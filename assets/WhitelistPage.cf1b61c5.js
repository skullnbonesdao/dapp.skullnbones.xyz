import{Q as C,a as g,b as D}from"./QInput.08b3bf3d.js";import{Q as b,a as R}from"./QTabPanels.36c9f6b2.js";import{Q as q}from"./QPage.7accb7aa.js";import{au as y,J as d,b1 as m,ak as v,as as t,bx as a,ar as f,ck as V,P as _,cJ as $,cK as J,cL as L,cM as x,cN as h,aX as Q,a6 as W,b7 as B,bz as S,ai as k,a1 as P,ah as U,aj as E}from"./index.2a5973e1.js";import{h as A}from"./QSlideTransition.9504ec78.js";import{l as F,n as K,o as M,m as T,C as I}from"./ClosePopup.ef7384b2.js";import{Q as N}from"./QBtnDropdown.10818a88.js";import{Q as X}from"./QTree.786c41a8.js";import"./touch.3df10340.js";const H={class:"row q-gutter-x-md"},Y=y({__name:"CreateWhitelist",setup(w){const o=d("My new whitelist");async function u(){const{pg_whitelist:n}=h();let[l,c]=_.findProgramAddressSync([$().publicKey.value.toBytes(),J(o.value)],n.value.programId);try{const r=await n.value.methods.initialize(o.value).accounts({whitelist:l,systemProgram:L.programId}).rpc();console.log(r),await A(r)}catch(r){x.create({color:"red",message:`${r}`,timeout:5e3})}}return(n,l)=>(m(),v("div",H,[t(C,{class:"col",modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=c=>o.value=c)},null,8,["modelValue"]),t(V,{color:"primary",onClick:l[1]||(l[1]=c=>u())},{default:a(()=>[f("Create")]),_:1})]))}}),j={class:"row q-gutter-x-md"},z=y({__name:"AddAddressToWhitelist",setup(w){const{pg_whitelist:o}=h(),u=d("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),n=d(),l=d();Q(async()=>{n.value=await o.value.account.whitelist.all()});async function c(){const r=new _(l.value.publicKey),[s,i]=_.findProgramAddressSync([new _(u.value).toBytes(),r.toBytes()],o.value.programId);try{const e=new _(u.value),p=await o.value.methods.addToWhitelist(e).accounts({entry:s,whitelist:r,authority:$().publicKey.value,systemProgram:L.programId}).rpc();console.log(p),await A(p)}catch(e){x.create({color:"red",message:`${e}`,timeout:5e3})}}return(r,s)=>{var i;return m(),v("div",j,[t(N,{color:"primary",label:((i=l.value)==null?void 0:i.account.name)??"please select a whitelist"},{default:a(()=>[t(F,null,{default:a(()=>[(m(!0),v(W,null,B(n.value,e=>S((m(),k(T,{clickable:"",key:e,onClick:p=>l.value=e},{default:a(()=>[t(K,null,{default:a(()=>[t(M,null,{default:a(()=>[f(P(e==null?void 0:e.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[I]])),128))]),_:1})]),_:1},8,["label"]),t(C,{class:"col",outlined:"",modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=e=>u.value=e),label:"Address to be added"},null,8,["modelValue"]),t(V,{color:"primary",onClick:s[1]||(s[1]=e=>c())},{default:a(()=>[f("Add")]),_:1})])}}}),G={class:"row q-gutter-x-md"},O=y({__name:"ViewWhitelist",setup(w){const{pg_whitelist:o}=h(),u=d(),n=d();Q(async()=>{u.value=await o.value.account.whitelist.all(),n.value=await o.value.account.whitelistEntry.all()});const l=U(()=>{var c;return(c=u==null?void 0:u.value)==null?void 0:c.map(r=>{var s,i;return{label:`${r.account.name} | ${r.publicKey.toString()}`,children:(i=(s=n.value)==null?void 0:s.filter(e=>e.account.parent.toString()===r.publicKey.toString()))==null?void 0:i.flatMap(e=>({label:`Member: ${e.account.whitelisted.toString()}  |  Account: ${e.publicKey.toString()} `}))}})});return(c,r)=>(m(),v("div",G,[l.value?(m(),k(X,{key:0,nodes:l.value,"node-key":"label","selected-color":"primary","default-expand-all":""},null,8,["nodes"])):E("",!0)]))}}),Z={class:"row q-gutter-x-md"},ee=y({__name:"RemoveAddressFromWhitelist",setup(w){const{pg_whitelist:o}=h(),u=d("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),n=d(),l=d();Q(async()=>{n.value=await o.value.account.whitelist.all()});async function c(){const r=new _(l.value.publicKey),[s,i]=_.findProgramAddressSync([new _(u.value).toBytes(),r.toBytes()],o.value.programId);try{console.log(o.value.methods);const e=new _(u.value),p=await o.value.methods.removeFromWhitelist(e).accounts({entry:s,whitelist:r,authority:$().publicKey.value}).rpc();console.log(p),await A(p)}catch(e){x.create({color:"red",message:`${e}`,timeout:5e3})}}return(r,s)=>{var i;return m(),v("div",Z,[t(N,{color:"primary",label:((i=l.value)==null?void 0:i.account.name)??"please select a whitelist"},{default:a(()=>[t(F,null,{default:a(()=>[(m(!0),v(W,null,B(n.value,e=>S((m(),k(T,{clickable:"",key:e,onClick:p=>l.value=e},{default:a(()=>[t(K,null,{default:a(()=>[t(M,null,{default:a(()=>[f(P(e==null?void 0:e.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[I]])),128))]),_:1})]),_:1},8,["label"]),t(C,{class:"col",outlined:"",modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=e=>u.value=e),label:"Address to be removed"},null,8,["modelValue"]),t(V,{color:"primary",onClick:s[1]||(s[1]=e=>c())},{default:a(()=>[f("Remove")]),_:1})])}}}),te={class:"row q-gutter-x-md"},ae=y({__name:"DeleteWhitelist",setup(w){const{pg_whitelist:o}=h(),u=d("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),n=d(),l=d();Q(async()=>{n.value=await o.value.account.whitelist.all()});async function c(){const r=new _(l.value.publicKey);_.findProgramAddressSync([new _(u.value).toBytes(),r.toBytes()],o.value.programId);try{const s=await o.value.methods.deleteWhitelist(l.value.account.name).accounts({whitelist:r,authority:$().publicKey.value}).rpc();console.log(s),await A(s)}catch(s){x.create({color:"red",message:`${s}`,timeout:5e3})}}return(r,s)=>{var i;return m(),v("div",te,[t(N,{color:"primary",label:((i=l.value)==null?void 0:i.account.name)??"please select a whitelist"},{default:a(()=>[t(F,null,{default:a(()=>[(m(!0),v(W,null,B(n.value,e=>S((m(),k(T,{clickable:"",key:e,onClick:p=>l.value=e},{default:a(()=>[t(K,null,{default:a(()=>[t(M,null,{default:a(()=>[f(P(e==null?void 0:e.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[I]])),128))]),_:1})]),_:1},8,["label"]),t(V,{color:"primary",onClick:s[0]||(s[0]=e=>c())},{default:a(()=>[f("Delete")]),_:1})])}}}),me=y({__name:"WhitelistPage",setup(w){const o=d("view");return(u,n)=>(m(),k(q,{class:"col text-center"},{default:a(()=>[t(D,{"no-caps":"","outside-arrows":"","mobile-arrows":"",modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=l=>o.value=l),class:"shadow-2",align:"justify"},{default:a(()=>[t(g,{name:"create",label:"Create Whitelist"}),t(g,{name:"add",label:"Add Address to Whitelist"}),t(g,{name:"remove",label:"Remove address from Whitelist"}),t(g,{name:"delete",label:"Delete Whitelist"}),t(g,{name:"view",label:"View "})]),_:1},8,["modelValue"]),t(R,{dark:"",modelValue:o.value,"onUpdate:modelValue":n[1]||(n[1]=l=>o.value=l),animated:""},{default:a(()=>[t(b,{name:"create"},{default:a(()=>[t(Y)]),_:1}),t(b,{name:"add"},{default:a(()=>[t(z)]),_:1}),t(b,{name:"remove"},{default:a(()=>[t(ee)]),_:1}),t(b,{name:"delete"},{default:a(()=>[t(ae)]),_:1}),t(b,{name:"view"},{default:a(()=>[t(O)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{me as default};
