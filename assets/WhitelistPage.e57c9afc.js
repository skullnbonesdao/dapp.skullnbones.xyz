import{Q as A,a as g,b as N}from"./QInput.20e0c15c.js";import{Q as b,a as U}from"./QTabPanels.2022eb85.js";import{Q as E}from"./QPage.0fa1cc90.js";import{co as h,cJ as k,au as y,J as d,b1 as m,ak as v,as as e,bx as o,ar as f,cj as x,P as _,cK as R,cL as L,cM as $,aX as Q,a6 as B,b7 as P,bz as S,ai as V,a1 as K,ah as j,aj as J}from"./index.08ab9ba0.js";import{h as C}from"./QSlideTransition.b391d75d.js";import{l as I,n as T,o as M,m as D}from"./uid.f00439cc.js";import{Q as F}from"./QBtnDropdown.f0169ed1.js";import{C as q}from"./ClosePopup.16ee5a09.js";import{Q as z}from"./QTree.e87c185c.js";function W(){h().publicKey.value||k.create({color:"yellow",message:"Wallet not connected!",timeout:5e3})}const X={class:"row q-gutter-x-md"},H=y({__name:"CreateWhitelist",setup(w){const l=d("My new whitelist");async function u(){W();const{pg_whitelist:n}=$();let[a,i]=_.findProgramAddressSync([h().publicKey.value.toBytes(),R(l.value)],n.value.programId);try{const r=await n.value.methods.initialize(l.value).accounts({whitelist:a,systemProgram:L.programId}).rpc();console.log(r),await C(r)}catch(r){k.create({color:"red",message:`${r}`,timeout:5e3})}}return(n,a)=>(m(),v("div",X,[e(A,{class:"col",modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=i=>l.value=i)},null,8,["modelValue"]),e(x,{color:"primary",onClick:a[1]||(a[1]=i=>u())},{default:o(()=>[f("Create")]),_:1})]))}}),Y={class:"row q-gutter-x-md"},G=y({__name:"AddAddressToWhitelist",setup(w){const{pg_whitelist:l}=$(),u=d(""),n=d(),a=d();Q(async()=>{n.value=await l.value.account.whitelist.all()});async function i(){W();const r=new _(a.value.publicKey.toString()),[s,c]=_.findProgramAddressSync([new _(u.value).toBytes(),r.toBytes()],l.value.programId);try{const t=new _(u.value),p=await l.value.methods.addToWhitelist(t).accounts({entry:s,whitelist:r,authority:h().publicKey.value,systemProgram:L.programId}).rpc();console.log(p),await C(p)}catch(t){k.create({color:"red",message:`${t}`,timeout:5e3})}}return(r,s)=>{var c;return m(),v("div",Y,[e(F,{color:"primary",label:((c=a.value)==null?void 0:c.account.name)??"please select a whitelist"},{default:o(()=>[e(I,null,{default:o(()=>[(m(!0),v(B,null,P(n.value,t=>S((m(),V(D,{clickable:"",key:t,onClick:p=>a.value=t},{default:o(()=>[e(T,null,{default:o(()=>[e(M,null,{default:o(()=>[f(K(t==null?void 0:t.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[q]])),128))]),_:1})]),_:1},8,["label"]),e(A,{class:"col",outlined:"",modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=t=>u.value=t),label:"Address to be added"},null,8,["modelValue"]),e(x,{color:"primary",onClick:s[1]||(s[1]=t=>i())},{default:o(()=>[f("Add")]),_:1})])}}}),O={class:"row q-gutter-x-md"},Z=y({__name:"ViewWhitelist",setup(w){const l=d(),u=d();Q(async()=>{const{pg_whitelist:a}=$();l.value=await a.value.account.whitelist.all(),u.value=await a.value.account.whitelistEntry.all()});const n=j(()=>{var a;return(a=l==null?void 0:l.value)==null?void 0:a.map(i=>{var r,s;return{label:`${i.account.name} | ${i.publicKey.toString()}`,children:(s=(r=u.value)==null?void 0:r.filter(c=>c.account.parent.toString()===i.publicKey.toString()))==null?void 0:s.flatMap(c=>({label:`Member: ${c.account.whitelisted.toString()}  |  Account: ${c.publicKey.toString()} `}))}})});return(a,i)=>(m(),v("div",O,[n.value?(m(),V(z,{key:0,nodes:n.value,"node-key":"label","selected-color":"primary","default-expand-all":""},null,8,["nodes"])):J("",!0)]))}}),ee={class:"row q-gutter-x-md"},te=y({__name:"RemoveAddressFromWhitelist",setup(w){const{pg_whitelist:l}=$(),u=d(""),n=d(),a=d();Q(async()=>{n.value=await l.value.account.whitelist.all()});async function i(){W();const r=new _(a.value.publicKey),[s,c]=_.findProgramAddressSync([new _(u.value).toBytes(),r.toBytes()],l.value.programId);try{console.log(l.value.methods);const t=new _(u.value),p=await l.value.methods.removeFromWhitelist(t).accounts({entry:s,whitelist:r,authority:h().publicKey.value}).rpc();console.log(p),await C(p)}catch(t){k.create({color:"red",message:`${t}`,timeout:5e3})}}return(r,s)=>{var c;return m(),v("div",ee,[e(F,{color:"primary",label:((c=a.value)==null?void 0:c.account.name)??"please select a whitelist"},{default:o(()=>[e(I,null,{default:o(()=>[(m(!0),v(B,null,P(n.value,t=>S((m(),V(D,{clickable:"",key:t,onClick:p=>a.value=t},{default:o(()=>[e(T,null,{default:o(()=>[e(M,null,{default:o(()=>[f(K(t==null?void 0:t.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[q]])),128))]),_:1})]),_:1},8,["label"]),e(A,{class:"col",outlined:"",modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=t=>u.value=t),label:"Address to be removed"},null,8,["modelValue"]),e(x,{color:"primary",onClick:s[1]||(s[1]=t=>i())},{default:o(()=>[f("Remove")]),_:1})])}}}),ae={class:"row q-gutter-x-md"},le=y({__name:"DeleteWhitelist",setup(w){const{pg_whitelist:l}=$(),u=d("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),n=d(),a=d();Q(async()=>{n.value=await l.value.account.whitelist.all()});async function i(){W();const r=new _(a.value.publicKey);_.findProgramAddressSync([new _(u.value).toBytes(),r.toBytes()],l.value.programId);try{const s=await l.value.methods.deleteWhitelist(a.value.account.name).accounts({whitelist:r,authority:h().publicKey.value}).rpc();console.log(s),await C(s)}catch(s){k.create({color:"red",message:`${s}`,timeout:5e3})}}return(r,s)=>{var c;return m(),v("div",ae,[e(F,{color:"primary",label:((c=a.value)==null?void 0:c.account.name)??"please select a whitelist"},{default:o(()=>[e(I,null,{default:o(()=>[(m(!0),v(B,null,P(n.value,t=>S((m(),V(D,{clickable:"",key:t,onClick:p=>a.value=t},{default:o(()=>[e(T,null,{default:o(()=>[e(M,null,{default:o(()=>[f(K(t==null?void 0:t.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[q]])),128))]),_:1})]),_:1},8,["label"]),e(x,{color:"primary",onClick:s[0]||(s[0]=t=>i())},{default:o(()=>[f("Delete")]),_:1})])}}}),_e=y({__name:"WhitelistPage",setup(w){const l=d("view");return(u,n)=>(m(),V(E,{class:"col text-center"},{default:o(()=>[e(N,{"no-caps":"","outside-arrows":"","mobile-arrows":"",modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=a=>l.value=a),class:"shadow-2",align:"justify"},{default:o(()=>[e(g,{name:"create",label:"Create Whitelist"}),e(g,{name:"add",label:"Add Address to Whitelist"}),e(g,{name:"remove",label:"Remove address from Whitelist"}),e(g,{name:"delete",label:"Delete Whitelist"}),e(g,{name:"view",label:"View "})]),_:1},8,["modelValue"]),e(U,{dark:"",modelValue:l.value,"onUpdate:modelValue":n[1]||(n[1]=a=>l.value=a),animated:""},{default:o(()=>[e(b,{name:"create"},{default:o(()=>[e(H)]),_:1}),e(b,{name:"add"},{default:o(()=>[e(G)]),_:1}),e(b,{name:"remove"},{default:o(()=>[e(te)]),_:1}),e(b,{name:"delete"},{default:o(()=>[e(le)]),_:1}),e(b,{name:"view"},{default:o(()=>[e(Z)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{_e as default};
