import{dj as Ae,dc as I,P as M,au as W,ck as Q,J as w,b1 as v,ak as q,as as e,bV as fe,cl as B,cQ as N,cS as $,bs as F,ai as V,bx as c,b7 as ge,ar as Ce,a1 as U,V as m,a6 as ue,al as a,aj as P,cn as oe,dk as H,c_ as K,cR as D,aX as be,ej as qe,ah as ye,b9 as Pe,co as X,cj as Te,dv as he,cP as J,cV as Ie,ek as Qe}from"./index.2f67b66f.js";import{Q as x}from"./QCardSection.3eeb44cb.js";import{Q as C}from"./QSeparator.d0b1e12d.js";import{Q as ne,a as j}from"./QTabs.d5beeddf.js";import{a as O,Q as de}from"./QTabPanels.742ef1fe.js";import{Q as T}from"./QCard.08d4d8dd.js";import{Q as Ke}from"./QPage.e6f9fad7.js";import{Q as pe}from"./QSlideTransition.ba2d4d85.js";import{Q as A}from"./QInput.df41d660.js";import{h as R}from"./handleTransaction.027e0731.js";import{Q as ie}from"./QSelect.35cf1ebf.js";import{c as re,b as te,d as xe,I as Se,a as Me}from"./calcAmountToTransfer.628fd73c.js";import{Q as Be}from"./QList.c04b0c40.js";import{Q as L}from"./QToggle.4b25d532.js";import{a as se,b as ae,c as Ne,d as Y,_ as le,f as z,s as Re}from"./FormatNumber.db3b102a.js";import{_ as Ee,c as Ve}from"./TokenSelectDropdown.8f9a6152.js";import{Q as Ge}from"./QImg.ff8a6e30.js";import{Q as _e}from"./QCardActions.bd54b088.js";import{Q as Le}from"./QSpace.6e4b2f34.js";import{U as je}from"./constants.e2ffd8e4.js";import{f as ve}from"./format_address.d3022ffc.js";import"./uid.42677368.js";import"./rtl.115a30e7.js";import"./touch.3df10340.js";import"./QMenu.0396f249.js";import"./use-key-composition.eaa7c820.js";import"./use-checkbox.cd9efb0f.js";import"./token.07e14955.js";const r=Ae("wrapperStore",{state:()=>({wrapperSelected:{},groupSelected:{},wrapper:[],groups:[]}),getters:{getWrapperByGroup:h=>i=>h.wrapper.filter(u=>{var s;return u.account.group.toString()==((s=i==null?void 0:i.publicKey)==null?void 0:s.toString())})},actions:{async updateStore(){var h;if(I()){const{pg_wrapper:i}=I();this.groups=await i.value.account.group.all(),this.wrapper=await i.value.account.wrapper.all(),(h=this.groupSelected)!=null&&h.publicKey||(this.groupSelected=this.groups[0]),console.log("[Updated] WrapperStore")}}}}),De=new M("subA4tNLV18htV8xACaZyMMKkAm1AQS4EhiPYPV4zbH"),Oe={class:"row"},ze=W({__name:"WrapperCreateGroup",setup(h){const i=Q(),u=w("");async function s(){try{const o=new N,t=I().pg_wrapper.value;if(u.value==""){i.notify({message:"Invalid group name",color:"info",position:"bottom-right"});return}o.add(await t.methods.initializeGroup(u.value).accountsPartial({signer:$(),fee:De}).instruction()),await R(o,"[Raffle] create new group"),await r().updateStore()}catch(o){i.notify({message:o.message,type:"negative"})}}return(o,t)=>(v(),q("div",Oe,[e(A,{square:"",filled:"",class:"col",modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=n=>u.value=n),label:"New group name",type:"text"},null,8,["modelValue"]),e(B,{square:"",onClick:t[1]||(t[1]=fe(n=>s(),["prevent"])),color:"primary",label:"Create"})]))}}),ce=W({__name:"WrapperGroupSelect",props:["asTabs"],setup(h){var u,s;const i=w(((s=(u=r().groupSelected)==null?void 0:u.account)==null?void 0:s.name)??"S&B Dockyard");return F(()=>i.value,()=>{r().groupSelected=r().groups.find(o=>o.account.name==i.value)}),(o,t)=>(v(),V(T,{bordered:"",flat:"",class:""},{default:c(()=>[h.asTabs?(v(),V(ne,{key:0,modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=n=>i.value=n),"active-color":"primary","indicator-color":"primary",align:"justify"},{default:c(()=>[(v(!0),q(ue,null,ge(m(r)().groups,n=>(v(),V(j,{name:n.account.name.toString(),key:n},{default:c(()=>[Ce(U(n.account.name.toString()),1)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])):(v(),V(ie,{key:1,label:"Select a group",square:"",filled:"","onUpdate:modelValue":[t[1]||(t[1]=()=>m(r)().wrapperSelected=void 0),t[2]||(t[2]=n=>m(r)().groupSelected=n)],modelValue:m(r)().groupSelected,options:m(r)().groups,"option-label":n=>{var l;return(l=n==null?void 0:n.account)==null?void 0:l.name}},null,8,["modelValue","options","option-label"]))]),_:1}))}}),Xe=W({__name:"WrapperCloseGroup",props:{disabled:{default:!0}},setup(h){const i=Q();async function u(){try{const s=new N,o=I().pg_wrapper.value;s.add(await o.methods.closeGroup().accountsPartial({group:r().groupSelected.publicKey,signer:$()}).instruction()),await R(s,"Close Group"),await r().updateStore()}catch(s){i.notify({message:s.message,type:"negative"})}}return(s,o)=>(v(),V(B,{disable:h.disabled,square:"",color:"primary",label:"Close",onClick:o[0]||(o[0]=fe(t=>u(),["prevent"]))},null,8,["disable"]))}}),Fe=a("div",{class:"text-h5"},"Group",-1),He=a("div",{class:"text-caption text-grey"}," The group will be used to filter and create the wrappers - one time creation fee of 0.5 SOL ",-1),Je=a("div",{class:"text-caption text-accent"}," Make sure u use a list where you are the owner! ",-1),Ye={key:0,class:"text-caption row"},Ze=a("div",{style:{width:"50px"}},"ID",-1),et={class:"col text-right"},tt={key:1,class:"text-caption row"},at=a("div",{style:{width:"50px"}},"Owner",-1),lt={class:"col text-accent text-right"},ot={class:"row"},nt={key:0,class:"text-caption row"},rt=a("div",{style:{width:"50px"}},"ID:",-1),st={class:"col text-accent text-right"},it={key:1,class:"text-caption row"},ct=a("div",{style:{width:"50px"}},"Owner:",-1),ut={class:"col text-accent text-right"},dt=a("div",{class:"text-h6 text-red-6 col"}," I know what im doing i want to close the group ",-1),pt=W({__name:"WrapperGroupView",setup(h){const i=w("select"),u=w(!1);return(s,o)=>(v(),V(T,{flat:"",bordered:""},{default:c(()=>[e(x,null,{default:c(()=>[Fe,He,Je]),_:1}),e(C),e(ne,{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=t=>i.value=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[e(j,{name:"select",label:"Select"}),e(j,{name:"create",label:"Create"}),e(j,{name:"close",label:"Close"})]),_:1},8,["modelValue"]),e(C),e(de,{modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=t=>i.value=t),animated:""},{default:c(()=>[e(O,{name:"create"},{default:c(()=>[e(ze)]),_:1}),e(O,{name:"select"},{default:c(()=>[e(ce,{class:""}),e(x,null,{default:c(()=>{var t,n,l,d,p;return[(t=m(r)().groupSelected)!=null&&t.account?(v(),q("div",Ye,[Ze,a("div",et,U((n=m(r)().groupSelected)==null?void 0:n.publicKey),1)])):P("",!0),(l=m(r)().groupSelected)!=null&&l.account?(v(),q("div",tt,[at,a("div",lt,U((p=(d=m(r)().groupSelected)==null?void 0:d.account)==null?void 0:p.owner),1)])):P("",!0)]}),_:1})]),_:1}),e(O,{name:"close"},{default:c(()=>[a("div",ot,[e(ce,{class:"col"}),e(Xe,{disabled:!u.value},null,8,["disabled"])]),e(x,null,{default:c(()=>{var t,n,l,d,p;return[(t=m(r)().groupSelected)!=null&&t.account?(v(),q("div",nt,[rt,a("div",st,U((n=m(r)().groupSelected)==null?void 0:n.publicKey),1)])):P("",!0),(l=m(r)().groupSelected)!=null&&l.account?(v(),q("div",it,[ct,a("div",ut,U((p=(d=m(r)().groupSelected)==null?void 0:d.account)==null?void 0:p.owner),1)])):P("",!0)]}),_:1}),e(x,{class:"row items-center"},{default:c(()=>[e(pe,{color:"red",modelValue:u.value,"onUpdate:modelValue":o[1]||(o[1]=t=>u.value=t)},null,8,["modelValue"]),dt]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),mt=a("div",{class:"text-h6"},"Wrapped Token",-1),wt={class:"row q-gutter-x-md items-center"},_t=a("div",{class:"text-h6"},"Ratio",-1),vt={class:"row q-gutter-x-md items-center"},ft={class:"row items-center"},gt=a("div",{class:"text-h6"},"Add Medata",-1),bt={key:0,class:"row items-center q-gutter-x-sm"},yt=W({__name:"WrapperCreate",setup(h){const i=Q(),u=w(),s=w(9),o=w(1),t=w(1),n=w(!0),l=w(""),d=w(""),p=w("");async function f(){var k;try{const _=new N,S=I().pg_wrapper.value,E=new H(window.crypto.getRandomValues(new Uint8Array(8))),Z={ratio:[new H(o.value),new H(t.value)],onlyCreatorCanWrap:!1,onlyCreatorCanUnwrap:!1,wrappedDecimals:s.value,seed:E},G=new M(u.value.mint.toString());if(_.add(await S.methods.initialize(Z).accountsPartial({signer:$(),group:new M(((k=r().groupSelected)==null?void 0:k.publicKey.toString())??""),mintUnwrapped:G,tokenProgram:K}).instruction()),_.add(await S.methods.createVault().accountsPartial({signer:$(),wrapper:se(G,$()),vaultUnwrappedAta:ae(se(G,$()),G),mintUnwrapped:G,tokenProgram:K}).instruction()),n.value){const ee={name:l.value,symbol:d.value,uri:p.value},g=se(G,$()),b=Ne(g,E),y=Y(b);_.add(await S.methods.metadataCreate(ee).accountsPartial({signer:$(),wrapper:g,mintWrapped:b,mintUnwrapped:G,metadata:y,tokenProgram:K}).instruction())}await R(_,`[Wrapper] create + vault ${n.value?"+ metadata":""}`),await r().updateStore()}catch(_){console.error(_),i.notify({message:_.message,type:"negative",position:"bottom-right"})}}return(k,_)=>(v(),V(T,{flat:""},{default:c(()=>[e(x,{class:""},{default:c(()=>[e(Ee,{label:"Unwrapped Token","textbox-label":"Token to wrap",onToken_account_selected:_[0]||(_[0]=S=>u.value=S)})]),_:1}),e(x,null,{default:c(()=>[mt,a("div",wt,[e(A,{square:"",filled:"",class:"col",modelValue:s.value,"onUpdate:modelValue":_[1]||(_[1]=S=>s.value=S),label:"Decimals",type:"number"},null,8,["modelValue"])])]),_:1}),e(x,null,{default:c(()=>[_t,a("div",vt,[e(A,{square:"",filled:"",class:"col",modelValue:o.value,"onUpdate:modelValue":_[2]||(_[2]=S=>o.value=S),label:"Unwrapped",type:"number"},null,8,["modelValue"]),e(oe,{name:"swap_horiz",size:"xl  "}),e(A,{square:"",filled:"",class:"col",modelValue:t.value,"onUpdate:modelValue":_[3]||(_[3]=S=>t.value=S),label:"Wrapped",type:"number"},null,8,["modelValue"])])]),_:1}),e(x,null,{default:c(()=>[a("div",ft,[gt,e(L,{modelValue:n.value,"onUpdate:modelValue":_[4]||(_[4]=S=>n.value=S),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),n.value?(v(),q("div",bt,[e(A,{square:"",filled:"",class:"col",modelValue:l.value,"onUpdate:modelValue":_[5]||(_[5]=S=>l.value=S),label:"Name",type:"text"},null,8,["modelValue"]),e(A,{square:"",filled:"",class:"col",modelValue:d.value,"onUpdate:modelValue":_[6]||(_[6]=S=>d.value=S),label:"Symbol",type:"text"},null,8,["modelValue"]),e(A,{square:"",filled:"",class:"col",modelValue:p.value,"onUpdate:modelValue":_[7]||(_[7]=S=>p.value=S),label:"Image-URI",type:"text"},null,8,["modelValue"])])):P("",!0)]),_:1}),e(x,{class:"row justify-end"},{default:c(()=>[e(B,{square:"",color:"primary",label:"Create new wrapper",onClick:_[8]||(_[8]=S=>f())})]),_:1})]),_:1}))}}),ht={class:"row items-center"},xt=a("div",{class:"col text-subtitle1 text-weight-thin"},"Publickey",-1),St={class:"text-subtitle2"},Vt={class:"col text-subtitle1 text-weight-thin"},$t={key:0,class:"text-subtitle2"},Ut={key:1,class:"text-subtitle2"},kt=W({__name:"WrapperInfo",setup(h){return(i,u)=>{var s;return(s=m(r)().wrapperSelected)!=null&&s.account?(v(),V(T,{key:0,flat:""},{default:c(()=>[e(C),e(x,null,{default:c(()=>{var o;return[a("div",ht,[xt,a("div",St,U(m(r)().wrapperSelected.publicKey),1)]),(v(!0),q(ue,null,ge(Object.keys((o=m(r)().wrapperSelected)==null?void 0:o.account),t=>(v(),q("div",{key:t,class:"row items-center"},[a("div",Vt,U(t.toUpperCase()),1),t=="ratio"?(v(),q("div",$t,U(m(r)().wrapperSelected.account[t][0])+" : "+U(m(r)().wrapperSelected.account[t][1]),1)):(v(),q("div",Ut,U(m(r)().wrapperSelected.account[t]),1))]))),128))]}),_:1})]),_:1})):P("",!0)}}}),Wt=W({__name:"WrapperClose",props:{disabled:{default:!0}},setup(h){const i=Q();async function u(){var s,o;try{const t=new N,n=I().pg_wrapper.value;t.add(await n.methods.close().accountsPartial({wrapper:(s=r().wrapperSelected)==null?void 0:s.publicKey,signer:$(),mintUnwrapped:(o=r().wrapperSelected)==null?void 0:o.account.mintUnwrapped,tokenProgram:K}).instruction()),await R(t,"[Wrapper] Close"),await r().updateStore()}catch(t){console.error(t),i.notify({message:t.message,type:"negative"})}}return(s,o)=>(v(),V(B,{disable:h.disabled,square:"",color:"primary",label:"Close WrapperInterface",onClick:o[0]||(o[0]=t=>u())},null,8,["disable"]))}}),At={class:"row items-center"},Ct=a("div",{class:"col text-subtitle1"},"Allow wrap",-1),qt={class:"row items-center"},Pt=a("div",{class:"col text-subtitle1"},"Allow unwrap",-1),Tt={class:"row items-center"},It=a("div",{class:"col text-subtitle1"},"Only admin can Wrap",-1),Qt={class:"row items-center"},Kt=a("div",{class:"col text-subtitle1"},"Only admin can unwrap",-1),Mt={class:"row items-center"},Bt=a("div",{class:"col text-subtitle1"},"Use whitelist",-1),Nt={class:"row items-center"},Rt=a("div",{class:"col text-subtitle1"},"Use Limit",-1),Et={class:"row items-center"},Gt=a("div",{class:"col text-subtitle1"},"Change Admin",-1),Lt={class:"row items-center"},jt=a("div",{class:"col text-subtitle1"},"Change Ratio",-1),Dt={key:0,style:{width:"500px"},class:"row items-center"},Ot=W({__name:"WrapperSettings",setup(h){var ee;const i=Q();(ee=r().wrapperSelected)==null||ee.account;const u=w(),s=w(),o=w(),t=w(),n=w(),l=w(),d=w(),p=w(),f=w(!1),k=w(),_=w(!1),S=w(),E=w();Z(),F(()=>{var g,b;return(b=(g=r())==null?void 0:g.wrapperSelected)==null?void 0:b.account},()=>{Z()});function Z(){var b,y;if(!((b=r().wrapperSelected)!=null&&b.account))return;const g=(y=r().wrapperSelected)==null?void 0:y.account;u.value=g.allowWrap,s.value=g==null?void 0:g.allowUnwrap,o.value=g==null?void 0:g.onlyAdminCanWrap,t.value=g==null?void 0:g.onlyAdminCanUnwrap,n.value=g==null?void 0:g.useWhitelist,l.value=g==null?void 0:g.whitelist,d.value=g==null?void 0:g.useLimit,p.value=(g==null?void 0:g.limitAmountUnwrapped)??0,k.value=g==null?void 0:g.admin,S.value=g==null?void 0:g.ratio[0],E.value=g==null?void 0:g.ratio[1]}async function G(){var g,b;try{const y=new N,Ue=I().pg_wrapper.value,ke={allowWrap:u.value,allowUnwrap:s.value,onlyAdminCanWrap:o.value,onlyAdminCanUnwrap:t.value,useWhitelist:n.value,useLimit:d.value,amountAbleToWrap:d.value?re(p.value,D().tokenList.find(We=>{var me,we;return We.address==((we=(me=r().wrapperSelected)==null?void 0:me.account)==null?void 0:we.mintUnwrapped.toString())}).decimals):null,admin:f.value?new M(k.value):null,ratio:_.value?[new H(S.value),new H(E.value)]:null};y.add(await Ue.methods.edit(ke).accountsPartial({wrapper:(g=r().wrapperSelected)==null?void 0:g.publicKey,signer:$(),mintUnwrapped:(b=r().wrapperSelected)==null?void 0:b.account.mintUnwrapped,whitelist:n.value?new M(l.value):null,tokenProgram:K}).instruction()),await R(y),await r().updateStore()}catch(y){console.error(y),i.notify({message:y.message,type:"negative"})}}return(g,b)=>(v(),V(T,{flat:""},{default:c(()=>[e(x,{class:"q-gutter-y-sm"},{default:c(()=>[a("div",At,[Ct,e(L,{modelValue:u.value,"onUpdate:modelValue":b[0]||(b[0]=y=>u.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",qt,[Pt,e(L,{modelValue:s.value,"onUpdate:modelValue":b[1]||(b[1]=y=>s.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",Tt,[It,e(L,{modelValue:o.value,"onUpdate:modelValue":b[2]||(b[2]=y=>o.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",Qt,[Kt,e(L,{modelValue:t.value,"onUpdate:modelValue":b[3]||(b[3]=y=>t.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",Mt,[Bt,n.value?(v(),V(A,{key:0,dense:"",filled:"",square:"",style:{width:"500px"},modelValue:l.value,"onUpdate:modelValue":b[4]||(b[4]=y=>l.value=y),type:"text",label:"Whitelist"},null,8,["modelValue"])):P("",!0),e(L,{modelValue:n.value,"onUpdate:modelValue":b[5]||(b[5]=y=>n.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",Nt,[Rt,d.value?(v(),V(A,{key:0,dense:"",filled:"",square:"",style:{width:"500px"},modelValue:p.value,"onUpdate:modelValue":b[6]||(b[6]=y=>p.value=y),type:"number",label:"Amount wrappable"},null,8,["modelValue"])):P("",!0),e(L,{modelValue:d.value,"onUpdate:modelValue":b[7]||(b[7]=y=>d.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",null,[a("div",Et,[Gt,f.value?(v(),V(A,{key:0,style:{width:"500px"},dense:"",filled:"",square:"",label:"Admin",modelValue:k.value,"onUpdate:modelValue":b[8]||(b[8]=y=>k.value=y)},null,8,["modelValue"])):P("",!0),e(L,{modelValue:f.value,"onUpdate:modelValue":b[9]||(b[9]=y=>f.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])])]),a("div",null,[a("div",Lt,[jt,_.value?(v(),q("div",Dt,[e(A,{class:"col",dense:"",filled:"",square:"",label:"Unwrapped",modelValue:S.value,"onUpdate:modelValue":b[10]||(b[10]=y=>S.value=y),type:"number"},null,8,["modelValue"]),e(oe,{size:"md",name:"swap_horiz"}),e(A,{class:"col",dense:"",filled:"",square:"",label:"Wrapped",modelValue:E.value,"onUpdate:modelValue":b[11]||(b[11]=y=>E.value=y),type:"number"},null,8,["modelValue"])])):P("",!0),e(L,{modelValue:_.value,"onUpdate:modelValue":b[12]||(b[12]=y=>_.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])])])]),_:1}),e(x,{class:"row justify-end"},{default:c(()=>[e(B,{square:"",class:"",color:"primary",label:"Update settings",onClick:b[13]||(b[13]=y=>G())})]),_:1})]),_:1}))}}),zt=W({__name:"WrapperCreateVault",setup(h){const i=Q(),u=w(!1);async function s(o){try{const t=new N,n=I().pg_wrapper.value;t.add(await n.methods.createVault().accountsPartial({wrapper:new M(r().wrapperSelected.publicKey.toString()),signer:$(),mintUnwrapped:new M(r().wrapperSelected.account.mintUnwrapped.toString()),tokenProgram:K}).instruction()),await R(t,"[Wrapper] create vault")}catch(t){console.error(t),i.notify({message:t.message,type:"negative"})}}return(o,t)=>{var n;return!u.value&&((n=m(r)().wrapperSelected)==null?void 0:n.publicKey)?(v(),V(B,{key:0,square:"",color:"primary",label:"Create Vault",onClick:t[0]||(t[0]=l=>s())})):P("",!0)}}}),Xt={class:"row"},Ft=a("div",{class:"col"},"Vault Balance",-1),Ht={class:"row"},Jt=a("div",{class:"col"},"Circ. Supply",-1),$e=W({__name:"WrapperVaultDonut",props:["wrapper"],setup(h){const i=h,u=w(0),s=w(0),o=w(0);async function t(){u.value=await n()??0,s.value=await l()??0,o.value=u.value*i.wrapper.account.ratio[1]/u.value*i.wrapper.account.ratio[1]*100}async function n(){return(await X().connection.getTokenSupply(new M(i.wrapper.account.mintWrapped))).value.uiAmount}async function l(){let f=ae(i.wrapper.publicKey,i.wrapper.account.mintUnwrapped);return(await X().connection.getTokenAccountBalance(f)).value.uiAmount}be(async()=>{await t()}),qe(()=>i.wrapper,async()=>await t());const d=ye(()=>[o.value]),p=w({dataLabels:{enabled:!1},legend:{labels:{colors:"white"},show:!1,position:"left"},theme:{palette:"palette4"},labels:["Redeemable"]});return(f,k)=>{const _=Pe("apexchart");return v(),q(ue,null,[a("div",Xt,[Ft,e(le,{class:"",number:s.value,decimals:4,"pad-start":10},null,8,["number"])]),a("div",Ht,[Jt,e(le,{number:u.value,decimals:4,"pad-start":10},null,8,["number"])]),e(_,{height:"200px",type:"radialBar",options:p.value,series:d.value},null,8,["options","series"])],64)}}}),Yt={class:"text-subtitle2 row items-center"},Zt=a("div",{class:"text-accent"}," I want to transfer tokens out of the vault to a new address ",-1),ea={class:"col"},ta={class:"row"},aa=W({__name:"WrapperTransferVaultOut",setup(h){const i=Q(),u=w(1),s=w($().toString()),o=w(!1);F(()=>Te().useSquads,()=>{s.value=$().toString()});async function t(){var n,l;try{if(I()){const d=new N,p=I().pg_wrapper.value,f=z(new M(s.value).toString(),r().wrapperSelected.account.mintUnwrapped.toString());await X().connection.getAccountInfo(f)||d.add(Ve($(),f,new M(s.value),r().wrapperSelected.account.mintUnwrapped,K,he)),d.add(await p.methods.transferVault(re(u.value,r().wrapperSelected.account.wrappedDecimals)).accountsPartial({signer:$(),wrapper:(n=r().wrapperSelected)==null?void 0:n.publicKey,mintUnwrapped:(l=r().wrapperSelected)==null?void 0:l.account.mintUnwrapped,ataUnwrappedSigner:f,tokenProgram:K}).instruction()),await R(d,`[Wrapper] transfer to ${s.value}`),await r().updateStore()}}catch(d){console.error(d),i.notify({message:d.message,type:"negative"})}}return(n,l)=>(v(),V(T,{flat:""},{default:c(()=>[a("div",Yt,[e(pe,{modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=d=>o.value=d)},null,8,["modelValue"]),Zt]),a("div",ea,[a("div",ta,[e(A,{class:"col",disable:!o.value,square:"",filled:"",modelValue:s.value,"onUpdate:modelValue":l[1]||(l[1]=d=>s.value=d),type:"text",label:"recipient"},null,8,["disable","modelValue"]),e(C,{vertical:""}),e(A,{disable:!o.value,square:"",filled:"",modelValue:u.value,"onUpdate:modelValue":l[2]||(l[2]=d=>u.value=d),type:"number",label:"Amount to transfer"},null,8,["disable","modelValue"]),e(B,{disable:!u.value||!s.value||!o.value,color:"primary",label:"Send",square:"",onClick:l[3]||(l[3]=d=>t())},null,8,["disable"])])])]),_:1}))}}),la={class:"row items-center"},oa=a("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),na={class:"text-subtitle2"},ra={class:"row items-center"},sa=a("div",{class:"col text-subtitle1 text-weight-thin"},"Mint",-1),ia={class:"text-subtitle2"},ca={class:"row items-center"},ua=a("div",{class:"col text-subtitle1 text-weight-thin"},"Unwrapped",-1),da={class:"text-subtitle2"},pa={class:"row items-center"},ma=a("div",{class:"col text-subtitle1 text-weight-thin"},"Balance",-1),wa={class:"text-subtitle2"},_a=W({__name:"WrapperVault",setup(h){Q();const i=w(null),u=w(!1);s(),F(()=>{var o,t;return(t=(o=r())==null?void 0:o.wrapperSelected)==null?void 0:t.account},async()=>{await s()});async function s(){var o;!r().wrapperSelected||(i.value=(o=(await X().connection.getParsedAccountInfo(ae(r().wrapperSelected.publicKey,r().wrapperSelected.account.mintUnwrapped))).value)==null?void 0:o.data,i.value&&(u.value=!0))}return(o,t)=>(v(),V(T,{flat:""},{default:c(()=>[e(C),e(x,{class:"col"},{default:c(()=>{var n,l,d;return[a("div",la,[oa,a("div",na,U(m(ae)(m(r)().wrapperSelected.publicKey,m(r)().wrapperSelected.account.mintUnwrapped)),1)]),a("div",ra,[sa,a("div",ia,U((n=m(r)().wrapperSelected.account)==null?void 0:n.mintUnwrapped),1)]),a("div",ca,[ua,a("div",da,U(m(D)().getTokenByMintPublicKey((l=m(r)().wrapperSelected)==null?void 0:l.account.mintUnwrapped).name),1)]),a("div",pa,[ma,a("div",wa,U((d=i.value)==null?void 0:d.parsed.info.tokenAmount.uiAmount),1)])]}),_:1}),e(x,null,{default:c(()=>[e($e,{wrapper:m(r)().wrapperSelected},null,8,["wrapper"])]),_:1}),e(x,{class:"q-gutter-y-md"},{default:c(()=>[u.value?P("",!0):(v(),V(zt,{key:0,class:"full-width"})),e(aa)]),_:1})]),_:1}))}}),va=W({__name:"WrapperMetadataUpdate",props:["name","symbol","uri"],setup(h){const i=h,u=Q();async function s(o){var t,n;try{const l=new N,d=I().pg_wrapper.value,p={name:i.name,symbol:i.symbol,uri:i.uri};l.add(await d.methods.metadataUpdate(p).accountsPartial({wrapper:(t=r().wrapperSelected)==null?void 0:t.publicKey,signer:$(),metadata:Y(r().wrapperSelected.account.mintWrapped),mintUnwrapped:(n=r().wrapperSelected)==null?void 0:n.account.mintUnwrapped,tokenProgram:K}).instruction()),await R(l,"[Wrapper] metadata update"),await r().updateStore()}catch(l){console.error(l),u.notify({message:l.message,type:"negative"})}}return(o,t)=>(v(),V(B,{square:"",color:"primary",label:"Apply Metadata",onClick:t[0]||(t[0]=n=>s())}))}}),fa=W({__name:"WrapperMetadataCreate",props:["name","symbol","uri"],setup(h){const i=h,u=Q();async function s(o){var t,n;try{const l=new N,d=I().pg_wrapper.value,p={name:i.name,symbol:i.symbol,uri:i.uri};l.add(await d.methods.metadataCreate(p).accountsPartial({wrapper:(t=r().wrapperSelected)==null?void 0:t.publicKey,signer:$(),metadata:Y(r().wrapperSelected.account.mintWrapped),mintUnwrapped:(n=r().wrapperSelected)==null?void 0:n.account.mintUnwrapped,tokenProgram:K}).instruction()),await R(l,"[Wrapper] metadata create"),await r().updateStore()}catch(l){console.error(l),u.notify({message:l.message,type:"negative"})}}return(o,t)=>(v(),V(B,{square:"",color:"primary",label:"Create Metadata",onClick:t[0]||(t[0]=n=>s())}))}}),ga={class:"row items-center"},ba=a("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),ya={class:"text-subtitle2"},ha={class:"row"},xa=W({__name:"WrapperMetadata",setup(h){Q();const i=w(""),u=w(""),s=w(""),o=w(),t=w(),n=w(!1);l(),F(()=>{var d,p;return(p=(d=r())==null?void 0:d.wrapperSelected)==null?void 0:p.account},async()=>{await l()});async function l(){!r().wrapperSelected||(o.value=await X().connection.getAccountInfo(Y(r().wrapperSelected.account.mintWrapped)),t.value=Re.deserializeMetadata(o.value),i.value=t.value.name,u.value=t.value.symbol,s.value=t.value.uri,o.value&&(n.value=!0))}return(d,p)=>(v(),V(T,{flat:""},{default:c(()=>[e(x,null,{default:c(()=>[a("div",ga,[ba,a("div",ya,U(m(Y)(m(r)().wrapperSelected.publicKey)),1)])]),_:1}),n.value?(v(),V(x,{key:0,class:"col"},{default:c(()=>[a("div",ha,[e(A,{square:"",label:"Name",filled:"",modelValue:i.value,"onUpdate:modelValue":p[0]||(p[0]=f=>i.value=f)},null,8,["modelValue"]),e(C,{vertical:""}),e(A,{square:"",label:"Symbol",filled:"",modelValue:u.value,"onUpdate:modelValue":p[1]||(p[1]=f=>u.value=f)},null,8,["modelValue"]),e(C,{vertical:""}),e(A,{square:"",label:"Image URI",class:"col",filled:"",modelValue:s.value,"onUpdate:modelValue":p[2]||(p[2]=f=>s.value=f)},null,8,["modelValue"]),e(va,{name:i.value,symbol:u.value,uri:s.value},null,8,["name","symbol","uri"])])]),_:1})):(v(),V(x,{key:1,class:"row justify-end"},{default:c(()=>[e(fa,{name:i.value,symbol:u.value,uri:s.value},null,8,["name","symbol","uri"])]),_:1}))]),_:1}))}}),Sa=a("div",{class:"text-h5"},"WrapperInterface Factory",-1),Va=a("div",{class:"text-caption text-grey"}," Small plates, salads & sandwiches in an intimate setting. ",-1),$a={class:"row q-gutter-x-md"},Ua={class:"text-caption text-grey text-right"},ka={class:"row"},Wa=a("div",{class:"text-h6 text-red-6 col"}," I know what im doing i want to close a wrapper ",-1),Aa=W({__name:"WrapperManage",setup(h){const i=w("select"),u=w(!1);return(s,o)=>(v(),V(T,{flat:"",bordered:""},{default:c(()=>[e(x,null,{default:c(()=>[Sa,Va]),_:1}),e(C),e(ne,{modelValue:i.value,"onUpdate:modelValue":o[0]||(o[0]=t=>i.value=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[e(j,{name:"create",label:"Create"}),e(j,{name:"select",label:"Edit"}),e(j,{name:"close",label:"Close"})]),_:1},8,["modelValue"]),e(C),e(de,{modelValue:i.value,"onUpdate:modelValue":o[4]||(o[4]=t=>i.value=t),animated:""},{default:c(()=>[e(O,{name:"create"},{default:c(()=>[e(yt)]),_:1}),e(O,{name:"select"},{default:c(()=>[e(T,{flat:""},{default:c(()=>{var t;return[e(x,null,{default:c(()=>[a("div",$a,[e(ie,{label:"Select a wrapper",class:"col",filled:"",modelValue:m(r)().wrapperSelected,"onUpdate:modelValue":o[1]||(o[1]=n=>m(r)().wrapperSelected=n),options:m(r)().getWrapperByGroup(m(r)().groupSelected),"option-label":n=>{var l,d;return"[Wrapped] "+(((l=m(D)().tokenList.find(p=>{var f,k;return p.address==((k=(f=n.account)==null?void 0:f.mintUnwrapped)==null?void 0:k.toString())}))==null?void 0:l.name)??((d=n.account)==null?void 0:d.mintUnwrapped.toString())??"")}},null,8,["modelValue","options","option-label"])]),a("div",Ua," Total Found: "+U(m(r)().wrapper.length),1)]),_:1}),(t=m(r)().wrapperSelected)!=null&&t.account?(v(),V(x,{key:0,class:"row full-width"},{default:c(()=>[e(Be,{bordered:"",class:"rounded-borders full-width"},{default:c(()=>[e(te,{class:"text-h5",icon:"info",label:"Info"},{default:c(()=>[e(kt)]),_:1}),e(C),e(te,{class:"text-h5",icon:"settings",label:"Settings"},{default:c(()=>[e(Ot)]),_:1}),e(C),e(te,{class:"text-h5",icon:"note_add",label:"Metadata"},{default:c(()=>[e(xa)]),_:1}),e(C),e(te,{class:"text-h5","default-opened":"",icon:"inventory_2",label:"Vault"},{default:c(()=>[e(_a)]),_:1})]),_:1})]),_:1})):P("",!0)]}),_:1})]),_:1}),e(O,{name:"close"},{default:c(()=>[e(T,{flat:""},{default:c(()=>{var t;return[e(x,null,{default:c(()=>[a("div",ka,[e(ie,{label:"Select a wrapper",class:"col",filled:"",modelValue:m(r)().wrapperSelected,"onUpdate:modelValue":o[2]||(o[2]=n=>m(r)().wrapperSelected=n),options:m(r)().wrapper,"option-label":n=>{var l,d;return"[Wrapped] "+(((l=m(D)().tokenList.find(p=>{var f,k;return p.address==((k=(f=n.account)==null?void 0:f.mintUnwrapped)==null?void 0:k.toString())}))==null?void 0:l.name)??((d=n.account)==null?void 0:d.mintUnwrapped.toString())??"")}},null,8,["modelValue","options","option-label"]),e(Wt,{disabled:!u.value},null,8,["disabled"])])]),_:1}),(t=m(r)().wrapperSelected)!=null&&t.account?(v(),V(x,{key:0,class:"row justify-between"})):P("",!0)]}),_:1}),e(x,{class:"row items-center"},{default:c(()=>[e(pe,{color:"red",modelValue:u.value,"onUpdate:modelValue":o[3]||(o[3]=t=>u.value=t)},null,8,["modelValue"]),Wa]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),Ca=W({__name:"WrapperWrap",props:["wrapper"],setup(h){const i=Q(),u=w(1),s=h;async function o(){var t,n;try{const l=new N,d=I().pg_wrapper.value,p=s.wrapper,f=re(u.value,((t=D().getTokenByMintPublicKey(p==null?void 0:p.account.mintUnwrapped))==null?void 0:t.decimals)??((n=J().getAccountByMintPublicKey(p==null?void 0:p.account.mintUnwrapped))==null?void 0:n.decimals)??0);await X().connection.getAccountInfo(z($().toString(),s.wrapper.account.mintWrapped.toString()))||l.add(Ve($(),z($().toString(),s.wrapper.account.mintWrapped.toString()),$(),s.wrapper.account.mintWrapped,K,he)),console.log(`amount_to_transfer=${f}`);let _=s.wrapper.account.useWhitelist?s.wrapper.account.whitelist:null,S=s.wrapper.account.useWhitelist?xe(_):null;console.log(_),l.add(await d.methods.wrap(f).accountsPartial({signer:$(),wrapper:p.publicKey,mintUnwrapped:p.account.mintUnwrapped,signerUnwrapped:z($().toString(),p.account.mintUnwrapped.toString()),signerWrapped:z($().toString(),s.wrapper.account.mintWrapped.toString()),tokenProgram:K,whitelist:_,whitelistEntry:S,whitelistProgram:Se}).instruction()),await R(l,"[Wrapper] wrap tokens"),await r().updateStore()}catch(l){console.error(l),i.notify({message:l.message,type:"negative"})}}return(t,n)=>(v(),q("div",null,[e(A,{disable:!h.wrapper.account.allowWrap,filled:"",type:"number",modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=l=>u.value=l)},null,8,["disable","modelValue"]),e(B,{disable:!h.wrapper.account.allowWrap,class:"full-width",color:"primary",label:"Wrap",onClick:n[1]||(n[1]=l=>o())},null,8,["disable"])]))}}),qa=W({__name:"WrapperUnwrap",props:["wrapper"],setup(h){const i=Q(),u=w(1),s=h;async function o(t){var n,l;try{const d=new N,p=I().pg_wrapper.value,f=s.wrapper,k=re(u.value,(n=J().getAccountByMintPublicKey(f==null?void 0:f.account.mintUnwrapped))==null?void 0:n.decimals);let _=s.wrapper.account.useWhitelist?s.wrapper.account.whitelist:null,S=s.wrapper.account.useWhitelist?xe(_):null;d.add(await p.methods.unwrap(k).accountsPartial({signer:$(),wrapper:f.publicKey,mintUnwrapped:f.account.mintUnwrapped,signerUnwrapped:new M(((l=J().accounts.find(E=>E.mint.toString()==f.account.mintUnwrapped.toString()))==null?void 0:l.pubkey)??""),signerWrapped:z(Ie().publicKey.value.toString(),s.wrapper.account.mintWrapped.toString()),tokenProgram:K,whitelist:_,whitelistEntry:S,whitelistProgram:Se}).instruction()),await R(d,"[Wrapper] unwrap tokens"),await r().updateStore()}catch(d){console.error(d),i.notify({message:d.message,type:"negative"})}}return(t,n)=>(v(),q("div",null,[e(A,{disable:!h.wrapper.account.allowUnwrap,filled:"",type:"number",modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=l=>u.value=l)},null,8,["disable","modelValue"]),e(B,{disable:!h.wrapper.account.allowUnwrap,class:"full-width",color:"primary",label:"Unwrap",onClick:n[1]||(n[1]=l=>o())},null,8,["disable"])]))}});const Pa={class:"q-pa-md"},Ta={class:"q-pa-xs col-xs-12 col-sm-6 col-md-3"},Ia={class:"row items-center"},Qa=a("div",{class:"col text-subtitle1 text-weight-thin"},"Group",-1),Ka={class:"text-subtitle2"},Ma={class:"row items-center"},Ba=a("div",{class:"col text-subtitle1 text-weight-thin"},"Pair",-1),Na={class:"text-subtitle2 row q-gutter-x-xs"},Ra=a("div",null,"/",-1),Ea={class:"row items-center"},Ga=a("div",{class:"col text-subtitle1 text-weight-thin"},"Wrappable",-1),La={class:"text-subtitle2"},ja={class:"row items-center"},Da=a("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),Oa={class:"text-subtitle2"},za={class:"col text-center"},Xa={class:"col text-center"},Fa=a("div",{class:"text-center text-subtitle2"},"Status",-1),Ha=a("div",null,null,-1),Ja=a("div",{class:"col text-center"},"Wallet Balance",-1),Ya={class:"row q-pa-md"},Za={class:"row q-gutter-x-md"},el=W({__name:"WrapperTable",setup(h){const i=Q();function u(){return i.screen.lt.sm?3:i.screen.lt.md?6:9}const s=w(""),o=w({page:1,rowsPerPage:u()});return F(()=>i.screen.name,()=>{o.value.rowsPerPage=u()}),ve($().toString()),ye(()=>i.screen.gt.xs?i.screen.gt.sm?[3,6,9]:[3,6]:[3]),(t,n)=>(v(),q("div",Pa,[m(r)().groupSelected?(v(),V(Me,{key:0,grid:"","hide-header":"","hide-bottom":"",rows:m(r)().getWrapperByGroup(m(r)().groupSelected),"row-key":"name",filter:s.value,pagination:o.value,"onUpdate:pagination":n[0]||(n[0]=l=>o.value=l),"rows-per-page-options":[0]},{item:c(l=>[a("div",Ta,[e(T,{flat:"",bordered:""},{default:c(()=>[e(x,{class:"text-center"},{default:c(()=>{var d;return[e(Ge,{height:"150px",width:"150px",src:((d=m(D)().tokenList.find(p=>{var f;return p.address==((f=l.row.account)==null?void 0:f.mintUnwrapped.toString())}))==null?void 0:d.logoURI)??m(je)},null,8,["src"])]}),_:2},1024),e(x,null,{default:c(()=>{var d,p,f,k;return[a("div",Ia,[Qa,a("div",Ka,U(m(r)().groups.find(_=>_.publicKey.toString()==l.row.account.group.toString()).account.name),1)]),a("div",Ma,[Ba,a("div",Na,[a("div",null,U(m(D)().tokenList.find(_=>_.address==l.row.account.mintUnwrapped.toString()).symbol),1),Ra,a("div",null," W"+U(m(D)().tokenList.find(_=>_.address==l.row.account.mintUnwrapped.toString()).symbol),1)])]),a("div",Ea,[Ga,a("div",La,U((d=l.row)!=null&&d.account.useLimit?(p=l.row)==null?void 0:p.account.limitAmountUnwrapped:"\u221E"),1)]),a("div",ja,[Da,a("div",Oa,U(m(ve)((k=(f=l.row)==null?void 0:f.publicKey)==null?void 0:k.toString())),1)])]}),_:2},1024),e(C),e(_e,{class:"row text-h4"},{default:c(()=>[a("div",za,U(l.row.account.ratio[0]),1),e(oe,{size:"md",name:"swap_horiz"}),a("div",Xa,U(l.row.account.ratio[1]),1)]),_:2},1024),e(_e,{class:"row"},{default:c(()=>[e(T,{class:"col q-mx-sm",flat:"",bordered:""},{default:c(()=>[e(x,null,{default:c(()=>[Fa]),_:1}),e(C),Ha,e(x,null,{default:c(()=>[e($e,{mintWrapped:l.row.account.mintWrapped.toString(),mintUnwrapped:l.row.account.mintUnwrapped.toString(),wrapper:l.row},null,8,["mintWrapped","mintUnwrapped","wrapper"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(x,{class:"col"},{default:c(()=>[e(T,{bordered:"",flat:"",class:"q-mb-md"},{default:c(()=>{var d,p;return[e(x,null,{default:c(()=>[Ja]),_:1}),e(C),a("div",Ya,[e(le,{number:(d=m(J)().getAccountByMintPublicKey(l.row.account.mintUnwrapped))==null?void 0:d.uiAmount,decimals:4,"pad-start":10},null,8,["number"]),e(Le),e(le,{number:(p=m(J)().getAccountByMintPublicKey(l.row.account.mintWrapped))==null?void 0:p.uiAmount,decimals:4,"pad-start":10},null,8,["number"])])]}),_:2},1024),a("div",Za,[e(Ca,{class:"col",wrapper:l.row},null,8,["wrapper"]),e(qa,{class:"col",wrapper:l.row},null,8,["wrapper"])])]),_:2},1024)]),_:2},1024)])]),_:1},8,["rows","filter","pagination"])):P("",!0)]))}}),tl=a("div",{class:"col text-h6"},"Token Wrapper Interface",-1),al={class:"row"},ql=W({__name:"WrapperPage",setup(h){const i=w("wrapping");return r(),be(async()=>{I()||Qe(),await r().updateStore()}),(u,s)=>(v(),V(Ke,{class:"bg-black"},{default:c(()=>[e(T,null,{default:c(()=>[e(x,{class:"row items-center q-gutter-x-md"},{default:c(()=>[e(oe,{name:"inventory_2",size:"md"}),tl]),_:1}),e(C),e(ne,{modelValue:i.value,"onUpdate:modelValue":s[0]||(s[0]=o=>i.value=o),class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify"},{default:c(()=>[e(j,{name:"wrapping",label:"Wrap / Unwrap"}),e(j,{name:"manage",label:"Manage"})]),_:1},8,["modelValue"]),e(C),e(de,{modelValue:i.value,"onUpdate:modelValue":s[1]||(s[1]=o=>i.value=o),animated:""},{default:c(()=>[e(O,{name:"wrapping"},{default:c(()=>[a("div",al,[e(ce,{"as-tabs":"true",class:"col"})]),e(el)]),_:1}),e(O,{name:"manage",class:"row q-gutter-x-md"},{default:c(()=>{var o;return[e(pt,{class:"col-3"}),(o=m(r)().groupSelected)!=null&&o.account?(v(),V(Aa,{key:0,class:"col"})):P("",!0)]}),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{ql as default};
