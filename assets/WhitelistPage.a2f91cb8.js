import{Q as A,a as g,b as R}from"./QInput.7ac568a2.js";import{a as S,Q as U}from"./QList.a7e4ae39.js";import{Q as b,a as E}from"./QTabPanels.01bb489b.js";import{Q as L}from"./QPage.fa79ed5f.js";import{cp as h,cP as k,au as y,J as d,b1 as m,ak as v,as as e,bx as o,ar as f,ck as V,P as _,cQ as j,cR as N,cS as x,cT as $,aX as C,a6 as B,b7 as P,bz as K,ai as Q,a1 as I,ah as z,aj as J}from"./index.a4fb67a3.js";import{m as T,n as D,l as F}from"./use-key-composition.bc98317d.js";import{Q as M}from"./QBtnDropdown.10f3431a.js";import{C as q}from"./ClosePopup.e13f83fc.js";import{Q as X}from"./QTree.0f80d1e1.js";import"./touch.3df10340.js";import"./QSlideTransition.7b51e6cc.js";function W(){h().publicKey.value||k.create({color:"yellow",message:"Wallet not connected!",timeout:5e3})}const H={class:"row q-gutter-x-md"},Y=y({__name:"CreateWhitelist",setup(w){const l=d("My new whitelist");async function u(){W();const{pg_whitelist:n}=$();let[a,i]=_.findProgramAddressSync([h().publicKey.value.toBytes(),j(l.value)],n.value.programId);try{const r=await n.value.methods.initialize(l.value).accounts({whitelist:a,systemProgram:N.programId}).rpc();console.log(r),await x(r)}catch(r){k.create({color:"red",message:`${r}`,timeout:5e3})}}return(n,a)=>(m(),v("div",H,[e(A,{class:"col",modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=i=>l.value=i)},null,8,["modelValue"]),e(V,{color:"primary",onClick:a[1]||(a[1]=i=>u())},{default:o(()=>[f("Create")]),_:1})]))}}),G={class:"row q-gutter-x-md"},O=y({__name:"AddAddressToWhitelist",setup(w){const{pg_whitelist:l}=$(),u=d(""),n=d(),a=d();C(async()=>{n.value=await l.value.account.whitelist.all()});async function i(){W();const r=new _(a.value.publicKey.toString()),[s,c]=_.findProgramAddressSync([new _(u.value).toBytes(),r.toBytes()],l.value.programId);try{const t=new _(u.value),p=await l.value.methods.addToWhitelist(t).accounts({entry:s,whitelist:r,authority:h().publicKey.value,systemProgram:N.programId}).rpc();console.log(p),await x(p)}catch(t){k.create({color:"red",message:`${t}`,timeout:5e3})}}return(r,s)=>{var c;return m(),v("div",G,[e(M,{color:"primary",label:((c=a.value)==null?void 0:c.account.name)??"please select a whitelist"},{default:o(()=>[e(S,null,{default:o(()=>[(m(!0),v(B,null,P(n.value,t=>K((m(),Q(F,{clickable:"",key:t,onClick:p=>a.value=t},{default:o(()=>[e(T,null,{default:o(()=>[e(D,null,{default:o(()=>[f(I(t==null?void 0:t.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[q]])),128))]),_:1})]),_:1},8,["label"]),e(A,{class:"col",outlined:"",modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=t=>u.value=t),label:"Address to be added"},null,8,["modelValue"]),e(V,{color:"primary",onClick:s[1]||(s[1]=t=>i())},{default:o(()=>[f("Add")]),_:1})])}}}),Z={class:"row q-gutter-x-md"},ee=y({__name:"ViewWhitelist",setup(w){const l=d(),u=d();C(async()=>{const{pg_whitelist:a}=$();l.value=await a.value.account.whitelist.all(),u.value=await a.value.account.whitelistEntry.all()});const n=z(()=>{var a;return(a=l==null?void 0:l.value)==null?void 0:a.map(i=>{var r,s;return{label:`${i.account.name} | ${i.publicKey.toString()}`,children:(s=(r=u.value)==null?void 0:r.filter(c=>c.account.parent.toString()===i.publicKey.toString()))==null?void 0:s.flatMap(c=>({label:`Member: ${c.account.whitelisted.toString()}  |  Account: ${c.publicKey.toString()} `}))}})});return(a,i)=>(m(),v("div",Z,[n.value?(m(),Q(X,{key:0,nodes:n.value,"node-key":"label","selected-color":"primary","default-expand-all":""},null,8,["nodes"])):J("",!0)]))}}),te={class:"row q-gutter-x-md"},ae=y({__name:"RemoveAddressFromWhitelist",setup(w){const{pg_whitelist:l}=$(),u=d(""),n=d(),a=d();C(async()=>{n.value=await l.value.account.whitelist.all()});async function i(){W();const r=new _(a.value.publicKey),[s,c]=_.findProgramAddressSync([new _(u.value).toBytes(),r.toBytes()],l.value.programId);try{console.log(l.value.methods);const t=new _(u.value),p=await l.value.methods.removeFromWhitelist(t).accounts({entry:s,whitelist:r,authority:h().publicKey.value}).rpc();console.log(p),await x(p)}catch(t){k.create({color:"red",message:`${t}`,timeout:5e3})}}return(r,s)=>{var c;return m(),v("div",te,[e(M,{color:"primary",label:((c=a.value)==null?void 0:c.account.name)??"please select a whitelist"},{default:o(()=>[e(S,null,{default:o(()=>[(m(!0),v(B,null,P(n.value,t=>K((m(),Q(F,{clickable:"",key:t,onClick:p=>a.value=t},{default:o(()=>[e(T,null,{default:o(()=>[e(D,null,{default:o(()=>[f(I(t==null?void 0:t.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[q]])),128))]),_:1})]),_:1},8,["label"]),e(A,{class:"col",outlined:"",modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=t=>u.value=t),label:"Address to be removed"},null,8,["modelValue"]),e(V,{color:"primary",onClick:s[1]||(s[1]=t=>i())},{default:o(()=>[f("Remove")]),_:1})])}}}),le={class:"row q-gutter-x-md"},oe=y({__name:"DeleteWhitelist",setup(w){const{pg_whitelist:l}=$(),u=d("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),n=d(),a=d();C(async()=>{n.value=await l.value.account.whitelist.all()});async function i(){W();const r=new _(a.value.publicKey);_.findProgramAddressSync([new _(u.value).toBytes(),r.toBytes()],l.value.programId);try{const s=await l.value.methods.deleteWhitelist(a.value.account.name).accounts({whitelist:r,authority:h().publicKey.value}).rpc();console.log(s),await x(s)}catch(s){k.create({color:"red",message:`${s}`,timeout:5e3})}}return(r,s)=>{var c;return m(),v("div",le,[e(M,{color:"primary",label:((c=a.value)==null?void 0:c.account.name)??"please select a whitelist"},{default:o(()=>[e(S,null,{default:o(()=>[(m(!0),v(B,null,P(n.value,t=>K((m(),Q(F,{clickable:"",key:t,onClick:p=>a.value=t},{default:o(()=>[e(T,null,{default:o(()=>[e(D,null,{default:o(()=>[f(I(t==null?void 0:t.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[q]])),128))]),_:1})]),_:1},8,["label"]),e(V,{color:"primary",onClick:s[0]||(s[0]=t=>i())},{default:o(()=>[f("Delete")]),_:1})])}}}),fe=y({__name:"WhitelistPage",setup(w){const l=d("view");return(u,n)=>(m(),Q(L,{class:"col text-center"},{default:o(()=>[e(R,{"no-caps":"","outside-arrows":"","mobile-arrows":"",modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=a=>l.value=a),class:"shadow-2 bg-dark",align:"justify"},{default:o(()=>[e(g,{name:"create",label:"Create Whitelist"}),e(g,{name:"add",label:"Add Address to Whitelist"}),e(g,{name:"remove",label:"Remove address from Whitelist"}),e(g,{name:"delete",label:"Delete Whitelist"}),e(g,{name:"view",label:"View "})]),_:1},8,["modelValue"]),e(U),e(E,{dark:"",modelValue:l.value,"onUpdate:modelValue":n[1]||(n[1]=a=>l.value=a),animated:""},{default:o(()=>[e(b,{name:"create"},{default:o(()=>[e(Y)]),_:1}),e(b,{name:"add"},{default:o(()=>[e(O)]),_:1}),e(b,{name:"remove"},{default:o(()=>[e(ae)]),_:1}),e(b,{name:"delete"},{default:o(()=>[e(oe)]),_:1}),e(b,{name:"view"},{default:o(()=>[e(ee)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{fe as default};
