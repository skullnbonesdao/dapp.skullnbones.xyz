import{cM as $e,dj as Q,P as L,au as U,cj as T,J as m,b1 as b,ak as C,as as e,bV as be,ck as M,d9 as N,ai as V,V as w,bx as c,al as t,a1 as S,aj as q,bs as te,da as D,dq as X,b7 as ye,a6 as he,cm as ce,d0 as J,dg as K,aX as xe,ah as Ve,b9 as Ue,cn as Y,cN as se,d$ as ke,eh as We}from"./index.c6ca1f90.js";import{Q as k,a as x}from"./QInput.fa31dd95.js";import{Q as I}from"./QSeparator.adbe345b.js";import{a as j,Q as ue}from"./QTabs.0d18b9d5.js";import{Q as P}from"./QCard.9bc6fa26.js";import{a as F,Q as _e}from"./QTabPanels.abf14abe.js";import{Q as Ae}from"./QPage.31c2f50c.js";import{Q as ve}from"./QSlideTransition.545fc03e.js";import{g as W,h as O}from"./handleTransaction.e3b1a93c.js";import{Q as re}from"./QSelect.41903ec2.js";import{c as de,Q as ne}from"./calcAmountToTransfer.40dcaf82.js";import{Q as Ce}from"./QList.772213fa.js";import{Q as G}from"./QToggle.24cf7629.js";import{a as me,b as ie,c as qe,d as ee,f as H,s as Pe}from"./WrapperInterface.645dbc7d.js";import{Q as Te}from"./QImg.bbaa1a69.js";import{Q as ge}from"./QCardActions.754023e1.js";import{f as Ie,a as Ke}from"./format_address.e23e3ede.js";import{U as Qe}from"./constants.e2ffd8e4.js";import{c as Me}from"./associatedTokenAccount.36bd3d0b.js";import"./rtl.a88e20be.js";import"./touch.3df10340.js";import"./use-checkbox.08ae2b4e.js";import"./SquadsStore.78a954bd.js";import"./pda.386d6c74.js";import"./cusper.a8a21f48.js";import"./assert.6afcd24c.js";import"./vaultTransactionCreate.deafa28a.js";import"./token.2f5b83f8.js";let Le;const fe=()=>Le,s=$e("wrapperStore",{state:()=>({wrapperSelected:{},groupSelected:{},wrapper:[],groups:[]}),getters:{},actions:{async updateStore(){if(Q()){const{pg_wrapper:h}=Q();this.groups=await h.value.account.group.all(),this.wrapper=await h.value.account.wrapper.all(),this.groupSelected||(this.groupSelected=this.groups[0]),console.log("[Updated] WrapperStore")}}}}),Ne=new L("subA4tNLV18htV8xACaZyMMKkAm1AQS4EhiPYPV4zbH"),Oe={class:"row"},Be=U({__name:"WrapperCreateGroup",setup(h){const u=T(),p=m("");async function r(){try{const l=new N,a=Q().pg_wrapper.value;if(p.value==""){u.notify({message:"Invalid group name",color:"info",position:"bottom-right"});return}l.add(await a.methods.initializeGroup(p.value).accountsPartial({signer:W(),fee:Ne}).instruction()),await O(l,"[Raffle] create new group"),await s().updateStore()}catch(l){u.notify({message:l.message,type:"negative"})}}return(l,a)=>(b(),C("div",Oe,[e(k,{square:"",filled:"",class:"col",modelValue:p.value,"onUpdate:modelValue":a[0]||(a[0]=n=>p.value=n),label:"New group name",type:"text"},null,8,["modelValue"]),e(M,{square:"",onClick:a[1]||(a[1]=be(n=>r(),["prevent"])),color:"primary",label:"Create"})]))}}),we=U({__name:"WrapperGroupSelect",setup(h){return(u,p)=>(b(),V(re,{label:"Select a group",square:"",filled:"",modelValue:w(s)().groupSelected,"onUpdate:modelValue":p[0]||(p[0]=r=>w(s)().groupSelected=r),options:w(s)().groups,"option-label":r=>{var l;return(l=r==null?void 0:r.account)==null?void 0:l.name}},null,8,["modelValue","options","option-label"]))}}),Ee=U({__name:"WrapperCloseGroup",props:{disabled:{default:!0}},setup(h){const u=T();async function p(){try{const r=new N,l=Q().pg_wrapper.value;r.add(await l.methods.closeGroup().accountsPartial({group:s().groupSelected.publicKey,signer:W()}).instruction()),await O(r,"Close Group"),await s().updateStore()}catch(r){u.notify({message:r.message,type:"negative"})}}return(r,l)=>(b(),V(M,{disable:h.disabled,square:"",color:"primary",label:"Close",onClick:l[0]||(l[0]=be(a=>p(),["prevent"]))},null,8,["disable"]))}}),Re=t("div",{class:"text-h5"},"Group",-1),Ge=t("div",{class:"text-caption text-grey"}," The group will be used to filter and create the wrappers - one time creation fee of 0.5 SOL ",-1),je=t("div",{class:"text-caption text-accent"}," Make sure u use a list where you are the owner! ",-1),ze={key:0,class:"text-caption row"},De=t("div",{style:{width:"50px"}},"ID",-1),Fe={class:"col text-right"},Xe={key:1,class:"text-caption row"},Ze=t("div",{style:{width:"50px"}},"Owner",-1),Je={class:"col text-accent text-right"},He={class:"row"},Ye={key:0,class:"text-caption row"},et=t("div",{style:{width:"50px"}},"ID:",-1),tt={class:"col text-accent text-right"},at={key:1,class:"text-caption row"},lt=t("div",{style:{width:"50px"}},"Owner:",-1),ot={class:"col text-accent text-right"},nt=t("div",{class:"text-h6 text-red-6 col"}," I know what im doing i want to close the group ",-1),st=U({__name:"WrapperGroupView",setup(h){const u=m("select"),p=m(!1);return(r,l)=>(b(),V(P,{flat:"",bordered:""},{default:c(()=>[e(x,null,{default:c(()=>[Re,Ge,je]),_:1}),e(I),e(ue,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=a=>u.value=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[e(j,{name:"select",label:"Select"}),e(j,{name:"create",label:"Create"}),e(j,{name:"close",label:"Close"})]),_:1},8,["modelValue"]),e(I),e(_e,{modelValue:u.value,"onUpdate:modelValue":l[2]||(l[2]=a=>u.value=a),animated:""},{default:c(()=>[e(F,{name:"create"},{default:c(()=>[e(Be)]),_:1}),e(F,{name:"select"},{default:c(()=>[e(we,{class:""}),e(x,null,{default:c(()=>{var a,n,o,d,_;return[(a=w(s)().groupSelected)!=null&&a.account?(b(),C("div",ze,[De,t("div",Fe,S((n=w(s)().groupSelected)==null?void 0:n.publicKey),1)])):q("",!0),(o=w(s)().groupSelected)!=null&&o.account?(b(),C("div",Xe,[Ze,t("div",Je,S((_=(d=w(s)().groupSelected)==null?void 0:d.account)==null?void 0:_.owner),1)])):q("",!0)]}),_:1})]),_:1}),e(F,{name:"close"},{default:c(()=>[t("div",He,[e(we,{class:"col"}),e(Ee,{disabled:!p.value},null,8,["disabled"])]),e(x,null,{default:c(()=>{var a,n,o,d,_;return[(a=w(s)().groupSelected)!=null&&a.account?(b(),C("div",Ye,[et,t("div",tt,S((n=w(s)().groupSelected)==null?void 0:n.publicKey),1)])):q("",!0),(o=w(s)().groupSelected)!=null&&o.account?(b(),C("div",at,[lt,t("div",ot,S((_=(d=w(s)().groupSelected)==null?void 0:d.account)==null?void 0:_.owner),1)])):q("",!0)]}),_:1}),e(x,{class:"row items-center"},{default:c(()=>[e(ve,{color:"red",modelValue:p.value,"onUpdate:modelValue":l[1]||(l[1]=a=>p.value=a)},null,8,["modelValue"]),nt]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),rt={class:"row items-center"},it=t("div",{class:"col text-h6"},"Unwrapped Token",-1),ct={class:"row items-center"},ut=t("div",{class:"col text-right q-mr-md text-subtitle2"},"Filter:",-1),dt={class:"row q-gutter-x-md items-center"},pt=t("div",{class:"text-h6"},"Wrapped Token",-1),mt={class:"row q-gutter-x-md items-center"},wt=t("div",{class:"text-h6"},"Ratio",-1),_t={class:"row q-gutter-x-md items-center"},vt={class:"row items-center"},ft=t("div",{class:"text-h6"},"Add Medata",-1),gt={key:0,class:"row items-center q-gutter-x-sm"},bt=U({__name:"WrapperCreate",setup(h){const u=T(),p=m(["list","address"]),r=m("list"),l=m(),a=m(9),n=m(1),o=m(1),d=m(!0),_=m(""),f=m(""),$=m("");async function A(){var E;try{const g=new N,i=Q().pg_wrapper.value,v=new J(window.crypto.getRandomValues(new Uint8Array(8))),y={ratio:[new J(n.value),new J(o.value)],onlyCreatorCanWrap:!1,onlyCreatorCanUnwrap:!1,wrappedDecimals:a.value,seed:v},R=new L(l.value.mint.toString());if(g.add(await i.methods.initialize(y).accountsPartial({signer:W(),group:new L(((E=s().groupSelected)==null?void 0:E.publicKey.toString())??""),mintUnwrapped:R,tokenProgram:K}).instruction()),g.add(await i.methods.createVault().accountsPartial({signer:W(),wrapper:me(R,W()),vaultUnwrappedAta:ie(me(R,W()),R),mintUnwrapped:R,tokenProgram:K}).instruction()),d.value){const pe={name:_.value,symbol:f.value,uri:$.value},le=me(R,W()),Z=qe(le,v),oe=ee(Z);g.add(await i.methods.metadataCreate(pe).accountsPartial({signer:W(),wrapper:le,mintWrapped:Z,mintUnwrapped:R,metadata:oe,tokenProgram:K}).instruction())}await O(g,`[Wrapper] create + vault ${d.value?"+ metadata":""}`),await s().updateStore()}catch(g){console.error(g),u.notify({message:g.message,type:"negative",position:"bottom-right"})}}const B=m(z());te(()=>r.value,()=>B.value=z());function z(){var E;return r.value=="list"?D().tokenList.map(g=>({name:g.name,symbol:g.symbol,mint:g.address})):(E=X().getAccountsBalanceNotZero)==null?void 0:E.map(g=>{var i,v;return{name:(i=g.info)==null?void 0:i.name,symbol:(v=g.info)==null?void 0:v.symbol,mint:g.mint}})}function ae(E,g,i){g(()=>{const v=E.toLowerCase();B.value=z().filter(y=>JSON.stringify(y).toLowerCase().indexOf(v)>-1)})}return(E,g)=>(b(),V(P,{flat:""},{default:c(()=>[e(x,{class:""},{default:c(()=>[t("div",rt,[it,t("div",ct,[ut,e(ue,{dense:"",modelValue:r.value,"onUpdate:modelValue":g[0]||(g[0]=i=>r.value=i),class:"text-teal"},{default:c(()=>[(b(!0),C(he,null,ye(p.value,i=>(b(),V(j,{name:i,label:i,key:i},null,8,["name","label"]))),128))]),_:1},8,["modelValue"])])]),t("div",dt,[e(re,{filled:"",square:"",class:"col","use-input":"","hide-selected":"","fill-input":"",onFilter:ae,options:B.value,"option-label":i=>i.name?`[${i.symbol}] ${i.name}`:i.mint,modelValue:l.value,"onUpdate:modelValue":g[1]||(g[1]=i=>l.value=i),label:"Token to Wrap"},null,8,["options","option-label","modelValue"])])]),_:1}),e(x,null,{default:c(()=>[pt,t("div",mt,[e(k,{square:"",filled:"",class:"col",modelValue:a.value,"onUpdate:modelValue":g[2]||(g[2]=i=>a.value=i),label:"Decimals",type:"number"},null,8,["modelValue"])])]),_:1}),e(x,null,{default:c(()=>[wt,t("div",_t,[e(k,{square:"",filled:"",class:"col",modelValue:n.value,"onUpdate:modelValue":g[3]||(g[3]=i=>n.value=i),label:"Unwrapped",type:"number"},null,8,["modelValue"]),e(ce,{name:"swap_horiz",size:"xl  "}),e(k,{square:"",filled:"",class:"col",modelValue:o.value,"onUpdate:modelValue":g[4]||(g[4]=i=>o.value=i),label:"Wrapped",type:"number"},null,8,["modelValue"])])]),_:1}),e(x,null,{default:c(()=>[t("div",vt,[ft,e(G,{modelValue:d.value,"onUpdate:modelValue":g[5]||(g[5]=i=>d.value=i),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),d.value?(b(),C("div",gt,[e(k,{square:"",filled:"",class:"col",modelValue:_.value,"onUpdate:modelValue":g[6]||(g[6]=i=>_.value=i),label:"Name",type:"text"},null,8,["modelValue"]),e(k,{square:"",filled:"",class:"col",modelValue:f.value,"onUpdate:modelValue":g[7]||(g[7]=i=>f.value=i),label:"Symbol",type:"text"},null,8,["modelValue"]),e(k,{square:"",filled:"",class:"col",modelValue:$.value,"onUpdate:modelValue":g[8]||(g[8]=i=>$.value=i),label:"Image-URI",type:"text"},null,8,["modelValue"])])):q("",!0)]),_:1}),e(x,{class:"row justify-end"},{default:c(()=>[e(M,{square:"",color:"primary",label:"Create new wrapper",onClick:g[9]||(g[9]=i=>A())})]),_:1})]),_:1}))}}),yt={class:"row items-center"},ht=t("div",{class:"col text-subtitle1 text-weight-thin"},"Publickey",-1),xt={class:"text-subtitle2"},Vt={class:"col text-subtitle1 text-weight-thin"},St={key:0,class:"text-subtitle2"},$t={key:1,class:"text-subtitle2"},Ut=U({__name:"WrapperInfo",setup(h){return(u,p)=>{var r;return(r=w(s)().wrapperSelected)!=null&&r.account?(b(),V(P,{key:0,flat:""},{default:c(()=>[e(I),e(x,null,{default:c(()=>{var l;return[t("div",yt,[ht,t("div",xt,S(w(s)().wrapperSelected.publicKey),1)]),(b(!0),C(he,null,ye(Object.keys((l=w(s)().wrapperSelected)==null?void 0:l.account),a=>(b(),C("div",{key:a,class:"row items-center"},[t("div",Vt,S(a.toUpperCase()),1),a=="ratio"?(b(),C("div",St,S(w(s)().wrapperSelected.account[a][0])+" : "+S(w(s)().wrapperSelected.account[a][1]),1)):(b(),C("div",$t,S(w(s)().wrapperSelected.account[a]),1))]))),128))]}),_:1})]),_:1})):q("",!0)}}}),kt=U({__name:"WrapperClose",props:{disabled:{default:!0}},setup(h){const u=T();async function p(){var r,l;try{const a=new N,n=Q().pg_wrapper.value;a.add(await n.methods.close().accountsPartial({wrapper:(r=s().wrapperSelected)==null?void 0:r.publicKey,signer:W(),mintUnwrapped:(l=s().wrapperSelected)==null?void 0:l.account.mintUnwrapped,tokenProgram:K}).instruction()),await O(a,"[Wrapper] Close"),await s().updateStore()}catch(a){console.error(a),u.notify({message:a.message,type:"negative"})}}return(r,l)=>(b(),V(M,{disable:h.disabled,square:"",color:"primary",label:"Close WrapperInterface",onClick:l[0]||(l[0]=a=>p())},null,8,["disable"]))}}),Wt={class:"row items-center"},At=t("div",{class:"col text-subtitle1"},"Allow wrap",-1),Ct={class:"row items-center"},qt=t("div",{class:"col text-subtitle1"},"Allow unwrap",-1),Pt={class:"row items-center"},Tt=t("div",{class:"col text-subtitle1"},"Only admin can Wrap",-1),It={class:"row items-center"},Kt=t("div",{class:"col text-subtitle1"},"Only admin can unwrap",-1),Qt={class:"row items-center"},Mt=t("div",{class:"col text-subtitle1"},"Use whitelist",-1),Lt={class:"row items-center"},Nt=t("div",{class:"col text-subtitle1"},"Use Limit",-1),Ot={class:"row items-center"},Bt=t("div",{class:"col text-subtitle1"},"Change Admin",-1),Et={class:"row items-center"},Rt=t("div",{class:"col text-subtitle1"},"Change Ratio",-1),Gt={key:0,style:{width:"500px"},class:"row items-center"},jt=U({__name:"WrapperSettings",setup(h){var g;const u=T();(g=s().wrapperSelected)==null||g.account;const p=m(),r=m(),l=m(),a=m(),n=m(),o=m(),d=m(),_=m(),f=m(!1),$=m(),A=m(!1),B=m(),z=m();ae(),te(()=>{var i,v;return(v=(i=s())==null?void 0:i.wrapperSelected)==null?void 0:v.account},()=>{ae()});function ae(){var v,y;if(!((v=s().wrapperSelected)!=null&&v.account))return;const i=(y=s().wrapperSelected)==null?void 0:y.account;p.value=i.allowWrap,r.value=i==null?void 0:i.allowUnwrap,l.value=i==null?void 0:i.onlyAdminCanWrap,a.value=i==null?void 0:i.onlyAdminCanUnwrap,n.value=i==null?void 0:i.useWhitelist,o.value=i==null?void 0:i.whitelist,d.value=i==null?void 0:i.useLimit,_.value=(i==null?void 0:i.limitAmountUnwrapped)??0,$.value=i==null?void 0:i.admin,B.value=i==null?void 0:i.ratio[0],z.value=i==null?void 0:i.ratio[1]}async function E(){var i,v;try{const y=new N,R=Q().pg_wrapper.value,pe={allowWrap:p.value,allowUnwrap:r.value,onlyAdminCanWrap:l.value,onlyAdminCanUnwrap:a.value,useWhitelist:n.value,whitelistAddress:n.value?new L(o.value):null,useLimit:d.value,amountAbleToWrap:d.value?de(_.value,D().tokenList.find(le=>{var Z,oe;return le.address==((oe=(Z=s().wrapperSelected)==null?void 0:Z.account)==null?void 0:oe.mintUnwrapped.toString())}).decimals):null,admin:f.value?new L($.value):null,ratio:A.value?[new J(B.value),new J(z.value)]:null};y.add(await R.methods.edit(pe).accountsPartial({wrapper:(i=s().wrapperSelected)==null?void 0:i.publicKey,signer:W(),mintUnwrapped:(v=s().wrapperSelected)==null?void 0:v.account.mintUnwrapped,whitelist:null,tokenProgram:K}).instruction()),await O(y),await s().updateStore()}catch(y){console.error(y),u.notify({message:y.message,type:"negative"})}}return(i,v)=>(b(),V(P,{flat:""},{default:c(()=>[e(x,{class:"q-gutter-y-sm"},{default:c(()=>[t("div",Wt,[At,e(G,{modelValue:p.value,"onUpdate:modelValue":v[0]||(v[0]=y=>p.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",Ct,[qt,e(G,{modelValue:r.value,"onUpdate:modelValue":v[1]||(v[1]=y=>r.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",Pt,[Tt,e(G,{modelValue:l.value,"onUpdate:modelValue":v[2]||(v[2]=y=>l.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",It,[Kt,e(G,{modelValue:a.value,"onUpdate:modelValue":v[3]||(v[3]=y=>a.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",Qt,[Mt,n.value?(b(),V(k,{key:0,dense:"",filled:"",square:"",style:{width:"500px"},modelValue:o.value,"onUpdate:modelValue":v[4]||(v[4]=y=>o.value=y),type:"text",label:"Whitelist"},null,8,["modelValue"])):q("",!0),e(G,{modelValue:n.value,"onUpdate:modelValue":v[5]||(v[5]=y=>n.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",Lt,[Nt,d.value?(b(),V(k,{key:0,dense:"",filled:"",square:"",style:{width:"500px"},modelValue:_.value,"onUpdate:modelValue":v[6]||(v[6]=y=>_.value=y),type:"number",label:"Amount wrappable"},null,8,["modelValue"])):q("",!0),e(G,{modelValue:d.value,"onUpdate:modelValue":v[7]||(v[7]=y=>d.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",null,[t("div",Ot,[Bt,f.value?(b(),V(k,{key:0,style:{width:"500px"},dense:"",filled:"",square:"",label:"Admin",modelValue:$.value,"onUpdate:modelValue":v[8]||(v[8]=y=>$.value=y)},null,8,["modelValue"])):q("",!0),e(G,{modelValue:f.value,"onUpdate:modelValue":v[9]||(v[9]=y=>f.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])])]),t("div",null,[t("div",Et,[Rt,A.value?(b(),C("div",Gt,[e(k,{class:"col",dense:"",filled:"",square:"",label:"Unwrapped",modelValue:B.value,"onUpdate:modelValue":v[10]||(v[10]=y=>B.value=y),type:"number"},null,8,["modelValue"]),e(ce,{size:"md",name:"swap_horiz"}),e(k,{class:"col",dense:"",filled:"",square:"",label:"Wrapped",modelValue:z.value,"onUpdate:modelValue":v[11]||(v[11]=y=>z.value=y),type:"number"},null,8,["modelValue"])])):q("",!0),e(G,{modelValue:A.value,"onUpdate:modelValue":v[12]||(v[12]=y=>A.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])])])]),_:1}),e(x,{class:"row justify-end"},{default:c(()=>[e(M,{square:"",class:"",color:"primary",label:"Update settings",onClick:v[13]||(v[13]=y=>E())})]),_:1})]),_:1}))}}),zt=U({__name:"WrapperCreateVault",setup(h){const u=T(),p=m(!1);async function r(l){try{const a=new N,n=fe().pg_wrapper.value;a.add(await n.methods.createVault().accountsPartial({wrapper:new L(s().wrapperSelected.publicKey.toString()),signer:W(),mintUnwrapped:new L(s().wrapperSelected.account.mintUnwrapped.toString()),tokenProgram:K}).instruction()),await O(a,"[Wrapper] create vault")}catch(a){console.error(a),u.notify({message:a.message,type:"negative"})}}return(l,a)=>{var n;return!p.value&&((n=w(s)().wrapperSelected)==null?void 0:n.publicKey)?(b(),V(M,{key:0,square:"",color:"primary",label:"Create Vault",onClick:a[0]||(a[0]=o=>r())})):q("",!0)}}}),Se=U({__name:"WrapperVaultDonut",props:["wrapper"],setup(h){const u=h,p=m(0),r=m(0);async function l(){p.value=await a()*u.wrapper.account.ratio[0],r.value=await n()*u.wrapper.account.ratio[1]}async function a(){return(await Y().connection.getTokenSupply(new L(u.wrapper.account.mintWrapped))).value.uiAmount}async function n(){let _=ie(u.wrapper.publicKey,u.wrapper.account.mintUnwrapped);return(await Y().connection.getTokenAccountBalance(_)).value.uiAmount}xe(async()=>{await l()});const o=Ve(()=>[r.value,p.value]),d=m({dataLabels:{enabled:!1},legend:{labels:{colors:"white"},show:!0,position:"bottom"},theme:{palette:"palette3"},labels:["Vault","Circ. Supply"]});return(_,f)=>{const $=Ue("apexchart");return b(),V($,{height:"200px",type:"donut",options:d.value,series:o.value},null,8,["options","series"])}}}),Dt={class:"text-subtitle2 row items-center"},Ft=t("div",{class:"text-accent"}," I want to transfer tokens out of the vault to a new address ",-1),Xt={class:"col"},Zt={class:"row"},Jt=U({__name:"WrapperTransferVaultOut",setup(h){const u=T(),p=m(1),r=m("C6LnFVyc5Qj2LAPdkX5CyyEEga9ePPB6ZRuzGhirZnqX"),l=m(!1);async function a(){try{if(Q()){const n=new N,o=Q().pg_wrapper.value;n.add(await o.methods.transferVault(de(p.value,X().getAccountByMintPublicKey(s().wrapperSelected.account.mintUnwrapped).decimals)).accountsPartial({signer:W(),wrapper:s().wrapperSelected.publicKey,mintUnwrapped:s().wrapperSelected.account.mintUnwrapped,ataUnwrappedSigner:H(new L(r.value).toString(),s().wrapperSelected.account.mintUnwrapped.toString()),tokenProgram:K}).instruction()),await O(n,`[Wrapper] transfer to ${r.value}`),await s().updateStore()}}catch(n){console.error(n),u.notify({message:n.message,type:"negative"})}}return(n,o)=>(b(),V(P,{flat:""},{default:c(()=>[t("div",Dt,[e(ve,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=d=>l.value=d)},null,8,["modelValue"]),Ft]),t("div",Xt,[t("div",Zt,[e(k,{class:"col",disable:!l.value,square:"",filled:"",modelValue:r.value,"onUpdate:modelValue":o[1]||(o[1]=d=>r.value=d),type:"text",label:"recipient"},null,8,["disable","modelValue"]),e(I,{vertical:""}),e(k,{disable:!l.value,square:"",filled:"",modelValue:p.value,"onUpdate:modelValue":o[2]||(o[2]=d=>p.value=d),type:"number",label:"Amount to transfer"},null,8,["disable","modelValue"]),e(M,{disable:!p.value||!r.value||!l.value,color:"primary",label:"Send",square:"",onClick:o[3]||(o[3]=d=>a())},null,8,["disable"])])])]),_:1}))}}),Ht={class:"row items-center"},Yt=t("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),ea={class:"text-subtitle2"},ta={class:"row items-center"},aa=t("div",{class:"col text-subtitle1 text-weight-thin"},"Mint",-1),la={class:"text-subtitle2"},oa={class:"row items-center"},na=t("div",{class:"col text-subtitle1 text-weight-thin"},"Unwrapped",-1),sa={class:"text-subtitle2"},ra={class:"row items-center"},ia=t("div",{class:"col text-subtitle1 text-weight-thin"},"Balance",-1),ca={class:"text-subtitle2"},ua=U({__name:"WrapperVault",setup(h){T();const u=m(null),p=m(!1);r(),te(()=>{var l,a;return(a=(l=s())==null?void 0:l.wrapperSelected)==null?void 0:a.account},async()=>{await r()});async function r(){var l;u.value=(l=(await Y().connection.getParsedAccountInfo(ie(s().wrapperSelected.publicKey,s().wrapperSelected.account.mintUnwrapped))).value)==null?void 0:l.data,u.value&&(p.value=!0)}return(l,a)=>(b(),V(P,{flat:""},{default:c(()=>[e(I),e(x,{class:"col"},{default:c(()=>{var n,o;return[t("div",Ht,[Yt,t("div",ea,S(w(ie)(w(s)().wrapperSelected.publicKey,w(s)().wrapperSelected.account.mintUnwrapped)),1)]),t("div",ta,[aa,t("div",la,S((n=w(s)().wrapperSelected.account)==null?void 0:n.mintUnwrapped),1)]),t("div",oa,[na,t("div",sa,S(w(D)().getTokenByMintPublicKey(w(s)().wrapperSelected.account.mintUnwrapped).name),1)]),t("div",ra,[ia,t("div",ca,S((o=u.value)==null?void 0:o.parsed.info.tokenAmount.uiAmount),1)])]}),_:1}),e(x,null,{default:c(()=>[e(Se,{wrapper:w(s)().wrapperSelected},null,8,["wrapper"])]),_:1}),e(x,{class:"q-gutter-y-md"},{default:c(()=>[p.value?q("",!0):(b(),V(zt,{key:0,class:"full-width"})),e(Jt)]),_:1})]),_:1}))}}),da=U({__name:"WrapperMetadataUpdate",props:["name","symbol","uri"],setup(h){const u=h,p=T();async function r(l){var a,n;try{const o=new N,d=fe().pg_wrapper.value,_={name:u.name,symbol:u.symbol,uri:u.uri};o.add(await d.methods.metadataUpdate(_).accountsPartial({wrapper:(a=s().wrapperSelected)==null?void 0:a.publicKey,signer:W(),metadata:ee(s().wrapperSelected.account.mintWrapped),mintUnwrapped:(n=s().wrapperSelected)==null?void 0:n.account.mintUnwrapped,tokenProgram:K}).instruction()),await O(o,"[Wrapper] metadata update"),await s().updateStore()}catch(o){console.error(o),p.notify({message:o.message,type:"negative"})}}return(l,a)=>(b(),V(M,{square:"",color:"primary",label:"Apply Metadata",onClick:a[0]||(a[0]=n=>r())}))}}),pa=U({__name:"WrapperMetadataCreate",props:["name","symbol","uri"],setup(h){const u=h,p=T();async function r(l){var a,n;try{const o=new N,d=fe().pg_wrapper.value,_={name:u.name,symbol:u.symbol,uri:u.uri};o.add(await d.methods.metadataCreate(_).accountsPartial({wrapper:(a=s().wrapperSelected)==null?void 0:a.publicKey,signer:W(),metadata:ee(s().wrapperSelected.account.mintWrapped),mintUnwrapped:(n=s().wrapperSelected)==null?void 0:n.account.mintUnwrapped,tokenProgram:K}).instruction()),await O(o,"[Wrapper] metadata create"),await s().updateStore()}catch(o){console.error(o),p.notify({message:o.message,type:"negative"})}}return(l,a)=>(b(),V(M,{square:"",color:"primary",label:"Create Metadata",onClick:a[0]||(a[0]=n=>r())}))}}),ma={class:"row items-center"},wa=t("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),_a={class:"text-subtitle2"},va={class:"row"},fa=U({__name:"WrapperMetadata",setup(h){T();const u=m(""),p=m(""),r=m(""),l=m(),a=m(),n=m(!1);o(),te(()=>{var d,_;return(_=(d=s())==null?void 0:d.wrapperSelected)==null?void 0:_.account},async()=>{await o()});async function o(){l.value=await Y().connection.getAccountInfo(ee(s().wrapperSelected.account.mintWrapped)),a.value=Pe.deserializeMetadata(l.value),u.value=a.value.name,p.value=a.value.symbol,r.value=a.value.uri,l.value&&(n.value=!0)}return(d,_)=>(b(),V(P,{flat:""},{default:c(()=>[e(x,null,{default:c(()=>[t("div",ma,[wa,t("div",_a,S(w(ee)(w(s)().wrapperSelected.publicKey)),1)])]),_:1}),n.value?(b(),V(x,{key:0,class:"col"},{default:c(()=>[t("div",va,[e(k,{square:"",label:"Name",filled:"",modelValue:u.value,"onUpdate:modelValue":_[0]||(_[0]=f=>u.value=f)},null,8,["modelValue"]),e(I,{vertical:""}),e(k,{square:"",label:"Symbol",filled:"",modelValue:p.value,"onUpdate:modelValue":_[1]||(_[1]=f=>p.value=f)},null,8,["modelValue"]),e(I,{vertical:""}),e(k,{square:"",label:"Image URI",class:"col",filled:"",modelValue:r.value,"onUpdate:modelValue":_[2]||(_[2]=f=>r.value=f)},null,8,["modelValue"]),e(da,{name:u.value,symbol:p.value,uri:r.value},null,8,["name","symbol","uri"])])]),_:1})):(b(),V(x,{key:1,class:"row justify-end"},{default:c(()=>[e(pa,{name:u.value,symbol:p.value,uri:r.value},null,8,["name","symbol","uri"])]),_:1}))]),_:1}))}}),ga=t("div",{class:"text-h5"},"WrapperInterface Factory",-1),ba=t("div",{class:"text-caption text-grey"}," Small plates, salads & sandwiches in an intimate setting. ",-1),ya={class:"row q-gutter-x-md"},ha={class:"text-caption text-grey text-right"},xa={class:"row"},Va=t("div",{class:"text-h6 text-red-6 col"}," I know what im doing i want to close a wrapper ",-1),Sa=U({__name:"WrapperManage",setup(h){const u=m("select"),p=m(!1);return(r,l)=>(b(),V(P,{flat:"",bordered:""},{default:c(()=>[e(x,null,{default:c(()=>[ga,ba]),_:1}),e(I),e(ue,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=a=>u.value=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[e(j,{name:"create",label:"Create"}),e(j,{name:"select",label:"Edit"}),e(j,{name:"close",label:"Close"})]),_:1},8,["modelValue"]),e(I),e(_e,{modelValue:u.value,"onUpdate:modelValue":l[4]||(l[4]=a=>u.value=a),animated:""},{default:c(()=>[e(F,{name:"create"},{default:c(()=>[e(bt)]),_:1}),e(F,{name:"select"},{default:c(()=>[e(P,{flat:""},{default:c(()=>{var a;return[e(x,null,{default:c(()=>[t("div",ya,[e(re,{label:"Select a wrapper",class:"col",filled:"",modelValue:w(s)().wrapperSelected,"onUpdate:modelValue":l[1]||(l[1]=n=>w(s)().wrapperSelected=n),options:w(s)().wrapper,"option-label":n=>{var o,d;return"[Wrapped] "+(((o=w(D)().tokenList.find(_=>{var f,$;return _.address==(($=(f=n.account)==null?void 0:f.mintUnwrapped)==null?void 0:$.toString())}))==null?void 0:o.name)??((d=n.account)==null?void 0:d.mintUnwrapped.toString())??"")}},null,8,["modelValue","options","option-label"])]),t("div",ha," Total Found: "+S(w(s)().wrapper.length),1)]),_:1}),(a=w(s)().wrapperSelected)!=null&&a.account?(b(),V(x,{key:0,class:"row full-width"},{default:c(()=>[e(Ce,{bordered:"",class:"rounded-borders full-width"},{default:c(()=>[e(ne,{"expand-separator":"",class:"text-h5",icon:"info",label:"Info"},{default:c(()=>[e(Ut)]),_:1}),e(ne,{"expand-separator":"",class:"text-h5",icon:"settings",label:"Settings"},{default:c(()=>[e(jt)]),_:1}),e(ne,{"expand-separator":"",class:"text-h5",icon:"note_add",label:"Metadata"},{default:c(()=>[e(fa)]),_:1}),e(ne,{"default-opened":"","expand-separator":"",class:"text-h5",icon:"inventory_2",label:"Vault"},{default:c(()=>[e(ua)]),_:1})]),_:1})]),_:1})):q("",!0)]}),_:1})]),_:1}),e(F,{name:"close"},{default:c(()=>[e(P,{flat:""},{default:c(()=>{var a;return[e(x,null,{default:c(()=>[t("div",xa,[e(re,{label:"Select a wrapper",class:"col",filled:"",modelValue:w(s)().wrapperSelected,"onUpdate:modelValue":l[2]||(l[2]=n=>w(s)().wrapperSelected=n),options:w(s)().wrapper,"option-label":n=>{var o,d;return"[Wrapped] "+(((o=w(D)().tokenList.find(_=>{var f,$;return _.address==(($=(f=n.account)==null?void 0:f.mintUnwrapped)==null?void 0:$.toString())}))==null?void 0:o.name)??((d=n.account)==null?void 0:d.mintUnwrapped.toString())??"")}},null,8,["modelValue","options","option-label"]),e(kt,{disabled:!p.value},null,8,["disabled"])])]),_:1}),(a=w(s)().wrapperSelected)!=null&&a.account?(b(),V(x,{key:0,class:"row justify-between"})):q("",!0)]}),_:1}),e(x,{class:"row items-center"},{default:c(()=>[e(ve,{color:"red",modelValue:p.value,"onUpdate:modelValue":l[3]||(l[3]=a=>p.value=a)},null,8,["modelValue"]),Va]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),$a=U({__name:"WrapperWrap",props:["wrapper"],setup(h){const u=T(),p=m(1),r=h;async function l(a){var n,o;try{const d=new N,_=Q().pg_wrapper.value,f=r.wrapper,$=de(p.value,(n=X().getAccountByMintPublicKey(f==null?void 0:f.account.mintUnwrapped))==null?void 0:n.decimals);await Y().connection.getAccountInfo(H(se().publicKey.value.toString(),r.wrapper.account.mintWrapped.toString()))||d.add(Me(W(),H(W().toString(),r.wrapper.account.mintWrapped.toString()),W(),r.wrapper.account.mintWrapped,K,ke)),d.add(await _.methods.wrap($).accountsPartial({signer:se().publicKey.value,wrapper:f.publicKey,mintUnwrapped:f.account.mintUnwrapped,signerUnwrapped:new L(((o=X().accounts.find(B=>B.mint.toString()==f.account.mintUnwrapped.toString()))==null?void 0:o.pubkey)??""),signerWrapped:H(se().publicKey.value.toString(),r.wrapper.account.mintWrapped.toString()),tokenProgram:K,whitelist:null,whitelistEntry:null}).instruction()),await O(d,"[Wrapper] wrap tokens"),await s().updateStore()}catch(d){console.error(d),u.notify({message:d.message,type:"negative"})}}return(a,n)=>(b(),C("div",null,[e(k,{disable:!h.wrapper.account.allowWrap,filled:"",modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=o=>p.value=o)},null,8,["disable","modelValue"]),e(M,{disable:!h.wrapper.account.allowWrap,class:"full-width",color:"primary",label:"Wrap",onClick:n[1]||(n[1]=o=>l())},null,8,["disable"])]))}}),Ua=U({__name:"WrapperUnwrap",props:["wrapper"],setup(h){const u=T(),p=m(1),r=h;async function l(a){var n,o;try{const d=new N,_=Q().pg_wrapper.value,f=r.wrapper,$=de(p.value,(n=X().getAccountByMintPublicKey(f==null?void 0:f.account.mintUnwrapped))==null?void 0:n.decimals);d.add(await _.methods.unwrap($).accountsPartial({signer:W(),wrapper:f.publicKey,mintUnwrapped:f.account.mintUnwrapped,signerUnwrapped:new L(((o=X().accounts.find(A=>A.mint.toString()==f.account.mintUnwrapped.toString()))==null?void 0:o.pubkey)??""),signerWrapped:H(se().publicKey.value.toString(),r.wrapper.account.mintWrapped.toString()),tokenProgram:K,whitelist:null,whitelistEntry:null}).instruction()),await O(d,"[Wrapper] unwrap tokens"),await s().updateStore()}catch(d){console.error(d),u.notify({message:d.message,type:"negative"})}}return(a,n)=>(b(),C("div",null,[e(k,{disable:!h.wrapper.account.allowUnwrap,filled:"",modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=o=>p.value=o)},null,8,["disable","modelValue"]),e(M,{disable:!h.wrapper.account.allowUnwrap,class:"full-width",color:"primary",label:"Unwrap",onClick:n[1]||(n[1]=o=>l())},null,8,["disable"])]))}});const ka={class:"q-pa-md"},Wa={class:"q-pa-xs col-xs-12 col-sm-6 col-md-3"},Aa={class:"row items-center"},Ca=t("div",{class:"col text-subtitle1 text-weight-thin"},"Group",-1),qa={class:"text-subtitle2"},Pa={class:"row items-center"},Ta=t("div",{class:"col text-subtitle1 text-weight-thin"},"Pair",-1),Ia={class:"text-subtitle2 row q-gutter-x-xs"},Ka=t("div",null,"/",-1),Qa={class:"row items-center"},Ma=t("div",{class:"col text-subtitle1 text-weight-thin"},"Wrappable",-1),La={class:"text-subtitle2"},Na={class:"row items-center"},Oa=t("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),Ba={class:"text-subtitle2"},Ea={class:"col text-center"},Ra={class:"col text-center"},Ga=t("div",{class:"text-center text-subtitle2"},"Status",-1),ja=t("div",null,null,-1),za={class:"row q-mb-md q-px-md text-weight-thin"},Da={class:"col-1 q-gutter-x-xs"},Fa=t("div",{class:"col text-center"},"Wallet Balance",-1),Xa={class:"col-1 text-right q-gutter-x-xs"},Za={class:"row q-gutter-x-md"},Ja=U({__name:"WrapperTable",setup(h){const u=T();function p(){return u.screen.lt.sm?3:u.screen.lt.md?6:9}const r=m(""),l=m({page:1,rowsPerPage:p()});return te(()=>u.screen.name,()=>{l.value.rowsPerPage=p()}),Ve(()=>u.screen.gt.xs?u.screen.gt.sm?[3,6,9]:[3,6]:[3]),(a,n)=>(b(),C("div",ka,[e(Ke,{grid:"",rows:w(s)().wrapper,"row-key":"name",filter:r.value,"hide-header":"",pagination:l.value,"onUpdate:pagination":n[0]||(n[0]=o=>l.value=o),"rows-per-page-options":[0]},{item:c(o=>[t("div",Wa,[e(P,{flat:"",bordered:""},{default:c(()=>[e(x,{class:"text-center"},{default:c(()=>{var d;return[e(Te,{height:"200px",src:((d=w(D)().tokenList.find(_=>{var f;return _.address==((f=o.row.account)==null?void 0:f.mintUnwrapped.toString())}))==null?void 0:d.logoURI)??w(Qe)},null,8,["src"])]}),_:2},1024),e(x,null,{default:c(()=>{var d,_,f,$;return[t("div",Aa,[Ca,t("div",qa,S(w(s)().groups.find(A=>A.publicKey.toString()==o.row.account.group.toString()).account.name),1)]),t("div",Pa,[Ta,t("div",Ia,[t("div",null,S(w(D)().tokenList.find(A=>A.address==o.row.account.mintUnwrapped.toString()).symbol),1),Ka,t("div",null," W"+S(w(D)().tokenList.find(A=>A.address==o.row.account.mintUnwrapped.toString()).symbol),1)])]),t("div",Qa,[Ma,t("div",La,S((d=o.row)!=null&&d.account.useLimit?(_=o.row)==null?void 0:_.account.limitAmountUnwrapped:"\u221E"),1)]),t("div",Na,[Oa,t("div",Ba,S(w(Ie)(($=(f=o.row)==null?void 0:f.publicKey)==null?void 0:$.toString())),1)])]}),_:2},1024),e(I),e(ge,{class:"row text-h4"},{default:c(()=>[t("div",Ea,S(o.row.account.ratio[0]),1),e(ce,{size:"md",name:"swap_horiz"}),t("div",Ra,S(o.row.account.ratio[1]),1)]),_:2},1024),e(ge,{class:"row"},{default:c(()=>[e(P,{class:"col q-mx-sm",flat:"",bordered:""},{default:c(()=>[e(x,null,{default:c(()=>[Ga]),_:1}),e(I),ja,e(x,null,{default:c(()=>[e(Se,{mintWrapped:o.row.account.mintWrapped.toString(),mintUnwrapped:o.row.account.mintUnwrapped.toString(),wrapper:o.row},null,8,["mintWrapped","mintUnwrapped","wrapper"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(x,{class:"col"},{default:c(()=>{var d,_;return[t("div",za,[t("div",Da,S((d=w(X)().getAccountByMintPublicKey(o.row.account.mintUnwrapped))==null?void 0:d.uiAmount),1),Fa,t("div",Xa,S((_=w(X)().getAccountByMintPublicKey(o.row.account.mintWrapped))==null?void 0:_.uiAmount),1)]),t("div",Za,[e($a,{class:"col",wrapper:o.row},null,8,["wrapper"]),e(Ua,{class:"col",wrapper:o.row},null,8,["wrapper"])])]}),_:2},1024)]),_:2},1024)])]),_:1},8,["rows","filter","pagination"])]))}}),Ha=t("div",{class:"col text-h6"},"WrapperInterface",-1),Ya={class:"row"},Wl=U({__name:"WrapperPage",setup(h){const u=m("wrapping");return s(),xe(async()=>{Q()||We(),await s().updateStore()}),(p,r)=>(b(),V(Ae,{class:"bg-black"},{default:c(()=>[e(P,null,{default:c(()=>[e(x,{class:"row items-center q-gutter-x-md"},{default:c(()=>[e(ce,{name:"inventory_2",size:"md"}),Ha]),_:1}),e(I),e(ue,{modelValue:u.value,"onUpdate:modelValue":r[0]||(r[0]=l=>u.value=l),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[e(j,{name:"wrapping",label:"Wrap / Unwrap"}),e(j,{name:"manage",label:"Manage"})]),_:1},8,["modelValue"]),e(I),e(_e,{modelValue:u.value,"onUpdate:modelValue":r[2]||(r[2]=l=>u.value=l),animated:""},{default:c(()=>[e(F,{name:"wrapping"},{default:c(()=>[t("div",Ya,[e(we,{class:"col"}),e(M,{square:"",color:"primary",label:"reload",onClick:r[1]||(r[1]=()=>{w(s)().updateStore()})})]),e(P,{flat:""},{default:c(()=>[e(x,null,{default:c(()=>[e(Ja)]),_:1})]),_:1})]),_:1}),e(F,{name:"manage",class:"row q-gutter-x-md"},{default:c(()=>{var l;return[e(st,{class:"col-3"}),(l=w(s)().groupSelected)!=null&&l.account?(b(),V(Sa,{key:0,class:"col"})):q("",!0)]}),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{Wl as default};
