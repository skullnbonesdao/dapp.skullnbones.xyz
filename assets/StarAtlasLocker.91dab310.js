import{au as _n,b1 as Se,ak as it,as as Z,bx as ce,al as fe,cV as fa,dA as fu,dB as By,dC as xy,dD as Cy,dE as hu,dF as pu,dG as yu,dH as gu,dI as mu,d3 as we,dJ as bu,dK as wu,bY as ku,dL as L,dM as _e,d6 as C,dN as M,dO as De,d7 as te,dP as Oe,dQ as Kt,dR as Ue,dS as Ei,da as ge,dT as me,dp as kn,dU as eo,dV as on,dW as lf,dX as df,dY as ff,db as hf,dc as Ba,en as Dc,bW as vo,bX as z,e5 as My,e6 as Dh,e7 as _d,e8 as Ly,e9 as Ky,ea as zc,eb as lk,P as An,cR as rt,d4 as ds,d5 as _o,dn as Ny,cP as nr,cp as mn,cT as rr,dg as Gn,cU as pf,cj as $y,eo as dk,d2 as Su,df as vu,ep as fk,eq as hk,J as en,ai as Ot,V as Ae,aj as nn,cm as yf,bs as _u,aX as Au,ar as Ao,a1 as Rt,b7 as xa,a6 as Ca,ah as pk,cn as yk}from"./index.967c20ee.js";import{a as zh,Q as gk}from"./QTabs.6428837f.js";import{Q as Hi}from"./QSeparator.c594515f.js";import{a as Wh,Q as mk}from"./QTabPanels.c99a60b3.js";import{Q as bk}from"./QPage.f25f3ecc.js";import{Q as Sn}from"./QCardSection.a535f321.js";import{Q as vr}from"./use-form.981e8c9a.js";import{_ as Dy,t as wk}from"./FormatNumber.22ee9055.js";import{c as Ad,Q as Io}from"./calcAmountToTransfer.804d46b6.js";import{l as rn,a as zy}from"./lodash.ccfb0e7b.js";import{s as fs}from"./sha256.39524186.js";import{_ as jo}from"./defineProperty.034d6b40.js";import{f as gf}from"./WrapperInterface.01dd7d35.js";import{c as Vh}from"./associatedTokenAccount.4fbfe265.js";import{Q as Fs}from"./QSelect.8a9e922d.js";import{Q as Wc}from"./QInput.5fb55f75.js";import{h as Wy}from"./handleTransaction.a329206b.js";import{Q as Vy}from"./QImg.643cb2b1.js";import{Q as Uy}from"./QList.663b0b98.js";import{a as Qt}from"./QItem.e7c8c311.js";import"./use-key-composition.89017460.js";import"./QResizeObserver.9c93e893.js";import"./rtl.1180a65d.js";import"./touch.3df10340.js";import"./QSlideTransition.5b16b2c5.js";import"./index.c7f16ac7.js";import"./errors.2edf0a46.js";const kk={class:"row q-gutter-x-xs"},Sk=["src"],xs=_n({__name:"AmountCurrencyDisplay",props:{currencyName:{type:String,default:"ATLAS"},decimals:{default:5},padStart:{default:10},number:{type:String,required:!0}},setup(r){return(e,t)=>(Se(),it("div",kk,[Z(fa,{size:"xs"},{default:ce(()=>[fe("img",{src:`currencies/${r.currencyName}.webp`},null,8,Sk)]),_:1}),Z(Dy,{decimals:r.decimals,"pad-start":r.padStart,number:parseFloat(r.number)},null,8,["decimals","pad-start","number"])]))}});var zn={},Iu={},Fy={},jy={};Object.defineProperty(jy,"__esModule",{value:!0});var Eu={},Kn={},Qi={};class vk extends TypeError{constructor(e,t){let n;const{message:i,...s}=e,{path:o}=e,a=o.length===0?i:"At path: "+o.join(".")+" -- "+i;super(a),Object.assign(this,s),this.name=this.constructor.name,this.failures=()=>{var c;return(c=n)!=null?c:n=[e,...t()]}}}function _k(r){return hi(r)&&typeof r[Symbol.iterator]=="function"}function hi(r){return typeof r=="object"&&r!=null}function br(r){return typeof r=="string"?JSON.stringify(r):""+r}function Ak(r){const{done:e,value:t}=r.next();return e?void 0:t}function Ik(r,e,t,n){if(r===!0)return;r===!1?r={}:typeof r=="string"&&(r={message:r});const{path:i,branch:s}=e,{type:o}=t,{refinement:a,message:c="Expected a value of type `"+o+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+br(n)+"`"}=r;return{value:n,type:o,refinement:a,key:i[i.length-1],path:i,branch:s,...r,message:c}}function*Uh(r,e,t,n){_k(r)||(r=[r]);for(const i of r){const s=Ik(i,e,t,n);s&&(yield s)}}function*mf(r,e,t={}){const{path:n=[],branch:i=[r],coerce:s=!1,mask:o=!1}=t,a={path:n,branch:i};if(s&&(r=e.coercer(r,a),o&&e.type!=="type"&&hi(e.schema)&&hi(r)&&!Array.isArray(r)))for(const l in r)e.schema[l]===void 0&&delete r[l];let c=!0;for(const l of e.validator(r,a))c=!1,yield[l,void 0];for(let[l,u,d]of e.entries(r,a)){const m=mf(u,d,{path:l===void 0?n:[...n,l],branch:l===void 0?i:[...i,u],coerce:s,mask:o});for(const y of m)y[0]?(c=!1,yield[y[0],void 0]):s&&(u=y[1],l===void 0?r=u:r instanceof Map?r.set(l,u):r instanceof Set?r.add(u):hi(r)&&(r[l]=u))}if(c)for(const l of e.refiner(r,a))c=!1,yield[l,void 0];c&&(yield[void 0,r])}class Wr{constructor(e){const{type:t,schema:n,validator:i,refiner:s,coercer:o=c=>c,entries:a=function*(){}}=e;this.type=t,this.schema=n,this.entries=a,this.coercer=o,i?this.validator=(c,l)=>{const u=i(c,l);return Uh(u,l,this,c)}:this.validator=()=>[],s?this.refiner=(c,l)=>{const u=s(c,l);return Uh(u,l,this,c)}:this.refiner=()=>[]}assert(e){return qy(e,this)}create(e){return se(e,this)}is(e){return Gy(e,this)}mask(e){return Ek(e,this)}validate(e,t={}){return Ma(e,this,t)}}function qy(r,e){const t=Ma(r,e);if(t[0])throw t[0]}function se(r,e){const t=Ma(r,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function Ek(r,e){const t=Ma(r,e,{coerce:!0,mask:!0});if(t[0])throw t[0];return t[1]}function Gy(r,e){return!Ma(r,e)[0]}function Ma(r,e,t={}){const n=mf(r,e,t),i=Ak(n);if(i[0])return[new vk(i[0],function*(){for(const o of n)o[0]&&(yield o[0])}),void 0];{const s=i[1];return[void 0,s]}}function hs(r,e){return new Wr({type:r,schema:null,validator:e})}function Pk(){return hs("any",()=>!0)}function oe(r){return new Wr({type:"array",schema:r,*entries(e){if(r&&Array.isArray(e))for(const[t,n]of e.entries())yield[t,n,r]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||"Expected an array value, but received: "+br(e)}})}function $r(){return hs("boolean",r=>typeof r=="boolean")}function bf(r){return hs("instance",e=>e instanceof r||"Expected a `"+r.name+"` instance, but received: "+br(e))}function _t(r){const e=br(r),t=typeof r;return new Wr({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?r:null,validator(n){return n===r||"Expected the literal `"+e+"`, but received: "+br(n)}})}function Rk(){return hs("never",()=>!1)}function ae(r){return new Wr({...r,validator:(e,t)=>e===null||r.validator(e,t),refiner:(e,t)=>e===null||r.refiner(e,t)})}function $(){return hs("number",r=>typeof r=="number"&&!isNaN(r)||"Expected a number, but received: "+br(r))}function ve(r){return new Wr({...r,validator:(e,t)=>e===void 0||r.validator(e,t),refiner:(e,t)=>e===void 0||r.refiner(e,t)})}function Hy(r,e){return new Wr({type:"record",schema:null,*entries(t){if(hi(t))for(const n in t){const i=t[n];yield[n,n,r],yield[n,i,e]}},validator(t){return hi(t)||"Expected an object, but received: "+br(t)}})}function re(){return hs("string",r=>typeof r=="string"||"Expected a string, but received: "+br(r))}function wf(r){const e=Rk();return new Wr({type:"tuple",schema:null,*entries(t){if(Array.isArray(t)){const n=Math.max(r.length,t.length);for(let i=0;i<n;i++)yield[i,t[i],r[i]||e]}},validator(t){return Array.isArray(t)||"Expected an array, but received: "+br(t)}})}function J(r){const e=Object.keys(r);return new Wr({type:"type",schema:r,*entries(t){if(hi(t))for(const n of e)yield[n,t[n],r[n]]},validator(t){return hi(t)||"Expected an object, but received: "+br(t)}})}function Cn(r){const e=r.map(t=>t.type).join(" | ");return new Wr({type:"union",schema:null,validator(t,n){const i=[];for(const s of r){const[...o]=mf(t,s,n),[a]=o;if(a[0])for(const[c]of o)c&&i.push(c);else return[]}return["Expected the value to satisfy a union of `"+e+"`, but received: "+br(t),...i]}})}function La(){return hs("unknown",()=>!0)}function Ka(r,e,t){return new Wr({...r,coercer:(n,i)=>Gy(n,e)?r.coercer(t(n,i),i):r.coercer(n,i)})}const Tk=fu.v4,Ok=function(r,e,t,n){if(typeof r!="string")throw new TypeError(r+" must be a string");n=n||{};const i=typeof n.version=="number"?n.version:2;if(i!==1&&i!==2)throw new TypeError(i+" must be 1 or 2");const s={method:r};if(i===2&&(s.jsonrpc="2.0"),e){if(typeof e!="object"&&!Array.isArray(e))throw new TypeError(e+" must be an object, array or omitted");s.params=e}if(typeof t>"u"){const o=typeof n.generator=="function"?n.generator:function(){return Tk()};s.id=o(s,n)}else i===2&&t===null?n.notificationIdNull&&(s.id=null):s.id=t;return s};var Bk=Ok;const xk=fu.v4,Ck=Bk,ha=function(r,e){if(!(this instanceof ha))return new ha(r,e);e||(e={}),this.options={reviver:typeof e.reviver<"u"?e.reviver:null,replacer:typeof e.replacer<"u"?e.replacer:null,generator:typeof e.generator<"u"?e.generator:function(){return xk()},version:typeof e.version<"u"?e.version:2,notificationIdNull:typeof e.notificationIdNull=="boolean"?e.notificationIdNull:!1},this.callServer=r};var Mk=ha;ha.prototype.request=function(r,e,t,n){const i=this;let s=null;const o=Array.isArray(r)&&typeof e=="function";if(this.options.version===1&&o)throw new TypeError("JSON-RPC 1.0 does not support batching");if(o||!o&&r&&typeof r=="object"&&typeof e=="function")n=e,s=r;else{typeof t=="function"&&(n=t,t=void 0);const l=typeof n=="function";try{s=Ck(r,e,t,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(u){if(l)return n(u);throw u}if(!l)return s}let c;try{c=JSON.stringify(s,this.options.replacer)}catch(l){return n(l)}return this.callServer(c,function(l,u){i._parseResponse(l,u,n)}),s};ha.prototype._parseResponse=function(r,e,t){if(r){t(r);return}if(!e)return t();let n;try{n=JSON.parse(e,this.options.reviver)}catch(i){return t(i)}if(t.length===3)if(Array.isArray(n)){const i=function(o){return typeof o.error<"u"},s=function(o){return!i(o)};return t(null,n.filter(i),n.filter(s))}else return t(null,n.error,n.result);t(null,n)};var Yy={};(function(r){var e=bu.exports;Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var t=e(By),n=e(xy.exports),i=e(Cy.exports),s=e(hu.exports),o=e(pu.exports),a=e(yu.exports),c=e(gu.exports),l=e(mu.exports),u=wu.exports;function d(p){var w=m();return function(){var E=(0,l.default)(p),P;if(w){var K=(0,l.default)(this).constructor;P=Reflect.construct(E,arguments,K)}else P=E.apply(this,arguments);return(0,c.default)(this,P)}}function m(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var y=function(p,w){var v={};for(var E in p)Object.prototype.hasOwnProperty.call(p,E)&&w.indexOf(E)<0&&(v[E]=p[E]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function")for(var P=0,E=Object.getOwnPropertySymbols(p);P<E.length;P++)w.indexOf(E[P])<0&&Object.prototype.propertyIsEnumerable.call(p,E[P])&&(v[E[P]]=p[E[P]]);return v},S=function(p){(0,a.default)(v,p);var w=d(v);function v(E){var P,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"ws://localhost:8080",T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},b=arguments.length>3?arguments[3]:void 0;(0,s.default)(this,v);var _=T.autoconnect,R=_===void 0?!0:_,W=T.reconnect,B=W===void 0?!0:W,V=T.reconnect_interval,q=V===void 0?1e3:V,I=T.max_reconnects,D=I===void 0?5:I,G=y(T,["autoconnect","reconnect","reconnect_interval","max_reconnects"]);return P=w.call(this),P.webSocketFactory=E,P.queue={},P.rpc_id=0,P.address=K,P.autoconnect=R,P.ready=!1,P.reconnect=B,P.reconnect_timer_id=void 0,P.reconnect_interval=q,P.max_reconnects=D,P.rest_options=G,P.current_reconnects=0,P.generate_request_id=b||function(){return++P.rpc_id},P.autoconnect&&P._connect(P.address,Object.assign({autoconnect:P.autoconnect,reconnect:P.reconnect,reconnect_interval:P.reconnect_interval,max_reconnects:P.max_reconnects},P.rest_options)),P}return(0,o.default)(v,[{key:"connect",value:function(){this.socket||this._connect(this.address,Object.assign({autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects},this.rest_options))}},{key:"call",value:function(P,K,T,b){var _=this;return!b&&(0,i.default)(T)==="object"&&(b=T,T=null),new Promise(function(R,W){if(!_.ready)return W(new Error("socket not ready"));var B=_.generate_request_id(P,K),V={jsonrpc:"2.0",method:P,params:K||null,id:B};_.socket.send(JSON.stringify(V),b,function(q){if(q)return W(q);_.queue[B]={promise:[R,W]},T&&(_.queue[B].timeout=setTimeout(function(){delete _.queue[B],W(new Error("reply timeout"))},T))})})}},{key:"login",value:function(){var E=(0,n.default)(t.default.mark(function K(T){var b;return t.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,this.call("rpc.login",T);case 2:if(b=R.sent,b){R.next=5;break}throw new Error("authentication failed");case 5:return R.abrupt("return",b);case 6:case"end":return R.stop()}},K,this)}));function P(K){return E.apply(this,arguments)}return P}()},{key:"listMethods",value:function(){var E=(0,n.default)(t.default.mark(function K(){return t.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.call("__listMethods");case 2:return b.abrupt("return",b.sent);case 3:case"end":return b.stop()}},K,this)}));function P(){return E.apply(this,arguments)}return P}()},{key:"notify",value:function(P,K){var T=this;return new Promise(function(b,_){if(!T.ready)return _(new Error("socket not ready"));var R={jsonrpc:"2.0",method:P,params:K||null};T.socket.send(JSON.stringify(R),function(W){if(W)return _(W);b()})})}},{key:"subscribe",value:function(){var E=(0,n.default)(t.default.mark(function K(T){var b;return t.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return typeof T=="string"&&(T=[T]),R.next=3,this.call("rpc.on",T);case 3:if(b=R.sent,!(typeof T=="string"&&b[T]!=="ok")){R.next=6;break}throw new Error("Failed subscribing to an event '"+T+"' with: "+b[T]);case 6:return R.abrupt("return",b);case 7:case"end":return R.stop()}},K,this)}));function P(K){return E.apply(this,arguments)}return P}()},{key:"unsubscribe",value:function(){var E=(0,n.default)(t.default.mark(function K(T){var b;return t.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return typeof T=="string"&&(T=[T]),R.next=3,this.call("rpc.off",T);case 3:if(b=R.sent,!(typeof T=="string"&&b[T]!=="ok")){R.next=6;break}throw new Error("Failed unsubscribing from an event with: "+b);case 6:return R.abrupt("return",b);case 7:case"end":return R.stop()}},K,this)}));function P(K){return E.apply(this,arguments)}return P}()},{key:"close",value:function(P,K){this.socket.close(P||1e3,K)}},{key:"_connect",value:function(P,K){var T=this;clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(P,K),this.socket.addEventListener("open",function(){T.ready=!0,T.emit("open"),T.current_reconnects=0}),this.socket.addEventListener("message",function(b){var _=b.data;_ instanceof ArrayBuffer&&(_=we.Buffer.from(_).toString());try{_=JSON.parse(_)}catch{return}if(_.notification&&T.listeners(_.notification).length){if(!Object.keys(_.params).length)return T.emit(_.notification);var R=[_.notification];if(_.params.constructor===Object)R.push(_.params);else for(var W=0;W<_.params.length;W++)R.push(_.params[W]);return Promise.resolve().then(function(){T.emit.apply(T,R)})}if(!T.queue[_.id])return _.method&&_.params?Promise.resolve().then(function(){T.emit(_.method,_.params)}):void 0;"error"in _=="result"in _&&T.queue[_.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),T.queue[_.id].timeout&&clearTimeout(T.queue[_.id].timeout),_.error?T.queue[_.id].promise[1](_.error):T.queue[_.id].promise[0](_.result),delete T.queue[_.id]}),this.socket.addEventListener("error",function(b){return T.emit("error",b)}),this.socket.addEventListener("close",function(b){var _=b.code,R=b.reason;T.ready&&setTimeout(function(){return T.emit("close",_,R)},0),T.ready=!1,T.socket=void 0,_!==1e3&&(T.current_reconnects++,T.reconnect&&(T.max_reconnects>T.current_reconnects||T.max_reconnects===0)&&(T.reconnect_timer_id=setTimeout(function(){return T._connect(P,K)},T.reconnect_interval)))})}}]),v}(u.EventEmitter);r.default=S})(Yy);var Lk=ku(Yy),Jy={};(function(r){var e=bu.exports;Object.defineProperty(r,"__esModule",{value:!0}),r.default=d;var t=e(hu.exports),n=e(pu.exports),i=e(yu.exports),s=e(gu.exports),o=e(mu.exports),a=wu.exports;function c(m){var y=l();return function(){var p=(0,o.default)(m),w;if(y){var v=(0,o.default)(this).constructor;w=Reflect.construct(p,arguments,v)}else w=p.apply(this,arguments);return(0,s.default)(this,w)}}function l(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var u=function(m){(0,i.default)(S,m);var y=c(S);function S(p,w,v){var E;return(0,t.default)(this,S),E=y.call(this),E.socket=new window.WebSocket(p,v),E.socket.onopen=function(){return E.emit("open")},E.socket.onmessage=function(P){return E.emit("message",P.data)},E.socket.onerror=function(P){return E.emit("error",P)},E.socket.onclose=function(P){E.emit("close",P.code,P.reason)},E}return(0,n.default)(S,[{key:"send",value:function(w,v,E){var P=E||v;try{this.socket.send(w),P()}catch(K){P(K)}}},{key:"close",value:function(w,v){this.socket.close(w,v)}},{key:"addEventListener",value:function(w,v,E){this.socket.addEventListener(w,v,E)}}]),S}(a.EventEmitter);function d(m,y){return new u(m,y)}})(Jy);var Kk=ku(Jy);const Nk=on.utils.randomPrivateKey,Fh=()=>{const r=on.utils.randomPrivateKey(),e=Vc(r),t=new Uint8Array(64);return t.set(r),t.set(e,32),{publicKey:e,secretKey:t}},Vc=on.getPublicKey;function jh(r){try{return on.ExtendedPoint.fromHex(r),!0}catch{return!1}}const kf=(r,e)=>on.sign(r,e.slice(0,32)),$k=on.verify,Ce=r=>L.Buffer.isBuffer(r)?r:r instanceof Uint8Array?L.Buffer.from(r.buffer,r.byteOffset,r.byteLength):L.Buffer.from(r);class Sf{constructor(e){Object.assign(this,e)}encode(){return L.Buffer.from(lf(na,this))}static decode(e){return df(na,this,e)}static decodeUnchecked(e){return ff(na,this,e)}}class Dk extends Sf{constructor(e){if(super(e),this.enum="",Object.keys(e).length!==1)throw new Error("Enum can only take single value");Object.keys(e).map(t=>{this.enum=t})}}const na=new Map;var Qy;let Xy;const Zy=32,jn=32;function zk(r){return r._bn!==void 0}let qh=1;Xy=Symbol.toStringTag;class Y extends Sf{constructor(e){if(super({}),this._bn=void 0,zk(e))this._bn=e._bn;else{if(typeof e=="string"){const t=me.decode(e);if(t.length!=jn)throw new Error("Invalid public key input");this._bn=new kn(t)}else this._bn=new kn(e);if(this._bn.byteLength()>jn)throw new Error("Invalid public key input")}}static unique(){const e=new Y(qh);return qh+=1,new Y(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return me.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(L.Buffer);if(e.length===jn)return e;const t=L.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[Xy](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,n){const i=L.Buffer.concat([e.toBuffer(),L.Buffer.from(t),n.toBuffer()]),s=eo(i);return new Y(s)}static createProgramAddressSync(e,t){let n=L.Buffer.alloc(0);e.forEach(function(s){if(s.length>Zy)throw new TypeError("Max seed length exceeded");n=L.Buffer.concat([n,Ce(s)])}),n=L.Buffer.concat([n,t.toBuffer(),L.Buffer.from("ProgramDerivedAddress")]);const i=eo(n);if(jh(i))throw new Error("Invalid seeds, address must fall off the curve");return new Y(i)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let n=255,i;for(;n!=0;){try{const s=e.concat(L.Buffer.from([n]));i=this.createProgramAddressSync(s,t)}catch(s){if(s instanceof TypeError)throw s;n--;continue}return[i,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new Y(e);return jh(t.toBytes())}}Qy=Y;Y.default=new Qy("11111111111111111111111111111111");na.set(Y,{kind:"struct",fields:[["_bn","u256"]]});class Wk{constructor(e){if(this._publicKey=void 0,this._secretKey=void 0,e){const t=Ce(e);if(e.length!==64)throw new Error("bad secret key size");this._publicKey=t.slice(32,64),this._secretKey=t.slice(0,32)}else this._secretKey=Ce(Nk()),this._publicKey=Ce(Vc(this._secretKey))}get publicKey(){return new Y(this._publicKey)}get secretKey(){return L.Buffer.concat([this._secretKey,this._publicKey],64)}}const Vk=new Y("BPFLoader1111111111111111111111111111111111"),pi=1280-40-8,Pu=127,to=64;class vf extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(vf.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class _f extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(_f.prototype,"name",{value:"TransactionExpiredTimeoutError"});class Ls extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Ls.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class pa{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const n=new Map;this.keySegments().flat().forEach((s,o)=>{n.set(s.toBase58(),o)});const i=s=>{const o=n.get(s.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(s=>({programIdIndex:i(s.programId),accountKeyIndexes:s.keys.map(o=>i(o.pubkey)),data:s.data}))}}const Ne=(r="publicKey")=>ge(32,r),Uk=(r="signature")=>ge(64,r),Wi=(r="string")=>{const e=C([M("length"),M("lengthPadding"),ge(Kt(M(),-8),"chars")],r),t=e.decode.bind(e),n=e.encode.bind(e),i=e;return i.decode=(s,o)=>t(s,o).chars.toString(),i.encode=(s,o,a)=>{const c={chars:L.Buffer.from(s,"utf8")};return n(c,o,a)},i.alloc=s=>M().span+M().span+L.Buffer.from(s,"utf8").length,i},Fk=(r="authorized")=>C([Ne("staker"),Ne("withdrawer")],r),jk=(r="lockup")=>C([De("unixTimestamp"),De("epoch"),Ne("custodian")],r),qk=(r="voteInit")=>C([Ne("nodePubkey"),Ne("authorizedVoter"),Ne("authorizedWithdrawer"),te("commission")],r),Gk=(r="voteAuthorizeWithSeedArgs")=>C([M("voteAuthorizationType"),Ne("currentAuthorityDerivedKeyOwnerPubkey"),Wi("currentAuthorityDerivedKeySeed"),Ne("newAuthorized")],r);function eg(r,e){const t=i=>{if(i.span>=0)return i.span;if(typeof i.alloc=="function")return i.alloc(e[i.property]);if("count"in i&&"elementLayout"in i){const s=e[i.property];if(Array.isArray(s))return s.length*t(i.elementLayout)}else if("fields"in i)return eg({layout:i},e[i.property]);return 0};let n=0;return r.layout.fields.forEach(i=>{n+=t(i)}),n}function Pn(r){let e=0,t=0;for(;;){let n=r.shift();if(e|=(n&127)<<t*7,t+=1,(n&128)===0)break}return e}function Wn(r,e){let t=e;for(;;){let n=t&127;if(t>>=7,t==0){r.push(n);break}else n|=128,r.push(n)}}function qe(r,e){if(!r)throw new Error(e||"Assertion failed")}class Ru{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const n=new Map,i=o=>{const a=o.toBase58();let c=n.get(a);return c===void 0&&(c={isSigner:!1,isWritable:!1,isInvoked:!1},n.set(a,c)),c},s=i(t);s.isSigner=!0,s.isWritable=!0;for(const o of e){i(o.programId).isInvoked=!0;for(const a of o.keys){const c=i(a.pubkey);c.isSigner||=a.isSigner,c.isWritable||=a.isWritable}}return new Ru(t,n)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];qe(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,c])=>c.isSigner&&c.isWritable),n=e.filter(([,c])=>c.isSigner&&!c.isWritable),i=e.filter(([,c])=>!c.isSigner&&c.isWritable),s=e.filter(([,c])=>!c.isSigner&&!c.isWritable),o={numRequiredSignatures:t.length+n.length,numReadonlySignedAccounts:n.length,numReadonlyUnsignedAccounts:s.length};{qe(t.length>0,"Expected at least one writable signer key");const[c]=t[0];qe(c===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...t.map(([c])=>new Y(c)),...n.map(([c])=>new Y(c)),...i.map(([c])=>new Y(c)),...s.map(([c])=>new Y(c))];return[o,a]}extractTableLookup(e){const[t,n]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[i,s]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&i.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:i},{writable:n,readonly:s}]}drainKeysFoundInLookupTable(e,t){const n=new Array,i=new Array;for(const[s,o]of this.keyMetaMap.entries())if(t(o)){const a=new Y(s),c=e.findIndex(l=>l.equals(a));c>=0&&(qe(c<256,"Max lookup table index exceeded"),n.push(c),i.push(a),this.keyMetaMap.delete(s))}return[n,i]}}class wr{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new Y(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:me.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new pa(this.staticAccountKeys)}static compile(e){const t=Ru.compile(e.instructions,e.payerKey),[n,i]=t.getMessageComponents(),o=new pa(i).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:me.encode(a.data)}));return new wr({header:n,accountKeys:i,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const n=e-t,s=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return n<s}else{const n=t-this.header.numReadonlySignedAccounts;return e<n}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];Wn(t,e);const n=this.instructions.map(d=>{const{accounts:m,programIdIndex:y}=d,S=Array.from(me.decode(d.data));let p=[];Wn(p,m.length);let w=[];return Wn(w,S.length),{programIdIndex:y,keyIndicesCount:L.Buffer.from(p),keyIndices:m,dataLength:L.Buffer.from(w),data:S}});let i=[];Wn(i,n.length);let s=L.Buffer.alloc(pi);L.Buffer.from(i).copy(s);let o=i.length;n.forEach(d=>{o+=C([te("programIdIndex"),ge(d.keyIndicesCount.length,"keyIndicesCount"),Oe(te("keyIndex"),d.keyIndices.length,"keyIndices"),ge(d.dataLength.length,"dataLength"),Oe(te("userdatum"),d.data.length,"data")]).encode(d,s,o)}),s=s.slice(0,o);const a=C([ge(1,"numRequiredSignatures"),ge(1,"numReadonlySignedAccounts"),ge(1,"numReadonlyUnsignedAccounts"),ge(t.length,"keyCount"),Oe(Ne("key"),e,"keys"),Ne("recentBlockhash")]),c={numRequiredSignatures:L.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:L.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:L.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:L.Buffer.from(t),keys:this.accountKeys.map(d=>Ce(d.toBytes())),recentBlockhash:me.decode(this.recentBlockhash)};let l=L.Buffer.alloc(2048);const u=a.encode(c,l);return s.copy(l,u),l.slice(0,u+s.length)}static from(e){let t=[...e];const n=t.shift();if(n!==(n&Pu))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const i=t.shift(),s=t.shift(),o=Pn(t);let a=[];for(let m=0;m<o;m++){const y=t.slice(0,jn);t=t.slice(jn),a.push(new Y(L.Buffer.from(y)))}const c=t.slice(0,jn);t=t.slice(jn);const l=Pn(t);let u=[];for(let m=0;m<l;m++){const y=t.shift(),S=Pn(t),p=t.slice(0,S);t=t.slice(S);const w=Pn(t),v=t.slice(0,w),E=me.encode(L.Buffer.from(v));t=t.slice(w),u.push({programIdIndex:y,accounts:p,data:E})}const d={header:{numRequiredSignatures:n,numReadonlySignedAccounts:i,numReadonlyUnsignedAccounts:s},recentBlockhash:me.encode(L.Buffer.from(c)),accountKeys:a,instructions:u};return new wr(d)}}class Xi{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new pa(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,n=this.staticAccountKeys.length;if(e>=n){const i=e-n,s=this.addressTableLookups.reduce((o,a)=>o+a.writableIndexes.length,0);return i<s}else if(e>=this.header.numRequiredSignatures){const i=e-t,o=n-t-this.header.numReadonlyUnsignedAccounts;return i<o}else{const i=t-this.header.numReadonlySignedAccounts;return e<i}}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const n of this.addressTableLookups){const i=e.find(s=>s.key.equals(n.accountKey));if(!i)throw new Error(`Failed to find address lookup table account for table key ${n.accountKey.toBase58()}`);for(const s of n.writableIndexes)if(s<i.state.addresses.length)t.writable.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${n.accountKey.toBase58()}`);for(const s of n.readonlyIndexes)if(s<i.state.addresses.length)t.readonly.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${n.accountKey.toBase58()}`)}return t}static compile(e){const t=Ru.compile(e.instructions,e.payerKey),n=new Array,i={writable:new Array,readonly:new Array},s=e.addressLookupTableAccounts||[];for(const u of s){const d=t.extractTableLookup(u);if(d!==void 0){const[m,{writable:y,readonly:S}]=d;n.push(m),i.writable.push(...y),i.readonly.push(...S)}}const[o,a]=t.getMessageComponents(),l=new pa(a,i).compileInstructions(e.instructions);return new Xi({header:o,staticAccountKeys:a,recentBlockhash:e.recentBlockhash,compiledInstructions:l,addressTableLookups:n})}serialize(){const e=Array();Wn(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),n=Array();Wn(n,this.compiledInstructions.length);const i=this.serializeAddressTableLookups(),s=Array();Wn(s,this.addressTableLookups.length);const o=C([te("prefix"),C([te("numRequiredSignatures"),te("numReadonlySignedAccounts"),te("numReadonlyUnsignedAccounts")],"header"),ge(e.length,"staticAccountKeysLength"),Oe(Ne(),this.staticAccountKeys.length,"staticAccountKeys"),Ne("recentBlockhash"),ge(n.length,"instructionsLength"),ge(t.length,"serializedInstructions"),ge(s.length,"addressTableLookupsLength"),ge(i.length,"serializedAddressTableLookups")]),a=new Uint8Array(pi),c=1<<7,l=o.encode({prefix:c,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(u=>u.toBytes()),recentBlockhash:me.decode(this.recentBlockhash),instructionsLength:new Uint8Array(n),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(s),serializedAddressTableLookups:i},a);return a.slice(0,l)}serializeInstructions(){let e=0;const t=new Uint8Array(pi);for(const n of this.compiledInstructions){const i=Array();Wn(i,n.accountKeyIndexes.length);const s=Array();Wn(s,n.data.length),e+=C([te("programIdIndex"),ge(i.length,"encodedAccountKeyIndexesLength"),Oe(te(),n.accountKeyIndexes.length,"accountKeyIndexes"),ge(s.length,"encodedDataLength"),ge(n.data.length,"data")]).encode({programIdIndex:n.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(i),accountKeyIndexes:n.accountKeyIndexes,encodedDataLength:new Uint8Array(s),data:n.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(pi);for(const n of this.addressTableLookups){const i=Array();Wn(i,n.writableIndexes.length);const s=Array();Wn(s,n.readonlyIndexes.length),e+=C([Ne("accountKey"),ge(i.length,"encodedWritableIndexesLength"),Oe(te(),n.writableIndexes.length,"writableIndexes"),ge(s.length,"encodedReadonlyIndexesLength"),Oe(te(),n.readonlyIndexes.length,"readonlyIndexes")]).encode({accountKey:n.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(i),writableIndexes:n.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(s),readonlyIndexes:n.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const n=t.shift(),i=n&Pu;qe(n!==i,"Expected versioned message but received legacy message");const s=i;qe(s===0,`Expected versioned message with version 0 but found version ${s}`);const o={numRequiredSignatures:t.shift(),numReadonlySignedAccounts:t.shift(),numReadonlyUnsignedAccounts:t.shift()},a=[],c=Pn(t);for(let S=0;S<c;S++)a.push(new Y(t.splice(0,jn)));const l=me.encode(t.splice(0,jn)),u=Pn(t),d=[];for(let S=0;S<u;S++){const p=t.shift(),w=Pn(t),v=t.splice(0,w),E=Pn(t),P=new Uint8Array(t.splice(0,E));d.push({programIdIndex:p,accountKeyIndexes:v,data:P})}const m=Pn(t),y=[];for(let S=0;S<m;S++){const p=new Y(t.splice(0,jn)),w=Pn(t),v=t.splice(0,w),E=Pn(t),P=t.splice(0,E);y.push({accountKey:p,writableIndexes:v,readonlyIndexes:P})}return new Xi({header:o,staticAccountKeys:a,recentBlockhash:l,compiledInstructions:d,addressTableLookups:y})}}const Af={deserializeMessageVersion(r){const e=r[0],t=e&Pu;return t===e?"legacy":t},deserialize:r=>{const e=Af.deserializeMessageVersion(r);if(e==="legacy")return wr.from(r);if(e===0)return Xi.deserialize(r);throw new Error(`Transaction message version ${e} deserialization is not supported`)}};let qr=function(r){return r[r.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",r[r.PROCESSED=1]="PROCESSED",r[r.TIMED_OUT=2]="TIMED_OUT",r[r.NONCE_INVALID=3]="NONCE_INVALID",r}({});const Hk=L.Buffer.alloc(to).fill(0);class et{constructor(e){this.keys=void 0,this.programId=void 0,this.data=L.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:n})=>({pubkey:e.toJSON(),isSigner:t,isWritable:n})),programId:this.programId.toJSON(),data:[...this.data]}}}class je{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:n}=e;this.minNonceContextSlot=t,this.nonceInfo=n}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:n}=e;this.recentBlockhash=t,this.lastValidBlockHeight=n}else{const{recentBlockhash:t,nonceInfo:n}=e;n&&(this.nonceInfo=n),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new et(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let n;if(this.feePayer)n=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)n=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let p=0;p<t.length;p++)if(t[p].programId===void 0)throw new Error(`Transaction instruction index ${p} has undefined program id`);const i=[],s=[];t.forEach(p=>{p.keys.forEach(v=>{s.push({...v})});const w=p.programId.toString();i.includes(w)||i.push(w)}),i.forEach(p=>{s.push({pubkey:new Y(p),isSigner:!1,isWritable:!1})});const o=[];s.forEach(p=>{const w=p.pubkey.toString(),v=o.findIndex(E=>E.pubkey.toString()===w);v>-1?(o[v].isWritable=o[v].isWritable||p.isWritable,o[v].isSigner=o[v].isSigner||p.isSigner):o.push(p)}),o.sort(function(p,w){if(p.isSigner!==w.isSigner)return p.isSigner?-1:1;if(p.isWritable!==w.isWritable)return p.isWritable?-1:1;const v={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return p.pubkey.toBase58().localeCompare(w.pubkey.toBase58(),"en",v)});const a=o.findIndex(p=>p.pubkey.equals(n));if(a>-1){const[p]=o.splice(a,1);p.isSigner=!0,p.isWritable=!0,o.unshift(p)}else o.unshift({pubkey:n,isSigner:!0,isWritable:!0});for(const p of this.signatures){const w=o.findIndex(v=>v.pubkey.equals(p.publicKey));if(w>-1)o[w].isSigner||(o[w].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${p.publicKey.toString()}`)}let c=0,l=0,u=0;const d=[],m=[];o.forEach(({pubkey:p,isSigner:w,isWritable:v})=>{w?(d.push(p.toString()),c+=1,v||(l+=1)):(m.push(p.toString()),v||(u+=1))});const y=d.concat(m),S=t.map(p=>{const{data:w,programId:v}=p;return{programIdIndex:y.indexOf(v.toString()),accounts:p.keys.map(E=>y.indexOf(E.pubkey.toString())),data:me.encode(w)}});return S.forEach(p=>{qe(p.programIdIndex>=0),p.accounts.forEach(w=>qe(w>=0))}),new wr({header:{numRequiredSignatures:c,numReadonlySignedAccounts:l,numReadonlyUnsignedAccounts:u},accountKeys:y,recentBlockhash:e,instructions:S})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((i,s)=>t[s].equals(i.publicKey))||(this.signatures=t.map(n=>({signature:null,publicKey:n}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(n=>{const i=n.toString();return t.has(i)?!1:(t.add(i),!0)}).map(n=>({signature:null,publicKey:n}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}this.signatures=n.map(s=>({signature:null,publicKey:s.publicKey}));const i=this._compile();this._partialSign(i,...n)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}const i=this._compile();this._partialSign(i,...n)}_partialSign(e,...t){const n=e.serialize();t.forEach(i=>{const s=kf(n,i.secretKey);this._addSignature(i.publicKey,Ce(s))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){qe(t.length===64);const n=this.signatures.findIndex(i=>e.equals(i.publicKey));if(n<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[n].signature=L.Buffer.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:n,publicKey:i}of this.signatures)if(n===null){if(t)return!1}else if(!$k(n,e,i.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:n}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),i=this.serializeMessage();if(n&&!this._verifySignatures(i,t))throw new Error("Signature verification failed");return this._serialize(i)}_serialize(e){const{signatures:t}=this,n=[];Wn(n,t.length);const i=n.length+t.length*64+e.length,s=L.Buffer.alloc(i);return qe(t.length<256),L.Buffer.from(n).copy(s,0),t.forEach(({signature:o},a)=>{o!==null&&(qe(o.length===64,"signature has invalid length"),L.Buffer.from(o).copy(s,n.length+a*64))}),e.copy(s,n.length+t.length*64),qe(s.length<=pi,`Transaction too large: ${s.length} > ${pi}`),s}get keys(){return qe(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return qe(this.instructions.length===1),this.instructions[0].programId}get data(){return qe(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const n=Pn(t);let i=[];for(let s=0;s<n;s++){const o=t.slice(0,to);t=t.slice(to),i.push(me.encode(L.Buffer.from(o)))}return je.populate(wr.from(t),i)}static populate(e,t=[]){const n=new je;return n.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(n.feePayer=e.accountKeys[0]),t.forEach((i,s)=>{const o={signature:i==me.encode(Hk)?null:me.decode(i),publicKey:e.accountKeys[s]};n.signatures.push(o)}),e.instructions.forEach(i=>{const s=i.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:n.signatures.some(c=>c.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});n.instructions.push(new et({keys:s,programId:e.accountKeys[i.programIdIndex],data:me.decode(i.data)}))}),n._message=e,n._json=n.toJSON(),n}}class If{constructor(e){this.payerKey=void 0,this.instructions=void 0,this.recentBlockhash=void 0,this.payerKey=e.payerKey,this.instructions=e.instructions,this.recentBlockhash=e.recentBlockhash}static decompile(e,t){const{header:n,compiledInstructions:i,recentBlockhash:s}=e,{numRequiredSignatures:o,numReadonlySignedAccounts:a,numReadonlyUnsignedAccounts:c}=n,l=o-a;qe(l>0,"Message header is invalid");const u=e.staticAccountKeys.length-o-c;qe(u>=0,"Message header is invalid");const d=e.getAccountKeys(t),m=d.get(0);if(m===void 0)throw new Error("Failed to decompile message because no account keys were found");const y=[];for(const S of i){const p=[];for(const v of S.accountKeyIndexes){const E=d.get(v);if(E===void 0)throw new Error(`Failed to find key for account key index ${v}`);const P=v<o;let K;P?K=v<l:v<d.staticAccountKeys.length?K=v-o<u:K=v-d.staticAccountKeys.length<d.accountKeysFromLookups.writable.length,p.push({pubkey:E,isSigner:v<n.numRequiredSignatures,isWritable:K})}const w=d.get(S.programIdIndex);if(w===void 0)throw new Error(`Failed to find program id for program id index ${S.programIdIndex}`);y.push(new et({programId:w,data:Ce(S.data),keys:p}))}return new If({payerKey:m,instructions:y,recentBlockhash:s})}compileToLegacyMessage(){return wr.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions})}compileToV0Message(e){return Xi.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions,addressLookupTableAccounts:e})}}class Ef{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,t!==void 0)qe(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{const n=[];for(let i=0;i<e.header.numRequiredSignatures;i++)n.push(new Uint8Array(to));this.signatures=n}this.message=e}serialize(){const e=this.message.serialize(),t=Array();Wn(t,this.signatures.length);const n=C([ge(t.length,"encodedSignaturesLength"),Oe(Uk(),this.signatures.length,"signatures"),ge(e.length,"serializedMessage")]),i=new Uint8Array(2048),s=n.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},i);return i.slice(0,s)}static deserialize(e){let t=[...e];const n=[],i=Pn(t);for(let o=0;o<i;o++)n.push(new Uint8Array(t.splice(0,to)));const s=Af.deserialize(new Uint8Array(t));return new Ef(s,n)}sign(e){const t=this.message.serialize(),n=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const i of e){const s=n.findIndex(o=>o.equals(i.publicKey));qe(s>=0,`Cannot sign with non signer key ${i.publicKey.toBase58()}`),this.signatures[s]=kf(t,i.secretKey)}}addSignature(e,t){qe(t.byteLength===64,"Signature must be 64 bytes long");const i=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(s=>s.equals(e));qe(i>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[i]=t}}const Yk=160,Jk=64,Qk=Yk/Jk,tg=1e3/Qk,Tr=new Y("SysvarC1ock11111111111111111111111111111111"),Xk=new Y("SysvarEpochSchedu1e111111111111111111111111"),Zk=new Y("Sysvar1nstructions1111111111111111111111111"),Pc=new Y("SysvarRecentB1ockHashes11111111111111111111"),Zi=new Y("SysvarRent111111111111111111111111111111111"),eS=new Y("SysvarRewards111111111111111111111111111111"),tS=new Y("SysvarS1otHashes111111111111111111111111111"),nS=new Y("SysvarS1otHistory11111111111111111111111111"),Rc=new Y("SysvarStakeHistory1111111111111111111111111");async function Id(r,e,t,n){const i=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot},s=await r.sendTransaction(e,t,i);let o;if(e.recentBlockhash!=null&&e.lastValidBlockHeight!=null)o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,signature:s,blockhash:e.recentBlockhash,lastValidBlockHeight:e.lastValidBlockHeight},n&&n.commitment)).value;else if(e.minNonceContextSlot!=null&&e.nonceInfo!=null){const{nonceInstruction:a}=e.nonceInfo,c=a.keys[0].pubkey;o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,minContextSlot:e.minNonceContextSlot,nonceAccountPubkey:c,nonceValue:e.nonceInfo.nonce,signature:s},n&&n.commitment)).value}else(n==null?void 0:n.abortSignal)!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),o=(await r.confirmTransaction(s,n&&n.commitment)).value;if(o.err)throw new Error(`Transaction ${s} failed (${JSON.stringify(o)})`);return s}function Di(r){return new Promise(e=>setTimeout(e,r))}function ze(r,e){const t=r.layout.span>=0?r.layout.span:eg(r,e),n=L.Buffer.alloc(t),i=Object.assign({instruction:r.index},e);return r.layout.encode(i,n),n}function Qe(r,e){let t;try{t=r.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.instruction!==r.index)throw new Error(`invalid instruction; instruction index mismatch ${t.instruction} != ${r.index}`);return t}const ng=_e("lamportsPerSignature"),rg=C([M("version"),M("state"),Ne("authorizedPubkey"),Ne("nonce"),C([ng],"feeCalculator")]),Ed=rg.span;class Tu{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=rg.decode(Ce(e),0);return new Tu({authorizedPubkey:new Y(t.authorizedPubkey),nonce:new Y(t.nonce).toString(),feeCalculator:t.feeCalculator})}}const rS=r=>{const e=r.decode.bind(r),t=r.encode.bind(r);return{decode:e,encode:t}},iS=r=>e=>{const t=ge(r,e),{encode:n,decode:i}=rS(t),s=t;return s.decode=(o,a)=>{const c=i(o,a);return hf(L.Buffer.from(c))},s.encode=(o,a,c)=>{const l=Ba(o,r);return n(l,a,c)},s},no=iS(8);class sS{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(lt))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a SystemInstruction");return i}static decodeCreateAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t,space:n,programId:i}=Qe(lt.Create,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,lamports:t,space:n,programId:new Y(i)}}static decodeTransfer(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t}=Qe(lt.Transfer,e.data);return{fromPubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,lamports:t}}static decodeTransferWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t,seed:n,programId:i}=Qe(lt.TransferWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,basePubkey:e.keys[1].pubkey,toPubkey:e.keys[2].pubkey,lamports:t,seed:n,programId:new Y(i)}}static decodeAllocate(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{space:t}=Qe(lt.Allocate,e.data);return{accountPubkey:e.keys[0].pubkey,space:t}}static decodeAllocateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:n,space:i,programId:s}=Qe(lt.AllocateWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new Y(t),seed:n,space:i,programId:new Y(s)}}static decodeAssign(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{programId:t}=Qe(lt.Assign,e.data);return{accountPubkey:e.keys[0].pubkey,programId:new Y(t)}}static decodeAssignWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:n,programId:i}=Qe(lt.AssignWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new Y(t),seed:n,programId:new Y(i)}}static decodeCreateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{base:t,seed:n,lamports:i,space:s,programId:o}=Qe(lt.CreateWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,basePubkey:new Y(t),seed:n,lamports:i,space:s,programId:new Y(o)}}static decodeNonceInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{authorized:t}=Qe(lt.InitializeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:new Y(t)}}static decodeNonceAdvance(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Qe(lt.AdvanceNonceAccount,e.data),{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static decodeNonceWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Qe(lt.WithdrawNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t}}static decodeNonceAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t}=Qe(lt.AuthorizeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[1].pubkey,newAuthorizedPubkey:new Y(t)}}static checkProgramId(e){if(!e.equals(Lt.programId))throw new Error("invalid instruction; programId is not SystemProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const lt=Object.freeze({Create:{index:0,layout:C([M("instruction"),De("lamports"),De("space"),Ne("programId")])},Assign:{index:1,layout:C([M("instruction"),Ne("programId")])},Transfer:{index:2,layout:C([M("instruction"),no("lamports")])},CreateWithSeed:{index:3,layout:C([M("instruction"),Ne("base"),Wi("seed"),De("lamports"),De("space"),Ne("programId")])},AdvanceNonceAccount:{index:4,layout:C([M("instruction")])},WithdrawNonceAccount:{index:5,layout:C([M("instruction"),De("lamports")])},InitializeNonceAccount:{index:6,layout:C([M("instruction"),Ne("authorized")])},AuthorizeNonceAccount:{index:7,layout:C([M("instruction"),Ne("authorized")])},Allocate:{index:8,layout:C([M("instruction"),De("space")])},AllocateWithSeed:{index:9,layout:C([M("instruction"),Ne("base"),Wi("seed"),De("space"),Ne("programId")])},AssignWithSeed:{index:10,layout:C([M("instruction"),Ne("base"),Wi("seed"),Ne("programId")])},TransferWithSeed:{index:11,layout:C([M("instruction"),no("lamports"),Wi("seed"),Ne("programId")])},UpgradeNonceAccount:{index:12,layout:C([M("instruction")])}});class Lt{constructor(){}static createAccount(e){const t=lt.Create,n=ze(t,{lamports:e.lamports,space:e.space,programId:Ce(e.programId.toBuffer())});return new et({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:n})}static transfer(e){let t,n;if("basePubkey"in e){const i=lt.TransferWithSeed;t=ze(i,{lamports:BigInt(e.lamports),seed:e.seed,programId:Ce(e.programId.toBuffer())}),n=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}else{const i=lt.Transfer;t=ze(i,{lamports:BigInt(e.lamports)}),n=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}return new et({keys:n,programId:this.programId,data:t})}static assign(e){let t,n;if("basePubkey"in e){const i=lt.AssignWithSeed;t=ze(i,{base:Ce(e.basePubkey.toBuffer()),seed:e.seed,programId:Ce(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=lt.Assign;t=ze(i,{programId:Ce(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new et({keys:n,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=lt.CreateWithSeed,n=ze(t,{base:Ce(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:Ce(e.programId.toBuffer())});let i=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey!=e.fromPubkey&&i.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new et({keys:i,programId:this.programId,data:n})}static createNonceAccount(e){const t=new je;"basePubkey"in e&&"seed"in e?t.add(Lt.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:Ed,programId:this.programId})):t.add(Lt.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:Ed,programId:this.programId}));const n={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(n)),t}static nonceInitialize(e){const t=lt.InitializeNonceAccount,n=ze(t,{authorized:Ce(e.authorizedPubkey.toBuffer())}),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Pc,isSigner:!1,isWritable:!1},{pubkey:Zi,isSigner:!1,isWritable:!1}],programId:this.programId,data:n};return new et(i)}static nonceAdvance(e){const t=lt.AdvanceNonceAccount,n=ze(t),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Pc,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n};return new et(i)}static nonceWithdraw(e){const t=lt.WithdrawNonceAccount,n=ze(t,{lamports:e.lamports});return new et({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:Pc,isSigner:!1,isWritable:!1},{pubkey:Zi,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static nonceAuthorize(e){const t=lt.AuthorizeNonceAccount,n=ze(t,{authorized:Ce(e.newAuthorizedPubkey.toBuffer())});return new et({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static allocate(e){let t,n;if("basePubkey"in e){const i=lt.AllocateWithSeed;t=ze(i,{base:Ce(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:Ce(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=lt.Allocate;t=ze(i,{space:e.space}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new et({keys:n,programId:this.programId,data:t})}}Lt.programId=new Y("11111111111111111111111111111111");const oS=pi-300;class es{constructor(){}static getMinNumSignatures(e){return 2*(Math.ceil(e/es.chunkSize)+1+1)}static async load(e,t,n,i,s){{const d=await e.getMinimumBalanceForRentExemption(s.length),m=await e.getAccountInfo(n.publicKey,"confirmed");let y=null;if(m!==null){if(m.executable)return console.error("Program load failed, account is already executable"),!1;m.data.length!==s.length&&(y=y||new je,y.add(Lt.allocate({accountPubkey:n.publicKey,space:s.length}))),m.owner.equals(i)||(y=y||new je,y.add(Lt.assign({accountPubkey:n.publicKey,programId:i}))),m.lamports<d&&(y=y||new je,y.add(Lt.transfer({fromPubkey:t.publicKey,toPubkey:n.publicKey,lamports:d-m.lamports})))}else y=new je().add(Lt.createAccount({fromPubkey:t.publicKey,newAccountPubkey:n.publicKey,lamports:d>0?d:1,space:s.length,programId:i}));y!==null&&await Id(e,y,[t,n],{commitment:"confirmed"})}const o=C([M("instruction"),M("offset"),M("bytesLength"),M("bytesLengthPadding"),Oe(te("byte"),Kt(M(),-8),"bytes")]),a=es.chunkSize;let c=0,l=s,u=[];for(;l.length>0;){const d=l.slice(0,a),m=L.Buffer.alloc(a+16);o.encode({instruction:0,offset:c,bytes:d,bytesLength:0,bytesLengthPadding:0},m);const y=new je().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0}],programId:i,data:m});u.push(Id(e,y,[t,n],{commitment:"confirmed"})),e._rpcEndpoint.includes("solana.com")&&await Di(1e3/4),c+=a,l=l.slice(a)}await Promise.all(u);{const d=C([M("instruction")]),m=L.Buffer.alloc(d.span);d.encode({instruction:1},m);const y=new je().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0},{pubkey:Zi,isSigner:!1,isWritable:!1}],programId:i,data:m}),S="processed",p=await e.sendTransaction(y,[t,n],{preflightCommitment:S}),{context:w,value:v}=await e.confirmTransaction({signature:p,lastValidBlockHeight:y.lastValidBlockHeight,blockhash:y.recentBlockhash},S);if(v.err)throw new Error(`Transaction ${p} failed (${JSON.stringify(v)})`);for(;;){try{if(await e.getSlot({commitment:S})>w.slot)break}catch{}await new Promise(E=>setTimeout(E,Math.round(tg/2)))}}return!0}}es.chunkSize=oS;const aS=new Y("BPFLoader2111111111111111111111111111111111");class cS{static getMinNumSignatures(e){return es.getMinNumSignatures(e)}static load(e,t,n,i,s){return es.load(e,t,n,s,i)}}function uS(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var lS=Object.prototype.toString,dS=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};function Qo(r,e){var t,n,i,s,o,a,c;if(r===!0)return"true";if(r===!1)return"false";switch(typeof r){case"object":if(r===null)return null;if(r.toJSON&&typeof r.toJSON=="function")return Qo(r.toJSON(),e);if(c=lS.call(r),c==="[object Array]"){for(i="[",n=r.length-1,t=0;t<n;t++)i+=Qo(r[t],!0)+",";return n>-1&&(i+=Qo(r[t],!0)),i+"]"}else if(c==="[object Object]"){for(s=dS(r).sort(),n=s.length,i="",t=0;t<n;)o=s[t],a=Qo(r[o],!1),a!==void 0&&(i&&(i+=","),i+=JSON.stringify(o)+":"+a),t++;return"{"+i+"}"}else return JSON.stringify(r);case"function":case"undefined":return e?null:void 0;case"string":return JSON.stringify(r);default:return isFinite(r)?r:null}}var fS=function(r){var e=Qo(r,!1);if(e!==void 0)return""+e},Gh=uS(fS);const qo=32;function jl(r){let e=0;for(;r>1;)r/=2,e++;return e}function hS(r){return r===0?1:(r--,r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16,r|=r>>32,r+1)}class ig{constructor(e,t,n,i,s){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=n,this.firstNormalEpoch=i,this.firstNormalSlot=s}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const t=jl(hS(e+qo+1))-jl(qo)-1,n=this.getSlotsInEpoch(t),i=e-(n-qo);return[t,i]}else{const t=e-this.firstNormalSlot,n=Math.floor(t/this.slotsPerEpoch),i=this.firstNormalEpoch+n,s=t%this.slotsPerEpoch;return[i,s]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*qo:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+jl(qo)):this.slotsPerEpoch}}class ya extends Error{constructor(e,t){super(e),this.logs=void 0,this.logs=t}}const pS={JSON_RPC_SERVER_ERROR_BLOCK_CLEANED_UP:-32001,JSON_RPC_SERVER_ERROR_SEND_TRANSACTION_PREFLIGHT_FAILURE:-32002,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_VERIFICATION_FAILURE:-32003,JSON_RPC_SERVER_ERROR_BLOCK_NOT_AVAILABLE:-32004,JSON_RPC_SERVER_ERROR_NODE_UNHEALTHY:-32005,JSON_RPC_SERVER_ERROR_TRANSACTION_PRECOMPILE_VERIFICATION_FAILURE:-32006,JSON_RPC_SERVER_ERROR_SLOT_SKIPPED:-32007,JSON_RPC_SERVER_ERROR_NO_SNAPSHOT:-32008,JSON_RPC_SERVER_ERROR_LONG_TERM_STORAGE_SLOT_SKIPPED:-32009,JSON_RPC_SERVER_ERROR_KEY_EXCLUDED_FROM_SECONDARY_INDEX:-32010,JSON_RPC_SERVER_ERROR_TRANSACTION_HISTORY_NOT_AVAILABLE:-32011,JSON_RPC_SCAN_ERROR:-32012,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_LEN_MISMATCH:-32013,JSON_RPC_SERVER_ERROR_BLOCK_STATUS_NOT_AVAILABLE_YET:-32014,JSON_RPC_SERVER_ERROR_UNSUPPORTED_TRANSACTION_VERSION:-32015,JSON_RPC_SERVER_ERROR_MIN_CONTEXT_SLOT_NOT_REACHED:-32016};class he extends Error{constructor({code:e,message:t,data:n},i){super(i!=null?`${i}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=n,this.name="SolanaJSONRPCError"}}var yS=globalThis.fetch;class gS extends Lk{constructor(e,t,n){const i=s=>{const o=Kk(s,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in o?this.underlyingSocket=o.socket:this.underlyingSocket=o,o};super(i,e,t,n),this.underlyingSocket=void 0}call(...e){var n;const t=(n=this.underlyingSocket)==null?void 0:n.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){var n;const t=(n=this.underlyingSocket)==null?void 0:n.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}function mS(r,e){let t;try{t=r.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.typeIndex!==r.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${r.index}`);return t}const Hh=56;class Pd{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=mS(bS,e),n=e.length-Hh;qe(n>=0,"lookup table is invalid"),qe(n%32===0,"lookup table is invalid");const i=n/32,{addresses:s}=C([Oe(Ne(),i,"addresses")]).decode(e.slice(Hh));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new Y(t.authority[0]):void 0,addresses:s.map(o=>new Y(o))}}}const bS={index:1,layout:C([M("typeIndex"),no("deactivationSlot"),_e("lastExtendedSlot"),te("lastExtendedStartIndex"),te(),Oe(Ne(),Kt(te(),-1),"authority")])},wS=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function kS(r){const e=r.match(wS);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${r}\``);const[t,n,i,s]=e,o=r.startsWith("https:")?"wss:":"ws:",a=i==null?null:parseInt(i.slice(1),10),c=a==null?"":`:${a+1}`;return`${o}//${n}${c}${s}`}const Nt=Ka(bf(Y),re(),r=>new Y(r)),sg=wf([re(),_t("base64")]),Pf=Ka(bf(L.Buffer),sg,r=>L.Buffer.from(r[0],"base64")),og=30*1e3;function SS(r){if(/^https?:/.test(r)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return r}function pt(r){let e,t;if(typeof r=="string")e=r;else if(r){const{commitment:n,...i}=r;e=n,t=i}return{commitment:e,config:t}}function ag(r){return Cn([J({jsonrpc:_t("2.0"),id:re(),result:r}),J({jsonrpc:_t("2.0"),id:re(),error:J({code:La(),message:re(),data:ve(Pk())})})])}const vS=ag(La());function Be(r){return Ka(ag(r),vS,e=>"error"in e?e:{...e,result:se(e.result,r)})}function Et(r){return Be(J({context:J({slot:$()}),value:r}))}function Ou(r){return J({context:J({slot:$()}),value:r})}function ql(r,e){return r===0?new Xi({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new Y(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:me.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new wr(e)}const _S=J({foundation:$(),foundationTerm:$(),initial:$(),taper:$(),terminal:$()}),AS=Be(oe(ae(J({epoch:$(),effectiveSlot:$(),amount:$(),postBalance:$(),commission:ve(ae($()))})))),IS=oe(J({slot:$(),prioritizationFee:$()})),ES=J({total:$(),validator:$(),foundation:$(),epoch:$()}),PS=J({epoch:$(),slotIndex:$(),slotsInEpoch:$(),absoluteSlot:$(),blockHeight:ve($()),transactionCount:ve($())}),RS=J({slotsPerEpoch:$(),leaderScheduleSlotOffset:$(),warmup:$r(),firstNormalEpoch:$(),firstNormalSlot:$()}),TS=Hy(re(),oe($())),ps=ae(Cn([J({}),re()])),OS=J({err:ps}),BS=_t("receivedSignature"),xS=J({"solana-core":re(),"feature-set":ve($())}),Yh=Et(J({err:ae(Cn([J({}),re()])),logs:ae(oe(re())),accounts:ve(ae(oe(ae(J({executable:$r(),owner:re(),lamports:$(),data:oe(re()),rentEpoch:ve($())}))))),unitsConsumed:ve($()),returnData:ve(ae(J({programId:re(),data:wf([re(),_t("base64")])})))})),CS=Et(J({byIdentity:Hy(re(),oe($())),range:J({firstSlot:$(),lastSlot:$()})}));function MS(r,e,t,n,i,s){const o=t||yS;let a;s!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let c;return n&&(c=async(u,d)=>{const m=await new Promise((y,S)=>{try{n(u,d,(p,w)=>y([p,w]))}catch(p){S(p)}});return await o(...m)}),new Mk(async(u,d)=>{const m={method:"POST",body:u,agent:a,headers:Object.assign({"Content-Type":"application/json"},e||{},Lv)};try{let y=5,S,p=500;for(;c?S=await c(r,m):S=await o(r,m),!(S.status!==429||i===!0||(y-=1,y===0));)console.log(`Server responded with ${S.status} ${S.statusText}.  Retrying after ${p}ms delay...`),await Di(p),p*=2;const w=await S.text();S.ok?d(null,w):d(new Error(`${S.status} ${S.statusText}: ${w}`))}catch(y){y instanceof Error&&d(y)}},{})}function LS(r){return(e,t)=>new Promise((n,i)=>{r.request(e,t,(s,o)=>{if(s){i(s);return}n(o)})})}function KS(r){return e=>new Promise((t,n)=>{e.length===0&&t([]);const i=e.map(s=>r.request(s.methodName,s.args));r.request(i,(s,o)=>{if(s){n(s);return}t(o)})})}const NS=Be(_S),$S=Be(ES),DS=Be(IS),zS=Be(PS),WS=Be(RS),VS=Be(TS),US=Be($()),FS=Et(J({total:$(),circulating:$(),nonCirculating:$(),nonCirculatingAccounts:oe(Nt)})),Rd=J({amount:re(),uiAmount:ae($()),decimals:$(),uiAmountString:ve(re())}),jS=Et(oe(J({address:Nt,amount:re(),uiAmount:ae($()),decimals:$(),uiAmountString:ve(re())}))),qS=Et(oe(J({pubkey:Nt,account:J({executable:$r(),owner:Nt,lamports:$(),data:Pf,rentEpoch:$()})}))),Td=J({program:re(),parsed:La(),space:$()}),GS=Et(oe(J({pubkey:Nt,account:J({executable:$r(),owner:Nt,lamports:$(),data:Td,rentEpoch:$()})}))),HS=Et(oe(J({lamports:$(),address:Nt}))),ga=J({executable:$r(),owner:Nt,lamports:$(),data:Pf,rentEpoch:$()}),YS=J({pubkey:Nt,account:ga}),JS=Ka(Cn([bf(L.Buffer),Td]),Cn([sg,Td]),r=>Array.isArray(r)?se(r,Pf):r),Od=J({executable:$r(),owner:Nt,lamports:$(),data:JS,rentEpoch:$()}),QS=J({pubkey:Nt,account:Od}),XS=J({state:Cn([_t("active"),_t("inactive"),_t("activating"),_t("deactivating")]),active:$(),inactive:$()}),ZS=Be(oe(J({signature:re(),slot:$(),err:ps,memo:ae(re()),blockTime:ve(ae($()))}))),ev=Be(oe(J({signature:re(),slot:$(),err:ps,memo:ae(re()),blockTime:ve(ae($()))}))),tv=J({subscription:$(),result:Ou(ga)}),nv=J({pubkey:Nt,account:ga}),rv=J({subscription:$(),result:Ou(nv)}),iv=J({parent:$(),slot:$(),root:$()}),sv=J({subscription:$(),result:iv}),ov=Cn([J({type:Cn([_t("firstShredReceived"),_t("completed"),_t("optimisticConfirmation"),_t("root")]),slot:$(),timestamp:$()}),J({type:_t("createdBank"),parent:$(),slot:$(),timestamp:$()}),J({type:_t("frozen"),slot:$(),timestamp:$(),stats:J({numTransactionEntries:$(),numSuccessfulTransactions:$(),numFailedTransactions:$(),maxTransactionsPerEntry:$()})}),J({type:_t("dead"),slot:$(),timestamp:$(),err:re()})]),av=J({subscription:$(),result:ov}),cv=J({subscription:$(),result:Ou(Cn([OS,BS]))}),uv=J({subscription:$(),result:$()}),lv=J({pubkey:re(),gossip:ae(re()),tpu:ae(re()),rpc:ae(re()),version:ae(re())}),Jh=J({votePubkey:re(),nodePubkey:re(),activatedStake:$(),epochVoteAccount:$r(),epochCredits:oe(wf([$(),$(),$()])),commission:$(),lastVote:$(),rootSlot:ae($())}),dv=Be(J({current:oe(Jh),delinquent:oe(Jh)})),fv=Cn([_t("processed"),_t("confirmed"),_t("finalized")]),hv=J({slot:$(),confirmations:ae($()),err:ps,confirmationStatus:ve(fv)}),pv=Et(oe(ae(hv))),yv=Be($()),cg=J({accountKey:Nt,writableIndexes:oe($()),readonlyIndexes:oe($())}),Rf=J({signatures:oe(re()),message:J({accountKeys:oe(re()),header:J({numRequiredSignatures:$(),numReadonlySignedAccounts:$(),numReadonlyUnsignedAccounts:$()}),instructions:oe(J({accounts:oe($()),data:re(),programIdIndex:$()})),recentBlockhash:re(),addressTableLookups:ve(oe(cg))})}),ug=J({pubkey:Nt,signer:$r(),writable:$r(),source:ve(Cn([_t("transaction"),_t("lookupTable")]))}),lg=J({accountKeys:oe(ug),signatures:oe(re())}),dg=J({parsed:La(),program:re(),programId:Nt}),fg=J({accounts:oe(Nt),data:re(),programId:Nt}),gv=Cn([fg,dg]),mv=Cn([J({parsed:La(),program:re(),programId:re()}),J({accounts:oe(re()),data:re(),programId:re()})]),hg=Ka(gv,mv,r=>"accounts"in r?se(r,fg):se(r,dg)),pg=J({signatures:oe(re()),message:J({accountKeys:oe(ug),instructions:oe(hg),recentBlockhash:re(),addressTableLookups:ve(ae(oe(cg)))})}),Uc=J({accountIndex:$(),mint:re(),owner:ve(re()),uiTokenAmount:Rd}),yg=J({writable:oe(Nt),readonly:oe(Nt)}),Bu=J({err:ps,fee:$(),innerInstructions:ve(ae(oe(J({index:$(),instructions:oe(J({accounts:oe($()),data:re(),programIdIndex:$()}))})))),preBalances:oe($()),postBalances:oe($()),logMessages:ve(ae(oe(re()))),preTokenBalances:ve(ae(oe(Uc))),postTokenBalances:ve(ae(oe(Uc))),loadedAddresses:ve(yg),computeUnitsConsumed:ve($())}),Tf=J({err:ps,fee:$(),innerInstructions:ve(ae(oe(J({index:$(),instructions:oe(hg)})))),preBalances:oe($()),postBalances:oe($()),logMessages:ve(ae(oe(re()))),preTokenBalances:ve(ae(oe(Uc))),postTokenBalances:ve(ae(oe(Uc))),loadedAddresses:ve(yg),computeUnitsConsumed:ve($())}),Eo=Cn([_t(0),_t("legacy")]),ys=J({pubkey:re(),lamports:$(),postBalance:ae($()),rewardType:ae(re()),commission:ve(ae($()))}),bv=Be(ae(J({blockhash:re(),previousBlockhash:re(),parentSlot:$(),transactions:oe(J({transaction:Rf,meta:ae(Bu),version:ve(Eo)})),rewards:ve(oe(ys)),blockTime:ae($()),blockHeight:ae($())}))),wv=Be(ae(J({blockhash:re(),previousBlockhash:re(),parentSlot:$(),rewards:ve(oe(ys)),blockTime:ae($()),blockHeight:ae($())}))),kv=Be(ae(J({blockhash:re(),previousBlockhash:re(),parentSlot:$(),transactions:oe(J({transaction:lg,meta:ae(Bu),version:ve(Eo)})),rewards:ve(oe(ys)),blockTime:ae($()),blockHeight:ae($())}))),Sv=Be(ae(J({blockhash:re(),previousBlockhash:re(),parentSlot:$(),transactions:oe(J({transaction:pg,meta:ae(Tf),version:ve(Eo)})),rewards:ve(oe(ys)),blockTime:ae($()),blockHeight:ae($())}))),vv=Be(ae(J({blockhash:re(),previousBlockhash:re(),parentSlot:$(),transactions:oe(J({transaction:lg,meta:ae(Tf),version:ve(Eo)})),rewards:ve(oe(ys)),blockTime:ae($()),blockHeight:ae($())}))),_v=Be(ae(J({blockhash:re(),previousBlockhash:re(),parentSlot:$(),rewards:ve(oe(ys)),blockTime:ae($()),blockHeight:ae($())}))),Av=Be(ae(J({blockhash:re(),previousBlockhash:re(),parentSlot:$(),transactions:oe(J({transaction:Rf,meta:ae(Bu)})),rewards:ve(oe(ys)),blockTime:ae($())}))),Qh=Be(ae(J({blockhash:re(),previousBlockhash:re(),parentSlot:$(),signatures:oe(re()),blockTime:ae($())}))),Gl=Be(ae(J({slot:$(),meta:Bu,blockTime:ve(ae($())),transaction:Rf,version:ve(Eo)}))),ac=Be(ae(J({slot:$(),transaction:pg,meta:ae(Tf),blockTime:ve(ae($())),version:ve(Eo)}))),Iv=Et(J({blockhash:re(),feeCalculator:J({lamportsPerSignature:$()})})),Ev=Et(J({blockhash:re(),lastValidBlockHeight:$()})),Pv=Et($r()),Rv=J({slot:$(),numTransactions:$(),numSlots:$(),samplePeriodSecs:$()}),Tv=Be(oe(Rv)),Ov=Et(ae(J({feeCalculator:J({lamportsPerSignature:$()})}))),Bv=Be(re()),xv=Be(re()),Cv=J({err:ps,logs:oe(re()),signature:re()}),Mv=J({result:Ou(Cv),subscription:$()}),Lv={"solana-client":"js/0.0.0-development"};class Kv{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const l={};return async u=>{const{commitment:d,config:m}=pt(u),y=this._buildArgs([],d,void 0,m),S=Gh(y);return l[S]=l[S]??(async()=>{try{const p=await this._rpcRequest("getBlockHeight",y),w=se(p,Be($()));if("error"in w)throw new he(w.error,"failed to get block height information");return w.result}finally{delete l[S]}})(),await l[S]}})();let n,i,s,o,a,c;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,n=t.wsEndpoint,i=t.httpHeaders,s=t.fetch,o=t.fetchMiddleware,a=t.disableRetryOnRateLimit,c=t.httpAgent),this._rpcEndpoint=SS(e),this._rpcWsEndpoint=n||kS(e),this._rpcClient=MS(e,i,s,o,a,c),this._rpcRequest=LS(this._rpcClient),this._rpcBatchRequest=KS(this._rpcClient),this._rpcWebSocket=new gS(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:n,config:i}=pt(t),s=this._buildArgs([e.toBase58()],n,void 0,i),o=await this._rpcRequest("getBalance",s),a=se(o,Et($()));if("error"in a)throw new he(a.error,`failed to get balance for ${e.toBase58()}`);return a.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+n)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),n=se(t,Be(ae($())));if("error"in n)throw new he(n.error,`failed to get block time for slot ${e}`);return n.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=se(e,Be($()));if("error"in t)throw new he(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=se(e,US);if("error"in t)throw new he(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};const n=await this._rpcRequest("getSupply",[t]),i=se(n,FS);if("error"in i)throw new he(i.error,"failed to get supply");return i.result}async getTokenSupply(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenSupply",n),s=se(i,Et(Rd));if("error"in s)throw new he(s.error,"failed to get token supply");return s.result}async getTokenAccountBalance(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenAccountBalance",n),s=se(i,Et(Rd));if("error"in s)throw new he(s.error,"failed to get token account balance");return s.result}async getTokenAccountsByOwner(e,t,n){const{commitment:i,config:s}=pt(n);let o=[e.toBase58()];"mint"in t?o.push({mint:t.mint.toBase58()}):o.push({programId:t.programId.toBase58()});const a=this._buildArgs(o,i,"base64",s),c=await this._rpcRequest("getTokenAccountsByOwner",a),l=se(c,qS);if("error"in l)throw new he(l.error,`failed to get token accounts owned by account ${e.toBase58()}`);return l.result}async getParsedTokenAccountsByOwner(e,t,n){let i=[e.toBase58()];"mint"in t?i.push({mint:t.mint.toBase58()}):i.push({programId:t.programId.toBase58()});const s=this._buildArgs(i,n,"jsonParsed"),o=await this._rpcRequest("getTokenAccountsByOwner",s),a=se(o,GS);if("error"in a)throw new he(a.error,`failed to get token accounts owned by account ${e.toBase58()}`);return a.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},n=t.filter||t.commitment?[t]:[],i=await this._rpcRequest("getLargestAccounts",n),s=se(i,HS);if("error"in s)throw new he(s.error,"failed to get largest accounts");return s.result}async getTokenLargestAccounts(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenLargestAccounts",n),s=se(i,jS);if("error"in s)throw new he(s.error,"failed to get token largest accounts");return s.result}async getAccountInfoAndContext(e,t){const{commitment:n,config:i}=pt(t),s=this._buildArgs([e.toBase58()],n,"base64",i),o=await this._rpcRequest("getAccountInfo",s),a=se(o,Et(ae(ga)));if("error"in a)throw new he(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getParsedAccountInfo(e,t){const{commitment:n,config:i}=pt(t),s=this._buildArgs([e.toBase58()],n,"jsonParsed",i),o=await this._rpcRequest("getAccountInfo",s),a=se(o,Et(ae(Od)));if("error"in a)throw new he(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(n){throw new Error("failed to get info about account "+e.toBase58()+": "+n)}}async getMultipleParsedAccounts(e,t){const{commitment:n,config:i}=pt(t),s=e.map(l=>l.toBase58()),o=this._buildArgs([s],n,"jsonParsed",i),a=await this._rpcRequest("getMultipleAccounts",o),c=se(a,Et(oe(ae(Od))));if("error"in c)throw new he(c.error,`failed to get info for accounts ${s}`);return c.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:n,config:i}=pt(t),s=e.map(l=>l.toBase58()),o=this._buildArgs([s],n,"base64",i),a=await this._rpcRequest("getMultipleAccounts",o),c=se(a,Et(oe(ae(ga))));if("error"in c)throw new he(c.error,`failed to get info for accounts ${s}`);return c.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,n){const{commitment:i,config:s}=pt(t),o=this._buildArgs([e.toBase58()],i,void 0,{...s,epoch:n??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getStakeActivation",o),c=se(a,Be(XS));if("error"in c)throw new he(c.error,`failed to get Stake Activation ${e.toBase58()}`);return c.result}async getProgramAccounts(e,t){const{commitment:n,config:i}=pt(t),{encoding:s,...o}=i||{},a=this._buildArgs([e.toBase58()],n,s||"base64",o),c=await this._rpcRequest("getProgramAccounts",a),l=oe(YS),u=o.withContext===!0?se(c,Et(l)):se(c,Be(l));if("error"in u)throw new he(u.error,`failed to get accounts owned by program ${e.toBase58()}`);return u.result}async getParsedProgramAccounts(e,t){const{commitment:n,config:i}=pt(t),s=this._buildArgs([e.toBase58()],n,"jsonParsed",i),o=await this._rpcRequest("getProgramAccounts",s),a=se(o,Be(oe(QS)));if("error"in a)throw new he(a.error,`failed to get accounts owned by program ${e.toBase58()}`);return a.result}async confirmTransaction(e,t){var s;let n;if(typeof e=="string")n=e;else{const o=e;if((s=o.abortSignal)!=null&&s.aborted)return Promise.reject(o.abortSignal.reason);n=o.signature}let i;try{i=me.decode(n)}catch{throw new Error("signature must be base58 encoded: "+n)}return qe(i.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:n}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,n)=>{e!=null&&(e.aborted?n(e.reason):e.addEventListener("abort",()=>{n(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let n,i,s=!1;const o=new Promise((c,l)=>{try{n=this.onSignature(t,(d,m)=>{n=void 0;const y={context:m,value:d};c({__type:qr.PROCESSED,response:y})},e);const u=new Promise(d=>{n==null?d():i=this._onSubscriptionStateChange(n,m=>{m==="subscribed"&&d()})});(async()=>{if(await u,s)return;const d=await this.getSignatureStatus(t);if(s||d==null)return;const{context:m,value:y}=d;if(y!=null)if(y!=null&&y.err)l(y.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(y.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(y.confirmationStatus==="processed"||y.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}s=!0,c({__type:qr.PROCESSED,response:{context:m,value:y}})}})()}catch(u){l(u)}});return{abortConfirmation:()=>{i&&(i(),i=void 0),n!=null&&(this.removeSignatureListener(n),n=void 0)},confirmationPromise:o}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:n,signature:i}}){let s=!1;const o=new Promise(d=>{const m=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let y=await m();if(!s){for(;y<=n;)if(await Di(1e3),s||(y=await m(),s))return;d({__type:qr.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:a,confirmationPromise:c}=this.getTransactionConfirmationPromise({commitment:e,signature:i}),l=this.getCancellationPromise(t);let u;try{const d=await Promise.race([l,c,o]);if(d.__type===qr.PROCESSED)u=d.response;else throw new vf(i)}finally{s=!0,a()}return u}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:n,nonceAccountPubkey:i,nonceValue:s,signature:o}}){let a=!1;const c=new Promise(y=>{let S=s,p=null;const w=async()=>{try{const{context:v,value:E}=await this.getNonceAndContext(i,{commitment:e,minContextSlot:n});return p=v.slot,E==null?void 0:E.nonce}catch{return S}};(async()=>{if(S=await w(),!a)for(;;){if(s!==S){y({__type:qr.NONCE_INVALID,slotInWhichNonceDidAdvance:p});return}if(await Di(2e3),a||(S=await w(),a))return}})()}),{abortConfirmation:l,confirmationPromise:u}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),d=this.getCancellationPromise(t);let m;try{const y=await Promise.race([d,u,c]);if(y.__type===qr.PROCESSED)m=y.response;else{let S;for(;;){const p=await this.getSignatureStatus(o);if(p==null)break;if(p.context.slot<(y.slotInWhichNonceDidAdvance??n)){await Di(400);continue}S=p;break}if(S!=null&&S.value){const p=e||"finalized",{confirmationStatus:w}=S.value;switch(p){case"processed":case"recent":if(w!=="processed"&&w!=="confirmed"&&w!=="finalized")throw new Ls(o);break;case"confirmed":case"single":case"singleGossip":if(w!=="confirmed"&&w!=="finalized")throw new Ls(o);break;case"finalized":case"max":case"root":if(w!=="finalized")throw new Ls(o);break;default:(v=>{})(p)}m={context:S.context,value:{err:S.value.err}}}else throw new Ls(o)}}finally{a=!0,l()}return m}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let n;const i=new Promise(c=>{let l=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{l=this._confirmTransactionInitialTimeout||3e4;break}}n=setTimeout(()=>c({__type:qr.TIMED_OUT,timeoutMs:l}),l)}),{abortConfirmation:s,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let a;try{const c=await Promise.race([o,i]);if(c.__type===qr.PROCESSED)a=c.response;else throw new _f(t,c.timeoutMs/1e3)}finally{clearTimeout(n),s()}return a}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=se(e,Be(oe(lv)));if("error"in t)throw new he(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getVoteAccounts",t),i=se(n,dv);if("error"in i)throw new he(i.error,"failed to get vote accounts");return i.result}async getSlot(e){const{commitment:t,config:n}=pt(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getSlot",i),o=se(s,Be($()));if("error"in o)throw new he(o.error,"failed to get slot");return o.result}async getSlotLeader(e){const{commitment:t,config:n}=pt(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getSlotLeader",i),o=se(s,Be(re()));if("error"in o)throw new he(o.error,"failed to get slot leader");return o.result}async getSlotLeaders(e,t){const n=[e,t],i=await this._rpcRequest("getSlotLeaders",n),s=se(i,Be(oe(Nt)));if("error"in s)throw new he(s.error,"failed to get slot leaders");return s.result}async getSignatureStatus(e,t){const{context:n,value:i}=await this.getSignatureStatuses([e],t);qe(i.length===1);const s=i[0];return{context:n,value:s}}async getSignatureStatuses(e,t){const n=[e];t&&n.push(t);const i=await this._rpcRequest("getSignatureStatuses",n),s=se(i,pv);if("error"in s)throw new he(s.error,"failed to get signature status");return s.result}async getTransactionCount(e){const{commitment:t,config:n}=pt(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getTransactionCount",i),o=se(s,Be($()));if("error"in o)throw new he(o.error,"failed to get transaction count");return o.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getInflationGovernor",t),i=se(n,NS);if("error"in i)throw new he(i.error,"failed to get inflation");return i.result}async getInflationReward(e,t,n){const{commitment:i,config:s}=pt(n),o=this._buildArgs([e.map(l=>l.toBase58())],i,void 0,{...s,epoch:t??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getInflationReward",o),c=se(a,AS);if("error"in c)throw new he(c.error,"failed to get inflation reward");return c.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=se(e,$S);if("error"in t)throw new he(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:n}=pt(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getEpochInfo",i),o=se(s,zS);if("error"in o)throw new he(o.error,"failed to get epoch info");return o.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=se(e,WS);if("error"in t)throw new he(t.error,"failed to get epoch schedule");const n=t.result;return new ig(n.slotsPerEpoch,n.leaderScheduleSlotOffset,n.warmup,n.firstNormalEpoch,n.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=se(e,VS);if("error"in t)throw new he(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const n=this._buildArgs([e],t),i=await this._rpcRequest("getMinimumBalanceForRentExemption",n),s=se(i,yv);return"error"in s?(console.warn("Unable to fetch minimum balance for rent exemption"),0):s.result}async getRecentBlockhashAndContext(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getRecentBlockhash",t),i=se(n,Iv);if("error"in i)throw new he(i.error,"failed to get recent blockhash");return i.result}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),n=se(t,Tv);if("error"in n)throw new he(n.error,"failed to get recent performance samples");return n.result}async getFeeCalculatorForBlockhash(e,t){const n=this._buildArgs([e],t),i=await this._rpcRequest("getFeeCalculatorForBlockhash",n),s=se(i,Ov);if("error"in s)throw new he(s.error,"failed to get fee calculator");const{context:o,value:a}=s.result;return{context:o,value:a!==null?a.feeCalculator:null}}async getFeeForMessage(e,t){const n=Ce(e.serialize()).toString("base64"),i=this._buildArgs([n],t),s=await this._rpcRequest("getFeeForMessage",i),o=se(s,Et(ae($())));if("error"in o)throw new he(o.error,"failed to get fee for message");if(o.result===null)throw new Error("invalid blockhash");return o.result}async getRecentPrioritizationFees(e){var o;const t=(o=e==null?void 0:e.lockedWritableAccounts)==null?void 0:o.map(a=>a.toBase58()),n=t!=null&&t.length?[t]:[],i=await this._rpcRequest("getRecentPrioritizationFees",n),s=se(i,DS);if("error"in s)throw new he(s.error,"failed to get recent prioritization fees");return s.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:n}=pt(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getLatestBlockhash",i),o=se(s,Ev);if("error"in o)throw new he(o.error,"failed to get latest blockhash");return o.result}async isBlockhashValid(e,t){const{commitment:n,config:i}=pt(t),s=this._buildArgs([e],n,void 0,i),o=await this._rpcRequest("isBlockhashValid",s),a=se(o,Pv);if("error"in a)throw new he(a.error,"failed to determine if the blockhash `"+e+"`is valid");return a.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=se(e,Be(xS));if("error"in t)throw new he(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=se(e,Be(re()));if("error"in t)throw new he(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:n,config:i}=pt(t),s=this._buildArgsAtLeastConfirmed([e],n,void 0,i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=se(o,kv);if("error"in a)throw a.error;return a.result}case"none":{const a=se(o,wv);if("error"in a)throw a.error;return a.result}default:{const a=se(o,bv);if("error"in a)throw a.error;const{result:c}=a;return c?{...c,transactions:c.transactions.map(({transaction:l,meta:u,version:d})=>({meta:u,transaction:{...l,message:ql(d,l.message)},version:d}))}:null}}}catch(a){throw new he(a,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:n,config:i}=pt(t),s=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=se(o,vv);if("error"in a)throw a.error;return a.result}case"none":{const a=se(o,_v);if("error"in a)throw a.error;return a.result}default:{const a=se(o,Sv);if("error"in a)throw a.error;return a.result}}}catch(a){throw new he(a,"failed to get block")}}async getBlockProduction(e){let t,n;if(typeof e=="string")n=e;else if(e){const{commitment:a,...c}=e;n=a,t=c}const i=this._buildArgs([],n,"base64",t),s=await this._rpcRequest("getBlockProduction",i),o=se(s,CS);if("error"in o)throw new he(o.error,"failed to get block production information");return o.result}async getTransaction(e,t){const{commitment:n,config:i}=pt(t),s=this._buildArgsAtLeastConfirmed([e],n,void 0,i),o=await this._rpcRequest("getTransaction",s),a=se(o,Gl);if("error"in a)throw new he(a.error,"failed to get transaction");const c=a.result;return c&&{...c,transaction:{...c.transaction,message:ql(c.version,c.transaction.message)}}}async getParsedTransaction(e,t){const{commitment:n,config:i}=pt(t),s=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",i),o=await this._rpcRequest("getTransaction",s),a=se(o,ac);if("error"in a)throw new he(a.error,"failed to get transaction");return a.result}async getParsedTransactions(e,t){const{commitment:n,config:i}=pt(t),s=e.map(c=>{const l=this._buildArgsAtLeastConfirmed([c],n,"jsonParsed",i);return{methodName:"getTransaction",args:l}});return(await this._rpcBatchRequest(s)).map(c=>{const l=se(c,ac);if("error"in l)throw new he(l.error,"failed to get transactions");return l.result})}async getTransactions(e,t){const{commitment:n,config:i}=pt(t),s=e.map(c=>{const l=this._buildArgsAtLeastConfirmed([c],n,void 0,i);return{methodName:"getTransaction",args:l}});return(await this._rpcBatchRequest(s)).map(c=>{const l=se(c,Gl);if("error"in l)throw new he(l.error,"failed to get transactions");const u=l.result;return u&&{...u,transaction:{...u.transaction,message:ql(u.version,u.transaction.message)}}})}async getConfirmedBlock(e,t){const n=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getConfirmedBlock",n),s=se(i,Av);if("error"in s)throw new he(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");const a={...o,transactions:o.transactions.map(({transaction:c,meta:l})=>{const u=new wr(c.message);return{meta:l,transaction:{...c,message:u}}})};return{...a,transactions:a.transactions.map(({transaction:c,meta:l})=>({meta:l,transaction:je.populate(c.message,c.signatures)}))}}async getBlocks(e,t,n){const i=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],n),s=await this._rpcRequest("getBlocks",i),o=se(s,Be(oe($())));if("error"in o)throw new he(o.error,"failed to get blocks");return o.result}async getBlockSignatures(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getBlock",n),s=se(i,Qh);if("error"in s)throw new he(s.error,"failed to get block");const o=s.result;if(!o)throw new Error("Block "+e+" not found");return o}async getConfirmedBlockSignatures(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getConfirmedBlock",n),s=se(i,Qh);if("error"in s)throw new he(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");return o}async getConfirmedTransaction(e,t){const n=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getConfirmedTransaction",n),s=se(i,Gl);if("error"in s)throw new he(s.error,"failed to get transaction");const o=s.result;if(!o)return o;const a=new wr(o.transaction.message),c=o.transaction.signatures;return{...o,transaction:je.populate(a,c)}}async getParsedConfirmedTransaction(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),i=await this._rpcRequest("getConfirmedTransaction",n),s=se(i,ac);if("error"in s)throw new he(s.error,"failed to get confirmed transaction");return s.result}async getParsedConfirmedTransactions(e,t){const n=e.map(o=>{const a=this._buildArgsAtLeastConfirmed([o],t,"jsonParsed");return{methodName:"getConfirmedTransaction",args:a}});return(await this._rpcBatchRequest(n)).map(o=>{const a=se(o,ac);if("error"in a)throw new he(a.error,"failed to get confirmed transactions");return a.result})}async getConfirmedSignaturesForAddress(e,t,n){let i={},s=await this.getFirstAvailableBlock();for(;!("until"in i)&&(t--,!(t<=0||t<s));)try{const c=await this.getConfirmedBlockSignatures(t,"finalized");c.signatures.length>0&&(i.until=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}let o=await this.getSlot("finalized");for(;!("before"in i)&&(n++,!(n>o));)try{const c=await this.getConfirmedBlockSignatures(n);c.signatures.length>0&&(i.before=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}return(await this.getConfirmedSignaturesForAddress2(e,i)).map(c=>c.signature)}async getConfirmedSignaturesForAddress2(e,t,n){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),s=await this._rpcRequest("getConfirmedSignaturesForAddress2",i),o=se(s,ZS);if("error"in o)throw new he(o.error,"failed to get confirmed signatures for address");return o.result}async getSignaturesForAddress(e,t,n){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),s=await this._rpcRequest("getSignaturesForAddress",i),o=se(s,ev);if("error"in o)throw new he(o.error,"failed to get signatures for address");return o.result}async getAddressLookupTable(e,t){const{context:n,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=new Pd({key:e,state:Pd.deserialize(i.data)})),{context:n,value:s}}async getNonceAndContext(e,t){const{context:n,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=Tu.fromAccountData(i.data)),{context:n,value:s}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+n)})}async requestAirdrop(e,t){const n=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),i=se(n,Bv);if("error"in i)throw new he(i.error,`airdrop to ${e.toBase58()} failed`);return i.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await Di(100);const n=Date.now()-this._blockhashInfo.lastFetch>=og;if(this._blockhashInfo.latestBlockhash!==null&&!n)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,n=t?t.blockhash:null;for(let i=0;i<50;i++){const s=await this.getLatestBlockhash("finalized");if(n!==s.blockhash)return this._blockhashInfo={latestBlockhash:s,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},s;await Di(tg/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:n}=pt(e),i=this._buildArgs([],t,"base64",n),s=await this._rpcRequest("getStakeMinimumDelegation",i),o=se(s,Et($()));if("error"in o)throw new he(o.error,"failed to get stake minimum delegation");return o.result}async simulateTransaction(e,t,n){if("message"in e){const p=e.serialize(),w=L.Buffer.from(p).toString("base64");if(Array.isArray(t)||n!==void 0)throw new Error("Invalid arguments");const v=t||{};v.encoding="base64","commitment"in v||(v.commitment=this.commitment);const E=[w,v],P=await this._rpcRequest("simulateTransaction",E),K=se(P,Yh);if("error"in K)throw new Error("failed to simulate transaction: "+K.error.message);return K.result}let i;if(e instanceof je){let S=e;i=new je,i.feePayer=S.feePayer,i.instructions=e.instructions,i.nonceInfo=S.nonceInfo,i.signatures=S.signatures}else i=je.populate(e),i._message=i._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");const s=t;if(i.nonceInfo&&s)i.sign(...s);else{let S=this._disableBlockhashCaching;for(;;){const p=await this._blockhashWithExpiryBlockHeight(S);if(i.lastValidBlockHeight=p.lastValidBlockHeight,i.recentBlockhash=p.blockhash,!s)break;if(i.sign(...s),!i.signature)throw new Error("!signature");const w=i.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(w)&&!this._blockhashInfo.transactionSignatures.includes(w)){this._blockhashInfo.simulatedSignatures.push(w);break}else S=!0}}const o=i._compile(),a=o.serialize(),l=i._serialize(a).toString("base64"),u={encoding:"base64",commitment:this.commitment};if(n){const S=(Array.isArray(n)?n:o.nonProgramIds()).map(p=>p.toBase58());u.accounts={encoding:"base64",addresses:S}}s&&(u.sigVerify=!0);const d=[l,u],m=await this._rpcRequest("simulateTransaction",d),y=se(m,Yh);if("error"in y){let S;if("data"in y.error&&(S=y.error.data.logs,S&&Array.isArray(S))){const p=`
    `,w=p+S.join(p);console.error(y.error.message,w)}throw new ya("failed to simulate transaction: "+y.error.message,S)}return y.result}async sendTransaction(e,t,n){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const o=e.serialize();return await this.sendRawTransaction(o,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");const i=t;if(e.nonceInfo)e.sign(...i);else{let o=this._disableBlockhashCaching;for(;;){const a=await this._blockhashWithExpiryBlockHeight(o);if(e.lastValidBlockHeight=a.lastValidBlockHeight,e.recentBlockhash=a.blockhash,e.sign(...i),!e.signature)throw new Error("!signature");const c=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(c))o=!0;else{this._blockhashInfo.transactionSignatures.push(c);break}}}const s=e.serialize();return await this.sendRawTransaction(s,n)}async sendRawTransaction(e,t){const n=Ce(e).toString("base64");return await this.sendEncodedTransaction(n,t)}async sendEncodedTransaction(e,t){const n={encoding:"base64"},i=t&&t.skipPreflight,s=t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(n.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(n.minContextSlot=t.minContextSlot),i&&(n.skipPreflight=i),s&&(n.preflightCommitment=s);const o=[e,n],a=await this._rpcRequest("sendTransaction",o),c=se(a,xv);if("error"in c){let l;throw"data"in c.error&&(l=c.error.data.logs),new ya("failed to send transaction: "+c.error.message,l)}return c.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,n])=>{this._setSubscription(t,{...n,state:"pending"})})}_setSubscription(e,t){var i;const n=(i=this._subscriptionsByHash[e])==null?void 0:i.state;if(this._subscriptionsByHash[e]=t,n!==t.state){const s=this._subscriptionStateChangeCallbacksByHash[e];s&&s.forEach(o=>{try{o(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){const n=this._subscriptionHashByClientSubscriptionId[e];if(n==null)return()=>{};const i=this._subscriptionStateChangeCallbacksByHash[n]||=new Set;return i.add(t),()=>{i.delete(t),i.size===0&&delete this._subscriptionStateChangeCallbacksByHash[n]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(n){n instanceof Error&&console.log(`Error when closing socket connection: ${n.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async n=>{const i=this._subscriptionsByHash[n];if(i!==void 0)switch(i.state){case"pending":case"unsubscribed":if(i.callbacks.size===0){delete this._subscriptionsByHash[n],i.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[i.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:s,method:o}=i;try{this._setSubscription(n,{...i,state:"subscribing"});const a=await this._rpcWebSocket.call(o,s);this._setSubscription(n,{...i,serverSubscriptionId:a,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[a]=i.callbacks,await this._updateSubscriptions()}catch(a){if(a instanceof Error&&console.error(`${o} error for argument`,s,a.message),!t())return;this._setSubscription(n,{...i,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":i.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:s,unsubscribeMethod:o}=i;if(this._subscriptionsAutoDisposedByRpc.has(s))this._subscriptionsAutoDisposedByRpc.delete(s);else{this._setSubscription(n,{...i,state:"unsubscribing"}),this._setSubscription(n,{...i,state:"unsubscribing"});try{await this._rpcWebSocket.call(o,[s])}catch(a){if(a instanceof Error&&console.error(`${o} error:`,a.message),!t())return;this._setSubscription(n,{...i,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(n,{...i,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){const n=this._subscriptionCallbacksByServerSubscriptionId[e];n!==void 0&&n.forEach(i=>{try{i(...t)}catch(s){console.error(s)}})}_wsOnAccountNotification(e){const{result:t,subscription:n}=se(e,tv);this._handleServerNotification(n,[t.value,t.context])}_makeSubscription(e,t){const n=this._nextClientSubscriptionId++,i=Gh([e.method,t],!0),s=this._subscriptionsByHash[i];return s===void 0?this._subscriptionsByHash[i]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:s.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[n]=i,this._subscriptionDisposeFunctionsByClientSubscriptionId[n]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[n],delete this._subscriptionHashByClientSubscriptionId[n];const o=this._subscriptionsByHash[i];qe(o!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${n}`),o.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),n}onAccountChange(e,t,n){const i=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64");return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},i)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:n}=se(e,rv);this._handleServerNotification(n,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,n,i){const s=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64",i?{filters:i}:void 0);return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},s)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,n){const i=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],n||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},i)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:n}=se(e,Mv);this._handleServerNotification(n,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:n}=se(e,sv);this._handleServerNotification(n,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:n}=se(e,av);this._handleServerNotification(n,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const n=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];n?await n():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,n,i){const s=t||this._commitment;if(s||n||i){let o={};n&&(o.encoding=n),s&&(o.commitment=s),i&&(o=Object.assign(o,i)),e.push(o)}return e}_buildArgsAtLeastConfirmed(e,t,n,i){const s=t||this._commitment;if(s&&!["confirmed","finalized"].includes(s))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,n,i)}_wsOnSignatureNotification(e){const{result:t,subscription:n}=se(e,cv);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(n),this._handleServerNotification(n,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,n){const i=this._buildArgs([e],n||this._commitment||"finalized"),s=this._makeSubscription({callback:(o,a)=>{if(o.type==="status"){t(o.result,a);try{this.removeSignatureListener(s)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},i);return s}onSignatureWithOptions(e,t,n){const{commitment:i,...s}={...n,commitment:n&&n.commitment||this._commitment||"finalized"},o=this._buildArgs([e],i,void 0,s),a=this._makeSubscription({callback:(c,l)=>{t(c,l);try{this.removeSignatureListener(a)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return a}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:n}=se(e,uv);this._handleServerNotification(n,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class js{constructor(e){this._keypair=void 0,this._keypair=e??Fh()}static generate(){return new js(Fh())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const n=e.slice(32,64);if(!t||!t.skipValidation){const i=e.slice(0,32),s=Vc(i);for(let o=0;o<32;o++)if(n[o]!==s[o])throw new Error("provided secretKey is invalid")}return new js({publicKey:n,secretKey:e})}static fromSeed(e){const t=Vc(e),n=new Uint8Array(64);return n.set(e),n.set(t,32),new js({publicKey:t,secretKey:n})}get publicKey(){return new Y(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}const Yr=Object.freeze({CreateLookupTable:{index:0,layout:C([M("instruction"),no("recentSlot"),te("bumpSeed")])},FreezeLookupTable:{index:1,layout:C([M("instruction")])},ExtendLookupTable:{index:2,layout:C([M("instruction"),no(),Oe(Ne(),Kt(M(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:C([M("instruction")])},CloseLookupTable:{index:4,layout:C([M("instruction")])}});class Nv{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Yr))if(o.index==n){i=s;break}if(!i)throw new Error("Invalid Instruction. Should be a LookupTable Instruction");return i}static decodeCreateLookupTable(e){this.checkProgramId(e.programId),this.checkKeysLength(e.keys,4);const{recentSlot:t}=Qe(Yr.CreateLookupTable,e.data);return{authority:e.keys[1].pubkey,payer:e.keys[2].pubkey,recentSlot:Number(t)}}static decodeExtendLookupTable(e){if(this.checkProgramId(e.programId),e.keys.length<2)throw new Error(`invalid instruction; found ${e.keys.length} keys, expected at least 2`);const{addresses:t}=Qe(Yr.ExtendLookupTable,e.data);return{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,payer:e.keys.length>2?e.keys[2].pubkey:void 0,addresses:t.map(n=>new Y(n))}}static decodeCloseLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,3),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,recipient:e.keys[2].pubkey}}static decodeFreezeLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static decodeDeactivateLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(Of.programId))throw new Error("invalid instruction; programId is not AddressLookupTable Program")}static checkKeysLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}class Of{constructor(){}static createLookupTable(e){const[t,n]=Y.findProgramAddressSync([e.authority.toBuffer(),Ba(BigInt(e.recentSlot),8)],this.programId),i=Yr.CreateLookupTable,s=ze(i,{recentSlot:BigInt(e.recentSlot),bumpSeed:n}),o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:Lt.programId,isSigner:!1,isWritable:!1}];return[new et({programId:this.programId,keys:o,data:s}),t]}static freezeLookupTable(e){const t=Yr.FreezeLookupTable,n=ze(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new et({programId:this.programId,keys:i,data:n})}static extendLookupTable(e){const t=Yr.ExtendLookupTable,n=ze(t,{addresses:e.addresses.map(s=>s.toBytes())}),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return e.payer&&i.push({pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:Lt.programId,isSigner:!1,isWritable:!1}),new et({programId:this.programId,keys:i,data:n})}static deactivateLookupTable(e){const t=Yr.DeactivateLookupTable,n=ze(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new et({programId:this.programId,keys:i,data:n})}static closeLookupTable(e){const t=Yr.CloseLookupTable,n=ze(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.recipient,isSigner:!1,isWritable:!0}];return new et({programId:this.programId,keys:i,data:n})}}Of.programId=new Y("AddressLookupTab1e1111111111111111111111111");class $v{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=te("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(xr))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a ComputeBudgetInstruction");return i}static decodeRequestUnits(e){this.checkProgramId(e.programId);const{units:t,additionalFee:n}=Qe(xr.RequestUnits,e.data);return{units:t,additionalFee:n}}static decodeRequestHeapFrame(e){this.checkProgramId(e.programId);const{bytes:t}=Qe(xr.RequestHeapFrame,e.data);return{bytes:t}}static decodeSetComputeUnitLimit(e){this.checkProgramId(e.programId);const{units:t}=Qe(xr.SetComputeUnitLimit,e.data);return{units:t}}static decodeSetComputeUnitPrice(e){this.checkProgramId(e.programId);const{microLamports:t}=Qe(xr.SetComputeUnitPrice,e.data);return{microLamports:t}}static checkProgramId(e){if(!e.equals(Bf.programId))throw new Error("invalid instruction; programId is not ComputeBudgetProgram")}}const xr=Object.freeze({RequestUnits:{index:0,layout:C([te("instruction"),M("units"),M("additionalFee")])},RequestHeapFrame:{index:1,layout:C([te("instruction"),M("bytes")])},SetComputeUnitLimit:{index:2,layout:C([te("instruction"),M("units")])},SetComputeUnitPrice:{index:3,layout:C([te("instruction"),no("microLamports")])}});class Bf{constructor(){}static requestUnits(e){const t=xr.RequestUnits,n=ze(t,e);return new et({keys:[],programId:this.programId,data:n})}static requestHeapFrame(e){const t=xr.RequestHeapFrame,n=ze(t,e);return new et({keys:[],programId:this.programId,data:n})}static setComputeUnitLimit(e){const t=xr.SetComputeUnitLimit,n=ze(t,e);return new et({keys:[],programId:this.programId,data:n})}static setComputeUnitPrice(e){const t=xr.SetComputeUnitPrice,n=ze(t,{microLamports:BigInt(e.microLamports)});return new et({keys:[],programId:this.programId,data:n})}}Bf.programId=new Y("ComputeBudget111111111111111111111111111111");const Xh=64,Zh=32,ep=64,tp=C([te("numSignatures"),te("padding"),Ue("signatureOffset"),Ue("signatureInstructionIndex"),Ue("publicKeyOffset"),Ue("publicKeyInstructionIndex"),Ue("messageDataOffset"),Ue("messageDataSize"),Ue("messageInstructionIndex")]);class xu{constructor(){}static createInstructionWithPublicKey(e){const{publicKey:t,message:n,signature:i,instructionIndex:s}=e;qe(t.length===Zh,`Public Key must be ${Zh} bytes but received ${t.length} bytes`),qe(i.length===ep,`Signature must be ${ep} bytes but received ${i.length} bytes`);const o=tp.span,a=o+t.length,c=a+i.length,l=1,u=L.Buffer.alloc(c+n.length),d=s??65535;return tp.encode({numSignatures:l,padding:0,signatureOffset:a,signatureInstructionIndex:d,publicKeyOffset:o,publicKeyInstructionIndex:d,messageDataOffset:c,messageDataSize:n.length,messageInstructionIndex:d},u),u.fill(t,o),u.fill(i,a),u.fill(n,c),new et({keys:[],programId:xu.programId,data:u})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:n,instructionIndex:i}=e;qe(t.length===Xh,`Private key must be ${Xh} bytes but received ${t.length} bytes`);try{const s=js.fromSecretKey(t),o=s.publicKey.toBytes(),a=kf(n,s.secretKey);return this.createInstructionWithPublicKey({publicKey:o,message:n,signature:a,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}xu.programId=new Y("Ed25519SigVerify111111111111111111111111111");const Dv=(r,e)=>{const t=Ei.sign(r,e);return[t.toCompactRawBytes(),t.recovery]};Ei.utils.isValidPrivateKey;const zv=Ei.getPublicKey,np=32,Hl=20,rp=64,Wv=11,Yl=C([te("numSignatures"),Ue("signatureOffset"),te("signatureInstructionIndex"),Ue("ethAddressOffset"),te("ethAddressInstructionIndex"),Ue("messageDataOffset"),Ue("messageDataSize"),te("messageInstructionIndex"),ge(20,"ethAddress"),ge(64,"signature"),te("recoveryId")]);class qs{constructor(){}static publicKeyToEthAddress(e){qe(e.length===rp,`Public key must be ${rp} bytes but received ${e.length} bytes`);try{return L.Buffer.from(Dc(Ce(e))).slice(-Hl)}catch(t){throw new Error(`Error constructing Ethereum address: ${t}`)}}static createInstructionWithPublicKey(e){const{publicKey:t,message:n,signature:i,recoveryId:s,instructionIndex:o}=e;return qs.createInstructionWithEthAddress({ethAddress:qs.publicKeyToEthAddress(t),message:n,signature:i,recoveryId:s,instructionIndex:o})}static createInstructionWithEthAddress(e){const{ethAddress:t,message:n,signature:i,recoveryId:s,instructionIndex:o=0}=e;let a;typeof t=="string"?t.startsWith("0x")?a=L.Buffer.from(t.substr(2),"hex"):a=L.Buffer.from(t,"hex"):a=t,qe(a.length===Hl,`Address must be ${Hl} bytes but received ${a.length} bytes`);const c=1+Wv,l=c,u=c+a.length,d=u+i.length+1,m=1,y=L.Buffer.alloc(Yl.span+n.length);return Yl.encode({numSignatures:m,signatureOffset:u,signatureInstructionIndex:o,ethAddressOffset:l,ethAddressInstructionIndex:o,messageDataOffset:d,messageDataSize:n.length,messageInstructionIndex:o,signature:Ce(i),ethAddress:Ce(a),recoveryId:s},y),y.fill(Ce(n),Yl.span),new et({keys:[],programId:qs.programId,data:y})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:n,instructionIndex:i}=e;qe(t.length===np,`Private key must be ${np} bytes but received ${t.length} bytes`);try{const s=Ce(t),o=zv(s,!1).slice(1),a=L.Buffer.from(Dc(Ce(n))),[c,l]=Dv(a,s);return this.createInstructionWithPublicKey({publicKey:o,message:n,signature:c,recoveryId:l,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}qs.programId=new Y("KeccakSecp256k11111111111111111111111111111");var gg;const mg=new Y("StakeConfig11111111111111111111111111111111");class bg{constructor(e,t){this.staker=void 0,this.withdrawer=void 0,this.staker=e,this.withdrawer=t}}class Na{constructor(e,t,n){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=n}}gg=Na;Na.default=new gg(0,0,Y.default);class Vv{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Yt))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a StakeInstruction");return i}static decodeInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t,lockup:n}=Qe(Yt.Initialize,e.data);return{stakePubkey:e.keys[0].pubkey,authorized:new bg(new Y(t.staker),new Y(t.withdrawer)),lockup:new Na(n.unixTimestamp,n.epoch,new Y(n.custodian))}}static decodeDelegate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,6),Qe(Yt.Delegate,e.data),{stakePubkey:e.keys[0].pubkey,votePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[5].pubkey}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,stakeAuthorizationType:n}=Qe(Yt.Authorize,e.data),i={stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new Y(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(i.custodianPubkey=e.keys[3].pubkey),i}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{newAuthorized:t,stakeAuthorizationType:n,authoritySeed:i,authorityOwner:s}=Qe(Yt.AuthorizeWithSeed,e.data),o={stakePubkey:e.keys[0].pubkey,authorityBase:e.keys[1].pubkey,authoritySeed:i,authorityOwner:new Y(s),newAuthorizedPubkey:new Y(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(o.custodianPubkey=e.keys[3].pubkey),o}static decodeSplit(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Qe(Yt.Split,e.data);return{stakePubkey:e.keys[0].pubkey,splitStakePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[2].pubkey,lamports:t}}static decodeMerge(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Qe(Yt.Merge,e.data),{stakePubkey:e.keys[0].pubkey,sourceStakePubKey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Qe(Yt.Withdraw,e.data),n={stakePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t};return e.keys.length>5&&(n.custodianPubkey=e.keys[5].pubkey),n}static decodeDeactivate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Qe(Yt.Deactivate,e.data),{stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static checkProgramId(e){if(!e.equals(Cu.programId))throw new Error("invalid instruction; programId is not StakeProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const Yt=Object.freeze({Initialize:{index:0,layout:C([M("instruction"),Fk(),jk()])},Authorize:{index:1,layout:C([M("instruction"),Ne("newAuthorized"),M("stakeAuthorizationType")])},Delegate:{index:2,layout:C([M("instruction")])},Split:{index:3,layout:C([M("instruction"),De("lamports")])},Withdraw:{index:4,layout:C([M("instruction"),De("lamports")])},Deactivate:{index:5,layout:C([M("instruction")])},Merge:{index:7,layout:C([M("instruction")])},AuthorizeWithSeed:{index:8,layout:C([M("instruction"),Ne("newAuthorized"),M("stakeAuthorizationType"),Wi("authoritySeed"),Ne("authorityOwner")])}}),Uv=Object.freeze({Staker:{index:0},Withdrawer:{index:1}});class Cu{constructor(){}static initialize(e){const{stakePubkey:t,authorized:n,lockup:i}=e,s=i||Na.default,o=Yt.Initialize,a=ze(o,{authorized:{staker:Ce(n.staker.toBuffer()),withdrawer:Ce(n.withdrawer.toBuffer())},lockup:{unixTimestamp:s.unixTimestamp,epoch:s.epoch,custodian:Ce(s.custodian.toBuffer())}}),c={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Zi,isSigner:!1,isWritable:!1}],programId:this.programId,data:a};return new et(c)}static createAccountWithSeed(e){const t=new je;t.add(Lt.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:n,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:n,authorized:i,lockup:s}))}static createAccount(e){const t=new je;t.add(Lt.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:n,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:n,authorized:i,lockup:s}))}static delegate(e){const{stakePubkey:t,authorizedPubkey:n,votePubkey:i}=e,s=Yt.Delegate,o=ze(s);return new je().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:Tr,isSigner:!1,isWritable:!1},{pubkey:Rc,isSigner:!1,isWritable:!1},{pubkey:mg,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static authorize(e){const{stakePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:i,stakeAuthorizationType:s,custodianPubkey:o}=e,a=Yt.Authorize,c=ze(a,{newAuthorized:Ce(i.toBuffer()),stakeAuthorizationType:s.index}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Tr,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return o&&l.push({pubkey:o,isSigner:!1,isWritable:!1}),new je().add({keys:l,programId:this.programId,data:c})}static authorizeWithSeed(e){const{stakePubkey:t,authorityBase:n,authoritySeed:i,authorityOwner:s,newAuthorizedPubkey:o,stakeAuthorizationType:a,custodianPubkey:c}=e,l=Yt.AuthorizeWithSeed,u=ze(l,{newAuthorized:Ce(o.toBuffer()),stakeAuthorizationType:a.index,authoritySeed:i,authorityOwner:Ce(s.toBuffer())}),d=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:Tr,isSigner:!1,isWritable:!1}];return c&&d.push({pubkey:c,isSigner:!1,isWritable:!1}),new je().add({keys:d,programId:this.programId,data:u})}static splitInstruction(e){const{stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,lamports:s}=e,o=Yt.Split,a=ze(o,{lamports:s});return new et({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:a})}static split(e){const t=new je;return t.add(Lt.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:0,space:this.space,programId:this.programId})),t.add(this.splitInstruction(e))}static splitWithSeed(e){const{stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,basePubkey:s,seed:o,lamports:a}=e,c=new je;return c.add(Lt.allocate({accountPubkey:i,basePubkey:s,seed:o,space:this.space,programId:this.programId})),c.add(this.splitInstruction({stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,lamports:a}))}static merge(e){const{stakePubkey:t,sourceStakePubKey:n,authorizedPubkey:i}=e,s=Yt.Merge,o=ze(s);return new je().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:Tr,isSigner:!1,isWritable:!1},{pubkey:Rc,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static withdraw(e){const{stakePubkey:t,authorizedPubkey:n,toPubkey:i,lamports:s,custodianPubkey:o}=e,a=Yt.Withdraw,c=ze(a,{lamports:s}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:Tr,isSigner:!1,isWritable:!1},{pubkey:Rc,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return o&&l.push({pubkey:o,isSigner:!1,isWritable:!1}),new je().add({keys:l,programId:this.programId,data:c})}static deactivate(e){const{stakePubkey:t,authorizedPubkey:n}=e,i=Yt.Deactivate,s=ze(i);return new je().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Tr,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:s})}}Cu.programId=new Y("Stake11111111111111111111111111111111111111");Cu.space=200;class wg{constructor(e,t,n,i){this.nodePubkey=void 0,this.authorizedVoter=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.nodePubkey=e,this.authorizedVoter=t,this.authorizedWithdrawer=n,this.commission=i}}class Fv{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Jr))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a VoteInstruction");return i}static decodeInitializeAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,4);const{voteInit:t}=Qe(Jr.InitializeAccount,e.data);return{votePubkey:e.keys[0].pubkey,nodePubkey:e.keys[3].pubkey,voteInit:new wg(new Y(t.nodePubkey),new Y(t.authorizedVoter),new Y(t.authorizedWithdrawer),t.commission)}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,voteAuthorizationType:n}=Qe(Jr.Authorize,e.data);return{votePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new Y(t),voteAuthorizationType:{index:n}}}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:t,currentAuthorityDerivedKeySeed:n,newAuthorized:i,voteAuthorizationType:s}}=Qe(Jr.AuthorizeWithSeed,e.data);return{currentAuthorityDerivedKeyBasePubkey:e.keys[2].pubkey,currentAuthorityDerivedKeyOwnerPubkey:new Y(t),currentAuthorityDerivedKeySeed:n,newAuthorizedPubkey:new Y(i),voteAuthorizationType:{index:s},votePubkey:e.keys[0].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Qe(Jr.Withdraw,e.data);return{votePubkey:e.keys[0].pubkey,authorizedWithdrawerPubkey:e.keys[2].pubkey,lamports:t,toPubkey:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(Po.programId))throw new Error("invalid instruction; programId is not VoteProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const Jr=Object.freeze({InitializeAccount:{index:0,layout:C([M("instruction"),qk()])},Authorize:{index:1,layout:C([M("instruction"),Ne("newAuthorized"),M("voteAuthorizationType")])},Withdraw:{index:3,layout:C([M("instruction"),De("lamports")])},AuthorizeWithSeed:{index:10,layout:C([M("instruction"),Gk()])}}),jv=Object.freeze({Voter:{index:0},Withdrawer:{index:1}});class Po{constructor(){}static initializeAccount(e){const{votePubkey:t,nodePubkey:n,voteInit:i}=e,s=Jr.InitializeAccount,o=ze(s,{voteInit:{nodePubkey:Ce(i.nodePubkey.toBuffer()),authorizedVoter:Ce(i.authorizedVoter.toBuffer()),authorizedWithdrawer:Ce(i.authorizedWithdrawer.toBuffer()),commission:i.commission}}),a={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Zi,isSigner:!1,isWritable:!1},{pubkey:Tr,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:o};return new et(a)}static createAccount(e){const t=new je;return t.add(Lt.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}static authorize(e){const{votePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:i,voteAuthorizationType:s}=e,o=Jr.Authorize,a=ze(o,{newAuthorized:Ce(i.toBuffer()),voteAuthorizationType:s.index}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Tr,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return new je().add({keys:c,programId:this.programId,data:a})}static authorizeWithSeed(e){const{currentAuthorityDerivedKeyBasePubkey:t,currentAuthorityDerivedKeyOwnerPubkey:n,currentAuthorityDerivedKeySeed:i,newAuthorizedPubkey:s,voteAuthorizationType:o,votePubkey:a}=e,c=Jr.AuthorizeWithSeed,l=ze(c,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:Ce(n.toBuffer()),currentAuthorityDerivedKeySeed:i,newAuthorized:Ce(s.toBuffer()),voteAuthorizationType:o.index}}),u=[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:Tr,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return new je().add({keys:u,programId:this.programId,data:l})}static withdraw(e){const{votePubkey:t,authorizedWithdrawerPubkey:n,lamports:i,toPubkey:s}=e,o=Jr.Withdraw,a=ze(o,{lamports:i}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return new je().add({keys:c,programId:this.programId,data:a})}static safeWithdraw(e,t,n){if(e.lamports>t-n)throw new Error("Withdraw will leave vote account with insuffcient funds.");return Po.withdraw(e)}}Po.programId=new Y("Vote111111111111111111111111111111111111111");Po.space=3731;const kg=new Y("Va1idator1nfo111111111111111111111111111111"),qv=J({name:re(),website:ve(re()),details:ve(re()),keybaseUsername:ve(re())});class xf{constructor(e,t){this.key=void 0,this.info=void 0,this.key=e,this.info=t}static fromConfigData(e){let t=[...e];if(Pn(t)!==2)return null;const i=[];for(let s=0;s<2;s++){const o=new Y(t.slice(0,jn));t=t.slice(jn);const a=t.slice(0,1)[0]===1;t=t.slice(1),i.push({publicKey:o,isSigner:a})}if(i[0].publicKey.equals(kg)&&i[1].isSigner){const s=Wi().decode(L.Buffer.from(t)),o=JSON.parse(s);return qy(o,qv),new xf(i[1].publicKey,o)}return null}}const Gv=new Y("Vote111111111111111111111111111111111111111"),Hv=C([Ne("nodePubkey"),Ne("authorizedWithdrawer"),te("commission"),_e(),Oe(C([_e("slot"),M("confirmationCount")]),Kt(M(),-8),"votes"),te("rootSlotValid"),_e("rootSlot"),_e(),Oe(C([_e("epoch"),Ne("authorizedVoter")]),Kt(M(),-8),"authorizedVoters"),C([Oe(C([Ne("authorizedPubkey"),_e("epochOfLastAuthorizedSwitch"),_e("targetEpoch")]),32,"buf"),_e("idx"),te("isEmpty")],"priorVoters"),_e(),Oe(C([_e("epoch"),_e("credits"),_e("prevCredits")]),Kt(M(),-8),"epochCredits"),C([_e("slot"),_e("timestamp")],"lastTimestamp")]);class Cf{constructor(e){this.nodePubkey=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.rootSlot=void 0,this.votes=void 0,this.authorizedVoters=void 0,this.priorVoters=void 0,this.epochCredits=void 0,this.lastTimestamp=void 0,this.nodePubkey=e.nodePubkey,this.authorizedWithdrawer=e.authorizedWithdrawer,this.commission=e.commission,this.rootSlot=e.rootSlot,this.votes=e.votes,this.authorizedVoters=e.authorizedVoters,this.priorVoters=e.priorVoters,this.epochCredits=e.epochCredits,this.lastTimestamp=e.lastTimestamp}static fromAccountData(e){const n=Hv.decode(Ce(e),4);let i=n.rootSlot;return n.rootSlotValid||(i=null),new Cf({nodePubkey:new Y(n.nodePubkey),authorizedWithdrawer:new Y(n.authorizedWithdrawer),commission:n.commission,votes:n.votes,rootSlot:i,authorizedVoters:n.authorizedVoters.map(Yv),priorVoters:Jv(n.priorVoters),epochCredits:n.epochCredits,lastTimestamp:n.lastTimestamp})}}function Yv({authorizedVoter:r,epoch:e}){return{epoch:e,authorizedVoter:new Y(r)}}function ip({authorizedPubkey:r,epochOfLastAuthorizedSwitch:e,targetEpoch:t}){return{authorizedPubkey:new Y(r),epochOfLastAuthorizedSwitch:e,targetEpoch:t}}function Jv({buf:r,idx:e,isEmpty:t}){return t?[]:[...r.slice(e+1).map(ip),...r.slice(0,e).map(ip)]}const sp={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function Qv(r,e){const t=e===!1?"http":"https";if(!r)return sp[t].devnet;const n=sp[t][r];if(!n)throw new Error(`Unknown ${t} cluster: ${r}`);return n}async function Xv(r,e,t,n){let i,s;t&&Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")||t&&Object.prototype.hasOwnProperty.call(t,"nonceValue")?(i=t,s=n):s=t;const o=s&&{skipPreflight:s.skipPreflight,preflightCommitment:s.preflightCommitment||s.commitment,minContextSlot:s.minContextSlot},a=await r.sendRawTransaction(e,o),c=s&&s.commitment,u=(await(i?r.confirmTransaction(i,c):r.confirmTransaction(a,c))).value;if(u.err)throw new Error(`Raw transaction ${a} failed (${JSON.stringify(u)})`);return a}const Zv=1e9;var Sg=Object.freeze(Object.defineProperty({__proto__:null,Account:Wk,AddressLookupTableAccount:Pd,AddressLookupTableInstruction:Nv,AddressLookupTableProgram:Of,Authorized:bg,BLOCKHASH_CACHE_TIMEOUT_MS:og,BPF_LOADER_DEPRECATED_PROGRAM_ID:Vk,BPF_LOADER_PROGRAM_ID:aS,BpfLoader:cS,COMPUTE_BUDGET_INSTRUCTION_LAYOUTS:xr,ComputeBudgetInstruction:$v,ComputeBudgetProgram:Bf,Connection:Kv,Ed25519Program:xu,Enum:Dk,EpochSchedule:ig,FeeCalculatorLayout:ng,Keypair:js,LAMPORTS_PER_SOL:Zv,LOOKUP_TABLE_INSTRUCTION_LAYOUTS:Yr,Loader:es,Lockup:Na,MAX_SEED_LENGTH:Zy,Message:wr,MessageAccountKeys:pa,MessageV0:Xi,NONCE_ACCOUNT_LENGTH:Ed,NonceAccount:Tu,PACKET_DATA_SIZE:pi,PUBLIC_KEY_LENGTH:jn,PublicKey:Y,SIGNATURE_LENGTH_IN_BYTES:to,SOLANA_SCHEMA:na,STAKE_CONFIG_ID:mg,STAKE_INSTRUCTION_LAYOUTS:Yt,SYSTEM_INSTRUCTION_LAYOUTS:lt,SYSVAR_CLOCK_PUBKEY:Tr,SYSVAR_EPOCH_SCHEDULE_PUBKEY:Xk,SYSVAR_INSTRUCTIONS_PUBKEY:Zk,SYSVAR_RECENT_BLOCKHASHES_PUBKEY:Pc,SYSVAR_RENT_PUBKEY:Zi,SYSVAR_REWARDS_PUBKEY:eS,SYSVAR_SLOT_HASHES_PUBKEY:tS,SYSVAR_SLOT_HISTORY_PUBKEY:nS,SYSVAR_STAKE_HISTORY_PUBKEY:Rc,Secp256k1Program:qs,SendTransactionError:ya,SolanaJSONRPCError:he,SolanaJSONRPCErrorCode:pS,StakeAuthorizationLayout:Uv,StakeInstruction:Vv,StakeProgram:Cu,Struct:Sf,SystemInstruction:sS,SystemProgram:Lt,Transaction:je,TransactionExpiredBlockheightExceededError:vf,TransactionExpiredNonceInvalidError:Ls,TransactionExpiredTimeoutError:_f,TransactionInstruction:et,TransactionMessage:If,TransactionStatus:qr,VALIDATOR_INFO_KEY:kg,VERSION_PREFIX_MASK:Pu,VOTE_PROGRAM_ID:Gv,ValidatorInfo:xf,VersionedMessage:Af,VersionedTransaction:Ef,VoteAccount:Cf,VoteAuthorizationLayout:jv,VoteInit:wg,VoteInstruction:Fv,VoteProgram:Po,clusterApiUrl:Qv,sendAndConfirmRawTransaction:Xv,sendAndConfirmTransaction:Id},Symbol.toStringTag,{value:"Module"})),Te={},vg=vo(Sg);(function(r){var e=z&&z.__importDefault||function(B){return B&&B.__esModule?B:{default:B}};Object.defineProperty(r,"__esModule",{value:!0}),r.map=r.array=r.rustEnum=r.str=r.vecU8=r.tagged=r.vec=r.bool=r.option=r.publicKey=r.i128=r.u128=r.i64=r.u64=r.struct=r.f64=r.f32=r.i32=r.u32=r.i16=r.u16=r.i8=r.u8=void 0;const t=Dh,n=vg,i=e(My.exports);var s=Dh;Object.defineProperty(r,"u8",{enumerable:!0,get:function(){return s.u8}}),Object.defineProperty(r,"i8",{enumerable:!0,get:function(){return s.s8}}),Object.defineProperty(r,"u16",{enumerable:!0,get:function(){return s.u16}}),Object.defineProperty(r,"i16",{enumerable:!0,get:function(){return s.s16}}),Object.defineProperty(r,"u32",{enumerable:!0,get:function(){return s.u32}}),Object.defineProperty(r,"i32",{enumerable:!0,get:function(){return s.s32}}),Object.defineProperty(r,"f32",{enumerable:!0,get:function(){return s.f32}}),Object.defineProperty(r,"f64",{enumerable:!0,get:function(){return s.f64}}),Object.defineProperty(r,"struct",{enumerable:!0,get:function(){return s.struct}});class o extends t.Layout{constructor(V,q,I){super(V,I),this.blob=t.blob(V),this.signed=q}decode(V,q=0){const I=new i.default(this.blob.decode(V,q),10,"le");return this.signed?I.fromTwos(this.span*8).clone():I}encode(V,q,I=0){return this.signed&&(V=V.toTwos(this.span*8)),this.blob.encode(V.toArrayLike(we.Buffer,"le",this.span),q,I)}}function a(B){return new o(8,!1,B)}r.u64=a;function c(B){return new o(8,!0,B)}r.i64=c;function l(B){return new o(16,!1,B)}r.u128=l;function u(B){return new o(16,!0,B)}r.i128=u;class d extends t.Layout{constructor(V,q,I,D){super(V.span,D),this.layout=V,this.decoder=q,this.encoder=I}decode(V,q){return this.decoder(this.layout.decode(V,q))}encode(V,q,I){return this.layout.encode(this.encoder(V),q,I)}getSpan(V,q){return this.layout.getSpan(V,q)}}function m(B){return new d(t.blob(32),V=>new n.PublicKey(V),V=>V.toBuffer(),B)}r.publicKey=m;class y extends t.Layout{constructor(V,q){super(-1,q),this.layout=V,this.discriminator=t.u8()}encode(V,q,I=0){return V==null?this.discriminator.encode(0,q,I):(this.discriminator.encode(1,q,I),this.layout.encode(V,q,I+1)+1)}decode(V,q=0){const I=this.discriminator.decode(V,q);if(I===0)return null;if(I===1)return this.layout.decode(V,q+1);throw new Error("Invalid option "+this.property)}getSpan(V,q=0){const I=this.discriminator.decode(V,q);if(I===0)return 1;if(I===1)return this.layout.getSpan(V,q+1)+1;throw new Error("Invalid option "+this.property)}}function S(B,V){return new y(B,V)}r.option=S;function p(B){return new d(t.u8(),w,v,B)}r.bool=p;function w(B){if(B===0)return!1;if(B===1)return!0;throw new Error("Invalid bool: "+B)}function v(B){return B?1:0}function E(B,V){const q=t.u32("length"),I=t.struct([q,t.seq(B,t.offset(q,-q.span),"values")]);return new d(I,({values:D})=>D,D=>({values:D}),V)}r.vec=E;function P(B,V,q){const I=t.struct([a("tag"),V.replicate("data")]);function D({tag:G,data:Ie}){if(!G.eq(B))throw new Error("Invalid tag, expected: "+B.toString("hex")+", got: "+G.toString("hex"));return Ie}return new d(I,D,G=>({tag:B,data:G}),q)}r.tagged=P;function K(B){const V=t.u32("length"),q=t.struct([V,t.blob(t.offset(V,-V.span),"data")]);return new d(q,({data:I})=>I,I=>({data:I}),B)}r.vecU8=K;function T(B){return new d(K(),V=>V.toString("utf-8"),V=>we.Buffer.from(V,"utf-8"),B)}r.str=T;function b(B,V,q){const I=t.union(q??t.u8(),V);return B.forEach((D,G)=>I.addVariant(G,D,D.property)),I}r.rustEnum=b;function _(B,V,q){const I=t.struct([t.seq(B,V,"values")]);return new d(I,({values:D})=>D,D=>({values:D}),q)}r.array=_;class R extends t.Layout{constructor(V,q,I){super(V.span+q.span,I),this.keyLayout=V,this.valueLayout=q}decode(V,q){q=q||0;const I=this.keyLayout.decode(V,q),D=this.valueLayout.decode(V,q+this.keyLayout.getSpan(V,q));return[I,D]}encode(V,q,I){I=I||0;const D=this.keyLayout.encode(V[0],q,I),G=this.valueLayout.encode(V[1],q,I+D);return D+G}getSpan(V,q){return this.keyLayout.getSpan(V,q)+this.valueLayout.getSpan(V,q)}}function W(B,V,q){const I=t.u32("length"),D=t.struct([I,t.seq(new R(B,V),t.offset(I,-I.span),"values")]);return new d(D,({values:G})=>new Map(G),G=>({values:Array.from(G.entries())}),q)}r.map=W})(Te);var e_=Object.freeze({__proto__:null,encode:function(r){return r.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),"0x")},decode:function(r){r.indexOf("0x")===0&&(r=r.substr(2)),r.length%2==1&&(r="0"+r);let e=r.match(/.{2}/g);return e===null?L.Buffer.from([]):L.Buffer.from(e.map(t=>parseInt(t,16)))}});function _g(r){return new TextDecoder("utf-8").decode(r)}function Ag(r){return new TextEncoder().encode(r)}var t_=Object.freeze({__proto__:null,decode:_g,encode:Ag});function Ig(r){return me.encode(r)}var n_=Object.freeze({__proto__:null,encode:Ig,decode:function(r){return me.decode(r)}});function Eg(r){return L.Buffer.from(Ly(r))}var r_=Object.freeze({__proto__:null,encode:function(r){return _d(r)},decode:Eg}),i_=Object.freeze({__proto__:null,hex:e_,utf8:t_,bs58:n_,base64:r_});function Mf(r){const e=new Map;return r.errors&&r.errors.forEach(t=>{var n;let i=(n=t.msg)!==null&&n!==void 0?n:t.name;e.set(t.code,i)}),e}function Pg(r,...e){if(r.args.length!=e.length)throw new Error("Invalid argument length");const t={};let n=0;return r.args.forEach(i=>{t[i.name]=e[n],n+=1}),t}function Mu(r,e={}){r.forEach(t=>{if("accounts"in t)Mu(t.accounts,e[t.name]);else if(e[t.name]===void 0)throw new Error(`Invalid arguments: ${t.name} not provided.`)})}function hr(r){return r instanceof Y?r:new Y(r)}class s_ extends TypeError{constructor(e,t){let n;const{message:i,...s}=e,{path:o}=e;super(o.length===0?i:"At path: "+o.join(".")+" -- "+i),Object.assign(this,s),this.name=this.constructor.name,this.failures=()=>{var a;return(a=n)!=null?a:n=[e,...t()]}}}function Gs(r){return typeof r=="object"&&r!=null}function Si(r){return typeof r=="string"?JSON.stringify(r):""+r}function o_(r,e,t,n){if(r===!0)return;r===!1?r={}:typeof r=="string"&&(r={message:r});const{path:i,branch:s}=e,{type:o}=t,{refinement:a,message:c="Expected a value of type `"+o+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+Si(n)+"`"}=r;return{value:n,type:o,refinement:a,key:i[i.length-1],path:i,branch:s,...r,message:c}}function*op(r,e,t,n){var i;Gs(i=r)&&typeof i[Symbol.iterator]=="function"||(r=[r]);for(const s of r){const o=o_(s,e,t,n);o&&(yield o)}}function*Lf(r,e,t={}){const{path:n=[],branch:i=[r],coerce:s=!1,mask:o=!1}=t,a={path:n,branch:i};if(s&&(r=e.coercer(r,a),o&&e.type!=="type"&&Gs(e.schema)&&Gs(r)&&!Array.isArray(r)))for(const l in r)e.schema[l]===void 0&&delete r[l];let c=!0;for(const l of e.validator(r,a))c=!1,yield[l,void 0];for(let[l,u,d]of e.entries(r,a)){const m=Lf(u,d,{path:l===void 0?n:[...n,l],branch:l===void 0?i:[...i,u],coerce:s,mask:o});for(const y of m)y[0]?(c=!1,yield[y[0],void 0]):s&&(u=y[1],l===void 0?r=u:r instanceof Map?r.set(l,u):r instanceof Set?r.add(u):Gs(r)&&(r[l]=u))}if(c)for(const l of e.refiner(r,a))c=!1,yield[l,void 0];c&&(yield[void 0,r])}class Pi{constructor(e){const{type:t,schema:n,validator:i,refiner:s,coercer:o=c=>c,entries:a=function*(){}}=e;this.type=t,this.schema=n,this.entries=a,this.coercer=o,this.validator=i?(c,l)=>op(i(c,l),l,this,c):()=>[],this.refiner=s?(c,l)=>op(s(c,l),l,this,c):()=>[]}assert(e){return function(t,n){const i=ra(t,n);if(i[0])throw i[0]}(e,this)}create(e){return Kf(e,this)}is(e){return Rg(e,this)}mask(e){return function(t,n){const i=ra(t,n,{coerce:!0,mask:!0});if(i[0])throw i[0];return i[1]}(e,this)}validate(e,t={}){return ra(e,this,t)}}function Kf(r,e){const t=ra(r,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function Rg(r,e){return!ra(r,e)[0]}function ra(r,e,t={}){const n=Lf(r,e,t),i=function(s){const{done:o,value:a}=s.next();return o?void 0:a}(n);return i[0]?[new s_(i[0],function*(){for(const s of n)s[0]&&(yield s[0])}),void 0]:[void 0,i[1]]}function $a(r,e){return new Pi({type:r,schema:null,validator:e})}function Jl(r){return new Pi({type:"array",schema:r,*entries(e){if(r&&Array.isArray(e))for(const[t,n]of e.entries())yield[t,n,r]},coercer:e=>Array.isArray(e)?e.slice():e,validator:e=>Array.isArray(e)||"Expected an array value, but received: "+Si(e)})}function ap(r){const e=Si(r),t=typeof r;return new Pi({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?r:null,validator:n=>n===r||"Expected the literal `"+e+"`, but received: "+Si(n)})}function cc(r){return new Pi({...r,validator:(e,t)=>e===null||r.validator(e,t),refiner:(e,t)=>e===null||r.refiner(e,t)})}function uc(){return $a("number",r=>typeof r=="number"&&!isNaN(r)||"Expected a number, but received: "+Si(r))}function Tc(r){return new Pi({...r,validator:(e,t)=>e===void 0||r.validator(e,t),refiner:(e,t)=>e===void 0||r.refiner(e,t)})}function Vi(){return $a("string",r=>typeof r=="string"||"Expected a string, but received: "+Si(r))}function li(r){const e=Object.keys(r);return new Pi({type:"type",schema:r,*entries(t){if(Gs(t))for(const n of e)yield[n,t[n],r[n]]},validator:t=>Gs(t)||"Expected an object, but received: "+Si(t)})}function Tg(r){const e=r.map(t=>t.type).join(" | ");return new Pi({type:"union",schema:null,validator(t,n){const i=[];for(const s of r){const[...o]=Lf(t,s,n),[a]=o;if(!a[0])return[];for(const[c]of o)c&&i.push(c)}return["Expected the value to satisfy a union of `"+e+"`, but received: "+Si(t),...i]}})}function Og(){return $a("unknown",()=>!0)}async function Bg(r,e,t){if(e.length<=99)return await cp(r,e,t);{const n=function(i,s){return Array.apply(0,new Array(Math.ceil(i.length/s))).map((o,a)=>i.slice(a*s,(a+1)*s))}(e,99);return(await Promise.all(n.map(i=>cp(r,i,t)))).flat()}}async function cp(r,e,t){const n=t??r.commitment;return(await r.getMultipleAccountsInfo(e,n)).map((i,s)=>i===null?null:{publicKey:e[s],account:i})}async function xg(r,e,t,n,i){t&&t.length>0&&e.sign(...t);const s=e._compile(),o=s.serialize(),a=e._serialize(o).toString("base64"),c={encoding:"base64",commitment:n??r.commitment};if(i){const d=(Array.isArray(i)?i:s.nonProgramIds()).map(m=>m.toBase58());c.accounts={encoding:"base64",addresses:d}}t&&(c.sigVerify=!0);const l=[a,c],u=Kf(await r._rpcRequest("simulateTransaction",l),u_);if("error"in u){let d;if("data"in u.error&&(d=u.error.data.logs,d&&Array.isArray(d))){const m=`
    `,y=m+d.join(m);console.error(u.error.message,y)}throw new ya("failed to simulate transaction: "+u.error.message,d)}return u.result}function a_(r){return function(e,t,n){return new Pi({...e,coercer:(i,s)=>Rg(i,t)?e.coercer(n(i,s),s):e.coercer(i,s)})}(Cg(r),c_,e=>"error"in e?e:{...e,result:Kf(e.result,r)})}const c_=Cg(Og());function Cg(r){return Tg([li({jsonrpc:ap("2.0"),id:Vi(),result:r}),li({jsonrpc:ap("2.0"),id:Vi(),error:li({code:Og(),message:Vi(),data:Tc($a("any",()=>!0))})})])}const u_=(up=li({err:cc(Tg([li({}),Vi()])),logs:cc(Jl(Vi())),accounts:Tc(cc(Jl(cc(li({executable:$a("boolean",r=>typeof r=="boolean"),owner:Vi(),lamports:uc(),data:Jl(Vi()),rentEpoch:Tc(uc())}))))),unitsConsumed:Tc(uc())}),a_(li({context:li({slot:uc()}),value:up})));var up,l_=Object.freeze({__proto__:null,invoke:async function(r,e,t,n){r=hr(r),n||(n=ro());const i=new je;if(i.add(new et({programId:r,keys:e??[],data:t})),n.sendAndConfirm===void 0)throw new Error("This function requires 'Provider.sendAndConfirm' to be implemented.");return await n.sendAndConfirm(i,[])},getMultipleAccounts:Bg,simulateTransaction:xg});class Mg{constructor(e,t,n){this.connection=e,this.wallet=t,this.opts=n}static defaultOptions(){return{preflightCommitment:"processed",commitment:"processed"}}static local(e,t){throw new Error("Provider local is not available on browser.")}static env(){throw new Error("Provider env is not available on browser.")}async sendAndConfirm(e,t,n){var i;n===void 0&&(n=this.opts),e.feePayer=this.wallet.publicKey,e.recentBlockhash=(await this.connection.getRecentBlockhash(n.preflightCommitment)).blockhash,e=await this.wallet.signTransaction(e),(t??[]).forEach(o=>{e.partialSign(o)});const s=e.serialize();try{return await lp(this.connection,s,n)}catch(o){if(o instanceof Lg){const a=await this.connection.getTransaction(Ig(e.signature),{commitment:"confirmed"});if(a){const c=(i=a.meta)===null||i===void 0?void 0:i.logMessages;throw c?new ya(o.message,c):o}throw o}throw o}}async sendAll(e,t){t===void 0&&(t=this.opts);const n=await this.connection.getRecentBlockhash(t.preflightCommitment);let i=e.map(a=>{var c;let l=a.tx,u=(c=a.signers)!==null&&c!==void 0?c:[];return l.feePayer=this.wallet.publicKey,l.recentBlockhash=n.blockhash,u.forEach(d=>{l.partialSign(d)}),l});const s=await this.wallet.signAllTransactions(i),o=[];for(let a=0;a<i.length;a+=1){const c=s[a].serialize();o.push(await lp(this.connection,c,t))}return o}async simulate(e,t,n,i){e.feePayer=this.wallet.publicKey,e.recentBlockhash=(await this.connection.getLatestBlockhash(n??this.connection.commitment)).blockhash,e=await this.wallet.signTransaction(e);const s=await xg(this.connection,e,t,n,i);if(s.value.err)throw new d_(s.value);return s.value}}class d_ extends Error{constructor(e,t){super(t),this.simulationResponse=e}}async function lp(r,e,t){const n=t&&{skipPreflight:t.skipPreflight,preflightCommitment:t.preflightCommitment||t.commitment},i=await r.sendRawTransaction(e,n),s=(await r.confirmTransaction(i,t&&t.commitment)).value;if(s.err)throw new Lg(`Raw transaction ${i} failed (${JSON.stringify(s)})`);return i}class Lg extends Error{constructor(e){super(e)}}function f_(r){Bd=r}function ro(){return Bd===null?Mg.local():Bd}let Bd=null;const h_=new Set(["anchor-deprecated-state","debug-logs"]),Kg=new Map;function Lu(r){return Kg.get(r)!==void 0}var p_=Object.freeze({__proto__:null,set:function(r){if(!h_.has(r))throw new Error("Invalid feature");Kg.set(r,!0)},isSet:Lu});class ma extends Error{constructor(e){super(e),this.name="IdlError"}}class Ro{constructor(e){this.stack=e}static parse(e){var t;const n=/^Program (\w*) invoke/,i=/^Program \w* success/,s=[];for(let o=0;o<e.length;o++){if(i.exec(e[o])){s.pop();continue}const a=(t=n.exec(e[o]))===null||t===void 0?void 0:t[1];a&&s.push(new Y(a))}return new Ro(s)}}class Hs extends Error{constructor(e,t,n,i,s,o){super(n.join(`
`).replace("Program log: ","")),this.errorLogs=n,this.logs=i,this.error={errorCode:e,errorMessage:t,comparedValues:o,origin:s},this._programErrorStack=Ro.parse(i)}static parse(e){if(!e)return null;const t=e.findIndex(l=>l.startsWith("Program log: AnchorError"));if(t===-1)return null;const n=e[t],i=[n];let s;if(t+1<e.length){if(e[t+1]==="Program log: Left:"){const l=/^Program log: (.*)$/,u=l.exec(e[t+2])[1],d=l.exec(e[t+4])[1];s=[new Y(u),new Y(d)],i.push(...e.slice(t+1,t+5))}else if(e[t+1].startsWith("Program log: Left:")){const l=/^Program log: (Left|Right): (.*)$/,u=l.exec(e[t+1])[2],d=l.exec(e[t+2])[2];i.push(...e.slice(t+1,t+3)),s=[u,d]}}const o=/^Program log: AnchorError occurred\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n),a=/^Program log: AnchorError thrown in (.*):(\d*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n),c=/^Program log: AnchorError caused by account: (.*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n);if(o){const[l,u,d]=o.slice(1,4),m={code:l,number:parseInt(u)};return new Hs(m,d,i,e,void 0,s)}if(a){const[l,u,d,m,y]=a.slice(1,6),S={code:d,number:parseInt(m)},p={file:l,line:parseInt(u)};return new Hs(S,y,i,e,p,s)}if(c){const[l,u,d,m]=c.slice(1,5),y=l,S={code:u,number:parseInt(d)};return new Hs(S,m,i,e,y,s)}return null}get program(){return this._programErrorStack.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){return this._programErrorStack.stack}toString(){return this.message}}class ba extends Error{constructor(e,t,n){super(),this.code=e,this.msg=t,this.logs=n,n&&(this._programErrorStack=Ro.parse(n))}static parse(e,t){const n=e.toString();let i,s;if(n.includes("custom program error:")){let a=n.split("custom program error: ");if(a.length!==2)return null;i=a[1]}else{const a=n.match(/"Custom":([0-9]+)}/g);if(!a||a.length>1)return null;i=a[0].match(/([0-9]+)/g)[0]}try{s=parseInt(i)}catch{return null}let o=t.get(s);return o!==void 0?new ba(s,o,e.logs):(o=Ng.get(s),o!==void 0?new ba(s,o,e.logs):null)}get program(){var e;return(e=this._programErrorStack)===null||e===void 0?void 0:e.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){var e;return(e=this._programErrorStack)===null||e===void 0?void 0:e.stack}toString(){return this.msg}}function Nf(r,e){Lu("debug-logs")&&console.log("Translating error:",r);const t=Hs.parse(r.logs);if(t)return t;const n=ba.parse(r,e);if(n)return n;if(r.logs){const i={get:function(s,o){return o==="programErrorStack"?s.programErrorStack.stack:o==="program"?s.programErrorStack.stack[r.programErrorStack.stack.length-1]:Reflect.get(...arguments)}};return r.programErrorStack=Ro.parse(r.logs),new Proxy(r,i)}return r}const be={InstructionMissing:100,InstructionFallbackNotFound:101,InstructionDidNotDeserialize:102,InstructionDidNotSerialize:103,IdlInstructionStub:1e3,IdlInstructionInvalidProgram:1001,ConstraintMut:2e3,ConstraintHasOne:2001,ConstraintSigner:2002,ConstraintRaw:2003,ConstraintOwner:2004,ConstraintRentExempt:2005,ConstraintSeeds:2006,ConstraintExecutable:2007,ConstraintState:2008,ConstraintAssociated:2009,ConstraintAssociatedInit:2010,ConstraintClose:2011,ConstraintAddress:2012,ConstraintZero:2013,ConstraintTokenMint:2014,ConstraintTokenOwner:2015,ConstraintMintMintAuthority:2016,ConstraintMintFreezeAuthority:2017,ConstraintMintDecimals:2018,ConstraintSpace:2019,RequireViolated:2500,RequireEqViolated:2501,RequireKeysEqViolated:2502,RequireNeqViolated:2503,RequireKeysNeqViolated:2504,RequireGtViolated:2505,RequireGteViolated:2506,AccountDiscriminatorAlreadySet:3e3,AccountDiscriminatorNotFound:3001,AccountDiscriminatorMismatch:3002,AccountDidNotDeserialize:3003,AccountDidNotSerialize:3004,AccountNotEnoughKeys:3005,AccountNotMutable:3006,AccountOwnedByWrongProgram:3007,InvalidProgramId:3008,InvalidProgramExecutable:3009,AccountNotSigner:3010,AccountNotSystemOwned:3011,AccountNotInitialized:3012,AccountNotProgramData:3013,AccountNotAssociatedTokenAccount:3014,AccountSysvarMismatch:3015,StateInvalidAddress:4e3,DeclaredProgramIdMismatch:4100,Deprecated:5e3},Ng=new Map([[be.InstructionMissing,"8 byte instruction identifier not provided"],[be.InstructionFallbackNotFound,"Fallback functions are not supported"],[be.InstructionDidNotDeserialize,"The program could not deserialize the given instruction"],[be.InstructionDidNotSerialize,"The program could not serialize the given instruction"],[be.IdlInstructionStub,"The program was compiled without idl instructions"],[be.IdlInstructionInvalidProgram,"The transaction was given an invalid program for the IDL instruction"],[be.ConstraintMut,"A mut constraint was violated"],[be.ConstraintHasOne,"A has_one constraint was violated"],[be.ConstraintSigner,"A signer constraint was violated"],[be.ConstraintRaw,"A raw constraint was violated"],[be.ConstraintOwner,"An owner constraint was violated"],[be.ConstraintRentExempt,"A rent exemption constraint was violated"],[be.ConstraintSeeds,"A seeds constraint was violated"],[be.ConstraintExecutable,"An executable constraint was violated"],[be.ConstraintState,"A state constraint was violated"],[be.ConstraintAssociated,"An associated constraint was violated"],[be.ConstraintAssociatedInit,"An associated init constraint was violated"],[be.ConstraintClose,"A close constraint was violated"],[be.ConstraintAddress,"An address constraint was violated"],[be.ConstraintZero,"Expected zero account discriminant"],[be.ConstraintTokenMint,"A token mint constraint was violated"],[be.ConstraintTokenOwner,"A token owner constraint was violated"],[be.ConstraintMintMintAuthority,"A mint mint authority constraint was violated"],[be.ConstraintMintFreezeAuthority,"A mint freeze authority constraint was violated"],[be.ConstraintMintDecimals,"A mint decimals constraint was violated"],[be.ConstraintSpace,"A space constraint was violated"],[be.RequireViolated,"A require expression was violated"],[be.RequireEqViolated,"A require_eq expression was violated"],[be.RequireKeysEqViolated,"A require_keys_eq expression was violated"],[be.RequireNeqViolated,"A require_neq expression was violated"],[be.RequireKeysNeqViolated,"A require_keys_neq expression was violated"],[be.RequireGtViolated,"A require_gt expression was violated"],[be.RequireGteViolated,"A require_gte expression was violated"],[be.AccountDiscriminatorAlreadySet,"The account discriminator was already set on this account"],[be.AccountDiscriminatorNotFound,"No 8 byte discriminator was found on the account"],[be.AccountDiscriminatorMismatch,"8 byte discriminator did not match what was expected"],[be.AccountDidNotDeserialize,"Failed to deserialize the account"],[be.AccountDidNotSerialize,"Failed to serialize the account"],[be.AccountNotEnoughKeys,"Not enough account keys given to the instruction"],[be.AccountNotMutable,"The given account is not mutable"],[be.AccountOwnedByWrongProgram,"The given account is owned by a different program than expected"],[be.InvalidProgramId,"Program ID was not as expected"],[be.InvalidProgramExecutable,"Program account is not executable"],[be.AccountNotSigner,"The given account did not sign"],[be.AccountNotSystemOwned,"The given account is not owned by the system program"],[be.AccountNotInitialized,"The program expected this account to be already initialized"],[be.AccountNotProgramData,"The given account is not a program data account"],[be.AccountNotAssociatedTokenAccount,"The given account is not the associated token account"],[be.AccountSysvarMismatch,"The given public key does not match the required sysvar"],[be.StateInvalidAddress,"The given state account does not have the correct address"],[be.DeclaredProgramIdMismatch,"The declared program id does not match the actual program id"],[be.Deprecated,"The API being used is deprecated and should no longer be used"]]);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Fc=function(){return Fc=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i]);return r},Fc.apply(this,arguments)};function y_(r){return r.toLowerCase()}var g_=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],m_=/[^A-Z0-9]+/gi;function dp(r,e,t){return e instanceof RegExp?r.replace(e,t):e.reduce(function(n,i){return n.replace(i,t)},r)}function b_(r,e){return e===void 0&&(e={}),function(t,n){n===void 0&&(n={});for(var i=n.splitRegexp,s=i===void 0?g_:i,o=n.stripRegexp,a=o===void 0?m_:o,c=n.transform,l=c===void 0?y_:c,u=n.delimiter,d=u===void 0?" ":u,m=dp(dp(t,s,"$1\0$2"),a,"\0"),y=0,S=m.length;m.charAt(y)==="\0";)y++;for(;m.charAt(S-1)==="\0";)S--;return m.slice(y,S).split("\0").map(l).join(d)}(r,Fc({delimiter:"."},e))}class Un{static fieldLayout(e,t){const n=e.name!==void 0?rn(e.name):void 0;switch(e.type){case"bool":return Te.bool(n);case"u8":return Te.u8(n);case"i8":return Te.i8(n);case"u16":return Te.u16(n);case"i16":return Te.i16(n);case"u32":return Te.u32(n);case"i32":return Te.i32(n);case"f32":return Te.f32(n);case"u64":return Te.u64(n);case"i64":return Te.i64(n);case"f64":return Te.f64(n);case"u128":return Te.u128(n);case"i128":return Te.i128(n);case"bytes":return Te.vecU8(n);case"string":return Te.str(n);case"publicKey":return Te.publicKey(n);default:if("vec"in e.type)return Te.vec(Un.fieldLayout({name:void 0,type:e.type.vec},t),n);if("option"in e.type)return Te.option(Un.fieldLayout({name:void 0,type:e.type.option},t),n);if("defined"in e.type){const i=e.type.defined;if(t===void 0)throw new ma("User defined types not provided");const s=t.filter(o=>o.name===i);if(s.length!==1)throw new ma(`Type not found: ${JSON.stringify(e)}`);return Un.typeDefLayout(s[0],t,n)}if("array"in e.type){let i=e.type.array[0],s=e.type.array[1],o=Un.fieldLayout({name:void 0,type:i},t);return Te.array(o,s,n)}throw new Error(`Not yet implemented: ${e}`)}}static typeDefLayout(e,t=[],n){if(e.type.kind==="struct"){const i=e.type.fields.map(s=>Un.fieldLayout(s,t));return Te.struct(i,n)}if(e.type.kind==="enum"){let i=e.type.variants.map(s=>{const o=rn(s.name);if(s.fields===void 0)return Te.struct([],o);const a=s.fields.map(c=>{if(!c.hasOwnProperty("name"))throw new Error("Tuple enum variants not yet implemented.");return Un.fieldLayout(c,t)});return Te.struct(a,o)});return n!==void 0?Te.rustEnum(i).replicate(n):Te.rustEnum(i,n)}throw new Error(`Unknown type kint: ${e}`)}}class Ku{constructor(e){this.idl=e,this.ixLayout=Ku.parseIxLayout(e);const t=new Map;e.instructions.forEach(n=>{const i=Ql("global",n.name);t.set(me.encode(i),{layout:this.ixLayout.get(n.name),name:n.name})}),e.state&&e.state.methods.map(n=>{const i=Ql("state",n.name);t.set(me.encode(i),{layout:this.ixLayout.get(n.name),name:n.name})}),this.sighashLayouts=t}encode(e,t){return this._encode("global",e,t)}encodeState(e,t){return this._encode("state",e,t)}_encode(e,t,n){const i=L.Buffer.alloc(1e3),s=rn(t),o=this.ixLayout.get(s);if(!o)throw new Error(`Unknown method: ${s}`);const a=o.encode(n,i),c=i.slice(0,a);return L.Buffer.concat([Ql(e,t),c])}static parseIxLayout(e){const t=(e.state?e.state.methods:[]).map(n=>{let i=n.args.map(o=>{var a,c;return Un.fieldLayout(o,Array.from([...(a=e.accounts)!==null&&a!==void 0?a:[],...(c=e.types)!==null&&c!==void 0?c:[]]))});const s=rn(n.name);return[s,Te.struct(i,s)]}).concat(e.instructions.map(n=>{let i=n.args.map(o=>{var a,c;return Un.fieldLayout(o,Array.from([...(a=e.accounts)!==null&&a!==void 0?a:[],...(c=e.types)!==null&&c!==void 0?c:[]]))});const s=rn(n.name);return[s,Te.struct(i,s)]}));return new Map(t)}decode(e,t="hex"){typeof e=="string"&&(e=t==="hex"?L.Buffer.from(e,"hex"):me.decode(e));let n=me.encode(e.slice(0,8)),i=e.slice(8);const s=this.sighashLayouts.get(n);return s?{data:s.layout.decode(i),name:s.name}:null}format(e,t){return Hr.format(e,t,this.idl)}}class Hr{static format(e,t,n){const i=n.instructions.filter(a=>e.name===a.name)[0];if(i===void 0)return console.error("Invalid instruction given"),null;const s=i.args.map(a=>({name:a.name,type:Hr.formatIdlType(a.type),data:Hr.formatIdlData(a,e.data[a.name],n.types)})),o=Hr.flattenIdlAccounts(i.accounts);return{args:s,accounts:t.map((a,c)=>c<o.length?{name:o[c].name,...a}:{name:void 0,...a})}}static formatIdlType(e){if(typeof e=="string")return e;if("vec"in e)return`Vec<${this.formatIdlType(e.vec)}>`;if("option"in e)return`Option<${this.formatIdlType(e.option)}>`;if("defined"in e)return e.defined;if("array"in e)return`Array<${e.array[0]}; ${e.array[1]}>`;throw new Error(`Unknown IDL type: ${e}`)}static formatIdlData(e,t,n){if(typeof e.type=="string")return t.toString();if(e.type.hasOwnProperty("vec"))return"["+t.map(i=>this.formatIdlData({name:"",type:e.type.vec},i)).join(", ")+"]";if(e.type.hasOwnProperty("option"))return t===null?"null":this.formatIdlData({name:"",type:e.type.option},t,n);if(e.type.hasOwnProperty("defined")){if(n===void 0)throw new Error("User defined types not provided");const i=n.filter(s=>s.name===e.type.defined);if(i.length!==1)throw new Error(`Type not found: ${e.type.defined}`);return Hr.formatIdlDataDefined(i[0],t,n)}return"unknown"}static formatIdlDataDefined(e,t,n){if(e.type.kind==="struct"){const i=e.type;return"{ "+Object.keys(t).map(s=>{const o=i.fields.filter(a=>a.name===s)[0];if(o===void 0)throw new Error("Unable to find type");return s+": "+Hr.formatIdlData(o,t[s],n)}).join(", ")+" }"}if(e.type.variants.length===0)return"{}";if(e.type.variants[0].name){const i=e.type.variants,s=Object.keys(t)[0],o=t[s],a=Object.keys(o).map(l=>{var u;const d=o[l],m=(u=i[s])===null||u===void 0?void 0:u.filter(y=>y.name===l)[0];if(m===void 0)throw new Error("Unable to find variant");return l+": "+Hr.formatIdlData(m,d,n)}).join(", "),c=rn(s,{pascalCase:!0});return a.length===0?c:`${c} { ${a} }`}return"Tuple formatting not yet implemented"}static flattenIdlAccounts(e,t){return e.map(n=>{const i=function(s){const o=s.replace(/([A-Z])/g," $1");return o.charAt(0).toUpperCase()+o.slice(1)}(n.name);if(n.hasOwnProperty("accounts")){const s=t?`${t} > ${i}`:i;return Hr.flattenIdlAccounts(n.accounts,s)}return{...n,name:t?`${t} > ${i}`:i}}).flat()}}function Ql(r,e){var t;let n=`${r}:${t===void 0&&(t={}),b_(e,Fc({delimiter:"_"},t))}`;return L.Buffer.from(fs.exports.sha256.digest(n)).slice(0,8)}function $f(r,e){if(e.type.kind==="enum"){let t=e.type.variants.map(n=>n.fields===void 0?0:n.fields.map(i=>{if(typeof i!="object"||!("name"in i))throw new Error("Tuple enum variants not yet implemented.");return ia(r,i.type)}).reduce((i,s)=>i+s));return Math.max(...t)+1}return e.type.fields===void 0?0:e.type.fields.map(t=>ia(r,t.type)).reduce((t,n)=>t+n,0)}function ia(r,e){var t,n;switch(e){case"bool":case"u8":case"i8":case"bytes":case"string":return 1;case"i16":case"u16":return 2;case"u32":case"i32":case"f32":return 4;case"u64":case"i64":case"f64":return 8;case"u128":case"i128":return 16;case"publicKey":return 32;default:if("vec"in e)return 1;if("option"in e)return 1+ia(r,e.option);if("coption"in e)return 4+ia(r,e.coption);if("defined"in e){const i=(n=(t=r.types)===null||t===void 0?void 0:t.filter(s=>s.name===e.defined))!==null&&n!==void 0?n:[];if(i.length!==1)throw new ma(`Type not found: ${JSON.stringify(e)}`);return $f(r,i[0])}if("array"in e){let i=e.array[0],s=e.array[1];return ia(r,i)*s}throw new Error(`Invalid type ${JSON.stringify(e)}`)}}const w_=8;class Ys{constructor(e){if(e.accounts===void 0)return void(this.accountLayouts=new Map);const t=e.accounts.map(n=>[n.name,Un.typeDefLayout(n,e.types)]);this.accountLayouts=new Map(t),this.idl=e}async encode(e,t){const n=L.Buffer.alloc(1e3),i=this.accountLayouts.get(e);if(!i)throw new Error(`Unknown account: ${e}`);const s=i.encode(t,n);let o=n.slice(0,s),a=Ys.accountDiscriminator(e);return L.Buffer.concat([a,o])}decode(e,t){if(Ys.accountDiscriminator(e).compare(t.slice(0,8)))throw new Error("Invalid account discriminator");return this.decodeUnchecked(e,t)}decodeUnchecked(e,t){const n=t.slice(8),i=this.accountLayouts.get(e);if(!i)throw new Error(`Unknown account: ${e}`);return i.decode(n)}memcmp(e,t){const n=Ys.accountDiscriminator(e);return{offset:0,bytes:me.encode(t?L.Buffer.concat([n,t]):n)}}size(e){var t;return 8+((t=$f(this.idl,e))!==null&&t!==void 0?t:0)}static accountDiscriminator(e){return L.Buffer.from(fs.exports.sha256.digest(`account:${rn(e,{pascalCase:!0})}`)).slice(0,8)}}class $g{constructor(e){if(e.events===void 0)return void(this.layouts=new Map);const t=e.events.map(n=>{let i={name:n.name,type:{kind:"struct",fields:n.fields.map(s=>({name:s.name,type:s.type}))}};return[n.name,Un.typeDefLayout(i,e.types)]});this.layouts=new Map(t),this.discriminators=new Map(e.events===void 0?[]:e.events.map(n=>[_d(Dg(n.name)),n.name]))}decode(e){let t;try{t=L.Buffer.from(Ly(e))}catch{return null}const n=_d(t.slice(0,8)),i=this.discriminators.get(n);if(i===void 0)return null;const s=this.layouts.get(i);if(!s)throw new Error(`Unknown event: ${i}`);return{data:s.decode(t.slice(8)),name:i}}}function Dg(r){return L.Buffer.from(fs.exports.sha256.digest(`event:${r}`)).slice(0,8)}class zg{constructor(e){if(e.state===void 0)throw new Error("Idl state not defined.");this.layout=Un.typeDefLayout(e.state.struct,e.types)}async encode(e,t){const n=L.Buffer.alloc(1e3),i=this.layout.encode(t,n),s=await Df(e),o=n.slice(0,i);return L.Buffer.concat([s,o])}decode(e){const t=e.slice(8);return this.layout.decode(t)}}async function Df(r){let e=Lu("anchor-deprecated-state")?"account":"state";return L.Buffer.from(fs.exports.sha256.digest(`${e}:${r}`)).slice(0,8)}class Nu{constructor(e){this.instruction=new Ku(e),this.accounts=new Ys(e),this.events=new $g(e),e.state&&(this.state=new zg(e))}}var k_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof we.global<"u"?we.global:typeof self<"u"?self:{};function S_(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}class Hn{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}decode(e,t){throw new Error("Layout is abstract")}encode(e,t,n){throw new Error("Layout is abstract")}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}var Wg=Hn;class Ui extends Hn{isCount(){throw new Error("ExternalLayout is abstract")}}class v_ extends Ui{constructor(e,t,n){if(!(e instanceof Hn))throw new TypeError("layout must be a Layout");if(t===void 0)t=0;else if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,n||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof $u||this.layout instanceof Vg}decode(e,t){return t===void 0&&(t=0),this.layout.decode(e,t+this.offset)}encode(e,t,n){return n===void 0&&(n=0),this.layout.encode(e,t,n+this.offset)}}class $u extends Hn{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntLE(t,this.span)}encode(e,t,n){return n===void 0&&(n=0),t.writeUIntLE(e,n,this.span),this.span}}class Vg extends Hn{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntBE(t,this.span)}encode(e,t,n){return n===void 0&&(n=0),t.writeUIntBE(e,n,this.span),this.span}}const Xl=Math.pow(2,32);class __ extends Hn{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const n=e.readUInt32LE(t);return function(i,s){return i*Xl+s}(e.readUInt32LE(t+4),n)}encode(e,t,n){n===void 0&&(n=0);const i=function(s){const o=Math.floor(s/Xl);return{hi32:o,lo32:s-o*Xl}}(e);return t.writeUInt32LE(i.lo32,n),t.writeUInt32LE(i.hi32,n+4),8}}class A_ extends Hn{constructor(e,t,n){if(!Array.isArray(e)||!e.reduce((s,o)=>s&&o instanceof Hn,!0))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&n===void 0&&(n=t,t=void 0);for(const s of e)if(0>s.span&&s.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let i=-1;try{i=e.reduce((s,o)=>s+o.getSpan(),0)}catch{}super(i,t),this.fields=e,this.decodePrefixes=!!n}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let n=0;try{n=this.fields.reduce((i,s)=>{const o=s.getSpan(e,t);return t+=o,i+o},0)}catch{throw new RangeError("indeterminate span")}return n}decode(e,t){t===void 0&&(t=0);const n=this.makeDestinationObject();for(const i of this.fields)if(i.property!==void 0&&(n[i.property]=i.decode(e,t)),t+=i.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return n}encode(e,t,n){n===void 0&&(n=0);const i=n;let s=0,o=0;for(const a of this.fields){let c=a.span;if(o=0<c?c:0,a.property!==void 0){const l=e[a.property];l!==void 0&&(o=a.encode(l,t,n),0>c&&(c=a.getSpan(t,n)))}s=n,n+=c}return s+o-i}fromArray(e){const t=this.makeDestinationObject();for(const n of this.fields)n.property!==void 0&&0<e.length&&(t[n.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const n of this.fields){if(n.property===e)return t;0>n.span?t=-1:0<=t&&(t+=n.span)}}}class Ug{constructor(e){this.property=e}decode(){throw new Error("UnionDiscriminator is abstract")}encode(){throw new Error("UnionDiscriminator is abstract")}}class fp extends Ug{constructor(e,t){if(!(e instanceof Ui&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,n){return this.layout.encode(e,t,n)}}class Fg extends Hn{constructor(e,t,n){const i=e instanceof $u||e instanceof Vg;if(i)e=new fp(new v_(e));else if(e instanceof Ui&&e.isCount())e=new fp(e);else if(!(e instanceof Ug))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(t===void 0&&(t=null),!(t===null||t instanceof Hn))throw new TypeError("defaultLayout must be null or a Layout");if(t!==null){if(0>t.span)throw new Error("defaultLayout must have constant span");t.property===void 0&&(t=t.replicate("content"))}let s=-1;t&&(s=t.span,0<=s&&i&&(s+=e.layout.span)),super(s,n),this.discriminator=e,this.usesPrefixDiscriminator=i,this.defaultLayout=t,this.registry={};let o=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(a){return o(a)},this.configGetSourceVariant=function(a){o=a.bind(this)}}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);const n=this.getVariant(e,t);if(!n)throw new Error("unable to determine span for unrecognized variant");return n.getSpan(e,t)}defaultGetSourceVariant(e){if(e.hasOwnProperty(this.discriminator.property)){if(this.defaultLayout&&e.hasOwnProperty(this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||e.hasOwnProperty(t.property)))return t}else for(const t in this.registry){const n=this.registry[t];if(e.hasOwnProperty(n.property))return n}throw new Error("unable to infer src variant")}decode(e,t){let n;t===void 0&&(t=0);const i=this.discriminator,s=i.decode(e,t);let o=this.registry[s];if(o===void 0){let a=0;o=this.defaultLayout,this.usesPrefixDiscriminator&&(a=i.layout.span),n=this.makeDestinationObject(),n[i.property]=s,n[o.property]=this.defaultLayout.decode(e,t+a)}else n=o.decode(e,t);return n}encode(e,t,n){n===void 0&&(n=0);const i=this.getSourceVariant(e);if(i===void 0){const s=this.discriminator,o=this.defaultLayout;let a=0;return this.usesPrefixDiscriminator&&(a=s.layout.span),s.encode(e[s.property],t,n),a+o.encode(e[o.property],t,n+a)}return i.encode(e,t,n)}addVariant(e,t,n){const i=new I_(this,e,t,n);return this.registry[e]=i,i}getVariant(e,t){let n=e;return we.Buffer.isBuffer(e)&&(t===void 0&&(t=0),n=this.discriminator.decode(e,t)),this.registry[n]}}class I_ extends Hn{constructor(e,t,n,i){if(!(e instanceof Fg))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if(typeof n=="string"&&i===void 0&&(i=n,n=null),n){if(!(n instanceof Hn))throw new TypeError("layout must be a Layout");if(e.defaultLayout!==null&&0<=n.span&&n.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof i!="string")throw new TypeError("variant must have a String property")}let s=e.span;0>e.span&&(s=n?n.span:0,0<=s&&e.usesPrefixDiscriminator&&(s+=e.discriminator.layout.span)),super(s,i),this.union=e,this.variant=t,this.layout=n||null}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let n=0;return this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),n+this.layout.getSpan(e,t+n)}decode(e,t){const n=this.makeDestinationObject();if(t===void 0&&(t=0),this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let i=0;return this.union.usesPrefixDiscriminator&&(i=this.union.discriminator.layout.span),this.layout?n[this.property]=this.layout.decode(e,t+i):this.property?n[this.property]=!0:this.union.usesPrefixDiscriminator&&(n[this.union.discriminator.property]=this.variant),n}encode(e,t,n){n===void 0&&(n=0);let i=0;if(this.union.usesPrefixDiscriminator&&(i=this.union.discriminator.layout.span),this.layout&&!e.hasOwnProperty(this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,n);let s=i;if(this.layout&&(this.layout.encode(e[this.property],t,n+i),s+=this.layout.getSpan(t,n+i),0<=this.union.span&&s>this.union.span))throw new Error("encoded variant overruns containing union");return s}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}class E_ extends Hn{constructor(e,t){if(!(e instanceof Ui&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;e instanceof Ui||(n=e),super(n,t),this.length=e}getSpan(e,t){let n=this.span;return 0>n&&(n=this.length.decode(e,t)),n}decode(e,t){t===void 0&&(t=0);let n=this.span;return 0>n&&(n=this.length.decode(e,t)),e.slice(t,t+n)}encode(e,t,n){let i=this.length;if(this.length instanceof Ui&&(i=e.length),!we.Buffer.isBuffer(e)||i!==e.length)throw new TypeError((s="Blob.encode",((o=this).property?s+"["+o.property+"]":s)+" requires (length "+i+") Buffer as src"));var s,o;if(n+i>t.length)throw new RangeError("encoding overruns Buffer");return t.write(e.toString("hex"),n,i,"hex"),this.length instanceof Ui&&this.length.encode(i,t,n),i}}var ln=r=>new $u(1,r),ai=r=>new __(r),kt=(r,e,t)=>new A_(r,e,t),Du=(r,e)=>new E_(r,e);class P_{constructor(e){}encode(e,t){switch(rn(e)){case"initializeMint":return function({decimals:n,mintAuthority:i,freezeAuthority:s}){return Bt({initializeMint:{decimals:n,mintAuthority:i.toBuffer(),freezeAuthorityOption:!!s,freezeAuthority:(s||Y.default).toBuffer()}})}(t);case"initializeAccount":return Bt({initializeAccount:{}});case"initializeMultisig":return function({m:n}){return Bt({initializeMultisig:{m:n}})}(t);case"transfer":return function({amount:n}){return Bt({transfer:{amount:n}})}(t);case"approve":return function({amount:n}){return Bt({approve:{amount:n}})}(t);case"revoke":return Bt({revoke:{}});case"setAuthority":return function({authorityType:n,newAuthority:i}){return Bt({setAuthority:{authorityType:n,newAuthority:i}})}(t);case"mintTo":return function({amount:n}){return Bt({mintTo:{amount:n}})}(t);case"burn":return function({amount:n}){return Bt({burn:{amount:n}})}(t);case"closeAccount":return Bt({closeAccount:{}});case"freezeAccount":return Bt({freezeAccount:{}});case"thawAccount":return Bt({thawAccount:{}});case"transferChecked":return function({amount:n,decimals:i}){return Bt({transferChecked:{amount:n,decimals:i}})}(t);case"approvedChecked":return function({amount:n,decimals:i}){return Bt({approveChecked:{amount:n,decimals:i}})}(t);case"mintToChecked":return function({amount:n,decimals:i}){return Bt({mintToChecked:{amount:n,decimals:i}})}(t);case"burnChecked":return function({amount:n,decimals:i}){return Bt({burnChecked:{amount:n,decimals:i}})}(t);case"intializeAccount2":return function({authority:n}){return Bt({initilaizeAccount2:{authority:n}})}(t);case"syncNative":return Bt({syncNative:{}});case"initializeAccount3":return function({authority:n}){return Bt({initializeAccount3:{authority:n}})}(t);case"initializeMultisig2":return function({m:n}){return Bt({initializeMultisig2:{m:n}})}(t);case"initializeMint2":return function({decimals:n,mintAuthority:i,freezeAuthority:s}){return Bt({encodeInitializeMint2:{decimals:n,mintAuthority:i,freezeAuthority:s}})}(t);default:throw new Error(`Invalid instruction: ${e}`)}}encodeState(e,t){throw new Error("SPL token does not have state")}}const St=(hp=ln("instruction"),new Fg(hp,R_,T_));var hp,R_,T_;function Ps(r){return Du(32,r)}function Bt(r){let e=we.Buffer.alloc(O_),t=St.encode(r,e);return e.slice(0,t)}St.addVariant(0,kt([ln("decimals"),Du(32,"mintAuthority"),ln("freezeAuthorityOption"),Ps("freezeAuthority")]),"initializeMint"),St.addVariant(1,kt([]),"initializeAccount"),St.addVariant(2,kt([ln("m")]),"initializeMultisig"),St.addVariant(3,kt([ai("amount")]),"transfer"),St.addVariant(4,kt([ai("amount")]),"approve"),St.addVariant(5,kt([]),"revoke"),St.addVariant(6,kt([ln("authorityType"),ln("newAuthorityOption"),Ps("newAuthority")]),"setAuthority"),St.addVariant(7,kt([ai("amount")]),"mintTo"),St.addVariant(8,kt([ai("amount")]),"burn"),St.addVariant(9,kt([]),"closeAccount"),St.addVariant(10,kt([]),"freezeAccount"),St.addVariant(11,kt([]),"thawAccount"),St.addVariant(12,kt([ai("amount"),ln("decimals")]),"transferChecked"),St.addVariant(13,kt([ai("amount"),ln("decimals")]),"approvedChecked"),St.addVariant(14,kt([ai("amount"),ln("decimals")]),"mintToChecked"),St.addVariant(15,kt([ai("amount"),ln("decimals")]),"burnedChecked"),St.addVariant(16,kt([Ps("authority")]),"InitializeAccount2"),St.addVariant(17,kt([]),"syncNative"),St.addVariant(18,kt([Ps("authority")]),"initializeAccount3"),St.addVariant(19,kt([ln("m")]),"initializeMultisig2"),St.addVariant(20,kt([ln("decimals"),Ps("mintAuthority"),ln("freezeAuthorityOption"),Ps("freezeAuthority")]),"initializeMint2");const O_=Math.max(...Object.values(St.registry).map(r=>r.span));class B_{constructor(e){}encode(e,t){throw new Error("SPL token does not have state")}decode(e){throw new Error("SPL token does not have state")}}function Oc(r){return new zf(Du(8),e=>Wf.fromBuffer(e),e=>e.toBuffer(),r)}function Ks(r){return new zf(Du(32),e=>new Y(e),e=>e.toBuffer(),r)}function sa(r,e){return new x_(r,e)}class zf extends Wg{constructor(e,t,n,i){super(e.span,i),this.layout=e,this.decoder=t,this.encoder=n}decode(e,t){return this.decoder(this.layout.decode(e,t))}encode(e,t,n){return this.layout.encode(this.encoder(e),t,n)}getSpan(e,t){return this.layout.getSpan(e,t)}}class x_ extends Wg{constructor(e,t){super(-1,t),this.layout=e,this.discriminator=(n=>new $u(4,n))()}encode(e,t,n=0){return e==null?this.layout.span+this.discriminator.encode(0,t,n):(this.discriminator.encode(1,t,n),this.layout.encode(e,t,n+4)+4)}decode(e,t=0){const n=this.discriminator.decode(e,t);if(n===0)return null;if(n===1)return this.layout.decode(e,t+4);throw new Error("Invalid coption "+this.layout.property)}getSpan(e,t=0){return this.layout.getSpan(e,t+4)+4}}function C_(r){if(r===0)return!1;if(r===1)return!0;throw new Error("Invalid bool: "+r)}function M_(r){return r?1:0}class Wf extends kn{toBuffer(){const e=super.toArray().reverse(),t=we.Buffer.from(e);if(t.length===8)return t;if(t.length>=8)throw new Error("u64 too large");const n=we.Buffer.alloc(8);return t.copy(n),n}static fromBuffer(e){if(e.length!==8)throw new Error(`Invalid buffer length: ${e.length}`);return new Wf([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}class L_{constructor(e){this.idl=e}async encode(e,t){switch(e){case"token":{const n=we.Buffer.alloc(165),i=yp.encode(t,n);return n.slice(0,i)}case"mint":{const n=we.Buffer.alloc(82),i=pp.encode(t,n);return n.slice(0,i)}default:throw new Error(`Invalid account name: ${e}`)}}decode(e,t){return this.decodeUnchecked(e,t)}decodeUnchecked(e,t){switch(e){case"token":return function(n){return yp.decode(n)}(t);case"mint":return function(n){return pp.decode(n)}(t);default:throw new Error(`Invalid account name: ${e}`)}}memcmp(e,t){switch(e){case"token":return{dataSize:165};case"mint":return{dataSize:82};default:throw new Error(`Invalid account name: ${e}`)}}size(e){var t;return(t=$f(this.idl,e))!==null&&t!==void 0?t:0}}const pp=kt([sa(Ks(),"mintAuthority"),Oc("supply"),ln("decimals"),function(r){return new zf(ln(),C_,M_,r)}("isInitialized"),sa(Ks(),"freezeAuthority")]),yp=kt([Ks("mint"),Ks("authority"),Oc("amount"),sa(Ks(),"delegate"),ln("state"),sa(Oc(),"isNative"),Oc("delegatedAmount"),sa(Ks(),"closeAuthority")]);class K_{constructor(e){}decode(e){throw new Error("SPL token program does not have events")}}class jg{constructor(e){this.instruction=new P_(e),this.accounts=new L_(e),this.events=new K_(e),this.state=new B_(e)}}var N_=Object.freeze({__proto__:null,hash:function(r){return fs.exports.sha256(r)}});function qg(r,e,t){const n=L.Buffer.concat([r.toBuffer(),L.Buffer.from(e),t.toBuffer()]),i=fs.exports.sha256.digest(n);return new Y(L.Buffer.from(i))}function Gg(r,e){let t=L.Buffer.alloc(0);r.forEach(function(s){if(s.length>32)throw new TypeError("Max seed length exceeded");t=L.Buffer.concat([t,$_(s)])}),t=L.Buffer.concat([t,e.toBuffer(),L.Buffer.from("ProgramDerivedAddress")]);let n=fs.exports.sha256(new Uint8Array(t)),i=new kn(n,16).toArray(void 0,32);if(Y.isOnCurve(new Uint8Array(i)))throw new Error("Invalid seeds, address must fall off the curve");return new Y(i)}function Vf(r,e){let t,n=255;for(;n!=0;){try{t=Gg(r.concat(L.Buffer.from([n])),e)}catch(i){if(i instanceof TypeError)throw i;n--;continue}return[t,n]}throw new Error("Unable to find a viable program address nonce")}const $_=r=>r instanceof L.Buffer?r:r instanceof Uint8Array?L.Buffer.from(r.buffer,r.byteOffset,r.byteLength):L.Buffer.from(r);async function Hg(r,...e){let t=[L.Buffer.from([97,110,99,104,111,114])];e.forEach(i=>{t.push(i instanceof L.Buffer?i:hr(i).toBuffer())});const[n]=await Y.findProgramAddress(t,hr(r));return n}var D_=Object.freeze({__proto__:null,createWithSeedSync:qg,createProgramAddressSync:Gg,findProgramAddressSync:Vf,associated:Hg});const xd=new Y("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),Cd=new Y("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");var z_=Object.freeze({__proto__:null,TOKEN_PROGRAM_ID:xd,ASSOCIATED_PROGRAM_ID:Cd,associatedAddress:async function({mint:r,owner:e}){return(await Y.findProgramAddress([e.toBuffer(),xd.toBuffer(),r.toBuffer()],Cd))[0]}}),Md={exports:{}};(function(r,e){var t=typeof self<"u"?self:k_,n=function(){function s(){this.fetch=!1,this.DOMException=t.DOMException}return s.prototype=t,new s}();(function(s){(function(o){var a="URLSearchParams"in s,c="Symbol"in s&&"iterator"in Symbol,l="FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),u="FormData"in s,d="ArrayBuffer"in s;if(d)var m=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],y=ArrayBuffer.isView||function(I){return I&&m.indexOf(Object.prototype.toString.call(I))>-1};function S(I){if(typeof I!="string"&&(I=String(I)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(I))throw new TypeError("Invalid character in header field name");return I.toLowerCase()}function p(I){return typeof I!="string"&&(I=String(I)),I}function w(I){var D={next:function(){var G=I.shift();return{done:G===void 0,value:G}}};return c&&(D[Symbol.iterator]=function(){return D}),D}function v(I){this.map={},I instanceof v?I.forEach(function(D,G){this.append(G,D)},this):Array.isArray(I)?I.forEach(function(D){this.append(D[0],D[1])},this):I&&Object.getOwnPropertyNames(I).forEach(function(D){this.append(D,I[D])},this)}function E(I){if(I.bodyUsed)return Promise.reject(new TypeError("Already read"));I.bodyUsed=!0}function P(I){return new Promise(function(D,G){I.onload=function(){D(I.result)},I.onerror=function(){G(I.error)}})}function K(I){var D=new FileReader,G=P(D);return D.readAsArrayBuffer(I),G}function T(I){if(I.slice)return I.slice(0);var D=new Uint8Array(I.byteLength);return D.set(new Uint8Array(I)),D.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(I){var D;this._bodyInit=I,I?typeof I=="string"?this._bodyText=I:l&&Blob.prototype.isPrototypeOf(I)?this._bodyBlob=I:u&&FormData.prototype.isPrototypeOf(I)?this._bodyFormData=I:a&&URLSearchParams.prototype.isPrototypeOf(I)?this._bodyText=I.toString():d&&l&&(D=I)&&DataView.prototype.isPrototypeOf(D)?(this._bodyArrayBuffer=T(I.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):d&&(ArrayBuffer.prototype.isPrototypeOf(I)||y(I))?this._bodyArrayBuffer=T(I):this._bodyText=I=Object.prototype.toString.call(I):this._bodyText="",this.headers.get("content-type")||(typeof I=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a&&URLSearchParams.prototype.isPrototypeOf(I)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l&&(this.blob=function(){var I=E(this);if(I)return I;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?E(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(K)}),this.text=function(){var I=E(this);if(I)return I;if(this._bodyBlob)return function(D){var G=new FileReader,Ie=P(G);return G.readAsText(D),Ie}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(D){for(var G=new Uint8Array(D),Ie=new Array(G.length),ue=0;ue<G.length;ue++)Ie[ue]=String.fromCharCode(G[ue]);return Ie.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},u&&(this.formData=function(){return this.text().then(W)}),this.json=function(){return this.text().then(JSON.parse)},this}v.prototype.append=function(I,D){I=S(I),D=p(D);var G=this.map[I];this.map[I]=G?G+", "+D:D},v.prototype.delete=function(I){delete this.map[S(I)]},v.prototype.get=function(I){return I=S(I),this.has(I)?this.map[I]:null},v.prototype.has=function(I){return this.map.hasOwnProperty(S(I))},v.prototype.set=function(I,D){this.map[S(I)]=p(D)},v.prototype.forEach=function(I,D){for(var G in this.map)this.map.hasOwnProperty(G)&&I.call(D,this.map[G],G,this)},v.prototype.keys=function(){var I=[];return this.forEach(function(D,G){I.push(G)}),w(I)},v.prototype.values=function(){var I=[];return this.forEach(function(D){I.push(D)}),w(I)},v.prototype.entries=function(){var I=[];return this.forEach(function(D,G){I.push([G,D])}),w(I)},c&&(v.prototype[Symbol.iterator]=v.prototype.entries);var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function R(I,D){var G,Ie,ue=(D=D||{}).body;if(I instanceof R){if(I.bodyUsed)throw new TypeError("Already read");this.url=I.url,this.credentials=I.credentials,D.headers||(this.headers=new v(I.headers)),this.method=I.method,this.mode=I.mode,this.signal=I.signal,ue||I._bodyInit==null||(ue=I._bodyInit,I.bodyUsed=!0)}else this.url=String(I);if(this.credentials=D.credentials||this.credentials||"same-origin",!D.headers&&this.headers||(this.headers=new v(D.headers)),this.method=(G=D.method||this.method||"GET",Ie=G.toUpperCase(),_.indexOf(Ie)>-1?Ie:G),this.mode=D.mode||this.mode||null,this.signal=D.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ue)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ue)}function W(I){var D=new FormData;return I.trim().split("&").forEach(function(G){if(G){var Ie=G.split("="),ue=Ie.shift().replace(/\+/g," "),Pe=Ie.join("=").replace(/\+/g," ");D.append(decodeURIComponent(ue),decodeURIComponent(Pe))}}),D}function B(I,D){D||(D={}),this.type="default",this.status=D.status===void 0?200:D.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in D?D.statusText:"OK",this.headers=new v(D.headers),this.url=D.url||"",this._initBody(I)}R.prototype.clone=function(){return new R(this,{body:this._bodyInit})},b.call(R.prototype),b.call(B.prototype),B.prototype.clone=function(){return new B(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new v(this.headers),url:this.url})},B.error=function(){var I=new B(null,{status:0,statusText:""});return I.type="error",I};var V=[301,302,303,307,308];B.redirect=function(I,D){if(V.indexOf(D)===-1)throw new RangeError("Invalid status code");return new B(null,{status:D,headers:{location:I}})},o.DOMException=s.DOMException;try{new o.DOMException}catch{o.DOMException=function(D,G){this.message=D,this.name=G;var Ie=Error(D);this.stack=Ie.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function q(I,D){return new Promise(function(G,Ie){var ue=new R(I,D);if(ue.signal&&ue.signal.aborted)return Ie(new o.DOMException("Aborted","AbortError"));var Pe=new XMLHttpRequest;function Gt(){Pe.abort()}Pe.onload=function(){var yn,ke,Ke={status:Pe.status,statusText:Pe.statusText,headers:(yn=Pe.getAllResponseHeaders()||"",ke=new v,yn.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(cn){var Ht=cn.split(":"),wt=Ht.shift().trim();if(wt){var Ar=Ht.join(":").trim();ke.append(wt,Ar)}}),ke)};Ke.url="responseURL"in Pe?Pe.responseURL:Ke.headers.get("X-Request-URL");var Zt="response"in Pe?Pe.response:Pe.responseText;G(new B(Zt,Ke))},Pe.onerror=function(){Ie(new TypeError("Network request failed"))},Pe.ontimeout=function(){Ie(new TypeError("Network request failed"))},Pe.onabort=function(){Ie(new o.DOMException("Aborted","AbortError"))},Pe.open(ue.method,ue.url,!0),ue.credentials==="include"?Pe.withCredentials=!0:ue.credentials==="omit"&&(Pe.withCredentials=!1),"responseType"in Pe&&l&&(Pe.responseType="blob"),ue.headers.forEach(function(yn,ke){Pe.setRequestHeader(ke,yn)}),ue.signal&&(ue.signal.addEventListener("abort",Gt),Pe.onreadystatechange=function(){Pe.readyState===4&&ue.signal.removeEventListener("abort",Gt)}),Pe.send(ue._bodyInit===void 0?null:ue._bodyInit)})}q.polyfill=!0,s.fetch||(s.fetch=q,s.Headers=v,s.Request=R,s.Response=B),o.Headers=v,o.Request=R,o.Response=B,o.fetch=q,Object.defineProperty(o,"__esModule",{value:!0})})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=n;(e=i.fetch).default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,r.exports=e})(Md,Md.exports);var W_=S_(Md.exports);async function gp(r,e){const t=await r.getAccountInfo(e);if(t===null)throw new Error("program account not found");const{program:n}=Ld(t.data),i=await r.getAccountInfo(n.programdataAddress);if(i===null)throw new Error("program data account not found");const{programData:s}=Ld(i.data);return s}const V_=Te.rustEnum([Te.struct([],"uninitialized"),Te.struct([Te.option(Te.publicKey(),"authorityAddress")],"buffer"),Te.struct([Te.publicKey("programdataAddress")],"program"),Te.struct([Te.u64("slot"),Te.option(Te.publicKey(),"upgradeAuthorityAddress")],"programData")],void 0,Te.u32());function Ld(r){return V_.decode(r)}var U_=Object.freeze({__proto__:null,verifiedBuild:async function(r,e,t=5){const n=`https://anchor.projectserum.com/api/v0/program/${e.toString()}/latest?limit=${t}`,[i,s]=await Promise.all([gp(r,e),W_(n)]),o=(await s.json()).filter(c=>!c.aborted&&c.state==="Built"&&c.verified==="Verified");if(o.length===0)return null;const a=o[0];return i.slot.toNumber()!==a.verified_slot?null:a},fetchData:gp,decodeUpgradeableLoaderState:Ld}),F_=Object.freeze({__proto__:null,sha256:N_,rpc:l_,publicKey:D_,bytes:i_,token:z_,features:p_,registry:U_});const j_=Te.struct([Te.publicKey("authority"),Te.vecU8("data")]);function Da(r,e){var t,n;let i={};const s=r.args?r.args.length:0;if(e.length>s){if(e.length!==s+1)throw new Error(`provided too many arguments ${e} to instruction ${r==null?void 0:r.name} expecting: ${(n=(t=r.args)===null||t===void 0?void 0:t.map(o=>o.name))!==null&&n!==void 0?n:[]}`);i=e.pop()}return[e,i]}class io{static build(e,t,n){if(e.name==="_inner")throw new ma("the _inner name is reserved");const i=(...s)=>{const[o,a]=Da(e,[...s]);Mu(e.accounts,a.accounts);const c=i.accounts(a.accounts);return a.remainingAccounts!==void 0&&c.push(...a.remainingAccounts),Lu("debug-logs")&&console.log("Outgoing account metas:",c),new et({keys:c,programId:n,data:t(e.name,Pg(e,...o))})};return i.accounts=s=>io.accountsArray(s,e.accounts,e.name),i}static accountsArray(e,t,n){return e?t.map(i=>{if(("accounts"in i?i.accounts:void 0)!==void 0){const s=e[i.name];return io.accountsArray(s,i.accounts,n).flat()}{const s=i;let o;try{o=hr(e[i.name])}catch{throw new Error(`Wrong input type for account "${i.name}" in the instruction accounts object${n!==void 0?' for instruction "'+n+'"':""}. Expected PublicKey or string.`)}return{pubkey:o,isWritable:s.isMut,isSigner:s.isSigner}}}).flat():[]}}class Yg{static build(e,t,n,i){return async(...s)=>{var o;const a=t(...s),[,c]=Da(e,[...s]);if(i.sendAndConfirm===void 0)throw new Error("This function requires 'Provider.sendAndConfirm' to be implemented.");try{return await i.sendAndConfirm(a,(o=c.signers)!==null&&o!==void 0?o:[],c.options)}catch(l){throw Nf(l,n)}}}}class Jg{static build(e,t){return(...n)=>{var i,s,o;const[,a]=Da(e,[...n]),c=new je;if(a.preInstructions&&a.instructions)throw new Error("instructions is deprecated, use preInstructions");return(i=a.preInstructions)===null||i===void 0||i.forEach(l=>c.add(l)),(s=a.instructions)===null||s===void 0||s.forEach(l=>c.add(l)),c.add(t(...n)),(o=a.postInstructions)===null||o===void 0||o.forEach(l=>c.add(l)),c}}}class Qg{constructor(e,t,n=ro(),i=new Nu(e)){this.provider=n,this.coder=i,this._idl=e,this._programId=t,this._address=Zl(t),this._sub=null;const[s,o,a]=(()=>{var c;let l={},u={},d={};return(c=e.state)===null||c===void 0||c.methods.forEach(m=>{const y=io.build(m,(v,E)=>i.instruction.encodeState(v,E),t);y.accounts=v=>function(P,K,T,b){if(T.name==="new"){const[_]=Vf([],P);if(K.wallet===void 0)throw new Error("This function requires the Provider interface implementor to have a 'wallet' field.");return[{pubkey:K.wallet.publicKey,isWritable:!1,isSigner:!0},{pubkey:Zl(P),isWritable:!0,isSigner:!1},{pubkey:_,isWritable:!1,isSigner:!1},{pubkey:Lt.programId,isWritable:!1,isSigner:!1},{pubkey:P,isWritable:!1,isSigner:!1}]}return Mu(T.accounts,b),[{pubkey:Zl(P),isWritable:!0,isSigner:!1}]}(t,n,m,v).concat(io.accountsArray(v,m.accounts,m.name));const S=Jg.build(m,y),p=Yg.build(m,S,Mf(e),n),w=rn(m.name);l[w]=y,u[w]=S,d[w]=p}),[l,u,d]})();this.instruction=s,this.transaction=o,this.rpc=a}get programId(){return this._programId}async fetch(){const e=this.address(),t=await this.provider.connection.getAccountInfo(e);if(t===null)throw new Error(`Account does not exist ${e.toString()}`);const n=this._idl.state;if(!n)throw new Error("State is not specified in IDL.");if((await Df(n.struct.name)).compare(t.data.slice(0,8)))throw new Error("Invalid account discriminator");return this.coder.state.decode(t.data)}address(){return this._address}subscribe(e){if(this._sub!==null)return this._sub.ee;const t=new Ky,n=this.provider.connection.onAccountChange(this.address(),i=>{const s=this.coder.state.decode(i.data);t.emit("change",s)},e);return this._sub={ee:t,listener:n},t}unsubscribe(){this._sub!==null&&this.provider.connection.removeAccountChangeListener(this._sub.listener).then(async()=>{this._sub=null}).catch(console.error)}}function Zl(r){let[e]=Vf([],r);return qg(e,"unversioned",r)}class Xg{constructor(e,t,n,i,s){this._idlAccount=t,this._programId=n,this._provider=i??ro(),this._coder=s??new Nu(e),this._size=this._coder.accounts.size(t)}get size(){return this._size}get programId(){return this._programId}get provider(){return this._provider}get coder(){return this._coder}async fetchNullable(e,t){const n=await this.getAccountInfo(e,t);return n===null?null:this._coder.accounts.decode(this._idlAccount.name,n.data)}async fetch(e,t){const n=await this.fetchNullable(e,t);if(n===null)throw new Error(`Account does not exist ${e.toString()}`);return n}async fetchMultiple(e,t){return(await Bg(this._provider.connection,e.map(n=>hr(n)),t)).map(n=>n==null?null:this._coder.accounts.decode(this._idlAccount.name,n==null?void 0:n.account.data))}async all(e){return(await this._provider.connection.getProgramAccounts(this._programId,{commitment:this._provider.connection.commitment,filters:[{memcmp:this.coder.accounts.memcmp(this._idlAccount.name,e instanceof we.Buffer?e:void 0)},...Array.isArray(e)?e:[]]})).map(({pubkey:t,account:n})=>({publicKey:t,account:this._coder.accounts.decode(this._idlAccount.name,n.data)}))}subscribe(e,t){const n=Go.get(e.toString());if(n)return n.ee;const i=new Ky;e=hr(e);const s=this._provider.connection.onAccountChange(e,o=>{const a=this._coder.accounts.decode(this._idlAccount.name,o.data);i.emit("change",a)},t);return Go.set(e.toString(),{ee:i,listener:s}),i}async unsubscribe(e){let t=Go.get(e.toString());t?Go&&await this._provider.connection.removeAccountChangeListener(t.listener).then(()=>{Go.delete(e.toString())}).catch(console.error):console.warn("Address is not subscribed")}async createInstruction(e,t){const n=this.size;if(this._provider.wallet===void 0)throw new Error("This function requires the Provider interface implementor to have a 'wallet' field.");return Lt.createAccount({fromPubkey:this._provider.wallet.publicKey,newAccountPubkey:e.publicKey,space:t??n,lamports:await this._provider.connection.getMinimumBalanceForRentExemption(t??n),programId:this._programId})}async associated(...e){const t=await this.associatedAddress(...e);return await this.fetch(t)}async associatedAddress(...e){return await Hg(this._programId,...e)}async getAccountInfo(e,t){return await this._provider.connection.getAccountInfo(hr(e),t)}}const Go=new Map,q_=13,G_=14;class Zg{constructor(e,t,n){this._programId=e,this._provider=t,this._eventParser=new Uf(e,n),this._eventCallbacks=new Map,this._eventListeners=new Map,this._listenerIdCount=0}addEventListener(e,t){var n;let i=this._listenerIdCount;return this._listenerIdCount+=1,e in this._eventCallbacks||this._eventListeners.set(e,[]),this._eventListeners.set(e,((n=this._eventListeners.get(e))!==null&&n!==void 0?n:[]).concat(i)),this._eventCallbacks.set(i,[e,t]),this._onLogsSubscriptionId!==void 0||(this._onLogsSubscriptionId=this._provider.connection.onLogs(this._programId,(s,o)=>{s.err||this._eventParser.parseLogs(s.logs,a=>{const c=this._eventListeners.get(a.name);c&&c.forEach(l=>{const u=this._eventCallbacks.get(l);if(u){const[,d]=u;d(a.data,o.slot)}})})})),i}async removeEventListener(e){const t=this._eventCallbacks.get(e);if(!t)throw new Error(`Event listener ${e} doesn't exist!`);const[n]=t;let i=this._eventListeners.get(n);if(!i)throw new Error(`Event listeners don't exist for ${n}!`);this._eventCallbacks.delete(e),i=i.filter(s=>s!==e),i.length===0&&this._eventListeners.delete(n),this._eventCallbacks.size==0&&(zc.exports.ok(this._eventListeners.size===0),this._onLogsSubscriptionId!==void 0&&(await this._provider.connection.removeOnLogsListener(this._onLogsSubscriptionId),this._onLogsSubscriptionId=void 0))}}class Uf{constructor(e,t){this.coder=t,this.programId=e}parseLogs(e,t){const n=new Y_(e),i=new H_;let s=n.next();for(;s!==null;){let[o,a,c]=this.handleLog(i,s);o&&t(o),a&&i.push(a),c&&i.pop(),s=n.next()}}handleLog(e,t){return e.stack.length>0&&e.program()===this.programId.toString()?this.handleProgramLog(t):[null,...this.handleSystemLog(t)]}handleProgramLog(e){if(e.startsWith("Program log: ")||e.startsWith("Program data: ")){const t=e.startsWith("Program log: ")?e.slice(q_):e.slice(G_);return[this.coder.events.decode(t),null,!1]}return[null,...this.handleSystemLog(e)]}handleSystemLog(e){const t=e.split(":")[0];return t.match(/^Program (.*) success/g)!==null?[null,!0]:t.startsWith(`Program ${this.programId.toString()} invoke`)?[this.programId.toString(),!1]:t.includes("invoke")?["cpi",!1]:[null,!1]}}class H_{constructor(){this.stack=[]}program(){return zc.exports.ok(this.stack.length>0),this.stack[this.stack.length-1]}push(e){this.stack.push(e)}pop(){zc.exports.ok(this.stack.length>0),this.stack.pop()}}class Y_{constructor(e){this.logs=e}next(){if(this.logs.length===0)return null;let e=this.logs[0];return this.logs=this.logs.slice(1),e}}const J_=new Y("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");function em(){return new jg(tm)}const tm={version:"0.1.0",name:"spl_token",instructions:[{name:"initializeMint",accounts:[{name:"mint",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"decimals",type:"u8"},{name:"mintAuthority",type:"publicKey"},{name:"freezeAuthority",type:{coption:"publicKey"}}]},{name:"initializeAccount",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[]},{name:"initializeMultisig",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"m",type:"u8"}]},{name:"transfer",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"destination",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"}]},{name:"approve",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"delegate",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"}]},{name:"revoke",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[]},{name:"setAuthority",accounts:[{name:"mint",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"authorityType",type:"u8"},{name:"newAuthority",type:{coption:"publicKey"}}]},{name:"mintTo",accounts:[{name:"mint",isMut:!0,isSigner:!1},{name:"to",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"}]},{name:"burn",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"mint",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"}]},{name:"closeAccount",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"destination",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!1}],args:[]},{name:"freezeAccount",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[]},{name:"thawAccount",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[]},{name:"transferChecked",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"destination",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"},{name:"decimals",type:"u8"}]},{name:"approveChecked",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"delegate",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"},{name:"decimals",type:"u8"}]},{name:"mintToChecked",accounts:[{name:"mint",isMut:!0,isSigner:!1},{name:"to",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"},{name:"decimals",type:"u8"}]},{name:"burnChecked",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"mint",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"},{name:"decimals",type:"u8"}]},{name:"initializeAccount2",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"authority",type:"publicKey"}]},{name:"syncNative",accounts:[{name:"account",isMut:!0,isSigner:!1}],args:[]},{name:"initializeAccount3",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1}],args:[{name:"authority",type:"publicKey"}]},{name:"initializeMultisig2",accounts:[{name:"account",isMut:!0,isSigner:!1}],args:[{name:"m",type:"u8"}]},{name:"initializeMint2",accounts:[{name:"mint",isMut:!0,isSigner:!1}],args:[{name:"decimals",type:"u8"},{name:"mintAuthority",type:"publicKey"},{name:"freezeAuthority",type:{coption:"publicKey"}}]}],accounts:[{name:"mint",type:{kind:"struct",fields:[{name:"mintAuthority",type:{coption:"publicKey"}},{name:"supply",type:"u64"},{name:"decimals",type:"u8"},{name:"isInitialized",type:"bool"},{name:"freezeAuthority",type:{coption:"publicKey"}}]}},{name:"token",type:{kind:"struct",fields:[{name:"mint",type:"publicKey"},{name:"authority",type:"publicKey"},{name:"amount",type:"u64"},{name:"delegate",type:{coption:"publicKey"}},{name:"state",type:"u8"},{name:"isNative",type:{coption:"u64"}},{name:"delegatedAmount",type:"u64"},{name:"closeAuthority",type:{coption:"publicKey"}}]}}]};class wa{constructor(e,t,n,i,s,o){this._args=e,this._accounts=t,this._provider=n,this._programId=i,this._idlIx=s,this._accountStore=new Q_(n,o)}async resolve(){for(let e=0;e<this._idlIx.accounts.length;e+=1){const t=this._idlIx.accounts[e],n=rn(t.name);if(t.pda&&t.pda.seeds.length>0&&!this._accounts[n])await this.autoPopulatePda(t);else if(!t.isSigner||this._accounts[n])Reflect.has(wa.CONST_ACCOUNTS,n)&&!this._accounts[n]&&(this._accounts[n]=wa.CONST_ACCOUNTS[n]);else{if(this._provider.wallet===void 0)throw new Error("This function requires the Provider interface implementor to have a 'wallet' field.");this._accounts[n]=this._provider.wallet.publicKey}}}async autoPopulatePda(e){if(!e.pda||!e.pda.seeds)throw new Error("Must have seeds");const t=await Promise.all(e.pda.seeds.map(s=>this.toBuffer(s))),n=await this.parseProgramId(e),[i]=await Y.findProgramAddress(t,n);this._accounts[rn(e.name)]=i}async parseProgramId(e){var t;if(!(!((t=e.pda)===null||t===void 0)&&t.programId))return this._programId;switch(e.pda.programId.kind){case"const":return new Y(this.toBufferConst(e.pda.programId.value));case"arg":return this.argValue(e.pda.programId);case"account":return await this.accountValue(e.pda.programId);default:throw new Error(`Unexpected program seed kind: ${e.pda.programId.kind}`)}}async toBuffer(e){switch(e.kind){case"const":return this.toBufferConst(e);case"arg":return await this.toBufferArg(e);case"account":return await this.toBufferAccount(e);default:throw new Error(`Unexpected seed kind: ${e.kind}`)}}toBufferConst(e){return this.toBufferValue(e.type,e.value)}async toBufferArg(e){const t=this.argValue(e);return this.toBufferValue(e.type,t)}argValue(e){const t=rn(e.path.split(".")[0]),n=this._idlIx.args.findIndex(i=>i.name===t);if(n===-1)throw new Error(`Unable to find argument for seed: ${t}`);return this._args[n]}async toBufferAccount(e){const t=await this.accountValue(e);return this.toBufferValue(e.type,t)}async accountValue(e){const t=e.path.split("."),n=t[0],i=this._accounts[rn(n)];if(t.length===1)return i;const s=await this._accountStore.fetchAccount(e.account,i);return this.parseAccountValue(s,t.slice(1))}parseAccountValue(e,t){let n;for(;t.length>0;)n=e[rn(t[0])],t=t.slice(1);return n}toBufferValue(e,t){switch(e){case"u8":return we.Buffer.from([t]);case"u16":let n=we.Buffer.alloc(2);return n.writeUInt16LE(t),n;case"u32":let i=we.Buffer.alloc(4);return i.writeUInt32LE(t),i;case"u64":let s=we.Buffer.alloc(8);return s.writeBigUInt64LE(BigInt(t)),s;case"string":return we.Buffer.from(Ag(t));case"publicKey":return t.toBuffer();default:if(e.array)return we.Buffer.from(t);throw new Error(`Unexpected seed type: ${e}`)}}}wa.CONST_ACCOUNTS={systemProgram:Lt.programId,tokenProgram:xd,associatedTokenProgram:Cd,rent:Zi};class Q_{constructor(e,t){this._provider=e,this._accounts=t,this._cache=new Map}async fetchAccount(e,t){const n=t.toString();if(!this._cache.has(n))if(e==="TokenAccount"){const i=await this._provider.connection.getAccountInfo(t);if(i===null)throw new Error(`invalid account info for ${n}`);const s=em().accounts.decode("token",i.data);this._cache.set(n,s)}else{const i=this._accounts[rn(e)].fetch(t);this._cache.set(n,i)}return this._cache.get(n)}}class nm{static build(e,t,n,i,s,o,a,c,l){return(...u)=>new X_(u,i,s,o,a,c,e,t,n,l)}}class X_{constructor(e,t,n,i,s,o,a,c,l,u){this._args=e,this._ixFn=t,this._txFn=n,this._rpcFn=i,this._simulateFn=s,this._viewFn=o,this._accounts={},this._remainingAccounts=[],this._signers=[],this._preInstructions=[],this._postInstructions=[],this._accountsResolver=new wa(e,this._accounts,a,c,l,u)}async pubkeys(){return await this._accountsResolver.resolve(),this._accounts}accounts(e){return Object.assign(this._accounts,e),this}signers(e){return this._signers=this._signers.concat(e),this}remainingAccounts(e){return this._remainingAccounts=this._remainingAccounts.concat(e),this}preInstructions(e){return this._preInstructions=this._preInstructions.concat(e),this}postInstructions(e){return this._postInstructions=this._postInstructions.concat(e),this}async rpc(e){return await this._accountsResolver.resolve(),this._rpcFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async view(e){if(await this._accountsResolver.resolve(),!this._viewFn)throw new Error("Method does not support views");return this._viewFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async simulate(e){return await this._accountsResolver.resolve(),this._simulateFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async instruction(){return await this._accountsResolver.resolve(),this._ixFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions})}async transaction(){return await this._accountsResolver.resolve(),this._txFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions})}}class ka{constructor(e,t,n,i){t=hr(t),n||(n=ro()),this._idl=e,this._provider=n,this._programId=t,this._coder=i??new Nu(e),this._events=new Zg(this._programId,n,this._coder);const[s,o,a,c,l,u,d,m]=class{static build(y,S,p,w){const v={},E={},P={},K={},T={},b={},_=Mf(y),R=y.accounts?class{static build(B,V,q,I){var D;const G={};return(D=B.accounts)===null||D===void 0||D.forEach(Ie=>{const ue=rn(Ie.name);G[ue]=new Xg(B,Ie,q,I,V)}),G}}.build(y,S,p,w):{},W=class{static build(B,V,q,I){if(B.state!==void 0)return new Qg(B,q,I,V)}}.build(y,S,p,w);return y.instructions.forEach(B=>{const V=io.build(B,(Pe,Gt)=>S.instruction.encode(Pe,Gt),p),q=Jg.build(B,V),I=Yg.build(B,q,_,w),D=class{static build(Pe,Gt,yn,ke,Ke,Zt,cn){return async(...Ht)=>{var wt;const Ar=Gt(...Ht),[,gn]=Da(Pe,[...Ht]);let Ir;if(ke.simulate===void 0)throw new Error("This function requires 'Provider.simulate' to be implemented.");try{Ir=await ke.simulate(Ar,gn.signers,(wt=gn.options)===null||wt===void 0?void 0:wt.commitment)}catch(si){throw Nf(si,yn)}if(Ir===void 0)throw new Error("Unable to simulate transaction");const ii=Ir.logs;if(!ii)throw new Error("Simulated logs not found");const Li=[];return cn.events&&new Uf(Zt,Ke).parseLogs(ii,si=>{Li.push(si)}),{events:Li,raw:ii}}}}.build(B,q,_,w,S,p,y),G=class{static build(Pe,Gt,yn,ke){const Ke=Gt.accounts.find(cn=>cn.isMut),Zt=!!Gt.returns;if(!Ke&&Zt)return async(...cn)=>{var Ht,wt;let Ar=await yn(...cn);const gn=`Program return: ${Pe} `;let Ir=Ar.raw.find(si=>si.startsWith(gn));if(!Ir)throw new Error("View expected return log");let ii=Eg(Ir.slice(gn.length)),Li=Gt.returns;if(!Li)throw new Error("View expected return type");return Un.fieldLayout({type:Li},Array.from([...(Ht=ke.accounts)!==null&&Ht!==void 0?Ht:[],...(wt=ke.types)!==null&&wt!==void 0?wt:[]])).decode(ii)}}}.build(p,B,D,y),Ie=nm.build(w,p,B,V,q,I,D,G,R),ue=rn(B.name);E[ue]=V,P[ue]=q,v[ue]=I,K[ue]=D,T[ue]=Ie,G&&(b[ue]=G)}),[v,E,P,R,K,T,W,b]}}.build(e,this._coder,t,n);this.rpc=s,this.instruction=o,this.transaction=a,this.account=c,this.simulate=l,this.methods=u,this.state=d,this.views=m}get programId(){return this._programId}get idl(){return this._idl}get coder(){return this._coder}get provider(){return this._provider}static async at(e,t){const n=hr(e),i=await ka.fetchIdl(n,t);if(!i)throw new Error(`IDL not found for program: ${e.toString()}`);return new ka(i,n,t)}static async fetchIdl(e,t){t=t??ro();const n=hr(e),i=await async function(l){const u=(await Y.findProgramAddress([],l))[0];return await Y.createWithSeed(u,"anchor:idl",l)}(n),s=await t.connection.getAccountInfo(i);if(!s)return null;let o=(a=s.data.slice(8),j_.decode(a));var a;const c=lk(o.data);return JSON.parse(_g(c))}addEventListener(e,t){return this._events.addEventListener(e,t)}async removeEventListener(e){return await this._events.removeEventListener(e)}}class Z_{static token(e){return function(t){return new ka(tm,J_,t,em())}(e)}}var eA=Object.freeze(Object.defineProperty({__proto__:null,web3:Sg,ACCOUNT_DISCRIMINATOR_SIZE:w_,AccountClient:Xg,AnchorError:Hs,AnchorProvider:Mg,BorshAccountsCoder:Ys,BorshCoder:Nu,BorshEventCoder:$g,BorshInstructionCoder:Ku,BorshStateCoder:zg,EventManager:Zg,EventParser:Uf,IdlError:ma,LangErrorCode:be,LangErrorMessage:Ng,MethodsBuilderFactory:nm,Program:ka,ProgramError:ba,ProgramErrorStack:Ro,Spl:Z_,SplTokenCoder:jg,StateClient:Qg,eventDiscriminator:Dg,getProvider:ro,parseIdlErrors:Mf,setProvider:f_,splitArgsAndCtx:Da,stateDiscriminator:Df,toInstruction:Pg,translateAddress:hr,translateError:Nf,utils:F_,validateAccounts:Mu,BN:kn},Symbol.toStringTag,{value:"Module"})),ot=vo(eA),za={};Object.defineProperty(za,"__esModule",{value:!0});za.stakingIdl=void 0;za.stakingIdl={version:"0.1.0",name:"atlas_staking",instructions:[{name:"cancelUnstake",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",path:"user"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}}],args:[]},{name:"createStakingAccount",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",path:"user"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"harvest",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"rewardMint",isMut:!1,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",account:"StakingAccount",path:"staking_account.owner"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"userRewardAccount",isMut:!0,isSigner:!1},{name:"rewardAta",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"initializeStaking",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"stakingVarsAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-vars"}]}},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"registerStake",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"stakingVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-vars"}]}},{name:"stakeMint",isMut:!1,isSigner:!1},{name:"rewardMint",isMut:!1,isSigner:!1},{name:"registeredStake",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",path:"authority"},{kind:"account",type:"publicKey",account:"Mint",path:"stake_mint"},{kind:"account",type:"publicKey",account:"Mint",path:"reward_mint"}]}},{name:"rewardAta",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"rewardMultiplier",type:"u64"},{name:"cooldownPeriod",type:"u64"}]},{name:"settle",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",path:"authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",account:"StakingAccount",path:"staking_account.owner"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}}],args:[{name:"updatedStakingPeriod",type:"u16"}]},{name:"stakeTokens",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"stakeMint",isMut:!1,isSigner:!1},{name:"tokenSource",isMut:!0,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",path:"user"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"tokenEscrow",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"stakeAmount",type:"u64"}]},{name:"unstakeTokens",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"rewardMint",isMut:!1,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",account:"StakingAccount",path:"staking_account.owner"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"userRewardAccount",isMut:!0,isSigner:!1},{name:"rewardAta",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"updateCooldownPeriod",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",path:"authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}}],args:[{name:"cooldownPeriod",type:"u64"}]},{name:"updateRewardMultiplier",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",path:"authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}}],args:[{name:"rewardMultiplier",type:"u64"},{name:"newStakingPeriod",type:"u16"}]},{name:"withdrawTokens",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"stakeMint",isMut:!1,isSigner:!1},{name:"tokenSource",isMut:!0,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",account:"StakingAccount",path:"staking_account.owner"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"tokenEscrow",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[]}],accounts:[{name:"RegisteredStake",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"stakeMint",type:"publicKey"},{name:"rewardMint",type:"publicKey"},{name:"currentPeriod",type:"u16"},{name:"rewardMultiplier",type:"u64"},{name:"cooldownPeriod",type:"u64"},{name:"bump",type:"u8"}]}},{name:"StakingAccount",type:{kind:"struct",fields:[{name:"owner",type:"publicKey"},{name:"registeredStake",type:"publicKey"},{name:"stakeMint",type:"publicKey"},{name:"totalStake",type:"u64"},{name:"activeStake",type:"u64"},{name:"pendingRewards",type:"u64"},{name:"paidRewards",type:"u64"},{name:"currentPeriod",type:"u16"},{name:"stakedAtTs",type:"i64"},{name:"lastPendingRewardCalcTs",type:"i64"},{name:"lastHarvestTs",type:"i64"},{name:"unstakedTs",type:"i64"},{name:"bump",type:"u8"}]}},{name:"StakingVars",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"bump",type:"u8"}]}}],errors:[{code:6e3,name:"InvalidMint",msg:"Invalid Token Mint"},{code:6001,name:"InvalidOwner",msg:"Account now owned by user"},{code:6002,name:"InsufficientFunds",msg:"Insufficient token balance"},{code:6003,name:"InvalidAuthority",msg:"Invalid authority for this account"},{code:6004,name:"InvalidDepositQty",msg:"Invalid deposit quantity"},{code:6005,name:"NumericalOverflowError",msg:"Numerical overflow error"},{code:6006,name:"StakeOnCooldown",msg:"Cannot stake while account is on cooldown"},{code:6007,name:"InvalidEscrowAuth",msg:"Invalid escrow authority"},{code:6008,name:"WithdrawOnCooldown",msg:"Cannot withdraw before cooldown period has elapsed"},{code:6009,name:"InvalidPeriod",msg:"Staking account must be in the same period as the Registered Stake"},{code:6010,name:"NotOnCooldown",msg:"Staking account is not on cooldown"}],metadata:{}};Object.defineProperty(Qi,"__esModule",{value:!0});Qi.getStakingProgram=Qi.getStakingIdl=void 0;const mp=ot,tA=za;function rm(r){const e=tA.stakingIdl;return e.metadata.address=r.toBase58(),e}Qi.getStakingIdl=rm;function nA({connection:r,programId:e}){const t=rm(e),n=new mp.AnchorProvider(r,null,null);return new mp.Program(t,e,n)}Qi.getStakingProgram=nA;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Qi,r)})(Kn);var rA=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Eu,"__esModule",{value:!0});Eu.cancelUnstakeInstruction=void 0;const iA=Kn;function sA({connection:r,user:e,registeredStake:t,programId:n}){return rA(this,void 0,void 0,function*(){const i=(0,iA.getStakingProgram)({connection:r,programId:n}),s={instructions:[],signers:[]},o=yield i.methods.cancelUnstake().accounts({user:e,registeredStake:t}).instruction();return s.instructions.push(o),s})}Eu.cancelUnstakeInstruction=sA;var zu={},oA=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(zu,"__esModule",{value:!0});zu.createStakingAccountInstruction=void 0;const aA=Kn;function cA({connection:r,user:e,registeredStake:t,programId:n}){return oA(this,void 0,void 0,function*(){const i=(0,aA.getStakingProgram)({connection:r,programId:n}),s={instructions:[],signers:[]},o=yield i.methods.createStakingAccount().accounts({user:e,registeredStake:t}).instruction();return s.instructions.push(o),s})}zu.createStakingAccountInstruction=cA;var Wu={},gs={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.associatedAddress=r.ASSOCIATED_PROGRAM_ID=r.TOKEN_PROGRAM_ID=void 0;const e=vg;r.TOKEN_PROGRAM_ID=new e.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),r.ASSOCIATED_PROGRAM_ID=new e.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");async function t({mint:n,owner:i}){return(await e.PublicKey.findProgramAddress([i.toBuffer(),r.TOKEN_PROGRAM_ID.toBuffer(),n.toBuffer()],r.ASSOCIATED_PROGRAM_ID))[0]}r.associatedAddress=t})(gs);var lr={},Wt={};class uA extends TypeError{constructor(e,t){let n;const{message:i,...s}=e,{path:o}=e,a=o.length===0?i:"At path: "+o.join(".")+" -- "+i;super(a),Object.assign(this,s),this.name=this.constructor.name,this.failures=()=>{var c;return(c=n)!=null?c:n=[e,...t()]}}}function lA(r){return yi(r)&&typeof r[Symbol.iterator]=="function"}function yi(r){return typeof r=="object"&&r!=null}function kr(r){return typeof r=="string"?JSON.stringify(r):""+r}function dA(r){const{done:e,value:t}=r.next();return e?void 0:t}function fA(r,e,t,n){if(r===!0)return;r===!1?r={}:typeof r=="string"&&(r={message:r});const{path:i,branch:s}=e,{type:o}=t,{refinement:a,message:c="Expected a value of type `"+o+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+kr(n)+"`"}=r;return{value:n,type:o,refinement:a,key:i[i.length-1],path:i,branch:s,...r,message:c}}function*bp(r,e,t,n){lA(r)||(r=[r]);for(const i of r){const s=fA(i,e,t,n);s&&(yield s)}}function*Ff(r,e,t={}){const{path:n=[],branch:i=[r],coerce:s=!1,mask:o=!1}=t,a={path:n,branch:i};if(s&&(r=e.coercer(r,a),o&&e.type!=="type"&&yi(e.schema)&&yi(r)&&!Array.isArray(r)))for(const l in r)e.schema[l]===void 0&&delete r[l];let c=!0;for(const l of e.validator(r,a))c=!1,yield[l,void 0];for(let[l,u,d]of e.entries(r,a)){const m=Ff(u,d,{path:l===void 0?n:[...n,l],branch:l===void 0?i:[...i,u],coerce:s,mask:o});for(const y of m)y[0]?(c=!1,yield[y[0],void 0]):s&&(u=y[1],l===void 0?r=u:r instanceof Map?r.set(l,u):r instanceof Set?r.add(u):yi(r)&&(r[l]=u))}if(c)for(const l of e.refiner(r,a))c=!1,yield[l,void 0];c&&(yield[void 0,r])}class Vr{constructor(e){const{type:t,schema:n,validator:i,refiner:s,coercer:o=c=>c,entries:a=function*(){}}=e;this.type=t,this.schema=n,this.entries=a,this.coercer=o,i?this.validator=(c,l)=>{const u=i(c,l);return bp(u,l,this,c)}:this.validator=()=>[],s?this.refiner=(c,l)=>{const u=s(c,l);return bp(u,l,this,c)}:this.refiner=()=>[]}assert(e){return im(e,this)}create(e){return ne(e,this)}is(e){return sm(e,this)}mask(e){return hA(e,this)}validate(e,t={}){return Wa(e,this,t)}}function im(r,e){const t=Wa(r,e);if(t[0])throw t[0]}function ne(r,e){const t=Wa(r,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function hA(r,e){const t=Wa(r,e,{coerce:!0,mask:!0});if(t[0])throw t[0];return t[1]}function sm(r,e){return!Wa(r,e)[0]}function Wa(r,e,t={}){const n=Ff(r,e,t),i=dA(n);if(i[0])return[new uA(i[0],function*(){for(const o of n)o[0]&&(yield o[0])}),void 0];{const s=i[1];return[void 0,s]}}function ms(r,e){return new Vr({type:r,schema:null,validator:e})}function om(){return ms("any",()=>!0)}function j(r){return new Vr({type:"array",schema:r,*entries(e){if(r&&Array.isArray(e))for(const[t,n]of e.entries())yield[t,n,r]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||"Expected an array value, but received: "+kr(e)}})}function $t(){return ms("boolean",r=>typeof r=="boolean")}function To(r){return ms("instance",e=>e instanceof r||"Expected a `"+r.name+"` instance, but received: "+kr(e))}function Ee(r){const e=kr(r),t=typeof r;return new Vr({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?r:null,validator(n){return n===r||"Expected the literal `"+e+"`, but received: "+kr(n)}})}function pA(){return ms("never",()=>!1)}function F(r){return new Vr({...r,validator:(e,t)=>e===null||r.validator(e,t),refiner:(e,t)=>e===null||r.refiner(e,t)})}function k(){return ms("number",r=>typeof r=="number"&&!isNaN(r)||"Expected a number, but received: "+kr(r))}function X(r){return new Vr({...r,validator:(e,t)=>e===void 0||r.validator(e,t),refiner:(e,t)=>e===void 0||r.refiner(e,t)})}function Vu(r,e){return new Vr({type:"record",schema:null,*entries(t){if(yi(t))for(const n in t){const i=t[n];yield[n,n,r],yield[n,i,e]}},validator(t){return yi(t)||"Expected an object, but received: "+kr(t)}})}function N(){return ms("string",r=>typeof r=="string"||"Expected a string, but received: "+kr(r))}function Oo(r){const e=pA();return new Vr({type:"tuple",schema:null,*entries(t){if(Array.isArray(t)){const n=Math.max(r.length,t.length);for(let i=0;i<n;i++)yield[i,t[i],r[i]||e]}},validator(t){return Array.isArray(t)||"Expected an array, but received: "+kr(t)}})}function O(r){const e=Object.keys(r);return new Vr({type:"type",schema:r,*entries(t){if(yi(t))for(const n of e)yield[n,t[n],r[n]]},validator(t){return yi(t)||"Expected an object, but received: "+kr(t)}})}function st(r){const e=r.map(t=>t.type).join(" | ");return new Vr({type:"union",schema:null,validator(t,n){const i=[];for(const s of r){const[...o]=Ff(t,s,n),[a]=o;if(a[0])for(const[c]of o)c&&i.push(c);else return[]}return["Expected the value to satisfy a union of `"+e+"`, but received: "+kr(t),...i]}})}function Ur(){return ms("unknown",()=>!0)}function Fr(r,e,t){return new Vr({...r,coercer:(n,i)=>sm(n,e)?r.coercer(t(n,i),i):r.coercer(n,i)})}const yA=fu.v4,gA=function(r,e,t,n){if(typeof r!="string")throw new TypeError(r+" must be a string");n=n||{};const i=typeof n.version=="number"?n.version:2;if(i!==1&&i!==2)throw new TypeError(i+" must be 1 or 2");const s={method:r};if(i===2&&(s.jsonrpc="2.0"),e){if(typeof e!="object"&&!Array.isArray(e))throw new TypeError(e+" must be an object, array or omitted");s.params=e}if(typeof t>"u"){const o=typeof n.generator=="function"?n.generator:function(){return yA()};s.id=o(s,n)}else i===2&&t===null?n.notificationIdNull&&(s.id=null):s.id=t;return s};var mA=gA;const bA=fu.v4,wA=mA,Sa=function(r,e){if(!(this instanceof Sa))return new Sa(r,e);e||(e={}),this.options={reviver:typeof e.reviver<"u"?e.reviver:null,replacer:typeof e.replacer<"u"?e.replacer:null,generator:typeof e.generator<"u"?e.generator:function(){return bA()},version:typeof e.version<"u"?e.version:2,notificationIdNull:typeof e.notificationIdNull=="boolean"?e.notificationIdNull:!1},this.callServer=r};var kA=Sa;Sa.prototype.request=function(r,e,t,n){const i=this;let s=null;const o=Array.isArray(r)&&typeof e=="function";if(this.options.version===1&&o)throw new TypeError("JSON-RPC 1.0 does not support batching");if(o||!o&&r&&typeof r=="object"&&typeof e=="function")n=e,s=r;else{typeof t=="function"&&(n=t,t=void 0);const l=typeof n=="function";try{s=wA(r,e,t,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(u){if(l)return n(u);throw u}if(!l)return s}let c;try{c=JSON.stringify(s,this.options.replacer)}catch(l){return n(l)}return this.callServer(c,function(l,u){i._parseResponse(l,u,n)}),s};Sa.prototype._parseResponse=function(r,e,t){if(r){t(r);return}if(!e)return t();let n;try{n=JSON.parse(e,this.options.reviver)}catch(i){return t(i)}if(t.length===3)if(Array.isArray(n)){const i=function(o){return typeof o.error<"u"},s=function(o){return!i(o)};return t(null,n.filter(i),n.filter(s))}else return t(null,n.error,n.result);t(null,n)};var am={};(function(r){var e=bu.exports;Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var t=e(By),n=e(xy.exports),i=e(Cy.exports),s=e(hu.exports),o=e(pu.exports),a=e(yu.exports),c=e(gu.exports),l=e(mu.exports),u=wu.exports;function d(p){var w=m();return function(){var E=(0,l.default)(p),P;if(w){var K=(0,l.default)(this).constructor;P=Reflect.construct(E,arguments,K)}else P=E.apply(this,arguments);return(0,c.default)(this,P)}}function m(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var y=function(p,w){var v={};for(var E in p)Object.prototype.hasOwnProperty.call(p,E)&&w.indexOf(E)<0&&(v[E]=p[E]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function")for(var P=0,E=Object.getOwnPropertySymbols(p);P<E.length;P++)w.indexOf(E[P])<0&&Object.prototype.propertyIsEnumerable.call(p,E[P])&&(v[E[P]]=p[E[P]]);return v},S=function(p){(0,a.default)(v,p);var w=d(v);function v(E){var P,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"ws://localhost:8080",T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},b=arguments.length>3?arguments[3]:void 0;(0,s.default)(this,v);var _=T.autoconnect,R=_===void 0?!0:_,W=T.reconnect,B=W===void 0?!0:W,V=T.reconnect_interval,q=V===void 0?1e3:V,I=T.max_reconnects,D=I===void 0?5:I,G=y(T,["autoconnect","reconnect","reconnect_interval","max_reconnects"]);return P=w.call(this),P.webSocketFactory=E,P.queue={},P.rpc_id=0,P.address=K,P.autoconnect=R,P.ready=!1,P.reconnect=B,P.reconnect_timer_id=void 0,P.reconnect_interval=q,P.max_reconnects=D,P.rest_options=G,P.current_reconnects=0,P.generate_request_id=b||function(){return++P.rpc_id},P.autoconnect&&P._connect(P.address,Object.assign({autoconnect:P.autoconnect,reconnect:P.reconnect,reconnect_interval:P.reconnect_interval,max_reconnects:P.max_reconnects},P.rest_options)),P}return(0,o.default)(v,[{key:"connect",value:function(){this.socket||this._connect(this.address,Object.assign({autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects},this.rest_options))}},{key:"call",value:function(P,K,T,b){var _=this;return!b&&(0,i.default)(T)==="object"&&(b=T,T=null),new Promise(function(R,W){if(!_.ready)return W(new Error("socket not ready"));var B=_.generate_request_id(P,K),V={jsonrpc:"2.0",method:P,params:K||null,id:B};_.socket.send(JSON.stringify(V),b,function(q){if(q)return W(q);_.queue[B]={promise:[R,W]},T&&(_.queue[B].timeout=setTimeout(function(){delete _.queue[B],W(new Error("reply timeout"))},T))})})}},{key:"login",value:function(){var E=(0,n.default)(t.default.mark(function K(T){var b;return t.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,this.call("rpc.login",T);case 2:if(b=R.sent,b){R.next=5;break}throw new Error("authentication failed");case 5:return R.abrupt("return",b);case 6:case"end":return R.stop()}},K,this)}));function P(K){return E.apply(this,arguments)}return P}()},{key:"listMethods",value:function(){var E=(0,n.default)(t.default.mark(function K(){return t.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.call("__listMethods");case 2:return b.abrupt("return",b.sent);case 3:case"end":return b.stop()}},K,this)}));function P(){return E.apply(this,arguments)}return P}()},{key:"notify",value:function(P,K){var T=this;return new Promise(function(b,_){if(!T.ready)return _(new Error("socket not ready"));var R={jsonrpc:"2.0",method:P,params:K||null};T.socket.send(JSON.stringify(R),function(W){if(W)return _(W);b()})})}},{key:"subscribe",value:function(){var E=(0,n.default)(t.default.mark(function K(T){var b;return t.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return typeof T=="string"&&(T=[T]),R.next=3,this.call("rpc.on",T);case 3:if(b=R.sent,!(typeof T=="string"&&b[T]!=="ok")){R.next=6;break}throw new Error("Failed subscribing to an event '"+T+"' with: "+b[T]);case 6:return R.abrupt("return",b);case 7:case"end":return R.stop()}},K,this)}));function P(K){return E.apply(this,arguments)}return P}()},{key:"unsubscribe",value:function(){var E=(0,n.default)(t.default.mark(function K(T){var b;return t.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return typeof T=="string"&&(T=[T]),R.next=3,this.call("rpc.off",T);case 3:if(b=R.sent,!(typeof T=="string"&&b[T]!=="ok")){R.next=6;break}throw new Error("Failed unsubscribing from an event with: "+b);case 6:return R.abrupt("return",b);case 7:case"end":return R.stop()}},K,this)}));function P(K){return E.apply(this,arguments)}return P}()},{key:"close",value:function(P,K){this.socket.close(P||1e3,K)}},{key:"_connect",value:function(P,K){var T=this;clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(P,K),this.socket.addEventListener("open",function(){T.ready=!0,T.emit("open"),T.current_reconnects=0}),this.socket.addEventListener("message",function(b){var _=b.data;_ instanceof ArrayBuffer&&(_=we.Buffer.from(_).toString());try{_=JSON.parse(_)}catch{return}if(_.notification&&T.listeners(_.notification).length){if(!Object.keys(_.params).length)return T.emit(_.notification);var R=[_.notification];if(_.params.constructor===Object)R.push(_.params);else for(var W=0;W<_.params.length;W++)R.push(_.params[W]);return Promise.resolve().then(function(){T.emit.apply(T,R)})}if(!T.queue[_.id])return _.method&&_.params?Promise.resolve().then(function(){T.emit(_.method,_.params)}):void 0;"error"in _=="result"in _&&T.queue[_.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),T.queue[_.id].timeout&&clearTimeout(T.queue[_.id].timeout),_.error?T.queue[_.id].promise[1](_.error):T.queue[_.id].promise[0](_.result),delete T.queue[_.id]}),this.socket.addEventListener("error",function(b){return T.emit("error",b)}),this.socket.addEventListener("close",function(b){var _=b.code,R=b.reason;T.ready&&setTimeout(function(){return T.emit("close",_,R)},0),T.ready=!1,T.socket=void 0,_!==1e3&&(T.current_reconnects++,T.reconnect&&(T.max_reconnects>T.current_reconnects||T.max_reconnects===0)&&(T.reconnect_timer_id=setTimeout(function(){return T._connect(P,K)},T.reconnect_interval)))})}}]),v}(u.EventEmitter);r.default=S})(am);var SA=ku(am),cm={};(function(r){var e=bu.exports;Object.defineProperty(r,"__esModule",{value:!0}),r.default=d;var t=e(hu.exports),n=e(pu.exports),i=e(yu.exports),s=e(gu.exports),o=e(mu.exports),a=wu.exports;function c(m){var y=l();return function(){var p=(0,o.default)(m),w;if(y){var v=(0,o.default)(this).constructor;w=Reflect.construct(p,arguments,v)}else w=p.apply(this,arguments);return(0,s.default)(this,w)}}function l(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var u=function(m){(0,i.default)(S,m);var y=c(S);function S(p,w,v){var E;return(0,t.default)(this,S),E=y.call(this),E.socket=new window.WebSocket(p,v),E.socket.onopen=function(){return E.emit("open")},E.socket.onmessage=function(P){return E.emit("message",P.data)},E.socket.onerror=function(P){return E.emit("error",P)},E.socket.onclose=function(P){E.emit("close",P.code,P.reason)},E}return(0,n.default)(S,[{key:"send",value:function(w,v,E){var P=E||v;try{this.socket.send(w),P()}catch(K){P(K)}}},{key:"close",value:function(w,v){this.socket.close(w,v)}},{key:"addEventListener",value:function(w,v,E){this.socket.addEventListener(w,v,E)}}]),S}(a.EventEmitter);function d(m,y){return new u(m,y)}})(cm);var vA=ku(cm);const _A=on.utils.randomPrivateKey,wp=()=>{const r=on.utils.randomPrivateKey(),e=jc(r),t=new Uint8Array(64);return t.set(r),t.set(e,32),{publicKey:e,secretKey:t}},jc=on.getPublicKey;function kp(r){try{return on.ExtendedPoint.fromHex(r),!0}catch{return!1}}const jf=(r,e)=>on.sign(r,e.slice(0,32)),AA=on.verify,Me=r=>L.Buffer.isBuffer(r)?r:r instanceof Uint8Array?L.Buffer.from(r.buffer,r.byteOffset,r.byteLength):L.Buffer.from(r);class qf{constructor(e){Object.assign(this,e)}encode(){return L.Buffer.from(lf(oa,this))}static decode(e){return df(oa,this,e)}static decodeUnchecked(e){return ff(oa,this,e)}}class IA extends qf{constructor(e){if(super(e),this.enum="",Object.keys(e).length!==1)throw new Error("Enum can only take single value");Object.keys(e).map(t=>{this.enum=t})}}const oa=new Map;var um;let lm;const dm=32,qn=32;function EA(r){return r._bn!==void 0}let Sp=1;lm=Symbol.toStringTag;class ie extends qf{constructor(e){if(super({}),this._bn=void 0,EA(e))this._bn=e._bn;else{if(typeof e=="string"){const t=me.decode(e);if(t.length!=qn)throw new Error("Invalid public key input");this._bn=new kn(t)}else this._bn=new kn(e);if(this._bn.byteLength()>qn)throw new Error("Invalid public key input")}}static unique(){const e=new ie(Sp);return Sp+=1,new ie(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return me.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(L.Buffer);if(e.length===qn)return e;const t=L.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[lm](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,n){const i=L.Buffer.concat([e.toBuffer(),L.Buffer.from(t),n.toBuffer()]),s=eo(i);return new ie(s)}static createProgramAddressSync(e,t){let n=L.Buffer.alloc(0);e.forEach(function(s){if(s.length>dm)throw new TypeError("Max seed length exceeded");n=L.Buffer.concat([n,Me(s)])}),n=L.Buffer.concat([n,t.toBuffer(),L.Buffer.from("ProgramDerivedAddress")]);const i=eo(n);if(kp(i))throw new Error("Invalid seeds, address must fall off the curve");return new ie(i)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let n=255,i;for(;n!=0;){try{const s=e.concat(L.Buffer.from([n]));i=this.createProgramAddressSync(s,t)}catch(s){if(s instanceof TypeError)throw s;n--;continue}return[i,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new ie(e);return kp(t.toBytes())}}um=ie;ie.default=new um("11111111111111111111111111111111");oa.set(ie,{kind:"struct",fields:[["_bn","u256"]]});class PA{constructor(e){if(this._publicKey=void 0,this._secretKey=void 0,e){const t=Me(e);if(e.length!==64)throw new Error("bad secret key size");this._publicKey=t.slice(32,64),this._secretKey=t.slice(0,32)}else this._secretKey=Me(_A()),this._publicKey=Me(jc(this._secretKey))}get publicKey(){return new ie(this._publicKey)}get secretKey(){return L.Buffer.concat([this._secretKey,this._publicKey],64)}}const RA=new ie("BPFLoader1111111111111111111111111111111111"),gi=1280-40-8,Uu=127,so=64;class Gf extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Gf.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class Hf extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Hf.prototype,"name",{value:"TransactionExpiredTimeoutError"});class Ns extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Ns.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class va{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const n=new Map;this.keySegments().flat().forEach((s,o)=>{n.set(s.toBase58(),o)});const i=s=>{const o=n.get(s.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(s=>({programIdIndex:i(s.programId),accountKeyIndexes:s.keys.map(o=>i(o.pubkey)),data:s.data}))}}const $e=(r="publicKey")=>ge(32,r),TA=(r="signature")=>ge(64,r),Fi=(r="string")=>{const e=C([M("length"),M("lengthPadding"),ge(Kt(M(),-8),"chars")],r),t=e.decode.bind(e),n=e.encode.bind(e),i=e;return i.decode=(s,o)=>t(s,o).chars.toString(),i.encode=(s,o,a)=>{const c={chars:L.Buffer.from(s,"utf8")};return n(c,o,a)},i.alloc=s=>M().span+M().span+L.Buffer.from(s,"utf8").length,i},OA=(r="authorized")=>C([$e("staker"),$e("withdrawer")],r),BA=(r="lockup")=>C([De("unixTimestamp"),De("epoch"),$e("custodian")],r),xA=(r="voteInit")=>C([$e("nodePubkey"),$e("authorizedVoter"),$e("authorizedWithdrawer"),te("commission")],r),CA=(r="voteAuthorizeWithSeedArgs")=>C([M("voteAuthorizationType"),$e("currentAuthorityDerivedKeyOwnerPubkey"),Fi("currentAuthorityDerivedKeySeed"),$e("newAuthorized")],r);function fm(r,e){const t=i=>{if(i.span>=0)return i.span;if(typeof i.alloc=="function")return i.alloc(e[i.property]);if("count"in i&&"elementLayout"in i){const s=e[i.property];if(Array.isArray(s))return s.length*t(i.elementLayout)}else if("fields"in i)return fm({layout:i},e[i.property]);return 0};let n=0;return r.layout.fields.forEach(i=>{n+=t(i)}),n}function Rn(r){let e=0,t=0;for(;;){let n=r.shift();if(e|=(n&127)<<t*7,t+=1,(n&128)===0)break}return e}function Vn(r,e){let t=e;for(;;){let n=t&127;if(t>>=7,t==0){r.push(n);break}else n|=128,r.push(n)}}function Ge(r,e){if(!r)throw new Error(e||"Assertion failed")}class Fu{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const n=new Map,i=o=>{const a=o.toBase58();let c=n.get(a);return c===void 0&&(c={isSigner:!1,isWritable:!1,isInvoked:!1},n.set(a,c)),c},s=i(t);s.isSigner=!0,s.isWritable=!0;for(const o of e){i(o.programId).isInvoked=!0;for(const a of o.keys){const c=i(a.pubkey);c.isSigner||=a.isSigner,c.isWritable||=a.isWritable}}return new Fu(t,n)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];Ge(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,c])=>c.isSigner&&c.isWritable),n=e.filter(([,c])=>c.isSigner&&!c.isWritable),i=e.filter(([,c])=>!c.isSigner&&c.isWritable),s=e.filter(([,c])=>!c.isSigner&&!c.isWritable),o={numRequiredSignatures:t.length+n.length,numReadonlySignedAccounts:n.length,numReadonlyUnsignedAccounts:s.length};{Ge(t.length>0,"Expected at least one writable signer key");const[c]=t[0];Ge(c===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...t.map(([c])=>new ie(c)),...n.map(([c])=>new ie(c)),...i.map(([c])=>new ie(c)),...s.map(([c])=>new ie(c))];return[o,a]}extractTableLookup(e){const[t,n]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[i,s]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&i.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:i},{writable:n,readonly:s}]}drainKeysFoundInLookupTable(e,t){const n=new Array,i=new Array;for(const[s,o]of this.keyMetaMap.entries())if(t(o)){const a=new ie(s),c=e.findIndex(l=>l.equals(a));c>=0&&(Ge(c<256,"Max lookup table index exceeded"),n.push(c),i.push(a),this.keyMetaMap.delete(s))}return[n,i]}}class Sr{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new ie(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:me.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new va(this.staticAccountKeys)}static compile(e){const t=Fu.compile(e.instructions,e.payerKey),[n,i]=t.getMessageComponents(),o=new va(i).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:me.encode(a.data)}));return new Sr({header:n,accountKeys:i,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const n=e-t,s=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return n<s}else{const n=t-this.header.numReadonlySignedAccounts;return e<n}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];Vn(t,e);const n=this.instructions.map(d=>{const{accounts:m,programIdIndex:y}=d,S=Array.from(me.decode(d.data));let p=[];Vn(p,m.length);let w=[];return Vn(w,S.length),{programIdIndex:y,keyIndicesCount:L.Buffer.from(p),keyIndices:m,dataLength:L.Buffer.from(w),data:S}});let i=[];Vn(i,n.length);let s=L.Buffer.alloc(gi);L.Buffer.from(i).copy(s);let o=i.length;n.forEach(d=>{o+=C([te("programIdIndex"),ge(d.keyIndicesCount.length,"keyIndicesCount"),Oe(te("keyIndex"),d.keyIndices.length,"keyIndices"),ge(d.dataLength.length,"dataLength"),Oe(te("userdatum"),d.data.length,"data")]).encode(d,s,o)}),s=s.slice(0,o);const a=C([ge(1,"numRequiredSignatures"),ge(1,"numReadonlySignedAccounts"),ge(1,"numReadonlyUnsignedAccounts"),ge(t.length,"keyCount"),Oe($e("key"),e,"keys"),$e("recentBlockhash")]),c={numRequiredSignatures:L.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:L.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:L.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:L.Buffer.from(t),keys:this.accountKeys.map(d=>Me(d.toBytes())),recentBlockhash:me.decode(this.recentBlockhash)};let l=L.Buffer.alloc(2048);const u=a.encode(c,l);return s.copy(l,u),l.slice(0,u+s.length)}static from(e){let t=[...e];const n=t.shift();if(n!==(n&Uu))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const i=t.shift(),s=t.shift(),o=Rn(t);let a=[];for(let m=0;m<o;m++){const y=t.slice(0,qn);t=t.slice(qn),a.push(new ie(L.Buffer.from(y)))}const c=t.slice(0,qn);t=t.slice(qn);const l=Rn(t);let u=[];for(let m=0;m<l;m++){const y=t.shift(),S=Rn(t),p=t.slice(0,S);t=t.slice(S);const w=Rn(t),v=t.slice(0,w),E=me.encode(L.Buffer.from(v));t=t.slice(w),u.push({programIdIndex:y,accounts:p,data:E})}const d={header:{numRequiredSignatures:n,numReadonlySignedAccounts:i,numReadonlyUnsignedAccounts:s},recentBlockhash:me.encode(L.Buffer.from(c)),accountKeys:a,instructions:u};return new Sr(d)}}class ts{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new va(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,n=this.staticAccountKeys.length;if(e>=n){const i=e-n,s=this.addressTableLookups.reduce((o,a)=>o+a.writableIndexes.length,0);return i<s}else if(e>=this.header.numRequiredSignatures){const i=e-t,o=n-t-this.header.numReadonlyUnsignedAccounts;return i<o}else{const i=t-this.header.numReadonlySignedAccounts;return e<i}}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const n of this.addressTableLookups){const i=e.find(s=>s.key.equals(n.accountKey));if(!i)throw new Error(`Failed to find address lookup table account for table key ${n.accountKey.toBase58()}`);for(const s of n.writableIndexes)if(s<i.state.addresses.length)t.writable.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${n.accountKey.toBase58()}`);for(const s of n.readonlyIndexes)if(s<i.state.addresses.length)t.readonly.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${n.accountKey.toBase58()}`)}return t}static compile(e){const t=Fu.compile(e.instructions,e.payerKey),n=new Array,i={writable:new Array,readonly:new Array},s=e.addressLookupTableAccounts||[];for(const u of s){const d=t.extractTableLookup(u);if(d!==void 0){const[m,{writable:y,readonly:S}]=d;n.push(m),i.writable.push(...y),i.readonly.push(...S)}}const[o,a]=t.getMessageComponents(),l=new va(a,i).compileInstructions(e.instructions);return new ts({header:o,staticAccountKeys:a,recentBlockhash:e.recentBlockhash,compiledInstructions:l,addressTableLookups:n})}serialize(){const e=Array();Vn(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),n=Array();Vn(n,this.compiledInstructions.length);const i=this.serializeAddressTableLookups(),s=Array();Vn(s,this.addressTableLookups.length);const o=C([te("prefix"),C([te("numRequiredSignatures"),te("numReadonlySignedAccounts"),te("numReadonlyUnsignedAccounts")],"header"),ge(e.length,"staticAccountKeysLength"),Oe($e(),this.staticAccountKeys.length,"staticAccountKeys"),$e("recentBlockhash"),ge(n.length,"instructionsLength"),ge(t.length,"serializedInstructions"),ge(s.length,"addressTableLookupsLength"),ge(i.length,"serializedAddressTableLookups")]),a=new Uint8Array(gi),c=1<<7,l=o.encode({prefix:c,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(u=>u.toBytes()),recentBlockhash:me.decode(this.recentBlockhash),instructionsLength:new Uint8Array(n),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(s),serializedAddressTableLookups:i},a);return a.slice(0,l)}serializeInstructions(){let e=0;const t=new Uint8Array(gi);for(const n of this.compiledInstructions){const i=Array();Vn(i,n.accountKeyIndexes.length);const s=Array();Vn(s,n.data.length),e+=C([te("programIdIndex"),ge(i.length,"encodedAccountKeyIndexesLength"),Oe(te(),n.accountKeyIndexes.length,"accountKeyIndexes"),ge(s.length,"encodedDataLength"),ge(n.data.length,"data")]).encode({programIdIndex:n.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(i),accountKeyIndexes:n.accountKeyIndexes,encodedDataLength:new Uint8Array(s),data:n.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(gi);for(const n of this.addressTableLookups){const i=Array();Vn(i,n.writableIndexes.length);const s=Array();Vn(s,n.readonlyIndexes.length),e+=C([$e("accountKey"),ge(i.length,"encodedWritableIndexesLength"),Oe(te(),n.writableIndexes.length,"writableIndexes"),ge(s.length,"encodedReadonlyIndexesLength"),Oe(te(),n.readonlyIndexes.length,"readonlyIndexes")]).encode({accountKey:n.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(i),writableIndexes:n.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(s),readonlyIndexes:n.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const n=t.shift(),i=n&Uu;Ge(n!==i,"Expected versioned message but received legacy message");const s=i;Ge(s===0,`Expected versioned message with version 0 but found version ${s}`);const o={numRequiredSignatures:t.shift(),numReadonlySignedAccounts:t.shift(),numReadonlyUnsignedAccounts:t.shift()},a=[],c=Rn(t);for(let S=0;S<c;S++)a.push(new ie(t.splice(0,qn)));const l=me.encode(t.splice(0,qn)),u=Rn(t),d=[];for(let S=0;S<u;S++){const p=t.shift(),w=Rn(t),v=t.splice(0,w),E=Rn(t),P=new Uint8Array(t.splice(0,E));d.push({programIdIndex:p,accountKeyIndexes:v,data:P})}const m=Rn(t),y=[];for(let S=0;S<m;S++){const p=new ie(t.splice(0,qn)),w=Rn(t),v=t.splice(0,w),E=Rn(t),P=t.splice(0,E);y.push({accountKey:p,writableIndexes:v,readonlyIndexes:P})}return new ts({header:o,staticAccountKeys:a,recentBlockhash:l,compiledInstructions:d,addressTableLookups:y})}}const Yf={deserializeMessageVersion(r){const e=r[0],t=e&Uu;return t===e?"legacy":t},deserialize:r=>{const e=Yf.deserializeMessageVersion(r);if(e==="legacy")return Sr.from(r);if(e===0)return ts.deserialize(r);throw new Error(`Transaction message version ${e} deserialization is not supported`)}};let Gr=function(r){return r[r.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",r[r.PROCESSED=1]="PROCESSED",r[r.TIMED_OUT=2]="TIMED_OUT",r[r.NONCE_INVALID=3]="NONCE_INVALID",r}({});const MA=L.Buffer.alloc(so).fill(0);class ut{constructor(e){this.keys=void 0,this.programId=void 0,this.data=L.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:n})=>({pubkey:e.toJSON(),isSigner:t,isWritable:n})),programId:this.programId.toJSON(),data:[...this.data]}}}class Ze{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:n}=e;this.minNonceContextSlot=t,this.nonceInfo=n}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:n}=e;this.recentBlockhash=t,this.lastValidBlockHeight=n}else{const{recentBlockhash:t,nonceInfo:n}=e;n&&(this.nonceInfo=n),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new ut(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let n;if(this.feePayer)n=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)n=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let p=0;p<t.length;p++)if(t[p].programId===void 0)throw new Error(`Transaction instruction index ${p} has undefined program id`);const i=[],s=[];t.forEach(p=>{p.keys.forEach(v=>{s.push({...v})});const w=p.programId.toString();i.includes(w)||i.push(w)}),i.forEach(p=>{s.push({pubkey:new ie(p),isSigner:!1,isWritable:!1})});const o=[];s.forEach(p=>{const w=p.pubkey.toString(),v=o.findIndex(E=>E.pubkey.toString()===w);v>-1?(o[v].isWritable=o[v].isWritable||p.isWritable,o[v].isSigner=o[v].isSigner||p.isSigner):o.push(p)}),o.sort(function(p,w){if(p.isSigner!==w.isSigner)return p.isSigner?-1:1;if(p.isWritable!==w.isWritable)return p.isWritable?-1:1;const v={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return p.pubkey.toBase58().localeCompare(w.pubkey.toBase58(),"en",v)});const a=o.findIndex(p=>p.pubkey.equals(n));if(a>-1){const[p]=o.splice(a,1);p.isSigner=!0,p.isWritable=!0,o.unshift(p)}else o.unshift({pubkey:n,isSigner:!0,isWritable:!0});for(const p of this.signatures){const w=o.findIndex(v=>v.pubkey.equals(p.publicKey));if(w>-1)o[w].isSigner||(o[w].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${p.publicKey.toString()}`)}let c=0,l=0,u=0;const d=[],m=[];o.forEach(({pubkey:p,isSigner:w,isWritable:v})=>{w?(d.push(p.toString()),c+=1,v||(l+=1)):(m.push(p.toString()),v||(u+=1))});const y=d.concat(m),S=t.map(p=>{const{data:w,programId:v}=p;return{programIdIndex:y.indexOf(v.toString()),accounts:p.keys.map(E=>y.indexOf(E.pubkey.toString())),data:me.encode(w)}});return S.forEach(p=>{Ge(p.programIdIndex>=0),p.accounts.forEach(w=>Ge(w>=0))}),new Sr({header:{numRequiredSignatures:c,numReadonlySignedAccounts:l,numReadonlyUnsignedAccounts:u},accountKeys:y,recentBlockhash:e,instructions:S})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((i,s)=>t[s].equals(i.publicKey))||(this.signatures=t.map(n=>({signature:null,publicKey:n}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(n=>{const i=n.toString();return t.has(i)?!1:(t.add(i),!0)}).map(n=>({signature:null,publicKey:n}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}this.signatures=n.map(s=>({signature:null,publicKey:s.publicKey}));const i=this._compile();this._partialSign(i,...n)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}const i=this._compile();this._partialSign(i,...n)}_partialSign(e,...t){const n=e.serialize();t.forEach(i=>{const s=jf(n,i.secretKey);this._addSignature(i.publicKey,Me(s))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){Ge(t.length===64);const n=this.signatures.findIndex(i=>e.equals(i.publicKey));if(n<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[n].signature=L.Buffer.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:n,publicKey:i}of this.signatures)if(n===null){if(t)return!1}else if(!AA(n,e,i.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:n}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),i=this.serializeMessage();if(n&&!this._verifySignatures(i,t))throw new Error("Signature verification failed");return this._serialize(i)}_serialize(e){const{signatures:t}=this,n=[];Vn(n,t.length);const i=n.length+t.length*64+e.length,s=L.Buffer.alloc(i);return Ge(t.length<256),L.Buffer.from(n).copy(s,0),t.forEach(({signature:o},a)=>{o!==null&&(Ge(o.length===64,"signature has invalid length"),L.Buffer.from(o).copy(s,n.length+a*64))}),e.copy(s,n.length+t.length*64),Ge(s.length<=gi,`Transaction too large: ${s.length} > ${gi}`),s}get keys(){return Ge(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return Ge(this.instructions.length===1),this.instructions[0].programId}get data(){return Ge(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const n=Rn(t);let i=[];for(let s=0;s<n;s++){const o=t.slice(0,so);t=t.slice(so),i.push(me.encode(L.Buffer.from(o)))}return Ze.populate(Sr.from(t),i)}static populate(e,t=[]){const n=new Ze;return n.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(n.feePayer=e.accountKeys[0]),t.forEach((i,s)=>{const o={signature:i==me.encode(MA)?null:me.decode(i),publicKey:e.accountKeys[s]};n.signatures.push(o)}),e.instructions.forEach(i=>{const s=i.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:n.signatures.some(c=>c.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});n.instructions.push(new ut({keys:s,programId:e.accountKeys[i.programIdIndex],data:me.decode(i.data)}))}),n._message=e,n._json=n.toJSON(),n}}class Jf{constructor(e){this.payerKey=void 0,this.instructions=void 0,this.recentBlockhash=void 0,this.payerKey=e.payerKey,this.instructions=e.instructions,this.recentBlockhash=e.recentBlockhash}static decompile(e,t){const{header:n,compiledInstructions:i,recentBlockhash:s}=e,{numRequiredSignatures:o,numReadonlySignedAccounts:a,numReadonlyUnsignedAccounts:c}=n,l=o-a;Ge(l>0,"Message header is invalid");const u=e.staticAccountKeys.length-o-c;Ge(u>=0,"Message header is invalid");const d=e.getAccountKeys(t),m=d.get(0);if(m===void 0)throw new Error("Failed to decompile message because no account keys were found");const y=[];for(const S of i){const p=[];for(const v of S.accountKeyIndexes){const E=d.get(v);if(E===void 0)throw new Error(`Failed to find key for account key index ${v}`);const P=v<o;let K;P?K=v<l:v<d.staticAccountKeys.length?K=v-o<u:K=v-d.staticAccountKeys.length<d.accountKeysFromLookups.writable.length,p.push({pubkey:E,isSigner:v<n.numRequiredSignatures,isWritable:K})}const w=d.get(S.programIdIndex);if(w===void 0)throw new Error(`Failed to find program id for program id index ${S.programIdIndex}`);y.push(new ut({programId:w,data:Me(S.data),keys:p}))}return new Jf({payerKey:m,instructions:y,recentBlockhash:s})}compileToLegacyMessage(){return Sr.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions})}compileToV0Message(e){return ts.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions,addressLookupTableAccounts:e})}}class Qf{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,t!==void 0)Ge(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{const n=[];for(let i=0;i<e.header.numRequiredSignatures;i++)n.push(new Uint8Array(so));this.signatures=n}this.message=e}serialize(){const e=this.message.serialize(),t=Array();Vn(t,this.signatures.length);const n=C([ge(t.length,"encodedSignaturesLength"),Oe(TA(),this.signatures.length,"signatures"),ge(e.length,"serializedMessage")]),i=new Uint8Array(2048),s=n.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},i);return i.slice(0,s)}static deserialize(e){let t=[...e];const n=[],i=Rn(t);for(let o=0;o<i;o++)n.push(new Uint8Array(t.splice(0,so)));const s=Yf.deserialize(new Uint8Array(t));return new Qf(s,n)}sign(e){const t=this.message.serialize(),n=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const i of e){const s=n.findIndex(o=>o.equals(i.publicKey));Ge(s>=0,`Cannot sign with non signer key ${i.publicKey.toBase58()}`),this.signatures[s]=jf(t,i.secretKey)}}addSignature(e,t){Ge(t.byteLength===64,"Signature must be 64 bytes long");const i=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(s=>s.equals(e));Ge(i>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[i]=t}}const LA=160,KA=64,NA=LA/KA,hm=1e3/NA,Or=new ie("SysvarC1ock11111111111111111111111111111111"),$A=new ie("SysvarEpochSchedu1e111111111111111111111111"),DA=new ie("Sysvar1nstructions1111111111111111111111111"),Bc=new ie("SysvarRecentB1ockHashes11111111111111111111"),oo=new ie("SysvarRent111111111111111111111111111111111"),zA=new ie("SysvarRewards111111111111111111111111111111"),WA=new ie("SysvarS1otHashes111111111111111111111111111"),VA=new ie("SysvarS1otHistory11111111111111111111111111"),xc=new ie("SysvarStakeHistory1111111111111111111111111");async function Kd(r,e,t,n){const i=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot},s=await r.sendTransaction(e,t,i);let o;if(e.recentBlockhash!=null&&e.lastValidBlockHeight!=null)o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,signature:s,blockhash:e.recentBlockhash,lastValidBlockHeight:e.lastValidBlockHeight},n&&n.commitment)).value;else if(e.minNonceContextSlot!=null&&e.nonceInfo!=null){const{nonceInstruction:a}=e.nonceInfo,c=a.keys[0].pubkey;o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,minContextSlot:e.minNonceContextSlot,nonceAccountPubkey:c,nonceValue:e.nonceInfo.nonce,signature:s},n&&n.commitment)).value}else(n==null?void 0:n.abortSignal)!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),o=(await r.confirmTransaction(s,n&&n.commitment)).value;if(o.err)throw new Error(`Transaction ${s} failed (${JSON.stringify(o)})`);return s}function zi(r){return new Promise(e=>setTimeout(e,r))}function We(r,e){const t=r.layout.span>=0?r.layout.span:fm(r,e),n=L.Buffer.alloc(t),i=Object.assign({instruction:r.index},e);return r.layout.encode(i,n),n}function Xe(r,e){let t;try{t=r.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.instruction!==r.index)throw new Error(`invalid instruction; instruction index mismatch ${t.instruction} != ${r.index}`);return t}const pm=_e("lamportsPerSignature"),ym=C([M("version"),M("state"),$e("authorizedPubkey"),$e("nonce"),C([pm],"feeCalculator")]),Nd=ym.span;class ju{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=ym.decode(Me(e),0);return new ju({authorizedPubkey:new ie(t.authorizedPubkey),nonce:new ie(t.nonce).toString(),feeCalculator:t.feeCalculator})}}const UA=r=>{const e=r.decode.bind(r),t=r.encode.bind(r);return{decode:e,encode:t}},FA=r=>e=>{const t=ge(r,e),{encode:n,decode:i}=UA(t),s=t;return s.decode=(o,a)=>{const c=i(o,a);return hf(L.Buffer.from(c))},s.encode=(o,a,c)=>{const l=Ba(o,r);return n(l,a,c)},s},ao=FA(8);class jA{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(dt))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a SystemInstruction");return i}static decodeCreateAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t,space:n,programId:i}=Xe(dt.Create,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,lamports:t,space:n,programId:new ie(i)}}static decodeTransfer(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t}=Xe(dt.Transfer,e.data);return{fromPubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,lamports:t}}static decodeTransferWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t,seed:n,programId:i}=Xe(dt.TransferWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,basePubkey:e.keys[1].pubkey,toPubkey:e.keys[2].pubkey,lamports:t,seed:n,programId:new ie(i)}}static decodeAllocate(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{space:t}=Xe(dt.Allocate,e.data);return{accountPubkey:e.keys[0].pubkey,space:t}}static decodeAllocateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:n,space:i,programId:s}=Xe(dt.AllocateWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new ie(t),seed:n,space:i,programId:new ie(s)}}static decodeAssign(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{programId:t}=Xe(dt.Assign,e.data);return{accountPubkey:e.keys[0].pubkey,programId:new ie(t)}}static decodeAssignWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:n,programId:i}=Xe(dt.AssignWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new ie(t),seed:n,programId:new ie(i)}}static decodeCreateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{base:t,seed:n,lamports:i,space:s,programId:o}=Xe(dt.CreateWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,basePubkey:new ie(t),seed:n,lamports:i,space:s,programId:new ie(o)}}static decodeNonceInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{authorized:t}=Xe(dt.InitializeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:new ie(t)}}static decodeNonceAdvance(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Xe(dt.AdvanceNonceAccount,e.data),{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static decodeNonceWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Xe(dt.WithdrawNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t}}static decodeNonceAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t}=Xe(dt.AuthorizeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[1].pubkey,newAuthorizedPubkey:new ie(t)}}static checkProgramId(e){if(!e.equals(sn.programId))throw new Error("invalid instruction; programId is not SystemProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const dt=Object.freeze({Create:{index:0,layout:C([M("instruction"),De("lamports"),De("space"),$e("programId")])},Assign:{index:1,layout:C([M("instruction"),$e("programId")])},Transfer:{index:2,layout:C([M("instruction"),ao("lamports")])},CreateWithSeed:{index:3,layout:C([M("instruction"),$e("base"),Fi("seed"),De("lamports"),De("space"),$e("programId")])},AdvanceNonceAccount:{index:4,layout:C([M("instruction")])},WithdrawNonceAccount:{index:5,layout:C([M("instruction"),De("lamports")])},InitializeNonceAccount:{index:6,layout:C([M("instruction"),$e("authorized")])},AuthorizeNonceAccount:{index:7,layout:C([M("instruction"),$e("authorized")])},Allocate:{index:8,layout:C([M("instruction"),De("space")])},AllocateWithSeed:{index:9,layout:C([M("instruction"),$e("base"),Fi("seed"),De("space"),$e("programId")])},AssignWithSeed:{index:10,layout:C([M("instruction"),$e("base"),Fi("seed"),$e("programId")])},TransferWithSeed:{index:11,layout:C([M("instruction"),ao("lamports"),Fi("seed"),$e("programId")])},UpgradeNonceAccount:{index:12,layout:C([M("instruction")])}});class sn{constructor(){}static createAccount(e){const t=dt.Create,n=We(t,{lamports:e.lamports,space:e.space,programId:Me(e.programId.toBuffer())});return new ut({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:n})}static transfer(e){let t,n;if("basePubkey"in e){const i=dt.TransferWithSeed;t=We(i,{lamports:BigInt(e.lamports),seed:e.seed,programId:Me(e.programId.toBuffer())}),n=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}else{const i=dt.Transfer;t=We(i,{lamports:BigInt(e.lamports)}),n=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}return new ut({keys:n,programId:this.programId,data:t})}static assign(e){let t,n;if("basePubkey"in e){const i=dt.AssignWithSeed;t=We(i,{base:Me(e.basePubkey.toBuffer()),seed:e.seed,programId:Me(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=dt.Assign;t=We(i,{programId:Me(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new ut({keys:n,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=dt.CreateWithSeed,n=We(t,{base:Me(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:Me(e.programId.toBuffer())});let i=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey!=e.fromPubkey&&i.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new ut({keys:i,programId:this.programId,data:n})}static createNonceAccount(e){const t=new Ze;"basePubkey"in e&&"seed"in e?t.add(sn.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:Nd,programId:this.programId})):t.add(sn.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:Nd,programId:this.programId}));const n={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(n)),t}static nonceInitialize(e){const t=dt.InitializeNonceAccount,n=We(t,{authorized:Me(e.authorizedPubkey.toBuffer())}),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Bc,isSigner:!1,isWritable:!1},{pubkey:oo,isSigner:!1,isWritable:!1}],programId:this.programId,data:n};return new ut(i)}static nonceAdvance(e){const t=dt.AdvanceNonceAccount,n=We(t),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Bc,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n};return new ut(i)}static nonceWithdraw(e){const t=dt.WithdrawNonceAccount,n=We(t,{lamports:e.lamports});return new ut({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:Bc,isSigner:!1,isWritable:!1},{pubkey:oo,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static nonceAuthorize(e){const t=dt.AuthorizeNonceAccount,n=We(t,{authorized:Me(e.newAuthorizedPubkey.toBuffer())});return new ut({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static allocate(e){let t,n;if("basePubkey"in e){const i=dt.AllocateWithSeed;t=We(i,{base:Me(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:Me(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=dt.Allocate;t=We(i,{space:e.space}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new ut({keys:n,programId:this.programId,data:t})}}sn.programId=new ie("11111111111111111111111111111111");const qA=gi-300;class ns{constructor(){}static getMinNumSignatures(e){return 2*(Math.ceil(e/ns.chunkSize)+1+1)}static async load(e,t,n,i,s){{const d=await e.getMinimumBalanceForRentExemption(s.length),m=await e.getAccountInfo(n.publicKey,"confirmed");let y=null;if(m!==null){if(m.executable)return console.error("Program load failed, account is already executable"),!1;m.data.length!==s.length&&(y=y||new Ze,y.add(sn.allocate({accountPubkey:n.publicKey,space:s.length}))),m.owner.equals(i)||(y=y||new Ze,y.add(sn.assign({accountPubkey:n.publicKey,programId:i}))),m.lamports<d&&(y=y||new Ze,y.add(sn.transfer({fromPubkey:t.publicKey,toPubkey:n.publicKey,lamports:d-m.lamports})))}else y=new Ze().add(sn.createAccount({fromPubkey:t.publicKey,newAccountPubkey:n.publicKey,lamports:d>0?d:1,space:s.length,programId:i}));y!==null&&await Kd(e,y,[t,n],{commitment:"confirmed"})}const o=C([M("instruction"),M("offset"),M("bytesLength"),M("bytesLengthPadding"),Oe(te("byte"),Kt(M(),-8),"bytes")]),a=ns.chunkSize;let c=0,l=s,u=[];for(;l.length>0;){const d=l.slice(0,a),m=L.Buffer.alloc(a+16);o.encode({instruction:0,offset:c,bytes:d,bytesLength:0,bytesLengthPadding:0},m);const y=new Ze().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0}],programId:i,data:m});u.push(Kd(e,y,[t,n],{commitment:"confirmed"})),e._rpcEndpoint.includes("solana.com")&&await zi(1e3/4),c+=a,l=l.slice(a)}await Promise.all(u);{const d=C([M("instruction")]),m=L.Buffer.alloc(d.span);d.encode({instruction:1},m);const y=new Ze().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0},{pubkey:oo,isSigner:!1,isWritable:!1}],programId:i,data:m}),S="processed",p=await e.sendTransaction(y,[t,n],{preflightCommitment:S}),{context:w,value:v}=await e.confirmTransaction({signature:p,lastValidBlockHeight:y.lastValidBlockHeight,blockhash:y.recentBlockhash},S);if(v.err)throw new Error(`Transaction ${p} failed (${JSON.stringify(v)})`);for(;;){try{if(await e.getSlot({commitment:S})>w.slot)break}catch{}await new Promise(E=>setTimeout(E,Math.round(hm/2)))}}return!0}}ns.chunkSize=qA;const GA=new ie("BPFLoader2111111111111111111111111111111111");class HA{static getMinNumSignatures(e){return ns.getMinNumSignatures(e)}static load(e,t,n,i,s){return ns.load(e,t,n,s,i)}}function YA(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var JA=Object.prototype.toString,QA=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};function Xo(r,e){var t,n,i,s,o,a,c;if(r===!0)return"true";if(r===!1)return"false";switch(typeof r){case"object":if(r===null)return null;if(r.toJSON&&typeof r.toJSON=="function")return Xo(r.toJSON(),e);if(c=JA.call(r),c==="[object Array]"){for(i="[",n=r.length-1,t=0;t<n;t++)i+=Xo(r[t],!0)+",";return n>-1&&(i+=Xo(r[t],!0)),i+"]"}else if(c==="[object Object]"){for(s=QA(r).sort(),n=s.length,i="",t=0;t<n;)o=s[t],a=Xo(r[o],!1),a!==void 0&&(i&&(i+=","),i+=JSON.stringify(o)+":"+a),t++;return"{"+i+"}"}else return JSON.stringify(r);case"function":case"undefined":return e?null:void 0;case"string":return JSON.stringify(r);default:return isFinite(r)?r:null}}var XA=function(r){var e=Xo(r,!1);if(e!==void 0)return""+e},vp=YA(XA);const Ho=32;function ed(r){let e=0;for(;r>1;)r/=2,e++;return e}function ZA(r){return r===0?1:(r--,r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16,r|=r>>32,r+1)}class gm{constructor(e,t,n,i,s){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=n,this.firstNormalEpoch=i,this.firstNormalSlot=s}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const t=ed(ZA(e+Ho+1))-ed(Ho)-1,n=this.getSlotsInEpoch(t),i=e-(n-Ho);return[t,i]}else{const t=e-this.firstNormalSlot,n=Math.floor(t/this.slotsPerEpoch),i=this.firstNormalEpoch+n,s=t%this.slotsPerEpoch;return[i,s]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*Ho:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+ed(Ho)):this.slotsPerEpoch}}class $d extends Error{constructor(e,t){super(e),this.logs=void 0,this.logs=t}}const e1={JSON_RPC_SERVER_ERROR_BLOCK_CLEANED_UP:-32001,JSON_RPC_SERVER_ERROR_SEND_TRANSACTION_PREFLIGHT_FAILURE:-32002,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_VERIFICATION_FAILURE:-32003,JSON_RPC_SERVER_ERROR_BLOCK_NOT_AVAILABLE:-32004,JSON_RPC_SERVER_ERROR_NODE_UNHEALTHY:-32005,JSON_RPC_SERVER_ERROR_TRANSACTION_PRECOMPILE_VERIFICATION_FAILURE:-32006,JSON_RPC_SERVER_ERROR_SLOT_SKIPPED:-32007,JSON_RPC_SERVER_ERROR_NO_SNAPSHOT:-32008,JSON_RPC_SERVER_ERROR_LONG_TERM_STORAGE_SLOT_SKIPPED:-32009,JSON_RPC_SERVER_ERROR_KEY_EXCLUDED_FROM_SECONDARY_INDEX:-32010,JSON_RPC_SERVER_ERROR_TRANSACTION_HISTORY_NOT_AVAILABLE:-32011,JSON_RPC_SCAN_ERROR:-32012,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_LEN_MISMATCH:-32013,JSON_RPC_SERVER_ERROR_BLOCK_STATUS_NOT_AVAILABLE_YET:-32014,JSON_RPC_SERVER_ERROR_UNSUPPORTED_TRANSACTION_VERSION:-32015,JSON_RPC_SERVER_ERROR_MIN_CONTEXT_SLOT_NOT_REACHED:-32016};class pe extends Error{constructor({code:e,message:t,data:n},i){super(i!=null?`${i}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=n,this.name="SolanaJSONRPCError"}}var t1=globalThis.fetch;class n1 extends SA{constructor(e,t,n){const i=s=>{const o=vA(s,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in o?this.underlyingSocket=o.socket:this.underlyingSocket=o,o};super(i,e,t,n),this.underlyingSocket=void 0}call(...e){var n;const t=(n=this.underlyingSocket)==null?void 0:n.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){var n;const t=(n=this.underlyingSocket)==null?void 0:n.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}function r1(r,e){let t;try{t=r.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.typeIndex!==r.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${r.index}`);return t}const _p=56;class Dd{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=r1(i1,e),n=e.length-_p;Ge(n>=0,"lookup table is invalid"),Ge(n%32===0,"lookup table is invalid");const i=n/32,{addresses:s}=C([Oe($e(),i,"addresses")]).decode(e.slice(_p));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new ie(t.authority[0]):void 0,addresses:s.map(o=>new ie(o))}}}const i1={index:1,layout:C([M("typeIndex"),ao("deactivationSlot"),_e("lastExtendedSlot"),te("lastExtendedStartIndex"),te(),Oe($e(),Kt(te(),-1),"authority")])},s1=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function o1(r){const e=r.match(s1);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${r}\``);const[t,n,i,s]=e,o=r.startsWith("https:")?"wss:":"ws:",a=i==null?null:parseInt(i.slice(1),10),c=a==null?"":`:${a+1}`;return`${o}//${n}${c}${s}`}const Dt=Fr(To(ie),N(),r=>new ie(r)),mm=Oo([N(),Ee("base64")]),Xf=Fr(To(L.Buffer),mm,r=>L.Buffer.from(r[0],"base64")),bm=30*1e3;function a1(r){if(/^https?:/.test(r)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return r}function yt(r){let e,t;if(typeof r=="string")e=r;else if(r){const{commitment:n,...i}=r;e=n,t=i}return{commitment:e,config:t}}function wm(r){return st([O({jsonrpc:Ee("2.0"),id:N(),result:r}),O({jsonrpc:Ee("2.0"),id:N(),error:O({code:Ur(),message:N(),data:X(om())})})])}const c1=wm(Ur());function xe(r){return Fr(wm(r),c1,e=>"error"in e?e:{...e,result:ne(e.result,r)})}function Pt(r){return xe(O({context:O({slot:k()}),value:r}))}function qu(r){return O({context:O({slot:k()}),value:r})}function td(r,e){return r===0?new ts({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new ie(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:me.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new Sr(e)}const u1=O({foundation:k(),foundationTerm:k(),initial:k(),taper:k(),terminal:k()}),l1=xe(j(F(O({epoch:k(),effectiveSlot:k(),amount:k(),postBalance:k(),commission:X(F(k()))})))),d1=j(O({slot:k(),prioritizationFee:k()})),f1=O({total:k(),validator:k(),foundation:k(),epoch:k()}),h1=O({epoch:k(),slotIndex:k(),slotsInEpoch:k(),absoluteSlot:k(),blockHeight:X(k()),transactionCount:X(k())}),p1=O({slotsPerEpoch:k(),leaderScheduleSlotOffset:k(),warmup:$t(),firstNormalEpoch:k(),firstNormalSlot:k()}),y1=Vu(N(),j(k())),bs=F(st([O({}),N()])),g1=O({err:bs}),m1=Ee("receivedSignature"),b1=O({"solana-core":N(),"feature-set":X(k())}),Ap=Pt(O({err:F(st([O({}),N()])),logs:F(j(N())),accounts:X(F(j(F(O({executable:$t(),owner:N(),lamports:k(),data:j(N()),rentEpoch:X(k())}))))),unitsConsumed:X(k()),returnData:X(F(O({programId:N(),data:Oo([N(),Ee("base64")])})))})),w1=Pt(O({byIdentity:Vu(N(),j(k())),range:O({firstSlot:k(),lastSlot:k()})}));function k1(r,e,t,n,i,s){const o=t||t1;let a;s!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let c;return n&&(c=async(u,d)=>{const m=await new Promise((y,S)=>{try{n(u,d,(p,w)=>y([p,w]))}catch(p){S(p)}});return await o(...m)}),new kA(async(u,d)=>{const m={method:"POST",body:u,agent:a,headers:Object.assign({"Content-Type":"application/json"},e||{},S0)};try{let y=5,S,p=500;for(;c?S=await c(r,m):S=await o(r,m),!(S.status!==429||i===!0||(y-=1,y===0));)console.log(`Server responded with ${S.status} ${S.statusText}.  Retrying after ${p}ms delay...`),await zi(p),p*=2;const w=await S.text();S.ok?d(null,w):d(new Error(`${S.status} ${S.statusText}: ${w}`))}catch(y){y instanceof Error&&d(y)}},{})}function S1(r){return(e,t)=>new Promise((n,i)=>{r.request(e,t,(s,o)=>{if(s){i(s);return}n(o)})})}function v1(r){return e=>new Promise((t,n)=>{e.length===0&&t([]);const i=e.map(s=>r.request(s.methodName,s.args));r.request(i,(s,o)=>{if(s){n(s);return}t(o)})})}const _1=xe(u1),A1=xe(f1),I1=xe(d1),E1=xe(h1),P1=xe(p1),R1=xe(y1),T1=xe(k()),O1=Pt(O({total:k(),circulating:k(),nonCirculating:k(),nonCirculatingAccounts:j(Dt)})),zd=O({amount:N(),uiAmount:F(k()),decimals:k(),uiAmountString:X(N())}),B1=Pt(j(O({address:Dt,amount:N(),uiAmount:F(k()),decimals:k(),uiAmountString:X(N())}))),x1=Pt(j(O({pubkey:Dt,account:O({executable:$t(),owner:Dt,lamports:k(),data:Xf,rentEpoch:k()})}))),Wd=O({program:N(),parsed:Ur(),space:k()}),C1=Pt(j(O({pubkey:Dt,account:O({executable:$t(),owner:Dt,lamports:k(),data:Wd,rentEpoch:k()})}))),M1=Pt(j(O({lamports:k(),address:Dt}))),_a=O({executable:$t(),owner:Dt,lamports:k(),data:Xf,rentEpoch:k()}),L1=O({pubkey:Dt,account:_a}),K1=Fr(st([To(L.Buffer),Wd]),st([mm,Wd]),r=>Array.isArray(r)?ne(r,Xf):r),Vd=O({executable:$t(),owner:Dt,lamports:k(),data:K1,rentEpoch:k()}),N1=O({pubkey:Dt,account:Vd}),$1=O({state:st([Ee("active"),Ee("inactive"),Ee("activating"),Ee("deactivating")]),active:k(),inactive:k()}),D1=xe(j(O({signature:N(),slot:k(),err:bs,memo:F(N()),blockTime:X(F(k()))}))),z1=xe(j(O({signature:N(),slot:k(),err:bs,memo:F(N()),blockTime:X(F(k()))}))),W1=O({subscription:k(),result:qu(_a)}),V1=O({pubkey:Dt,account:_a}),U1=O({subscription:k(),result:qu(V1)}),F1=O({parent:k(),slot:k(),root:k()}),j1=O({subscription:k(),result:F1}),q1=st([O({type:st([Ee("firstShredReceived"),Ee("completed"),Ee("optimisticConfirmation"),Ee("root")]),slot:k(),timestamp:k()}),O({type:Ee("createdBank"),parent:k(),slot:k(),timestamp:k()}),O({type:Ee("frozen"),slot:k(),timestamp:k(),stats:O({numTransactionEntries:k(),numSuccessfulTransactions:k(),numFailedTransactions:k(),maxTransactionsPerEntry:k()})}),O({type:Ee("dead"),slot:k(),timestamp:k(),err:N()})]),G1=O({subscription:k(),result:q1}),H1=O({subscription:k(),result:qu(st([g1,m1]))}),Y1=O({subscription:k(),result:k()}),J1=O({pubkey:N(),gossip:F(N()),tpu:F(N()),rpc:F(N()),version:F(N())}),Ip=O({votePubkey:N(),nodePubkey:N(),activatedStake:k(),epochVoteAccount:$t(),epochCredits:j(Oo([k(),k(),k()])),commission:k(),lastVote:k(),rootSlot:F(k())}),Q1=xe(O({current:j(Ip),delinquent:j(Ip)})),X1=st([Ee("processed"),Ee("confirmed"),Ee("finalized")]),Z1=O({slot:k(),confirmations:F(k()),err:bs,confirmationStatus:X(X1)}),e0=Pt(j(F(Z1))),t0=xe(k()),km=O({accountKey:Dt,writableIndexes:j(k()),readonlyIndexes:j(k())}),Zf=O({signatures:j(N()),message:O({accountKeys:j(N()),header:O({numRequiredSignatures:k(),numReadonlySignedAccounts:k(),numReadonlyUnsignedAccounts:k()}),instructions:j(O({accounts:j(k()),data:N(),programIdIndex:k()})),recentBlockhash:N(),addressTableLookups:X(j(km))})}),Sm=O({pubkey:Dt,signer:$t(),writable:$t(),source:X(st([Ee("transaction"),Ee("lookupTable")]))}),vm=O({accountKeys:j(Sm),signatures:j(N())}),_m=O({parsed:Ur(),program:N(),programId:Dt}),Am=O({accounts:j(Dt),data:N(),programId:Dt}),n0=st([Am,_m]),r0=st([O({parsed:Ur(),program:N(),programId:N()}),O({accounts:j(N()),data:N(),programId:N()})]),Im=Fr(n0,r0,r=>"accounts"in r?ne(r,Am):ne(r,_m)),Em=O({signatures:j(N()),message:O({accountKeys:j(Sm),instructions:j(Im),recentBlockhash:N(),addressTableLookups:X(F(j(km)))})}),qc=O({accountIndex:k(),mint:N(),owner:X(N()),uiTokenAmount:zd}),Pm=O({writable:j(Dt),readonly:j(Dt)}),Gu=O({err:bs,fee:k(),innerInstructions:X(F(j(O({index:k(),instructions:j(O({accounts:j(k()),data:N(),programIdIndex:k()}))})))),preBalances:j(k()),postBalances:j(k()),logMessages:X(F(j(N()))),preTokenBalances:X(F(j(qc))),postTokenBalances:X(F(j(qc))),loadedAddresses:X(Pm),computeUnitsConsumed:X(k())}),eh=O({err:bs,fee:k(),innerInstructions:X(F(j(O({index:k(),instructions:j(Im)})))),preBalances:j(k()),postBalances:j(k()),logMessages:X(F(j(N()))),preTokenBalances:X(F(j(qc))),postTokenBalances:X(F(j(qc))),loadedAddresses:X(Pm),computeUnitsConsumed:X(k())}),Bo=st([Ee(0),Ee("legacy")]),ws=O({pubkey:N(),lamports:k(),postBalance:F(k()),rewardType:F(N()),commission:X(F(k()))}),i0=xe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:Zf,meta:F(Gu),version:X(Bo)})),rewards:X(j(ws)),blockTime:F(k()),blockHeight:F(k())}))),s0=xe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),rewards:X(j(ws)),blockTime:F(k()),blockHeight:F(k())}))),o0=xe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:vm,meta:F(Gu),version:X(Bo)})),rewards:X(j(ws)),blockTime:F(k()),blockHeight:F(k())}))),a0=xe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:Em,meta:F(eh),version:X(Bo)})),rewards:X(j(ws)),blockTime:F(k()),blockHeight:F(k())}))),c0=xe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:vm,meta:F(eh),version:X(Bo)})),rewards:X(j(ws)),blockTime:F(k()),blockHeight:F(k())}))),u0=xe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),rewards:X(j(ws)),blockTime:F(k()),blockHeight:F(k())}))),l0=xe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:Zf,meta:F(Gu)})),rewards:X(j(ws)),blockTime:F(k())}))),Ep=xe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),signatures:j(N()),blockTime:F(k())}))),nd=xe(F(O({slot:k(),meta:F(Gu),blockTime:X(F(k())),transaction:Zf,version:X(Bo)}))),lc=xe(F(O({slot:k(),transaction:Em,meta:F(eh),blockTime:X(F(k())),version:X(Bo)}))),d0=Pt(O({blockhash:N(),feeCalculator:O({lamportsPerSignature:k()})})),f0=Pt(O({blockhash:N(),lastValidBlockHeight:k()})),h0=Pt($t()),p0=O({slot:k(),numTransactions:k(),numSlots:k(),samplePeriodSecs:k()}),y0=xe(j(p0)),g0=Pt(F(O({feeCalculator:O({lamportsPerSignature:k()})}))),m0=xe(N()),b0=xe(N()),w0=O({err:bs,logs:j(N()),signature:N()}),k0=O({result:qu(w0),subscription:k()}),S0={"solana-client":"js/0.0.0-development"};class v0{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const l={};return async u=>{const{commitment:d,config:m}=yt(u),y=this._buildArgs([],d,void 0,m),S=vp(y);return l[S]=l[S]??(async()=>{try{const p=await this._rpcRequest("getBlockHeight",y),w=ne(p,xe(k()));if("error"in w)throw new pe(w.error,"failed to get block height information");return w.result}finally{delete l[S]}})(),await l[S]}})();let n,i,s,o,a,c;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,n=t.wsEndpoint,i=t.httpHeaders,s=t.fetch,o=t.fetchMiddleware,a=t.disableRetryOnRateLimit,c=t.httpAgent),this._rpcEndpoint=a1(e),this._rpcWsEndpoint=n||o1(e),this._rpcClient=k1(e,i,s,o,a,c),this._rpcRequest=S1(this._rpcClient),this._rpcBatchRequest=v1(this._rpcClient),this._rpcWebSocket=new n1(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:n,config:i}=yt(t),s=this._buildArgs([e.toBase58()],n,void 0,i),o=await this._rpcRequest("getBalance",s),a=ne(o,Pt(k()));if("error"in a)throw new pe(a.error,`failed to get balance for ${e.toBase58()}`);return a.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+n)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),n=ne(t,xe(F(k())));if("error"in n)throw new pe(n.error,`failed to get block time for slot ${e}`);return n.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=ne(e,xe(k()));if("error"in t)throw new pe(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=ne(e,T1);if("error"in t)throw new pe(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};const n=await this._rpcRequest("getSupply",[t]),i=ne(n,O1);if("error"in i)throw new pe(i.error,"failed to get supply");return i.result}async getTokenSupply(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenSupply",n),s=ne(i,Pt(zd));if("error"in s)throw new pe(s.error,"failed to get token supply");return s.result}async getTokenAccountBalance(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenAccountBalance",n),s=ne(i,Pt(zd));if("error"in s)throw new pe(s.error,"failed to get token account balance");return s.result}async getTokenAccountsByOwner(e,t,n){const{commitment:i,config:s}=yt(n);let o=[e.toBase58()];"mint"in t?o.push({mint:t.mint.toBase58()}):o.push({programId:t.programId.toBase58()});const a=this._buildArgs(o,i,"base64",s),c=await this._rpcRequest("getTokenAccountsByOwner",a),l=ne(c,x1);if("error"in l)throw new pe(l.error,`failed to get token accounts owned by account ${e.toBase58()}`);return l.result}async getParsedTokenAccountsByOwner(e,t,n){let i=[e.toBase58()];"mint"in t?i.push({mint:t.mint.toBase58()}):i.push({programId:t.programId.toBase58()});const s=this._buildArgs(i,n,"jsonParsed"),o=await this._rpcRequest("getTokenAccountsByOwner",s),a=ne(o,C1);if("error"in a)throw new pe(a.error,`failed to get token accounts owned by account ${e.toBase58()}`);return a.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},n=t.filter||t.commitment?[t]:[],i=await this._rpcRequest("getLargestAccounts",n),s=ne(i,M1);if("error"in s)throw new pe(s.error,"failed to get largest accounts");return s.result}async getTokenLargestAccounts(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenLargestAccounts",n),s=ne(i,B1);if("error"in s)throw new pe(s.error,"failed to get token largest accounts");return s.result}async getAccountInfoAndContext(e,t){const{commitment:n,config:i}=yt(t),s=this._buildArgs([e.toBase58()],n,"base64",i),o=await this._rpcRequest("getAccountInfo",s),a=ne(o,Pt(F(_a)));if("error"in a)throw new pe(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getParsedAccountInfo(e,t){const{commitment:n,config:i}=yt(t),s=this._buildArgs([e.toBase58()],n,"jsonParsed",i),o=await this._rpcRequest("getAccountInfo",s),a=ne(o,Pt(F(Vd)));if("error"in a)throw new pe(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(n){throw new Error("failed to get info about account "+e.toBase58()+": "+n)}}async getMultipleParsedAccounts(e,t){const{commitment:n,config:i}=yt(t),s=e.map(l=>l.toBase58()),o=this._buildArgs([s],n,"jsonParsed",i),a=await this._rpcRequest("getMultipleAccounts",o),c=ne(a,Pt(j(F(Vd))));if("error"in c)throw new pe(c.error,`failed to get info for accounts ${s}`);return c.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:n,config:i}=yt(t),s=e.map(l=>l.toBase58()),o=this._buildArgs([s],n,"base64",i),a=await this._rpcRequest("getMultipleAccounts",o),c=ne(a,Pt(j(F(_a))));if("error"in c)throw new pe(c.error,`failed to get info for accounts ${s}`);return c.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,n){const{commitment:i,config:s}=yt(t),o=this._buildArgs([e.toBase58()],i,void 0,{...s,epoch:n??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getStakeActivation",o),c=ne(a,xe($1));if("error"in c)throw new pe(c.error,`failed to get Stake Activation ${e.toBase58()}`);return c.result}async getProgramAccounts(e,t){const{commitment:n,config:i}=yt(t),{encoding:s,...o}=i||{},a=this._buildArgs([e.toBase58()],n,s||"base64",o),c=await this._rpcRequest("getProgramAccounts",a),l=j(L1),u=o.withContext===!0?ne(c,Pt(l)):ne(c,xe(l));if("error"in u)throw new pe(u.error,`failed to get accounts owned by program ${e.toBase58()}`);return u.result}async getParsedProgramAccounts(e,t){const{commitment:n,config:i}=yt(t),s=this._buildArgs([e.toBase58()],n,"jsonParsed",i),o=await this._rpcRequest("getProgramAccounts",s),a=ne(o,xe(j(N1)));if("error"in a)throw new pe(a.error,`failed to get accounts owned by program ${e.toBase58()}`);return a.result}async confirmTransaction(e,t){var s;let n;if(typeof e=="string")n=e;else{const o=e;if((s=o.abortSignal)!=null&&s.aborted)return Promise.reject(o.abortSignal.reason);n=o.signature}let i;try{i=me.decode(n)}catch{throw new Error("signature must be base58 encoded: "+n)}return Ge(i.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:n}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,n)=>{e!=null&&(e.aborted?n(e.reason):e.addEventListener("abort",()=>{n(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let n,i,s=!1;const o=new Promise((c,l)=>{try{n=this.onSignature(t,(d,m)=>{n=void 0;const y={context:m,value:d};c({__type:Gr.PROCESSED,response:y})},e);const u=new Promise(d=>{n==null?d():i=this._onSubscriptionStateChange(n,m=>{m==="subscribed"&&d()})});(async()=>{if(await u,s)return;const d=await this.getSignatureStatus(t);if(s||d==null)return;const{context:m,value:y}=d;if(y!=null)if(y!=null&&y.err)l(y.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(y.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(y.confirmationStatus==="processed"||y.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}s=!0,c({__type:Gr.PROCESSED,response:{context:m,value:y}})}})()}catch(u){l(u)}});return{abortConfirmation:()=>{i&&(i(),i=void 0),n!=null&&(this.removeSignatureListener(n),n=void 0)},confirmationPromise:o}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:n,signature:i}}){let s=!1;const o=new Promise(d=>{const m=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let y=await m();if(!s){for(;y<=n;)if(await zi(1e3),s||(y=await m(),s))return;d({__type:Gr.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:a,confirmationPromise:c}=this.getTransactionConfirmationPromise({commitment:e,signature:i}),l=this.getCancellationPromise(t);let u;try{const d=await Promise.race([l,c,o]);if(d.__type===Gr.PROCESSED)u=d.response;else throw new Gf(i)}finally{s=!0,a()}return u}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:n,nonceAccountPubkey:i,nonceValue:s,signature:o}}){let a=!1;const c=new Promise(y=>{let S=s,p=null;const w=async()=>{try{const{context:v,value:E}=await this.getNonceAndContext(i,{commitment:e,minContextSlot:n});return p=v.slot,E==null?void 0:E.nonce}catch{return S}};(async()=>{if(S=await w(),!a)for(;;){if(s!==S){y({__type:Gr.NONCE_INVALID,slotInWhichNonceDidAdvance:p});return}if(await zi(2e3),a||(S=await w(),a))return}})()}),{abortConfirmation:l,confirmationPromise:u}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),d=this.getCancellationPromise(t);let m;try{const y=await Promise.race([d,u,c]);if(y.__type===Gr.PROCESSED)m=y.response;else{let S;for(;;){const p=await this.getSignatureStatus(o);if(p==null)break;if(p.context.slot<(y.slotInWhichNonceDidAdvance??n)){await zi(400);continue}S=p;break}if(S!=null&&S.value){const p=e||"finalized",{confirmationStatus:w}=S.value;switch(p){case"processed":case"recent":if(w!=="processed"&&w!=="confirmed"&&w!=="finalized")throw new Ns(o);break;case"confirmed":case"single":case"singleGossip":if(w!=="confirmed"&&w!=="finalized")throw new Ns(o);break;case"finalized":case"max":case"root":if(w!=="finalized")throw new Ns(o);break;default:(v=>{})(p)}m={context:S.context,value:{err:S.value.err}}}else throw new Ns(o)}}finally{a=!0,l()}return m}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let n;const i=new Promise(c=>{let l=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{l=this._confirmTransactionInitialTimeout||3e4;break}}n=setTimeout(()=>c({__type:Gr.TIMED_OUT,timeoutMs:l}),l)}),{abortConfirmation:s,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let a;try{const c=await Promise.race([o,i]);if(c.__type===Gr.PROCESSED)a=c.response;else throw new Hf(t,c.timeoutMs/1e3)}finally{clearTimeout(n),s()}return a}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=ne(e,xe(j(J1)));if("error"in t)throw new pe(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getVoteAccounts",t),i=ne(n,Q1);if("error"in i)throw new pe(i.error,"failed to get vote accounts");return i.result}async getSlot(e){const{commitment:t,config:n}=yt(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getSlot",i),o=ne(s,xe(k()));if("error"in o)throw new pe(o.error,"failed to get slot");return o.result}async getSlotLeader(e){const{commitment:t,config:n}=yt(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getSlotLeader",i),o=ne(s,xe(N()));if("error"in o)throw new pe(o.error,"failed to get slot leader");return o.result}async getSlotLeaders(e,t){const n=[e,t],i=await this._rpcRequest("getSlotLeaders",n),s=ne(i,xe(j(Dt)));if("error"in s)throw new pe(s.error,"failed to get slot leaders");return s.result}async getSignatureStatus(e,t){const{context:n,value:i}=await this.getSignatureStatuses([e],t);Ge(i.length===1);const s=i[0];return{context:n,value:s}}async getSignatureStatuses(e,t){const n=[e];t&&n.push(t);const i=await this._rpcRequest("getSignatureStatuses",n),s=ne(i,e0);if("error"in s)throw new pe(s.error,"failed to get signature status");return s.result}async getTransactionCount(e){const{commitment:t,config:n}=yt(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getTransactionCount",i),o=ne(s,xe(k()));if("error"in o)throw new pe(o.error,"failed to get transaction count");return o.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getInflationGovernor",t),i=ne(n,_1);if("error"in i)throw new pe(i.error,"failed to get inflation");return i.result}async getInflationReward(e,t,n){const{commitment:i,config:s}=yt(n),o=this._buildArgs([e.map(l=>l.toBase58())],i,void 0,{...s,epoch:t??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getInflationReward",o),c=ne(a,l1);if("error"in c)throw new pe(c.error,"failed to get inflation reward");return c.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=ne(e,A1);if("error"in t)throw new pe(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:n}=yt(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getEpochInfo",i),o=ne(s,E1);if("error"in o)throw new pe(o.error,"failed to get epoch info");return o.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=ne(e,P1);if("error"in t)throw new pe(t.error,"failed to get epoch schedule");const n=t.result;return new gm(n.slotsPerEpoch,n.leaderScheduleSlotOffset,n.warmup,n.firstNormalEpoch,n.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=ne(e,R1);if("error"in t)throw new pe(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const n=this._buildArgs([e],t),i=await this._rpcRequest("getMinimumBalanceForRentExemption",n),s=ne(i,t0);return"error"in s?(console.warn("Unable to fetch minimum balance for rent exemption"),0):s.result}async getRecentBlockhashAndContext(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getRecentBlockhash",t),i=ne(n,d0);if("error"in i)throw new pe(i.error,"failed to get recent blockhash");return i.result}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),n=ne(t,y0);if("error"in n)throw new pe(n.error,"failed to get recent performance samples");return n.result}async getFeeCalculatorForBlockhash(e,t){const n=this._buildArgs([e],t),i=await this._rpcRequest("getFeeCalculatorForBlockhash",n),s=ne(i,g0);if("error"in s)throw new pe(s.error,"failed to get fee calculator");const{context:o,value:a}=s.result;return{context:o,value:a!==null?a.feeCalculator:null}}async getFeeForMessage(e,t){const n=Me(e.serialize()).toString("base64"),i=this._buildArgs([n],t),s=await this._rpcRequest("getFeeForMessage",i),o=ne(s,Pt(F(k())));if("error"in o)throw new pe(o.error,"failed to get fee for message");if(o.result===null)throw new Error("invalid blockhash");return o.result}async getRecentPrioritizationFees(e){var o;const t=(o=e==null?void 0:e.lockedWritableAccounts)==null?void 0:o.map(a=>a.toBase58()),n=t!=null&&t.length?[t]:[],i=await this._rpcRequest("getRecentPrioritizationFees",n),s=ne(i,I1);if("error"in s)throw new pe(s.error,"failed to get recent prioritization fees");return s.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:n}=yt(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getLatestBlockhash",i),o=ne(s,f0);if("error"in o)throw new pe(o.error,"failed to get latest blockhash");return o.result}async isBlockhashValid(e,t){const{commitment:n,config:i}=yt(t),s=this._buildArgs([e],n,void 0,i),o=await this._rpcRequest("isBlockhashValid",s),a=ne(o,h0);if("error"in a)throw new pe(a.error,"failed to determine if the blockhash `"+e+"`is valid");return a.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=ne(e,xe(b1));if("error"in t)throw new pe(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=ne(e,xe(N()));if("error"in t)throw new pe(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:n,config:i}=yt(t),s=this._buildArgsAtLeastConfirmed([e],n,void 0,i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=ne(o,o0);if("error"in a)throw a.error;return a.result}case"none":{const a=ne(o,s0);if("error"in a)throw a.error;return a.result}default:{const a=ne(o,i0);if("error"in a)throw a.error;const{result:c}=a;return c?{...c,transactions:c.transactions.map(({transaction:l,meta:u,version:d})=>({meta:u,transaction:{...l,message:td(d,l.message)},version:d}))}:null}}}catch(a){throw new pe(a,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:n,config:i}=yt(t),s=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=ne(o,c0);if("error"in a)throw a.error;return a.result}case"none":{const a=ne(o,u0);if("error"in a)throw a.error;return a.result}default:{const a=ne(o,a0);if("error"in a)throw a.error;return a.result}}}catch(a){throw new pe(a,"failed to get block")}}async getBlockProduction(e){let t,n;if(typeof e=="string")n=e;else if(e){const{commitment:a,...c}=e;n=a,t=c}const i=this._buildArgs([],n,"base64",t),s=await this._rpcRequest("getBlockProduction",i),o=ne(s,w1);if("error"in o)throw new pe(o.error,"failed to get block production information");return o.result}async getTransaction(e,t){const{commitment:n,config:i}=yt(t),s=this._buildArgsAtLeastConfirmed([e],n,void 0,i),o=await this._rpcRequest("getTransaction",s),a=ne(o,nd);if("error"in a)throw new pe(a.error,"failed to get transaction");const c=a.result;return c&&{...c,transaction:{...c.transaction,message:td(c.version,c.transaction.message)}}}async getParsedTransaction(e,t){const{commitment:n,config:i}=yt(t),s=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",i),o=await this._rpcRequest("getTransaction",s),a=ne(o,lc);if("error"in a)throw new pe(a.error,"failed to get transaction");return a.result}async getParsedTransactions(e,t){const{commitment:n,config:i}=yt(t),s=e.map(c=>{const l=this._buildArgsAtLeastConfirmed([c],n,"jsonParsed",i);return{methodName:"getTransaction",args:l}});return(await this._rpcBatchRequest(s)).map(c=>{const l=ne(c,lc);if("error"in l)throw new pe(l.error,"failed to get transactions");return l.result})}async getTransactions(e,t){const{commitment:n,config:i}=yt(t),s=e.map(c=>{const l=this._buildArgsAtLeastConfirmed([c],n,void 0,i);return{methodName:"getTransaction",args:l}});return(await this._rpcBatchRequest(s)).map(c=>{const l=ne(c,nd);if("error"in l)throw new pe(l.error,"failed to get transactions");const u=l.result;return u&&{...u,transaction:{...u.transaction,message:td(u.version,u.transaction.message)}}})}async getConfirmedBlock(e,t){const n=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getConfirmedBlock",n),s=ne(i,l0);if("error"in s)throw new pe(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");const a={...o,transactions:o.transactions.map(({transaction:c,meta:l})=>{const u=new Sr(c.message);return{meta:l,transaction:{...c,message:u}}})};return{...a,transactions:a.transactions.map(({transaction:c,meta:l})=>({meta:l,transaction:Ze.populate(c.message,c.signatures)}))}}async getBlocks(e,t,n){const i=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],n),s=await this._rpcRequest("getBlocks",i),o=ne(s,xe(j(k())));if("error"in o)throw new pe(o.error,"failed to get blocks");return o.result}async getBlockSignatures(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getBlock",n),s=ne(i,Ep);if("error"in s)throw new pe(s.error,"failed to get block");const o=s.result;if(!o)throw new Error("Block "+e+" not found");return o}async getConfirmedBlockSignatures(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getConfirmedBlock",n),s=ne(i,Ep);if("error"in s)throw new pe(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");return o}async getConfirmedTransaction(e,t){const n=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getConfirmedTransaction",n),s=ne(i,nd);if("error"in s)throw new pe(s.error,"failed to get transaction");const o=s.result;if(!o)return o;const a=new Sr(o.transaction.message),c=o.transaction.signatures;return{...o,transaction:Ze.populate(a,c)}}async getParsedConfirmedTransaction(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),i=await this._rpcRequest("getConfirmedTransaction",n),s=ne(i,lc);if("error"in s)throw new pe(s.error,"failed to get confirmed transaction");return s.result}async getParsedConfirmedTransactions(e,t){const n=e.map(o=>{const a=this._buildArgsAtLeastConfirmed([o],t,"jsonParsed");return{methodName:"getConfirmedTransaction",args:a}});return(await this._rpcBatchRequest(n)).map(o=>{const a=ne(o,lc);if("error"in a)throw new pe(a.error,"failed to get confirmed transactions");return a.result})}async getConfirmedSignaturesForAddress(e,t,n){let i={},s=await this.getFirstAvailableBlock();for(;!("until"in i)&&(t--,!(t<=0||t<s));)try{const c=await this.getConfirmedBlockSignatures(t,"finalized");c.signatures.length>0&&(i.until=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}let o=await this.getSlot("finalized");for(;!("before"in i)&&(n++,!(n>o));)try{const c=await this.getConfirmedBlockSignatures(n);c.signatures.length>0&&(i.before=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}return(await this.getConfirmedSignaturesForAddress2(e,i)).map(c=>c.signature)}async getConfirmedSignaturesForAddress2(e,t,n){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),s=await this._rpcRequest("getConfirmedSignaturesForAddress2",i),o=ne(s,D1);if("error"in o)throw new pe(o.error,"failed to get confirmed signatures for address");return o.result}async getSignaturesForAddress(e,t,n){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),s=await this._rpcRequest("getSignaturesForAddress",i),o=ne(s,z1);if("error"in o)throw new pe(o.error,"failed to get signatures for address");return o.result}async getAddressLookupTable(e,t){const{context:n,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=new Dd({key:e,state:Dd.deserialize(i.data)})),{context:n,value:s}}async getNonceAndContext(e,t){const{context:n,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=ju.fromAccountData(i.data)),{context:n,value:s}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+n)})}async requestAirdrop(e,t){const n=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),i=ne(n,m0);if("error"in i)throw new pe(i.error,`airdrop to ${e.toBase58()} failed`);return i.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await zi(100);const n=Date.now()-this._blockhashInfo.lastFetch>=bm;if(this._blockhashInfo.latestBlockhash!==null&&!n)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,n=t?t.blockhash:null;for(let i=0;i<50;i++){const s=await this.getLatestBlockhash("finalized");if(n!==s.blockhash)return this._blockhashInfo={latestBlockhash:s,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},s;await zi(hm/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:n}=yt(e),i=this._buildArgs([],t,"base64",n),s=await this._rpcRequest("getStakeMinimumDelegation",i),o=ne(s,Pt(k()));if("error"in o)throw new pe(o.error,"failed to get stake minimum delegation");return o.result}async simulateTransaction(e,t,n){if("message"in e){const p=e.serialize(),w=L.Buffer.from(p).toString("base64");if(Array.isArray(t)||n!==void 0)throw new Error("Invalid arguments");const v=t||{};v.encoding="base64","commitment"in v||(v.commitment=this.commitment);const E=[w,v],P=await this._rpcRequest("simulateTransaction",E),K=ne(P,Ap);if("error"in K)throw new Error("failed to simulate transaction: "+K.error.message);return K.result}let i;if(e instanceof Ze){let S=e;i=new Ze,i.feePayer=S.feePayer,i.instructions=e.instructions,i.nonceInfo=S.nonceInfo,i.signatures=S.signatures}else i=Ze.populate(e),i._message=i._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");const s=t;if(i.nonceInfo&&s)i.sign(...s);else{let S=this._disableBlockhashCaching;for(;;){const p=await this._blockhashWithExpiryBlockHeight(S);if(i.lastValidBlockHeight=p.lastValidBlockHeight,i.recentBlockhash=p.blockhash,!s)break;if(i.sign(...s),!i.signature)throw new Error("!signature");const w=i.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(w)&&!this._blockhashInfo.transactionSignatures.includes(w)){this._blockhashInfo.simulatedSignatures.push(w);break}else S=!0}}const o=i._compile(),a=o.serialize(),l=i._serialize(a).toString("base64"),u={encoding:"base64",commitment:this.commitment};if(n){const S=(Array.isArray(n)?n:o.nonProgramIds()).map(p=>p.toBase58());u.accounts={encoding:"base64",addresses:S}}s&&(u.sigVerify=!0);const d=[l,u],m=await this._rpcRequest("simulateTransaction",d),y=ne(m,Ap);if("error"in y){let S;if("data"in y.error&&(S=y.error.data.logs,S&&Array.isArray(S))){const p=`
    `,w=p+S.join(p);console.error(y.error.message,w)}throw new $d("failed to simulate transaction: "+y.error.message,S)}return y.result}async sendTransaction(e,t,n){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const o=e.serialize();return await this.sendRawTransaction(o,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");const i=t;if(e.nonceInfo)e.sign(...i);else{let o=this._disableBlockhashCaching;for(;;){const a=await this._blockhashWithExpiryBlockHeight(o);if(e.lastValidBlockHeight=a.lastValidBlockHeight,e.recentBlockhash=a.blockhash,e.sign(...i),!e.signature)throw new Error("!signature");const c=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(c))o=!0;else{this._blockhashInfo.transactionSignatures.push(c);break}}}const s=e.serialize();return await this.sendRawTransaction(s,n)}async sendRawTransaction(e,t){const n=Me(e).toString("base64");return await this.sendEncodedTransaction(n,t)}async sendEncodedTransaction(e,t){const n={encoding:"base64"},i=t&&t.skipPreflight,s=t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(n.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(n.minContextSlot=t.minContextSlot),i&&(n.skipPreflight=i),s&&(n.preflightCommitment=s);const o=[e,n],a=await this._rpcRequest("sendTransaction",o),c=ne(a,b0);if("error"in c){let l;throw"data"in c.error&&(l=c.error.data.logs),new $d("failed to send transaction: "+c.error.message,l)}return c.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,n])=>{this._setSubscription(t,{...n,state:"pending"})})}_setSubscription(e,t){var i;const n=(i=this._subscriptionsByHash[e])==null?void 0:i.state;if(this._subscriptionsByHash[e]=t,n!==t.state){const s=this._subscriptionStateChangeCallbacksByHash[e];s&&s.forEach(o=>{try{o(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){const n=this._subscriptionHashByClientSubscriptionId[e];if(n==null)return()=>{};const i=this._subscriptionStateChangeCallbacksByHash[n]||=new Set;return i.add(t),()=>{i.delete(t),i.size===0&&delete this._subscriptionStateChangeCallbacksByHash[n]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(n){n instanceof Error&&console.log(`Error when closing socket connection: ${n.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async n=>{const i=this._subscriptionsByHash[n];if(i!==void 0)switch(i.state){case"pending":case"unsubscribed":if(i.callbacks.size===0){delete this._subscriptionsByHash[n],i.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[i.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:s,method:o}=i;try{this._setSubscription(n,{...i,state:"subscribing"});const a=await this._rpcWebSocket.call(o,s);this._setSubscription(n,{...i,serverSubscriptionId:a,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[a]=i.callbacks,await this._updateSubscriptions()}catch(a){if(a instanceof Error&&console.error(`${o} error for argument`,s,a.message),!t())return;this._setSubscription(n,{...i,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":i.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:s,unsubscribeMethod:o}=i;if(this._subscriptionsAutoDisposedByRpc.has(s))this._subscriptionsAutoDisposedByRpc.delete(s);else{this._setSubscription(n,{...i,state:"unsubscribing"}),this._setSubscription(n,{...i,state:"unsubscribing"});try{await this._rpcWebSocket.call(o,[s])}catch(a){if(a instanceof Error&&console.error(`${o} error:`,a.message),!t())return;this._setSubscription(n,{...i,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(n,{...i,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){const n=this._subscriptionCallbacksByServerSubscriptionId[e];n!==void 0&&n.forEach(i=>{try{i(...t)}catch(s){console.error(s)}})}_wsOnAccountNotification(e){const{result:t,subscription:n}=ne(e,W1);this._handleServerNotification(n,[t.value,t.context])}_makeSubscription(e,t){const n=this._nextClientSubscriptionId++,i=vp([e.method,t],!0),s=this._subscriptionsByHash[i];return s===void 0?this._subscriptionsByHash[i]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:s.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[n]=i,this._subscriptionDisposeFunctionsByClientSubscriptionId[n]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[n],delete this._subscriptionHashByClientSubscriptionId[n];const o=this._subscriptionsByHash[i];Ge(o!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${n}`),o.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),n}onAccountChange(e,t,n){const i=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64");return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},i)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:n}=ne(e,U1);this._handleServerNotification(n,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,n,i){const s=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64",i?{filters:i}:void 0);return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},s)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,n){const i=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],n||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},i)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:n}=ne(e,k0);this._handleServerNotification(n,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:n}=ne(e,j1);this._handleServerNotification(n,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:n}=ne(e,G1);this._handleServerNotification(n,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const n=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];n?await n():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,n,i){const s=t||this._commitment;if(s||n||i){let o={};n&&(o.encoding=n),s&&(o.commitment=s),i&&(o=Object.assign(o,i)),e.push(o)}return e}_buildArgsAtLeastConfirmed(e,t,n,i){const s=t||this._commitment;if(s&&!["confirmed","finalized"].includes(s))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,n,i)}_wsOnSignatureNotification(e){const{result:t,subscription:n}=ne(e,H1);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(n),this._handleServerNotification(n,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,n){const i=this._buildArgs([e],n||this._commitment||"finalized"),s=this._makeSubscription({callback:(o,a)=>{if(o.type==="status"){t(o.result,a);try{this.removeSignatureListener(s)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},i);return s}onSignatureWithOptions(e,t,n){const{commitment:i,...s}={...n,commitment:n&&n.commitment||this._commitment||"finalized"},o=this._buildArgs([e],i,void 0,s),a=this._makeSubscription({callback:(c,l)=>{t(c,l);try{this.removeSignatureListener(a)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return a}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:n}=ne(e,Y1);this._handleServerNotification(n,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class Js{constructor(e){this._keypair=void 0,this._keypair=e??wp()}static generate(){return new Js(wp())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const n=e.slice(32,64);if(!t||!t.skipValidation){const i=e.slice(0,32),s=jc(i);for(let o=0;o<32;o++)if(n[o]!==s[o])throw new Error("provided secretKey is invalid")}return new Js({publicKey:n,secretKey:e})}static fromSeed(e){const t=jc(e),n=new Uint8Array(64);return n.set(e),n.set(t,32),new Js({publicKey:t,secretKey:n})}get publicKey(){return new ie(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}const Qr=Object.freeze({CreateLookupTable:{index:0,layout:C([M("instruction"),ao("recentSlot"),te("bumpSeed")])},FreezeLookupTable:{index:1,layout:C([M("instruction")])},ExtendLookupTable:{index:2,layout:C([M("instruction"),ao(),Oe($e(),Kt(M(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:C([M("instruction")])},CloseLookupTable:{index:4,layout:C([M("instruction")])}});class _0{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Qr))if(o.index==n){i=s;break}if(!i)throw new Error("Invalid Instruction. Should be a LookupTable Instruction");return i}static decodeCreateLookupTable(e){this.checkProgramId(e.programId),this.checkKeysLength(e.keys,4);const{recentSlot:t}=Xe(Qr.CreateLookupTable,e.data);return{authority:e.keys[1].pubkey,payer:e.keys[2].pubkey,recentSlot:Number(t)}}static decodeExtendLookupTable(e){if(this.checkProgramId(e.programId),e.keys.length<2)throw new Error(`invalid instruction; found ${e.keys.length} keys, expected at least 2`);const{addresses:t}=Xe(Qr.ExtendLookupTable,e.data);return{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,payer:e.keys.length>2?e.keys[2].pubkey:void 0,addresses:t.map(n=>new ie(n))}}static decodeCloseLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,3),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,recipient:e.keys[2].pubkey}}static decodeFreezeLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static decodeDeactivateLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(th.programId))throw new Error("invalid instruction; programId is not AddressLookupTable Program")}static checkKeysLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}class th{constructor(){}static createLookupTable(e){const[t,n]=ie.findProgramAddressSync([e.authority.toBuffer(),Ba(BigInt(e.recentSlot),8)],this.programId),i=Qr.CreateLookupTable,s=We(i,{recentSlot:BigInt(e.recentSlot),bumpSeed:n}),o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:sn.programId,isSigner:!1,isWritable:!1}];return[new ut({programId:this.programId,keys:o,data:s}),t]}static freezeLookupTable(e){const t=Qr.FreezeLookupTable,n=We(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new ut({programId:this.programId,keys:i,data:n})}static extendLookupTable(e){const t=Qr.ExtendLookupTable,n=We(t,{addresses:e.addresses.map(s=>s.toBytes())}),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return e.payer&&i.push({pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:sn.programId,isSigner:!1,isWritable:!1}),new ut({programId:this.programId,keys:i,data:n})}static deactivateLookupTable(e){const t=Qr.DeactivateLookupTable,n=We(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new ut({programId:this.programId,keys:i,data:n})}static closeLookupTable(e){const t=Qr.CloseLookupTable,n=We(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.recipient,isSigner:!1,isWritable:!0}];return new ut({programId:this.programId,keys:i,data:n})}}th.programId=new ie("AddressLookupTab1e1111111111111111111111111");class A0{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=te("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Cr))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a ComputeBudgetInstruction");return i}static decodeRequestUnits(e){this.checkProgramId(e.programId);const{units:t,additionalFee:n}=Xe(Cr.RequestUnits,e.data);return{units:t,additionalFee:n}}static decodeRequestHeapFrame(e){this.checkProgramId(e.programId);const{bytes:t}=Xe(Cr.RequestHeapFrame,e.data);return{bytes:t}}static decodeSetComputeUnitLimit(e){this.checkProgramId(e.programId);const{units:t}=Xe(Cr.SetComputeUnitLimit,e.data);return{units:t}}static decodeSetComputeUnitPrice(e){this.checkProgramId(e.programId);const{microLamports:t}=Xe(Cr.SetComputeUnitPrice,e.data);return{microLamports:t}}static checkProgramId(e){if(!e.equals(nh.programId))throw new Error("invalid instruction; programId is not ComputeBudgetProgram")}}const Cr=Object.freeze({RequestUnits:{index:0,layout:C([te("instruction"),M("units"),M("additionalFee")])},RequestHeapFrame:{index:1,layout:C([te("instruction"),M("bytes")])},SetComputeUnitLimit:{index:2,layout:C([te("instruction"),M("units")])},SetComputeUnitPrice:{index:3,layout:C([te("instruction"),ao("microLamports")])}});class nh{constructor(){}static requestUnits(e){const t=Cr.RequestUnits,n=We(t,e);return new ut({keys:[],programId:this.programId,data:n})}static requestHeapFrame(e){const t=Cr.RequestHeapFrame,n=We(t,e);return new ut({keys:[],programId:this.programId,data:n})}static setComputeUnitLimit(e){const t=Cr.SetComputeUnitLimit,n=We(t,e);return new ut({keys:[],programId:this.programId,data:n})}static setComputeUnitPrice(e){const t=Cr.SetComputeUnitPrice,n=We(t,{microLamports:BigInt(e.microLamports)});return new ut({keys:[],programId:this.programId,data:n})}}nh.programId=new ie("ComputeBudget111111111111111111111111111111");const Pp=64,Rp=32,Tp=64,Op=C([te("numSignatures"),te("padding"),Ue("signatureOffset"),Ue("signatureInstructionIndex"),Ue("publicKeyOffset"),Ue("publicKeyInstructionIndex"),Ue("messageDataOffset"),Ue("messageDataSize"),Ue("messageInstructionIndex")]);class Hu{constructor(){}static createInstructionWithPublicKey(e){const{publicKey:t,message:n,signature:i,instructionIndex:s}=e;Ge(t.length===Rp,`Public Key must be ${Rp} bytes but received ${t.length} bytes`),Ge(i.length===Tp,`Signature must be ${Tp} bytes but received ${i.length} bytes`);const o=Op.span,a=o+t.length,c=a+i.length,l=1,u=L.Buffer.alloc(c+n.length),d=s??65535;return Op.encode({numSignatures:l,padding:0,signatureOffset:a,signatureInstructionIndex:d,publicKeyOffset:o,publicKeyInstructionIndex:d,messageDataOffset:c,messageDataSize:n.length,messageInstructionIndex:d},u),u.fill(t,o),u.fill(i,a),u.fill(n,c),new ut({keys:[],programId:Hu.programId,data:u})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:n,instructionIndex:i}=e;Ge(t.length===Pp,`Private key must be ${Pp} bytes but received ${t.length} bytes`);try{const s=Js.fromSecretKey(t),o=s.publicKey.toBytes(),a=jf(n,s.secretKey);return this.createInstructionWithPublicKey({publicKey:o,message:n,signature:a,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}Hu.programId=new ie("Ed25519SigVerify111111111111111111111111111");const I0=(r,e)=>{const t=Ei.sign(r,e);return[t.toCompactRawBytes(),t.recovery]};Ei.utils.isValidPrivateKey;const E0=Ei.getPublicKey,Bp=32,rd=20,xp=64,P0=11,id=C([te("numSignatures"),Ue("signatureOffset"),te("signatureInstructionIndex"),Ue("ethAddressOffset"),te("ethAddressInstructionIndex"),Ue("messageDataOffset"),Ue("messageDataSize"),te("messageInstructionIndex"),ge(20,"ethAddress"),ge(64,"signature"),te("recoveryId")]);class Qs{constructor(){}static publicKeyToEthAddress(e){Ge(e.length===xp,`Public key must be ${xp} bytes but received ${e.length} bytes`);try{return L.Buffer.from(Dc(Me(e))).slice(-rd)}catch(t){throw new Error(`Error constructing Ethereum address: ${t}`)}}static createInstructionWithPublicKey(e){const{publicKey:t,message:n,signature:i,recoveryId:s,instructionIndex:o}=e;return Qs.createInstructionWithEthAddress({ethAddress:Qs.publicKeyToEthAddress(t),message:n,signature:i,recoveryId:s,instructionIndex:o})}static createInstructionWithEthAddress(e){const{ethAddress:t,message:n,signature:i,recoveryId:s,instructionIndex:o=0}=e;let a;typeof t=="string"?t.startsWith("0x")?a=L.Buffer.from(t.substr(2),"hex"):a=L.Buffer.from(t,"hex"):a=t,Ge(a.length===rd,`Address must be ${rd} bytes but received ${a.length} bytes`);const c=1+P0,l=c,u=c+a.length,d=u+i.length+1,m=1,y=L.Buffer.alloc(id.span+n.length);return id.encode({numSignatures:m,signatureOffset:u,signatureInstructionIndex:o,ethAddressOffset:l,ethAddressInstructionIndex:o,messageDataOffset:d,messageDataSize:n.length,messageInstructionIndex:o,signature:Me(i),ethAddress:Me(a),recoveryId:s},y),y.fill(Me(n),id.span),new ut({keys:[],programId:Qs.programId,data:y})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:n,instructionIndex:i}=e;Ge(t.length===Bp,`Private key must be ${Bp} bytes but received ${t.length} bytes`);try{const s=Me(t),o=E0(s,!1).slice(1),a=L.Buffer.from(Dc(Me(n))),[c,l]=I0(a,s);return this.createInstructionWithPublicKey({publicKey:o,message:n,signature:c,recoveryId:l,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}Qs.programId=new ie("KeccakSecp256k11111111111111111111111111111");var Rm;const Tm=new ie("StakeConfig11111111111111111111111111111111");class Om{constructor(e,t){this.staker=void 0,this.withdrawer=void 0,this.staker=e,this.withdrawer=t}}class Va{constructor(e,t,n){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=n}}Rm=Va;Va.default=new Rm(0,0,ie.default);class R0{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Jt))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a StakeInstruction");return i}static decodeInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t,lockup:n}=Xe(Jt.Initialize,e.data);return{stakePubkey:e.keys[0].pubkey,authorized:new Om(new ie(t.staker),new ie(t.withdrawer)),lockup:new Va(n.unixTimestamp,n.epoch,new ie(n.custodian))}}static decodeDelegate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,6),Xe(Jt.Delegate,e.data),{stakePubkey:e.keys[0].pubkey,votePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[5].pubkey}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,stakeAuthorizationType:n}=Xe(Jt.Authorize,e.data),i={stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new ie(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(i.custodianPubkey=e.keys[3].pubkey),i}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{newAuthorized:t,stakeAuthorizationType:n,authoritySeed:i,authorityOwner:s}=Xe(Jt.AuthorizeWithSeed,e.data),o={stakePubkey:e.keys[0].pubkey,authorityBase:e.keys[1].pubkey,authoritySeed:i,authorityOwner:new ie(s),newAuthorizedPubkey:new ie(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(o.custodianPubkey=e.keys[3].pubkey),o}static decodeSplit(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Xe(Jt.Split,e.data);return{stakePubkey:e.keys[0].pubkey,splitStakePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[2].pubkey,lamports:t}}static decodeMerge(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Xe(Jt.Merge,e.data),{stakePubkey:e.keys[0].pubkey,sourceStakePubKey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Xe(Jt.Withdraw,e.data),n={stakePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t};return e.keys.length>5&&(n.custodianPubkey=e.keys[5].pubkey),n}static decodeDeactivate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Xe(Jt.Deactivate,e.data),{stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static checkProgramId(e){if(!e.equals(Yu.programId))throw new Error("invalid instruction; programId is not StakeProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const Jt=Object.freeze({Initialize:{index:0,layout:C([M("instruction"),OA(),BA()])},Authorize:{index:1,layout:C([M("instruction"),$e("newAuthorized"),M("stakeAuthorizationType")])},Delegate:{index:2,layout:C([M("instruction")])},Split:{index:3,layout:C([M("instruction"),De("lamports")])},Withdraw:{index:4,layout:C([M("instruction"),De("lamports")])},Deactivate:{index:5,layout:C([M("instruction")])},Merge:{index:7,layout:C([M("instruction")])},AuthorizeWithSeed:{index:8,layout:C([M("instruction"),$e("newAuthorized"),M("stakeAuthorizationType"),Fi("authoritySeed"),$e("authorityOwner")])}}),T0=Object.freeze({Staker:{index:0},Withdrawer:{index:1}});class Yu{constructor(){}static initialize(e){const{stakePubkey:t,authorized:n,lockup:i}=e,s=i||Va.default,o=Jt.Initialize,a=We(o,{authorized:{staker:Me(n.staker.toBuffer()),withdrawer:Me(n.withdrawer.toBuffer())},lockup:{unixTimestamp:s.unixTimestamp,epoch:s.epoch,custodian:Me(s.custodian.toBuffer())}}),c={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:oo,isSigner:!1,isWritable:!1}],programId:this.programId,data:a};return new ut(c)}static createAccountWithSeed(e){const t=new Ze;t.add(sn.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:n,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:n,authorized:i,lockup:s}))}static createAccount(e){const t=new Ze;t.add(sn.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:n,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:n,authorized:i,lockup:s}))}static delegate(e){const{stakePubkey:t,authorizedPubkey:n,votePubkey:i}=e,s=Jt.Delegate,o=We(s);return new Ze().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:Or,isSigner:!1,isWritable:!1},{pubkey:xc,isSigner:!1,isWritable:!1},{pubkey:Tm,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static authorize(e){const{stakePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:i,stakeAuthorizationType:s,custodianPubkey:o}=e,a=Jt.Authorize,c=We(a,{newAuthorized:Me(i.toBuffer()),stakeAuthorizationType:s.index}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Or,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return o&&l.push({pubkey:o,isSigner:!1,isWritable:!1}),new Ze().add({keys:l,programId:this.programId,data:c})}static authorizeWithSeed(e){const{stakePubkey:t,authorityBase:n,authoritySeed:i,authorityOwner:s,newAuthorizedPubkey:o,stakeAuthorizationType:a,custodianPubkey:c}=e,l=Jt.AuthorizeWithSeed,u=We(l,{newAuthorized:Me(o.toBuffer()),stakeAuthorizationType:a.index,authoritySeed:i,authorityOwner:Me(s.toBuffer())}),d=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:Or,isSigner:!1,isWritable:!1}];return c&&d.push({pubkey:c,isSigner:!1,isWritable:!1}),new Ze().add({keys:d,programId:this.programId,data:u})}static splitInstruction(e){const{stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,lamports:s}=e,o=Jt.Split,a=We(o,{lamports:s});return new ut({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:a})}static split(e){const t=new Ze;return t.add(sn.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:0,space:this.space,programId:this.programId})),t.add(this.splitInstruction(e))}static splitWithSeed(e){const{stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,basePubkey:s,seed:o,lamports:a}=e,c=new Ze;return c.add(sn.allocate({accountPubkey:i,basePubkey:s,seed:o,space:this.space,programId:this.programId})),c.add(this.splitInstruction({stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,lamports:a}))}static merge(e){const{stakePubkey:t,sourceStakePubKey:n,authorizedPubkey:i}=e,s=Jt.Merge,o=We(s);return new Ze().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:Or,isSigner:!1,isWritable:!1},{pubkey:xc,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static withdraw(e){const{stakePubkey:t,authorizedPubkey:n,toPubkey:i,lamports:s,custodianPubkey:o}=e,a=Jt.Withdraw,c=We(a,{lamports:s}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:Or,isSigner:!1,isWritable:!1},{pubkey:xc,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return o&&l.push({pubkey:o,isSigner:!1,isWritable:!1}),new Ze().add({keys:l,programId:this.programId,data:c})}static deactivate(e){const{stakePubkey:t,authorizedPubkey:n}=e,i=Jt.Deactivate,s=We(i);return new Ze().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Or,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:s})}}Yu.programId=new ie("Stake11111111111111111111111111111111111111");Yu.space=200;class Bm{constructor(e,t,n,i){this.nodePubkey=void 0,this.authorizedVoter=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.nodePubkey=e,this.authorizedVoter=t,this.authorizedWithdrawer=n,this.commission=i}}class O0{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Xr))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a VoteInstruction");return i}static decodeInitializeAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,4);const{voteInit:t}=Xe(Xr.InitializeAccount,e.data);return{votePubkey:e.keys[0].pubkey,nodePubkey:e.keys[3].pubkey,voteInit:new Bm(new ie(t.nodePubkey),new ie(t.authorizedVoter),new ie(t.authorizedWithdrawer),t.commission)}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,voteAuthorizationType:n}=Xe(Xr.Authorize,e.data);return{votePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new ie(t),voteAuthorizationType:{index:n}}}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:t,currentAuthorityDerivedKeySeed:n,newAuthorized:i,voteAuthorizationType:s}}=Xe(Xr.AuthorizeWithSeed,e.data);return{currentAuthorityDerivedKeyBasePubkey:e.keys[2].pubkey,currentAuthorityDerivedKeyOwnerPubkey:new ie(t),currentAuthorityDerivedKeySeed:n,newAuthorizedPubkey:new ie(i),voteAuthorizationType:{index:s},votePubkey:e.keys[0].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Xe(Xr.Withdraw,e.data);return{votePubkey:e.keys[0].pubkey,authorizedWithdrawerPubkey:e.keys[2].pubkey,lamports:t,toPubkey:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(xo.programId))throw new Error("invalid instruction; programId is not VoteProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const Xr=Object.freeze({InitializeAccount:{index:0,layout:C([M("instruction"),xA()])},Authorize:{index:1,layout:C([M("instruction"),$e("newAuthorized"),M("voteAuthorizationType")])},Withdraw:{index:3,layout:C([M("instruction"),De("lamports")])},AuthorizeWithSeed:{index:10,layout:C([M("instruction"),CA()])}}),B0=Object.freeze({Voter:{index:0},Withdrawer:{index:1}});class xo{constructor(){}static initializeAccount(e){const{votePubkey:t,nodePubkey:n,voteInit:i}=e,s=Xr.InitializeAccount,o=We(s,{voteInit:{nodePubkey:Me(i.nodePubkey.toBuffer()),authorizedVoter:Me(i.authorizedVoter.toBuffer()),authorizedWithdrawer:Me(i.authorizedWithdrawer.toBuffer()),commission:i.commission}}),a={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:oo,isSigner:!1,isWritable:!1},{pubkey:Or,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:o};return new ut(a)}static createAccount(e){const t=new Ze;return t.add(sn.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}static authorize(e){const{votePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:i,voteAuthorizationType:s}=e,o=Xr.Authorize,a=We(o,{newAuthorized:Me(i.toBuffer()),voteAuthorizationType:s.index}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Or,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return new Ze().add({keys:c,programId:this.programId,data:a})}static authorizeWithSeed(e){const{currentAuthorityDerivedKeyBasePubkey:t,currentAuthorityDerivedKeyOwnerPubkey:n,currentAuthorityDerivedKeySeed:i,newAuthorizedPubkey:s,voteAuthorizationType:o,votePubkey:a}=e,c=Xr.AuthorizeWithSeed,l=We(c,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:Me(n.toBuffer()),currentAuthorityDerivedKeySeed:i,newAuthorized:Me(s.toBuffer()),voteAuthorizationType:o.index}}),u=[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:Or,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return new Ze().add({keys:u,programId:this.programId,data:l})}static withdraw(e){const{votePubkey:t,authorizedWithdrawerPubkey:n,lamports:i,toPubkey:s}=e,o=Xr.Withdraw,a=We(o,{lamports:i}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return new Ze().add({keys:c,programId:this.programId,data:a})}static safeWithdraw(e,t,n){if(e.lamports>t-n)throw new Error("Withdraw will leave vote account with insuffcient funds.");return xo.withdraw(e)}}xo.programId=new ie("Vote111111111111111111111111111111111111111");xo.space=3731;const xm=new ie("Va1idator1nfo111111111111111111111111111111"),x0=O({name:N(),website:X(N()),details:X(N()),keybaseUsername:X(N())});class rh{constructor(e,t){this.key=void 0,this.info=void 0,this.key=e,this.info=t}static fromConfigData(e){let t=[...e];if(Rn(t)!==2)return null;const i=[];for(let s=0;s<2;s++){const o=new ie(t.slice(0,qn));t=t.slice(qn);const a=t.slice(0,1)[0]===1;t=t.slice(1),i.push({publicKey:o,isSigner:a})}if(i[0].publicKey.equals(xm)&&i[1].isSigner){const s=Fi().decode(L.Buffer.from(t)),o=JSON.parse(s);return im(o,x0),new rh(i[1].publicKey,o)}return null}}const C0=new ie("Vote111111111111111111111111111111111111111"),M0=C([$e("nodePubkey"),$e("authorizedWithdrawer"),te("commission"),_e(),Oe(C([_e("slot"),M("confirmationCount")]),Kt(M(),-8),"votes"),te("rootSlotValid"),_e("rootSlot"),_e(),Oe(C([_e("epoch"),$e("authorizedVoter")]),Kt(M(),-8),"authorizedVoters"),C([Oe(C([$e("authorizedPubkey"),_e("epochOfLastAuthorizedSwitch"),_e("targetEpoch")]),32,"buf"),_e("idx"),te("isEmpty")],"priorVoters"),_e(),Oe(C([_e("epoch"),_e("credits"),_e("prevCredits")]),Kt(M(),-8),"epochCredits"),C([_e("slot"),_e("timestamp")],"lastTimestamp")]);class ih{constructor(e){this.nodePubkey=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.rootSlot=void 0,this.votes=void 0,this.authorizedVoters=void 0,this.priorVoters=void 0,this.epochCredits=void 0,this.lastTimestamp=void 0,this.nodePubkey=e.nodePubkey,this.authorizedWithdrawer=e.authorizedWithdrawer,this.commission=e.commission,this.rootSlot=e.rootSlot,this.votes=e.votes,this.authorizedVoters=e.authorizedVoters,this.priorVoters=e.priorVoters,this.epochCredits=e.epochCredits,this.lastTimestamp=e.lastTimestamp}static fromAccountData(e){const n=M0.decode(Me(e),4);let i=n.rootSlot;return n.rootSlotValid||(i=null),new ih({nodePubkey:new ie(n.nodePubkey),authorizedWithdrawer:new ie(n.authorizedWithdrawer),commission:n.commission,votes:n.votes,rootSlot:i,authorizedVoters:n.authorizedVoters.map(L0),priorVoters:K0(n.priorVoters),epochCredits:n.epochCredits,lastTimestamp:n.lastTimestamp})}}function L0({authorizedVoter:r,epoch:e}){return{epoch:e,authorizedVoter:new ie(r)}}function Cp({authorizedPubkey:r,epochOfLastAuthorizedSwitch:e,targetEpoch:t}){return{authorizedPubkey:new ie(r),epochOfLastAuthorizedSwitch:e,targetEpoch:t}}function K0({buf:r,idx:e,isEmpty:t}){return t?[]:[...r.slice(e+1).map(Cp),...r.slice(0,e).map(Cp)]}const Mp={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function N0(r,e){const t=e===!1?"http":"https";if(!r)return Mp[t].devnet;const n=Mp[t][r];if(!n)throw new Error(`Unknown ${t} cluster: ${r}`);return n}async function $0(r,e,t,n){let i,s;t&&Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")||t&&Object.prototype.hasOwnProperty.call(t,"nonceValue")?(i=t,s=n):s=t;const o=s&&{skipPreflight:s.skipPreflight,preflightCommitment:s.preflightCommitment||s.commitment,minContextSlot:s.minContextSlot},a=await r.sendRawTransaction(e,o),c=s&&s.commitment,u=(await(i?r.confirmTransaction(i,c):r.confirmTransaction(a,c))).value;if(u.err)throw new Error(`Raw transaction ${a} failed (${JSON.stringify(u)})`);return a}const D0=1e9;var z0=Object.freeze(Object.defineProperty({__proto__:null,Account:PA,AddressLookupTableAccount:Dd,AddressLookupTableInstruction:_0,AddressLookupTableProgram:th,Authorized:Om,BLOCKHASH_CACHE_TIMEOUT_MS:bm,BPF_LOADER_DEPRECATED_PROGRAM_ID:RA,BPF_LOADER_PROGRAM_ID:GA,BpfLoader:HA,COMPUTE_BUDGET_INSTRUCTION_LAYOUTS:Cr,ComputeBudgetInstruction:A0,ComputeBudgetProgram:nh,Connection:v0,Ed25519Program:Hu,Enum:IA,EpochSchedule:gm,FeeCalculatorLayout:pm,Keypair:Js,LAMPORTS_PER_SOL:D0,LOOKUP_TABLE_INSTRUCTION_LAYOUTS:Qr,Loader:ns,Lockup:Va,MAX_SEED_LENGTH:dm,Message:Sr,MessageAccountKeys:va,MessageV0:ts,NONCE_ACCOUNT_LENGTH:Nd,NonceAccount:ju,PACKET_DATA_SIZE:gi,PUBLIC_KEY_LENGTH:qn,PublicKey:ie,SIGNATURE_LENGTH_IN_BYTES:so,SOLANA_SCHEMA:oa,STAKE_CONFIG_ID:Tm,STAKE_INSTRUCTION_LAYOUTS:Jt,SYSTEM_INSTRUCTION_LAYOUTS:dt,SYSVAR_CLOCK_PUBKEY:Or,SYSVAR_EPOCH_SCHEDULE_PUBKEY:$A,SYSVAR_INSTRUCTIONS_PUBKEY:DA,SYSVAR_RECENT_BLOCKHASHES_PUBKEY:Bc,SYSVAR_RENT_PUBKEY:oo,SYSVAR_REWARDS_PUBKEY:zA,SYSVAR_SLOT_HASHES_PUBKEY:WA,SYSVAR_SLOT_HISTORY_PUBKEY:VA,SYSVAR_STAKE_HISTORY_PUBKEY:xc,Secp256k1Program:Qs,SendTransactionError:$d,SolanaJSONRPCError:pe,SolanaJSONRPCErrorCode:e1,StakeAuthorizationLayout:T0,StakeInstruction:R0,StakeProgram:Yu,Struct:qf,SystemInstruction:jA,SystemProgram:sn,Transaction:Ze,TransactionExpiredBlockheightExceededError:Gf,TransactionExpiredNonceInvalidError:Ns,TransactionExpiredTimeoutError:Hf,TransactionInstruction:ut,TransactionMessage:Jf,TransactionStatus:Gr,VALIDATOR_INFO_KEY:xm,VERSION_PREFIX_MASK:Uu,VOTE_PROGRAM_ID:C0,ValidatorInfo:rh,VersionedMessage:Yf,VersionedTransaction:Qf,VoteAccount:ih,VoteAuthorizationLayout:B0,VoteInit:Bm,VoteInstruction:O0,VoteProgram:xo,clusterApiUrl:N0,sendAndConfirmRawTransaction:$0,sendAndConfirmTransaction:Kd},Symbol.toStringTag,{value:"Module"})),ni=vo(z0);const Lp=()=>{const r=on.utils.randomPrivateKey(),e=Ud(r),t=new Uint8Array(64);return t.set(r),t.set(e,32),{publicKey:e,secretKey:t}},Ud=on.getPublicKey;function Kp(r){try{return on.ExtendedPoint.fromHex(r),!0}catch{return!1}}const W0=(r,e)=>on.sign(r,e.slice(0,32)),V0=on.verify,En=r=>L.Buffer.isBuffer(r)?r:r instanceof Uint8Array?L.Buffer.from(r.buffer,r.byteOffset,r.byteLength):L.Buffer.from(r);class U0{constructor(e){Object.assign(this,e)}encode(){return L.Buffer.from(lf(Cc,this))}static decode(e){return df(Cc,this,e)}static decodeUnchecked(e){return ff(Cc,this,e)}}const Cc=new Map;var Cm;let Mm;const F0=32,ji=32;function j0(r){return r._bn!==void 0}let Np=1;Mm=Symbol.toStringTag;class de extends U0{constructor(e){if(super({}),this._bn=void 0,j0(e))this._bn=e._bn;else{if(typeof e=="string"){const t=me.decode(e);if(t.length!=ji)throw new Error("Invalid public key input");this._bn=new kn(t)}else this._bn=new kn(e);if(this._bn.byteLength()>ji)throw new Error("Invalid public key input")}}static unique(){const e=new de(Np);return Np+=1,new de(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return me.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(L.Buffer);if(e.length===ji)return e;const t=L.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[Mm](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,n){const i=L.Buffer.concat([e.toBuffer(),L.Buffer.from(t),n.toBuffer()]),s=eo(i);return new de(s)}static createProgramAddressSync(e,t){let n=L.Buffer.alloc(0);e.forEach(function(s){if(s.length>F0)throw new TypeError("Max seed length exceeded");n=L.Buffer.concat([n,En(s)])}),n=L.Buffer.concat([n,t.toBuffer(),L.Buffer.from("ProgramDerivedAddress")]);const i=eo(n);if(Kp(i))throw new Error("Invalid seeds, address must fall off the curve");return new de(i)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let n=255,i;for(;n!=0;){try{const s=e.concat(L.Buffer.from([n]));i=this.createProgramAddressSync(s,t)}catch(s){if(s instanceof TypeError)throw s;n--;continue}return[i,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new de(e);return Kp(t.toBytes())}}Cm=de;de.default=new Cm("11111111111111111111111111111111");Cc.set(de,{kind:"struct",fields:[["_bn","u256"]]});new de("BPFLoader1111111111111111111111111111111111");const Fd=1280-40-8,q0=127,jd=64;class $p{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const n=new Map;this.keySegments().flat().forEach((s,o)=>{n.set(s.toBase58(),o)});const i=s=>{const o=n.get(s.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(s=>({programIdIndex:i(s.programId),accountKeyIndexes:s.keys.map(o=>i(o.pubkey)),data:s.data}))}}const Ve=(r="publicKey")=>ge(32,r),$s=(r="string")=>{const e=C([M("length"),M("lengthPadding"),ge(Kt(M(),-8),"chars")],r),t=e.decode.bind(e),n=e.encode.bind(e),i=e;return i.decode=(s,o)=>t(s,o).chars.toString(),i.encode=(s,o,a)=>{const c={chars:L.Buffer.from(s,"utf8")};return n(c,o,a)},i.alloc=s=>M().span+M().span+L.Buffer.from(s,"utf8").length,i},G0=(r="authorized")=>C([Ve("staker"),Ve("withdrawer")],r),H0=(r="lockup")=>C([De("unixTimestamp"),De("epoch"),Ve("custodian")],r),Y0=(r="voteInit")=>C([Ve("nodePubkey"),Ve("authorizedVoter"),Ve("authorizedWithdrawer"),te("commission")],r),J0=(r="voteAuthorizeWithSeedArgs")=>C([M("voteAuthorizationType"),Ve("currentAuthorityDerivedKeyOwnerPubkey"),$s("currentAuthorityDerivedKeySeed"),Ve("newAuthorized")],r);function Lm(r,e){const t=i=>{if(i.span>=0)return i.span;if(typeof i.alloc=="function")return i.alloc(e[i.property]);if("count"in i&&"elementLayout"in i){const s=e[i.property];if(Array.isArray(s))return s.length*t(i.elementLayout)}else if("fields"in i)return Lm({layout:i},e[i.property]);return 0};let n=0;return r.layout.fields.forEach(i=>{n+=t(i)}),n}function Zo(r){let e=0,t=0;for(;;){let n=r.shift();if(e|=(n&127)<<t*7,t+=1,(n&128)===0)break}return e}function ea(r,e){let t=e;for(;;){let n=t&127;if(t>>=7,t==0){r.push(n);break}else n|=128,r.push(n)}}function Dn(r,e){if(!r)throw new Error(e||"Assertion failed")}class sh{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const n=new Map,i=o=>{const a=o.toBase58();let c=n.get(a);return c===void 0&&(c={isSigner:!1,isWritable:!1,isInvoked:!1},n.set(a,c)),c},s=i(t);s.isSigner=!0,s.isWritable=!0;for(const o of e){i(o.programId).isInvoked=!0;for(const a of o.keys){const c=i(a.pubkey);c.isSigner||=a.isSigner,c.isWritable||=a.isWritable}}return new sh(t,n)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];Dn(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,c])=>c.isSigner&&c.isWritable),n=e.filter(([,c])=>c.isSigner&&!c.isWritable),i=e.filter(([,c])=>!c.isSigner&&c.isWritable),s=e.filter(([,c])=>!c.isSigner&&!c.isWritable),o={numRequiredSignatures:t.length+n.length,numReadonlySignedAccounts:n.length,numReadonlyUnsignedAccounts:s.length};{Dn(t.length>0,"Expected at least one writable signer key");const[c]=t[0];Dn(c===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...t.map(([c])=>new de(c)),...n.map(([c])=>new de(c)),...i.map(([c])=>new de(c)),...s.map(([c])=>new de(c))];return[o,a]}extractTableLookup(e){const[t,n]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[i,s]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&i.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:i},{writable:n,readonly:s}]}drainKeysFoundInLookupTable(e,t){const n=new Array,i=new Array;for(const[s,o]of this.keyMetaMap.entries())if(t(o)){const a=new de(s),c=e.findIndex(l=>l.equals(a));c>=0&&(Dn(c<256,"Max lookup table index exceeded"),n.push(c),i.push(a),this.keyMetaMap.delete(s))}return[n,i]}}class Aa{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new de(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:me.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new $p(this.staticAccountKeys)}static compile(e){const t=sh.compile(e.instructions,e.payerKey),[n,i]=t.getMessageComponents(),o=new $p(i).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:me.encode(a.data)}));return new Aa({header:n,accountKeys:i,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const n=e-t,s=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return n<s}else{const n=t-this.header.numReadonlySignedAccounts;return e<n}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];ea(t,e);const n=this.instructions.map(d=>{const{accounts:m,programIdIndex:y}=d,S=Array.from(me.decode(d.data));let p=[];ea(p,m.length);let w=[];return ea(w,S.length),{programIdIndex:y,keyIndicesCount:L.Buffer.from(p),keyIndices:m,dataLength:L.Buffer.from(w),data:S}});let i=[];ea(i,n.length);let s=L.Buffer.alloc(Fd);L.Buffer.from(i).copy(s);let o=i.length;n.forEach(d=>{o+=C([te("programIdIndex"),ge(d.keyIndicesCount.length,"keyIndicesCount"),Oe(te("keyIndex"),d.keyIndices.length,"keyIndices"),ge(d.dataLength.length,"dataLength"),Oe(te("userdatum"),d.data.length,"data")]).encode(d,s,o)}),s=s.slice(0,o);const a=C([ge(1,"numRequiredSignatures"),ge(1,"numReadonlySignedAccounts"),ge(1,"numReadonlyUnsignedAccounts"),ge(t.length,"keyCount"),Oe(Ve("key"),e,"keys"),Ve("recentBlockhash")]),c={numRequiredSignatures:L.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:L.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:L.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:L.Buffer.from(t),keys:this.accountKeys.map(d=>En(d.toBytes())),recentBlockhash:me.decode(this.recentBlockhash)};let l=L.Buffer.alloc(2048);const u=a.encode(c,l);return s.copy(l,u),l.slice(0,u+s.length)}static from(e){let t=[...e];const n=t.shift();if(n!==(n&q0))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const i=t.shift(),s=t.shift(),o=Zo(t);let a=[];for(let m=0;m<o;m++){const y=t.slice(0,ji);t=t.slice(ji),a.push(new de(L.Buffer.from(y)))}const c=t.slice(0,ji);t=t.slice(ji);const l=Zo(t);let u=[];for(let m=0;m<l;m++){const y=t.shift(),S=Zo(t),p=t.slice(0,S);t=t.slice(S);const w=Zo(t),v=t.slice(0,w),E=me.encode(L.Buffer.from(v));t=t.slice(w),u.push({programIdIndex:y,accounts:p,data:E})}const d={header:{numRequiredSignatures:n,numReadonlySignedAccounts:i,numReadonlyUnsignedAccounts:s},recentBlockhash:me.encode(L.Buffer.from(c)),accountKeys:a,instructions:u};return new Aa(d)}}const Q0=L.Buffer.alloc(jd).fill(0);class nt{constructor(e){this.keys=void 0,this.programId=void 0,this.data=L.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:n})=>({pubkey:e.toJSON(),isSigner:t,isWritable:n})),programId:this.programId.toJSON(),data:[...this.data]}}}class vt{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:n}=e;this.minNonceContextSlot=t,this.nonceInfo=n}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:n}=e;this.recentBlockhash=t,this.lastValidBlockHeight=n}else{const{recentBlockhash:t,nonceInfo:n}=e;n&&(this.nonceInfo=n),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new nt(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let n;if(this.feePayer)n=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)n=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let p=0;p<t.length;p++)if(t[p].programId===void 0)throw new Error(`Transaction instruction index ${p} has undefined program id`);const i=[],s=[];t.forEach(p=>{p.keys.forEach(v=>{s.push({...v})});const w=p.programId.toString();i.includes(w)||i.push(w)}),i.forEach(p=>{s.push({pubkey:new de(p),isSigner:!1,isWritable:!1})});const o=[];s.forEach(p=>{const w=p.pubkey.toString(),v=o.findIndex(E=>E.pubkey.toString()===w);v>-1?(o[v].isWritable=o[v].isWritable||p.isWritable,o[v].isSigner=o[v].isSigner||p.isSigner):o.push(p)}),o.sort(function(p,w){if(p.isSigner!==w.isSigner)return p.isSigner?-1:1;if(p.isWritable!==w.isWritable)return p.isWritable?-1:1;const v={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return p.pubkey.toBase58().localeCompare(w.pubkey.toBase58(),"en",v)});const a=o.findIndex(p=>p.pubkey.equals(n));if(a>-1){const[p]=o.splice(a,1);p.isSigner=!0,p.isWritable=!0,o.unshift(p)}else o.unshift({pubkey:n,isSigner:!0,isWritable:!0});for(const p of this.signatures){const w=o.findIndex(v=>v.pubkey.equals(p.publicKey));if(w>-1)o[w].isSigner||(o[w].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${p.publicKey.toString()}`)}let c=0,l=0,u=0;const d=[],m=[];o.forEach(({pubkey:p,isSigner:w,isWritable:v})=>{w?(d.push(p.toString()),c+=1,v||(l+=1)):(m.push(p.toString()),v||(u+=1))});const y=d.concat(m),S=t.map(p=>{const{data:w,programId:v}=p;return{programIdIndex:y.indexOf(v.toString()),accounts:p.keys.map(E=>y.indexOf(E.pubkey.toString())),data:me.encode(w)}});return S.forEach(p=>{Dn(p.programIdIndex>=0),p.accounts.forEach(w=>Dn(w>=0))}),new Aa({header:{numRequiredSignatures:c,numReadonlySignedAccounts:l,numReadonlyUnsignedAccounts:u},accountKeys:y,recentBlockhash:e,instructions:S})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((i,s)=>t[s].equals(i.publicKey))||(this.signatures=t.map(n=>({signature:null,publicKey:n}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(n=>{const i=n.toString();return t.has(i)?!1:(t.add(i),!0)}).map(n=>({signature:null,publicKey:n}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}this.signatures=n.map(s=>({signature:null,publicKey:s.publicKey}));const i=this._compile();this._partialSign(i,...n)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}const i=this._compile();this._partialSign(i,...n)}_partialSign(e,...t){const n=e.serialize();t.forEach(i=>{const s=W0(n,i.secretKey);this._addSignature(i.publicKey,En(s))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){Dn(t.length===64);const n=this.signatures.findIndex(i=>e.equals(i.publicKey));if(n<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[n].signature=L.Buffer.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:n,publicKey:i}of this.signatures)if(n===null){if(t)return!1}else if(!V0(n,e,i.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:n}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),i=this.serializeMessage();if(n&&!this._verifySignatures(i,t))throw new Error("Signature verification failed");return this._serialize(i)}_serialize(e){const{signatures:t}=this,n=[];ea(n,t.length);const i=n.length+t.length*64+e.length,s=L.Buffer.alloc(i);return Dn(t.length<256),L.Buffer.from(n).copy(s,0),t.forEach(({signature:o},a)=>{o!==null&&(Dn(o.length===64,"signature has invalid length"),L.Buffer.from(o).copy(s,n.length+a*64))}),e.copy(s,n.length+t.length*64),Dn(s.length<=Fd,`Transaction too large: ${s.length} > ${Fd}`),s}get keys(){return Dn(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return Dn(this.instructions.length===1),this.instructions[0].programId}get data(){return Dn(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const n=Zo(t);let i=[];for(let s=0;s<n;s++){const o=t.slice(0,jd);t=t.slice(jd),i.push(me.encode(L.Buffer.from(o)))}return vt.populate(Aa.from(t),i)}static populate(e,t=[]){const n=new vt;return n.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(n.feePayer=e.accountKeys[0]),t.forEach((i,s)=>{const o={signature:i==me.encode(Q0)?null:me.decode(i),publicKey:e.accountKeys[s]};n.signatures.push(o)}),e.instructions.forEach(i=>{const s=i.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:n.signatures.some(c=>c.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});n.instructions.push(new nt({keys:s,programId:e.accountKeys[i.programIdIndex],data:me.decode(i.data)}))}),n._message=e,n._json=n.toJSON(),n}}new de("SysvarC1ock11111111111111111111111111111111");new de("SysvarEpochSchedu1e111111111111111111111111");new de("Sysvar1nstructions1111111111111111111111111");const sd=new de("SysvarRecentB1ockHashes11111111111111111111"),Ds=new de("SysvarRent111111111111111111111111111111111");new de("SysvarRewards111111111111111111111111111111");new de("SysvarS1otHashes111111111111111111111111111");new de("SysvarS1otHistory11111111111111111111111111");new de("SysvarStakeHistory1111111111111111111111111");async function X0(r,e,t,n){const i=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot},s=await r.sendTransaction(e,t,i);let o;if(e.recentBlockhash!=null&&e.lastValidBlockHeight!=null)o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,signature:s,blockhash:e.recentBlockhash,lastValidBlockHeight:e.lastValidBlockHeight},n&&n.commitment)).value;else if(e.minNonceContextSlot!=null&&e.nonceInfo!=null){const{nonceInstruction:a}=e.nonceInfo,c=a.keys[0].pubkey;o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,minContextSlot:e.minNonceContextSlot,nonceAccountPubkey:c,nonceValue:e.nonceInfo.nonce,signature:s},n&&n.commitment)).value}else(n==null?void 0:n.abortSignal)!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),o=(await r.confirmTransaction(s,n&&n.commitment)).value;if(o.err)throw new Error(`Transaction ${s} failed (${JSON.stringify(o)})`);return s}function Xn(r,e){const t=r.layout.span>=0?r.layout.span:Lm(r,e),n=L.Buffer.alloc(t),i=Object.assign({instruction:r.index},e);return r.layout.encode(i,n),n}const Z0=_e("lamportsPerSignature"),eI=C([M("version"),M("state"),Ve("authorizedPubkey"),Ve("nonce"),C([Z0],"feeCalculator")]),Dp=eI.span,tI=r=>{const e=r.decode.bind(r),t=r.encode.bind(r);return{decode:e,encode:t}},nI=r=>e=>{const t=ge(r,e),{encode:n,decode:i}=tI(t),s=t;return s.decode=(o,a)=>{const c=i(o,a);return hf(L.Buffer.from(c))},s.encode=(o,a,c)=>{const l=Ba(o,r);return n(l,a,c)},s},co=nI(8),Zn=Object.freeze({Create:{index:0,layout:C([M("instruction"),De("lamports"),De("space"),Ve("programId")])},Assign:{index:1,layout:C([M("instruction"),Ve("programId")])},Transfer:{index:2,layout:C([M("instruction"),co("lamports")])},CreateWithSeed:{index:3,layout:C([M("instruction"),Ve("base"),$s("seed"),De("lamports"),De("space"),Ve("programId")])},AdvanceNonceAccount:{index:4,layout:C([M("instruction")])},WithdrawNonceAccount:{index:5,layout:C([M("instruction"),De("lamports")])},InitializeNonceAccount:{index:6,layout:C([M("instruction"),Ve("authorized")])},AuthorizeNonceAccount:{index:7,layout:C([M("instruction"),Ve("authorized")])},Allocate:{index:8,layout:C([M("instruction"),De("space")])},AllocateWithSeed:{index:9,layout:C([M("instruction"),Ve("base"),$s("seed"),De("space"),Ve("programId")])},AssignWithSeed:{index:10,layout:C([M("instruction"),Ve("base"),$s("seed"),Ve("programId")])},TransferWithSeed:{index:11,layout:C([M("instruction"),co("lamports"),$s("seed"),Ve("programId")])},UpgradeNonceAccount:{index:12,layout:C([M("instruction")])}});class Br{constructor(){}static createAccount(e){const t=Zn.Create,n=Xn(t,{lamports:e.lamports,space:e.space,programId:En(e.programId.toBuffer())});return new nt({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:n})}static transfer(e){let t,n;if("basePubkey"in e){const i=Zn.TransferWithSeed;t=Xn(i,{lamports:BigInt(e.lamports),seed:e.seed,programId:En(e.programId.toBuffer())}),n=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}else{const i=Zn.Transfer;t=Xn(i,{lamports:BigInt(e.lamports)}),n=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}return new nt({keys:n,programId:this.programId,data:t})}static assign(e){let t,n;if("basePubkey"in e){const i=Zn.AssignWithSeed;t=Xn(i,{base:En(e.basePubkey.toBuffer()),seed:e.seed,programId:En(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=Zn.Assign;t=Xn(i,{programId:En(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new nt({keys:n,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=Zn.CreateWithSeed,n=Xn(t,{base:En(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:En(e.programId.toBuffer())});let i=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey!=e.fromPubkey&&i.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new nt({keys:i,programId:this.programId,data:n})}static createNonceAccount(e){const t=new vt;"basePubkey"in e&&"seed"in e?t.add(Br.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:Dp,programId:this.programId})):t.add(Br.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:Dp,programId:this.programId}));const n={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(n)),t}static nonceInitialize(e){const t=Zn.InitializeNonceAccount,n=Xn(t,{authorized:En(e.authorizedPubkey.toBuffer())}),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:sd,isSigner:!1,isWritable:!1},{pubkey:Ds,isSigner:!1,isWritable:!1}],programId:this.programId,data:n};return new nt(i)}static nonceAdvance(e){const t=Zn.AdvanceNonceAccount,n=Xn(t),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:sd,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n};return new nt(i)}static nonceWithdraw(e){const t=Zn.WithdrawNonceAccount,n=Xn(t,{lamports:e.lamports});return new nt({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:sd,isSigner:!1,isWritable:!1},{pubkey:Ds,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static nonceAuthorize(e){const t=Zn.AuthorizeNonceAccount,n=Xn(t,{authorized:En(e.newAuthorizedPubkey.toBuffer())});return new nt({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static allocate(e){let t,n;if("basePubkey"in e){const i=Zn.AllocateWithSeed;t=Xn(i,{base:En(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:En(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=Zn.Allocate;t=Xn(i,{space:e.space}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new nt({keys:n,programId:this.programId,data:t})}}Br.programId=new de("11111111111111111111111111111111");new de("BPFLoader2111111111111111111111111111111111");C([M("typeIndex"),co("deactivationSlot"),_e("lastExtendedSlot"),te("lastExtendedStartIndex"),te(),Oe(Ve(),Kt(te(),-1),"authority")]);const Ut=Fr(To(de),N(),r=>new de(r)),Km=Oo([N(),Ee("base64")]),oh=Fr(To(L.Buffer),Km,r=>L.Buffer.from(r[0],"base64"));function Nm(r){return st([O({jsonrpc:Ee("2.0"),id:N(),result:r}),O({jsonrpc:Ee("2.0"),id:N(),error:O({code:Ur(),message:N(),data:X(om())})})])}const rI=Nm(Ur());function ft(r){return Fr(Nm(r),rI,e=>"error"in e?e:{...e,result:ne(e.result,r)})}function dr(r){return ft(O({context:O({slot:k()}),value:r}))}function Ju(r){return O({context:O({slot:k()}),value:r})}const iI=O({foundation:k(),foundationTerm:k(),initial:k(),taper:k(),terminal:k()});ft(j(F(O({epoch:k(),effectiveSlot:k(),amount:k(),postBalance:k(),commission:X(F(k()))}))));const sI=j(O({slot:k(),prioritizationFee:k()})),oI=O({total:k(),validator:k(),foundation:k(),epoch:k()}),aI=O({epoch:k(),slotIndex:k(),slotsInEpoch:k(),absoluteSlot:k(),blockHeight:X(k()),transactionCount:X(k())}),cI=O({slotsPerEpoch:k(),leaderScheduleSlotOffset:k(),warmup:$t(),firstNormalEpoch:k(),firstNormalSlot:k()}),uI=Vu(N(),j(k())),ks=F(st([O({}),N()])),lI=O({err:ks}),dI=Ee("receivedSignature");O({"solana-core":N(),"feature-set":X(k())});dr(O({err:F(st([O({}),N()])),logs:F(j(N())),accounts:X(F(j(F(O({executable:$t(),owner:N(),lamports:k(),data:j(N()),rentEpoch:X(k())}))))),unitsConsumed:X(k()),returnData:X(F(O({programId:N(),data:Oo([N(),Ee("base64")])})))}));dr(O({byIdentity:Vu(N(),j(k())),range:O({firstSlot:k(),lastSlot:k()})}));ft(iI);ft(oI);ft(sI);ft(aI);ft(cI);ft(uI);ft(k());dr(O({total:k(),circulating:k(),nonCirculating:k(),nonCirculatingAccounts:j(Ut)}));const fI=O({amount:N(),uiAmount:F(k()),decimals:k(),uiAmountString:X(N())});dr(j(O({address:Ut,amount:N(),uiAmount:F(k()),decimals:k(),uiAmountString:X(N())})));dr(j(O({pubkey:Ut,account:O({executable:$t(),owner:Ut,lamports:k(),data:oh,rentEpoch:k()})})));const qd=O({program:N(),parsed:Ur(),space:k()});dr(j(O({pubkey:Ut,account:O({executable:$t(),owner:Ut,lamports:k(),data:qd,rentEpoch:k()})})));dr(j(O({lamports:k(),address:Ut})));const ah=O({executable:$t(),owner:Ut,lamports:k(),data:oh,rentEpoch:k()});O({pubkey:Ut,account:ah});const hI=Fr(st([To(L.Buffer),qd]),st([Km,qd]),r=>Array.isArray(r)?ne(r,oh):r),pI=O({executable:$t(),owner:Ut,lamports:k(),data:hI,rentEpoch:k()});O({pubkey:Ut,account:pI});O({state:st([Ee("active"),Ee("inactive"),Ee("activating"),Ee("deactivating")]),active:k(),inactive:k()});ft(j(O({signature:N(),slot:k(),err:ks,memo:F(N()),blockTime:X(F(k()))})));ft(j(O({signature:N(),slot:k(),err:ks,memo:F(N()),blockTime:X(F(k()))})));O({subscription:k(),result:Ju(ah)});const yI=O({pubkey:Ut,account:ah});O({subscription:k(),result:Ju(yI)});const gI=O({parent:k(),slot:k(),root:k()});O({subscription:k(),result:gI});const mI=st([O({type:st([Ee("firstShredReceived"),Ee("completed"),Ee("optimisticConfirmation"),Ee("root")]),slot:k(),timestamp:k()}),O({type:Ee("createdBank"),parent:k(),slot:k(),timestamp:k()}),O({type:Ee("frozen"),slot:k(),timestamp:k(),stats:O({numTransactionEntries:k(),numSuccessfulTransactions:k(),numFailedTransactions:k(),maxTransactionsPerEntry:k()})}),O({type:Ee("dead"),slot:k(),timestamp:k(),err:N()})]);O({subscription:k(),result:mI});O({subscription:k(),result:Ju(st([lI,dI]))});O({subscription:k(),result:k()});O({pubkey:N(),gossip:F(N()),tpu:F(N()),rpc:F(N()),version:F(N())});const zp=O({votePubkey:N(),nodePubkey:N(),activatedStake:k(),epochVoteAccount:$t(),epochCredits:j(Oo([k(),k(),k()])),commission:k(),lastVote:k(),rootSlot:F(k())});ft(O({current:j(zp),delinquent:j(zp)}));const bI=st([Ee("processed"),Ee("confirmed"),Ee("finalized")]),wI=O({slot:k(),confirmations:F(k()),err:ks,confirmationStatus:X(bI)});dr(j(F(wI)));ft(k());const $m=O({accountKey:Ut,writableIndexes:j(k()),readonlyIndexes:j(k())}),ch=O({signatures:j(N()),message:O({accountKeys:j(N()),header:O({numRequiredSignatures:k(),numReadonlySignedAccounts:k(),numReadonlyUnsignedAccounts:k()}),instructions:j(O({accounts:j(k()),data:N(),programIdIndex:k()})),recentBlockhash:N(),addressTableLookups:X(j($m))})}),Dm=O({pubkey:Ut,signer:$t(),writable:$t(),source:X(st([Ee("transaction"),Ee("lookupTable")]))}),zm=O({accountKeys:j(Dm),signatures:j(N())}),Wm=O({parsed:Ur(),program:N(),programId:Ut}),Vm=O({accounts:j(Ut),data:N(),programId:Ut}),kI=st([Vm,Wm]),SI=st([O({parsed:Ur(),program:N(),programId:N()}),O({accounts:j(N()),data:N(),programId:N()})]),Um=Fr(kI,SI,r=>"accounts"in r?ne(r,Vm):ne(r,Wm)),Fm=O({signatures:j(N()),message:O({accountKeys:j(Dm),instructions:j(Um),recentBlockhash:N(),addressTableLookups:X(F(j($m)))})}),Gc=O({accountIndex:k(),mint:N(),owner:X(N()),uiTokenAmount:fI}),jm=O({writable:j(Ut),readonly:j(Ut)}),Qu=O({err:ks,fee:k(),innerInstructions:X(F(j(O({index:k(),instructions:j(O({accounts:j(k()),data:N(),programIdIndex:k()}))})))),preBalances:j(k()),postBalances:j(k()),logMessages:X(F(j(N()))),preTokenBalances:X(F(j(Gc))),postTokenBalances:X(F(j(Gc))),loadedAddresses:X(jm),computeUnitsConsumed:X(k())}),uh=O({err:ks,fee:k(),innerInstructions:X(F(j(O({index:k(),instructions:j(Um)})))),preBalances:j(k()),postBalances:j(k()),logMessages:X(F(j(N()))),preTokenBalances:X(F(j(Gc))),postTokenBalances:X(F(j(Gc))),loadedAddresses:X(jm),computeUnitsConsumed:X(k())}),Co=st([Ee(0),Ee("legacy")]),Ss=O({pubkey:N(),lamports:k(),postBalance:F(k()),rewardType:F(N()),commission:X(F(k()))});ft(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:ch,meta:F(Qu),version:X(Co)})),rewards:X(j(Ss)),blockTime:F(k()),blockHeight:F(k())})));ft(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),rewards:X(j(Ss)),blockTime:F(k()),blockHeight:F(k())})));ft(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:zm,meta:F(Qu),version:X(Co)})),rewards:X(j(Ss)),blockTime:F(k()),blockHeight:F(k())})));ft(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:Fm,meta:F(uh),version:X(Co)})),rewards:X(j(Ss)),blockTime:F(k()),blockHeight:F(k())})));ft(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:zm,meta:F(uh),version:X(Co)})),rewards:X(j(Ss)),blockTime:F(k()),blockHeight:F(k())})));ft(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),rewards:X(j(Ss)),blockTime:F(k()),blockHeight:F(k())})));ft(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:ch,meta:F(Qu)})),rewards:X(j(Ss)),blockTime:F(k())})));ft(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),signatures:j(N()),blockTime:F(k())})));ft(F(O({slot:k(),meta:Qu,blockTime:X(F(k())),transaction:ch,version:X(Co)})));ft(F(O({slot:k(),transaction:Fm,meta:F(uh),blockTime:X(F(k())),version:X(Co)})));dr(O({blockhash:N(),feeCalculator:O({lamportsPerSignature:k()})}));dr(O({blockhash:N(),lastValidBlockHeight:k()}));dr($t());const vI=O({slot:k(),numTransactions:k(),numSlots:k(),samplePeriodSecs:k()});ft(j(vI));dr(F(O({feeCalculator:O({lamportsPerSignature:k()})})));ft(N());ft(N());const _I=O({err:ks,logs:j(N()),signature:N()});O({result:Ju(_I),subscription:k()});class di{constructor(e){this._keypair=void 0,this._keypair=e??Lp()}static generate(){return new di(Lp())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const n=e.slice(32,64);if(!t||!t.skipValidation){const i=e.slice(0,32),s=Ud(i);for(let o=0;o<32;o++)if(n[o]!==s[o])throw new Error("provided secretKey is invalid")}return new di({publicKey:n,secretKey:e})}static fromSeed(e){const t=Ud(e),n=new Uint8Array(64);return n.set(e),n.set(t,32),new di({publicKey:t,secretKey:n})}get publicKey(){return new de(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}Object.freeze({CreateLookupTable:{index:0,layout:C([M("instruction"),co("recentSlot"),te("bumpSeed")])},FreezeLookupTable:{index:1,layout:C([M("instruction")])},ExtendLookupTable:{index:2,layout:C([M("instruction"),co(),Oe(Ve(),Kt(M(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:C([M("instruction")])},CloseLookupTable:{index:4,layout:C([M("instruction")])}});new de("AddressLookupTab1e1111111111111111111111111");Object.freeze({RequestUnits:{index:0,layout:C([te("instruction"),M("units"),M("additionalFee")])},RequestHeapFrame:{index:1,layout:C([te("instruction"),M("bytes")])},SetComputeUnitLimit:{index:2,layout:C([te("instruction"),M("units")])},SetComputeUnitPrice:{index:3,layout:C([te("instruction"),co("microLamports")])}});new de("ComputeBudget111111111111111111111111111111");C([te("numSignatures"),te("padding"),Ue("signatureOffset"),Ue("signatureInstructionIndex"),Ue("publicKeyOffset"),Ue("publicKeyInstructionIndex"),Ue("messageDataOffset"),Ue("messageDataSize"),Ue("messageInstructionIndex")]);new de("Ed25519SigVerify111111111111111111111111111");Ei.utils.isValidPrivateKey;Ei.getPublicKey;C([te("numSignatures"),Ue("signatureOffset"),te("signatureInstructionIndex"),Ue("ethAddressOffset"),te("ethAddressInstructionIndex"),Ue("messageDataOffset"),Ue("messageDataSize"),te("messageInstructionIndex"),ge(20,"ethAddress"),ge(64,"signature"),te("recoveryId")]);new de("KeccakSecp256k11111111111111111111111111111");var qm;new de("StakeConfig11111111111111111111111111111111");class Gm{constructor(e,t,n){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=n}}qm=Gm;Gm.default=new qm(0,0,de.default);Object.freeze({Initialize:{index:0,layout:C([M("instruction"),G0(),H0()])},Authorize:{index:1,layout:C([M("instruction"),Ve("newAuthorized"),M("stakeAuthorizationType")])},Delegate:{index:2,layout:C([M("instruction")])},Split:{index:3,layout:C([M("instruction"),De("lamports")])},Withdraw:{index:4,layout:C([M("instruction"),De("lamports")])},Deactivate:{index:5,layout:C([M("instruction")])},Merge:{index:7,layout:C([M("instruction")])},AuthorizeWithSeed:{index:8,layout:C([M("instruction"),Ve("newAuthorized"),M("stakeAuthorizationType"),$s("authoritySeed"),Ve("authorityOwner")])}});Object.freeze({Staker:{index:0},Withdrawer:{index:1}});new de("Stake11111111111111111111111111111111111111");Object.freeze({InitializeAccount:{index:0,layout:C([M("instruction"),Y0()])},Authorize:{index:1,layout:C([M("instruction"),Ve("newAuthorized"),M("voteAuthorizationType")])},Withdraw:{index:3,layout:C([M("instruction"),De("lamports")])},AuthorizeWithSeed:{index:10,layout:C([M("instruction"),J0()])}});Object.freeze({Voter:{index:0},Withdrawer:{index:1}});new de("Vote111111111111111111111111111111111111111");new de("Va1idator1nfo111111111111111111111111111111");O({name:N(),website:X(N()),details:X(N()),keybaseUsername:X(N())});new de("Vote111111111111111111111111111111111111111");C([Ve("nodePubkey"),Ve("authorizedWithdrawer"),te("commission"),_e(),Oe(C([_e("slot"),M("confirmationCount")]),Kt(M(),-8),"votes"),te("rootSlotValid"),_e("rootSlot"),_e(),Oe(C([_e("epoch"),Ve("authorizedVoter")]),Kt(M(),-8),"authorizedVoters"),C([Oe(C([Ve("authorizedPubkey"),_e("epochOfLastAuthorizedSwitch"),_e("targetEpoch")]),32,"buf"),_e("idx"),te("isEmpty")],"priorVoters"),_e(),Oe(C([_e("epoch"),_e("credits"),_e("prevCredits")]),Kt(M(),-8),"epochCredits"),C([_e("slot"),_e("timestamp")],"lastTimestamp")]);var Ye={},Xu={};Xu.byteLength=EI;Xu.toByteArray=RI;Xu.fromByteArray=BI;var Mr=[],er=[],AI=typeof Uint8Array<"u"?Uint8Array:Array,od="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Rs=0,II=od.length;Rs<II;++Rs)Mr[Rs]=od[Rs],er[od.charCodeAt(Rs)]=Rs;er["-".charCodeAt(0)]=62;er["_".charCodeAt(0)]=63;function Hm(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function EI(r){var e=Hm(r),t=e[0],n=e[1];return(t+n)*3/4-n}function PI(r,e,t){return(e+t)*3/4-t}function RI(r){var e,t=Hm(r),n=t[0],i=t[1],s=new AI(PI(r,n,i)),o=0,a=i>0?n-4:n,c;for(c=0;c<a;c+=4)e=er[r.charCodeAt(c)]<<18|er[r.charCodeAt(c+1)]<<12|er[r.charCodeAt(c+2)]<<6|er[r.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=er[r.charCodeAt(c)]<<2|er[r.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=er[r.charCodeAt(c)]<<10|er[r.charCodeAt(c+1)]<<4|er[r.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function TI(r){return Mr[r>>18&63]+Mr[r>>12&63]+Mr[r>>6&63]+Mr[r&63]}function OI(r,e,t){for(var n,i=[],s=e;s<t;s+=3)n=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),i.push(TI(n));return i.join("")}function BI(r){for(var e,t=r.length,n=t%3,i=[],s=16383,o=0,a=t-n;o<a;o+=s)i.push(OI(r,o,o+s>a?a:o+s));return n===1?(e=r[t-1],i.push(Mr[e>>2]+Mr[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push(Mr[e>>10]+Mr[e>>4&63]+Mr[e<<2&63]+"=")),i.join("")}var lh={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */lh.read=function(r,e,t,n,i){var s,o,a=i*8-n-1,c=(1<<a)-1,l=c>>1,u=-7,d=t?i-1:0,m=t?-1:1,y=r[e+d];for(d+=m,s=y&(1<<-u)-1,y>>=-u,u+=a;u>0;s=s*256+r[e+d],d+=m,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=o*256+r[e+d],d+=m,u-=8);if(s===0)s=1-l;else{if(s===c)return o?NaN:(y?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-l}return(y?-1:1)*o*Math.pow(2,s-n)};lh.write=function(r,e,t,n,i,s){var o,a,c,l=s*8-i-1,u=(1<<l)-1,d=u>>1,m=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=n?0:s-1,S=n?1:-1,p=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+d>=1?e+=m/c:e+=m*Math.pow(2,1-d),e*c>=2&&(o++,c/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(e*c-1)*Math.pow(2,i),o=o+d):(a=e*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;r[t+y]=a&255,y+=S,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;r[t+y]=o&255,y+=S,o/=256,l-=8);r[t+y-S]|=p*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){const e=Xu,t=lh,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=a,r.SlowBuffer=E,r.INSPECT_MAX_BYTES=50;const i=2147483647;r.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const g=new Uint8Array(1),f={foo:function(){return 42}};return Object.setPrototypeOf(f,Uint8Array.prototype),Object.setPrototypeOf(g,f),g.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(!!a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(!!a.isBuffer(this))return this.byteOffset}});function o(g){if(g>i)throw new RangeError('The value "'+g+'" is invalid for option "size"');const f=new Uint8Array(g);return Object.setPrototypeOf(f,a.prototype),f}function a(g,f,h){if(typeof g=="number"){if(typeof f=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(g)}return c(g,f,h)}a.poolSize=8192;function c(g,f,h){if(typeof g=="string")return m(g,f);if(ArrayBuffer.isView(g))return S(g);if(g==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g);if(Er(g,ArrayBuffer)||g&&Er(g.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Er(g,SharedArrayBuffer)||g&&Er(g.buffer,SharedArrayBuffer)))return p(g,f,h);if(typeof g=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const A=g.valueOf&&g.valueOf();if(A!=null&&A!==g)return a.from(A,f,h);const x=w(g);if(x)return x;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof g[Symbol.toPrimitive]=="function")return a.from(g[Symbol.toPrimitive]("string"),f,h);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g)}a.from=function(g,f,h){return c(g,f,h)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(g){if(typeof g!="number")throw new TypeError('"size" argument must be of type number');if(g<0)throw new RangeError('The value "'+g+'" is invalid for option "size"')}function u(g,f,h){return l(g),g<=0?o(g):f!==void 0?typeof h=="string"?o(g).fill(f,h):o(g).fill(f):o(g)}a.alloc=function(g,f,h){return u(g,f,h)};function d(g){return l(g),o(g<0?0:v(g)|0)}a.allocUnsafe=function(g){return d(g)},a.allocUnsafeSlow=function(g){return d(g)};function m(g,f){if((typeof f!="string"||f==="")&&(f="utf8"),!a.isEncoding(f))throw new TypeError("Unknown encoding: "+f);const h=P(g,f)|0;let A=o(h);const x=A.write(g,f);return x!==h&&(A=A.slice(0,x)),A}function y(g){const f=g.length<0?0:v(g.length)|0,h=o(f);for(let A=0;A<f;A+=1)h[A]=g[A]&255;return h}function S(g){if(Er(g,Uint8Array)){const f=new Uint8Array(g);return p(f.buffer,f.byteOffset,f.byteLength)}return y(g)}function p(g,f,h){if(f<0||g.byteLength<f)throw new RangeError('"offset" is outside of buffer bounds');if(g.byteLength<f+(h||0))throw new RangeError('"length" is outside of buffer bounds');let A;return f===void 0&&h===void 0?A=new Uint8Array(g):h===void 0?A=new Uint8Array(g,f):A=new Uint8Array(g,f,h),Object.setPrototypeOf(A,a.prototype),A}function w(g){if(a.isBuffer(g)){const f=v(g.length)|0,h=o(f);return h.length===0||g.copy(h,0,0,f),h}if(g.length!==void 0)return typeof g.length!="number"||Fl(g.length)?o(0):y(g);if(g.type==="Buffer"&&Array.isArray(g.data))return y(g.data)}function v(g){if(g>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return g|0}function E(g){return+g!=g&&(g=0),a.alloc(+g)}a.isBuffer=function(f){return f!=null&&f._isBuffer===!0&&f!==a.prototype},a.compare=function(f,h){if(Er(f,Uint8Array)&&(f=a.from(f,f.offset,f.byteLength)),Er(h,Uint8Array)&&(h=a.from(h,h.offset,h.byteLength)),!a.isBuffer(f)||!a.isBuffer(h))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(f===h)return 0;let A=f.length,x=h.length;for(let U=0,H=Math.min(A,x);U<H;++U)if(f[U]!==h[U]){A=f[U],x=h[U];break}return A<x?-1:x<A?1:0},a.isEncoding=function(f){switch(String(f).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(f,h){if(!Array.isArray(f))throw new TypeError('"list" argument must be an Array of Buffers');if(f.length===0)return a.alloc(0);let A;if(h===void 0)for(h=0,A=0;A<f.length;++A)h+=f[A].length;const x=a.allocUnsafe(h);let U=0;for(A=0;A<f.length;++A){let H=f[A];if(Er(H,Uint8Array))U+H.length>x.length?(a.isBuffer(H)||(H=a.from(H)),H.copy(x,U)):Uint8Array.prototype.set.call(x,H,U);else if(a.isBuffer(H))H.copy(x,U);else throw new TypeError('"list" argument must be an Array of Buffers');U+=H.length}return x};function P(g,f){if(a.isBuffer(g))return g.length;if(ArrayBuffer.isView(g)||Er(g,ArrayBuffer))return g.byteLength;if(typeof g!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof g);const h=g.length,A=arguments.length>2&&arguments[2]===!0;if(!A&&h===0)return 0;let x=!1;for(;;)switch(f){case"ascii":case"latin1":case"binary":return h;case"utf8":case"utf-8":return Ul(g).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return h*2;case"hex":return h>>>1;case"base64":return $h(g).length;default:if(x)return A?-1:Ul(g).length;f=(""+f).toLowerCase(),x=!0}}a.byteLength=P;function K(g,f,h){let A=!1;if((f===void 0||f<0)&&(f=0),f>this.length||((h===void 0||h>this.length)&&(h=this.length),h<=0)||(h>>>=0,f>>>=0,h<=f))return"";for(g||(g="utf8");;)switch(g){case"hex":return Gt(this,f,h);case"utf8":case"utf-8":return D(this,f,h);case"ascii":return ue(this,f,h);case"latin1":case"binary":return Pe(this,f,h);case"base64":return I(this,f,h);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return yn(this,f,h);default:if(A)throw new TypeError("Unknown encoding: "+g);g=(g+"").toLowerCase(),A=!0}}a.prototype._isBuffer=!0;function T(g,f,h){const A=g[f];g[f]=g[h],g[h]=A}a.prototype.swap16=function(){const f=this.length;if(f%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let h=0;h<f;h+=2)T(this,h,h+1);return this},a.prototype.swap32=function(){const f=this.length;if(f%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let h=0;h<f;h+=4)T(this,h,h+3),T(this,h+1,h+2);return this},a.prototype.swap64=function(){const f=this.length;if(f%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let h=0;h<f;h+=8)T(this,h,h+7),T(this,h+1,h+6),T(this,h+2,h+5),T(this,h+3,h+4);return this},a.prototype.toString=function(){const f=this.length;return f===0?"":arguments.length===0?D(this,0,f):K.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(f){if(!a.isBuffer(f))throw new TypeError("Argument must be a Buffer");return this===f?!0:a.compare(this,f)===0},a.prototype.inspect=function(){let f="";const h=r.INSPECT_MAX_BYTES;return f=this.toString("hex",0,h).replace(/(.{2})/g,"$1 ").trim(),this.length>h&&(f+=" ... "),"<Buffer "+f+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(f,h,A,x,U){if(Er(f,Uint8Array)&&(f=a.from(f,f.offset,f.byteLength)),!a.isBuffer(f))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof f);if(h===void 0&&(h=0),A===void 0&&(A=f?f.length:0),x===void 0&&(x=0),U===void 0&&(U=this.length),h<0||A>f.length||x<0||U>this.length)throw new RangeError("out of range index");if(x>=U&&h>=A)return 0;if(x>=U)return-1;if(h>=A)return 1;if(h>>>=0,A>>>=0,x>>>=0,U>>>=0,this===f)return 0;let H=U-x,Le=A-h;const At=Math.min(H,Le),ht=this.slice(x,U),It=f.slice(h,A);for(let at=0;at<At;++at)if(ht[at]!==It[at]){H=ht[at],Le=It[at];break}return H<Le?-1:Le<H?1:0};function b(g,f,h,A,x){if(g.length===0)return-1;if(typeof h=="string"?(A=h,h=0):h>2147483647?h=2147483647:h<-2147483648&&(h=-2147483648),h=+h,Fl(h)&&(h=x?0:g.length-1),h<0&&(h=g.length+h),h>=g.length){if(x)return-1;h=g.length-1}else if(h<0)if(x)h=0;else return-1;if(typeof f=="string"&&(f=a.from(f,A)),a.isBuffer(f))return f.length===0?-1:_(g,f,h,A,x);if(typeof f=="number")return f=f&255,typeof Uint8Array.prototype.indexOf=="function"?x?Uint8Array.prototype.indexOf.call(g,f,h):Uint8Array.prototype.lastIndexOf.call(g,f,h):_(g,[f],h,A,x);throw new TypeError("val must be string, number or Buffer")}function _(g,f,h,A,x){let U=1,H=g.length,Le=f.length;if(A!==void 0&&(A=String(A).toLowerCase(),A==="ucs2"||A==="ucs-2"||A==="utf16le"||A==="utf-16le")){if(g.length<2||f.length<2)return-1;U=2,H/=2,Le/=2,h/=2}function At(It,at){return U===1?It[at]:It.readUInt16BE(at*U)}let ht;if(x){let It=-1;for(ht=h;ht<H;ht++)if(At(g,ht)===At(f,It===-1?0:ht-It)){if(It===-1&&(It=ht),ht-It+1===Le)return It*U}else It!==-1&&(ht-=ht-It),It=-1}else for(h+Le>H&&(h=H-Le),ht=h;ht>=0;ht--){let It=!0;for(let at=0;at<Le;at++)if(At(g,ht+at)!==At(f,at)){It=!1;break}if(It)return ht}return-1}a.prototype.includes=function(f,h,A){return this.indexOf(f,h,A)!==-1},a.prototype.indexOf=function(f,h,A){return b(this,f,h,A,!0)},a.prototype.lastIndexOf=function(f,h,A){return b(this,f,h,A,!1)};function R(g,f,h,A){h=Number(h)||0;const x=g.length-h;A?(A=Number(A),A>x&&(A=x)):A=x;const U=f.length;A>U/2&&(A=U/2);let H;for(H=0;H<A;++H){const Le=parseInt(f.substr(H*2,2),16);if(Fl(Le))return H;g[h+H]=Le}return H}function W(g,f,h,A){return oc(Ul(f,g.length-h),g,h,A)}function B(g,f,h,A){return oc(ok(f),g,h,A)}function V(g,f,h,A){return oc($h(f),g,h,A)}function q(g,f,h,A){return oc(ak(f,g.length-h),g,h,A)}a.prototype.write=function(f,h,A,x){if(h===void 0)x="utf8",A=this.length,h=0;else if(A===void 0&&typeof h=="string")x=h,A=this.length,h=0;else if(isFinite(h))h=h>>>0,isFinite(A)?(A=A>>>0,x===void 0&&(x="utf8")):(x=A,A=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const U=this.length-h;if((A===void 0||A>U)&&(A=U),f.length>0&&(A<0||h<0)||h>this.length)throw new RangeError("Attempt to write outside buffer bounds");x||(x="utf8");let H=!1;for(;;)switch(x){case"hex":return R(this,f,h,A);case"utf8":case"utf-8":return W(this,f,h,A);case"ascii":case"latin1":case"binary":return B(this,f,h,A);case"base64":return V(this,f,h,A);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,f,h,A);default:if(H)throw new TypeError("Unknown encoding: "+x);x=(""+x).toLowerCase(),H=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(g,f,h){return f===0&&h===g.length?e.fromByteArray(g):e.fromByteArray(g.slice(f,h))}function D(g,f,h){h=Math.min(g.length,h);const A=[];let x=f;for(;x<h;){const U=g[x];let H=null,Le=U>239?4:U>223?3:U>191?2:1;if(x+Le<=h){let At,ht,It,at;switch(Le){case 1:U<128&&(H=U);break;case 2:At=g[x+1],(At&192)===128&&(at=(U&31)<<6|At&63,at>127&&(H=at));break;case 3:At=g[x+1],ht=g[x+2],(At&192)===128&&(ht&192)===128&&(at=(U&15)<<12|(At&63)<<6|ht&63,at>2047&&(at<55296||at>57343)&&(H=at));break;case 4:At=g[x+1],ht=g[x+2],It=g[x+3],(At&192)===128&&(ht&192)===128&&(It&192)===128&&(at=(U&15)<<18|(At&63)<<12|(ht&63)<<6|It&63,at>65535&&at<1114112&&(H=at))}}H===null?(H=65533,Le=1):H>65535&&(H-=65536,A.push(H>>>10&1023|55296),H=56320|H&1023),A.push(H),x+=Le}return Ie(A)}const G=4096;function Ie(g){const f=g.length;if(f<=G)return String.fromCharCode.apply(String,g);let h="",A=0;for(;A<f;)h+=String.fromCharCode.apply(String,g.slice(A,A+=G));return h}function ue(g,f,h){let A="";h=Math.min(g.length,h);for(let x=f;x<h;++x)A+=String.fromCharCode(g[x]&127);return A}function Pe(g,f,h){let A="";h=Math.min(g.length,h);for(let x=f;x<h;++x)A+=String.fromCharCode(g[x]);return A}function Gt(g,f,h){const A=g.length;(!f||f<0)&&(f=0),(!h||h<0||h>A)&&(h=A);let x="";for(let U=f;U<h;++U)x+=ck[g[U]];return x}function yn(g,f,h){const A=g.slice(f,h);let x="";for(let U=0;U<A.length-1;U+=2)x+=String.fromCharCode(A[U]+A[U+1]*256);return x}a.prototype.slice=function(f,h){const A=this.length;f=~~f,h=h===void 0?A:~~h,f<0?(f+=A,f<0&&(f=0)):f>A&&(f=A),h<0?(h+=A,h<0&&(h=0)):h>A&&(h=A),h<f&&(h=f);const x=this.subarray(f,h);return Object.setPrototypeOf(x,a.prototype),x};function ke(g,f,h){if(g%1!==0||g<0)throw new RangeError("offset is not uint");if(g+f>h)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(f,h,A){f=f>>>0,h=h>>>0,A||ke(f,h,this.length);let x=this[f],U=1,H=0;for(;++H<h&&(U*=256);)x+=this[f+H]*U;return x},a.prototype.readUintBE=a.prototype.readUIntBE=function(f,h,A){f=f>>>0,h=h>>>0,A||ke(f,h,this.length);let x=this[f+--h],U=1;for(;h>0&&(U*=256);)x+=this[f+--h]*U;return x},a.prototype.readUint8=a.prototype.readUInt8=function(f,h){return f=f>>>0,h||ke(f,1,this.length),this[f]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(f,h){return f=f>>>0,h||ke(f,2,this.length),this[f]|this[f+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(f,h){return f=f>>>0,h||ke(f,2,this.length),this[f]<<8|this[f+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(f,h){return f=f>>>0,h||ke(f,4,this.length),(this[f]|this[f+1]<<8|this[f+2]<<16)+this[f+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(f,h){return f=f>>>0,h||ke(f,4,this.length),this[f]*16777216+(this[f+1]<<16|this[f+2]<<8|this[f+3])},a.prototype.readBigUInt64LE=oi(function(f){f=f>>>0,Es(f,"offset");const h=this[f],A=this[f+7];(h===void 0||A===void 0)&&Fo(f,this.length-8);const x=h+this[++f]*2**8+this[++f]*2**16+this[++f]*2**24,U=this[++f]+this[++f]*2**8+this[++f]*2**16+A*2**24;return BigInt(x)+(BigInt(U)<<BigInt(32))}),a.prototype.readBigUInt64BE=oi(function(f){f=f>>>0,Es(f,"offset");const h=this[f],A=this[f+7];(h===void 0||A===void 0)&&Fo(f,this.length-8);const x=h*2**24+this[++f]*2**16+this[++f]*2**8+this[++f],U=this[++f]*2**24+this[++f]*2**16+this[++f]*2**8+A;return(BigInt(x)<<BigInt(32))+BigInt(U)}),a.prototype.readIntLE=function(f,h,A){f=f>>>0,h=h>>>0,A||ke(f,h,this.length);let x=this[f],U=1,H=0;for(;++H<h&&(U*=256);)x+=this[f+H]*U;return U*=128,x>=U&&(x-=Math.pow(2,8*h)),x},a.prototype.readIntBE=function(f,h,A){f=f>>>0,h=h>>>0,A||ke(f,h,this.length);let x=h,U=1,H=this[f+--x];for(;x>0&&(U*=256);)H+=this[f+--x]*U;return U*=128,H>=U&&(H-=Math.pow(2,8*h)),H},a.prototype.readInt8=function(f,h){return f=f>>>0,h||ke(f,1,this.length),this[f]&128?(255-this[f]+1)*-1:this[f]},a.prototype.readInt16LE=function(f,h){f=f>>>0,h||ke(f,2,this.length);const A=this[f]|this[f+1]<<8;return A&32768?A|4294901760:A},a.prototype.readInt16BE=function(f,h){f=f>>>0,h||ke(f,2,this.length);const A=this[f+1]|this[f]<<8;return A&32768?A|4294901760:A},a.prototype.readInt32LE=function(f,h){return f=f>>>0,h||ke(f,4,this.length),this[f]|this[f+1]<<8|this[f+2]<<16|this[f+3]<<24},a.prototype.readInt32BE=function(f,h){return f=f>>>0,h||ke(f,4,this.length),this[f]<<24|this[f+1]<<16|this[f+2]<<8|this[f+3]},a.prototype.readBigInt64LE=oi(function(f){f=f>>>0,Es(f,"offset");const h=this[f],A=this[f+7];(h===void 0||A===void 0)&&Fo(f,this.length-8);const x=this[f+4]+this[f+5]*2**8+this[f+6]*2**16+(A<<24);return(BigInt(x)<<BigInt(32))+BigInt(h+this[++f]*2**8+this[++f]*2**16+this[++f]*2**24)}),a.prototype.readBigInt64BE=oi(function(f){f=f>>>0,Es(f,"offset");const h=this[f],A=this[f+7];(h===void 0||A===void 0)&&Fo(f,this.length-8);const x=(h<<24)+this[++f]*2**16+this[++f]*2**8+this[++f];return(BigInt(x)<<BigInt(32))+BigInt(this[++f]*2**24+this[++f]*2**16+this[++f]*2**8+A)}),a.prototype.readFloatLE=function(f,h){return f=f>>>0,h||ke(f,4,this.length),t.read(this,f,!0,23,4)},a.prototype.readFloatBE=function(f,h){return f=f>>>0,h||ke(f,4,this.length),t.read(this,f,!1,23,4)},a.prototype.readDoubleLE=function(f,h){return f=f>>>0,h||ke(f,8,this.length),t.read(this,f,!0,52,8)},a.prototype.readDoubleBE=function(f,h){return f=f>>>0,h||ke(f,8,this.length),t.read(this,f,!1,52,8)};function Ke(g,f,h,A,x,U){if(!a.isBuffer(g))throw new TypeError('"buffer" argument must be a Buffer instance');if(f>x||f<U)throw new RangeError('"value" argument is out of bounds');if(h+A>g.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(f,h,A,x){if(f=+f,h=h>>>0,A=A>>>0,!x){const Le=Math.pow(2,8*A)-1;Ke(this,f,h,A,Le,0)}let U=1,H=0;for(this[h]=f&255;++H<A&&(U*=256);)this[h+H]=f/U&255;return h+A},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(f,h,A,x){if(f=+f,h=h>>>0,A=A>>>0,!x){const Le=Math.pow(2,8*A)-1;Ke(this,f,h,A,Le,0)}let U=A-1,H=1;for(this[h+U]=f&255;--U>=0&&(H*=256);)this[h+U]=f/H&255;return h+A},a.prototype.writeUint8=a.prototype.writeUInt8=function(f,h,A){return f=+f,h=h>>>0,A||Ke(this,f,h,1,255,0),this[h]=f&255,h+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(f,h,A){return f=+f,h=h>>>0,A||Ke(this,f,h,2,65535,0),this[h]=f&255,this[h+1]=f>>>8,h+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(f,h,A){return f=+f,h=h>>>0,A||Ke(this,f,h,2,65535,0),this[h]=f>>>8,this[h+1]=f&255,h+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(f,h,A){return f=+f,h=h>>>0,A||Ke(this,f,h,4,4294967295,0),this[h+3]=f>>>24,this[h+2]=f>>>16,this[h+1]=f>>>8,this[h]=f&255,h+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(f,h,A){return f=+f,h=h>>>0,A||Ke(this,f,h,4,4294967295,0),this[h]=f>>>24,this[h+1]=f>>>16,this[h+2]=f>>>8,this[h+3]=f&255,h+4};function Zt(g,f,h,A,x){si(f,A,x,g,h,7);let U=Number(f&BigInt(4294967295));g[h++]=U,U=U>>8,g[h++]=U,U=U>>8,g[h++]=U,U=U>>8,g[h++]=U;let H=Number(f>>BigInt(32)&BigInt(4294967295));return g[h++]=H,H=H>>8,g[h++]=H,H=H>>8,g[h++]=H,H=H>>8,g[h++]=H,h}function cn(g,f,h,A,x){si(f,A,x,g,h,7);let U=Number(f&BigInt(4294967295));g[h+7]=U,U=U>>8,g[h+6]=U,U=U>>8,g[h+5]=U,U=U>>8,g[h+4]=U;let H=Number(f>>BigInt(32)&BigInt(4294967295));return g[h+3]=H,H=H>>8,g[h+2]=H,H=H>>8,g[h+1]=H,H=H>>8,g[h]=H,h+8}a.prototype.writeBigUInt64LE=oi(function(f,h=0){return Zt(this,f,h,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=oi(function(f,h=0){return cn(this,f,h,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(f,h,A,x){if(f=+f,h=h>>>0,!x){const At=Math.pow(2,8*A-1);Ke(this,f,h,A,At-1,-At)}let U=0,H=1,Le=0;for(this[h]=f&255;++U<A&&(H*=256);)f<0&&Le===0&&this[h+U-1]!==0&&(Le=1),this[h+U]=(f/H>>0)-Le&255;return h+A},a.prototype.writeIntBE=function(f,h,A,x){if(f=+f,h=h>>>0,!x){const At=Math.pow(2,8*A-1);Ke(this,f,h,A,At-1,-At)}let U=A-1,H=1,Le=0;for(this[h+U]=f&255;--U>=0&&(H*=256);)f<0&&Le===0&&this[h+U+1]!==0&&(Le=1),this[h+U]=(f/H>>0)-Le&255;return h+A},a.prototype.writeInt8=function(f,h,A){return f=+f,h=h>>>0,A||Ke(this,f,h,1,127,-128),f<0&&(f=255+f+1),this[h]=f&255,h+1},a.prototype.writeInt16LE=function(f,h,A){return f=+f,h=h>>>0,A||Ke(this,f,h,2,32767,-32768),this[h]=f&255,this[h+1]=f>>>8,h+2},a.prototype.writeInt16BE=function(f,h,A){return f=+f,h=h>>>0,A||Ke(this,f,h,2,32767,-32768),this[h]=f>>>8,this[h+1]=f&255,h+2},a.prototype.writeInt32LE=function(f,h,A){return f=+f,h=h>>>0,A||Ke(this,f,h,4,2147483647,-2147483648),this[h]=f&255,this[h+1]=f>>>8,this[h+2]=f>>>16,this[h+3]=f>>>24,h+4},a.prototype.writeInt32BE=function(f,h,A){return f=+f,h=h>>>0,A||Ke(this,f,h,4,2147483647,-2147483648),f<0&&(f=4294967295+f+1),this[h]=f>>>24,this[h+1]=f>>>16,this[h+2]=f>>>8,this[h+3]=f&255,h+4},a.prototype.writeBigInt64LE=oi(function(f,h=0){return Zt(this,f,h,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=oi(function(f,h=0){return cn(this,f,h,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Ht(g,f,h,A,x,U){if(h+A>g.length)throw new RangeError("Index out of range");if(h<0)throw new RangeError("Index out of range")}function wt(g,f,h,A,x){return f=+f,h=h>>>0,x||Ht(g,f,h,4),t.write(g,f,h,A,23,4),h+4}a.prototype.writeFloatLE=function(f,h,A){return wt(this,f,h,!0,A)},a.prototype.writeFloatBE=function(f,h,A){return wt(this,f,h,!1,A)};function Ar(g,f,h,A,x){return f=+f,h=h>>>0,x||Ht(g,f,h,8),t.write(g,f,h,A,52,8),h+8}a.prototype.writeDoubleLE=function(f,h,A){return Ar(this,f,h,!0,A)},a.prototype.writeDoubleBE=function(f,h,A){return Ar(this,f,h,!1,A)},a.prototype.copy=function(f,h,A,x){if(!a.isBuffer(f))throw new TypeError("argument should be a Buffer");if(A||(A=0),!x&&x!==0&&(x=this.length),h>=f.length&&(h=f.length),h||(h=0),x>0&&x<A&&(x=A),x===A||f.length===0||this.length===0)return 0;if(h<0)throw new RangeError("targetStart out of bounds");if(A<0||A>=this.length)throw new RangeError("Index out of range");if(x<0)throw new RangeError("sourceEnd out of bounds");x>this.length&&(x=this.length),f.length-h<x-A&&(x=f.length-h+A);const U=x-A;return this===f&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(h,A,x):Uint8Array.prototype.set.call(f,this.subarray(A,x),h),U},a.prototype.fill=function(f,h,A,x){if(typeof f=="string"){if(typeof h=="string"?(x=h,h=0,A=this.length):typeof A=="string"&&(x=A,A=this.length),x!==void 0&&typeof x!="string")throw new TypeError("encoding must be a string");if(typeof x=="string"&&!a.isEncoding(x))throw new TypeError("Unknown encoding: "+x);if(f.length===1){const H=f.charCodeAt(0);(x==="utf8"&&H<128||x==="latin1")&&(f=H)}}else typeof f=="number"?f=f&255:typeof f=="boolean"&&(f=Number(f));if(h<0||this.length<h||this.length<A)throw new RangeError("Out of range index");if(A<=h)return this;h=h>>>0,A=A===void 0?this.length:A>>>0,f||(f=0);let U;if(typeof f=="number")for(U=h;U<A;++U)this[U]=f;else{const H=a.isBuffer(f)?f:a.from(f,x),Le=H.length;if(Le===0)throw new TypeError('The value "'+f+'" is invalid for argument "value"');for(U=0;U<A-h;++U)this[U+h]=H[U%Le]}return this};const gn={};function Ir(g,f,h){gn[g]=class extends h{constructor(){super(),Object.defineProperty(this,"message",{value:f.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${g}]`,this.stack,delete this.name}get code(){return g}set code(x){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:x,writable:!0})}toString(){return`${this.name} [${g}]: ${this.message}`}}}Ir("ERR_BUFFER_OUT_OF_BOUNDS",function(g){return g?`${g} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ir("ERR_INVALID_ARG_TYPE",function(g,f){return`The "${g}" argument must be of type number. Received type ${typeof f}`},TypeError),Ir("ERR_OUT_OF_RANGE",function(g,f,h){let A=`The value of "${g}" is out of range.`,x=h;return Number.isInteger(h)&&Math.abs(h)>2**32?x=ii(String(h)):typeof h=="bigint"&&(x=String(h),(h>BigInt(2)**BigInt(32)||h<-(BigInt(2)**BigInt(32)))&&(x=ii(x)),x+="n"),A+=` It must be ${f}. Received ${x}`,A},RangeError);function ii(g){let f="",h=g.length;const A=g[0]==="-"?1:0;for(;h>=A+4;h-=3)f=`_${g.slice(h-3,h)}${f}`;return`${g.slice(0,h)}${f}`}function Li(g,f,h){Es(f,"offset"),(g[f]===void 0||g[f+h]===void 0)&&Fo(f,g.length-(h+1))}function si(g,f,h,A,x,U){if(g>h||g<f){const H=typeof f=="bigint"?"n":"";let Le;throw U>3?f===0||f===BigInt(0)?Le=`>= 0${H} and < 2${H} ** ${(U+1)*8}${H}`:Le=`>= -(2${H} ** ${(U+1)*8-1}${H}) and < 2 ** ${(U+1)*8-1}${H}`:Le=`>= ${f}${H} and <= ${h}${H}`,new gn.ERR_OUT_OF_RANGE("value",Le,g)}Li(A,x,U)}function Es(g,f){if(typeof g!="number")throw new gn.ERR_INVALID_ARG_TYPE(f,"number",g)}function Fo(g,f,h){throw Math.floor(g)!==g?(Es(g,h),new gn.ERR_OUT_OF_RANGE(h||"offset","an integer",g)):f<0?new gn.ERR_BUFFER_OUT_OF_BOUNDS:new gn.ERR_OUT_OF_RANGE(h||"offset",`>= ${h?1:0} and <= ${f}`,g)}const ik=/[^+/0-9A-Za-z-_]/g;function sk(g){if(g=g.split("=")[0],g=g.trim().replace(ik,""),g.length<2)return"";for(;g.length%4!==0;)g=g+"=";return g}function Ul(g,f){f=f||1/0;let h;const A=g.length;let x=null;const U=[];for(let H=0;H<A;++H){if(h=g.charCodeAt(H),h>55295&&h<57344){if(!x){if(h>56319){(f-=3)>-1&&U.push(239,191,189);continue}else if(H+1===A){(f-=3)>-1&&U.push(239,191,189);continue}x=h;continue}if(h<56320){(f-=3)>-1&&U.push(239,191,189),x=h;continue}h=(x-55296<<10|h-56320)+65536}else x&&(f-=3)>-1&&U.push(239,191,189);if(x=null,h<128){if((f-=1)<0)break;U.push(h)}else if(h<2048){if((f-=2)<0)break;U.push(h>>6|192,h&63|128)}else if(h<65536){if((f-=3)<0)break;U.push(h>>12|224,h>>6&63|128,h&63|128)}else if(h<1114112){if((f-=4)<0)break;U.push(h>>18|240,h>>12&63|128,h>>6&63|128,h&63|128)}else throw new Error("Invalid code point")}return U}function ok(g){const f=[];for(let h=0;h<g.length;++h)f.push(g.charCodeAt(h)&255);return f}function ak(g,f){let h,A,x;const U=[];for(let H=0;H<g.length&&!((f-=2)<0);++H)h=g.charCodeAt(H),A=h>>8,x=h%256,U.push(x),U.push(A);return U}function $h(g){return e.toByteArray(sk(g))}function oc(g,f,h,A){let x;for(x=0;x<A&&!(x+h>=f.length||x>=g.length);++x)f[x+h]=g[x];return x}function Er(g,f){return g instanceof f||g!=null&&g.constructor!=null&&g.constructor.name!=null&&g.constructor.name===f.name}function Fl(g){return g!==g}const ck=function(){const g="0123456789abcdef",f=new Array(256);for(let h=0;h<16;++h){const A=h*16;for(let x=0;x<16;++x)f[A+x]=g[h]+g[x]}return f}();function oi(g){return typeof BigInt>"u"?uk:g}function uk(){throw new Error("BigInt not supported")}})(Ye);var xI=typeof we.global<"u"?we.global:typeof self<"u"?self:typeof window<"u"?window:{},Gd;typeof Object.create=="function"?Gd=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:Gd=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e};var CI=Gd;function Yi(r,e){var t={seen:[],stylize:LI};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),Ym(e)?t.showHidden=e:e&&VI(t,e),zs(t.showHidden)&&(t.showHidden=!1),zs(t.depth)&&(t.depth=2),zs(t.colors)&&(t.colors=!1),zs(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=MI),Hc(t,r,t.depth)}Yi.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Yi.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function MI(r,e){var t=Yi.styles[e];return t?"\x1B["+Yi.colors[t][0]+"m"+r+"\x1B["+Yi.colors[t][1]+"m":r}function LI(r,e){return r}function KI(r){var e={};return r.forEach(function(t,n){e[t]=!0}),e}function Hc(r,e,t){if(r.customInspect&&e&&ca(e.inspect)&&e.inspect!==Yi&&!(e.constructor&&e.constructor.prototype===e)){var n=e.inspect(t,r);return Qm(n)||(n=Hc(r,n,t)),n}var i=NI(r,e);if(i)return i;var s=Object.keys(e),o=KI(s);if(r.showHidden&&(s=Object.getOwnPropertyNames(e)),Mc(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return ad(e);if(s.length===0){if(ca(e)){var a=e.name?": "+e.name:"";return r.stylize("[Function"+a+"]","special")}if(aa(e))return r.stylize(RegExp.prototype.toString.call(e),"regexp");if(Yc(e))return r.stylize(Date.prototype.toString.call(e),"date");if(Mc(e))return ad(e)}var c="",l=!1,u=["{","}"];if(zI(e)&&(l=!0,u=["[","]"]),ca(e)){var d=e.name?": "+e.name:"";c=" [Function"+d+"]"}if(aa(e)&&(c=" "+RegExp.prototype.toString.call(e)),Yc(e)&&(c=" "+Date.prototype.toUTCString.call(e)),Mc(e)&&(c=" "+ad(e)),s.length===0&&(!l||e.length==0))return u[0]+c+u[1];if(t<0)return aa(e)?r.stylize(RegExp.prototype.toString.call(e),"regexp"):r.stylize("[Object]","special");r.seen.push(e);var m;return l?m=$I(r,e,t,o,s):m=s.map(function(y){return Hd(r,e,t,o,y,l)}),r.seen.pop(),DI(m,c,u)}function NI(r,e){if(zs(e))return r.stylize("undefined","undefined");if(Qm(e)){var t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(t,"string")}if(WI(e))return r.stylize(""+e,"number");if(Ym(e))return r.stylize(""+e,"boolean");if(Jm(e))return r.stylize("null","null")}function ad(r){return"["+Error.prototype.toString.call(r)+"]"}function $I(r,e,t,n,i){for(var s=[],o=0,a=e.length;o<a;++o)Xm(e,String(o))?s.push(Hd(r,e,t,n,String(o),!0)):s.push("");return i.forEach(function(c){c.match(/^\d+$/)||s.push(Hd(r,e,t,n,c,!0))}),s}function Hd(r,e,t,n,i,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},c.get?c.set?a=r.stylize("[Getter/Setter]","special"):a=r.stylize("[Getter]","special"):c.set&&(a=r.stylize("[Setter]","special")),Xm(n,i)||(o="["+i+"]"),a||(r.seen.indexOf(c.value)<0?(Jm(t)?a=Hc(r,c.value,null):a=Hc(r,c.value,t-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(l){return"  "+l}).join(`
`).substr(2):a=`
`+a.split(`
`).map(function(l){return"   "+l}).join(`
`))):a=r.stylize("[Circular]","special")),zs(o)){if(s&&i.match(/^\d+$/))return a;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=r.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=r.stylize(o,"string"))}return o+": "+a}function DI(r,e,t){var n=r.reduce(function(i,s){return s.indexOf(`
`)>=0,i+s.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?t[0]+(e===""?"":e+`
 `)+" "+r.join(`,
  `)+" "+t[1]:t[0]+e+" "+r.join(", ")+" "+t[1]}function zI(r){return Array.isArray(r)}function Ym(r){return typeof r=="boolean"}function Jm(r){return r===null}function WI(r){return typeof r=="number"}function Qm(r){return typeof r=="string"}function zs(r){return r===void 0}function aa(r){return Zu(r)&&dh(r)==="[object RegExp]"}function Zu(r){return typeof r=="object"&&r!==null}function Yc(r){return Zu(r)&&dh(r)==="[object Date]"}function Mc(r){return Zu(r)&&(dh(r)==="[object Error]"||r instanceof Error)}function ca(r){return typeof r=="function"}function Wp(r){return r===null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||typeof r=="symbol"||typeof r>"u"}function dh(r){return Object.prototype.toString.call(r)}function VI(r,e){if(!e||!Zu(e))return r;for(var t=Object.keys(e),n=t.length;n--;)r[t[n]]=e[t[n]];return r}function Xm(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Vp(r,e){if(r===e)return 0;for(var t=r.length,n=e.length,i=0,s=Math.min(t,n);i<s;++i)if(r[i]!==e[i]){t=r[i],n=e[i];break}return t<n?-1:n<t?1:0}var UI=Object.prototype.hasOwnProperty,Up=Object.keys||function(r){var e=[];for(var t in r)UI.call(r,t)&&e.push(t);return e},Fp=Array.prototype.slice,cd;function Zm(){return typeof cd<"u"?cd:cd=function(){return function(){}.name==="foo"}()}function jp(r){return Object.prototype.toString.call(r)}function qp(r){return Ye.isBuffer(r)||typeof xI.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r?!!(r instanceof DataView||r.buffer&&r.buffer instanceof ArrayBuffer):!1}function fn(r,e){r||Mn(r,!0,e,"==",hh)}var FI=/\s*function\s+([^\(\s]*)\s*/;function eb(r){if(!!ca(r)){if(Zm())return r.name;var e=r.toString(),t=e.match(FI);return t&&t[1]}}fn.AssertionError=fh;function fh(r){this.name="AssertionError",this.actual=r.actual,this.expected=r.expected,this.operator=r.operator,r.message?(this.message=r.message,this.generatedMessage=!1):(this.message=jI(this),this.generatedMessage=!0);var e=r.stackStartFunction||Mn;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var t=new Error;if(t.stack){var n=t.stack,i=eb(e),s=n.indexOf(`
`+i);if(s>=0){var o=n.indexOf(`
`,s+1);n=n.substring(o+1)}this.stack=n}}}CI(fh,Error);function Gp(r,e){return typeof r=="string"?r.length<e?r:r.slice(0,e):r}function Hp(r){if(Zm()||!ca(r))return Yi(r);var e=eb(r),t=e?": "+e:"";return"[Function"+t+"]"}function jI(r){return Gp(Hp(r.actual),128)+" "+r.operator+" "+Gp(Hp(r.expected),128)}function Mn(r,e,t,n,i){throw new fh({message:t,actual:r,expected:e,operator:n,stackStartFunction:i})}fn.fail=Mn;function hh(r,e){r||Mn(r,!0,e,"==",hh)}fn.ok=hh;fn.equal=tb;function tb(r,e,t){r!=e&&Mn(r,e,t,"==",tb)}fn.notEqual=nb;function nb(r,e,t){r==e&&Mn(r,e,t,"!=",nb)}fn.deepEqual=rb;function rb(r,e,t){uo(r,e,!1)||Mn(r,e,t,"deepEqual",rb)}fn.deepStrictEqual=ib;function ib(r,e,t){uo(r,e,!0)||Mn(r,e,t,"deepStrictEqual",ib)}function uo(r,e,t,n){if(r===e)return!0;if(Ye.isBuffer(r)&&Ye.isBuffer(e))return Vp(r,e)===0;if(Yc(r)&&Yc(e))return r.getTime()===e.getTime();if(aa(r)&&aa(e))return r.source===e.source&&r.global===e.global&&r.multiline===e.multiline&&r.lastIndex===e.lastIndex&&r.ignoreCase===e.ignoreCase;if((r===null||typeof r!="object")&&(e===null||typeof e!="object"))return t?r===e:r==e;if(qp(r)&&qp(e)&&jp(r)===jp(e)&&!(r instanceof Float32Array||r instanceof Float64Array))return Vp(new Uint8Array(r.buffer),new Uint8Array(e.buffer))===0;if(Ye.isBuffer(r)!==Ye.isBuffer(e))return!1;n=n||{actual:[],expected:[]};var i=n.actual.indexOf(r);return i!==-1&&i===n.expected.indexOf(e)?!0:(n.actual.push(r),n.expected.push(e),qI(r,e,t,n))}function Yp(r){return Object.prototype.toString.call(r)=="[object Arguments]"}function qI(r,e,t,n){if(r==null||e===null||e===void 0)return!1;if(Wp(r)||Wp(e))return r===e;if(t&&Object.getPrototypeOf(r)!==Object.getPrototypeOf(e))return!1;var i=Yp(r),s=Yp(e);if(i&&!s||!i&&s)return!1;if(i)return r=Fp.call(r),e=Fp.call(e),uo(r,e,t);var o=Up(r),a=Up(e),c,l;if(o.length!==a.length)return!1;for(o.sort(),a.sort(),l=o.length-1;l>=0;l--)if(o[l]!==a[l])return!1;for(l=o.length-1;l>=0;l--)if(c=o[l],!uo(r[c],e[c],t,n))return!1;return!0}fn.notDeepEqual=sb;function sb(r,e,t){uo(r,e,!1)&&Mn(r,e,t,"notDeepEqual",sb)}fn.notDeepStrictEqual=ob;function ob(r,e,t){uo(r,e,!0)&&Mn(r,e,t,"notDeepStrictEqual",ob)}fn.strictEqual=ab;function ab(r,e,t){r!==e&&Mn(r,e,t,"===",ab)}fn.notStrictEqual=cb;function cb(r,e,t){r===e&&Mn(r,e,t,"!==",cb)}function Jp(r,e){if(!r||!e)return!1;if(Object.prototype.toString.call(e)=="[object RegExp]")return e.test(r);try{if(r instanceof e)return!0}catch{}return Error.isPrototypeOf(e)?!1:e.call({},r)===!0}function GI(r){var e;try{r()}catch(t){e=t}return e}function ub(r,e,t,n){var i;if(typeof e!="function")throw new TypeError('"block" argument must be a function');typeof t=="string"&&(n=t,t=null),i=GI(e),n=(t&&t.name?" ("+t.name+").":".")+(n?" "+n:"."),r&&!i&&Mn(i,t,"Missing expected exception"+n);var s=typeof n=="string",o=!r&&Mc(i),a=!r&&i&&!t;if((o&&s&&Jp(i,t)||a)&&Mn(i,t,"Got unwanted exception"+n),r&&i&&t&&!Jp(i,t)||!r&&i)throw i}fn.throws=HI;function HI(r,e,t){ub(!0,r,e,t)}fn.doesNotThrow=YI;function YI(r,e,t){ub(!1,r,e,t)}fn.ifError=JI;function JI(r){if(r)throw r}class Ia{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}decode(e,t){throw new Error("Layout is abstract")}encode(e,t,n){throw new Error("Layout is abstract")}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}function QI(r,e){return e.property?r+"["+e.property+"]":r}class dc extends Ia{isCount(){throw new Error("ExternalLayout is abstract")}}class lb extends Ia{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntLE(t,this.span)}encode(e,t,n){return n===void 0&&(n=0),t.writeUIntLE(e,n,this.span),this.span}}class XI extends Ia{constructor(e,t,n){if(!(Array.isArray(e)&&e.reduce((s,o)=>s&&o instanceof Ia,!0)))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&n===void 0&&(n=t,t=void 0);for(const s of e)if(0>s.span&&s.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let i=-1;try{i=e.reduce((s,o)=>s+o.getSpan(),0)}catch{}super(i,t),this.fields=e,this.decodePrefixes=!!n}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let n=0;try{n=this.fields.reduce((i,s)=>{const o=s.getSpan(e,t);return t+=o,i+o},0)}catch{throw new RangeError("indeterminate span")}return n}decode(e,t){t===void 0&&(t=0);const n=this.makeDestinationObject();for(const i of this.fields)if(i.property!==void 0&&(n[i.property]=i.decode(e,t)),t+=i.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return n}encode(e,t,n){n===void 0&&(n=0);const i=n;let s=0,o=0;for(const a of this.fields){let c=a.span;if(o=0<c?c:0,a.property!==void 0){const l=e[a.property];l!==void 0&&(o=a.encode(l,t,n),0>c&&(c=a.getSpan(t,n)))}s=n,n+=c}return s+o-i}fromArray(e){const t=this.makeDestinationObject();for(const n of this.fields)n.property!==void 0&&0<e.length&&(t[n.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const n of this.fields){if(n.property===e)return t;0>n.span?t=-1:0<=t&&(t+=n.span)}}}class ZI extends Ia{constructor(e,t){if(!(e instanceof dc&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;e instanceof dc||(n=e),super(n,t),this.length=e}getSpan(e,t){let n=this.span;return 0>n&&(n=this.length.decode(e,t)),n}decode(e,t){t===void 0&&(t=0);let n=this.span;return 0>n&&(n=this.length.decode(e,t)),e.slice(t,t+n)}encode(e,t,n){let i=this.length;if(this.length instanceof dc&&(i=e.length),!(Ye.Buffer.isBuffer(e)&&i===e.length))throw new TypeError(QI("Blob.encode",this)+" requires (length "+i+") Buffer as src");if(n+i>t.length)throw new RangeError("encoding overruns Buffer");return t.write(e.toString("hex"),n,i,"hex"),this.length instanceof dc&&this.length.encode(i,t,n),i}}var Fe=r=>new lb(1,r),ua=r=>new lb(4,r),xt=(r,e,t)=>new XI(r,e,t),db=(r,e)=>new ZI(r,e);const Ct=(r="publicKey")=>db(32,r),tr=(r="uint64")=>db(8,r);function zt(r,e,t,...n){return X0(e,t,n,{skipPreflight:!1})}const eE=new de("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),fb=new de("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"),Qp="Failed to find account",Xp="Invalid account owner";function ud(r){return Ye.Buffer.from(r.toBuffer())}class un extends kn{toBuffer(){const e=super.toArray().reverse(),t=Ye.Buffer.from(e);if(t.length===8)return t;fn(t.length<8,"u64 too large");const n=Ye.Buffer.alloc(8);return t.copy(n),n}static fromBuffer(e){return fn(e.length===8,`Invalid buffer length: ${e.length}`),new un([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}function $n(r){return"publicKey"in r}const tE={MintTokens:0,FreezeAccount:1,AccountOwner:2,CloseAccount:3},hb=new de("So11111111111111111111111111111111111111112"),ta=xt([ua("mintAuthorityOption"),Ct("mintAuthority"),tr("supply"),Fe("decimals"),Fe("isInitialized"),ua("freezeAuthorityOption"),Ct("freezeAuthority")]),Cs=xt([Ct("mint"),Ct("owner"),tr("amount"),ua("delegateOption"),Ct("delegate"),Fe("state"),ua("isNativeOption"),tr("isNative"),tr("delegatedAmount"),ua("closeAuthorityOption"),Ct("closeAuthority")]),fc=xt([Fe("m"),Fe("n"),Fe("is_initialized"),Ct("signer1"),Ct("signer2"),Ct("signer3"),Ct("signer4"),Ct("signer5"),Ct("signer6"),Ct("signer7"),Ct("signer8"),Ct("signer9"),Ct("signer10"),Ct("signer11")]);class ct{constructor(e,t,n,i){jo(this,"connection",void 0),jo(this,"publicKey",void 0),jo(this,"programId",void 0),jo(this,"associatedProgramId",void 0),jo(this,"payer",void 0),Object.assign(this,{connection:e,publicKey:t,programId:n,payer:i,associatedProgramId:fb})}static async getMinBalanceRentForExemptMint(e){return await e.getMinimumBalanceForRentExemption(ta.span)}static async getMinBalanceRentForExemptAccount(e){return await e.getMinimumBalanceForRentExemption(Cs.span)}static async getMinBalanceRentForExemptMultisig(e){return await e.getMinimumBalanceForRentExemption(fc.span)}static async createMint(e,t,n,i,s,o){const a=di.generate(),c=new ct(e,a.publicKey,o,t),l=await ct.getMinBalanceRentForExemptMint(e),u=new vt;return u.add(Br.createAccount({fromPubkey:t.publicKey,newAccountPubkey:a.publicKey,lamports:l,space:ta.span,programId:o})),u.add(ct.createInitMintInstruction(o,a.publicKey,s,n,i)),await zt("createAccount and InitializeMint",e,u,t,a),c}async createAccount(e){const t=await ct.getMinBalanceRentForExemptAccount(this.connection),n=di.generate(),i=new vt;i.add(Br.createAccount({fromPubkey:this.payer.publicKey,newAccountPubkey:n.publicKey,lamports:t,space:Cs.span,programId:this.programId}));const s=this.publicKey;return i.add(ct.createInitAccountInstruction(this.programId,s,n.publicKey,e)),await zt("createAccount and InitializeAccount",this.connection,i,this.payer,n),n.publicKey}async createAssociatedTokenAccount(e){const t=await ct.getAssociatedTokenAddress(this.associatedProgramId,this.programId,this.publicKey,e);return this.createAssociatedTokenAccountInternal(e,t)}async createAssociatedTokenAccountInternal(e,t){return await zt("CreateAssociatedTokenAccount",this.connection,new vt().add(ct.createAssociatedTokenAccountInstruction(this.associatedProgramId,this.programId,this.publicKey,t,e,this.payer.publicKey)),this.payer),t}async getOrCreateAssociatedAccountInfo(e){const t=await ct.getAssociatedTokenAddress(this.associatedProgramId,this.programId,this.publicKey,e);try{return await this.getAccountInfo(t)}catch(n){if(n.message===Qp||n.message===Xp){try{await this.createAssociatedTokenAccountInternal(e,t)}catch{}return await this.getAccountInfo(t)}else throw n}}static async createWrappedNativeAccount(e,t,n,i,s){const o=await ct.getMinBalanceRentForExemptAccount(e),a=di.generate(),c=new vt;return c.add(Br.createAccount({fromPubkey:i.publicKey,newAccountPubkey:a.publicKey,lamports:o,space:Cs.span,programId:t})),c.add(Br.transfer({fromPubkey:i.publicKey,toPubkey:a.publicKey,lamports:s})),c.add(ct.createInitAccountInstruction(t,hb,a.publicKey,n)),await zt("createAccount, transfer, and initializeAccount",e,c,i,a),a.publicKey}async createMultisig(e,t){const n=di.generate(),i=await ct.getMinBalanceRentForExemptMultisig(this.connection),s=new vt;s.add(Br.createAccount({fromPubkey:this.payer.publicKey,newAccountPubkey:n.publicKey,lamports:i,space:fc.span,programId:this.programId}));let o=[{pubkey:n.publicKey,isSigner:!1,isWritable:!0},{pubkey:Ds,isSigner:!1,isWritable:!1}];t.forEach(l=>o.push({pubkey:l,isSigner:!1,isWritable:!1}));const a=xt([Fe("instruction"),Fe("m")]),c=Ye.Buffer.alloc(a.span);return a.encode({instruction:2,m:e},c),s.add({keys:o,programId:this.programId,data:c}),await zt("createAccount and InitializeMultisig",this.connection,s,this.payer,n),n.publicKey}async getMintInfo(){const e=await this.connection.getAccountInfo(this.publicKey);if(e===null)throw new Error("Failed to find mint account");if(!e.owner.equals(this.programId))throw new Error(`Invalid mint owner: ${JSON.stringify(e.owner)}`);if(e.data.length!=ta.span)throw new Error("Invalid mint size");const t=Ye.Buffer.from(e.data),n=ta.decode(t);return n.mintAuthorityOption===0?n.mintAuthority=null:n.mintAuthority=new de(n.mintAuthority),n.supply=un.fromBuffer(n.supply),n.isInitialized=n.isInitialized!=0,n.freezeAuthorityOption===0?n.freezeAuthority=null:n.freezeAuthority=new de(n.freezeAuthority),n}async getAccountInfo(e,t){const n=await this.connection.getAccountInfo(e,t);if(n===null)throw new Error(Qp);if(!n.owner.equals(this.programId))throw new Error(Xp);if(n.data.length!=Cs.span)throw new Error("Invalid account size");const i=Ye.Buffer.from(n.data),s=Cs.decode(i);if(s.address=e,s.mint=new de(s.mint),s.owner=new de(s.owner),s.amount=un.fromBuffer(s.amount),s.delegateOption===0?(s.delegate=null,s.delegatedAmount=new un):(s.delegate=new de(s.delegate),s.delegatedAmount=un.fromBuffer(s.delegatedAmount)),s.isInitialized=s.state!==0,s.isFrozen=s.state===2,s.isNativeOption===1?(s.rentExemptReserve=un.fromBuffer(s.isNative),s.isNative=!0):(s.rentExemptReserve=null,s.isNative=!1),s.closeAuthorityOption===0?s.closeAuthority=null:s.closeAuthority=new de(s.closeAuthority),!s.mint.equals(this.publicKey))throw new Error(`Invalid account mint: ${JSON.stringify(s.mint)} !== ${JSON.stringify(this.publicKey)}`);return s}async getMultisigInfo(e){const t=await this.connection.getAccountInfo(e);if(t===null)throw new Error("Failed to find multisig");if(!t.owner.equals(this.programId))throw new Error("Invalid multisig owner");if(t.data.length!=fc.span)throw new Error("Invalid multisig size");const n=Ye.Buffer.from(t.data),i=fc.decode(n);return i.signer1=new de(i.signer1),i.signer2=new de(i.signer2),i.signer3=new de(i.signer3),i.signer4=new de(i.signer4),i.signer5=new de(i.signer5),i.signer6=new de(i.signer6),i.signer7=new de(i.signer7),i.signer8=new de(i.signer8),i.signer9=new de(i.signer9),i.signer10=new de(i.signer10),i.signer11=new de(i.signer11),i}async transfer(e,t,n,i,s){let o,a;return $n(n)?(o=n.publicKey,a=[n]):(o=n,a=i),await zt("Transfer",this.connection,new vt().add(ct.createTransferInstruction(this.programId,e,t,o,i,s)),this.payer,...a)}async approve(e,t,n,i,s){let o,a;$n(n)?(o=n.publicKey,a=[n]):(o=n,a=i),await zt("Approve",this.connection,new vt().add(ct.createApproveInstruction(this.programId,e,t,o,i,s)),this.payer,...a)}async revoke(e,t,n){let i,s;$n(t)?(i=t.publicKey,s=[t]):(i=t,s=n),await zt("Revoke",this.connection,new vt().add(ct.createRevokeInstruction(this.programId,e,i,n)),this.payer,...s)}async setAuthority(e,t,n,i,s){let o,a;$n(i)?(o=i.publicKey,a=[i]):(o=i,a=s),await zt("SetAuthority",this.connection,new vt().add(ct.createSetAuthorityInstruction(this.programId,e,t,n,o,s)),this.payer,...a)}async mintTo(e,t,n,i){let s,o;$n(t)?(s=t.publicKey,o=[t]):(s=t,o=n),await zt("MintTo",this.connection,new vt().add(ct.createMintToInstruction(this.programId,this.publicKey,e,s,n,i)),this.payer,...o)}async burn(e,t,n,i){let s,o;$n(t)?(s=t.publicKey,o=[t]):(s=t,o=n),await zt("Burn",this.connection,new vt().add(ct.createBurnInstruction(this.programId,this.publicKey,e,s,n,i)),this.payer,...o)}async closeAccount(e,t,n,i){let s,o;$n(n)?(s=n.publicKey,o=[n]):(s=n,o=i),await zt("CloseAccount",this.connection,new vt().add(ct.createCloseAccountInstruction(this.programId,e,t,s,i)),this.payer,...o)}async freezeAccount(e,t,n){let i,s;$n(t)?(i=t.publicKey,s=[t]):(i=t,s=n),await zt("FreezeAccount",this.connection,new vt().add(ct.createFreezeAccountInstruction(this.programId,e,this.publicKey,i,n)),this.payer,...s)}async thawAccount(e,t,n){let i,s;$n(t)?(i=t.publicKey,s=[t]):(i=t,s=n),await zt("ThawAccount",this.connection,new vt().add(ct.createThawAccountInstruction(this.programId,e,this.publicKey,i,n)),this.payer,...s)}async transferChecked(e,t,n,i,s,o){let a,c;return $n(n)?(a=n.publicKey,c=[n]):(a=n,c=i),await zt("TransferChecked",this.connection,new vt().add(ct.createTransferCheckedInstruction(this.programId,e,this.publicKey,t,a,i,s,o)),this.payer,...c)}async approveChecked(e,t,n,i,s,o){let a,c;$n(n)?(a=n.publicKey,c=[n]):(a=n,c=i),await zt("ApproveChecked",this.connection,new vt().add(ct.createApproveCheckedInstruction(this.programId,e,this.publicKey,t,a,i,s,o)),this.payer,...c)}async mintToChecked(e,t,n,i,s){let o,a;$n(t)?(o=t.publicKey,a=[t]):(o=t,a=n),await zt("MintToChecked",this.connection,new vt().add(ct.createMintToCheckedInstruction(this.programId,this.publicKey,e,o,n,i,s)),this.payer,...a)}async burnChecked(e,t,n,i,s){let o,a;$n(t)?(o=t.publicKey,a=[t]):(o=t,a=n),await zt("BurnChecked",this.connection,new vt().add(ct.createBurnCheckedInstruction(this.programId,this.publicKey,e,o,n,i,s)),this.payer,...a)}async syncNative(e){await zt("SyncNative",this.connection,new vt().add(ct.createSyncNativeInstruction(this.programId,e)),this.payer)}static createInitMintInstruction(e,t,n,i,s){let o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Ds,isSigner:!1,isWritable:!1}];const a=xt([Fe("instruction"),Fe("decimals"),Ct("mintAuthority"),Fe("option"),Ct("freezeAuthority")]);let c=Ye.Buffer.alloc(1024);{const l=a.encode({instruction:0,decimals:n,mintAuthority:ud(i),option:s===null?0:1,freezeAuthority:ud(s||new de(0))},c);c=c.slice(0,l)}return new nt({keys:o,programId:e,data:c})}static createInitAccountInstruction(e,t,n,i){const s=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:Ds,isSigner:!1,isWritable:!1}],o=xt([Fe("instruction")]),a=Ye.Buffer.alloc(o.span);return o.encode({instruction:1},a),new nt({keys:s,programId:e,data:a})}static createTransferInstruction(e,t,n,i,s,o){const a=xt([Fe("instruction"),tr("amount")]),c=Ye.Buffer.alloc(a.span);a.encode({instruction:3,amount:new un(o).toBuffer()},c);let l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0}];return s.length===0?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new nt({keys:l,programId:e,data:c})}static createApproveInstruction(e,t,n,i,s,o){const a=xt([Fe("instruction"),tr("amount")]),c=Ye.Buffer.alloc(a.span);a.encode({instruction:4,amount:new un(o).toBuffer()},c);let l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1}];return s.length===0?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new nt({keys:l,programId:e,data:c})}static createRevokeInstruction(e,t,n,i){const s=xt([Fe("instruction")]),o=Ye.Buffer.alloc(s.span);s.encode({instruction:5},o);let a=[{pubkey:t,isSigner:!1,isWritable:!0}];return i.length===0?a.push({pubkey:n,isSigner:!0,isWritable:!1}):(a.push({pubkey:n,isSigner:!1,isWritable:!1}),i.forEach(c=>a.push({pubkey:c.publicKey,isSigner:!0,isWritable:!1}))),new nt({keys:a,programId:e,data:o})}static createSetAuthorityInstruction(e,t,n,i,s,o){const a=xt([Fe("instruction"),Fe("authorityType"),Fe("option"),Ct("newAuthority")]);let c=Ye.Buffer.alloc(1024);{const u=a.encode({instruction:6,authorityType:tE[i],option:n===null?0:1,newAuthority:ud(n||new de(0))},c);c=c.slice(0,u)}let l=[{pubkey:t,isSigner:!1,isWritable:!0}];return o.length===0?l.push({pubkey:s,isSigner:!0,isWritable:!1}):(l.push({pubkey:s,isSigner:!1,isWritable:!1}),o.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new nt({keys:l,programId:e,data:c})}static createMintToInstruction(e,t,n,i,s,o){const a=xt([Fe("instruction"),tr("amount")]),c=Ye.Buffer.alloc(a.span);a.encode({instruction:7,amount:new un(o).toBuffer()},c);let l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0}];return s.length===0?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new nt({keys:l,programId:e,data:c})}static createBurnInstruction(e,t,n,i,s,o){const a=xt([Fe("instruction"),tr("amount")]),c=Ye.Buffer.alloc(a.span);a.encode({instruction:8,amount:new un(o).toBuffer()},c);let l=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}];return s.length===0?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new nt({keys:l,programId:e,data:c})}static createCloseAccountInstruction(e,t,n,i,s){const o=xt([Fe("instruction")]),a=Ye.Buffer.alloc(o.span);o.encode({instruction:9},a);let c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0}];return s.length===0?c.push({pubkey:i,isSigner:!0,isWritable:!1}):(c.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(l=>c.push({pubkey:l.publicKey,isSigner:!0,isWritable:!1}))),new nt({keys:c,programId:e,data:a})}static createFreezeAccountInstruction(e,t,n,i,s){const o=xt([Fe("instruction")]),a=Ye.Buffer.alloc(o.span);o.encode({instruction:10},a);let c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1}];return s.length===0?c.push({pubkey:i,isSigner:!0,isWritable:!1}):(c.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(l=>c.push({pubkey:l.publicKey,isSigner:!0,isWritable:!1}))),new nt({keys:c,programId:e,data:a})}static createThawAccountInstruction(e,t,n,i,s){const o=xt([Fe("instruction")]),a=Ye.Buffer.alloc(o.span);o.encode({instruction:11},a);let c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1}];return s.length===0?c.push({pubkey:i,isSigner:!0,isWritable:!1}):(c.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(l=>c.push({pubkey:l.publicKey,isSigner:!0,isWritable:!1}))),new nt({keys:c,programId:e,data:a})}static createTransferCheckedInstruction(e,t,n,i,s,o,a,c){const l=xt([Fe("instruction"),tr("amount"),Fe("decimals")]),u=Ye.Buffer.alloc(l.span);l.encode({instruction:12,amount:new un(a).toBuffer(),decimals:c},u);let d=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0}];return o.length===0?d.push({pubkey:s,isSigner:!0,isWritable:!1}):(d.push({pubkey:s,isSigner:!1,isWritable:!1}),o.forEach(m=>d.push({pubkey:m.publicKey,isSigner:!0,isWritable:!1}))),new nt({keys:d,programId:e,data:u})}static createApproveCheckedInstruction(e,t,n,i,s,o,a,c){const l=xt([Fe("instruction"),tr("amount"),Fe("decimals")]),u=Ye.Buffer.alloc(l.span);l.encode({instruction:13,amount:new un(a).toBuffer(),decimals:c},u);let d=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1}];return o.length===0?d.push({pubkey:s,isSigner:!0,isWritable:!1}):(d.push({pubkey:s,isSigner:!1,isWritable:!1}),o.forEach(m=>d.push({pubkey:m.publicKey,isSigner:!0,isWritable:!1}))),new nt({keys:d,programId:e,data:u})}static createMintToCheckedInstruction(e,t,n,i,s,o,a){const c=xt([Fe("instruction"),tr("amount"),Fe("decimals")]),l=Ye.Buffer.alloc(c.span);c.encode({instruction:14,amount:new un(o).toBuffer(),decimals:a},l);let u=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0}];return s.length===0?u.push({pubkey:i,isSigner:!0,isWritable:!1}):(u.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(d=>u.push({pubkey:d.publicKey,isSigner:!0,isWritable:!1}))),new nt({keys:u,programId:e,data:l})}static createBurnCheckedInstruction(e,t,n,i,s,o,a){const c=xt([Fe("instruction"),tr("amount"),Fe("decimals")]),l=Ye.Buffer.alloc(c.span);c.encode({instruction:15,amount:new un(o).toBuffer(),decimals:a},l);let u=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}];return s.length===0?u.push({pubkey:i,isSigner:!0,isWritable:!1}):(u.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(d=>u.push({pubkey:d.publicKey,isSigner:!0,isWritable:!1}))),new nt({keys:u,programId:e,data:l})}static createSyncNativeInstruction(e,t){const n=xt([Fe("instruction")]),i=Ye.Buffer.alloc(n.span);n.encode({instruction:17},i);let s=[{pubkey:t,isSigner:!1,isWritable:!0}];return new nt({keys:s,programId:e,data:i})}static async getAssociatedTokenAddress(e,t,n,i,s=!1){if(!s&&!de.isOnCurve(i.toBuffer()))throw new Error(`Owner cannot sign: ${i.toString()}`);return(await de.findProgramAddress([i.toBuffer(),t.toBuffer(),n.toBuffer()],e))[0]}static createAssociatedTokenAccountInstruction(e,t,n,i,s,o){const a=Ye.Buffer.alloc(0);let c=[{pubkey:o,isSigner:!0,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:Br.programId,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:Ds,isSigner:!1,isWritable:!1}];return new nt({keys:c,programId:e,data:a})}}var nE=Object.freeze(Object.defineProperty({__proto__:null,ASSOCIATED_TOKEN_PROGRAM_ID:fb,AccountLayout:Cs,MintLayout:ta,NATIVE_MINT:hb,TOKEN_PROGRAM_ID:eE,Token:ct,u64:un},Symbol.toStringTag,{value:"Module"})),Ua=vo(nE),el=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.getAccountInfo=Wt.getTokenAccount=Wt.getAssociatedTokenAddress=Wt.convertFactionStringToNum=Wt.longToByteArray=Wt.byteArrayToLong=Wt.stringToByteArray=Wt.byteArrayToString=void 0;const hc=zn,pc=ot,Lc=ni,Rr=Ua;function rE(r){return String.fromCharCode(...r)}Wt.byteArrayToString=rE;function iE(r,e){if(r.length>e)return null;let t=[];for(let n=0;n<e;n+=1){let i=32;n<r.length&&(i=r.charCodeAt(n)),t=t.concat([i])}return t}Wt.stringToByteArray=iE;function sE(r){let e=0;for(let t=r.length-1;t>=0;t-=1)e=e*256+r[t];return e}Wt.byteArrayToLong=sE;function oE(r){const e=[0,0,0,0,0,0,0,0];for(let t=0;t<e.length;t+=1){const n=r&255;e[t]=n,r=(r-n)/256}return e}Wt.longToByteArray=oE;function aE(r){return el(this,void 0,void 0,function*(){switch(r.toLowerCase()){case"mud":return hc.FactionType.MUD;case"oni":return hc.FactionType.ONI;case"ustur":return hc.FactionType.Ustur;default:return hc.FactionType.Unenlisted}})}Wt.convertFactionStringToNum=aE;function pb(r,e){return el(this,void 0,void 0,function*(){const[t]=yield Lc.PublicKey.findProgramAddress([r.toBuffer(),Rr.TOKEN_PROGRAM_ID.toBuffer(),e.toBuffer()],Rr.ASSOCIATED_TOKEN_PROGRAM_ID);return t})}Wt.getAssociatedTokenAddress=pb;function cE(r,e,t,n=e,i){return el(this,void 0,void 0,function*(){const{value:s}=yield r.getParsedTokenAccountsByOwner(e,{mint:t});let o=null;if(i===void 0){let a=null;for(const c of s)if(c.account.data.parsed.type==="account"){const l=c.account.data.parsed,u=new pc.BN(l.info.tokenAmount.amount);(a===null||u.gt(a))&&(o=c.pubkey,a=u)}}else{let a=null;for(const c of s)if(c.account.data.parsed.type==="account"){const l=c.account.data.parsed,u=new pc.BN(l.info.tokenAmount.amount);u.gt(new pc.BN(i))&&(a===null||u.lt(a))&&(o=c.pubkey,a=u)}}if(o===null){const a=yield pb(e,t),{value:c}=yield r.getParsedAccountInfo(a,"confirmed");if(c===null||c.owner.equals(Lc.SystemProgram.programId))return{tokenAccount:a,createInstruction:[Rr.Token.createAssociatedTokenAccountInstruction(Rr.ASSOCIATED_TOKEN_PROGRAM_ID,Rr.TOKEN_PROGRAM_ID,t,a,e,n)]};if("program"in c.data&&c.data.parsed.type==="account"&&new Lc.PublicKey(c.data.parsed.info.owner).equals(e))return{tokenAccount:a};{const l=pc.web3.Keypair.generate();return{tokenAccount:l,createInstruction:[Lc.SystemProgram.createAccount({fromPubkey:n,newAccountPubkey:l.publicKey,lamports:yield Rr.Token.getMinBalanceRentForExemptAccount(r),space:Rr.AccountLayout.span,programId:Rr.TOKEN_PROGRAM_ID}),Rr.Token.createInitAccountInstruction(Rr.TOKEN_PROGRAM_ID,t,l.publicKey,e)]}}}else return{tokenAccount:o}})}Wt.getTokenAccount=cE;function uE(r,e){return el(this,void 0,void 0,function*(){const{value:t}=yield r.getParsedAccountInfo(e);return t.data})}Wt.getAccountInfo=uE;var tl={},lE=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(tl,"__esModule",{value:!0});tl.sendAndConfirmTransaction=void 0;const dE=ni;function fE(r,e,...t){return lE(this,void 0,void 0,function*(){let n="";try{n=yield(0,dE.sendAndConfirmTransaction)(r,e,t,{skipPreflight:!0,commitment:"singleGossip",preflightCommitment:null})}catch(i){console.log(i)}return n})}tl.sendAndConfirmTransaction=fE;var rs={},ph={},yh={},yb={};Object.defineProperty(yb,"__esModule",{value:!0});var nl={},Ri={},dn={},pr={},Fa={};Object.defineProperty(Fa,"__esModule",{value:!0});Fa.baseIdl=void 0;Fa.baseIdl={version:"0.1.0",name:"marketplace",instructions:[{name:"addRoyaltyTier",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"RegisteredCurrency",path:"registered_currency.token_mint"}]}}],args:[{name:"stakeAmount",type:"u64"},{name:"discount",type:"u64"}]},{name:"deleteRoyaltyTier",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"RegisteredCurrency",path:"registered_currency.token_mint"}]}}],args:[{name:"stakeAmount",type:"u64"}]},{name:"deregisterCurrency",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"initializeMarketplace",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"registerCurrency",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"saCurrencyVault",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"royalty",type:"u64"}]},{name:"updateCurrencyVault",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"saCurrencyVault",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"updateCurrencyRoyalty",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"royalty",type:"u64"}]},{name:"updateRoyaltyTier",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"RegisteredCurrency",path:"registered_currency.token_mint"}]}}],args:[{name:"stakeAmount",type:"u64"},{name:"discount",type:"u64"}]},{name:"addFeeExemption",accounts:[{name:"updateAuthorityMaster",isMut:!1,isSigner:!0},{name:"funder",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1},{name:"feeExemptTarget",isMut:!1,isSigner:!1},{name:"feeExemptAccount",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"discount",type:"u64"}]},{name:"removeFeeExemption",accounts:[{name:"updateAuthorityMaster",isMut:!1,isSigner:!0},{name:"funder",isMut:!0,isSigner:!1},{name:"marketVarsAccount",isMut:!1,isSigner:!1},{name:"feeExemptAccount",isMut:!0,isSigner:!1}],args:[]},{name:"processInitializeBuy",accounts:[{name:"orderInitializer",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"depositMint",isMut:!1,isSigner:!1},{name:"receiveMint",isMut:!1,isSigner:!1},{name:"orderVaultAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-account"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"orderVaultAuthority",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-auth"},{kind:"account",type:"publicKey",path:"order_initializer"}]}},{name:"initializerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"initializerReceiveTokenAccount",isMut:!0,isSigner:!1},{name:"orderAccount",isMut:!0,isSigner:!1},{name:"registeredCurrency",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"openOrdersCounter",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"open-orders-counter"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"price",type:"u64"},{name:"originationQty",type:"u64"}]},{name:"processInitializeSell",accounts:[{name:"orderInitializer",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"depositMint",isMut:!1,isSigner:!1},{name:"receiveMint",isMut:!1,isSigner:!1},{name:"orderVaultAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-account"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"orderVaultAuthority",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-auth"},{kind:"account",type:"publicKey",path:"order_initializer"}]}},{name:"initializerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"initializerReceiveTokenAccount",isMut:!1,isSigner:!1},{name:"orderAccount",isMut:!0,isSigner:!1},{name:"registeredCurrency",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"receive_mint"}]}},{name:"openOrdersCounter",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"open-orders-counter"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"price",type:"u64"},{name:"originationQty",type:"u64"}]},{name:"processExchange",accounts:[{name:"orderTaker",isMut:!0,isSigner:!0},{name:"orderTakerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"orderTakerReceiveTokenAccount",isMut:!0,isSigner:!1},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"assetMint",isMut:!1,isSigner:!1},{name:"orderInitializer",isMut:!0,isSigner:!1},{name:"initializerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"initializerReceiveTokenAccount",isMut:!0,isSigner:!1},{name:"orderVaultAccount",isMut:!0,isSigner:!1},{name:"orderVaultAuthority",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-auth"},{kind:"account",type:"publicKey",account:"OrderAccount",path:"order_account.order_initializer_pubkey"}]}},{name:"orderAccount",isMut:!0,isSigner:!1},{name:"saVault",isMut:!0,isSigner:!1},{name:"registeredCurrency",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"openOrdersCounter",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"atlasStaking",isMut:!1,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1},{name:"stakingAccount",isMut:!1,isSigner:!1},{name:"feeReduction",isMut:!1,isSigner:!1}],args:[{name:"purchaseQuantity",type:"u64"},{name:"expectedPrice",type:"u64"},{name:"seller",type:"publicKey"}]},{name:"processCancel",accounts:[{name:"signer",isMut:!0,isSigner:!0},{name:"orderInitializer",isMut:!0,isSigner:!1},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"depositMint",isMut:!1,isSigner:!1},{name:"initializerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"orderVaultAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-account"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"orderVaultAuthority",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-auth"},{kind:"account",type:"publicKey",path:"order_initializer"}]}},{name:"orderAccount",isMut:!0,isSigner:!1},{name:"openOrdersCounter",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"open-orders-counter"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[]},{name:"initializeOpenOrdersCounter",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"user",isMut:!1,isSigner:!1},{name:"openOrdersCounter",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"open-orders-counter"},{kind:"account",type:"publicKey",path:"user"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"depositMint",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]}],accounts:[{name:"FeeReduction",type:{kind:"struct",fields:[{name:"account",type:"publicKey"},{name:"bump",type:"u8"},{name:"discount",type:"u64"}]}},{name:"MarketVars",type:{kind:"struct",fields:[{name:"updateAuthorityMaster",type:"publicKey"},{name:"bump",type:"u8"}]}},{name:"OpenOrdersCounter",type:{kind:"struct",fields:[{name:"openOrderCount",type:"u64"},{name:"bump",type:"u8"}]}},{name:"OrderAccount",type:{kind:"struct",fields:[{name:"orderInitializerPubkey",type:"publicKey"},{name:"currencyMint",type:"publicKey"},{name:"assetMint",type:"publicKey"},{name:"initializerCurrencyTokenAccount",type:"publicKey"},{name:"initializerAssetTokenAccount",type:"publicKey"},{name:"orderSide",type:{defined:"OrderSide"}},{name:"price",type:"u64"},{name:"orderOriginationQty",type:"u64"},{name:"orderRemainingQty",type:"u64"},{name:"createdAtTimestamp",type:"i64"}]}},{name:"RegisteredCurrency",type:{kind:"struct",fields:[{name:"tokenMint",type:"publicKey"},{name:"saCurrencyVault",type:"publicKey"},{name:"royalty",type:"u64"},{name:"bump",type:"u8"},{name:"royaltyTiers",type:{vec:{defined:"RoyaltyTier"}}}]}}],types:[{name:"RoyaltyTier",type:{kind:"struct",fields:[{name:"stakeAmount",type:"u64"},{name:"discount",type:"u64"}]}},{name:"OrderSide",type:{kind:"enum",variants:[{name:"Buy"},{name:"Sell"}]}},{name:"TokenType",type:{kind:"enum",variants:[{name:"Asset"},{name:"Currency"}]}}],errors:[{code:6e3,name:"InvalidDestinationAccount",msg:"Invalid Destination Token Account"},{code:6001,name:"InvalidInstruction",msg:"Invalid instruction."},{code:6002,name:"InvalidMint",msg:"Invalid SPL Token mint"},{code:6003,name:"InvalidOfferAccountOwner",msg:"Invalid Offer Account Owner"},{code:6004,name:"InvalidTokenAccount",msg:"Invalid SPL Token account"},{code:6005,name:"NumericalOverflowError",msg:"Numerical overflow error"},{code:6006,name:"InvalidUpdateAuthorityAccount",msg:"Invalid Update Authority account"},{code:6007,name:"InvalidOrderVaultAuthorityAccount",msg:"Invalid Order Vault Authority account"},{code:6008,name:"UninitializedTokenAccount",msg:"Uninitialized Token Account"},{code:6009,name:"InsufficientBalance",msg:"Insufficient Balance"},{code:6010,name:"InvalidOrderDuration",msg:"Invalid Order Duration"},{code:6011,name:"InvalidOriginationQty",msg:"Origination quantity must be greater than 0"},{code:6012,name:"InsufficientOrderQty",msg:"Insufficient Order Quantity Remaining"},{code:6013,name:"InvalidRoyalty",msg:"Invalid Royalty Value"},{code:6014,name:"InvalidCounter",msg:"Invalid Open Order Counter"},{code:6015,name:"MintDecimalError",msg:"Mint must be zero decimal"},{code:6016,name:"InvalidOrderAccountError",msg:"Order Account does not match provided account"},{code:6017,name:"InvalidRoyaltyTier",msg:"No royalty tier exists with provided stake amount"},{code:6018,name:"RoyaltyTierLength",msg:"Royalty Tier vector cannot hold any additional tiers"},{code:6019,name:"InvalidOrderPrice",msg:"Order price did not match expected price"},{code:6020,name:"DuplicateRoyaltyTier",msg:"Royalty tier already exists"},{code:6021,name:"InvalidSeller",msg:"Order seller did not match expected seller"}],metadata:{}};var rl={};Object.defineProperty(rl,"__esModule",{value:!0});rl.baseIdl=void 0;rl.baseIdl={version:"0.1.0",name:"gm_logs",instructions:[],events:[{name:"RegisterCurrencyMemo",fields:[{name:"updateAuthorityAccount",type:"publicKey",index:!1},{name:"registeredCurrency",type:"publicKey",index:!1},{name:"currencyMint",type:"publicKey",index:!1},{name:"saCurrencyVault",type:"publicKey",index:!1},{name:"royalty",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"InitializeMemo",fields:[{name:"orderInitializerPubkey",type:"publicKey",index:!1},{name:"currencyMint",type:"publicKey",index:!1},{name:"assetMint",type:"publicKey",index:!1},{name:"initializerCurrencyTokenAccount",type:"publicKey",index:!1},{name:"initializerAssetTokenAccount",type:"publicKey",index:!1},{name:"orderSide",type:"u8",index:!1},{name:"price",type:"u64",index:!1},{name:"orderOriginationQty",type:"u64",index:!1},{name:"orderRemainingQty",type:"u64",index:!1},{name:"createdAtTimestamp",type:"i64",index:!1},{name:"orderId",type:"publicKey",index:!1}]},{name:"ExchangeMemo",fields:[{name:"orderInitializerPubkey",type:"publicKey",index:!1},{name:"currencyMint",type:"publicKey",index:!1},{name:"assetMint",type:"publicKey",index:!1},{name:"initializerCurrencyTokenAccount",type:"publicKey",index:!1},{name:"initializerAssetTokenAccount",type:"publicKey",index:!1},{name:"orderSide",type:"u8",index:!1},{name:"price",type:"u64",index:!1},{name:"orderOriginationQty",type:"u64",index:!1},{name:"orderRemainingQty",type:"u64",index:!1},{name:"createdAtTimestamp",type:"i64",index:!1},{name:"orderId",type:"publicKey",index:!1}]},{name:"CancelOrderMemo",fields:[{name:"orderInitializerPubkey",type:"publicKey",index:!1},{name:"currencyMint",type:"publicKey",index:!1},{name:"assetMint",type:"publicKey",index:!1},{name:"initializerCurrencyTokenAccount",type:"publicKey",index:!1},{name:"initializerAssetTokenAccount",type:"publicKey",index:!1},{name:"orderSide",type:"u8",index:!1},{name:"price",type:"u64",index:!1},{name:"orderOriginationQty",type:"u64",index:!1},{name:"orderRemainingQty",type:"u64",index:!1},{name:"createdAtTimestamp",type:"i64",index:!1},{name:"orderId",type:"publicKey",index:!1}]},{name:"StakeMemo",fields:[{name:"user",type:"publicKey",index:!1},{name:"registeredStake",type:"publicKey",index:!1},{name:"stakingAccount",type:"publicKey",index:!1},{name:"stakeAmount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"TransferMemo",fields:[{name:"user",type:"publicKey",index:!1},{name:"registeredStake",type:"publicKey",index:!1},{name:"stakingAccount",type:"publicKey",index:!1},{name:"transferAmount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"WithdrawMemo",fields:[{name:"user",type:"publicKey",index:!1},{name:"registeredStake",type:"publicKey",index:!1},{name:"stakingAccount",type:"publicKey",index:!1},{name:"withdrawAmount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"SettleMemo",fields:[{name:"user",type:"publicKey",index:!1},{name:"registeredStake",type:"publicKey",index:!1},{name:"stakingAccount",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]}],metadata:{}};var hE=z&&z.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),pE=z&&z.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),yE=z&&z.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&hE(e,r,t);return pE(e,r),e};Object.defineProperty(pr,"__esModule",{value:!0});pr.getMarketplaceProgram=pr.getGmLogsIDL=pr.getGmIDL=void 0;const Zp=ot,gE=Fa,mE=yE(rl);function gb(r){const e=gE.baseIdl;return e.metadata.address=r.toBase58(),e}pr.getGmIDL=gb;function bE(r){const e=mE.baseIdl;return e.metadata.address=r.toBase58(),e}pr.getGmLogsIDL=bE;function wE({connection:r,programId:e}){const t=gb(e),n=new Zp.AnchorProvider(r,null,null);return new Zp.Program(t,e,n)}pr.getMarketplaceProgram=wE;var vs=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(dn,"__esModule",{value:!0});dn.getSingleOrder=dn.getOpenOrdersForPlayerAndAsset=dn.getOpenOrdersForPlayerAndCurrency=dn.getOpenOrdersForAsset=dn.getOpenOrdersForCurrency=dn.getOpenOrdersForPlayer=dn.getAllOpenOrders=void 0;const Ln=ot,_s=pr;function kE(r,e){return vs(this,void 0,void 0,function*(){const t=new Ln.AnchorProvider(r,null,null),n=(0,_s.getGmIDL)(e),i=new Ln.Program(n,e,t),s=[{dataSize:201}];return yield i.account.orderAccount.all(s)})}dn.getAllOpenOrders=kE;function SE(r,e,t){return vs(this,void 0,void 0,function*(){const n=new Ln.AnchorProvider(r,null,null),i=(0,_s.getGmIDL)(t),s=new Ln.Program(i,t,n),o=[{dataSize:201},{memcmp:{offset:8,bytes:e.toBase58()}}];return yield s.account.orderAccount.all(o)})}dn.getOpenOrdersForPlayer=SE;function vE(r,e,t){return vs(this,void 0,void 0,function*(){const n=new Ln.AnchorProvider(r,null,null),i=(0,_s.getGmIDL)(t),s=new Ln.Program(i,t,n),o=[{dataSize:201},{memcmp:{offset:40,bytes:e.toBase58()}}];return yield s.account.orderAccount.all(o)})}dn.getOpenOrdersForCurrency=vE;function _E(r,e,t){return vs(this,void 0,void 0,function*(){const n=new Ln.AnchorProvider(r,null,null),i=(0,_s.getGmIDL)(t),s=new Ln.Program(i,t,n),o=[{dataSize:201},{memcmp:{offset:72,bytes:e.toBase58()}}];return yield s.account.orderAccount.all(o)})}dn.getOpenOrdersForAsset=_E;function AE(r,e,t,n){return vs(this,void 0,void 0,function*(){const i=new Ln.AnchorProvider(r,null,null),s=(0,_s.getGmIDL)(n),o=new Ln.Program(s,n,i),a=[{dataSize:201},{memcmp:{offset:40,bytes:t.toBase58()}},{memcmp:{offset:8,bytes:e.toBase58()}}];return yield o.account.orderAccount.all(a)})}dn.getOpenOrdersForPlayerAndCurrency=AE;function IE(r,e,t,n){return vs(this,void 0,void 0,function*(){const i=new Ln.AnchorProvider(r,null,null),s=(0,_s.getGmIDL)(n),o=new Ln.Program(s,n,i),a=[{dataSize:201},{memcmp:{offset:72,bytes:t.toBase58()}},{memcmp:{offset:8,bytes:e.toBase58()}}];return yield o.account.orderAccount.all(a)})}dn.getOpenOrdersForPlayerAndAsset=IE;function EE(r,e,t){return vs(this,void 0,void 0,function*(){const n=new Ln.AnchorProvider(r,null,null),i=(0,_s.getGmIDL)(t);return yield new Ln.Program(i,t,n).account.orderAccount.fetch(e)})}dn.getSingleOrder=EE;var Vt={},bn={};Object.defineProperty(bn,"__esModule",{value:!0});bn.FEE_EXEMPT_SEED=bn.OPEN_ORDERS_COUNTER=bn.REGISTERED_CURRENCY_SEED=bn.ORDER_VAULT_AUTH_SEED=bn.ORDER_VAULT_SEED=bn.MARKET_VARS_SEED=void 0;bn.MARKET_VARS_SEED=we.Buffer.from("market-vars");bn.ORDER_VAULT_SEED=we.Buffer.from("order-vault-account");bn.ORDER_VAULT_AUTH_SEED=we.Buffer.from("order-vault-auth");bn.REGISTERED_CURRENCY_SEED=we.Buffer.from("registered-currency");bn.OPEN_ORDERS_COUNTER=we.Buffer.from("open-orders-counter");bn.FEE_EXEMPT_SEED=we.Buffer.from("fee_exempt");var PE=z&&z.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),RE=z&&z.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),TE=z&&z.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&PE(e,r,t);return RE(e,r),e},Ti=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.getAllFeeExemptAccounts=Vt.getFeeExemptAccount=Vt.getOpenOrdersCounter=Vt.getAllRegisteredCurrencies=Vt.getRegisteredCurrencyAccount=Vt.getOrderVaultAuth=Vt.getOrderVault=Vt.getMarketVarsAccount=void 0;const Jc=ot,Mo=ni,Lo=TE(bn),mb=pr;function OE(r){return Ti(this,void 0,void 0,function*(){return Mo.PublicKey.findProgramAddress([Lo.MARKET_VARS_SEED],r)})}Vt.getMarketVarsAccount=OE;function BE(r,e,t){return Ti(this,void 0,void 0,function*(){return Mo.PublicKey.findProgramAddress([Lo.ORDER_VAULT_SEED,r.toBuffer(),e.toBuffer()],t)})}Vt.getOrderVault=BE;function xE(r,e){return Ti(this,void 0,void 0,function*(){return Mo.PublicKey.findProgramAddress([Lo.ORDER_VAULT_AUTH_SEED,r.toBuffer()],e)})}Vt.getOrderVaultAuth=xE;function CE(r,e){return Ti(this,void 0,void 0,function*(){return Mo.PublicKey.findProgramAddress([Lo.REGISTERED_CURRENCY_SEED,e.toBuffer()],r)})}Vt.getRegisteredCurrencyAccount=CE;function ME(r,e){return Ti(this,void 0,void 0,function*(){const t=new Jc.AnchorProvider(r,null,null),n=(0,mb.getGmIDL)(e),i=new Jc.Program(n,e,t),s=[{dataSize:1686}],o=yield i.account.registeredCurrency.all(s),a=[];for(const c of o){const l={mint:c.account.tokenMint,royalty:c.account.royalty,saVault:c.account.saCurrencyVault};a.push(l)}return a})}Vt.getAllRegisteredCurrencies=ME;function LE(r,e,t){return Ti(this,void 0,void 0,function*(){return Mo.PublicKey.findProgramAddress([Lo.OPEN_ORDERS_COUNTER,r.toBuffer(),e.toBuffer()],t)})}Vt.getOpenOrdersCounter=LE;function KE(r,e){return Ti(this,void 0,void 0,function*(){return Mo.PublicKey.findProgramAddress([Lo.FEE_EXEMPT_SEED,r.toBuffer()],e)})}Vt.getFeeExemptAccount=KE;function NE(r,e){return Ti(this,void 0,void 0,function*(){const t=new Jc.AnchorProvider(r,null,null),n=(0,mb.getGmIDL)(e);return yield new Jc.Program(n,e,t).account.feeReduction.all()})}Vt.getAllFeeExemptAccounts=NE;var Tn={},Ko=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.getRoyaltyReductionForStakingAccount=Tn.getRoyaltyReductionForUserAndMint=Tn.getRegisteredCurrencyInfoFromPubkey=Tn.getRegisteredCurrencyAccountInfo=Tn.getFeeExemptAccountInfo=Tn.getMarketVarsAccountInfo=void 0;const Qc=ot,gh=Vt,il=pr,Yd=Iu;function $E(r,e){return Ko(this,void 0,void 0,function*(){const t=(0,il.getMarketplaceProgram)({connection:r,programId:e}),[n]=yield(0,gh.getMarketVarsAccount)(e);return yield t.account.marketVars.fetch(n)})}Tn.getMarketVarsAccountInfo=$E;function DE(r,e,t){return Ko(this,void 0,void 0,function*(){const n=(0,il.getMarketplaceProgram)({connection:r,programId:t}),[i]=yield(0,gh.getFeeExemptAccount)(e,t);return yield n.account.feeExempt.fetch(i)})}Tn.getFeeExemptAccountInfo=DE;function zE(r,e,t){return Ko(this,void 0,void 0,function*(){const n=(0,il.getMarketplaceProgram)({connection:r,programId:e}),[i]=yield(0,gh.getRegisteredCurrencyAccount)(e,t);return yield n.account.registeredCurrency.fetch(i)})}Tn.getRegisteredCurrencyAccountInfo=zE;function mh(r,e,t){return Ko(this,void 0,void 0,function*(){return yield(0,il.getMarketplaceProgram)({connection:r,programId:e}).account.registeredCurrency.fetch(t)})}Tn.getRegisteredCurrencyInfoFromPubkey=mh;function WE(r,e,t,n,i,s){return Ko(this,void 0,void 0,function*(){let o=0;const a=yield mh(r,e,i),[c]=yield(0,Yd.getStakingAccount)(t,n,s),l=yield(0,Yd.getStakingAccountInfo)(r,c,t);if(l.unstakedTs.eq(new Qc.BN(0))){const u=a.royaltyTiers;let d=new Qc.BN(0);for(const m of u)l.totalStake.gte(m.stakeAmount)&&(d=m.discount);o=d.toNumber()/1e4}return o})}Tn.getRoyaltyReductionForUserAndMint=WE;function VE(r,e,t,n,i){return Ko(this,void 0,void 0,function*(){let s=0;const o=yield mh(r,e,i),a=yield(0,Yd.getStakingAccountInfo)(r,n,t);if(a.unstakedTs.eq(new Qc.BN(0))){const c=o.royaltyTiers;let l=new Qc.BN(0);for(const u of c)a.totalStake.gte(u.stakeAmount)&&(l=u.discount);s=l.toNumber()/1e4}return s})}Tn.getRoyaltyReductionForStakingAccount=VE;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(dn,r),t(Vt,r),t(Tn,r),t(bn,r)})(Ri);var ja={},Nn={},mi={},UE=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(mi,"__esModule",{value:!0});mi.convertDecimalPriceToBn=mi.initializeAtaForMint=mi.getOrderSide=void 0;const FE=ot,jE=gs,ld=Ua,qE=r=>JSON.stringify(r.orderSide)===JSON.stringify({buy:{}})?"BuySide":"SellSide";mi.getOrderSide=qE;function GE({mint:r,owner:e,connection:t}){return UE(this,void 0,void 0,function*(){const n=[],i=yield(0,jE.associatedAddress)({mint:r,owner:e});return(yield t.getAccountInfo(i))===null&&n.push(ld.Token.createAssociatedTokenAccountInstruction(ld.ASSOCIATED_TOKEN_PROGRAM_ID,ld.TOKEN_PROGRAM_ID,r,i,e,e)),{account:i,instructions:n}})}mi.initializeAtaForMint=GE;const HE=(r,e)=>new FE.BN(r*Math.pow(10,e));mi.convertDecimalPriceToBn=HE;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(pr,r),t(mi,r)})(Nn);var YE=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(ja,"__esModule",{value:!0});ja.createOrderCounterInstruction=void 0;const JE=Nn;function QE({connection:r,payer:e,initializerMainAccount:t,depositMint:n,programId:i}){return YE(this,void 0,void 0,function*(){return yield(0,JE.getMarketplaceProgram)({connection:r,programId:i}).methods.initializeOpenOrdersCounter().accounts({payer:e,user:t,depositMint:n}).instruction()})}ja.createOrderCounterInstruction=QE;var XE=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(nl,"__esModule",{value:!0});nl.createCancelOrderInstruction=void 0;const ZE=ot,eP=Ri,tP=ja,ey=Nn,nP=lr;function rP({connection:r,orderInitializer:e,orderAccount:t,programId:n,payer:i=e}){return XE(this,void 0,void 0,function*(){const s=(0,ey.getMarketplaceProgram)({connection:r,programId:n}),o={signers:[],instructions:[]},a=yield s.account.orderAccount.fetch(t),l=(0,ey.getOrderSide)(a)==="SellSide"?a.assetMint:a.currencyMint;let u=null,d=null;const m=yield(0,nP.getTokenAccount)(r,e,l);u=m.tokenAccount,"createInstruction"in m&&o.instructions.push(...m.createInstruction),u instanceof ZE.web3.Keypair?(d=u.publicKey,o.signers.push(u)):d=u;const[y]=yield(0,eP.getOpenOrdersCounter)(e,l,n);if((yield r.getAccountInfo(y))===null){const w=yield(0,tP.createOrderCounterInstruction)({connection:r,payer:i,initializerMainAccount:e,depositMint:l,programId:n});o.instructions.push(w)}const p=yield s.methods.processCancel().accounts({signer:i,depositMint:l,orderInitializer:e,initializerDepositTokenAccount:d,orderAccount:t}).instruction();return o.instructions.push(p),o})}nl.createCancelOrderInstruction=rP;var lo={},bb=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(lo,"__esModule",{value:!0});lo.createInitializeSellOrderInstruction=lo.createInitializeBuyOrderInstruction=void 0;const Xs=ot,wb=Nn,kb=lr,Sb=Ri,vb=ja,_b=lr;function iP({connection:r,initializerMainAccount:e,initializerDepositTokenAccount:t,price:n,originationQty:i,depositMint:s,receiveMint:o,programId:a}){return bb(this,void 0,void 0,function*(){const c=(0,wb.getMarketplaceProgram)({connection:r,programId:a}),l={signers:[],instructions:[]};let u=null,d=null;const m=yield(0,kb.getTokenAccount)(r,e,o);u=m.tokenAccount,"createInstruction"in m&&l.instructions.push(...m.createInstruction),u instanceof Xs.web3.Keypair?(d=u.publicKey,l.signers.push(u)):d=u;const[y]=yield(0,Sb.getOpenOrdersCounter)(e,s,a);if((yield r.getAccountInfo(y))===null){const E=yield(0,vb.createOrderCounterInstruction)({connection:r,payer:e,initializerMainAccount:e,depositMint:s,programId:a});l.instructions.push(E)}const p=Xs.web3.Keypair.generate();l.signers.push(p);const w=yield(0,_b.createAccountInstruction)(r,e,p,a);l.instructions.push(w);const v=yield c.methods.processInitializeBuy(n,new Xs.BN(i)).accounts({orderInitializer:e,initializerDepositTokenAccount:t,initializerReceiveTokenAccount:d,orderAccount:p.publicKey,depositMint:s,receiveMint:o}).signers([p]).instruction();return l.instructions.push(v),{orderAccount:p.publicKey,ixSet:l}})}lo.createInitializeBuyOrderInstruction=iP;function sP({connection:r,initializerMainAccount:e,initializerDepositTokenAccount:t,price:n,originationQty:i,depositMint:s,receiveMint:o,programId:a}){return bb(this,void 0,void 0,function*(){const c=(0,wb.getMarketplaceProgram)({connection:r,programId:a}),l={signers:[],instructions:[]};let u=null,d=null;const m=yield(0,kb.getTokenAccount)(r,e,o);u=m.tokenAccount,"createInstruction"in m&&l.instructions.push(...m.createInstruction),u instanceof Xs.web3.Keypair?(d=u.publicKey,l.signers.push(u)):d=u;const[y]=yield(0,Sb.getOpenOrdersCounter)(e,s,a);if((yield r.getAccountInfo(y))===null){const E=yield(0,vb.createOrderCounterInstruction)({connection:r,payer:e,initializerMainAccount:e,depositMint:s,programId:a});l.instructions.push(E)}const p=Xs.web3.Keypair.generate();l.signers.push(p);const w=yield(0,_b.createAccountInstruction)(r,e,p,a);l.instructions.push(w);const v=yield c.methods.processInitializeSell(n,new Xs.BN(i)).accounts({orderInitializer:e,initializerDepositTokenAccount:t,initializerReceiveTokenAccount:d,orderAccount:p.publicKey,depositMint:s,receiveMint:o}).signers([p]).instruction();return l.instructions.push(v),{orderAccount:p.publicKey,ixSet:l}})}lo.createInitializeSellOrderInstruction=sP;var sl={},oP=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(sl,"__esModule",{value:!0});sl.createDeregisterCurrencyInstruction=void 0;const aP=Nn;function cP({connection:r,updateAuthorityAccount:e,currencyMint:t,programId:n}){return oP(this,void 0,void 0,function*(){const s=[yield(0,aP.getMarketplaceProgram)({connection:r,programId:n}).methods.deregisterCurrency().accounts({updateAuthorityAccount:e,currencyMint:t}).instruction()];return{accounts:[],instructions:s}})}sl.createDeregisterCurrencyInstruction=cP;var ol={},al={},cl={},Ab={exports:{}};(function(r){(function(e){var t,n=20,i=1,s=1e6,o=1e6,a=-7,c=21,l=!1,u="[big.js] ",d=u+"Invalid ",m=d+"decimal places",y=d+"rounding mode",S=u+"Division by zero",p={},w=void 0,v=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function E(){function b(_){var R=this;if(!(R instanceof b))return _===w?E():new b(_);if(_ instanceof b)R.s=_.s,R.e=_.e,R.c=_.c.slice();else{if(typeof _!="string"){if(b.strict===!0&&typeof _!="bigint")throw TypeError(d+"value");_=_===0&&1/_<0?"-0":String(_)}P(R,_)}R.constructor=b}return b.prototype=p,b.DP=n,b.RM=i,b.NE=a,b.PE=c,b.strict=l,b.roundDown=0,b.roundHalfUp=1,b.roundHalfEven=2,b.roundUp=3,b}function P(b,_){var R,W,B;if(!v.test(_))throw Error(d+"number");for(b.s=_.charAt(0)=="-"?(_=_.slice(1),-1):1,(R=_.indexOf("."))>-1&&(_=_.replace(".","")),(W=_.search(/e/i))>0?(R<0&&(R=W),R+=+_.slice(W+1),_=_.substring(0,W)):R<0&&(R=_.length),B=_.length,W=0;W<B&&_.charAt(W)=="0";)++W;if(W==B)b.c=[b.e=0];else{for(;B>0&&_.charAt(--B)=="0";);for(b.e=R-W-1,b.c=[],R=0;W<=B;)b.c[R++]=+_.charAt(W++)}return b}function K(b,_,R,W){var B=b.c;if(R===w&&(R=b.constructor.RM),R!==0&&R!==1&&R!==2&&R!==3)throw Error(y);if(_<1)W=R===3&&(W||!!B[0])||_===0&&(R===1&&B[0]>=5||R===2&&(B[0]>5||B[0]===5&&(W||B[1]!==w))),B.length=1,W?(b.e=b.e-_+1,B[0]=1):B[0]=b.e=0;else if(_<B.length){if(W=R===1&&B[_]>=5||R===2&&(B[_]>5||B[_]===5&&(W||B[_+1]!==w||B[_-1]&1))||R===3&&(W||!!B[0]),B.length=_,W){for(;++B[--_]>9;)if(B[_]=0,_===0){++b.e,B.unshift(1);break}}for(_=B.length;!B[--_];)B.pop()}return b}function T(b,_,R){var W=b.e,B=b.c.join(""),V=B.length;if(_)B=B.charAt(0)+(V>1?"."+B.slice(1):"")+(W<0?"e":"e+")+W;else if(W<0){for(;++W;)B="0"+B;B="0."+B}else if(W>0)if(++W>V)for(W-=V;W--;)B+="0";else W<V&&(B=B.slice(0,W)+"."+B.slice(W));else V>1&&(B=B.charAt(0)+"."+B.slice(1));return b.s<0&&R?"-"+B:B}p.abs=function(){var b=new this.constructor(this);return b.s=1,b},p.cmp=function(b){var _,R=this,W=R.c,B=(b=new R.constructor(b)).c,V=R.s,q=b.s,I=R.e,D=b.e;if(!W[0]||!B[0])return W[0]?V:B[0]?-q:0;if(V!=q)return V;if(_=V<0,I!=D)return I>D^_?1:-1;for(q=(I=W.length)<(D=B.length)?I:D,V=-1;++V<q;)if(W[V]!=B[V])return W[V]>B[V]^_?1:-1;return I==D?0:I>D^_?1:-1},p.div=function(b){var _=this,R=_.constructor,W=_.c,B=(b=new R(b)).c,V=_.s==b.s?1:-1,q=R.DP;if(q!==~~q||q<0||q>s)throw Error(m);if(!B[0])throw Error(S);if(!W[0])return b.s=V,b.c=[b.e=0],b;var I,D,G,Ie,ue,Pe=B.slice(),Gt=I=B.length,yn=W.length,ke=W.slice(0,I),Ke=ke.length,Zt=b,cn=Zt.c=[],Ht=0,wt=q+(Zt.e=_.e-b.e)+1;for(Zt.s=V,V=wt<0?0:wt,Pe.unshift(0);Ke++<I;)ke.push(0);do{for(G=0;G<10;G++){if(I!=(Ke=ke.length))Ie=I>Ke?1:-1;else for(ue=-1,Ie=0;++ue<I;)if(B[ue]!=ke[ue]){Ie=B[ue]>ke[ue]?1:-1;break}if(Ie<0){for(D=Ke==I?B:Pe;Ke;){if(ke[--Ke]<D[Ke]){for(ue=Ke;ue&&!ke[--ue];)ke[ue]=9;--ke[ue],ke[Ke]+=10}ke[Ke]-=D[Ke]}for(;!ke[0];)ke.shift()}else break}cn[Ht++]=Ie?G:++G,ke[0]&&Ie?ke[Ke]=W[Gt]||0:ke=[W[Gt]]}while((Gt++<yn||ke[0]!==w)&&V--);return!cn[0]&&Ht!=1&&(cn.shift(),Zt.e--,wt--),Ht>wt&&K(Zt,wt,R.RM,ke[0]!==w),Zt},p.eq=function(b){return this.cmp(b)===0},p.gt=function(b){return this.cmp(b)>0},p.gte=function(b){return this.cmp(b)>-1},p.lt=function(b){return this.cmp(b)<0},p.lte=function(b){return this.cmp(b)<1},p.minus=p.sub=function(b){var _,R,W,B,V=this,q=V.constructor,I=V.s,D=(b=new q(b)).s;if(I!=D)return b.s=-D,V.plus(b);var G=V.c.slice(),Ie=V.e,ue=b.c,Pe=b.e;if(!G[0]||!ue[0])return ue[0]?b.s=-D:G[0]?b=new q(V):b.s=1,b;if(I=Ie-Pe){for((B=I<0)?(I=-I,W=G):(Pe=Ie,W=ue),W.reverse(),D=I;D--;)W.push(0);W.reverse()}else for(R=((B=G.length<ue.length)?G:ue).length,I=D=0;D<R;D++)if(G[D]!=ue[D]){B=G[D]<ue[D];break}if(B&&(W=G,G=ue,ue=W,b.s=-b.s),(D=(R=ue.length)-(_=G.length))>0)for(;D--;)G[_++]=0;for(D=_;R>I;){if(G[--R]<ue[R]){for(_=R;_&&!G[--_];)G[_]=9;--G[_],G[R]+=10}G[R]-=ue[R]}for(;G[--D]===0;)G.pop();for(;G[0]===0;)G.shift(),--Pe;return G[0]||(b.s=1,G=[Pe=0]),b.c=G,b.e=Pe,b},p.mod=function(b){var _,R=this,W=R.constructor,B=R.s,V=(b=new W(b)).s;if(!b.c[0])throw Error(S);return R.s=b.s=1,_=b.cmp(R)==1,R.s=B,b.s=V,_?new W(R):(B=W.DP,V=W.RM,W.DP=W.RM=0,R=R.div(b),W.DP=B,W.RM=V,this.minus(R.times(b)))},p.neg=function(){var b=new this.constructor(this);return b.s=-b.s,b},p.plus=p.add=function(b){var _,R,W,B=this,V=B.constructor;if(b=new V(b),B.s!=b.s)return b.s=-b.s,B.minus(b);var q=B.e,I=B.c,D=b.e,G=b.c;if(!I[0]||!G[0])return G[0]||(I[0]?b=new V(B):b.s=B.s),b;if(I=I.slice(),_=q-D){for(_>0?(D=q,W=G):(_=-_,W=I),W.reverse();_--;)W.push(0);W.reverse()}for(I.length-G.length<0&&(W=G,G=I,I=W),_=G.length,R=0;_;I[_]%=10)R=(I[--_]=I[_]+G[_]+R)/10|0;for(R&&(I.unshift(R),++D),_=I.length;I[--_]===0;)I.pop();return b.c=I,b.e=D,b},p.pow=function(b){var _=this,R=new _.constructor("1"),W=R,B=b<0;if(b!==~~b||b<-o||b>o)throw Error(d+"exponent");for(B&&(b=-b);b&1&&(W=W.times(_)),b>>=1,!!b;)_=_.times(_);return B?R.div(W):W},p.prec=function(b,_){if(b!==~~b||b<1||b>s)throw Error(d+"precision");return K(new this.constructor(this),b,_)},p.round=function(b,_){if(b===w)b=0;else if(b!==~~b||b<-s||b>s)throw Error(m);return K(new this.constructor(this),b+this.e+1,_)},p.sqrt=function(){var b,_,R,W=this,B=W.constructor,V=W.s,q=W.e,I=new B("0.5");if(!W.c[0])return new B(W);if(V<0)throw Error(u+"No square root");V=Math.sqrt(W+""),V===0||V===1/0?(_=W.c.join(""),_.length+q&1||(_+="0"),V=Math.sqrt(_),q=((q+1)/2|0)-(q<0||q&1),b=new B((V==1/0?"5e":(V=V.toExponential()).slice(0,V.indexOf("e")+1))+q)):b=new B(V+""),q=b.e+(B.DP+=4);do R=b,b=I.times(R.plus(W.div(R)));while(R.c.slice(0,q).join("")!==b.c.slice(0,q).join(""));return K(b,(B.DP-=4)+b.e+1,B.RM)},p.times=p.mul=function(b){var _,R=this,W=R.constructor,B=R.c,V=(b=new W(b)).c,q=B.length,I=V.length,D=R.e,G=b.e;if(b.s=R.s==b.s?1:-1,!B[0]||!V[0])return b.c=[b.e=0],b;for(b.e=D+G,q<I&&(_=B,B=V,V=_,G=q,q=I,I=G),_=new Array(G=q+I);G--;)_[G]=0;for(D=I;D--;){for(I=0,G=q+D;G>D;)I=_[G]+V[D]*B[G-D-1]+I,_[G--]=I%10,I=I/10|0;_[G]=I}for(I?++b.e:_.shift(),D=_.length;!_[--D];)_.pop();return b.c=_,b},p.toExponential=function(b,_){var R=this,W=R.c[0];if(b!==w){if(b!==~~b||b<0||b>s)throw Error(m);for(R=K(new R.constructor(R),++b,_);R.c.length<b;)R.c.push(0)}return T(R,!0,!!W)},p.toFixed=function(b,_){var R=this,W=R.c[0];if(b!==w){if(b!==~~b||b<0||b>s)throw Error(m);for(R=K(new R.constructor(R),b+R.e+1,_),b=b+R.e+1;R.c.length<b;)R.c.push(0)}return T(R,!1,!!W)},p.toJSON=p.toString=function(){var b=this,_=b.constructor;return T(b,b.e<=_.NE||b.e>=_.PE,!!b.c[0])},p.toNumber=function(){var b=Number(T(this,!0,!0));if(this.constructor.strict===!0&&!this.eq(b.toString()))throw Error(u+"Imprecise conversion");return b},p.toPrecision=function(b,_){var R=this,W=R.constructor,B=R.c[0];if(b!==w){if(b!==~~b||b<1||b>s)throw Error(d+"precision");for(R=K(new W(R),b,_);R.c.length<b;)R.c.push(0)}return T(R,b<=R.e||R.e<=W.NE||R.e>=W.PE,!!B)},p.valueOf=function(){var b=this,_=b.constructor;if(_.strict===!0)throw Error(u+"valueOf disallowed");return T(b,b.e<=_.NE||b.e>=_.PE,!0)},t=E(),t.default=t.Big=t,r.exports?r.exports=t:e.Big=t})(z)})(Ab);function Re(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];throw new Error(typeof r=="number"?"[MobX] minified error nr: "+r+(t.length?" "+t.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+r)}var uP={};function bh(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof we.global<"u"?we.global:typeof self<"u"?self:uP}var Ib=Object.assign,Xc=Object.getOwnPropertyDescriptor,Kr=Object.defineProperty,qa=Object.prototype,Jd=[];Object.freeze(Jd);var wh={};Object.freeze(wh);var lP=typeof Proxy<"u",dP=Object.toString();function Eb(){lP||Re("Proxy not available")}function Pb(r){var e=!1;return function(){if(!e)return e=!0,r.apply(this,arguments)}}var Ws=function(){};function Yn(r){return typeof r=="function"}function is(r){var e=typeof r;switch(e){case"string":case"symbol":case"number":return!0}return!1}function ul(r){return r!==null&&typeof r=="object"}function ti(r){if(!ul(r))return!1;var e=Object.getPrototypeOf(r);if(e==null)return!0;var t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t.toString()===dP}function Rb(r){var e=r==null?void 0:r.constructor;return e?e.name==="GeneratorFunction"||e.displayName==="GeneratorFunction":!1}function Ga(r,e,t){Kr(r,e,{enumerable:!1,writable:!0,configurable:!0,value:t})}function Tb(r,e,t){Kr(r,e,{enumerable:!1,writable:!1,configurable:!0,value:t})}function Oi(r,e){var t="isMobX"+r;return e.prototype[t]=!0,function(n){return ul(n)&&n[t]===!0}}function No(r){return r instanceof Map}function Ha(r){return r instanceof Set}var Ob=typeof Object.getOwnPropertySymbols<"u";function fP(r){var e=Object.keys(r);if(!Ob)return e;var t=Object.getOwnPropertySymbols(r);return t.length?[].concat(e,t.filter(function(n){return qa.propertyIsEnumerable.call(r,n)})):e}var fo=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Ob?function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:Object.getOwnPropertyNames;function Bb(r){return r===null?null:typeof r=="object"?""+r:r}function Zr(r,e){return qa.hasOwnProperty.call(r,e)}var hP=Object.getOwnPropertyDescriptors||function(e){var t={};return fo(e).forEach(function(n){t[n]=Xc(e,n)}),t};function ty(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,gP(n.key),n)}}function kh(r,e,t){return e&&ty(r.prototype,e),t&&ty(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function vi(){return vi=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},vi.apply(this,arguments)}function xb(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,Qd(r,e)}function Qd(r,e){return Qd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Qd(r,e)}function dd(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function pP(r,e){if(!!r){if(typeof r=="string")return ny(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ny(r,e)}}function ny(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Vs(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=pP(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yP(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function gP(r){var e=yP(r,"string");return typeof e=="symbol"?e:String(e)}var Lr=Symbol("mobx-stored-annotations");function yr(r){function e(t,n){if(Ya(n))return r.decorate_20223_(t,n);$o(t,n,r)}return Object.assign(e,r)}function $o(r,e,t){Zr(r,Lr)||Ga(r,Lr,vi({},r[Lr])),IP(t)||(r[Lr][e]=t)}function mP(r){return Zr(r,Lr)||Ga(r,Lr,vi({},r[Lr])),r[Lr]}function Ya(r){return typeof r=="object"&&typeof r.kind=="string"}var ye=Symbol("mobx administration"),Ja=function(){function r(t){t===void 0&&(t="Atom"),this.name_=void 0,this.isPendingUnobservation_=!1,this.isBeingObserved_=!1,this.observers_=new Set,this.batchId_=void 0,this.diffValue_=0,this.lastAccessedBy_=0,this.lowestObserverState_=He.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=t,this.batchId_=ee.inBatch?ee.batchId:NaN}var e=r.prototype;return e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.reportObserved=function(){return Zb(this)},e.reportChanged=function(){(!ee.inBatch||this.batchId_!==ee.batchId)&&(ee.stateVersion=ee.stateVersion<Number.MAX_SAFE_INTEGER?ee.stateVersion+1:Number.MIN_SAFE_INTEGER,this.batchId_=NaN),On(),ew(this),Bn()},e.toString=function(){return this.name_},r}(),Sh=Oi("Atom",Ja);function ll(r,e,t){e===void 0&&(e=Ws),t===void 0&&(t=Ws);var n=new Ja(r);return e!==Ws&&uw(n,e),t!==Ws&&Za(n,t),n}function bP(r,e){return r===e}function wP(r,e){return Th(r,e)}function kP(r,e){return Th(r,e,1)}function SP(r,e){return Object.is?Object.is(r,e):r===e?r!==0||1/r===1/e:r!==r&&e!==e}var ss={identity:bP,structural:wP,default:SP,shallow:kP};function os(r,e,t){return bl(r)?r:Array.isArray(r)?mt.array(r,{name:t}):ti(r)?mt.object(r,void 0,{name:t}):No(r)?mt.map(r,{name:t}):Ha(r)?mt.set(r,{name:t}):typeof r=="function"&&!Bi(r)&&!go(r)?Rb(r)?us(r):yo(t,r):r}function vP(r,e,t){if(r==null||Ft(r)||Xt(r)||qt(r)||vn(r))return r;if(Array.isArray(r))return mt.array(r,{name:t,deep:!1});if(ti(r))return mt.object(r,void 0,{name:t,deep:!1});if(No(r))return mt.map(r,{name:t,deep:!1});if(Ha(r))return mt.set(r,{name:t,deep:!1})}function dl(r){return r}function _P(r,e){return Th(r,e)?e:r}var Cb="override",AP=yr({annotationType_:Cb,make_:EP,extend_:PP,decorate_20223_:RP});function IP(r){return r.annotationType_===Cb}function EP(r,e){return 0}function PP(r,e,t,n){Re("'"+this.annotationType_+"' can only be used with 'makeObservable'")}function RP(r,e){console.warn("'"+this.annotationType_+"' cannot be used with decorators - this is a no-op")}function Qa(r,e){return{annotationType_:r,options_:e,make_:TP,extend_:OP,decorate_20223_:BP}}function TP(r,e,t,n){var i;if((i=this.options_)!=null&&i.bound)return this.extend_(r,e,t,!1)===null?0:1;if(n===r.target_)return this.extend_(r,e,t,!1)===null?0:2;if(Bi(t.value))return 1;var s=Mb(r,this,e,t,!1);return Kr(n,e,s),2}function OP(r,e,t,n){var i=Mb(r,this,e,t);return r.defineProperty_(e,i,n)}function BP(r,e){var t=e.kind,n=e.name,i=e.addInitializer,s=this,o=function(l){var u,d,m,y;return _i((u=(d=s.options_)==null?void 0:d.name)!=null?u:n.toString(),l,(m=(y=s.options_)==null?void 0:y.autoAction)!=null?m:!1)};if(t=="field"){i(function(){$o(this,n,s)});return}if(t=="method"){var a;return Bi(r)||(r=o(r)),(a=this.options_)!=null&&a.bound&&i(function(){var c=this,l=c[n].bind(c);l.isMobxAction=!0,c[n]=l}),r}Re("Cannot apply '"+s.annotationType_+"' to '"+String(n)+"' (kind: "+t+"):"+(`
'`+s.annotationType_+"' can only be used on properties with a function value."))}function xP(r,e,t,n){e.annotationType_,n.value}function Mb(r,e,t,n,i){var s,o,a,c,l,u,d;i===void 0&&(i=ee.safeDescriptors),xP(r,e,t,n);var m=n.value;if((s=e.options_)!=null&&s.bound){var y;m=m.bind((y=r.proxy_)!=null?y:r.target_)}return{value:_i((o=(a=e.options_)==null?void 0:a.name)!=null?o:t.toString(),m,(c=(l=e.options_)==null?void 0:l.autoAction)!=null?c:!1,(u=e.options_)!=null&&u.bound?(d=r.proxy_)!=null?d:r.target_:void 0),configurable:i?r.isPlainObject_:!0,enumerable:!1,writable:!i}}function Lb(r,e){return{annotationType_:r,options_:e,make_:CP,extend_:MP,decorate_20223_:LP}}function CP(r,e,t,n){var i;if(n===r.target_)return this.extend_(r,e,t,!1)===null?0:2;if((i=this.options_)!=null&&i.bound&&(!Zr(r.target_,e)||!go(r.target_[e]))&&this.extend_(r,e,t,!1)===null)return 0;if(go(t.value))return 1;var s=Kb(r,this,e,t,!1,!1);return Kr(n,e,s),2}function MP(r,e,t,n){var i,s=Kb(r,this,e,t,(i=this.options_)==null?void 0:i.bound);return r.defineProperty_(e,s,n)}function LP(r,e){var t,n=e.name,i=e.addInitializer;return go(r)||(r=us(r)),(t=this.options_)!=null&&t.bound&&i(function(){var s=this,o=s[n].bind(s);o.isMobXFlow=!0,s[n]=o}),r}function KP(r,e,t,n){e.annotationType_,n.value}function Kb(r,e,t,n,i,s){s===void 0&&(s=ee.safeDescriptors),KP(r,e,t,n);var o=n.value;if(go(o)||(o=us(o)),i){var a;o=o.bind((a=r.proxy_)!=null?a:r.target_),o.isMobXFlow=!0}return{value:o,configurable:s?r.isPlainObject_:!0,enumerable:!1,writable:!s}}function vh(r,e){return{annotationType_:r,options_:e,make_:NP,extend_:$P,decorate_20223_:DP}}function NP(r,e,t){return this.extend_(r,e,t,!1)===null?0:1}function $P(r,e,t,n){return zP(r,this,e,t),r.defineComputedProperty_(e,vi({},this.options_,{get:t.get,set:t.set}),n)}function DP(r,e){var t=this,n=e.name,i=e.addInitializer;return i(function(){var s=Is(this)[ye],o=vi({},t.options_,{get:r,context:this});o.name||(o.name="ObservableObject."+n.toString()),s.values_.set(n,new po(o))}),function(){return this[ye].getObservablePropValue_(n)}}function zP(r,e,t,n){e.annotationType_,n.get}function fl(r,e){return{annotationType_:r,options_:e,make_:WP,extend_:VP,decorate_20223_:UP}}function WP(r,e,t){return this.extend_(r,e,t,!1)===null?0:1}function VP(r,e,t,n){var i,s;return FP(r,this),r.defineObservableProperty_(e,t.value,(i=(s=this.options_)==null?void 0:s.enhancer)!=null?i:os,n)}function UP(r,e){var t=this,n=e.kind,i=e.name,s=new WeakSet;function o(a,c){var l,u,d=Is(a)[ye],m=new bi(c,(l=(u=t.options_)==null?void 0:u.enhancer)!=null?l:os,"ObservableObject."+i.toString(),!1);d.values_.set(i,m),s.add(a)}if(n=="accessor")return{get:function(){return s.has(this)||o(this,r.get.call(this)),this[ye].getObservablePropValue_(i)},set:function(c){return s.has(this)||o(this,c),this[ye].setObservablePropValue_(i,c)},init:function(c){return s.has(this)||o(this,c),c}}}function FP(r,e,t,n){e.annotationType_}var jP="true",qP=Nb();function Nb(r){return{annotationType_:jP,options_:r,make_:GP,extend_:HP,decorate_20223_:YP}}function GP(r,e,t,n){var i,s;if(t.get)return ar.make_(r,e,t,n);if(t.set){var o=_i(e.toString(),t.set);return n===r.target_?r.defineProperty_(e,{configurable:ee.safeDescriptors?r.isPlainObject_:!0,set:o})===null?0:2:(Kr(n,e,{configurable:!0,set:o}),2)}if(n!==r.target_&&typeof t.value=="function"){var a;if(Rb(t.value)){var c,l=(c=this.options_)!=null&&c.autoBind?us.bound:us;return l.make_(r,e,t,n)}var u=(a=this.options_)!=null&&a.autoBind?yo.bound:yo;return u.make_(r,e,t,n)}var d=((i=this.options_)==null?void 0:i.deep)===!1?mt.ref:mt;if(typeof t.value=="function"&&(s=this.options_)!=null&&s.autoBind){var m;t.value=t.value.bind((m=r.proxy_)!=null?m:r.target_)}return d.make_(r,e,t,n)}function HP(r,e,t,n){var i,s;if(t.get)return ar.extend_(r,e,t,n);if(t.set)return r.defineProperty_(e,{configurable:ee.safeDescriptors?r.isPlainObject_:!0,set:_i(e.toString(),t.set)},n);if(typeof t.value=="function"&&(i=this.options_)!=null&&i.autoBind){var o;t.value=t.value.bind((o=r.proxy_)!=null?o:r.target_)}var a=((s=this.options_)==null?void 0:s.deep)===!1?mt.ref:mt;return a.extend_(r,e,t,n)}function YP(r,e){Re("'"+this.annotationType_+"' cannot be used as a decorator")}var JP="observable",QP="observable.ref",XP="observable.shallow",ZP="observable.struct",$b={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze($b);function yc(r){return r||$b}var Xd=fl(JP),eR=fl(QP,{enhancer:dl}),tR=fl(XP,{enhancer:vP}),nR=fl(ZP,{enhancer:_P}),Db=yr(Xd);function gc(r){return r.deep===!0?os:r.deep===!1?dl:iR(r.defaultDecorator)}function rR(r){var e;return r?(e=r.defaultDecorator)!=null?e:Nb(r):void 0}function iR(r){var e,t;return r&&(e=(t=r.options_)==null?void 0:t.enhancer)!=null?e:os}function zb(r,e,t){if(Ya(e))return Xd.decorate_20223_(r,e);if(is(e)){$o(r,e,Xd);return}return bl(r)?r:ti(r)?mt.object(r,e,t):Array.isArray(r)?mt.array(r,e):No(r)?mt.map(r,e):Ha(r)?mt.set(r,e):typeof r=="object"&&r!==null?r:mt.box(r,e)}Ib(zb,Db);var sR={box:function(e,t){var n=yc(t);return new bi(e,gc(n),n.name,!0,n.equals)},array:function(e,t){var n=yc(t);return(ee.useProxies===!1||n.proxy===!1?gT:oT)(e,gc(n),n.name)},map:function(e,t){var n=yc(t);return new wl(e,gc(n),n.name)},set:function(e,t){var n=yc(t);return new Ph(e,gc(n),n.name)},object:function(e,t,n){return Ci(function(){return gl(ee.useProxies===!1||(n==null?void 0:n.proxy)===!1?Is({},n):nT({},n),e,t)})},ref:yr(eR),shallow:yr(tR),deep:Db,struct:yr(nR)},mt=Ib(zb,sR),Wb="computed",oR="computed.struct",Zd=vh(Wb),aR=vh(oR,{equals:ss.structural}),ar=function(e,t){if(Ya(t))return Zd.decorate_20223_(e,t);if(is(t))return $o(e,t,Zd);if(ti(e))return yr(vh(Wb,e));var n=ti(t)?t:{};return n.get=e,n.name||(n.name=e.name||""),new po(n)};Object.assign(ar,Zd);ar.struct=yr(aR);var ry,iy,Zc=0,cR=1,uR=(ry=(iy=Xc(function(){},"name"))==null?void 0:iy.configurable)!=null?ry:!1,sy={value:"action",configurable:!0,writable:!1,enumerable:!1};function _i(r,e,t,n){t===void 0&&(t=!1);function i(){return Vb(r,t,e,n||this,arguments)}return i.isMobxAction=!0,uR&&(sy.value=r,Kr(i,"name",sy)),i}function Vb(r,e,t,n,i){var s=Ub(r,e);try{return t.apply(n,i)}catch(o){throw s.error_=o,o}finally{Fb(s)}}function Ub(r,e,t,n){var i=!1,s=0,o=ee.trackingDerivation,a=!e||!o;On();var c=ee.allowStateChanges;a&&(As(),c=hl(!0));var l=yl(!0),u={runAsAction_:a,prevDerivation_:o,prevAllowStateChanges_:c,prevAllowStateReads_:l,notifySpy_:i,startTime_:s,actionId_:cR++,parentActionId_:Zc};return Zc=u.actionId_,u}function Fb(r){Zc!==r.actionId_&&Re(30),Zc=r.parentActionId_,r.error_!==void 0&&(ee.suppressReactionErrors=!0),pl(r.prevAllowStateChanges_),Zs(r.prevAllowStateReads_),Bn(),r.runAsAction_&&ei(r.prevDerivation_),ee.suppressReactionErrors=!1}function ho(r,e){var t=hl(r);try{return e()}finally{pl(t)}}function hl(r){var e=ee.allowStateChanges;return ee.allowStateChanges=r,e}function pl(r){ee.allowStateChanges=r}var jb;jb=Symbol.toPrimitive;var bi=function(r){xb(e,r);function e(n,i,s,o,a){var c;return s===void 0&&(s="ObservableValue"),a===void 0&&(a=ss.default),c=r.call(this,s)||this,c.enhancer=void 0,c.name_=void 0,c.equals=void 0,c.hasUnreportedChange_=!1,c.interceptors_=void 0,c.changeListeners_=void 0,c.value_=void 0,c.dehancer=void 0,c.enhancer=i,c.name_=s,c.equals=a,c.value_=i(n,void 0,s),c}var t=e.prototype;return t.dehanceValue=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.set=function(i){this.value_,i=this.prepareNewValue_(i),i!==ee.UNCHANGED&&this.setNewValue_(i)},t.prepareNewValue_=function(i){if(sr(this)){var s=or(this,{object:this,type:Nr,newValue:i});if(!s)return ee.UNCHANGED;i=s.newValue}return i=this.enhancer(i,this.value_,this.name_),this.equals(this.value_,i)?ee.UNCHANGED:i},t.setNewValue_=function(i){var s=this.value_;this.value_=i,this.reportChanged(),gr(this)&&mr(this,{type:Nr,object:this,newValue:i,oldValue:s})},t.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},t.intercept_=function(i){return ec(this,i)},t.observe_=function(i,s){return s&&i({observableKind:"value",debugObjectName:this.name_,object:this,type:Nr,newValue:this.value_,oldValue:void 0}),tc(this,i)},t.raw=function(){return this.value_},t.toJSON=function(){return this.get()},t.toString=function(){return this.name_+"["+this.value_+"]"},t.valueOf=function(){return Bb(this.get())},t[jb]=function(){return this.valueOf()},e}(Ja),_h=Oi("ObservableValue",bi),qb;qb=Symbol.toPrimitive;var po=function(){function r(t){this.dependenciesState_=He.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.isBeingObserved_=!1,this.isPendingUnobservation_=!1,this.observers_=new Set,this.diffValue_=0,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=He.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new tu(null),this.name_=void 0,this.triggeredBy_=void 0,this.isComputing_=!1,this.isRunningSetter_=!1,this.derivation=void 0,this.setter_=void 0,this.isTracing_=eu.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,t.get||Re(31),this.derivation=t.get,this.name_=t.name||"ComputedValue",t.set&&(this.setter_=_i("ComputedValue-setter",t.set)),this.equals_=t.equals||(t.compareStructural||t.struct?ss.structural:ss.default),this.scope_=t.context,this.requiresReaction_=t.requiresReaction,this.keepAlive_=!!t.keepAlive}var e=r.prototype;return e.onBecomeStale_=function(){bR(this)},e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.get=function(){if(this.isComputing_&&Re(32,this.name_,this.derivation),ee.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)ef(this)&&(this.warnAboutUntrackedRead_(),On(),this.value_=this.computeValue_(!1),Bn());else if(Zb(this),ef(this)){var n=ee.trackingContext;this.keepAlive_&&!n&&(ee.trackingContext=this),this.trackAndCompute()&&mR(this),ee.trackingContext=n}var i=this.value_;if(Kc(i))throw i.cause;return i},e.set=function(n){if(this.setter_){this.isRunningSetter_&&Re(33,this.name_),this.isRunningSetter_=!0;try{this.setter_.call(this.scope_,n)}finally{this.isRunningSetter_=!1}}else Re(34,this.name_)},e.trackAndCompute=function(){var n=this.value_,i=this.dependenciesState_===He.NOT_TRACKING_,s=this.computeValue_(!0),o=i||Kc(n)||Kc(s)||!this.equals_(n,s);return o&&(this.value_=s),o},e.computeValue_=function(n){this.isComputing_=!0;var i=hl(!1),s;if(n)s=Gb(this,this.derivation,this.scope_);else if(ee.disableErrorBoundaries===!0)s=this.derivation.call(this.scope_);else try{s=this.derivation.call(this.scope_)}catch(o){s=new tu(o)}return pl(i),this.isComputing_=!1,s},e.suspend_=function(){this.keepAlive_||(tf(this),this.value_=void 0)},e.observe_=function(n,i){var s=this,o=!0,a=void 0;return cs(function(){var c=s.get();if(!o||i){var l=As();n({observableKind:"computed",debugObjectName:s.name_,type:Nr,object:s,newValue:c,oldValue:a}),ei(l)}o=!1,a=c})},e.warnAboutUntrackedRead_=function(){},e.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},e.valueOf=function(){return Bb(this.get())},e[qb]=function(){return this.valueOf()},r}(),as=Oi("ComputedValue",po),He;(function(r){r[r.NOT_TRACKING_=-1]="NOT_TRACKING_",r[r.UP_TO_DATE_=0]="UP_TO_DATE_",r[r.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",r[r.STALE_=2]="STALE_"})(He||(He={}));var eu;(function(r){r[r.NONE=0]="NONE",r[r.LOG=1]="LOG",r[r.BREAK=2]="BREAK"})(eu||(eu={}));var tu=function(e){this.cause=void 0,this.cause=e};function Kc(r){return r instanceof tu}function ef(r){switch(r.dependenciesState_){case He.UP_TO_DATE_:return!1;case He.NOT_TRACKING_:case He.STALE_:return!0;case He.POSSIBLY_STALE_:{for(var e=yl(!0),t=As(),n=r.observing_,i=n.length,s=0;s<i;s++){var o=n[s];if(as(o)){if(ee.disableErrorBoundaries)o.get();else try{o.get()}catch{return ei(t),Zs(e),!0}if(r.dependenciesState_===He.STALE_)return ei(t),Zs(e),!0}}return Hb(r),ei(t),Zs(e),!1}}}function Xa(){return ee.trackingDerivation!==null}function Gb(r,e,t){var n=yl(!0);Hb(r),r.newObserving_=new Array(r.observing_.length+100),r.unboundDepsCount_=0,r.runId_=++ee.runId;var i=ee.trackingDerivation;ee.trackingDerivation=r,ee.inBatch++;var s;if(ee.disableErrorBoundaries===!0)s=e.call(t);else try{s=e.call(t)}catch(o){s=new tu(o)}return ee.inBatch--,ee.trackingDerivation=i,lR(r),Zs(n),s}function lR(r){for(var e=r.observing_,t=r.observing_=r.newObserving_,n=He.UP_TO_DATE_,i=0,s=r.unboundDepsCount_,o=0;o<s;o++){var a=t[o];a.diffValue_===0&&(a.diffValue_=1,i!==o&&(t[i]=a),i++),a.dependenciesState_>n&&(n=a.dependenciesState_)}for(t.length=i,r.newObserving_=null,s=e.length;s--;){var c=e[s];c.diffValue_===0&&Qb(c,r),c.diffValue_=0}for(;i--;){var l=t[i];l.diffValue_===1&&(l.diffValue_=0,gR(l,r))}n!==He.UP_TO_DATE_&&(r.dependenciesState_=n,r.onBecomeStale_())}function tf(r){var e=r.observing_;r.observing_=[];for(var t=e.length;t--;)Qb(e[t],r);r.dependenciesState_=He.NOT_TRACKING_}function Ah(r){var e=As();try{return r()}finally{ei(e)}}function As(){var r=ee.trackingDerivation;return ee.trackingDerivation=null,r}function ei(r){ee.trackingDerivation=r}function yl(r){var e=ee.allowStateReads;return ee.allowStateReads=r,e}function Zs(r){ee.allowStateReads=r}function Hb(r){if(r.dependenciesState_!==He.UP_TO_DATE_){r.dependenciesState_=He.UP_TO_DATE_;for(var e=r.observing_,t=e.length;t--;)e[t].lowestObserverState_=He.UP_TO_DATE_}}var dR=["mobxGuid","spyListeners","enforceActions","computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","allowStateReads","disableErrorBoundaries","runId","UNCHANGED","useProxies"],la=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.batchId=Number.MIN_SAFE_INTEGER,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0,this.stateVersion=Number.MIN_SAFE_INTEGER},Nc=!0,Yb=!1,ee=function(){var r=bh();return r.__mobxInstanceCount>0&&!r.__mobxGlobals&&(Nc=!1),r.__mobxGlobals&&r.__mobxGlobals.version!==new la().version&&(Nc=!1),Nc?r.__mobxGlobals?(r.__mobxInstanceCount+=1,r.__mobxGlobals.UNCHANGED||(r.__mobxGlobals.UNCHANGED={}),r.__mobxGlobals):(r.__mobxInstanceCount=1,r.__mobxGlobals=new la):(setTimeout(function(){Yb||Re(35)},1),new la)}();function fR(){if((ee.pendingReactions.length||ee.inBatch||ee.isRunningReactions)&&Re(36),Yb=!0,Nc){var r=bh();--r.__mobxInstanceCount===0&&(r.__mobxGlobals=void 0),ee=new la}}function Jb(){return ee}function hR(){var r=new la;for(var e in r)dR.indexOf(e)===-1&&(ee[e]=r[e]);ee.allowStateChanges=!ee.enforceActions}function pR(r){return r.observers_&&r.observers_.size>0}function yR(r){return r.observers_}function gR(r,e){r.observers_.add(e),r.lowestObserverState_>e.dependenciesState_&&(r.lowestObserverState_=e.dependenciesState_)}function Qb(r,e){r.observers_.delete(e),r.observers_.size===0&&Xb(r)}function Xb(r){r.isPendingUnobservation_===!1&&(r.isPendingUnobservation_=!0,ee.pendingUnobservations.push(r))}function On(){ee.inBatch===0&&(ee.batchId=ee.batchId<Number.MAX_SAFE_INTEGER?ee.batchId+1:Number.MIN_SAFE_INTEGER),ee.inBatch++}function Bn(){if(--ee.inBatch===0){tw();for(var r=ee.pendingUnobservations,e=0;e<r.length;e++){var t=r[e];t.isPendingUnobservation_=!1,t.observers_.size===0&&(t.isBeingObserved_&&(t.isBeingObserved_=!1,t.onBUO()),t instanceof po&&t.suspend_())}ee.pendingUnobservations=[]}}function Zb(r){var e=ee.trackingDerivation;return e!==null?(e.runId_!==r.lastAccessedBy_&&(r.lastAccessedBy_=e.runId_,e.newObserving_[e.unboundDepsCount_++]=r,!r.isBeingObserved_&&ee.trackingContext&&(r.isBeingObserved_=!0,r.onBO())),r.isBeingObserved_):(r.observers_.size===0&&ee.inBatch>0&&Xb(r),!1)}function ew(r){r.lowestObserverState_!==He.STALE_&&(r.lowestObserverState_=He.STALE_,r.observers_.forEach(function(e){e.dependenciesState_===He.UP_TO_DATE_&&e.onBecomeStale_(),e.dependenciesState_=He.STALE_}))}function mR(r){r.lowestObserverState_!==He.STALE_&&(r.lowestObserverState_=He.STALE_,r.observers_.forEach(function(e){e.dependenciesState_===He.POSSIBLY_STALE_?e.dependenciesState_=He.STALE_:e.dependenciesState_===He.UP_TO_DATE_&&(r.lowestObserverState_=He.UP_TO_DATE_)}))}function bR(r){r.lowestObserverState_===He.UP_TO_DATE_&&(r.lowestObserverState_=He.POSSIBLY_STALE_,r.observers_.forEach(function(e){e.dependenciesState_===He.UP_TO_DATE_&&(e.dependenciesState_=He.POSSIBLY_STALE_,e.onBecomeStale_())}))}var Ea=function(){function r(t,n,i,s){t===void 0&&(t="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=He.NOT_TRACKING_,this.diffValue_=0,this.runId_=0,this.unboundDepsCount_=0,this.isDisposed_=!1,this.isScheduled_=!1,this.isTrackPending_=!1,this.isRunning_=!1,this.isTracing_=eu.NONE,this.name_=t,this.onInvalidate_=n,this.errorHandler_=i,this.requiresObservable_=s}var e=r.prototype;return e.onBecomeStale_=function(){this.schedule_()},e.schedule_=function(){this.isScheduled_||(this.isScheduled_=!0,ee.pendingReactions.push(this),tw())},e.isScheduled=function(){return this.isScheduled_},e.runReaction_=function(){if(!this.isDisposed_){On(),this.isScheduled_=!1;var n=ee.trackingContext;if(ee.trackingContext=this,ef(this)){this.isTrackPending_=!0;try{this.onInvalidate_()}catch(i){this.reportExceptionInDerivation_(i)}}ee.trackingContext=n,Bn()}},e.track=function(n){if(!this.isDisposed_){On(),this.isRunning_=!0;var i=ee.trackingContext;ee.trackingContext=this;var s=Gb(this,n,void 0);ee.trackingContext=i,this.isRunning_=!1,this.isTrackPending_=!1,this.isDisposed_&&tf(this),Kc(s)&&this.reportExceptionInDerivation_(s.cause),Bn()}},e.reportExceptionInDerivation_=function(n){var i=this;if(this.errorHandler_){this.errorHandler_(n,this);return}if(ee.disableErrorBoundaries)throw n;var s="[mobx] uncaught error in '"+this+"'";ee.suppressReactionErrors||console.error(s,n),ee.globalReactionErrorHandlers.forEach(function(o){return o(n,i)})},e.dispose=function(){this.isDisposed_||(this.isDisposed_=!0,this.isRunning_||(On(),tf(this),Bn()))},e.getDisposer_=function(n){var i=this,s=function o(){i.dispose(),n==null||n.removeEventListener==null||n.removeEventListener("abort",o)};return n==null||n.addEventListener==null||n.addEventListener("abort",s),s[ye]=this,s},e.toString=function(){return"Reaction["+this.name_+"]"},e.trace=function(n){},r}();function wR(r){return ee.globalReactionErrorHandlers.push(r),function(){var e=ee.globalReactionErrorHandlers.indexOf(r);e>=0&&ee.globalReactionErrorHandlers.splice(e,1)}}var kR=100,nf=function(e){return e()};function tw(){ee.inBatch>0||ee.isRunningReactions||nf(SR)}function SR(){ee.isRunningReactions=!0;for(var r=ee.pendingReactions,e=0;r.length>0;){++e===kR&&(console.error("[mobx] cycle in reaction: "+r[0]),r.splice(0));for(var t=r.splice(0),n=0,i=t.length;n<i;n++)t[n].runReaction_()}ee.isRunningReactions=!1}var nu=Oi("Reaction",Ea);function vR(r){var e=nf;nf=function(n){return r(function(){return e(n)})}}function da(){return!1}function nw(r){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var rw="action",_R="action.bound",iw="autoAction",AR="autoAction.bound",sw="<unnamed action>",rf=Qa(rw),IR=Qa(_R,{bound:!0}),sf=Qa(iw,{autoAction:!0}),ER=Qa(AR,{autoAction:!0,bound:!0});function ow(r){var e=function(n,i){if(Yn(n))return _i(n.name||sw,n,r);if(Yn(i))return _i(n,i,r);if(Ya(i))return(r?sf:rf).decorate_20223_(n,i);if(is(i))return $o(n,i,r?sf:rf);if(is(n))return yr(Qa(r?iw:rw,{name:n,autoAction:r}))};return e}var Tt=ow(!1);Object.assign(Tt,rf);var yo=ow(!0);Object.assign(yo,sf);Tt.bound=yr(IR);yo.bound=yr(ER);function Pa(r){return Vb(r.name||sw,!1,r,this,void 0)}function Bi(r){return Yn(r)&&r.isMobxAction===!0}function cs(r,e){var t,n,i,s,o;e===void 0&&(e=wh);var a=(t=(n=e)==null?void 0:n.name)!=null?t:"Autorun",c=!e.scheduler&&!e.delay,l;if(c)l=new Ea(a,function(){this.track(m)},e.onError,e.requiresObservable);else{var u=aw(e),d=!1;l=new Ea(a,function(){d||(d=!0,u(function(){d=!1,l.isDisposed_||l.track(m)}))},e.onError,e.requiresObservable)}function m(){r(l)}return(i=e)!=null&&(s=i.signal)!=null&&s.aborted||l.schedule_(),l.getDisposer_((o=e)==null?void 0:o.signal)}var PR=function(e){return e()};function aw(r){return r.scheduler?r.scheduler:r.delay?function(e){return setTimeout(e,r.delay)}:PR}function cw(r,e,t){var n,i,s,o;t===void 0&&(t=wh);var a=(n=t.name)!=null?n:"Reaction",c=Tt(a,t.onError?RR(t.onError,e):e),l=!t.scheduler&&!t.delay,u=aw(t),d=!0,m=!1,y,S,p=t.compareStructural?ss.structural:t.equals||ss.default,w=new Ea(a,function(){d||l?v():m||(m=!0,u(v))},t.onError,t.requiresObservable);function v(){if(m=!1,!w.isDisposed_){var E=!1;w.track(function(){var P=ho(!1,function(){return r(w)});E=d||!p(y,P),S=y,y=P}),(d&&t.fireImmediately||!d&&E)&&c(y,S,w),d=!1}}return(i=t)!=null&&(s=i.signal)!=null&&s.aborted||w.schedule_(),w.getDisposer_((o=t)==null?void 0:o.signal)}function RR(r,e){return function(){try{return e.apply(this,arguments)}catch(t){r.call(this,t)}}}var TR="onBO",OR="onBUO";function uw(r,e,t){return lw(TR,r,e,t)}function Za(r,e,t){return lw(OR,r,e,t)}function lw(r,e,t,n){var i=typeof n=="function"?Dr(e,t):Dr(e),s=Yn(n)?n:t,o=r+"L";return i[o]?i[o].add(s):i[o]=new Set([s]),function(){var a=i[o];a&&(a.delete(s),a.size===0&&delete i[o])}}var BR="never",mc="always",xR="observed";function CR(r){r.isolateGlobalState===!0&&fR();var e=r.useProxies,t=r.enforceActions;if(e!==void 0&&(ee.useProxies=e===mc?!0:e===BR?!1:typeof Proxy<"u"),e==="ifavailable"&&(ee.verifyProxies=!0),t!==void 0){var n=t===mc?mc:t===xR;ee.enforceActions=n,ee.allowStateChanges=!(n===!0||n===mc)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(i){i in r&&(ee[i]=!!r[i])}),ee.allowStateReads=!ee.observableRequiresReaction,r.reactionScheduler&&vR(r.reactionScheduler)}function gl(r,e,t,n){var i=hP(e);return Ci(function(){var s=Is(r,n)[ye];fo(i).forEach(function(o){s.extend_(o,i[o],t&&o in t?t[o]:!0)})}),r}function MR(r,e){return dw(Dr(r,e))}function dw(r){var e={name:r.name_};return r.observing_&&r.observing_.length>0&&(e.dependencies=KR(r.observing_).map(dw)),e}function LR(r,e){return fw(Dr(r,e))}function fw(r){var e={name:r.name_};return pR(r)&&(e.observers=Array.from(yR(r)).map(fw)),e}function KR(r){return Array.from(new Set(r))}var NR=0;function ml(){this.message="FLOW_CANCELLED"}ml.prototype=Object.create(Error.prototype);function $R(r){return r instanceof ml}var fd=Lb("flow"),DR=Lb("flow.bound",{bound:!0}),us=Object.assign(function(e,t){if(Ya(t))return fd.decorate_20223_(e,t);if(is(t))return $o(e,t,fd);var n=e,i=n.name||"<unnamed flow>",s=function(){var a=this,c=arguments,l=++NR,u=Tt(i+" - runid: "+l+" - init",n).apply(a,c),d,m=void 0,y=new Promise(function(S,p){var w=0;d=p;function v(K){m=void 0;var T;try{T=Tt(i+" - runid: "+l+" - yield "+w++,u.next).call(u,K)}catch(b){return p(b)}P(T)}function E(K){m=void 0;var T;try{T=Tt(i+" - runid: "+l+" - yield "+w++,u.throw).call(u,K)}catch(b){return p(b)}P(T)}function P(K){if(Yn(K==null?void 0:K.then)){K.then(P,p);return}return K.done?S(K.value):(m=Promise.resolve(K.value),m.then(v,E))}v(void 0)});return y.cancel=Tt(i+" - runid: "+l+" - cancel",function(){try{m&&oy(m);var S=u.return(void 0),p=Promise.resolve(S.value);p.then(Ws,Ws),oy(p),d(new ml)}catch(w){d(w)}}),y};return s.isMobXFlow=!0,s},fd);us.bound=yr(DR);function oy(r){Yn(r.cancel)&&r.cancel()}function zR(r){return r}function go(r){return(r==null?void 0:r.isMobXFlow)===!0}function WR(r,e,t){var n;return qt(r)||Xt(r)||_h(r)?n=zr(r):Ft(r)&&(n=zr(r,e)),n.dehancer=typeof e=="function"?e:t,function(){n.dehancer=void 0}}function VR(r,e,t){return Yn(t)?FR(r,e,t):UR(r,e)}function UR(r,e){return zr(r).intercept_(e)}function FR(r,e,t){return zr(r,e).intercept_(t)}function hw(r,e){if(e===void 0)return as(r);if(Ft(r)===!1||!r[ye].values_.has(e))return!1;var t=Dr(r,e);return as(t)}function pw(r){return hw(r)}function $c(r,e){return hw(r,e)}function yw(r,e){return r?e!==void 0?Ft(r)?r[ye].values_.has(e):!1:Ft(r)||!!r[ye]||Sh(r)||nu(r)||as(r):!1}function bl(r){return yw(r)}function jR(r,e){return yw(r,e)}function mo(r){if(Ft(r))return r[ye].keys_();if(qt(r)||vn(r))return Array.from(r.keys());if(Xt(r))return r.map(function(e,t){return t});Re(5)}function gw(r){if(Ft(r))return mo(r).map(function(e){return r[e]});if(qt(r))return mo(r).map(function(e){return r.get(e)});if(vn(r))return Array.from(r.values());if(Xt(r))return r.slice();Re(6)}function mw(r){if(Ft(r))return mo(r).map(function(e){return[e,r[e]]});if(qt(r))return mo(r).map(function(e){return[e,r.get(e)]});if(vn(r))return Array.from(r.entries());if(Xt(r))return r.map(function(e,t){return[t,e]});Re(7)}function bw(r,e,t){if(arguments.length===2&&!vn(r)){On();var n=e;try{for(var i in n)bw(r,i,n[i])}finally{Bn()}return}Ft(r)?r[ye].set_(e,t):qt(r)?r.set(e,t):vn(r)?r.add(e):Xt(r)?(typeof e!="number"&&(e=parseInt(e,10)),e<0&&Re("Invalid index: '"+e+"'"),On(),e>=r.length&&(r.length=e+1),r[e]=t,Bn()):Re(8)}function qR(r,e){Ft(r)?r[ye].delete_(e):qt(r)||vn(r)?r.delete(e):Xt(r)?(typeof e!="number"&&(e=parseInt(e,10)),r.splice(e,1)):Re(9)}function ww(r,e){if(Ft(r))return r[ye].has_(e);if(qt(r))return r.has(e);if(vn(r))return r.has(e);if(Xt(r))return e>=0&&e<r.length;Re(10)}function GR(r,e){if(!!ww(r,e)){if(Ft(r))return r[ye].get_(e);if(qt(r))return r.get(e);if(Xt(r))return r[e];Re(11)}}function HR(r,e,t){if(Ft(r))return r[ye].defineProperty_(e,t);Re(39)}function kw(r){if(Ft(r))return r[ye].ownKeys_();Re(38)}function bo(r,e,t,n){return Yn(t)?JR(r,e,t,n):YR(r,e,t)}function YR(r,e,t){return zr(r).observe_(e,t)}function JR(r,e,t,n){return zr(r,e).observe_(t,n)}function bc(r,e,t){return r.set(e,t),t}function Ms(r,e){if(r==null||typeof r!="object"||r instanceof Date||!bl(r))return r;if(_h(r)||as(r))return Ms(r.get(),e);if(e.has(r))return e.get(r);if(Xt(r)){var t=bc(e,r,new Array(r.length));return r.forEach(function(o,a){t[a]=Ms(o,e)}),t}if(vn(r)){var n=bc(e,r,new Set);return r.forEach(function(o){n.add(Ms(o,e))}),n}if(qt(r)){var i=bc(e,r,new Map);return r.forEach(function(o,a){i.set(a,Ms(o,e))}),i}else{var s=bc(e,r,{});return kw(r).forEach(function(o){qa.propertyIsEnumerable.call(r,o)&&(s[o]=Ms(r[o],e))}),s}}function QR(r,e){return Ms(r,new Map)}function XR(){}function ir(r,e){e===void 0&&(e=void 0),On();try{return r.apply(e)}finally{Bn()}}function ZR(r,e,t){return arguments.length===1||e&&typeof e=="object"?eT(r,e):Sw(r,e,t||{})}function Sw(r,e,t){var n;if(typeof t.timeout=="number"){var i=new Error("WHEN_TIMEOUT");n=setTimeout(function(){if(!o[ye].isDisposed_)if(o(),t.onError)t.onError(i);else throw i},t.timeout)}t.name="When";var s=_i("When-effect",e),o=cs(function(a){var c=ho(!1,r);c&&(a.dispose(),n&&clearTimeout(n),s())},t);return o}function eT(r,e){var t;if(e!=null&&(t=e.signal)!=null&&t.aborted)return Object.assign(Promise.reject(new Error("WHEN_ABORTED")),{cancel:function(){return null}});var n,i,s=new Promise(function(o,a){var c,l=Sw(r,o,vi({},e,{onError:a}));n=function(){l(),a(new Error("WHEN_CANCELLED"))},i=function(){l(),a(new Error("WHEN_ABORTED"))},e==null||(c=e.signal)==null||c.addEventListener==null||c.addEventListener("abort",i)}).finally(function(){var o;return e==null||(o=e.signal)==null||o.removeEventListener==null?void 0:o.removeEventListener("abort",i)});return s.cancel=n,s}function Ts(r){return r[ye]}var tT={has:function(e,t){return Ts(e).has_(t)},get:function(e,t){return Ts(e).get_(t)},set:function(e,t,n){var i;return is(t)?(i=Ts(e).set_(t,n,!0))!=null?i:!0:!1},deleteProperty:function(e,t){var n;return is(t)?(n=Ts(e).delete_(t,!0))!=null?n:!0:!1},defineProperty:function(e,t,n){var i;return(i=Ts(e).defineProperty_(t,n))!=null?i:!0},ownKeys:function(e){return Ts(e).ownKeys_()},preventExtensions:function(e){Re(13)}};function nT(r,e){var t,n;return Eb(),r=Is(r,e),(n=(t=r[ye]).proxy_)!=null?n:t.proxy_=new Proxy(r,tT)}function sr(r){return r.interceptors_!==void 0&&r.interceptors_.length>0}function ec(r,e){var t=r.interceptors_||(r.interceptors_=[]);return t.push(e),Pb(function(){var n=t.indexOf(e);n!==-1&&t.splice(n,1)})}function or(r,e){var t=As();try{for(var n=[].concat(r.interceptors_||[]),i=0,s=n.length;i<s&&(e=n[i](e),e&&!e.type&&Re(14),!!e);i++);return e}finally{ei(t)}}function gr(r){return r.changeListeners_!==void 0&&r.changeListeners_.length>0}function tc(r,e){var t=r.changeListeners_||(r.changeListeners_=[]);return t.push(e),Pb(function(){var n=t.indexOf(e);n!==-1&&t.splice(n,1)})}function mr(r,e){var t=As(),n=r.changeListeners_;if(!!n){n=n.slice();for(var i=0,s=n.length;i<s;i++)n[i](e);ei(t)}}function Ih(r,e,t){return Ci(function(){var n,i=Is(r,t)[ye];(n=e)!=null||(e=mP(r)),fo(e).forEach(function(s){return i.make_(s,e[s])})}),r}var hd=Symbol("mobx-keys");function rT(r,e,t){return ti(r)?gl(r,r,e,t):(Ci(function(){var n=Is(r,t)[ye];if(!r[hd]){var i=Object.getPrototypeOf(r),s=new Set([].concat(fo(r),fo(i)));s.delete("constructor"),s.delete(ye),Ga(i,hd,s)}r[hd].forEach(function(o){return n.make_(o,e&&o in e?e[o]:!0)})}),r)}var ay="splice",Nr="update",iT=1e4,sT={get:function(e,t){var n=e[ye];return t===ye?n:t==="length"?n.getArrayLength_():typeof t=="string"&&!isNaN(t)?n.get_(parseInt(t)):Zr(ru,t)?ru[t]:e[t]},set:function(e,t,n){var i=e[ye];return t==="length"&&i.setArrayLength_(n),typeof t=="symbol"||isNaN(t)?e[t]=n:i.set_(parseInt(t),n),!0},preventExtensions:function(){Re(15)}},Eh=function(){function r(t,n,i,s){t===void 0&&(t="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=i,this.legacyMode_=s,this.atom_=new Ja(t),this.enhancer_=function(o,a){return n(o,a,"ObservableArray[..]")}}var e=r.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.dehanceValues_=function(n){return this.dehancer!==void 0&&n.length>0?n.map(this.dehancer):n},e.intercept_=function(n){return ec(this,n)},e.observe_=function(n,i){return i===void 0&&(i=!1),i&&n({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),tc(this,n)},e.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},e.setArrayLength_=function(n){(typeof n!="number"||isNaN(n)||n<0)&&Re("Out of range: "+n);var i=this.values_.length;if(n!==i)if(n>i){for(var s=new Array(n-i),o=0;o<n-i;o++)s[o]=void 0;this.spliceWithArray_(i,0,s)}else this.spliceWithArray_(n,i-n)},e.updateArrayLength_=function(n,i){n!==this.lastKnownLength_&&Re(16),this.lastKnownLength_+=i,this.legacyMode_&&i>0&&Ow(n+i+1)},e.spliceWithArray_=function(n,i,s){var o=this;this.atom_;var a=this.values_.length;if(n===void 0?n=0:n>a?n=a:n<0&&(n=Math.max(0,a+n)),arguments.length===1?i=a-n:i==null?i=0:i=Math.max(0,Math.min(i,a-n)),s===void 0&&(s=Jd),sr(this)){var c=or(this,{object:this.proxy_,type:ay,index:n,removedCount:i,added:s});if(!c)return Jd;i=c.removedCount,s=c.added}if(s=s.length===0?s:s.map(function(d){return o.enhancer_(d,void 0)}),this.legacyMode_){var l=s.length-i;this.updateArrayLength_(a,l)}var u=this.spliceItemsIntoValues_(n,i,s);return(i!==0||s.length!==0)&&this.notifyArraySplice_(n,s,u),this.dehanceValues_(u)},e.spliceItemsIntoValues_=function(n,i,s){if(s.length<iT){var o;return(o=this.values_).splice.apply(o,[n,i].concat(s))}else{var a=this.values_.slice(n,n+i),c=this.values_.slice(n+i);this.values_.length+=s.length-i;for(var l=0;l<s.length;l++)this.values_[n+l]=s[l];for(var u=0;u<c.length;u++)this.values_[n+s.length+u]=c[u];return a}},e.notifyArrayChildUpdate_=function(n,i,s){var o=!this.owned_&&da(),a=gr(this),c=a||o?{observableKind:"array",object:this.proxy_,type:Nr,debugObjectName:this.atom_.name_,index:n,newValue:i,oldValue:s}:null;this.atom_.reportChanged(),a&&mr(this,c)},e.notifyArraySplice_=function(n,i,s){var o=!this.owned_&&da(),a=gr(this),c=a||o?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:ay,index:n,removed:s,added:i,removedCount:s.length,addedCount:i.length}:null;this.atom_.reportChanged(),a&&mr(this,c)},e.get_=function(n){if(this.legacyMode_&&n>=this.values_.length){console.warn("[mobx] Out of bounds read: "+n);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[n])},e.set_=function(n,i){var s=this.values_;if(this.legacyMode_&&n>s.length&&Re(17,n,s.length),n<s.length){this.atom_;var o=s[n];if(sr(this)){var a=or(this,{type:Nr,object:this.proxy_,index:n,newValue:i});if(!a)return;i=a.newValue}i=this.enhancer_(i,o);var c=i!==o;c&&(s[n]=i,this.notifyArrayChildUpdate_(n,i,o))}else{for(var l=new Array(n+1-s.length),u=0;u<l.length-1;u++)l[u]=void 0;l[l.length-1]=i,this.spliceWithArray_(s.length,0,l)}},r}();function oT(r,e,t,n){return t===void 0&&(t="ObservableArray"),n===void 0&&(n=!1),Eb(),Ci(function(){var i=new Eh(t,e,n,!1);Tb(i.values_,ye,i);var s=new Proxy(i.values_,sT);return i.proxy_=s,r&&r.length&&i.spliceWithArray_(0,0,r),s})}var ru={clear:function(){return this.splice(0)},replace:function(e){var t=this[ye];return t.spliceWithArray_(0,t.values_.length,e)},toJSON:function(){return this.slice()},splice:function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];var o=this[ye];switch(arguments.length){case 0:return[];case 1:return o.spliceWithArray_(e);case 2:return o.spliceWithArray_(e,t)}return o.spliceWithArray_(e,t,i)},spliceWithArray:function(e,t,n){return this[ye].spliceWithArray_(e,t,n)},push:function(){for(var e=this[ye],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.spliceWithArray_(e.values_.length,0,n),e.values_.length},pop:function(){return this.splice(Math.max(this[ye].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=this[ye],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.spliceWithArray_(0,0,n),e.values_.length},reverse:function(){return ee.trackingDerivation&&Re(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){ee.trackingDerivation&&Re(37,"sort");var e=this.slice();return e.sort.apply(e,arguments),this.replace(e),this},remove:function(e){var t=this[ye],n=t.dehanceValues_(t.values_).indexOf(e);return n>-1?(this.splice(n,1),!0):!1}};jt("concat",ri);jt("flat",ri);jt("includes",ri);jt("indexOf",ri);jt("join",ri);jt("lastIndexOf",ri);jt("slice",ri);jt("toString",ri);jt("toLocaleString",ri);jt("every",xi);jt("filter",xi);jt("find",xi);jt("findIndex",xi);jt("flatMap",xi);jt("forEach",xi);jt("map",xi);jt("some",xi);jt("reduce",vw);jt("reduceRight",vw);function jt(r,e){typeof Array.prototype[r]=="function"&&(ru[r]=e(r))}function ri(r){return function(){var e=this[ye];e.atom_.reportObserved();var t=e.dehanceValues_(e.values_);return t[r].apply(t,arguments)}}function xi(r){return function(e,t){var n=this,i=this[ye];i.atom_.reportObserved();var s=i.dehanceValues_(i.values_);return s[r](function(o,a){return e.call(t,o,a,n)})}}function vw(r){return function(){var e=this,t=this[ye];t.atom_.reportObserved();var n=t.dehanceValues_(t.values_),i=arguments[0];return arguments[0]=function(s,o,a){return i(s,o,a,e)},n[r].apply(n,arguments)}}var aT=Oi("ObservableArrayAdministration",Eh);function Xt(r){return ul(r)&&aT(r[ye])}var _w,Aw,cT={},fi="add",iu="delete";_w=Symbol.iterator;Aw=Symbol.toStringTag;var wl=function(){function r(t,n,i){var s=this;n===void 0&&(n=os),i===void 0&&(i="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[ye]=cT,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=n,this.name_=i,Yn(Map)||Re(18),Ci(function(){s.keysAtom_=ll("ObservableMap.keys()"),s.data_=new Map,s.hasMap_=new Map,t&&s.merge(t)})}var e=r.prototype;return e.has_=function(n){return this.data_.has(n)},e.has=function(n){var i=this;if(!ee.trackingDerivation)return this.has_(n);var s=this.hasMap_.get(n);if(!s){var o=s=new bi(this.has_(n),dl,"ObservableMap.key?",!1);this.hasMap_.set(n,o),Za(o,function(){return i.hasMap_.delete(n)})}return s.get()},e.set=function(n,i){var s=this.has_(n);if(sr(this)){var o=or(this,{type:s?Nr:fi,object:this,newValue:i,name:n});if(!o)return this;i=o.newValue}return s?this.updateValue_(n,i):this.addValue_(n,i),this},e.delete=function(n){var i=this;if(this.keysAtom_,sr(this)){var s=or(this,{type:iu,object:this,name:n});if(!s)return!1}if(this.has_(n)){var o=da(),a=gr(this),c=a||o?{observableKind:"map",debugObjectName:this.name_,type:iu,object:this,oldValue:this.data_.get(n).value_,name:n}:null;return ir(function(){var l;i.keysAtom_.reportChanged(),(l=i.hasMap_.get(n))==null||l.setNewValue_(!1);var u=i.data_.get(n);u.setNewValue_(void 0),i.data_.delete(n)}),a&&mr(this,c),!0}return!1},e.updateValue_=function(n,i){var s=this.data_.get(n);if(i=s.prepareNewValue_(i),i!==ee.UNCHANGED){var o=da(),a=gr(this),c=a||o?{observableKind:"map",debugObjectName:this.name_,type:Nr,object:this,oldValue:s.value_,name:n,newValue:i}:null;s.setNewValue_(i),a&&mr(this,c)}},e.addValue_=function(n,i){var s=this;this.keysAtom_,ir(function(){var l,u=new bi(i,s.enhancer_,"ObservableMap.key",!1);s.data_.set(n,u),i=u.value_,(l=s.hasMap_.get(n))==null||l.setNewValue_(!0),s.keysAtom_.reportChanged()});var o=da(),a=gr(this),c=a||o?{observableKind:"map",debugObjectName:this.name_,type:fi,object:this,name:n,newValue:i}:null;a&&mr(this,c)},e.get=function(n){return this.has(n)?this.dehanceValue_(this.data_.get(n).get()):this.dehanceValue_(void 0)},e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},e.values=function(){var n=this,i=this.keys();return Ra({next:function(){var o=i.next(),a=o.done,c=o.value;return{done:a,value:a?void 0:n.get(c)}}})},e.entries=function(){var n=this,i=this.keys();return Ra({next:function(){var o=i.next(),a=o.done,c=o.value;return{done:a,value:a?void 0:[c,n.get(c)]}}})},e[_w]=function(){return this.entries()},e.forEach=function(n,i){for(var s=Vs(this),o;!(o=s()).done;){var a=o.value,c=a[0],l=a[1];n.call(i,l,c,this)}},e.merge=function(n){var i=this;return qt(n)&&(n=new Map(n)),ir(function(){ti(n)?fP(n).forEach(function(s){return i.set(s,n[s])}):Array.isArray(n)?n.forEach(function(s){var o=s[0],a=s[1];return i.set(o,a)}):No(n)?(n.constructor!==Map&&Re(19,n),n.forEach(function(s,o){return i.set(o,s)})):n!=null&&Re(20,n)}),this},e.clear=function(){var n=this;ir(function(){Ah(function(){for(var i=Vs(n.keys()),s;!(s=i()).done;){var o=s.value;n.delete(o)}})})},e.replace=function(n){var i=this;return ir(function(){for(var s=uT(n),o=new Map,a=!1,c=Vs(i.data_.keys()),l;!(l=c()).done;){var u=l.value;if(!s.has(u)){var d=i.delete(u);if(d)a=!0;else{var m=i.data_.get(u);o.set(u,m)}}}for(var y=Vs(s.entries()),S;!(S=y()).done;){var p=S.value,w=p[0],v=p[1],E=i.data_.has(w);if(i.set(w,v),i.data_.has(w)){var P=i.data_.get(w);o.set(w,P),E||(a=!0)}}if(!a)if(i.data_.size!==o.size)i.keysAtom_.reportChanged();else for(var K=i.data_.keys(),T=o.keys(),b=K.next(),_=T.next();!b.done;){if(b.value!==_.value){i.keysAtom_.reportChanged();break}b=K.next(),_=T.next()}i.data_=o}),this},e.toString=function(){return"[object ObservableMap]"},e.toJSON=function(){return Array.from(this)},e.observe_=function(n,i){return tc(this,n)},e.intercept_=function(n){return ec(this,n)},kh(r,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Aw,get:function(){return"Map"}}]),r}(),qt=Oi("ObservableMap",wl);function uT(r){if(No(r)||qt(r))return r;if(Array.isArray(r))return new Map(r);if(ti(r)){var e=new Map;for(var t in r)e.set(t,r[t]);return e}else return Re(21,r)}var Iw,Ew,lT={};Iw=Symbol.iterator;Ew=Symbol.toStringTag;var Ph=function(){function r(t,n,i){var s=this;n===void 0&&(n=os),i===void 0&&(i="ObservableSet"),this.name_=void 0,this[ye]=lT,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=i,Yn(Set)||Re(22),this.enhancer_=function(o,a){return n(o,a,i)},Ci(function(){s.atom_=ll(s.name_),t&&s.replace(t)})}var e=r.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.clear=function(){var n=this;ir(function(){Ah(function(){for(var i=Vs(n.data_.values()),s;!(s=i()).done;){var o=s.value;n.delete(o)}})})},e.forEach=function(n,i){for(var s=Vs(this),o;!(o=s()).done;){var a=o.value;n.call(i,a,a,this)}},e.add=function(n){var i=this;if(this.atom_,sr(this)){var s=or(this,{type:fi,object:this,newValue:n});if(!s)return this}if(!this.has(n)){ir(function(){i.data_.add(i.enhancer_(n,void 0)),i.atom_.reportChanged()});var o=!1,a=gr(this),c=a||o?{observableKind:"set",debugObjectName:this.name_,type:fi,object:this,newValue:n}:null;a&&mr(this,c)}return this},e.delete=function(n){var i=this;if(sr(this)){var s=or(this,{type:iu,object:this,oldValue:n});if(!s)return!1}if(this.has(n)){var o=!1,a=gr(this),c=a||o?{observableKind:"set",debugObjectName:this.name_,type:iu,object:this,oldValue:n}:null;return ir(function(){i.atom_.reportChanged(),i.data_.delete(n)}),a&&mr(this,c),!0}return!1},e.has=function(n){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(n))},e.entries=function(){var n=0,i=Array.from(this.keys()),s=Array.from(this.values());return Ra({next:function(){var a=n;return n+=1,a<s.length?{value:[i[a],s[a]],done:!1}:{done:!0}}})},e.keys=function(){return this.values()},e.values=function(){this.atom_.reportObserved();var n=this,i=0,s=Array.from(this.data_.values());return Ra({next:function(){return i<s.length?{value:n.dehanceValue_(s[i++]),done:!1}:{done:!0}}})},e.replace=function(n){var i=this;return vn(n)&&(n=new Set(n)),ir(function(){Array.isArray(n)?(i.clear(),n.forEach(function(s){return i.add(s)})):Ha(n)?(i.clear(),n.forEach(function(s){return i.add(s)})):n!=null&&Re("Cannot initialize set from "+n)}),this},e.observe_=function(n,i){return tc(this,n)},e.intercept_=function(n){return ec(this,n)},e.toJSON=function(){return Array.from(this)},e.toString=function(){return"[object ObservableSet]"},e[Iw]=function(){return this.values()},kh(r,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Ew,get:function(){return"Set"}}]),r}(),vn=Oi("ObservableSet",Ph),cy=Object.create(null),uy="remove",Pw=function(){function r(t,n,i,s){n===void 0&&(n=new Map),s===void 0&&(s=qP),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=t,this.values_=n,this.name_=i,this.defaultAnnotation_=s,this.keysAtom_=new Ja("ObservableObject.keys"),this.isPlainObject_=ti(this.target_)}var e=r.prototype;return e.getObservablePropValue_=function(n){return this.values_.get(n).get()},e.setObservablePropValue_=function(n,i){var s=this.values_.get(n);if(s instanceof po)return s.set(i),!0;if(sr(this)){var o=or(this,{type:Nr,object:this.proxy_||this.target_,name:n,newValue:i});if(!o)return null;i=o.newValue}if(i=s.prepareNewValue_(i),i!==ee.UNCHANGED){var a=gr(this),c=!1,l=a||c?{type:Nr,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:s.value_,name:n,newValue:i}:null;s.setNewValue_(i),a&&mr(this,l)}return!0},e.get_=function(n){return ee.trackingDerivation&&!Zr(this.target_,n)&&this.has_(n),this.target_[n]},e.set_=function(n,i,s){return s===void 0&&(s=!1),Zr(this.target_,n)?this.values_.has(n)?this.setObservablePropValue_(n,i):s?Reflect.set(this.target_,n,i):(this.target_[n]=i,!0):this.extend_(n,{value:i,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,s)},e.has_=function(n){if(!ee.trackingDerivation)return n in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var i=this.pendingKeys_.get(n);return i||(i=new bi(n in this.target_,dl,"ObservableObject.key?",!1),this.pendingKeys_.set(n,i)),i.get()},e.make_=function(n,i){if(i===!0&&(i=this.defaultAnnotation_),i!==!1){if(!(n in this.target_)){var s;if((s=this.target_[Lr])!=null&&s[n])return;Re(1,i.annotationType_,this.name_+"."+n.toString())}for(var o=this.target_;o&&o!==qa;){var a=Xc(o,n);if(a){var c=i.make_(this,n,a,o);if(c===0)return;if(c===1)break}o=Object.getPrototypeOf(o)}dy(this,i,n)}},e.extend_=function(n,i,s,o){if(o===void 0&&(o=!1),s===!0&&(s=this.defaultAnnotation_),s===!1)return this.defineProperty_(n,i,o);var a=s.extend_(this,n,i,o);return a&&dy(this,s,n),a},e.defineProperty_=function(n,i,s){s===void 0&&(s=!1),this.keysAtom_;try{On();var o=this.delete_(n);if(!o)return o;if(sr(this)){var a=or(this,{object:this.proxy_||this.target_,name:n,type:fi,newValue:i.value});if(!a)return null;var c=a.newValue;i.value!==c&&(i=vi({},i,{value:c}))}if(s){if(!Reflect.defineProperty(this.target_,n,i))return!1}else Kr(this.target_,n,i);this.notifyPropertyAddition_(n,i.value)}finally{Bn()}return!0},e.defineObservableProperty_=function(n,i,s,o){o===void 0&&(o=!1),this.keysAtom_;try{On();var a=this.delete_(n);if(!a)return a;if(sr(this)){var c=or(this,{object:this.proxy_||this.target_,name:n,type:fi,newValue:i});if(!c)return null;i=c.newValue}var l=ly(n),u={configurable:ee.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:l.get,set:l.set};if(o){if(!Reflect.defineProperty(this.target_,n,u))return!1}else Kr(this.target_,n,u);var d=new bi(i,s,"ObservableObject.key",!1);this.values_.set(n,d),this.notifyPropertyAddition_(n,d.value_)}finally{Bn()}return!0},e.defineComputedProperty_=function(n,i,s){s===void 0&&(s=!1),this.keysAtom_;try{On();var o=this.delete_(n);if(!o)return o;if(sr(this)){var a=or(this,{object:this.proxy_||this.target_,name:n,type:fi,newValue:void 0});if(!a)return null}i.name||(i.name="ObservableObject.key"),i.context=this.proxy_||this.target_;var c=ly(n),l={configurable:ee.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:c.get,set:c.set};if(s){if(!Reflect.defineProperty(this.target_,n,l))return!1}else Kr(this.target_,n,l);this.values_.set(n,new po(i)),this.notifyPropertyAddition_(n,void 0)}finally{Bn()}return!0},e.delete_=function(n,i){if(i===void 0&&(i=!1),this.keysAtom_,!Zr(this.target_,n))return!0;if(sr(this)){var s=or(this,{object:this.proxy_||this.target_,name:n,type:uy});if(!s)return null}try{var o,a;On();var c=gr(this),l=!1,u=this.values_.get(n),d=void 0;if(!u&&(c||l)){var m;d=(m=Xc(this.target_,n))==null?void 0:m.value}if(i){if(!Reflect.deleteProperty(this.target_,n))return!1}else delete this.target_[n];if(u&&(this.values_.delete(n),u instanceof bi&&(d=u.value_),ew(u)),this.keysAtom_.reportChanged(),(o=this.pendingKeys_)==null||(a=o.get(n))==null||a.set(n in this.target_),c||l){var y={type:uy,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:d,name:n};c&&mr(this,y)}}finally{Bn()}return!0},e.observe_=function(n,i){return tc(this,n)},e.intercept_=function(n){return ec(this,n)},e.notifyPropertyAddition_=function(n,i){var s,o,a=gr(this),c=!1;if(a||c){var l=a||c?{type:fi,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:n,newValue:i}:null;a&&mr(this,l)}(s=this.pendingKeys_)==null||(o=s.get(n))==null||o.set(!0),this.keysAtom_.reportChanged()},e.ownKeys_=function(){return this.keysAtom_.reportObserved(),fo(this.target_)},e.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},r}();function Is(r,e){var t;if(Zr(r,ye))return r;var n=(t=e==null?void 0:e.name)!=null?t:"ObservableObject",i=new Pw(r,new Map,String(n),rR(e));return Ga(r,ye,i),r}var dT=Oi("ObservableObjectAdministration",Pw);function ly(r){return cy[r]||(cy[r]={get:function(){return this[ye].getObservablePropValue_(r)},set:function(t){return this[ye].setObservablePropValue_(r,t)}})}function Ft(r){return ul(r)?dT(r[ye]):!1}function dy(r,e,t){var n;(n=r.target_[Lr])==null||delete n[t]}var fT=Tw(0),hT=function(){var r=!1,e={};return Object.defineProperty(e,"0",{set:function(){r=!0}}),Object.create(e)[0]=1,r===!1}(),pd=0,Rw=function(){};function pT(r,e){Object.setPrototypeOf?Object.setPrototypeOf(r.prototype,e):r.prototype.__proto__!==void 0?r.prototype.__proto__=e:r.prototype=e}pT(Rw,Array.prototype);var Rh=function(r,e,t){xb(n,r);function n(s,o,a,c){var l;return a===void 0&&(a="ObservableArray"),c===void 0&&(c=!1),l=r.call(this)||this,Ci(function(){var u=new Eh(a,o,c,!0);u.proxy_=dd(l),Tb(dd(l),ye,u),s&&s.length&&l.spliceWithArray(0,0,s),hT&&Object.defineProperty(dd(l),"0",fT)}),l}var i=n.prototype;return i.concat=function(){this[ye].atom_.reportObserved();for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return Array.prototype.concat.apply(this.slice(),a.map(function(l){return Xt(l)?l.slice():l}))},i[t]=function(){var s=this,o=0;return Ra({next:function(){return o<s.length?{value:s[o++],done:!1}:{done:!0,value:void 0}}})},kh(n,[{key:"length",get:function(){return this[ye].getArrayLength_()},set:function(o){this[ye].setArrayLength_(o)}},{key:e,get:function(){return"Array"}}]),n}(Rw,Symbol.toStringTag,Symbol.iterator);Object.entries(ru).forEach(function(r){var e=r[0],t=r[1];e!=="concat"&&Ga(Rh.prototype,e,t)});function Tw(r){return{enumerable:!1,configurable:!0,get:function(){return this[ye].get_(r)},set:function(t){this[ye].set_(r,t)}}}function yT(r){Kr(Rh.prototype,""+r,Tw(r))}function Ow(r){if(r>pd){for(var e=pd;e<r+100;e++)yT(e);pd=r}}Ow(1e3);function gT(r,e,t){return new Rh(r,e,t)}function Dr(r,e){if(typeof r=="object"&&r!==null){if(Xt(r))return e!==void 0&&Re(23),r[ye].atom_;if(vn(r))return r.atom_;if(qt(r)){if(e===void 0)return r.keysAtom_;var t=r.data_.get(e)||r.hasMap_.get(e);return t||Re(25,e,su(r)),t}if(Ft(r)){if(!e)return Re(26);var n=r[ye].values_.get(e);return n||Re(27,e,su(r)),n}if(Sh(r)||as(r)||nu(r))return r}else if(Yn(r)&&nu(r[ye]))return r[ye];Re(28)}function zr(r,e){if(r||Re(29),e!==void 0)return zr(Dr(r,e));if(Sh(r)||as(r)||nu(r)||qt(r)||vn(r))return r;if(r[ye])return r[ye];Re(24,r)}function su(r,e){var t;if(e!==void 0)t=Dr(r,e);else{if(Bi(r))return r.name;Ft(r)||qt(r)||vn(r)?t=zr(r):t=Dr(r)}return t.name_}function Ci(r){var e=As(),t=hl(!0);On();try{return r()}finally{Bn(),pl(t),ei(e)}}var fy=qa.toString;function Th(r,e,t){return t===void 0&&(t=-1),of(r,e,t)}function of(r,e,t,n,i){if(r===e)return r!==0||1/r===1/e;if(r==null||e==null)return!1;if(r!==r)return e!==e;var s=typeof r;if(s!=="function"&&s!=="object"&&typeof e!="object")return!1;var o=fy.call(r);if(o!==fy.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+r==""+e;case"[object Number]":return+r!=+r?+e!=+e:+r==0?1/+r===1/e:+r==+e;case"[object Date]":case"[object Boolean]":return+r==+e;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(r)===Symbol.valueOf.call(e);case"[object Map]":case"[object Set]":t>=0&&t++;break}r=hy(r),e=hy(e);var a=o==="[object Array]";if(!a){if(typeof r!="object"||typeof e!="object")return!1;var c=r.constructor,l=e.constructor;if(c!==l&&!(Yn(c)&&c instanceof c&&Yn(l)&&l instanceof l)&&"constructor"in r&&"constructor"in e)return!1}if(t===0)return!1;t<0&&(t=-1),n=n||[],i=i||[];for(var u=n.length;u--;)if(n[u]===r)return i[u]===e;if(n.push(r),i.push(e),a){if(u=r.length,u!==e.length)return!1;for(;u--;)if(!of(r[u],e[u],t-1,n,i))return!1}else{var d=Object.keys(r),m;if(u=d.length,Object.keys(e).length!==u)return!1;for(;u--;)if(m=d[u],!(Zr(e,m)&&of(r[m],e[m],t-1,n,i)))return!1}return n.pop(),i.pop(),!0}function hy(r){return Xt(r)?r.slice():No(r)||qt(r)||Ha(r)||vn(r)?Array.from(r.entries()):r}function Ra(r){return r[Symbol.iterator]=mT,r}function mT(){return this}["Symbol","Map","Set"].forEach(function(r){var e=bh();typeof e[r]>"u"&&Re("MobX requires global '"+r+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:nw,extras:{getDebugName:su},$mobx:ye});var bT=Object.freeze(Object.defineProperty({__proto__:null,$mobx:ye,FlowCancellationError:ml,ObservableMap:wl,ObservableSet:Ph,Reaction:Ea,_allowStateChanges:ho,_allowStateChangesInsideComputed:Pa,_allowStateReadsEnd:Zs,_allowStateReadsStart:yl,_autoAction:yo,_endAction:Fb,_getAdministration:zr,_getGlobalState:Jb,_interceptReads:WR,_isComputingDerivation:Xa,_resetGlobalState:hR,_startAction:Ub,action:Tt,autorun:cs,comparer:ss,computed:ar,configure:CR,createAtom:ll,defineProperty:HR,entries:mw,extendObservable:gl,flow:us,flowResult:zR,get:GR,getAtom:Dr,getDebugName:su,getDependencyTree:MR,getObserverTree:LR,has:ww,intercept:VR,isAction:Bi,isBoxedObservable:_h,isComputed:pw,isComputedProp:$c,isFlow:go,isFlowCancellationError:$R,isObservable:bl,isObservableArray:Xt,isObservableMap:qt,isObservableObject:Ft,isObservableProp:jR,isObservableSet:vn,keys:mo,makeAutoObservable:rT,makeObservable:Ih,observable:mt,observe:bo,onBecomeObserved:uw,onBecomeUnobserved:Za,onReactionError:wR,override:AP,ownKeys:kw,reaction:cw,remove:qR,runInAction:Pa,set:bw,spy:nw,toJS:QR,trace:XR,transaction:ir,untracked:Ah,values:gw,when:ZR},Symbol.toStringTag,{value:"Module"})),Bw=vo(bT);(function(r){var e=z&&z.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(r,"__esModule",{value:!0}),r.Order=r.OrderSide=void 0;const t=ot,n=e(Ab.exports),i=Bw;var s;(function(a){a.Buy="buy",a.Sell="sell"})(s=r.OrderSide||(r.OrderSide={}));class o{constructor(c){this.id="",this.orderType=s.Buy,this.orderMint="",this.currencyMint="",this.currencyDecimals=0,this.price=new t.BN(0),this.orderQtyRemaining=0,this.orderOriginationQty=0,this.owner="",this.ownerAssetTokenAccount="",this.ownerCurrencyTokenAccount="",this.createdAt=0,this.slotContext=0,c&&(this.id=c.id,this.orderType=c.orderType,this.orderMint=c.orderMint,this.currencyMint=c.currencyMint,this.currencyDecimals=c.currencyDecimals,this.price=c.price,this.orderQtyRemaining=c.orderQtyRemaining,this.orderOriginationQty=c.orderOriginationQty,this.owner=c.owner,this.ownerAssetTokenAccount=c.ownerAssetTokenAccount,this.ownerCurrencyTokenAccount=c.ownerCurrencyTokenAccount,this.createdAt=c.createdAt,this.slotContext=c.slotContext),(0,i.makeObservable)(this,{orderQtyRemaining:i.observable})}get decimalDivisor(){return new n.default(10).pow(this.currencyDecimals)}get bigNumberPrice(){return new n.default(this.price.toString())}get uiPrice(){return this.bigNumberPrice.div(this.decimalDivisor).toNumber()}priceForQuantity(c=1){return this.bigNumberPrice.mul(c).div(this.decimalDivisor).toNumber()}}r.Order=o})(cl);(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(cl,r)})(al);var wT=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(ol,"__esModule",{value:!0});ol.createExchangeInstruction=void 0;const wc=ot,kc=ni,kT=Nn,py=Ri,ST=Ri,yd=lr,gd=al;function vT({connection:r,orderAccount:e,purchaseQty:t,orderTaker:n,orderTakerDepositTokenAccount:i,programId:s,expectedPrice:o,orderType:a,assetMint:c,currencyMint:l,orderInitializer:u,saVault:d,stakingProgramId:m,registeredStake:y,stakingAccount:S,extraAccounts:p=[]}){return wT(this,void 0,void 0,function*(){const w=(0,kT.getMarketplaceProgram)({connection:r,programId:s}),v={signers:[],instructions:[]},E=a===gd.OrderSide.Sell?new kc.PublicKey(c):new kc.PublicKey(l),P=a===gd.OrderSide.Sell?new kc.PublicKey(l):new kc.PublicKey(c);let K=null,T=null,b=null,_=yield(0,yd.getTokenAccount)(r,u,E,n);"createInstruction"in _?(v.instructions.push(..._.createInstruction),_.tokenAccount instanceof wc.web3.Keypair?(K=_.tokenAccount.publicKey,v.signers.push(_.tokenAccount)):K=_.tokenAccount):K=_.tokenAccount,_=yield(0,yd.getTokenAccount)(r,u,P,n),"createInstruction"in _?(v.instructions.push(..._.createInstruction),_.tokenAccount instanceof wc.web3.Keypair?(T=_.tokenAccount.publicKey,v.signers.push(_.tokenAccount)):T=_.tokenAccount):T=_.tokenAccount;const[R]=yield(0,py.getOrderVault)(u,E,s),[W]=yield(0,ST.getOpenOrdersCounter)(u,E,s);_=yield(0,yd.getTokenAccount)(r,n,E),"createInstruction"in _?(v.instructions.push(..._.createInstruction),_.tokenAccount instanceof wc.web3.Keypair?(b=_.tokenAccount.publicKey,v.signers.push(_.tokenAccount)):b=_.tokenAccount):b=_.tokenAccount;const B=a===gd.OrderSide.Buy?n:u,[V]=yield(0,py.getFeeExemptAccount)(B,s),q=yield w.methods.processExchange(new wc.BN(t),o,B).accounts({orderTaker:n,orderTakerDepositTokenAccount:i,orderTakerReceiveTokenAccount:b,currencyMint:l,assetMint:c,orderInitializer:u,initializerDepositTokenAccount:K,initializerReceiveTokenAccount:T,orderVaultAccount:R,orderAccount:e,openOrdersCounter:W,saVault:d,atlasStaking:m,registeredStake:y,stakingAccount:S,feeReduction:V}).remainingAccounts(p).instruction();return v.instructions.push(q),v})}ol.createExchangeInstruction=vT;var kl={},_T=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(kl,"__esModule",{value:!0});kl.createInitializeMarketInstruction=void 0;const AT=Nn;function IT({connection:r,updateAuthorityAccount:e,programId:t}){return _T(this,void 0,void 0,function*(){const i=[yield(0,AT.getMarketplaceProgram)({connection:r,programId:t}).methods.initializeMarketplace().accounts({updateAuthorityAccount:e}).instruction()];return{accounts:[],instructions:i}})}kl.createInitializeMarketInstruction=IT;var Sl={},ET=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Sl,"__esModule",{value:!0});Sl.createRegisterCurrencyInstruction=void 0;const PT=ot,RT=Nn;function TT({connection:r,updateAuthorityAccount:e,royalty:t,saCurrencyVault:n,currencyMint:i,programId:s}){return ET(this,void 0,void 0,function*(){const a=[yield(0,RT.getMarketplaceProgram)({connection:r,programId:s}).methods.registerCurrency(new PT.BN(t)).accounts({updateAuthorityAccount:e,saCurrencyVault:n,currencyMint:i}).instruction()];return{accounts:[],instructions:a}})}Sl.createRegisterCurrencyInstruction=TT;var wi={},Oh=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(wi,"__esModule",{value:!0});wi.updateRoyaltyTier=wi.deleteRoyaltyTier=wi.addRoyaltyTier=void 0;const Ta=ot,Bh=Nn;function OT({connection:r,updateAuthorityAccount:e,registeredCurrency:t,stakeAmount:n,discount:i,programId:s}){return Oh(this,void 0,void 0,function*(){const o=(0,Bh.getMarketplaceProgram)({connection:r,programId:s}),a={signers:[],instructions:[]},c=yield o.methods.addRoyaltyTier(new Ta.BN(n),new Ta.BN(i)).accounts({updateAuthorityAccount:e,registeredCurrency:t}).instruction();return a.instructions.push(c),a})}wi.addRoyaltyTier=OT;function BT({connection:r,updateAuthorityAccount:e,registeredCurrency:t,stakeAmount:n,programId:i}){return Oh(this,void 0,void 0,function*(){const s=(0,Bh.getMarketplaceProgram)({connection:r,programId:i}),o={signers:[],instructions:[]},a=yield s.methods.deleteRoyaltyTier(new Ta.BN(n)).accounts({updateAuthorityAccount:e,registeredCurrency:t}).instruction();return o.instructions.push(a),o})}wi.deleteRoyaltyTier=BT;function xT({connection:r,updateAuthorityAccount:e,registeredCurrency:t,stakeAmount:n,discount:i,programId:s}){return Oh(this,void 0,void 0,function*(){const o=(0,Bh.getMarketplaceProgram)({connection:r,programId:s}),a={signers:[],instructions:[]},c=yield o.methods.updateRoyaltyTier(new Ta.BN(n),new Ta.BN(i)).accounts({updateAuthorityAccount:e,registeredCurrency:t}).instruction();return a.instructions.push(c),a})}wi.updateRoyaltyTier=xT;var wo={},xw=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(wo,"__esModule",{value:!0});wo.createUpdateRegisteredCurrencyVaultInstruction=wo.createUpdateRegisteredCurrencyRoyaltyInstruction=void 0;const CT=ot,Cw=Nn;function MT({connection:r,updateAuthorityAccount:e,royalty:t,currencyMint:n,programId:i}){return xw(this,void 0,void 0,function*(){return[yield(0,Cw.getMarketplaceProgram)({connection:r,programId:i}).methods.updateCurrencyRoyalty(new CT.BN(t)).accounts({updateAuthorityAccount:e,currencyMint:n}).instruction()]})}wo.createUpdateRegisteredCurrencyRoyaltyInstruction=MT;function LT({connection:r,updateAuthorityAccount:e,saCurrencyVault:t,currencyMint:n,programId:i}){return xw(this,void 0,void 0,function*(){return[yield(0,Cw.getMarketplaceProgram)({connection:r,programId:i}).methods.updateCurrencyVault().accounts({updateAuthorityAccount:e,saCurrencyVault:t,currencyMint:n}).instruction()]})}wo.createUpdateRegisteredCurrencyVaultInstruction=LT;var ko={},Mw=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(ko,"__esModule",{value:!0});ko.createRemoveFeeExemptionInstruction=ko.createAddFeeExemptionInstruction=void 0;const KT=ot,Lw=Nn,ou=Ri;function NT({connection:r,updateAuthorityAccount:e,funder:t,feeExemptTarget:n,programId:i}){return Mw(this,void 0,void 0,function*(){const s=(0,Lw.getMarketplaceProgram)({connection:r,programId:i}),o={signers:[],instructions:[]},a=1e6,[c]=yield(0,ou.getFeeExemptAccount)(n,i),[l]=yield(0,ou.getMarketVarsAccount)(i),u=[yield s.methods.addFeeExemption(new KT.BN(a)).accounts({updateAuthorityMaster:e,funder:t,feeExemptTarget:n,feeExemptAccount:c,marketVarsAccount:l}).instruction()];return o.instructions.push(...u),o})}ko.createAddFeeExemptionInstruction=NT;function $T({connection:r,updateAuthorityAccount:e,funder:t,feeExemptTarget:n,programId:i}){return Mw(this,void 0,void 0,function*(){const s=(0,Lw.getMarketplaceProgram)({connection:r,programId:i}),o={signers:[],instructions:[]},[a]=yield(0,ou.getFeeExemptAccount)(n,i),[c]=yield(0,ou.getMarketVarsAccount)(i),l=[yield s.methods.removeFeeExemption().accounts({updateAuthorityMaster:e,funder:t,feeExemptAccount:a,feeExemptTarget:n,marketVarsAccount:c}).instruction()];return o.instructions.push(...l),o})}ko.createRemoveFeeExemptionInstruction=$T;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(yb,r),t(nl,r),t(lo,r),t(sl,r),t(ol,r),t(kl,r),t(Sl,r),t(wi,r),t(wo,r),t(ko,r)})(yh);var Do={},Kw={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.GmLogs=void 0,function(e){e.CancelOrderMemo="CancelOrderMemo",e.ExchangeMemo="ExchangeMemo",e.InitializeMemo="InitializeMemo",e.RegisterCurrencyMemo="RegisterCurrencyMemo"}(r.GmLogs||(r.GmLogs={}))})(Kw);var Nw={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.GmEventType=void 0,function(e){e[e.orderAdded=0]="orderAdded",e[e.orderRemoved=1]="orderRemoved",e[e.orderModified=2]="orderModified"}(r.GmEventType||(r.GmEventType={}))})(Nw);(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Fa,r),t(Kw,r),t(Nw,r)})(Do);var $w={},vl={},Dw=function(){},DT=function(r){return r};function zw(r){throw new Error("[mobx-utils] "+r)}function Ai(r,e){e===void 0&&(e="Illegal state"),r||zw(e)}function Ww(r,e,t){Object.defineProperty(r,e,{enumerable:!1,writable:!0,configurable:!0,value:t})}var Vw=function(r){return r&&r!==Object.prototype&&Object.getOwnPropertyNames(r).concat(Vw(Object.getPrototypeOf(r))||[])},zT=function(r){var e=Vw(r),t=e.filter(function(n,i){return e.indexOf(n)===i});return t},af=function(r){return zT(r).filter(function(e){return e!=="constructor"&&!~e.indexOf("__")})},au="pending",Oa="fulfilled",_l="rejected";function WT(r){switch(this.state){case au:return r.pending&&r.pending(this.value);case _l:return r.rejected&&r.rejected(this.value);case Oa:return r.fulfilled?r.fulfilled(this.value):this.value}}function cf(r,e){if(Ai(arguments.length<=2,"fromPromise expects up to two arguments"),Ai(typeof r=="function"||typeof r=="object"&&r&&typeof r.then=="function","Please pass a promise or function to fromPromise"),r.isPromiseBasedObservable===!0)return r;typeof r=="function"&&(r=new Promise(r));var t=r;r.then(Tt("observableFromPromise-resolve",function(i){t.value=i,t.state=Oa}),Tt("observableFromPromise-reject",function(i){t.value=i,t.state=_l})),t.isPromiseBasedObservable=!0,t.case=WT;var n=e&&(e.state===Oa||e.state===au)?e.value:void 0;return gl(t,{value:n,state:au},{},{deep:!1}),t}(function(r){r.reject=Tt("fromPromise.reject",function(t){var n=r(Promise.reject(t));return n.state=_l,n.value=t,n});function e(t){t===void 0&&(t=void 0);var n=r(Promise.resolve(t));return n.state=Oa,n.value=t,n}r.resolve=Tt("fromPromise.resolve",e)})(cf||(cf={}));function VT(r){return r&&r.isPromiseBasedObservable===!0}var yy=function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n};function UT(r,e,t){if(gy(r,e),gy(r,t),e!==t){var n=r.slice(),i;return e<t?i=yy(n.slice(0,e),n.slice(e+1,t+1),[n[e]],n.slice(t+1)):i=yy(n.slice(0,t),[n[e]],n.slice(t,e),n.slice(e+1)),r.replace(i),r}}function gy(r,e){if(e<0)throw new Error("[mobx.array] Index out of bounds: "+e+" is negative");var t=r.length;if(e>=t)throw new Error("[mobx.array] Index out of bounds: "+e+" is not smaller than "+t)}function FT(r,e){e===void 0&&(e=void 0);var t=!1,n=mt.box(e,{deep:!1}),i=mt.box(!1),s=function(){return t||(t=!0,ho(!0,function(){i.set(!0)}),r(function(a){ho(!0,function(){n.set(a),i.set(!1)})})),n.get()},o=Tt("lazyObservable-reset",function(){return t=!1,n.set(e),n.get()});return{current:s,refresh:function(){return t?(t=!1,s()):n.get()},reset:function(){return o()},get pending(){return i.get()}}}function xh(r,e,t){e===void 0&&(e=Dw),t===void 0&&(t=void 0);var n=!1,i=!1,s=t,o=function(){n&&(n=!1,e())},a=ll("ResourceBasedObservable",function(){Ai(!n&&!i),n=!0,r(function(c){ho(!0,function(){s=c,a.reportChanged()})})},o);return{current:function(){Ai(!i,"subscribingObservable has already been disposed");var c=a.reportObserved();return!c&&!n&&console.warn("Called `get` of a subscribingObservable outside a reaction. Current value will be returned but no new subscription has started"),s},dispose:function(){i=!0,o()},isAlive:function(){return n}}}var Sc=function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s};function jT(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}function qT(r,e){var t;e===void 0&&(e=!1);var n=ar(r);return t={subscribe:function(i){return typeof i=="function"?{unsubscribe:bo(n,function(s){var o=s.newValue;return i(o)},e)}:i&&typeof i=="object"&&i.next?{unsubscribe:bo(n,function(s){var o=s.newValue;return i.next(o)},e)}:{unsubscribe:function(){}}}},t[jT()]=function(){return this},t}var GT=function(){function r(e,t){var n=this;Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"subscription",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Ih(this),Pa(function(){n.current=t,n.subscription=e.subscribe(n)})}return Object.defineProperty(r.prototype,"dispose",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.subscription&&this.subscription.unsubscribe()}}),Object.defineProperty(r.prototype,"next",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.current=e}}),Object.defineProperty(r.prototype,"complete",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.dispose()}}),Object.defineProperty(r.prototype,"error",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.current=e,this.dispose()}}),Sc([mt.ref],r.prototype,"current",void 0),Sc([Tt.bound],r.prototype,"next",null),Sc([Tt.bound],r.prototype,"complete",null),Sc([Tt.bound],r.prototype,"error",null),r}();function HT(r,e){return e===void 0&&(e=void 0),new GT(r,e)}var cu=function(){return cu=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},cu.apply(this,arguments)},Yo=function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},YT=["model","reset","submit","isDirty","isPropertyDirty","resetProperty"],Uw=function(){function r(e){var t=this;Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"localValues",{enumerable:!0,configurable:!0,writable:!0,value:mt.map({})}),Object.defineProperty(this,"localComputedValues",{enumerable:!0,configurable:!0,writable:!0,value:mt.map({})}),Object.defineProperty(this,"isPropertyDirty",{enumerable:!0,configurable:!0,writable:!0,value:function(i){return t.localValues.has(i)}}),Ih(this),Ai(Ft(e),"createViewModel expects an observable object");var n=af(this);af(e).forEach(function(i){var s;if(!n.includes(i)&&!(i===ye||i==="__mobxDidRunLazyInitializers")){if(Ai(YT.indexOf(i)===-1,"The propertyname "+i+" is reserved and cannot be used with viewModels"),$c(e,i)){var o=zr(e,i),a=o.derivation.bind(t),c=(s=o.setter_)===null||s===void 0?void 0:s.bind(t);t.localComputedValues.set(i,ar(a,{set:c}))}var l=Object.getOwnPropertyDescriptor(e,i),u=l?{enumerable:l.enumerable}:{};Object.defineProperty(t,i,cu(cu({},u),{configurable:!0,get:function(){return $c(e,i)?t.localComputedValues.get(i).get():t.isPropertyDirty(i)?t.localValues.get(i):t.model[i]},set:Tt(function(d){$c(e,i)?t.localComputedValues.get(i).set(d):d!==t.model[i]?t.localValues.set(i,d):t.localValues.delete(i)})}))}})}return Object.defineProperty(r.prototype,"isDirty",{get:function(){return this.localValues.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"changedValues",{get:function(){return new Map(this.localValues)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"submit",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;mo(this.localValues).forEach(function(t){var n=e.localValues.get(t),i=e.model[t];Xt(i)?i.replace(n):qt(i)?(i.clear(),i.merge(n)):pw(n)||(e.model[t]=n)}),this.localValues.clear()}}),Object.defineProperty(r.prototype,"reset",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.localValues.clear()}}),Object.defineProperty(r.prototype,"resetProperty",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.localValues.delete(e)}}),Yo([ar],r.prototype,"isDirty",null),Yo([ar],r.prototype,"changedValues",null),Yo([Tt.bound],r.prototype,"submit",null),Yo([Tt.bound],r.prototype,"reset",null),Yo([Tt.bound],r.prototype,"resetProperty",null),r}();function JT(r){return new Uw(r)}function QT(r,e){var t=Dr(r,e);if(!t)throw new Error("No computed provided, please provide an object created with `computed(() => expr)` or an object + property name");return bo(t,function(){})}function XT(r,e,t){if(t===void 0&&(t=0),!Xt(r))throw new Error("Expected observable array as first argument");Bi(e)||(e=Tt("queueProcessor",e));var n=function(){var i=r.slice(0);Pa(function(){return r.splice(0)}),i.forEach(e)};return t>0?cs(n,{delay:t}):cs(n)}function ZT(r,e,t,n){if(t===void 0&&(t=0),n===void 0&&(n=0),!Xt(r))throw new Error("Expected observable array as first argument");Bi(e)||(e=Tt("chunkProcessor",e));var i=function(){for(var s=function(){var o=n===0?r.length:Math.min(r.length,n),a=r.slice(0,o);Pa(function(){return r.splice(0,o)}),e(a)};r.length>0;)s()};return t>0?cs(i,{delay:t}):cs(i)}var qi={};function eO(){for(var r=0,e=Object.getOwnPropertyNames(qi);r<e.length;r++){var t=e[r];qi[t].dispose(),delete qi[t]}}function tO(r){return r===void 0&&(r=1e3),Xa()?(qi[r]||(typeof r=="number"?qi[r]=nO(r):qi[r]=rO()),qi[r].current()):Date.now()}function nO(r){var e;return xh(function(t){t(Date.now()),e=setInterval(function(){return t(Date.now())},r)},function(){clearInterval(e)},Date.now())}function rO(){var r=xh(function(e){e(Date.now());function t(){window.requestAnimationFrame(function(){e(Date.now()),r.isAlive()&&t()})}t()},function(){},Date.now());return r}function iO(r){return Xa()||console.warn("'expr' should only be used inside other reactive functions."),ar(r).get()}var uu=function(){return uu=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},uu.apply(this,arguments)},sO=0;function oO(r,e){Ai(typeof r=="function"&&r.length<2,"createTransformer expects a function that accepts one argument");var t={},n=void 0,i=!1,s=void 0;typeof e=="object"?(n=e.onCleanup,i=e.keepAlive!==void 0?e.keepAlive:!1,s=e.debugNameGenerator):typeof e=="function"&&(n=e);function o(c,l){var u,d={};typeof e=="object"?(n=e.onCleanup,s=e.debugNameGenerator,d=e):typeof e=="function"?n=e:(n=void 0,s=void 0);var m=s?s(l):"Transformer-"+r.name+"-"+c,y=ar(function(){return u=r(l)},uu(uu({},d),{name:m}));if(!i)var S=Za(y,function(){delete t[c],S(),n&&n(u,l)});return y}var a=!1;return function(c){var l=aO(c),u=t[l];if(u)return u.get();if(!i&&!Xa()){a||(console.warn("invoking a transformer from outside a reactive context won't memorized and is cleaned up immediately, unless keepAlive is set"),a=!0);var d=r(c);return n&&n(d,c),d}return u=t[l]=o(l,c),u.get()}}function aO(r){var e=typeof r;if(e==="string")return"string:"+r;if(e==="number")return"number:"+r;if(r===null||e!=="object"&&e!=="function")throw new Error("[mobx-utils] transform expected an object, function, string or number, got: "+String(r));var t=r.$transformId;return t===void 0&&(t="memoizationId:"+ ++sO,Ww(r,"$transformId",t)),t}function md(r){if(!r)return"ROOT";for(var e=[];r.parent;)e.push(r.path),r=r.parent;return e.reverse().join("/")}function bd(r){return Ft(r)||Xt(r)||qt(r)}function cO(r,e){var t=new WeakMap;function n(a){var c=t.get(a.object);i(a,c),e(a,md(c),r)}function i(a,c){switch(a.type){case"add":s(a.newValue,c,a.name);break;case"update":o(a.oldValue),s(a.newValue,c,a.name||""+a.index);break;case"remove":case"delete":o(a.oldValue);break;case"splice":a.removed.map(o),a.added.forEach(function(d,m){return s(d,c,""+(a.index+m))});for(var l=a.index+a.addedCount;l<a.object.length;l++)if(bd(a.object[l])){var u=t.get(a.object[l]);u&&(u.path=""+l)}break}}function s(a,c,l){if(bd(a)){var u=t.get(a);if(u){if(u.parent!==c||u.path!==l)throw new Error("The same observable object cannot appear twice in the same tree,"+(" trying to assign it to '"+md(c)+"/"+l+"',")+(" but it already exists at '"+md(u.parent)+"/"+u.path+"'"))}else{var d={parent:c,path:l,dispose:bo(a,n)};t.set(a,d),mw(a).forEach(function(m){var y=m[0],S=m[1];return s(S,d,y)})}}}function o(a){if(bd(a)){var c=t.get(a);if(!c)return;t.delete(a),c.dispose(),gw(a).forEach(o)}}return s(r,void 0,""),function(){o(r)}}var uO=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),lO=function(r){uO(e,r);function e(t,n,i){var s=i===void 0?{}:i,o=s.name,a=o===void 0?"ogm"+(Math.random()*1e3|0):o,c=s.keyToName,l=c===void 0?function(m){return""+m}:c,u=r.call(this)||this;Object.defineProperty(u,"_base",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"_ogmInfoKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"_groupBy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"_keyToName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"_disposeBaseObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),u._keyToName=l,u._groupBy=n,u._ogmInfoKey=Symbol("ogmInfo"+a),u._base=t;for(var d=0;d<t.length;d++)u._addItem(t[d]);return u._disposeBaseObserver=bo(u._base,function(m){if(m.type==="splice")ir(function(){for(var y=0,S=m.removed;y<S.length;y++){var p=S[y];u._removeItem(p)}for(var w=0,v=m.added;w<v.length;w++){var E=v[w];u._addItem(E)}});else if(m.type==="update")ir(function(){u._removeItem(m.oldValue),u._addItem(m.newValue)});else throw new Error("illegal state")}),u}return Object.defineProperty(e.prototype,"clear",{enumerable:!1,configurable:!0,writable:!0,value:function(){throw new Error("not supported")}}),Object.defineProperty(e.prototype,"delete",{enumerable:!1,configurable:!0,writable:!0,value:function(t){throw new Error("not supported")}}),Object.defineProperty(e.prototype,"set",{enumerable:!1,configurable:!0,writable:!0,value:function(t,n){throw new Error("not supported")}}),Object.defineProperty(e.prototype,"dispose",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._disposeBaseObserver();for(var t=0;t<this._base.length;t++){var n=this._base[t],i=n[this._ogmInfoKey];i.reaction(),delete n[this._ogmInfoKey]}}}),Object.defineProperty(e.prototype,"_getGroupArr",{enumerable:!1,configurable:!0,writable:!0,value:function(t){var n=r.prototype.get.call(this,t);return n===void 0&&(n=mt([],{name:"GroupArray["+this._keyToName(t)+"]",deep:!1}),r.prototype.set.call(this,t,n)),n}}),Object.defineProperty(e.prototype,"_removeFromGroupArr",{enumerable:!1,configurable:!0,writable:!0,value:function(t,n){var i=r.prototype.get.call(this,t);i.length===1?r.prototype.delete.call(this,t):(n===i.length-1||(i[n]=i[i.length-1],i[n][this._ogmInfoKey].groupArrIndex=n),i.length--)}}),Object.defineProperty(e.prototype,"_addItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t){var n=this,i=this._groupBy(t),s=this._getGroupArr(i),o={groupByValue:i,groupArrIndex:s.length,reaction:cw(function(){return n._groupBy(t)},function(a,c){var l=t[n._ogmInfoKey];n._removeFromGroupArr(l.groupByValue,l.groupArrIndex);var u=n._getGroupArr(a),d=u.length;u.push(t),l.groupByValue=a,l.groupArrIndex=d})};Object.defineProperty(t,this._ogmInfoKey,{configurable:!0,enumerable:!1,value:o}),s.push(t)}}),Object.defineProperty(e.prototype,"_removeItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t){var n=t[this._ogmInfoKey];this._removeFromGroupArr(n.groupByValue,n.groupArrIndex),n.reaction(),delete t[this._ogmInfoKey]}}),e}(wl),dO=function(){function r(e,t){Object.defineProperty(this,"base",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"closest",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"closestIdx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"isDisposed",{enumerable:!0,configurable:!0,writable:!0,value:!1});for(var n=this.closest=this.root=e,i=0;i<this.args.length-1&&(n=n.get(t[i]),n);i++)this.closest=n;this.closestIdx=i}return Object.defineProperty(r.prototype,"exists",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.assertNotDisposed();var e=this.args.length;return this.closestIdx>=e-1&&this.closest.has(this.args[e-1])}}),Object.defineProperty(r.prototype,"get",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(this.assertNotDisposed(),!this.exists())throw new Error("Entry doesn't exist");return this.closest.get(this.args[this.args.length-1])}}),Object.defineProperty(r.prototype,"set",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.assertNotDisposed();for(var t=this.args.length,n=this.closest,i=this.closestIdx;i<t-1;i++){var s=new Map;n.set(this.args[i],s),n=s}this.closestIdx=t-1,this.closest=n,n.set(this.args[t-1],e)}}),Object.defineProperty(r.prototype,"delete",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(this.assertNotDisposed(),!this.exists())throw new Error("Entry doesn't exist");var e=this.args.length;this.closest.delete(this.args[e-1]);for(var t=this.root,n=[t],i=0;i<e-1;i++)t=t.get(this.args[i]),n.push(t);for(var i=n.length-1;i>0;i--)n[i].size===0&&n[i-1].delete(this.args[i-1]);this.isDisposed=!0}}),Object.defineProperty(r.prototype,"assertNotDisposed",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(this.isDisposed)throw new Error("Concurrent modification exception")}}),r}(),fO=function(){function r(){Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"argsLength",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}return Object.defineProperty(r.prototype,"entry",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(this.argsLength===-1)this.argsLength=e.length;else if(this.argsLength!==e.length)throw new Error("DeepMap should be used with functions with a consistent length, expected: "+this.argsLength+", got: "+e.length);return this.last&&(this.last.isDisposed=!0),this.last=new dO(this.store,e)}}),r}(),lu=function(){return lu=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},lu.apply(this,arguments)},hO=function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n};function pO(r,e){if(e===void 0&&(e=!1),Bi(r))throw new Error("computedFn shouldn't be used on actions");var t=!1,n=0,i=typeof e=="boolean"?{keepAlive:e}:e,s=new fO;return function(){for(var o=this,a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];var l=s.entry(a);if(l.exists())return l.get().get();if(!i.keepAlive&&!Xa())return!t&&Jb().computedRequiresReaction&&(console.warn("invoking a computedFn from outside an reactive context won't be memoized, unless keepAlive is set"),t=!0),r.apply(this,a);var u,d=ar(function(){return u=r.apply(o,a)},lu(lu({},i),{name:"computedFn("+(i.name||r.name)+"#"+ ++n+")"}));return l.set(d),i.keepAlive||Za(d,function(){s.entry(a).delete(),i.onCleanup&&i.onCleanup.apply(i,hO([u],a)),u=void 0}),d.get()}}var yO=Object.freeze(Object.defineProperty({__proto__:null,FULFILLED:Oa,IDENTITY:DT,NOOP:Dw,ObservableGroupMap:lO,PENDING:au,REJECTED:_l,ViewModel:Uw,addHiddenProp:Ww,chunkProcessor:ZT,computedFn:pO,createTransformer:oO,createViewModel:JT,deepObserve:cO,expr:iO,fail:zw,get fromPromise(){return cf},fromResource:xh,fromStream:HT,getAllMethodsAndProperties:af,invariant:Ai,isPromiseBasedObservable:VT,keepAlive:QT,lazyObservable:FT,moveItem:UT,now:tO,queueProcessor:XT,resetNowInternalState:eO,toStream:qT},Symbol.toStringTag,{value:"Module"})),gO=vo(yO),Al={};Object.defineProperty(Al,"__esModule",{value:!0});Al.OrderCacheService=void 0;const my=zy.exports,Pr=Bw,by=cl,vc=Do;class mO{constructor(){this.endTriggered=!1,this.observableData={buyOrdersCache:new Map,sellOrdersCache:new Map},this.orderChanges=(0,Pr.observable)([]),this.observableData=(0,Pr.makeAutoObservable)(this.observableData),(0,Pr.makeObservable)(this,{buyOrdersCache:Pr.computed,sellOrdersCache:Pr.computed,allOrdersCache:Pr.computed})}get buyOrdersCache(){return this.observableData.buyOrdersCache}get sellOrdersCache(){return this.observableData.sellOrdersCache}get allOrdersCache(){const e=new Map;return this.buyOrdersCache.forEach(t=>{t.forEach((n,i)=>{e.set(i,n)})}),this.sellOrdersCache.forEach(t=>{t.forEach((n,i)=>{e.set(i,n)})}),e}get mints(){return(0,my.union)(Array.from(this.buyOrdersCache.keys()),Array.from(this.sellOrdersCache.keys()))}get orders(){return this.allOrdersCache}get buyOrders(){const e=new Map;return this.buyOrdersCache.forEach(t=>{t.forEach(n=>{e.set(n.id,n)})}),e}get sellOrders(){const e=new Map;return this.sellOrdersCache.forEach(t=>{t.forEach(n=>{e.set(n.id,n)})}),e}clearOrders(){const{allOrdersCache:e}=this;e.forEach(t=>{(0,Pr.runInAction)(()=>{this.orderChanges.push({eventType:vc.GmEventType.orderRemoved,order:t})})}),this.buyOrdersCache.clear(),this.sellOrdersCache.clear()}getAllOrdersCache(){return this.allOrdersCache}getOrderCacheByType(e){return e===by.OrderSide.Buy?this.getBuyOrderCache():this.getSellOrderCache()}getBuyOrderCache(){return new Map(this.buyOrdersCache)}getSellOrderCache(){return new Map(this.sellOrdersCache)}getOrderById(e){return this.allOrdersCache.get(e)}addOrder(e){const t=this.getOrdersForType(e.orderType);t.get(e.orderMint)||t.set(e.orderMint,new Map);const n=t.get(e.orderMint),i=n.get(e.id);return i&&i.slotContext>e.slotContext?i:(n.set(e.id,e),(0,Pr.runInAction)(()=>{this.orderChanges.push({eventType:vc.GmEventType.orderAdded,order:e})}),e)}updateOrder(e){const n=this.getOrdersForType(e.orderType).get(e.orderMint),i=n.get(e.id);if(!!i){if(i.orderQtyRemaining!==e.orderQtyRemaining&&e.slotContext>i.slotContext){const s=(0,my.clone)(i);s.orderQtyRemaining=e.orderQtyRemaining,n.set(e.id,s),(0,Pr.runInAction)(()=>{this.orderChanges.push({eventType:vc.GmEventType.orderModified,order:e})})}return e}}cancelOrder(e){return this.getOrdersForType(e.orderType).get(e.orderMint).delete(e.id)?((0,Pr.runInAction)(()=>{this.orderChanges.push({eventType:vc.GmEventType.orderRemoved,order:e})}),!0):!1}getOrdersForType(e){return e===by.OrderSide.Buy?this.buyOrdersCache:this.sellOrdersCache}}Al.OrderCacheService=mO;var zo={},Il={};Object.defineProperty(Il,"__esModule",{value:!0});Il.createTransactionFromInstructions=void 0;const bO=ni,wO=r=>{const e=new bO.Transaction;return e.add(...r),e};Il.createTransactionFromInstructions=wO;var So={};Object.defineProperty(So,"__esModule",{value:!0});So.TEN_THOUSAND=So.ONE_MILLION=void 0;So.ONE_MILLION=1e6;So.TEN_THOUSAND=1e4;var In=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(zo,"__esModule",{value:!0});zo.GmClientService=void 0;const ci=ni,_c=yh,jr=Ri,wd=Il,wy=lr,Os=cl,ky=So,kO=Nn,SO=Iu;class vO{constructor(){this.currencyInfo=[]}getRegisteredCurrencies(e,t,n=!1){var i;return In(this,void 0,void 0,function*(){if(((i=this.currencyInfo)===null||i===void 0?void 0:i.length)&&!n)return this.currencyInfo;const s=[],o=yield(0,jr.getAllRegisteredCurrencies)(e,t);for(const a of o){const{mint:c,royalty:l,saVault:u}=a,d=yield e.getTokenSupply(c,"recent"),{decimals:m}=d.value;s.push({decimals:m,mint:c.toString(),royaltyPercentageAsDecimal:l.toNumber()/ky.ONE_MILLION,saVault:u.toString()})}return this.currencyInfo=s,this.currencyInfo})}getAllOpenOrders(e,t){return In(this,void 0,void 0,function*(){const n=yield(0,jr.getAllOpenOrders)(e,t),i=yield e.getSlot();return this.accountItemsToOrders(e,t,n,i)})}getOpenOrdersForPlayer(e,t,n){return In(this,void 0,void 0,function*(){const i=yield(0,jr.getOpenOrdersForPlayer)(e,t,n),s=yield e.getSlot();return this.accountItemsToOrders(e,n,i,s)})}getOpenOrdersForCurrency(e,t,n){return In(this,void 0,void 0,function*(){const i=yield(0,jr.getOpenOrdersForCurrency)(e,t,n),s=yield e.getSlot();return this.accountItemsToOrders(e,n,i,s)})}getOpenOrdersForAsset(e,t,n){return In(this,void 0,void 0,function*(){const i=yield(0,jr.getOpenOrdersForAsset)(e,t,n),s=yield e.getSlot();return this.accountItemsToOrders(e,n,i,s)})}getOpenOrdersForPlayerAndCurrency(e,t,n,i){return In(this,void 0,void 0,function*(){const s=yield(0,jr.getOpenOrdersForPlayerAndCurrency)(e,t,n,i),o=yield e.getSlot();return this.accountItemsToOrders(e,i,s,o)})}getOpenOrdersForPlayerAndAsset(e,t,n,i){return In(this,void 0,void 0,function*(){const s=yield(0,jr.getOpenOrdersForPlayerAndAsset)(e,t,n,i),o=yield e.getSlot();return this.accountItemsToOrders(e,i,s,o)})}getOpenOrder(e,t,n){return In(this,void 0,void 0,function*(){const i=yield(0,jr.getSingleOrder)(e,t,n),s={publicKey:t,account:i},o=yield e.getSlot(),[a]=yield this.accountItemsToOrders(e,n,[s],o);return a})}getInitializeOrderTransaction(e,t,n,i,s,o,a,c){return In(this,void 0,void 0,function*(){let l=_c.createInitializeSellOrderInstruction,u=n,d=i;c===Os.OrderSide.Buy&&(l=_c.createInitializeBuyOrderInstruction,u=i,d=n);const m=yield(0,wy.getAssociatedTokenAddress)(t,u),{ixSet:y}=yield l({connection:e,depositMint:u,initializerDepositTokenAccount:m,initializerMainAccount:t,originationQty:s,price:o,programId:a,receiveMint:d}),{signers:S,instructions:p}=y;return{transaction:(0,wd.createTransactionFromInstructions)(p),signers:S}})}getBnPriceForCurrency(e,t,n,i){return In(this,void 0,void 0,function*(){const s=yield this.getRegisteredCurrencies(e,i),{decimals:o}=s.find(a=>a.mint.toString()===n.toString());return(0,kO.convertDecimalPriceToBn)(t,o)})}getCancelOrderTransaction(e,t,n,i){return In(this,void 0,void 0,function*(){const{instructions:s,signers:o}=yield(0,_c.createCancelOrderInstruction)({connection:e,orderAccount:t,orderInitializer:n,programId:i});return{transaction:(0,wd.createTransactionFromInstructions)(s),signers:o}})}getCreateExchangeTransaction(e,t,n,i,s,o=new ci.PublicKey("ATLocKpzDbTokxgvnLew3d7drZkEzLzDpzwgrgWKDbmc"),a=new ci.PublicKey("J5GhV1WKcEU98c1kZt36ixjaErrrPNWbZhg3JQDg114E")){return In(this,void 0,void 0,function*(){const c=new ci.PublicKey(t.id),l=new ci.PublicKey(t.orderMint),u=new ci.PublicKey(t.currencyMint),d=new ci.PublicKey(t.owner),m=t.orderType===Os.OrderSide.Buy?n:new ci.PublicKey(t.owner),y=yield(0,wy.getAssociatedTokenAddress)(n,t.orderType===Os.OrderSide.Buy?l:u),S=yield this.getRegisteredCurrencies(e,s),{saVault:p}=S.find(K=>K.mint===t.currencyMint),[w]=yield(0,SO.getStakingAccount)(o,m,a),{instructions:v,signers:E}=yield(0,_c.createExchangeInstruction)({connection:e,orderAccount:c,purchaseQty:i,orderTaker:n,orderTakerDepositTokenAccount:y,programId:s,expectedPrice:t.price,orderType:t.orderType,assetMint:l,currencyMint:u,orderInitializer:d,saVault:new ci.PublicKey(p),stakingProgramId:o,registeredStake:a,stakingAccount:w});return{transaction:(0,wd.createTransactionFromInstructions)(v),signers:E}})}accountItemsToOrders(e,t,n,i){return In(this,void 0,void 0,function*(){if(!n.length)return[];const s=yield this.getRegisteredCurrencies(e,t);return n.map(o=>{const a=o.publicKey.toString(),c=Object.keys(o.account.orderSide)[0]==="buy"?Os.OrderSide.Buy:Os.OrderSide.Sell,l=o.account.assetMint.toString(),u=o.account.currencyMint.toString(),d=o.account.price,m=o.account.orderRemainingQty.toNumber(),y=o.account.orderOriginationQty.toNumber(),S=o.account.orderInitializerPubkey.toString(),p=o.account.initializerAssetTokenAccount.toString(),w=o.account.initializerCurrencyTokenAccount.toString(),v=o.account.createdAtTimestamp.toNumber(),{decimals:E}=s.find(P=>P.mint.toString()===u);return new Os.Order({id:a,orderType:c,orderMint:l,currencyMint:u,currencyDecimals:E,price:d,orderQtyRemaining:m,orderOriginationQty:y,owner:S,ownerAssetTokenAccount:p,ownerCurrencyTokenAccount:w,createdAt:v,slotContext:i})})})}getAllFeeExemptions(e,t){return In(this,void 0,void 0,function*(){const n=[],i=yield(0,jr.getAllFeeExemptAccounts)(e,t);for(const s of i)n.push({publicKey:s.account.account.toString(),feeReductionPercentageAsDecimal:s.account.discount.toNumber()/ky.TEN_THOUSAND});return n})}}zo.GmClientService=vO;var nc={},Ac=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(nc,"__esModule",{value:!0});nc.GmEventService=void 0;const Jo=ot,kd=al,Sd=Do,_O=zo,AO=Nn,Ic=Do;class IO{constructor(e,t,n){this.registeredCurrencyInfo={},this.eventListeners=[],this.queuedEvents=[],this.connection=e,this.programId=t,this.commitment=n||e.commitment,this.handleOrderCreated=this.handleOrderCreated.bind(this),this.handleOrderExchanged=this.handleOrderExchanged.bind(this),this.handleOrderCanceled=this.handleOrderCanceled.bind(this),this.setCurrencyInfo=this.setCurrencyInfo.bind(this),this.handleCurrencyRegistered=this.handleCurrencyRegistered.bind(this)}initialize(){return Ac(this,void 0,void 0,function*(){this.idl=(0,AO.getGmLogsIDL)(this.programId),this.provider=new Jo.AnchorProvider(this.connection,null,{commitment:this.commitment}),this.program=new Jo.Program(this.idl,this.programId,this.provider,{instruction:new Jo.BorshInstructionCoder(this.idl),accounts:new Jo.BorshAccountsCoder(this.idl),state:null,events:new Jo.BorshEventCoder(this.idl)}),yield this.setCurrencyInfo();const e=this.program.addEventListener(Ic.GmLogs.InitializeMemo,this.handleOrderCreated),t=this.program.addEventListener(Ic.GmLogs.ExchangeMemo,this.handleOrderExchanged),n=this.program.addEventListener(Ic.GmLogs.CancelOrderMemo,this.handleOrderCanceled),i=this.program.addEventListener(Ic.GmLogs.RegisterCurrencyMemo,this.handleCurrencyRegistered);this.eventListeners.push(e,t,n,i)})}end(){return Ac(this,void 0,void 0,function*(){for(const e of this.eventListeners)yield this.program.removeEventListener(e);this.eventListeners=[],this.onEvent=null})}setEventHandler(e){this.onEvent=e;for(const t of this.queuedEvents)this.onEvent(t.eventType,t.order,t.slotContext)}setCurrencyInfo(){return Ac(this,void 0,void 0,function*(){const t=yield new _O.GmClientService().getRegisteredCurrencies(this.connection,this.programId,!0);for(const n of t)this.registeredCurrencyInfo[n.mint]=n})}getParsedOrderFromEvent(e,t){const n=this.registeredCurrencyInfo[e.currencyMint.toString()];if(!n)return null;const{decimals:i}=n;return new kd.Order({id:e.orderId.toString(),orderType:e.orderSide===0?kd.OrderSide.Buy:kd.OrderSide.Sell,orderMint:e.assetMint.toString(),currencyMint:e.currencyMint.toString(),currencyDecimals:i,price:e.price,orderQtyRemaining:e.orderRemainingQty.toNumber(),orderOriginationQty:e.orderOriginationQty.toNumber(),owner:e.orderInitializerPubkey.toString(),ownerAssetTokenAccount:e.initializerAssetTokenAccount.toString(),ownerCurrencyTokenAccount:e.initializerCurrencyTokenAccount.toString(),createdAt:e.createdAtTimestamp.toNumber(),slotContext:t})}handleOrderCreated(e,t){this.processEvent(Sd.GmEventType.orderAdded,this.getParsedOrderFromEvent(e,t),t)}handleOrderExchanged(e,t){this.processEvent(Sd.GmEventType.orderModified,this.getParsedOrderFromEvent(e,t),t)}handleOrderCanceled(e,t){this.processEvent(Sd.GmEventType.orderRemoved,this.getParsedOrderFromEvent(e,t),t)}processEvent(e,t,n){if(!this.onEvent){this.queuedEvents.push({eventType:e,order:t,slotContext:n});return}this.onEvent(e,t,n)}handleCurrencyRegistered(){return Ac(this,void 0,void 0,function*(){yield this.setCurrencyInfo()})}}nc.GmEventService=IO;var Bs=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(vl,"__esModule",{value:!0});vl.GmOrderbookService=void 0;const EO=gO,PO=zy.exports,RO=Al,vd=Do,Sy=zo,vy=nc;class El{constructor(e,t,n=60){this.gmClientService=new Sy.GmClientService,this.eventCallBacks=[],this.changeObserverDisposer=null,this.lastEventTimestamp=this.getNow(),this.isReloading=!1,this.connection=e,this.marketplaceProgramId=t,this.healthcheckThreshold=n,this.orderCacheService=new RO.OrderCacheService,this.gmClientService=new Sy.GmClientService,this.gmEventService=new vy.GmEventService(this.connection,this.marketplaceProgramId),this.handleMarketplaceEvent=this.handleMarketplaceEvent.bind(this)}initialize(){return Bs(this,void 0,void 0,function*(){return yield this.gmEventService.initialize(),this.changeObserverDisposer=(0,EO.queueProcessor)(this.orderCacheService.orderChanges,e=>{this.eventCallBacks.forEach(t=>t.onEvent(e))},250),this.gmEventService.setEventHandler(this.handleMarketplaceEvent),yield this.loadInitialOrders(),this.healthcheckTimer=setInterval(()=>{!this.getIsServiceHealthy()&&!this.isReloading&&this.resetOrdersData()},El.HEALTH_CHECK_RATE),this.orderCacheService.mints.length})}end(){return Bs(this,void 0,void 0,function*(){return yield this.gmEventService.end(),this.eventCallBacks=[],this.changeObserverDisposer=null,!0})}getIsServiceHealthy(){return this.getNow()-this.lastEventTimestamp<=this.healthcheckThreshold}resetOrdersData(){return Bs(this,void 0,void 0,function*(){this.isReloading||(this.isReloading=!0,yield this.resetEventService(),yield this.refetchOrderData(),this.lastEventTimestamp=this.getNow(),this.isReloading=!1)})}resetEventService(){return Bs(this,void 0,void 0,function*(){yield this.gmEventService.end(),this.gmEventService=new vy.GmEventService(this.connection,this.marketplaceProgramId),this.gmEventService.setEventHandler(this.handleMarketplaceEvent),yield this.gmEventService.initialize()})}refetchOrderData(){return Bs(this,void 0,void 0,function*(){const e=this.orderCacheService.getAllOrdersCache();try{const t=yield this.connection.getSlot("confirmed"),n=yield this.gmClientService.getAllOpenOrders(this.connection,this.marketplaceProgramId),i=new Map;for(const s of n){i.set(s.id,s);const o=e.get(s.id);o?o&&o.orderQtyRemaining!==s.orderQtyRemaining&&this.updateOrderInCache(s):this.addOrderToCache(s)}for(const s of Array.from(e.values()))s.slotContext<t&&!i.get(s.id)&&this.removeOrderFromCache(s)}catch(t){console.log("There was an error refreshing all marketplace data",t)}})}addOnEventHandler(e){this.eventCallBacks.push(e)}removeOnEventHandler(e){(0,PO.pull)(this.eventCallBacks,e)}loadInitialOrders(){return Bs(this,void 0,void 0,function*(){try{const e=yield this.gmClientService.getAllOpenOrders(this.connection,this.marketplaceProgramId);for(const t of e)this.addOrderToCache(t)}catch(e){console.log(e)}return this.orderCacheService.getAllOrdersCache().size})}addOrderToCache(e){return this.orderCacheService.addOrder(e)}removeOrderFromCache(e){return this.orderCacheService.cancelOrder(e)}updateOrderInCache(e){return this.orderCacheService.updateOrder(e)}getBuyOrders(){return this.orderCacheService.buyOrdersCache}getBuyOrdersForMint(e){return this.orderCacheService.buyOrdersCache.get(e)}getSellOrders(){return this.orderCacheService.sellOrdersCache}getSellOrdersForMint(e){return this.orderCacheService.sellOrdersCache.get(e)}getOrdersByType(e){return e==="buy"?this.getBuyOrders():this.getSellOrders()}getBuyOrdersByCurrencyAndItem(e,t){const n=this.getBuyOrdersForMint(t);if(!n)return[];const i=[...n.values()];return i.length?this.filterOrdersByCurrency(e,i):[]}getSellOrdersByCurrencyAndItem(e,t){const n=this.getSellOrdersForMint(t);if(!n)return[];const i=[...n.values()];return i.length?this.filterOrdersByCurrency(e,i):[]}filterOrdersByCurrency(e,t){return t.length?t.filter(n=>n.currencyMint===e):[]}getOrderById(e){return this.orderCacheService.getOrderById(e)}getAllOrdersByItemMint(e){const t=new Map,n=this.getSellOrdersForMint(e),i=this.getBuyOrdersForMint(e);if(n)for(const s of n.values())t.set(s.id,s);if(i)for(const s of i.values())t.set(s.id,s);return t}getAllMints(){return this.orderCacheService.mints}getAllOrdersForUserAddress(e){const t=this.orderCacheService.getAllOrdersCache();return Array.from(t.values()).filter(s=>s.owner===e)}handleOrderAddedEvent(e){this.addOrderToCache(e)}handleOrderModifiedEvent(e){if(e.orderQtyRemaining===0){this.removeOrderFromCache(e);return}this.updateOrderInCache(e)}handleOrderCanceledEvent(e){this.removeOrderFromCache(e)}handleMarketplaceEvent(e,t){if(!!t)switch(this.lastEventTimestamp=this.getNow(),e){case vd.GmEventType.orderAdded:this.handleOrderAddedEvent(t);break;case vd.GmEventType.orderModified:this.handleOrderModifiedEvent(t);break;case vd.GmEventType.orderRemoved:this.handleOrderCanceledEvent(t);break}}getNow(){return new Date().getTime()/1e3}}vl.GmOrderbookService=El;El.HEALTH_CHECK_RATE=5e3;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(vl,r),t(zo,r),t(nc,r)})($w);(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(yh,r),t(Ri,r),t(Do,r),t(Nn,r),t(al,r),t($w,r)})(ph);var Fw=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(rs,"__esModule",{value:!0});rs.createAccountTransaction=rs.createAccountInstruction=void 0;const du=ot,uf=ni,jw=ph;function TO(r,e,t,n){return Fw(this,void 0,void 0,function*(){const i=(0,jw.getGmIDL)(n),s=new du.AnchorProvider(r,null,null),o=new du.Program(i,n,s);return uf.SystemProgram.createAccount({fromPubkey:e,newAccountPubkey:t.publicKey,space:o.account.orderAccount.size,lamports:yield r.getMinimumBalanceForRentExemption(o.account.orderAccount.size),programId:n})})}rs.createAccountInstruction=TO;function OO(r,e,t,n){return Fw(this,void 0,void 0,function*(){const i=(0,jw.getGmIDL)(n),s=new du.AnchorProvider(r,null,null),o=new du.Program(i,n,s),a=new uf.Transaction({recentBlockhash:(yield r.getLatestBlockhash()).blockhash,feePayer:e});return a.add(uf.SystemProgram.createAccount({fromPubkey:e,newAccountPubkey:t.publicKey,space:o.account.orderAccount.size,lamports:yield r.getMinimumBalanceForRentExemption(o.account.orderAccount.size),programId:n})),a})}rs.createAccountTransaction=OO;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Wt,r),t(tl,r),t(rs,r)})(lr);var BO=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Wu,"__esModule",{value:!0});Wu.harvestRewardsInstruction=void 0;const xO=ot,CO=gs,MO=lr,LO=Kn;function KO({connection:r,user:e,rewardMint:t,registeredStake:n,stakingAccount:i,programId:s}){return BO(this,void 0,void 0,function*(){const o=(0,LO.getStakingProgram)({connection:r,programId:s}),a={signers:[],instructions:[]};let c=null,l=null;const u=yield(0,MO.getTokenAccount)(r,e,t);c=u.tokenAccount,"createInstruction"in u&&a.instructions.push(...u.createInstruction),c instanceof xO.web3.Keypair?(l=c.publicKey,a.signers.push(c)):l=c;const d=yield(0,CO.associatedAddress)({owner:n,mint:t}),m=yield o.methods.harvest().accounts({user:e,rewardMint:t,registeredStake:n,stakingAccount:i,userRewardAccount:l,rewardAta:d}).instruction();return a.instructions.push(m),a})}Wu.harvestRewardsInstruction=KO;var Pl={},NO=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Pl,"__esModule",{value:!0});Pl.createInitializeStakingInstruction=void 0;const $O=Kn;function DO({connection:r,updateAuthorityAccount:e,programId:t}){return NO(this,void 0,void 0,function*(){const n=(0,$O.getStakingProgram)({connection:r,programId:t}),i={signers:[],instructions:[]},s=yield n.methods.initializeStaking().accounts({updateAuthorityAccount:e}).instruction();return i.instructions.push(s),i})}Pl.createInitializeStakingInstruction=DO;var Rl={},Tl={},wn={},tn={};Object.defineProperty(tn,"__esModule",{value:!0});tn.ESCROW_AUTH=tn.STAKING_VARS=tn.STAKING_ESCROW=tn.STAKING_ACCOUNT=tn.REWARD_AUTH=tn.REWARD_ACCOUNT=tn.REGISTERED_STAKE=void 0;tn.REGISTERED_STAKE=we.Buffer.from("registered-stake");tn.REWARD_ACCOUNT=we.Buffer.from("reward-account");tn.REWARD_AUTH=we.Buffer.from("reward-vault-authority");tn.STAKING_ACCOUNT=we.Buffer.from("staking-account");tn.STAKING_ESCROW=we.Buffer.from("staking-escrow");tn.STAKING_VARS=we.Buffer.from("staking-vars");tn.ESCROW_AUTH=we.Buffer.from("escrow-auth");var Wo=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(wn,"__esModule",{value:!0});wn.getRewardAuth=wn.getTokenEscrow=wn.getStakingVarsAccount=wn.getStakingAccountsForRegisteredStake=wn.getStakingAccount=wn.getRegisteredStake=void 0;const _y=ot,rc=ni,zO=Kn,ic=tn;function WO(r,e,t,n){return Wo(this,void 0,void 0,function*(){return rc.PublicKey.findProgramAddress([ic.REGISTERED_STAKE,e.toBuffer(),t.toBuffer(),n.toBuffer()],r)})}wn.getRegisteredStake=WO;function VO(r,e,t){return Wo(this,void 0,void 0,function*(){return rc.PublicKey.findProgramAddress([ic.STAKING_ACCOUNT,e.toBuffer(),t.toBuffer()],r)})}wn.getStakingAccount=VO;function UO(r,e,t){return Wo(this,void 0,void 0,function*(){const n=new _y.AnchorProvider(r,null,null),i=(0,zO.getStakingIdl)(e),s=new _y.Program(i,e,n),o=[{dataSize:171},{memcmp:{offset:40,bytes:t.toBase58()}}];return yield s.account.stakingAccount.all(o)})}wn.getStakingAccountsForRegisteredStake=UO;function FO(r){return Wo(this,void 0,void 0,function*(){return rc.PublicKey.findProgramAddress([ic.STAKING_VARS],r)})}wn.getStakingVarsAccount=FO;function jO(r,e,t){return Wo(this,void 0,void 0,function*(){return rc.PublicKey.findProgramAddress([ic.STAKING_ESCROW,e.toBuffer(),t.toBuffer()],r)})}wn.getTokenEscrow=jO;function qO(r,e){return Wo(this,void 0,void 0,function*(){return rc.PublicKey.findProgramAddress([ic.REWARD_AUTH,e.toBuffer()],r)})}wn.getRewardAuth=qO;var ki={},Ch=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(ki,"__esModule",{value:!0});ki.getStakingVarsAccountInfo=ki.getStakingAccountInfo=ki.getRegisteredStakeAccountInfo=void 0;const Mh=Qi,GO=wn;function HO(r,e,t){return Ch(this,void 0,void 0,function*(){return yield(0,Mh.getStakingProgram)({connection:r,programId:t}).account.registeredStake.fetch(e)})}ki.getRegisteredStakeAccountInfo=HO;function YO(r,e,t){return Ch(this,void 0,void 0,function*(){return yield(0,Mh.getStakingProgram)({connection:r,programId:t}).account.stakingAccount.fetch(e)})}ki.getStakingAccountInfo=YO;function JO(r,e){return Ch(this,void 0,void 0,function*(){const t=(0,Mh.getStakingProgram)({connection:r,programId:e}),[n]=yield(0,GO.getStakingVarsAccount)(e);return yield t.account.stakingVars.fetch(n)})}ki.getStakingVarsAccountInfo=JO;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(wn,r),t(ki,r),t(tn,r)})(Tl);var QO=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Rl,"__esModule",{value:!0});Rl.registerStakeInstruction=void 0;const Ay=ot,XO=gs,ZO=Tl,eB=Kn;function tB({connection:r,authority:e,rewardMultiplier:t,stakeMint:n,rewardMint:i,cooldownPeriod:s,programId:o}){return QO(this,void 0,void 0,function*(){const a=(0,eB.getStakingProgram)({connection:r,programId:o}),c={instructions:[],signers:[]},[l]=yield(0,ZO.getRegisteredStake)(o,e,n,i),u=yield(0,XO.associatedAddress)({owner:l,mint:i}),d=yield a.methods.registerStake(new Ay.BN(t),new Ay.BN(s)).accounts({authority:e,stakeMint:n,rewardMint:i,rewardAta:u}).instruction();return c.instructions.push(d),c})}Rl.registerStakeInstruction=tB;var Ol={},nB=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Ol,"__esModule",{value:!0});Ol.createSettleStakingAccountInstruction=void 0;const rB=Kn;function iB({connection:r,authority:e,registeredStake:t,stakingAccount:n,updatedStakingPeriod:i,programId:s}){return nB(this,void 0,void 0,function*(){const o=(0,rB.getStakingProgram)({connection:r,programId:s}),a={instructions:[],signers:[]},c=yield o.methods.settle(i).accounts({authority:e,registeredStake:t,stakingAccount:n}).instruction();return a.instructions.push(c),a})}Ol.createSettleStakingAccountInstruction=iB;var Bl={},sB=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Bl,"__esModule",{value:!0});Bl.stakeTokensInstruction=void 0;const oB=gs,aB=Kn;function cB({connection:r,user:e,stakeMint:t,tokenSource:n,stakeQuantity:i,registeredStake:s,stakingAccount:o,programId:a}){return sB(this,void 0,void 0,function*(){const c=(0,aB.getStakingProgram)({connection:r,programId:a}),l=yield(0,oB.associatedAddress)({owner:o,mint:t}),u={instructions:[],signers:[]},d=yield c.methods.stakeTokens(i).accounts({user:e,stakeMint:t,tokenSource:n,registeredStake:s,tokenEscrow:l}).instruction();return u.instructions.push(d),u})}Bl.stakeTokensInstruction=cB;var xl={},uB=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(xl,"__esModule",{value:!0});xl.unstakeTokensInstruction=void 0;const lB=ot,dB=gs,fB=lr,hB=Tl,pB=Kn;function yB({connection:r,user:e,registeredStake:t,stakingAccount:n,programId:i}){return uB(this,void 0,void 0,function*(){const s=(0,pB.getStakingProgram)({connection:r,programId:i}),o={signers:[],instructions:[]},c=(yield(0,hB.getRegisteredStakeAccountInfo)(r,t,i)).rewardMint;let l=null,u=null;const d=yield(0,fB.getTokenAccount)(r,e,c);l=d.tokenAccount,"createInstruction"in d&&o.instructions.push(...d.createInstruction),l instanceof lB.web3.Keypair?(u=l.publicKey,o.signers.push(l)):u=l;const m=yield(0,dB.associatedAddress)({owner:t,mint:c}),y=yield s.methods.unstakeTokens().accounts({user:e,rewardMint:c,registeredStake:t,stakingAccount:n,userRewardAccount:u,rewardAta:m}).instruction();return o.instructions.push(y),o})}xl.unstakeTokensInstruction=yB;var Cl={},gB=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Cl,"__esModule",{value:!0});Cl.updateCooldownPeriodInstruction=void 0;const mB=ot,bB=Kn;function wB({connection:r,authority:e,registeredStake:t,cooldownPeriod:n,programId:i}){return gB(this,void 0,void 0,function*(){const s=(0,bB.getStakingProgram)({connection:r,programId:i}),o={instructions:[],signers:[]},a=yield s.methods.updateCooldownPeriod(new mB.BN(n)).accounts({authority:e,registeredStake:t}).instruction();return o.instructions.push(a),o})}Cl.updateCooldownPeriodInstruction=wB;var Ml={},kB=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Ml,"__esModule",{value:!0});Ml.updateRewardMultiplierInstruction=void 0;const SB=ot,vB=Kn;function _B({connection:r,authority:e,rewardMultiplier:t,registeredStake:n,newStakingPeriod:i,programId:s}){return kB(this,void 0,void 0,function*(){const o=(0,vB.getStakingProgram)({connection:r,programId:s}),a={instructions:[],signers:[]},c=yield o.methods.updateRewardMultiplier(new SB.BN(t),i).accounts({authority:e,registeredStake:n}).instruction();return a.instructions.push(c),a})}Ml.updateRewardMultiplierInstruction=_B;var Ll={},AB=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Ll,"__esModule",{value:!0});Ll.withdrawTokensInstruction=void 0;const IB=ot,EB=gs,PB=Kn,RB=lr;function TB({connection:r,authority:e,user:t,stakeMint:n,registeredStake:i,stakingAccount:s,programId:o}){return AB(this,void 0,void 0,function*(){const a=(0,PB.getStakingProgram)({connection:r,programId:o}),c=yield(0,EB.associatedAddress)({owner:s,mint:n}),l={signers:[],instructions:[]};let u=null,d=null;const m=yield(0,RB.getTokenAccount)(r,t,n);u=m.tokenAccount,"createInstruction"in m&&l.instructions.push(...m.createInstruction),u instanceof IB.web3.Keypair?(d=u.publicKey,l.signers.push(u)):d=u;const y=yield a.methods.withdrawTokens().accounts({user:t,authority:e,stakeMint:n,tokenSource:d,registeredStake:i,stakingAccount:s,tokenEscrow:c}).instruction();return l.instructions.push(y),l})}Ll.withdrawTokensInstruction=TB;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(jy,r),t(Eu,r),t(zu,r),t(Wu,r),t(Pl,r),t(Rl,r),t(Ol,r),t(Bl,r),t(xl,r),t(Cl,r),t(Ml,r),t(Ll,r)})(Fy);var qw={},Gw={};Object.defineProperty(Gw,"__esModule",{value:!0});(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(za,r),t(Gw,r)})(qw);(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Fy,r),t(Tl,r),t(qw,r),t(Kn,r)})(Iu);var Hw={};(function(r){var e=z&&z.__awaiter||function(d,m,y,S){function p(w){return w instanceof y?w:new y(function(v){v(w)})}return new(y||(y=Promise))(function(w,v){function E(T){try{K(S.next(T))}catch(b){v(b)}}function P(T){try{K(S.throw(T))}catch(b){v(b)}}function K(T){T.done?w(T.value):p(T.value).then(E,P)}K((S=S.apply(d,m||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.getPlayersOfFaction=r.getAllPlayers=r.getPlayer=r.enlistToFaction=r.getPlayerFactionPDA=r.getIDL=r.FactionType=void 0;const t=ot,n={version:"0.0.0",name:"enlist_to_faction",instructions:[{name:"processEnlistPlayer",accounts:[{name:"playerFactionAccount",isMut:!0,isSigner:!1},{name:"playerAccount",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"factionId",type:"u8"}]}],accounts:[{name:"PlayerFactionData",type:{kind:"struct",fields:[{name:"owner",type:"publicKey"},{name:"enlistedAtTimestamp",type:"i64"},{name:"factionId",type:"u8"},{name:"bump",type:"u8"},{name:"padding",type:{array:["u64",5]}}]}}],errors:[{code:300,name:"FactionTypeError",msg:"Faction ID must be 0, 1, or 2."}],metadata:{}},i="FACTION_ENLISTMENT";(function(d){d[d.Unenlisted=-1]="Unenlisted",d[d.MUD=0]="MUD",d[d.ONI=1]="ONI",d[d.Ustur=2]="Ustur"})(r.FactionType||(r.FactionType={}));function s(d){const m=n;return m.metadata.address=d.toBase58(),m}r.getIDL=s;function o(d,m){return e(this,void 0,void 0,function*(){return t.web3.PublicKey.findProgramAddress([we.Buffer.from(i,"utf8"),d.toBuffer()],m)})}r.getPlayerFactionPDA=o;function a(d,m,y,S){return e(this,void 0,void 0,function*(){const[p,w]=yield o(y,S),v=s(S),E=new t.AnchorProvider(d,null,null);return yield new t.Program(v,S,E).instruction.processEnlistPlayer(w,m,{accounts:{playerFactionAccount:p,playerAccount:y,systemProgram:t.web3.SystemProgram.programId,clock:t.web3.SYSVAR_CLOCK_PUBKEY}})})}r.enlistToFaction=a;function c(d,m,y){return e(this,void 0,void 0,function*(){const S=new t.AnchorProvider(d,null,null),p=s(y),w=new t.Program(p,y,S),[v]=yield o(m,y);return yield w.account.playerFactionData.fetch(v)})}r.getPlayer=c;function l(d,m){return e(this,void 0,void 0,function*(){const y=new t.AnchorProvider(d,null,null),S=s(m);return(yield new t.Program(S,m,y).account.playerFactionData.all()).map(E=>E.account)})}r.getAllPlayers=l;function u(d,m,y){return e(this,void 0,void 0,function*(){const S=new t.AnchorProvider(d,null,null),p=s(y);return(yield new t.Program(p,y,S).account.playerFactionData.all()).map(P=>P.account).filter(P=>P.factionId==m)})}r.getPlayersOfFaction=u})(Hw);var Yw={},Kl={};Object.defineProperty(Kl,"__esModule",{value:!0});Kl.gumDropIdl=void 0;Kl.gumDropIdl={version:"0.0.0",name:"merkle_distributor",instructions:[{name:"newDistributor",accounts:[{name:"base",isMut:!1,isSigner:!0},{name:"distributor",isMut:!0,isSigner:!1},{name:"payer",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"root",type:{array:["u8",32]}},{name:"temporal",type:"publicKey"}]},{name:"closeDistributor",accounts:[{name:"base",isMut:!1,isSigner:!0},{name:"distributor",isMut:!0,isSigner:!1},{name:"distributorWallet",isMut:!0,isSigner:!1},{name:"receiver",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"walletBump",type:"u8"}]},{name:"claim",accounts:[{name:"distributor",isMut:!0,isSigner:!1},{name:"claimStatus",isMut:!0,isSigner:!1},{name:"from",isMut:!0,isSigner:!1},{name:"to",isMut:!0,isSigner:!1},{name:"temporal",isMut:!1,isSigner:!0},{name:"payer",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"index",type:"u64"},{name:"amount",type:"u64"},{name:"claimantSecret",type:"publicKey"},{name:"proof",type:{vec:{array:["u8",32]}}}]},{name:"claimCandy",accounts:[{name:"distributor",isMut:!0,isSigner:!1},{name:"distributorWallet",isMut:!0,isSigner:!1},{name:"claimCount",isMut:!0,isSigner:!1},{name:"temporal",isMut:!1,isSigner:!0},{name:"payer",isMut:!1,isSigner:!0},{name:"candyMachineConfig",isMut:!1,isSigner:!1},{name:"candyMachine",isMut:!0,isSigner:!1},{name:"candyMachineWallet",isMut:!0,isSigner:!1},{name:"candyMachineMint",isMut:!0,isSigner:!1},{name:"candyMachineMetadata",isMut:!0,isSigner:!1},{name:"candyMachineMasterEdition",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"tokenMetadataProgram",isMut:!1,isSigner:!1},{name:"candyMachineProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1}],args:[{name:"walletBump",type:"u8"},{name:"claimBump",type:"u8"},{name:"index",type:"u64"},{name:"amount",type:"u64"},{name:"claimantSecret",type:"publicKey"},{name:"proof",type:{vec:{array:["u8",32]}}}]}],accounts:[{name:"MerkleDistributor",type:{kind:"struct",fields:[{name:"base",type:"publicKey"},{name:"bump",type:"u8"},{name:"root",type:{array:["u8",32]}},{name:"temporal",type:"publicKey"}]}},{name:"ClaimStatus",type:{kind:"struct",fields:[{name:"isClaimed",type:"bool"},{name:"claimant",type:"publicKey"},{name:"claimedAt",type:"i64"},{name:"amount",type:"u64"}]}},{name:"ClaimCount",type:{kind:"struct",fields:[{name:"count",type:"u64"},{name:"claimant",type:"publicKey"}]}},{name:"CandyMachine",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"wallet",type:"publicKey"},{name:"tokenMint",type:{option:"publicKey"}},{name:"config",type:"publicKey"},{name:"data",type:{defined:"CandyMachineData"}},{name:"itemsRedeemed",type:"u64"},{name:"bump",type:"u8"}]}}],types:[{name:"CandyMachineData",type:{kind:"struct",fields:[{name:"uuid",type:"string"},{name:"price",type:"u64"},{name:"itemsAvailable",type:"u64"},{name:"goLiveDate",type:{option:"i64"}}]}}],events:[{name:"ClaimedEvent",fields:[{name:"index",type:"u64",index:!1},{name:"claimant",type:"publicKey",index:!1},{name:"amount",type:"u64",index:!1}]}],errors:[{code:300,name:"InvalidProof",msg:"Invalid Merkle proof."},{code:301,name:"DropAlreadyClaimed",msg:"Drop already claimed."},{code:302,name:"Unauthorized",msg:"Account is not authorized to execute this instruction"},{code:303,name:"OwnerMismatch",msg:"Token account owner did not match intended owner"},{code:304,name:"TemporalMismatch",msg:"Temporal signer did not match distributor"}]};(function(r){var e=z&&z.__createBinding||(Object.create?function(p,w,v,E){E===void 0&&(E=v);var P=Object.getOwnPropertyDescriptor(w,v);(!P||("get"in P?!w.__esModule:P.writable||P.configurable))&&(P={enumerable:!0,get:function(){return w[v]}}),Object.defineProperty(p,E,P)}:function(p,w,v,E){E===void 0&&(E=v),p[E]=w[v]}),t=z&&z.__setModuleDefault||(Object.create?function(p,w){Object.defineProperty(p,"default",{enumerable:!0,value:w})}:function(p,w){p.default=w}),n=z&&z.__importStar||function(p){if(p&&p.__esModule)return p;var w={};if(p!=null)for(var v in p)v!=="default"&&Object.prototype.hasOwnProperty.call(p,v)&&e(w,p,v);return t(w,p),w},i=z&&z.__awaiter||function(p,w,v,E){function P(K){return K instanceof v?K:new v(function(T){T(K)})}return new(v||(v=Promise))(function(K,T){function b(W){try{R(E.next(W))}catch(B){T(B)}}function _(W){try{R(E.throw(W))}catch(B){T(B)}}function R(W){W.done?K(W.value):P(W.value).then(b,_)}R((E=E.apply(p,w||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.claimTokenInstructions=r.getMultipleClaimStatusAccounts=r.getClaimStatusAccount=r.getClaimStatusKey=void 0;const s=ot,o=Ua,a=n(me),c=Wt,l=Kl,u=new s.web3.PublicKey("gdrpGjVffourzkdDRrQmySw4aTHr8a3xmQzzxSwFD1a"),d=(p,w,v=u)=>i(void 0,void 0,void 0,function*(){return yield s.web3.PublicKey.findProgramAddress([we.Buffer.from("ClaimStatus"),p.toArrayLike(we.Buffer,"le",8),w.toBuffer()],v)});r.getClaimStatusKey=d;const m=(p,w,v,E=u)=>i(void 0,void 0,void 0,function*(){const P=new s.AnchorProvider(p,null,null),K=new s.Program(l.gumDropIdl,E,P),T=yield(0,r.getClaimStatusKey)(w,v,E);try{return yield K.account.claimStatus.fetch(T[0])}catch{return null}});r.getClaimStatusAccount=m;const y=(p,w,v,E=u)=>i(void 0,void 0,void 0,function*(){const P=new s.AnchorProvider(p,null,null),K=new s.Program(l.gumDropIdl,E,P),T=w.map(R=>(0,r.getClaimStatusKey)(R,v,E)),b=(yield Promise.all(T)).map(R=>R[0]);return yield K.account.claimStatus.fetchMultiple(b)});r.getMultipleClaimStatusAccounts=y;const S=p=>i(void 0,void 0,void 0,function*(){const{connection:w,claimUrl:v,playerPublicKey:E,programId:P}=p,K=new URLSearchParams(v.split("?")[1]),T=K.get("distributor"),b=K.get("handle"),_=K.get("amount"),R=K.get("index"),W=K.get("proof"),B=K.get("tokenAcc");if(!T||!b||!_||!R||!W||!B)throw new Error("Invalid claim");const V=W===""?[]:W.split(",").map(Ar=>{const gn=we.Buffer.from(a.decode(Ar));if(gn.length!==32)throw new Error("Invalid proof hash length");return gn}),q=new s.web3.PublicKey(T),I=new s.web3.PublicKey(B),D=yield w.getAccountInfo(I);if(D===null)throw new Error("Could not fetch distributor token account");const G=o.AccountLayout.decode(D.data),Ie=new s.web3.PublicKey(G.mint),ue=new s.web3.PublicKey(b),Pe=yield(0,c.getAssociatedTokenAddress)(ue,Ie),Gt=yield w.getParsedTokenAccountsByOwner(ue,{mint:Ie}),yn=new s.BN(R),ke=new s.BN(_),[Ke,Zt]=yield(0,r.getClaimStatusKey)(yn,q,P),cn=new s.AnchorProvider(w,null,null),Ht=new s.Program(l.gumDropIdl,P,cn),wt=[];return Gt.value.length===0&&wt.push(o.Token.createAssociatedTokenAccountInstruction(o.ASSOCIATED_TOKEN_PROGRAM_ID,o.TOKEN_PROGRAM_ID,Ie,Pe,ue,E)),wt.push(Ht.instruction.claim(Zt,yn,ke,E,V,{accounts:{distributor:q,claimStatus:Ke,from:I,to:Pe,temporal:E,payer:E,tokenProgram:o.TOKEN_PROGRAM_ID,systemProgram:s.web3.SystemProgram.programId}})),wt});r.claimTokenInstructions=S})(Yw);var le={},Nl={};Object.defineProperty(Nl,"__esModule",{value:!0});Nl.baseIdl=void 0;Nl.baseIdl={version:"0.0.0",name:"score",instructions:[{name:"processInitialize",accounts:[{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"scoreVarsAccount",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"treasuryTokenAccount",isMut:!0,isSigner:!1},{name:"treasuryAuthorityAccount",isMut:!1,isSigner:!1},{name:"atlasMint",isMut:!1,isSigner:!1},{name:"fuelMint",isMut:!1,isSigner:!1},{name:"foodMint",isMut:!1,isSigner:!1},{name:"armsMint",isMut:!1,isSigner:!1},{name:"toolkitMint",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"treasuryBump",type:"u8"},{name:"treasuryAuthBump",type:"u8"}]},{name:"processRegisterShip",accounts:[{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!0,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"scorevarsShipBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"rewardRatePerSecond",type:"u64"},{name:"fuelMaxReserve",type:"u32"},{name:"foodMaxReserve",type:"u32"},{name:"armsMaxReserve",type:"u32"},{name:"toolkitMaxReserve",type:"u32"},{name:"millisecondsToBurnOneFuel",type:"u32"},{name:"millisecondsToBurnOneFood",type:"u32"},{name:"millisecondsToBurnOneArms",type:"u32"},{name:"millisecondsToBurnOneToolkit",type:"u32"}]},{name:"processDeregisterShip",accounts:[{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!0,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"}]},{name:"processUpdateRewardRate",accounts:[{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!0,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"newRewardRatePerSecond",type:"u64"}]},{name:"processInitialDeposit",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"playerFactionAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"shipTokenAccountSource",isMut:!0,isSigner:!1},{name:"shipTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"shipQuantity",type:"u64"}]},{name:"processPartialDeposit",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"shipTokenAccountSource",isMut:!0,isSigner:!1},{name:"shipTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"shipQuantity",type:"u64"}]},{name:"processRefuel",accounts:[{name:"tokenOwnerAccount",isMut:!1,isSigner:!0},{name:"playerAccount",isMut:!1,isSigner:!1},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"fuelMint",isMut:!1,isSigner:!1},{name:"fuelTokenAccountSource",isMut:!0,isSigner:!1},{name:"fuelTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"fuelQuantity",type:"u64"}]},{name:"processRefeed",accounts:[{name:"tokenOwnerAccount",isMut:!1,isSigner:!0},{name:"playerAccount",isMut:!1,isSigner:!1},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"foodMint",isMut:!1,isSigner:!1},{name:"foodTokenAccountSource",isMut:!0,isSigner:!1},{name:"foodTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"foodQuantity",type:"u64"}]},{name:"processRearm",accounts:[{name:"tokenOwnerAccount",isMut:!1,isSigner:!0},{name:"playerAccount",isMut:!1,isSigner:!1},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"armsMint",isMut:!1,isSigner:!1},{name:"armsTokenAccountSource",isMut:!0,isSigner:!1},{name:"armsTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"armsQuantity",type:"u64"}]},{name:"processRepair",accounts:[{name:"tokenOwnerAccount",isMut:!1,isSigner:!0},{name:"playerAccount",isMut:!1,isSigner:!1},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"toolkitMint",isMut:!0,isSigner:!1},{name:"toolkitTokenAccountSource",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"toolkitQuantity",type:"u64"}]},{name:"processSettle",accounts:[{name:"playerAccount",isMut:!1,isSigner:!1},{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"}]},{name:"processHarvest",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"playerAtlasTokenAccount",isMut:!0,isSigner:!1},{name:"treasuryTokenAccount",isMut:!0,isSigner:!1},{name:"treasuryAuthorityAccount",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"treasuryBump",type:"u8"},{name:"treasuryAuthBump",type:"u8"}]},{name:"processWithdrawFuel",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"fuelTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"fuelTokenAccountReturn",isMut:!0,isSigner:!1},{name:"fuelMint",isMut:!0,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"}]},{name:"processWithdrawFood",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"foodTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"foodTokenAccountReturn",isMut:!0,isSigner:!1},{name:"foodMint",isMut:!0,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"}]},{name:"processWithdrawArms",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"armsTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"armsTokenAccountReturn",isMut:!0,isSigner:!1},{name:"armsMint",isMut:!0,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"}]},{name:"processWithdrawShips",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"playerAtlasTokenAccount",isMut:!0,isSigner:!1},{name:"shipTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"shipTokenAccountReturn",isMut:!0,isSigner:!1},{name:"toolkitTokenAccountSource",isMut:!0,isSigner:!1},{name:"treasuryTokenAccount",isMut:!0,isSigner:!1},{name:"treasuryAuthorityAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"toolkitMint",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"treasuryAuthBump",type:"u8"},{name:"treasuryBump",type:"u8"}]},{name:"processCloseAccounts",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"shipTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"fuelTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"foodTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"armsTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"fuelMint",isMut:!1,isSigner:!1},{name:"foodMint",isMut:!1,isSigner:!1},{name:"armsMint",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"shipBump",type:"u8"},{name:"fuelBump",type:"u8"},{name:"foodBump",type:"u8"},{name:"armsBump",type:"u8"},{name:"escrowAuthBump",type:"u8"}]}],accounts:[{name:"ScoreVars",type:{kind:"struct",fields:[{name:"updateAuthorityMaster",type:"publicKey"},{name:"fuelMint",type:"publicKey"},{name:"foodMint",type:"publicKey"},{name:"armsMint",type:"publicKey"},{name:"toolkitMint",type:"publicKey"}]}},{name:"ScoreVarsShip",type:{kind:"struct",fields:[{name:"shipMint",type:"publicKey"},{name:"rewardRatePerSecond",type:"u64"},{name:"fuelMaxReserve",type:"u32"},{name:"foodMaxReserve",type:"u32"},{name:"armsMaxReserve",type:"u32"},{name:"toolkitMaxReserve",type:"u32"},{name:"millisecondsToBurnOneFuel",type:"u32"},{name:"millisecondsToBurnOneFood",type:"u32"},{name:"millisecondsToBurnOneArms",type:"u32"},{name:"millisecondsToBurnOneToolkit",type:"u32"}]}},{name:"ShipStaking",type:{kind:"struct",fields:[{name:"owner",type:"publicKey"},{name:"factionId",type:"u8"},{name:"shipMint",type:"publicKey"},{name:"shipQuantityInEscrow",type:"u64"},{name:"fuelQuantityInEscrow",type:"u64"},{name:"foodQuantityInEscrow",type:"u64"},{name:"armsQuantityInEscrow",type:"u64"},{name:"fuelCurrentCapacity",type:"u64"},{name:"foodCurrentCapacity",type:"u64"},{name:"armsCurrentCapacity",type:"u64"},{name:"healthCurrentCapacity",type:"u64"},{name:"stakedAtTimestamp",type:"i64"},{name:"fueledAtTimestamp",type:"i64"},{name:"fedAtTimestamp",type:"i64"},{name:"armedAtTimestamp",type:"i64"},{name:"repairedAtTimestamp",type:"i64"},{name:"currentCapacityTimestamp",type:"i64"},{name:"totalTimeStaked",type:"u64"},{name:"stakedTimePaid",type:"u64"},{name:"pendingRewards",type:"u64"},{name:"totalRewardsPaid",type:"u64"}]}}],types:[{name:"Resource",type:{kind:"enum",variants:[{name:"Arms"},{name:"Fuel"},{name:"Food"},{name:"Toolkits"}]}}],errors:[{code:300,name:"ScorevarsNotInitialized",msg:"Scorevars auth is not initialized"},{code:301,name:"ScorevarsAuthInvalid",msg:"Scorevars auth invalid"},{code:302,name:"FactionTypeError",msg:"Faction ID must be 0, 1, or 2."},{code:303,name:"InvalidShipError",msg:"Invalid Ship Mint"},{code:304,name:"InvalidResourceError",msg:"Invalid Resource Mint"},{code:305,name:"ZeroResourceError",msg:"Resource Quantity must be >0."},{code:306,name:"ZeroShipError",msg:"Ship Quantity must be >0."},{code:307,name:"NumericalOverflowError",msg:"Numerical overflow error"},{code:308,name:"ResourceAmountTooSmall",msg:"Resource Amount Too Small, would add 0 seconds to capacity"},{code:309,name:"InvalidScoreVarsAccount",msg:"Invalid ScoreVars account for ship Staking Account given"},{code:310,name:"InvalidResourceWithdraw",msg:"Invalid Resource Withdraw, nothing to withdraw"},{code:311,name:"InvalidShipStakingOwner",msg:"Invalid Ship Staking Owner"},{code:312,name:"InvalidShipWithdraw",msg:"Invalid Ship Withdraw"},{code:313,name:"NotEnoughToolkits",msg:"Not enough toolkits for Ship Withdraw"},{code:314,name:"EscrowAccountNotZero",msg:"Escrow account must be 0 to close accounts"},{code:315,name:"IncorrectTokenAccountOwner",msg:"Token account does not have correct owner!"},{code:316,name:"UninitializedTokenAccount",msg:"Token or Mint Account is not initialized!"},{code:317,name:"IncorrectTokenAccountMint",msg:"Token or Mint Account mint is not correct!"}],metadata:{}};var $l={};Object.defineProperty($l,"__esModule",{value:!0});$l.scoreLogBaseIdl=void 0;$l.scoreLogBaseIdl={version:"0.0.0",name:"score_logs",instructions:[],events:[{name:"ProcessInitialDepositMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"factionId",type:"u8",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"stakedAtTimestamp",type:"i64",index:!1}]},{name:"ProcessPartialDepositMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"previousShipQuantity",type:"u64",index:!1},{name:"addedShipQuantity",type:"u64",index:!1},{name:"newShipQuantity",type:"u64",index:!1},{name:"partialDepositTimestamp",type:"i64",index:!1}]},{name:"ProcessRearmMemo",fields:[{name:"tokenOwnerAccount",type:"publicKey",index:!1},{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"armsQuantityToDeposit",type:"u64",index:!1},{name:"armedAtTimestamp",type:"i64",index:!1}]},{name:"ProcessRefeedMemo",fields:[{name:"tokenOwnerAccount",type:"publicKey",index:!1},{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"foodQuantityToDeposit",type:"u64",index:!1},{name:"fedAtTimestamp",type:"i64",index:!1}]},{name:"ProcessRefuelMemo",fields:[{name:"tokenOwnerAccount",type:"publicKey",index:!1},{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"fuelQuantityToDeposit",type:"u64",index:!1},{name:"fueledAtTimestamp",type:"i64",index:!1}]},{name:"ProcessRepairMemo",fields:[{name:"tokenOwnerAccount",type:"publicKey",index:!1},{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"toolkitQuantityToDeposit",type:"u64",index:!1},{name:"repairedAtTimestamp",type:"i64",index:!1}]},{name:"ProcessHarvestMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"stakedTimePaid",type:"u64",index:!1},{name:"rewardPayout",type:"u64",index:!1},{name:"totalRewardsPaid",type:"u64",index:!1},{name:"harvestTimestamp",type:"i64",index:!1}]},{name:"ProcessSettleMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"stakedTimePaid",type:"u64",index:!1},{name:"totalRewardsPaid",type:"u64",index:!1},{name:"settleTimestamp",type:"i64",index:!1}]},{name:"ProcessArmsWithdrawMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"armsQuantityWithdrawn",type:"u64",index:!1},{name:"armsWithdrawTimestamp",type:"i64",index:!1}]},{name:"ProcessFoodWithdrawMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"foodQuantityWithdrawn",type:"u64",index:!1},{name:"foodWithdrawTimestamp",type:"i64",index:!1}]},{name:"ProcessFuelWithdrawMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"fuelQuantityWithdrawn",type:"u64",index:!1},{name:"fuelWithdrawTimestamp",type:"i64",index:!1}]},{name:"ProcessWithdrawShipsMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"stakedTimePaid",type:"u64",index:!1},{name:"totalRewardsPaid",type:"u64",index:!1},{name:"shipsWithdrawTimestamp",type:"i64",index:!1}]},{name:"ProcessCloseAccountMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"accountClosedTimestamp",type:"i64",index:!1}]}]};var Je=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(le,"__esModule",{value:!0});le.closeAccountsInstruction=le.createWithdrawShipsInstruction=le.createWithdrawArmsInstruction=le.createWithdrawFoodInstruction=le.createWithdrawFuelInstruction=le.createHarvestInstruction=le.createSettleInstruction=le.createRepairInstruction=le.createRefuelInstruction=le.createRefeedInstruction=le.createRearmInstruction=le.createPartialDepositInstruction=le.createInitialDepositInstruction=le.createUpdateRewardRateInstruction=le.createDeregisterShipInstruction=le.createRegisterShipInstruction=le.createScoreVarsInitializeInstruction=le.getAllFleetsForUserPublicKey=le.getAllFleets=le.getAllRegisteredShips=le.getScoreTreasuryAuthAccount=le.getScoreTreasuryTokenAccount=le.getScoreVarsShipInfo=le.decodeEvent=le.getShipStakingAccountInfo=le.getScoreVarsInfo=le.getShipStakingAccount=le.getScoreEscrowAuthAccount=le.getScoreEscrowAccount=le.getScoreVarsShipAccount=le.getScoreVarsAccount=le.getScoreIDL=void 0;const Q=ot,Qn=Ua,Jw=ni,OB=zn,BB=Nl,xB=$l,Ji=lr;function bt(r){const e=BB.baseIdl;return e.metadata.address=r.toBase58(),e}le.getScoreIDL=bt;function hn(r){return Je(this,void 0,void 0,function*(){return Q.web3.PublicKey.findProgramAddress([we.Buffer.from("SCOREVARS")],r)})}le.getScoreVarsAccount=hn;function an(r,e){return Je(this,void 0,void 0,function*(){return Q.web3.PublicKey.findProgramAddress([we.Buffer.from("SCOREVARS_SHIP"),e.toBuffer()],r)})}le.getScoreVarsShipAccount=an;function xn(r,e,t,n){return Je(this,void 0,void 0,function*(){const i=[we.Buffer.from("SCORE_ESCROW"),n.toBuffer(),e.toBuffer()];return t!==null&&i.push(t.toBuffer()),Q.web3.PublicKey.findProgramAddress(i,r)})}le.getScoreEscrowAccount=xn;function _r(r,e,t){return Je(this,void 0,void 0,function*(){return Q.web3.PublicKey.findProgramAddress([we.Buffer.from("SCORE_ESCROW_AUTHORITY"),t.toBuffer(),e.toBuffer()],r)})}le.getScoreEscrowAuthAccount=_r;function pn(r,e,t){return Je(this,void 0,void 0,function*(){return Q.web3.PublicKey.findProgramAddress([we.Buffer.from("SCORE_INFO"),t.toBuffer(),e.toBuffer()],r)})}le.getShipStakingAccount=pn;function CB(r,e){return Je(this,void 0,void 0,function*(){const t=new Q.AnchorProvider(r,null,null),n=bt(e),i=new Q.Program(n,e,t),[s]=yield hn(e);return yield i.account.scoreVars.fetch(s)})}le.getScoreVarsInfo=CB;function MB(r,e,t,n){return Je(this,void 0,void 0,function*(){const i=new Q.AnchorProvider(r,null,null),s=bt(e),o=new Q.Program(s,e,i),[a]=yield pn(e,t,n);return yield o.account.shipStaking.fetch(a)})}le.getShipStakingAccountInfo=MB;function LB(r,e,t){return Je(this,void 0,void 0,function*(){const n=new Q.AnchorProvider(r,null,null);return new Q.Program(xB.scoreLogBaseIdl,e,n).coder.events.decode(t)})}le.decodeEvent=LB;function KB(r,e,t){return Je(this,void 0,void 0,function*(){const n=new Q.AnchorProvider(r,null,null),i=bt(e),s=new Q.Program(i,e,n),[o]=yield an(e,t);return yield s.account.scoreVarsShip.fetch(o)})}le.getScoreVarsShipInfo=KB;function Dl(r){return Je(this,void 0,void 0,function*(){return Q.web3.PublicKey.findProgramAddress([we.Buffer.from("SCORE_TREASURY")],r)})}le.getScoreTreasuryTokenAccount=Dl;function zl(r){return Je(this,void 0,void 0,function*(){return Q.web3.PublicKey.findProgramAddress([we.Buffer.from("SCORE_TREASURY_AUTHORITY")],r)})}le.getScoreTreasuryAuthAccount=zl;function NB(r,e){return Je(this,void 0,void 0,function*(){const t=bt(e),n=new Q.AnchorProvider(r,null,null),s=yield new Q.Program(t,e,n).account.scoreVarsShip.all(),o=[];for(const a of s)o.push(a.account);return o})}le.getAllRegisteredShips=NB;function $B(r,e){return Je(this,void 0,void 0,function*(){const t=bt(e),n=new Q.AnchorProvider(r,null,null),s=yield new Q.Program(t,e,n).account.shipStaking.all(),o=[];for(const a of s)o.push(a.account);return o})}le.getAllFleets=$B;function DB(r,e,t){return Je(this,void 0,void 0,function*(){const n=bt(t),i=new Q.AnchorProvider(r,null,null),s=new Q.Program(n,t,i),o=yield s.account.scoreVarsShip.all(),a=[];for(const u of o){const[d]=yield pn(t,u.account.shipMint,e);a.push(d)}return(yield s.account.shipStaking.fetchMultiple(a)).filter(u=>u!==null).map(u=>u)})}le.getAllFleetsForUserPublicKey=DB;function zB(r,e,t,n,i,s,o,a){return Je(this,void 0,void 0,function*(){const c=bt(a),l=new Q.AnchorProvider(r,null,null),u=new Q.Program(c,a,l),[d,m]=yield Dl(a),[y,S]=yield zl(a),[p,w]=yield hn(a);return yield u.instruction.processInitialize(w,m,S,{accounts:{updateAuthorityAccount:e,scoreVarsAccount:p,tokenProgram:Qn.TOKEN_PROGRAM_ID,systemProgram:Jw.SystemProgram.programId,rent:Q.web3.SYSVAR_RENT_PUBKEY,treasuryTokenAccount:d,treasuryAuthorityAccount:y,atlasMint:t,fuelMint:n,foodMint:i,armsMint:s,toolkitMint:o},signers:[]})})}le.createScoreVarsInitializeInstruction=zB;function WB(r,e,t,n,i,s,o,a,c,l,u,d,m){return Je(this,void 0,void 0,function*(){const y=bt(m),S=new Q.AnchorProvider(r,null,null),p=new Q.Program(y,m,S),[w,v]=yield an(m,t),[E,P]=yield hn(m);return yield p.instruction.processRegisterShip(P,v,new Q.BN(d),n,i,s,o,a,c,l,u,{accounts:{updateAuthorityAccount:e,scoreVarsAccount:E,scoreVarsShipAccount:w,shipMint:t,systemProgram:Jw.SystemProgram.programId},signers:[]})})}le.createRegisterShipInstruction=WB;function VB(r,e,t,n){return Je(this,void 0,void 0,function*(){const i=bt(n),s=new Q.AnchorProvider(r,null,null),o=new Q.Program(i,n,s),[a,c]=yield an(n,t),[l,u]=yield hn(n);return yield o.instruction.processDeregisterShip(u,c,{accounts:{updateAuthorityAccount:e,scoreVarsAccount:l,scoreVarsShipAccount:a,shipMint:t},signers:[]})})}le.createDeregisterShipInstruction=VB;function UB(r,e,t,n,i){return Je(this,void 0,void 0,function*(){const s=bt(i),o=new Q.AnchorProvider(r,null,null),a=new Q.Program(s,i,o),[c,l]=yield an(i,t),[u,d]=yield hn(i);return yield a.instruction.processUpdateRewardRate(d,l,new Q.BN(n),{accounts:{updateAuthorityAccount:e,scoreVarsAccount:u,scoreVarsShipAccount:c,shipMint:t},signers:[]})})}le.createUpdateRewardRateInstruction=UB;function FB(r,e,t,n,i,s,o=new Q.web3.PublicKey("FACTNmq2FhA2QNTnGM2aWJH3i7zT3cND5CgvjYTjyVYe")){return Je(this,void 0,void 0,function*(){const[a,c]=yield _r(s,n,e),[l,u]=yield xn(s,n,null,e),[d,m]=yield pn(s,n,e),[y,S]=yield an(s,n),[p]=yield(0,OB.getPlayerFactionPDA)(e,o),w=bt(s),v=new Q.AnchorProvider(r,null,null);return yield new Q.Program(w,s,v).instruction.processInitialDeposit(m,S,c,u,new Q.BN(t),{accounts:{playerAccount:e,shipStakingAccount:d,scoreVarsShipAccount:y,playerFactionAccount:p,escrowAuthority:a,systemProgram:Q.web3.SystemProgram.programId,tokenProgram:Qn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,rent:Q.web3.SYSVAR_RENT_PUBKEY,shipMint:n,shipTokenAccountSource:i,shipTokenAccountEscrow:l}})})}le.createInitialDepositInstruction=FB;function jB(r,e,t,n,i,s){return Je(this,void 0,void 0,function*(){const[o,a]=yield _r(s,n,e),[c,l]=yield xn(s,n,null,e),[u,d]=yield pn(s,n,e),[m,y]=yield an(s,n),S=bt(s),p=new Q.AnchorProvider(r,null,null);return yield new Q.Program(S,s,p).instruction.processPartialDeposit(d,y,a,l,new Q.BN(t),{accounts:{playerAccount:e,shipStakingAccount:u,scoreVarsShipAccount:m,escrowAuthority:o,systemProgram:Q.web3.SystemProgram.programId,tokenProgram:Qn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n,shipTokenAccountSource:i,shipTokenAccountEscrow:c}})})}le.createPartialDepositInstruction=jB;function qB(r,e,t,n,i,s,o,a){return Je(this,void 0,void 0,function*(){const[c,l]=yield _r(a,i,t),[u,d]=yield xn(a,i,s,t),[m,y]=yield pn(a,i,t),[S,p]=yield an(a,i),[w,v]=yield hn(a),E=bt(a),P=new Q.AnchorProvider(r,null,null);return yield new Q.Program(E,a,P).instruction.processRearm(y,v,p,l,d,new Q.BN(n),{accounts:{tokenOwnerAccount:e,playerAccount:t,shipStakingAccount:m,scoreVarsAccount:w,scoreVarsShipAccount:S,escrowAuthority:c,systemProgram:Q.web3.SystemProgram.programId,tokenProgram:Qn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,rent:Q.web3.SYSVAR_RENT_PUBKEY,shipMint:i,armsMint:s,armsTokenAccountSource:o,armsTokenAccountEscrow:u}})})}le.createRearmInstruction=qB;function GB(r,e,t,n,i,s,o,a){return Je(this,void 0,void 0,function*(){const[c,l]=yield _r(a,i,t),[u,d]=yield xn(a,i,s,t),[m,y]=yield pn(a,i,t),[S,p]=yield an(a,i),[w,v]=yield hn(a),E=bt(a),P=new Q.AnchorProvider(r,null,null);return yield new Q.Program(E,a,P).instruction.processRefeed(y,v,p,l,d,new Q.BN(n),{accounts:{tokenOwnerAccount:e,playerAccount:t,shipStakingAccount:m,scoreVarsAccount:w,scoreVarsShipAccount:S,escrowAuthority:c,systemProgram:Q.web3.SystemProgram.programId,tokenProgram:Qn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,rent:Q.web3.SYSVAR_RENT_PUBKEY,shipMint:i,foodMint:s,foodTokenAccountSource:o,foodTokenAccountEscrow:u}})})}le.createRefeedInstruction=GB;function HB(r,e,t,n,i,s,o,a){return Je(this,void 0,void 0,function*(){const[c,l]=yield _r(a,i,t),[u,d]=yield xn(a,i,s,t),[m,y]=yield pn(a,i,t),[S,p]=yield an(a,i),[w,v]=yield hn(a),E=bt(a),P=new Q.AnchorProvider(r,null,null);return yield new Q.Program(E,a,P).instruction.processRefuel(y,v,p,l,d,new Q.BN(n),{accounts:{tokenOwnerAccount:e,playerAccount:t,shipStakingAccount:m,scoreVarsAccount:w,scoreVarsShipAccount:S,escrowAuthority:c,systemProgram:Q.web3.SystemProgram.programId,tokenProgram:Qn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,rent:Q.web3.SYSVAR_RENT_PUBKEY,shipMint:i,fuelMint:s,fuelTokenAccountSource:o,fuelTokenAccountEscrow:u}})})}le.createRefuelInstruction=HB;function YB(r,e,t,n,i,s,o,a){return Je(this,void 0,void 0,function*(){const[c,l]=yield pn(a,i,t),[u,d]=yield an(a,i),[m,y]=yield hn(a),S=bt(a),p=new Q.AnchorProvider(r,null,null);return yield new Q.Program(S,a,p).instruction.processRepair(l,y,d,new Q.BN(n),{accounts:{tokenOwnerAccount:e,playerAccount:t,shipStakingAccount:c,scoreVarsAccount:m,scoreVarsShipAccount:u,systemProgram:Q.web3.SystemProgram.programId,tokenProgram:Qn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,rent:Q.web3.SYSVAR_RENT_PUBKEY,shipMint:i,toolkitMint:s,toolkitTokenAccountSource:o}})})}le.createRepairInstruction=YB;function JB(r,e,t,n,i){return Je(this,void 0,void 0,function*(){const[s,o]=yield pn(i,n,e),[a,c]=yield an(i,n),[l,u]=yield hn(i),d=bt(i),m=new Q.AnchorProvider(r,null,null);return yield new Q.Program(d,i,m).instruction.processSettle(o,u,c,{accounts:{playerAccount:e,updateAuthorityAccount:t,shipStakingAccount:s,scoreVarsShipAccount:a,scoreVarsAccount:l,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}})})}le.createSettleInstruction=JB;function QB(r,e,t,n,i){return Je(this,void 0,void 0,function*(){const[s,o]=yield pn(i,n,e),[a,c]=yield an(i,n),[l,u]=yield Dl(i),[d,m]=yield zl(i),y=bt(i),S=new Q.AnchorProvider(r,null,null),p=new Q.Program(y,i,S),w={signers:[],instructions:[]};let v;const E=yield(0,Ji.getTokenAccount)(r,e,t),P=E.tokenAccount;"createInstruction"in E&&w.instructions.push(...E.createInstruction),P instanceof Q.web3.Keypair?(v=P.publicKey,w.signers.push(P)):v=P;const K=yield p.instruction.processHarvest(o,c,u,m,{accounts:{playerAccount:e,shipStakingAccount:s,scoreVarsShipAccount:a,playerAtlasTokenAccount:v,treasuryTokenAccount:l,treasuryAuthorityAccount:d,tokenProgram:Qn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}});return w.instructions.push(K),w})}le.createHarvestInstruction=QB;function XB(r,e,t,n,i){return Je(this,void 0,void 0,function*(){const[s,o]=yield _r(i,n,e),[a,c]=yield xn(i,n,t,e),[l,u]=yield pn(i,n,e),[d,m]=yield an(i,n),[y,S]=yield hn(i),p=bt(i),w=new Q.AnchorProvider(r,null,null),v=new Q.Program(p,i,w),E={signers:[],instructions:[]};let P;const K=yield(0,Ji.getTokenAccount)(r,e,t),T=K.tokenAccount;"createInstruction"in K&&E.instructions.push(...K.createInstruction),T instanceof Q.web3.Keypair?(P=T.publicKey,E.signers.push(T)):P=T;const b=yield v.instruction.processWithdrawFuel(u,S,m,o,c,{accounts:{playerAccount:e,shipStakingAccount:l,scoreVarsAccount:y,scoreVarsShipAccount:d,fuelTokenAccountEscrow:a,fuelTokenAccountReturn:P,fuelMint:t,escrowAuthority:s,tokenProgram:Qn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}});return E.instructions.push(b),E})}le.createWithdrawFuelInstruction=XB;function ZB(r,e,t,n,i){return Je(this,void 0,void 0,function*(){const[s,o]=yield _r(i,n,e),[a,c]=yield xn(i,n,t,e),[l,u]=yield pn(i,n,e),[d,m]=yield an(i,n),[y,S]=yield hn(i),p=bt(i),w=new Q.AnchorProvider(r,null,null),v=new Q.Program(p,i,w),E={signers:[],instructions:[]};let P;const K=yield(0,Ji.getTokenAccount)(r,e,t),T=K.tokenAccount;"createInstruction"in K&&E.instructions.push(...K.createInstruction),T instanceof Q.web3.Keypair?(P=T.publicKey,E.signers.push(T)):P=T;const b=yield v.instruction.processWithdrawFood(u,S,m,o,c,{accounts:{playerAccount:e,shipStakingAccount:l,scoreVarsAccount:y,scoreVarsShipAccount:d,foodTokenAccountEscrow:a,foodTokenAccountReturn:P,foodMint:t,escrowAuthority:s,tokenProgram:Qn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}});return E.instructions.push(b),E})}le.createWithdrawFoodInstruction=ZB;function ex(r,e,t,n,i){return Je(this,void 0,void 0,function*(){const[s,o]=yield _r(i,n,e),[a,c]=yield xn(i,n,t,e),[l,u]=yield pn(i,n,e),[d,m]=yield an(i,n),[y,S]=yield hn(i),p=bt(i),w=new Q.AnchorProvider(r,null,null),v=new Q.Program(p,i,w),E={signers:[],instructions:[]};let P;const K=yield(0,Ji.getTokenAccount)(r,e,t),T=K.tokenAccount;"createInstruction"in K&&E.instructions.push(...K.createInstruction),T instanceof Q.web3.Keypair?(P=T.publicKey,E.signers.push(T)):P=T;const b=yield v.instruction.processWithdrawArms(u,S,m,o,c,{accounts:{playerAccount:e,shipStakingAccount:l,scoreVarsAccount:y,scoreVarsShipAccount:d,armsTokenAccountEscrow:a,armsTokenAccountReturn:P,armsMint:t,escrowAuthority:s,tokenProgram:Qn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}});return E.instructions.push(b),E})}le.createWithdrawArmsInstruction=ex;function tx(r,e,t,n,i,s){return Je(this,void 0,void 0,function*(){const[o,a]=yield _r(s,t,e),[c,l]=yield xn(s,t,null,e),[u,d]=yield pn(s,t,e),[m,y]=yield an(s,t),[S,p]=yield hn(s),[w,v]=yield Dl(s),[E,P]=yield zl(s),K={signers:[],instructions:[]},T=bt(s),b=new Q.AnchorProvider(r,null,null),_=new Q.Program(T,s,b);let R;const W=yield(0,Ji.getTokenAccount)(r,e,n),B=W.tokenAccount;"createInstruction"in W&&K.instructions.push(...W.createInstruction),B instanceof Q.web3.Keypair?(R=B.publicKey,K.signers.push(B)):R=B;let V;const q=yield(0,Ji.getTokenAccount)(r,e,t),I=q.tokenAccount;"createInstruction"in q&&K.instructions.push(...q.createInstruction),I instanceof Q.web3.Keypair?(V=I.publicKey,K.signers.push(I)):V=I;let D;const G=yield(0,Ji.getTokenAccount)(r,e,i),Ie=G.tokenAccount;"createInstruction"in G&&K.instructions.push(...G.createInstruction),Ie instanceof Q.web3.Keypair?(D=Ie.publicKey,K.signers.push(Ie)):D=Ie;const ue=yield _.instruction.processWithdrawShips(d,p,y,a,l,P,v,{accounts:{playerAccount:e,shipStakingAccount:u,scoreVarsAccount:S,scoreVarsShipAccount:m,playerAtlasTokenAccount:R,shipTokenAccountEscrow:c,shipTokenAccountReturn:V,toolkitTokenAccountSource:D,treasuryTokenAccount:w,treasuryAuthorityAccount:E,escrowAuthority:o,tokenProgram:Qn.TOKEN_PROGRAM_ID,systemProgram:Q.web3.SystemProgram.programId,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:t,toolkitMint:i}});return K.instructions.push(ue),K})}le.createWithdrawShipsInstruction=tx;function nx(r,e,t,n,i,s,o){return Je(this,void 0,void 0,function*(){const[a,c]=yield _r(o,t,e),[l,u]=yield xn(o,t,null,e),[d,m]=yield xn(o,t,n,e),[y,S]=yield xn(o,t,i,e),[p,w]=yield xn(o,t,s,e),[v,E]=yield hn(o),[P,K]=yield pn(o,t,e),T=bt(o),b=new Q.AnchorProvider(r,null,null);return yield new Q.Program(T,o,b).instruction.processCloseAccounts(K,E,u,m,S,w,c,{accounts:{playerAccount:e,shipStakingAccount:P,scoreVarsAccount:v,shipTokenAccountEscrow:l,fuelTokenAccountEscrow:d,foodTokenAccountEscrow:y,armsTokenAccountEscrow:p,escrowAuthority:a,tokenProgram:Qn.TOKEN_PROGRAM_ID,systemProgram:Q.web3.SystemProgram.programId,shipMint:t,fuelMint:n,foodMint:i,armsMint:s,clock:Q.web3.SYSVAR_CLOCK_PUBKEY}})})}le.closeAccountsInstruction=nx;var Qw={};Object.defineProperty(Qw,"__esModule",{value:!0});var Mt={},Mi=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(d){o(d)}}function c(u){try{l(n.throw(u))}catch(d){o(d)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})},rx=z&&z.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Mt,"__esModule",{value:!0});Mt.sendTokens=Mt.confirmTokenBalance=Mt.createMint=Mt.mintTokens=Mt.createAssociatedTokenAccountInstruction=Mt.createRequestUnitsInstruction=Mt.Numberu32=Mt.createATokenAccount=Mt.getAtaForMint=void 0;const cr=ot,Fn=Ua,ix=lr,Iy=zc.exports,Ey=rx(My.exports);function Xw(r,e){return Mi(this,void 0,void 0,function*(){return cr.web3.PublicKey.findProgramAddress([e.toBuffer(),Fn.TOKEN_PROGRAM_ID.toBuffer(),r.toBuffer()],Fn.ASSOCIATED_TOKEN_PROGRAM_ID)})}Mt.getAtaForMint=Xw;function sx(r,e,t,n){return Mi(this,void 0,void 0,function*(){t=t||r.wallet.publicKey,n=n||r.wallet.publicKey;const[i]=yield Xw(e,n),s=new cr.web3.Transaction,o=yield ek(i,t,n,e);return s.add(o),yield r.sendAndConfirm(s),i})}Mt.createATokenAccount=sx;class Zw extends Ey.default{toBuffer(){const e=super.toArray().reverse(),t=we.Buffer.from(e);if(t.length===4)return t;const n=we.Buffer.alloc(4);return t.copy(n),n}static fromBuffer(e){return new Ey.default([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}Mt.Numberu32=Zw;function ox(r){return Mi(this,void 0,void 0,function*(){const e=new Zw(1e6),t=we.Buffer.from([0]),n=e.toBuffer();return new cr.web3.TransactionInstruction({keys:[{pubkey:r,isSigner:!0,isWritable:!0}],programId:new cr.web3.PublicKey("ComputeBudget111111111111111111111111111111"),data:we.Buffer.concat([t,n])})})}Mt.createRequestUnitsInstruction=ox;function ek(r,e,t,n){return Mi(this,void 0,void 0,function*(){const i=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:cr.web3.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:Fn.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:cr.web3.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return new cr.web3.TransactionInstruction({keys:i,programId:Fn.ASSOCIATED_TOKEN_PROGRAM_ID,data:we.Buffer.from([])})})}Mt.createAssociatedTokenAccountInstruction=ek;function ax(r,e,t,n,i){return Mi(this,void 0,void 0,function*(){const s=new cr.web3.Transaction;return i=i||r.wallet.publicKey,s.add(Fn.Token.createMintToInstruction(Fn.TOKEN_PROGRAM_ID,e,t,i,[],n)),yield r.sendAndConfirm(s)})}Mt.mintTokens=ax;function cx(r,e,t,n){return Mi(this,void 0,void 0,function*(){const i=cr.web3.Keypair.generate(),s=new cr.web3.Transaction,o=yield r.connection.getMinimumBalanceForRentExemption(Fn.MintLayout.span);t=t||r.wallet.publicKey,n=n||r.wallet.publicKey;const a=cr.web3.SystemProgram.createAccount({fromPubkey:r.wallet.publicKey,newAccountPubkey:i.publicKey,lamports:o,space:Fn.MintLayout.span,programId:Fn.TOKEN_PROGRAM_ID});s.add(a);const c=Fn.Token.createInitMintInstruction(Fn.TOKEN_PROGRAM_ID,i.publicKey,e,t,n);return s.add(c),yield r.sendAndConfirm(s,[i]),i.publicKey})}Mt.createMint=cx;function ux(r,e,t,n){return Mi(this,void 0,void 0,function*(){const i=yield r.connection.getAccountInfo(e,"recent");if(n===!0&&(0,Iy.strict)(i===null),i!==null){const s=(0,ix.byteArrayToLong)(i.data.slice(64,72));(0,Iy.strict)(s==t,`On-chain Token amount of ${s} does not match expected amount ${t}`)}else console.log("Token account %s does not exist",e.toString())})}Mt.confirmTokenBalance=ux;function lx(r,e,t,n){return Mi(this,void 0,void 0,function*(){const i=new cr.web3.Transaction;return i.add(Fn.Token.createTransferInstruction(Fn.TOKEN_PROGRAM_ID,e,t,r.wallet.publicKey,[],n)),yield r.sendAndConfirm(i)})}Mt.sendTokens=lx;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Iu,r),t(Hw,r),t(Yw,r),t(ph,r),t(le,r),t(Qw,r),t(Mt,r),t(rs,r),t(lr,r)})(zn);const $i=new An("ATLASXmbPQxBUYbxPsV97usA3fPQYEqzQBUHgiFCUsXx"),tk=8,Gi=new An("poLisWXnNRwC6oBu1vHiuKQzFjGL4XDSu4g9qjz9qVk"),dx=new An("ATLkZsBofSKG845dNFpNoUyMciGpeH29BCbMqYFUoxzU"),fr=new An("ATLocKpzDbTokxgvnLew3d7drZkEzLzDpzwgrgWKDbmc");async function ui(){return await zn.getRegisteredStake(fr,dx,$i,Gi)}async function fx(r){return await zn.getStakingAccount((r=="ATLAS",fr),rt(),(await ui())[0])}function Us(r,e){const[t,n]=ds.findProgramAddressSync([r.toBuffer(),_o.toBuffer(),e.toBuffer()],wk.ASSOCIATED_PROGRAM_ID);return t}const Ki="AtlasLocker",gt=Ny("atlasLockerStore",{state:()=>({balanceWallet:"0",balanceSquads:"0",balanceLocker:"0",registeredStakeAtlasAddress:{},registeredStakeAtlasAddressInfo:{},stakingAccountAtlasAddress:{},stakingAccountAtlasInfo:{}}),getters:{},actions:{async createStakingAccount(){try{const r=new nr;return(await zn.createStakingAccountInstruction({connection:mn().connection,user:rt(),registeredStake:(await ui())[0],programId:fr})).instructions.forEach(e=>r.add(e)),console.log(`[${Ki}] createStakingAccount!`),r}catch(r){console.error(r),rr.create({message:r.message,type:"negative",position:"bottom-right"})}},async stakeTokens(r){try{const e=new nr;return(await zn.stakeTokensInstruction({connection:mn().connection,user:rt(),stakeMint:$i,tokenSource:Us(rt(),$i),stakingAccount:this.stakingAccountAtlasAddress,stakeQuantity:Ad(r,tk),registeredStake:(await ui())[0],programId:fr})).instructions.forEach(t=>e.add(t)),console.log(`[${Ki}] stakeTokens!`),e}catch(e){console.error(e),rr.create({message:e.message,type:"negative",position:"bottom-right"})}},async claimTokens(){try{const r=new nr;return(await zn.harvestRewardsInstruction({connection:mn().connection,user:rt(),rewardMint:Gi,registeredStake:(await ui())[0],stakingAccount:this.stakingAccountAtlasAddress,programId:fr})).instructions.forEach(e=>r.add(e)),console.log(`[${Ki}] claimTokens!`),r}catch(r){console.error(r),rr.create({message:r.message,type:"negative",position:"bottom-right"})}},async unstakeTokens(){try{const r=new nr;return(await zn.unstakeTokensInstruction({connection:mn().connection,user:rt(),registeredStake:(await ui())[0],stakingAccount:this.stakingAccountAtlasAddress,programId:fr})).instructions.forEach(e=>r.add(e)),console.log(`[${Ki}] claimTokens!`),r}catch(r){console.error(r),rr.create({message:r.message,type:"negative",position:"bottom-right"})}},async cancelUnstake(){try{const r=new nr;return(await zn.cancelUnstakeInstruction({connection:mn().connection,user:rt(),registeredStake:(await ui())[0],programId:fr})).instructions.forEach(e=>r.add(e)),console.log(`[${Ki}] cancelUnstake!`),r}catch(r){console.error(r),rr.create({message:r.message,type:"negative",position:"bottom-right"})}},async withdrawTokens(){try{const r=new nr;return(await zn.withdrawTokensInstruction({connection:mn().connection,user:rt(),authority:rt(),stakeMint:$i,registeredStake:(await ui())[0],stakingAccount:this.stakingAccountAtlasAddress,programId:fr})).instructions.forEach(e=>r.add(e)),console.log(`[${Ki}] withdrawTokens!`),r}catch(r){console.error(r),rr.create({message:r.message,type:"negative",position:"bottom-right"})}},async updateStore(){if(Gn()){this.stakingAccountAtlasInfo=void 0;try{this.registeredStakeAtlasAddress=(await ui())[0],this.stakingAccountAtlasAddress=(await fx("ATLAS"))[0],this.registeredStakeAtlasAddressInfo=await zn.getRegisteredStakeAccountInfo(mn().connection,this.registeredStakeAtlasAddress,fr),this.stakingAccountAtlasInfo=await zn.getStakingAccountInfo(mn().connection,this.stakingAccountAtlasAddress,fr)}catch{}try{this.balanceWallet=(await mn().connection.getTokenAccountBalance(Us(pf().publicKey.value,$i))).value.uiAmountString??"0"}catch{this.balanceWallet="-"}try{this.balanceSquads=(await mn().connection.getTokenAccountBalance(Us(new An($y().vaultPDA.toString()),$i))).value.uiAmountString??"0"}catch{this.balanceSquads="-"}try{this.balanceLocker=(await mn().connection.getTokenAccountBalance(Us(this.stakingAccountAtlasAddress,$i))).value.uiAmountString??"0"}catch{this.balanceLocker="-"}console.log(`[${Ki}] updated!`)}}}}),nk=new An("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"),sc=new An("poLisWXnNRwC6oBu1vHiuKQzFjGL4XDSu4g9qjz9qVk"),Py=8,ls=new An("5WmM9c9WE71y78Ah8Bp8vgyoStscM1ZZyaaFqRf8b2Qa"),Lh=new An("EAgUhz4LG8fqtrShFo1NDrvEiNPxEi7kHe96D76NzkAj"),hx=new An("8tYu2cXu3esX43qWTd21rwkpMDDfT1fdZxFtugnRUnAr"),Kh=new An(dk.address);function ur(){return ds.findProgramAddressSync([Su("Escrow"),ls.toBuffer(),Jn()[0].toBuffer()],Kh)}function Wl(){return ds.findProgramAddressSync([ur()[0].toBuffer(),_o.toBuffer(),Gi.toBuffer()],nk)}async function px(){var e;const r=(e=Gn())==null?void 0:e.pg_lockedVoter.value;return r==null?void 0:r.methods.newEscrow(ur()[1]).accountsPartial({locker:ls,escrow:ur()[0],escrowOwner:Jn()[0],payer:rt(),systemProgram:vu.programId}).transaction()}const yx=new An(fk.address);function Nh(r){return ds.findProgramAddressSync([Su("EscrowHistory"),ur()[0].toBuffer(),new kn(r).toBuffer("le",2)],yx)}function Ec(r){const t=r/60/60/24/255,n=[];for(let i=0;i<t;i++)n.push(3+i);return n}async function gx(r){var t;const e=(t=Gn())==null?void 0:t.pg_snapshots.value;return e==null?void 0:e.methods.createEscrowHistory(r).accountsPartial({escrow:ur()[0],escrowHistory:Nh(r)[0],payer:rt(),systemProgram:vu.programId}).transaction()}async function mx(r){var n;const e=(n=Gn())==null?void 0:n.pg_snapshots.value,t=(await e.account.lockerHistory.all()).find(i=>i.account.era==r).publicKey;return e==null?void 0:e.methods.sync().accountsPartial({locker:ls,escrow:ur()[0],lockerHistory:t,escrowHistory:Nh(r)[0]}).transaction()}const rk=new An(hk.address);function Ii(){return ds.findProgramAddressSync([Su("ProxyEscrow"),rt().toBuffer()],rk)}function Jn(){return ds.findProgramAddressSync([Su("Proxy"),Ii()[0].toBuffer(),rt().toBuffer()],rk)}function Vl(){return ds.findProgramAddressSync([Jn()[0].toBuffer(),_o.toBuffer(),sc.toBuffer()],nk)}async function bx(){var e;const r=(e=Gn())==null?void 0:e.pg_proxyRewarder.value;return r==null?void 0:r.methods.newProxyEscrow(Ii()[1]).accountsPartial({escrowOwner:rt(),proxyEscrow:Ii()[0],payer:rt(),systemProgram:vu.programId}).transaction()}async function wx(){var e;const r=(e=Gn())==null?void 0:e.pg_proxyRewarder.value;return r==null?void 0:r.methods.newProxy(Jn()[1]).accountsPartial({proxyEscrow:Ii()[0],proxy:Jn()[0],tokenMint:sc,proxyOwner:rt(),systemProgram:vu.programId}).transaction()}async function Ry(r,e){var n;const t=(n=Gn())==null?void 0:n.pg_proxyRewarder.value;return t==null?void 0:t.methods.proxyLock(r,e).accountsPartial({locker:ls,escrow:ur()[0],userTokenAccount:gf(rt().toString(),sc.toString()),proxyTokenAccount:Vl()[0],escrowTokenAccount:Wl()[0],proxy:Jn()[0],payer:rt(),lockedVoterProgram:Kh,tokenProgram:_o,registeredLocker:Lh}).transaction()}async function Ty(r){var s,o;const e=(s=Gn())==null?void 0:s.pg_proxyRewarder.value,n=(await((o=Gn())==null?void 0:o.pg_snapshots.value).account.lockerHistory.all()).find(a=>a.account.era==r).publicKey,i=(await e.account.treasuryAuthority.all()).find(a=>a.account.locker.toString()==ls.toString()).publicKey;return e==null?void 0:e.methods.claimRewards().accountsPartial({escrow:ur()[0],locker:ls,proxy:Jn()[0],proxyEscrow:Ii()[0],escrowHistory:Nh(r)[0],lockerHistory:n,treasuryTokenAccount:hx,registeredLocker:Lh,treasuryAuthority:i,userTokenAccount:gf(rt().toString(),sc.toString()),escrowOwner:rt(),tokenProgram:_o}).transaction()}async function kx(){var e;const r=(e=Gn())==null?void 0:e.pg_proxyRewarder.value;return r==null?void 0:r.methods.proxyExit().accountsPartial({locker:ls,escrow:ur()[0],proxy:Jn()[0],escrowTokenAccount:Wl()[0],proxyTokenAccount:Vl()[0],userTokenAccount:gf(rt().toString(),sc.toString()),payer:rt(),lockedVoterProgram:Kh,tokenProgram:_o,registeredLocker:Lh}).transaction()}const Ni="PolisLocker",tt=Ny("polisLockerStore",{state:()=>({balanceWallet:"0",balanceSquads:"0",balanceLocker:"0",proxy:{},proxyEscrow:{},escrow:{}}),getters:{},actions:{async createTokenAccounts(){try{const r=new nr;return r.add(Vh(rt(),Vl()[0],Jn()[0],Gi)),r.add(Vh(rt(),Wl()[0],ur()[0],Gi)),console.log(`[${Ni}] create tokenAccounts!`),r}catch(r){console.error(r),rr.create({message:r.message,type:"negative",position:"bottom-right"})}},async createLocker(r,e){try{const t=new nr;let n;const i=Ad(r,Py);n=await bx(),n&&t.add(n),n=await wx(),n&&t.add(n),n=await px(),n&&t.add(n);for(const s of Ec(e))n=await gx(s),n&&t.add(n);return n=await Ry(new kn(i),new kn(e)),n&&t.add(n),console.log(`[${Ni}] create locker!`),t}catch(t){console.error(t),rr.create({message:t.message,type:"negative",position:"bottom-right"})}},async syncLocker(){try{const r=new nr;let e;const t=parseInt(this.escrow.escrowEndsAt.toString())-parseInt(this.escrow.escrowStartedAt.toString());for(const n of Ec(t))e=await mx(n),e&&r.add(e);return console.log(`[${Ni}] sync locker!`),r}catch(r){console.error(r),rr.create({message:r.message,type:"negative",position:"bottom-right"})}},async addTokensToLocker(r,e,t=!1){try{const n=new nr;let i,s=e;t==!1&&(s=parseInt(this.escrow.escrowEndsAt.toString())-Math.floor(new Date().getTime()/1e3));const o=Ad(r,Py);return i=await Ry(new kn(o),new kn(s)),i&&n.add(i),console.log(`[${Ni}] add tokens to locker!`),n}catch(n){console.error(n),rr.create({message:n.message,type:"negative",position:"bottom-right"})}},async claimLocker(){try{const r=parseInt(this.escrow.escrowEndsAt.toString())-parseInt(this.escrow.escrowStartedAt.toString());console.log(r);const e=new nr;let t;for(const n of Ec(r))t=await Ty(n),t&&e.add(t);return console.log(`[${Ni}] claim form locker!`),e}catch(r){console.error(r),rr.create({message:r.message,type:"negative",position:"bottom-right"})}},async withdrawLocker(){try{const r=parseInt(this.escrow.escrowEndsAt.toString())-parseInt(this.escrow.escrowStartedAt.toString());console.log(r);const e=new nr;let t;for(const n of Ec(r))t=await Ty(n),t&&e.add(t);return t=await kx(),t&&e.add(t),console.log(`[${Ni}] close Locker!`),e}catch(r){console.error(r),rr.create({message:r.message,type:"negative",position:"bottom-right"})}},async updateStore(){var r,e;if(Gn()){const t=(r=Gn())==null?void 0:r.pg_lockedVoter.value,n=(e=Gn())==null?void 0:e.pg_proxyRewarder.value;try{this.proxy=await(n==null?void 0:n.account.proxy.fetch(Jn()[0]))}catch{this.proxy=void 0}try{this.proxyEscrow=await(n==null?void 0:n.account.proxyEscrow.fetch(Ii()[0]))}catch{this.proxyEscrow=void 0}try{this.escrow=await(t==null?void 0:t.account.escrow.fetch(ur()[0]))}catch{this.escrow=void 0}try{this.balanceWallet=(await mn().connection.getTokenAccountBalance(Us(pf().publicKey.value,Gi))).value.uiAmountString??"0"}catch{this.balanceWallet="-"}try{this.balanceSquads=(await mn().connection.getTokenAccountBalance(Us(new An($y().vaultPDA.toString()),Gi))).value.uiAmountString??"0"}catch{this.balanceSquads="-"}this.balanceLocker="-",console.log(`[${Ni}] updated!`)}}}}),Sx={class:"row"},vx=fe("div",{class:"col text-right"},"Wallet",-1),_x={key:0,class:"col-2"},Ax={class:"row q-gutter-x-xs no-wrap justify-end"},Ix={key:1,class:"col-2"},Ex={class:"row q-gutter-x-xs no-wrap justify-end"},Px={class:"row"},Rx=fe("div",{class:"col text-right"},"Squads",-1),Tx={key:0,class:"col-2"},Ox={class:"row q-gutter-x-xs no-wrap justify-end"},Bx={key:1,class:"col-2"},xx={class:"row q-gutter-x-xs no-wrap justify-end"},Cx={class:"row"},Mx=fe("div",{class:"col text-right"},"Locker",-1),Lx={key:0,class:"col-2"},Kx={class:"row q-gutter-x-xs no-wrap justify-end"},Nx={key:1,class:"col-2"},$x=fe("div",{class:"row q-gutter-x-xs no-wrap justify-end"}," - ",-1),Dx=[$x],zx=_n({__name:"TokenLockerBalances",props:["tab"],setup(r){const e=en(2),t=en(8);return(n,i)=>(Se(),Ot(vr,{class:"",flat:""},{default:ce(()=>[Z(Sn,null,{default:ce(()=>[fe("div",Sx,[vx,r.tab=="atlas"?(Se(),it("div",_x,[fe("div",Ax,[Z(xs,{number:Ae(gt)().balanceWallet.toString(),decimals:e.value,padStart:t.value,"currency-name":"ATLAS"},null,8,["number","decimals","padStart"])])])):nn("",!0),r.tab=="polis"?(Se(),it("div",Ix,[fe("div",Ex,[Z(xs,{number:Ae(tt)().balanceWallet.toString(),decimals:e.value,padStart:t.value,"currency-name":"POLIS"},null,8,["number","decimals","padStart"])])])):nn("",!0)]),fe("div",Px,[Rx,r.tab=="atlas"?(Se(),it("div",Tx,[fe("div",Ox,[Z(xs,{number:Ae(gt)().balanceSquads.toString(),decimals:e.value,padStart:t.value,"currency-name":"ATLAS"},null,8,["number","decimals","padStart"])])])):nn("",!0),r.tab=="polis"?(Se(),it("div",Bx,[fe("div",xx,[Z(xs,{number:Ae(tt)().balanceSquads.toString(),decimals:e.value,padStart:t.value,"currency-name":"POLIS"},null,8,["number","decimals","padStart"])])])):nn("",!0)]),fe("div",Cx,[Mx,r.tab=="atlas"?(Se(),it("div",Lx,[fe("div",Kx,[Z(xs,{number:Ae(gt)().balanceLocker.toString(),decimals:e.value,padStart:t.value,"currency-name":"ATLAS"},null,8,["number","decimals","padStart"])])])):nn("",!0),r.tab=="polis"?(Se(),it("div",Nx,Dx)):nn("",!0)])]),_:1})]),_:1}))}}),Wx=fe("div",{class:"text-h5"},"Instructions",-1),Vx=fe("div",{class:"text-subtitle2 text-weight-light"}," Build and invoke instructions... ",-1),Ux={key:0,class:"row"},Fx={key:1,class:"row"},jx=_n({__name:"PolisInstructionBuilderView",setup(r){const e=en("Create new locker"),t=en(["Create token accounts","Create new locker","Sync locker","Add tokens to locker","Claim tokens form locker","Withdraw tokens form locker"]),n=en(),i=en([{label:"1 Day",value:1*24*60*60},{label:"1 Week",value:1*7*24*60*60},{label:"2 Weeks",value:2*7*24*60*60},{label:"1 months",value:1/12*365*24*60*60},{label:"3 months",value:.25*365*24*60*60},{label:"6 months",value:.5*365*24*60*60},{label:"9 months",value:.75*365*24*60*60},{label:"1 years",value:1*365*24*60*60},{label:"2 years",value:2*365*24*60*60},{label:"3 years",value:3*365*24*60*60},{label:"4 years",value:4*365*24*60*60},{label:"5 years",value:5*365*24*60*60}]),s=en(i.value[0]),o=en(),a=en(!1);async function c(){switch(e.value){case"Create token accounts":n.value=await tt().createTokenAccounts();break;case"Create new locker":n.value=await tt().createLocker(o.value,s.value.value);break;case"Sync locker":n.value=await tt().syncLocker();break;case"Add tokens to locker":n.value=await tt().addTokensToLocker(o.value,s.value.value,a.value);break;case"Claim tokens form locker":n.value=await tt().claimLocker();break;case"Withdraw tokens form locker":n.value=await tt().withdrawLocker();break}await Wy(n.value,`[PolisLocker] ${e.value}`),n.value=void 0}return(l,u)=>(Se(),Ot(vr,{flat:"",bordered:"",square:""},{default:ce(()=>[Z(Sn,null,{default:ce(()=>[Wx,Vx]),_:1}),Z(Hi),Z(Sn,null,{default:ce(()=>[Z(Fs,{label:"Action",square:"",filled:"",modelValue:e.value,"onUpdate:modelValue":u[0]||(u[0]=d=>e.value=d),options:t.value},null,8,["modelValue","options"]),e.value=="Create new locker"?(Se(),it("div",Ux,[Z(Fs,{class:"col",square:"",filled:"",label:"Duration",modelValue:s.value,"onUpdate:modelValue":u[1]||(u[1]=d=>s.value=d),options:i.value},null,8,["modelValue","options"]),Z(Wc,{class:"col",square:"",filled:"",label:"Amount",modelValue:o.value,"onUpdate:modelValue":u[2]||(u[2]=d=>o.value=d)},null,8,["modelValue"])])):nn("",!0),e.value=="Add tokens to locker"?(Se(),it("div",Fx,[a.value?(Se(),Ot(Fs,{key:0,class:"col",square:"",filled:"",label:"Duration",modelValue:s.value,"onUpdate:modelValue":u[3]||(u[3]=d=>s.value=d),options:i.value},null,8,["modelValue","options"])):nn("",!0),Z(Wc,{class:"col",square:"",filled:"",label:"Amount",modelValue:o.value,"onUpdate:modelValue":u[4]||(u[4]=d=>o.value=d)},null,8,["modelValue"])])):nn("",!0),Z(yf,{onClick:c,label:"Build",color:"primary",class:"full-width q-ma-md"})]),_:1})]),_:1}))}}),Vo=_n({__name:"SolscanLink",props:["address"],setup(r){return(e,t)=>(Se(),Ot(yf,{color:"primary",size:"sm",icon:"link",target:"_blank",href:"https://solscan.io/account/"+r.address},null,8,["href"]))}}),Uo=_n({__name:"AccountBadge",props:["accountExists"],setup(r){return(e,t)=>r.accountExists?(Se(),Ot(fa,{key:0,icon:"check",color:"primary","text-color":"white"})):(Se(),Ot(fa,{key:1,icon:"close",color:"red","text-color":"white"}))}}),qx={class:"row items-center q-gutter-md"},Gx={class:"col text-uppercase"},Hx=_n({__name:"RegisteredStakeInfo",props:["address","name"],setup(r){const e=r,t=en();_u(()=>rt(),async()=>{await n()}),Au(async()=>{await n()});async function n(){try{t.value=await mn().connection.getTokenAccountBalance(e.address)}catch{}}return(i,s)=>(Se(),Ot(Io,{"expand-separator":""},{header:ce(()=>[Z(Qt,{avatar:""},{default:ce(()=>[Z(Uo,{"account-exists":!!r.address},null,8,["account-exists"])]),_:1}),Z(Qt,null,{default:ce(()=>[Ao("Registered Stake "+Rt(r.name),1)]),_:1}),Z(Qt,{side:""},{default:ce(()=>[fe("div",qx,[fe("div",null,Rt(r.address),1),Z(Vo,{address:r.address},null,8,["address"])])]),_:1})]),default:ce(()=>[Z(vr,null,{default:ce(()=>[Ae(gt)().registeredStakeAtlasAddressInfo?(Se(),Ot(Sn,{key:0},{default:ce(()=>[(Se(!0),it(Ca,null,xa(Object.keys(Ae(gt)().registeredStakeAtlasAddressInfo),o=>(Se(),it("div",{class:"row",key:o},[fe("div",Gx,Rt(o),1),fe("div",null,Rt(Ae(gt)().registeredStakeAtlasAddressInfo[o]),1)]))),128))]),_:1})):nn("",!0)]),_:1})]),_:1}))}}),Yx={class:"row items-center q-gutter-md"},Jx={class:"col text-uppercase"},Qx={key:0,class:"row"},Xx={key:1,class:"row"},Zx={key:0},eC={key:1},tC={key:2},nC=_n({__name:"AtlasLockerStakingAccountInfo",setup(r){return(e,t)=>(Se(),Ot(Io,{"expand-separator":"","default-opened":""},{header:ce(()=>[Z(Qt,{avatar:""},{default:ce(()=>[Z(Uo,{"account-exists":!!Ae(gt)().stakingAccountAtlasInfo},null,8,["account-exists"])]),_:1}),Z(Qt,null,{default:ce(()=>[Ao("Staking Account")]),_:1}),Z(Qt,{side:""},{default:ce(()=>[fe("div",Yx,[fe("div",null,Rt(Ae(gt)().stakingAccountAtlasAddress),1),Z(Vo,{address:Ae(gt)().stakingAccountAtlasAddress},null,8,["address"])])]),_:1})]),default:ce(()=>[Z(vr,null,{default:ce(()=>[Ae(gt)().stakingAccountAtlasInfo?(Se(),Ot(Sn,{key:0},{default:ce(()=>[(Se(!0),it(Ca,null,xa(Object.keys(Ae(gt)().stakingAccountAtlasInfo),n=>(Se(),it("div",{class:"row",key:n},[fe("div",Jx,Rt(n),1),n.includes("totalStake")||n.includes("activeStake")||n.includes("pendingRewards")||n.includes("paidRewards")||n.includes("pendingRewards")?(Se(),it("div",Qx,[Z(xs,{"currency-name":"ATLAS",number:Ae(gt)().stakingAccountAtlasInfo[n]*Math.pow(10,-Ae(tk))},null,8,["number"])])):n.includes("stakedAtTs")||n.includes("lastPendingRewardCalcTs")||n.includes("lastHarvestTs")||n.includes("unstakedTs")?(Se(),it("div",Xx,[Ae(gt)().stakingAccountAtlasInfo[n]==0?(Se(),it("div",Zx," - ")):(Se(),it("div",eC,Rt(new Date(Ae(gt)().stakingAccountAtlasInfo[n]*1e3).toUTCString()),1))])):(Se(),it("div",tC,Rt(Ae(gt)().stakingAccountAtlasInfo[n]),1))]))),128))]),_:1})):nn("",!0)]),_:1})]),_:1}))}}),rC=fe("div",null,[fe("div",{class:"text-h4"},"ATLAS Locker"),fe("div",{class:"text-subtitle1 text-weight-light"}," View and check your locker info... ")],-1),iC=_n({__name:"AtlasInfoView",setup(r){return Au(async()=>{await gt().updateStore()}),_u(()=>rt(),async()=>{await gt().updateStore()}),(e,t)=>(Se(),Ot(vr,{flat:"",bordered:"",square:""},{default:ce(()=>[Z(Sn,{class:"row items-center q-gutter-x-md"},{default:ce(()=>[fe("div",null,[Z(Vy,{width:"100px",src:"/currencies/ATLAS.webp"})]),rC]),_:1}),Z(Hi),Z(Sn,{class:"q-gutter-md"},{default:ce(()=>[Z(Uy,{class:"rounded-borders"},{default:ce(()=>[Z(Hx,{name:"ATLAS",address:Ae(gt)().registeredStakeAtlasAddress},null,8,["address"]),Z(nC)]),_:1})]),_:1})]),_:1}))}});function sC(r){const e=Math.floor(r/3600),t=Math.floor(r%3600/60),n=r%60,i=String(e).padStart(2,"0"),s=String(t).padStart(2,"0"),o=String(n).padStart(2,"0");return`${i}H : ${s}M : ${o}S`}const oC={class:"row items-center q-gutter-md"},aC={class:"col text-uppercase"},cC={class:"row"},uC=fe("div",{class:"col row q-gutter-x-sm"},[fe("div",{class:"text-uppercase"},"Expires in")],-1),lC={class:"row"},dC=fe("div",{class:"col row q-gutter-x-sm"},[fe("div",{class:"text-uppercase"},"Start Date")],-1),fC={class:"row"},hC=fe("div",{class:"col row q-gutter-x-sm"},[fe("div",{class:"text-uppercase"},"End Date")],-1),pC=_n({__name:"PolisLockerEscrowInfo",setup(r){const e=pk(()=>{var t,n;return tt().escrow?parseInt(((n=(t=tt().escrow)==null?void 0:t.escrowEndsAt)==null?void 0:n.toString())??"0")-Math.floor(new Date().getTime()/1e3):0});return(t,n)=>(Se(),Ot(Io,{"expand-separator":""},{header:ce(()=>[Z(Qt,{avatar:""},{default:ce(()=>[Z(Uo,{"account-exists":Ae(tt)().escrow?!!Object.keys(Ae(tt)().escrow).length:!1},null,8,["account-exists"])]),_:1}),Z(Qt,null,{default:ce(()=>[Ao(" Escrow ")]),_:1}),Z(Qt,{side:""},{default:ce(()=>[fe("div",oC,[fe("div",null,Rt(Ae(Jn)()[0]),1),Z(Vo,{address:Ae(ur)()[0]},null,8,["address"])])]),_:1})]),default:ce(()=>[Z(vr,null,{default:ce(()=>[Ae(tt)().escrow?(Se(),Ot(Sn,{key:0},{default:ce(()=>[(Se(!0),it(Ca,null,xa(Object.keys(Ae(tt)().escrow),i=>(Se(),it("div",{class:"row",key:i},[fe("div",aC,Rt(i),1),fe("div",null,Rt(Ae(tt)().escrow[i]),1)]))),128)),fe("div",cC,[uC,fe("div",null,Rt(Ae(sC)(e.value)),1)]),fe("div",lC,[dC,fe("div",null,Rt(new Date(Ae(tt)().escrow.escrowStartedAt*1e3).toUTCString()),1)]),fe("div",fC,[hC,fe("div",null,Rt(new Date(Ae(tt)().escrow.escrowEndsAt*1e3).toUTCString()),1)])]),_:1})):nn("",!0)]),_:1})]),_:1}))}}),yC={class:"row items-center q-gutter-md"},gC={class:"col text-uppercase"},mC=_n({__name:"PolisLockerProxyInfo",setup(r){return(e,t)=>(Se(),Ot(Io,{"expand-separator":""},{header:ce(()=>[Z(Qt,{avatar:""},{default:ce(()=>[Z(Uo,{"account-exists":Ae(tt)().proxy?!!Object.keys(Ae(tt)().proxy).length:!1},null,8,["account-exists"])]),_:1}),Z(Qt,null,{default:ce(()=>[Ao(" Proxy ")]),_:1}),Z(Qt,{side:""},{default:ce(()=>[fe("div",yC,[fe("div",null,Rt(Ae(Jn)()[0]),1),Z(Vo,{address:Ae(Jn)()[0]},null,8,["address"])])]),_:1})]),default:ce(()=>[Z(vr,null,{default:ce(()=>[Ae(tt)().proxy?(Se(),Ot(Sn,{key:0},{default:ce(()=>[(Se(!0),it(Ca,null,xa(Object.keys(Ae(tt)().proxy),n=>(Se(),it("div",{class:"row",key:n},[fe("div",gC,Rt(n),1),fe("div",null,Rt(Ae(tt)().proxy[n]),1)]))),128))]),_:1})):nn("",!0)]),_:1})]),_:1}))}}),bC={class:"row items-center q-gutter-md"},wC={class:"col text-uppercase"},kC=_n({__name:"PolisLockerProxyEscrowInfo",setup(r){return(e,t)=>(Se(),Ot(Io,{"expand-separator":""},{header:ce(()=>[Z(Qt,{avatar:""},{default:ce(()=>[Z(Uo,{"account-exists":Ae(tt)().proxyEscrow?!!Object.keys(Ae(tt)().proxyEscrow).length:!1},null,8,["account-exists"])]),_:1}),Z(Qt,null,{default:ce(()=>[Ao(" ProxyEscrow ")]),_:1}),Z(Qt,{side:""},{default:ce(()=>[fe("div",bC,[fe("div",null,Rt(Ae(Ii)()[0]),1),Z(Vo,{address:Ae(Ii)()[0]},null,8,["address"])])]),_:1})]),default:ce(()=>[Z(vr,null,{default:ce(()=>[Ae(tt)().proxyEscrow?(Se(),Ot(Sn,{key:0},{default:ce(()=>[(Se(!0),it(Ca,null,xa(Object.keys(Ae(tt)().proxyEscrow),n=>(Se(),it("div",{class:"row",key:n},[fe("div",wC,Rt(n),1),fe("div",null,Rt(Ae(tt)().proxyEscrow[n]),1)]))),128))]),_:1})):nn("",!0)]),_:1})]),_:1}))}}),SC={class:"row items-center q-gutter-md"},vC={class:"row"},_C=fe("div",{class:"col"},"Balance",-1),Oy=_n({__name:"PolisLockerATAInfo",props:{label:{type:String},address:{type:An,required:!0}},setup(r){const e=r,t=en();_u(()=>rt(),async()=>{await n()}),Au(async()=>{await n()});async function n(){try{t.value=await mn().connection.getTokenAccountBalance(e.address)}catch{}}return(i,s)=>(Se(),Ot(Io,{"expand-separator":""},{header:ce(()=>[Z(Qt,{avatar:""},{default:ce(()=>[Z(Uo,{"account-exists":t.value},null,8,["account-exists"])]),_:1}),Z(Qt,null,{default:ce(()=>[Ao(Rt(r.label),1)]),_:1}),Z(Qt,{side:""},{default:ce(()=>[fe("div",SC,[fe("div",null,Rt(r.address),1),Z(Vo,{address:r.address},null,8,["address"])])]),_:1})]),default:ce(()=>[Z(vr,null,{default:ce(()=>[Z(Sn,null,{default:ce(()=>{var o,a;return[fe("div",vC,[_C,Z(Dy,{"pad-start":"15",decimals:"4",number:(a=(o=t.value)==null?void 0:o.value)==null?void 0:a.uiAmount},null,8,["number"])])]}),_:1})]),_:1})]),_:1}))}}),AC=fe("div",null,[fe("div",{class:"text-h5"},"Polis Locker"),fe("div",{class:"text-subtitle1 text-weight-light"}," View and check your locker info... ")],-1),IC=_n({__name:"PolisInfoView",setup(r){return Au(async()=>{await tt().updateStore()}),_u(()=>rt(),async()=>{await tt().updateStore()}),(e,t)=>(Se(),Ot(vr,{flat:"",bordered:"",square:""},{default:ce(()=>[Z(Sn,{class:"row items-center q-gutter-x-md"},{default:ce(()=>[fe("div",null,[Z(Vy,{width:"100px",src:"/currencies/POLIS.webp"})]),AC]),_:1}),Z(Hi),Z(Sn,{class:"q-gutter-md"},{default:ce(()=>[Z(Uy,{class:"rounded-borders"},{default:ce(()=>[Z(pC),Z(mC),Z(kC),Z(Oy,{label:"Escrow ATA",address:Ae(Wl)()[0]},null,8,["address"]),Z(Oy,{label:"Proxy ATA",address:Ae(Vl)()[0]},null,8,["address"])]),_:1})]),_:1})]),_:1}))}}),EC=fe("div",{class:"text-h5"},"Instructions",-1),PC=fe("div",{class:"text-subtitle2 text-weight-light"}," Build and invoke instructions... ",-1),RC={key:0,class:"row"},TC={key:1,class:"row"},OC=_n({__name:"AtlasInstructionBuilderView",setup(r){const e=en(["Create staking account","Add tokens to locker","Claim tokens from locker","Unstake tokens from locker","Cancel unstake tokens from locker","Withdraw tokens from locker"]),t=en(e.value[0]),n=en(),i=en(),s=en(!1);async function o(){switch(t.value){case"Create staking account":n.value=await gt().createStakingAccount();break;case"Add tokens to locker":n.value=await gt().stakeTokens(i.value);break;case"Claim tokens from locker":n.value=await gt().claimTokens();break;case"Unstake tokens from locker":n.value=await gt().unstakeTokens();break;case"Cancel unstake tokens from locker":n.value=await gt().cancelUnstake();break;case"Withdraw tokens from locker":n.value=await gt().withdrawTokens();break}await Wy(n.value,`[Atlas Locker] ${t.value}`),n.value=void 0}return(a,c)=>(Se(),Ot(vr,{flat:"",bordered:"",square:""},{default:ce(()=>[Z(Sn,null,{default:ce(()=>[EC,PC]),_:1}),Z(Hi),Z(Sn,null,{default:ce(()=>[Z(Fs,{label:"Action",square:"",filled:"",modelValue:t.value,"onUpdate:modelValue":c[0]||(c[0]=l=>t.value=l),options:e.value},null,8,["modelValue","options"]),t.value=="Create new locker"?(Se(),it("div",RC,[Z(Fs,{class:"col",square:"",filled:"",label:"Duration",modelValue:a.duration_selected,"onUpdate:modelValue":c[1]||(c[1]=l=>a.duration_selected=l),options:a.duration_options},null,8,["modelValue","options"]),Z(Wc,{class:"col",square:"",filled:"",label:"Amount",modelValue:i.value,"onUpdate:modelValue":c[2]||(c[2]=l=>i.value=l)},null,8,["modelValue"])])):nn("",!0),t.value=="Add tokens to locker"?(Se(),it("div",TC,[s.value?(Se(),Ot(Fs,{key:0,class:"col",square:"",filled:"",label:"Duration",modelValue:a.duration_selected,"onUpdate:modelValue":c[3]||(c[3]=l=>a.duration_selected=l),options:a.duration_options},null,8,["modelValue","options"])):nn("",!0),Z(Wc,{class:"col",square:"",filled:"",label:"Amount",modelValue:i.value,"onUpdate:modelValue":c[4]||(c[4]=l=>i.value=l)},null,8,["modelValue"])])):nn("",!0),Z(yf,{onClick:o,label:"Build",color:"primary",class:"full-width q-ma-md"})]),_:1})]),_:1}))}}),BC={key:0,class:"col absolute-center"},xC={key:1},CC={class:"row items-center q-gutter-x-sm"},MC=fe("img",{src:"currencies\\ATLAS.webp"},null,-1),LC=fe("div",{class:"text-h5"},"ATLAS",-1),KC={class:"row items-center q-gutter-x-sm"},NC=fe("img",{src:"currencies\\POLIS.webp"},null,-1),$C=fe("div",{class:"text-h5"},"POLIS",-1),hM=_n({__name:"StarAtlasLocker",setup(r){const e=en("atlas");return(t,n)=>(Se(),Ot(bk,{class:"bg-black"},{default:ce(()=>{var i,s;return[(s=(i=Ae(pf)().publicKey)==null?void 0:i.value)!=null&&s.toString()?(Se(),it("div",xC,[Z(gk,{modelValue:e.value,"onUpdate:modelValue":n[0]||(n[0]=o=>e.value=o),align:"justify",class:"col bg-dark"},{default:ce(()=>[Z(zh,{name:"atlas"},{default:ce(()=>[fe("div",CC,[Z(fa,null,{default:ce(()=>[MC]),_:1}),LC])]),_:1}),Z(Hi,{vertical:""}),Z(zh,{name:"polis"},{default:ce(()=>[fe("div",KC,[Z(fa,null,{default:ce(()=>[NC]),_:1}),$C])]),_:1}),Z(Hi,{vertical:""}),Z(zx,{class:"q-pr-md col",tab:e.value},null,8,["tab"])]),_:1},8,["modelValue"]),Z(Hi),Z(mk,{modelValue:e.value,"onUpdate:modelValue":n[1]||(n[1]=o=>e.value=o),animated:""},{default:ce(()=>[Z(Wh,{name:"atlas"},{default:ce(()=>[Z(iC),Z(OC)]),_:1}),Z(Wh,{name:"polis"},{default:ce(()=>[Z(IC),Z(jx)]),_:1})]),_:1},8,["modelValue"])])):(Se(),it("div",BC,[Z(Ae(yk),{dark:""})]))]}),_:1}))}});export{hM as default};
