import{Q as W,a as b,b as q}from"./QInput.cbf31330.js";import{Q as h,a as R}from"./QTabPanels.6e2dc8de.js";import{Q as E}from"./QPage.6f0d29af.js";import{P as d,cI as J,cm as U,ah as Q,au as w,J as m,b1 as p,ak as f,as as t,bx as l,ar as g,cj as V,cJ as $,cK as D,cL as y,aX as A,a6 as S,b7 as C,bz as P,ai as k,a1 as B,aj as j}from"./index.1bcfe929.js";import{A as H,P as Y,e as z}from"./index.58bb2a54.js";import{d as L}from"./dapp_whitelist.5f7c1b69.js";import{Q as T,i as F,j as I,h as K,k as M,C as X}from"./ClosePopup.b6c100e6.js";import{Q as G}from"./QTree.ba154475.js";import"./uid.3d458cee.js";import"./touch.3df10340.js";import"./pako.esm.9b437c72.js";import"./QSlideTransition.f4f2fa7c.js";const O="processed",Z="confirmed",ee=new d(L.metadata.address);let N=null;const x=()=>N,te=()=>{const _=J(),a=U().connection,r=Q(()=>new H(a,_.value,{preflightCommitment:O,commitment:Z})),n=Q(()=>new Y(L,ee,r.value));N={wallet:_,connection:a,provider:r,program:n}},ae={class:"row q-gutter-x-md"},le=w({__name:"CreateWhitelist",setup(_){const a=m("My new whitelist");async function r(){const{program:n}=x();let[o,c]=d.findProgramAddressSync([$().publicKey.value.toBytes(),z(a.value)],n.value.programId);try{const u=await n.value.methods.initialize(a.value).accounts({whitelist:o,systemProgram:D.programId}).rpc();console.log(u),y.create({message:"TX-Signature: "+u,timeout:5e3})}catch{y.create({color:"red",message:"Error sending tx!",timeout:5e3})}}return(n,o)=>(p(),f("div",ae,[t(W,{class:"col",modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=c=>a.value=c)},null,8,["modelValue"]),t(V,{color:"primary",onClick:o[1]||(o[1]=c=>r())},{default:l(()=>[g("Create")]),_:1})]))}}),oe={class:"row q-gutter-x-md"},se=w({__name:"AddAddressToWhitelist",setup(_){const{program:a}=x(),r=m("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),n=m(),o=m();A(async()=>{n.value=await a.value.account.whitelist.all()});async function c(){const u=new d(o.value.publicKey),[s,i]=d.findProgramAddressSync([new d(r.value).toBytes(),u.toBytes()],a.value.programId);try{const e=new d(r.value),v=await a.value.methods.addToWhitelist(e).accounts({entry:s,whitelist:u,authority:$().publicKey.value,systemProgram:D.programId}).rpc();console.log(v),y.create({message:"TX-Signature: "+v,timeout:5e3})}catch(e){console.log(e),y.create({color:"red",message:`${e}`,timeout:5e3})}}return(u,s)=>{var i;return p(),f("div",oe,[t(M,{color:"primary",label:((i=o.value)==null?void 0:i.account.name)??"please select a whitelist"},{default:l(()=>[t(T,null,{default:l(()=>[(p(!0),f(S,null,C(n.value,e=>P((p(),k(K,{clickable:"",key:e,onClick:v=>o.value=e},{default:l(()=>[t(F,null,{default:l(()=>[t(I,null,{default:l(()=>[g(B(e==null?void 0:e.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[X]])),128))]),_:1})]),_:1},8,["label"]),t(W,{class:"col",outlined:"",modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=e=>r.value=e),label:"Address to be removed"},null,8,["modelValue"]),t(V,{color:"primary",onClick:s[1]||(s[1]=e=>c())},{default:l(()=>[g("Add")]),_:1})])}}}),re={class:"row q-gutter-x-md"},ne=w({__name:"ViewWhitelist",setup(_){const{program:a}=x(),r=m(),n=m();A(async()=>{r.value=await a.value.account.whitelist.all(),n.value=await a.value.account.whitelistEntry.all()});const o=Q(()=>{var c;return(c=r==null?void 0:r.value)==null?void 0:c.map(u=>{var s,i;return{label:`${u.account.name} | ${u.publicKey.toString()}`,children:(i=(s=n.value)==null?void 0:s.filter(e=>e.account.parent.toString()===u.publicKey.toString()))==null?void 0:i.flatMap(e=>({label:`Member: ${e.account.whitelisted.toString()}  |  Account: ${e.publicKey.toString()} `}))}})});return(c,u)=>(p(),f("div",re,[o.value?(p(),k(G,{key:0,nodes:o.value,"node-key":"label","selected-color":"primary","default-expand-all":""},null,8,["nodes"])):j("",!0)]))}}),ue={class:"row q-gutter-x-md"},ce=w({__name:"RemoveAddressFromWhitelist",setup(_){const{program:a}=x(),r=m("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),n=m(),o=m();A(async()=>{n.value=await a.value.account.whitelist.all()});async function c(){const u=new d(o.value.publicKey),[s,i]=d.findProgramAddressSync([new d(r.value).toBytes(),u.toBytes()],a.value.programId);try{console.log(a.value.methods);const e=new d(r.value),v=await a.value.methods.removeFromWhitelist(e).accounts({entry:s,whitelist:u,authority:$().publicKey.value}).rpc();console.log(v),y.create({message:"TX-Signature: "+v,timeout:5e3})}catch(e){console.log(e),y.create({color:"red",message:`${e}`,timeout:5e3})}}return(u,s)=>{var i;return p(),f("div",ue,[t(M,{color:"primary",label:((i=o.value)==null?void 0:i.account.name)??"please select a whitelist"},{default:l(()=>[t(T,null,{default:l(()=>[(p(!0),f(S,null,C(n.value,e=>P((p(),k(K,{clickable:"",key:e,onClick:v=>o.value=e},{default:l(()=>[t(F,null,{default:l(()=>[t(I,null,{default:l(()=>[g(B(e==null?void 0:e.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[X]])),128))]),_:1})]),_:1},8,["label"]),t(W,{class:"col",outlined:"",modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=e=>r.value=e),label:"Address to be added"},null,8,["modelValue"]),t(V,{color:"primary",onClick:s[1]||(s[1]=e=>c())},{default:l(()=>[g("Remove")]),_:1})])}}}),ie={class:"row q-gutter-x-md"},de=w({__name:"DeleteWhitelist",setup(_){const{program:a}=x(),r=m("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),n=m(),o=m();A(async()=>{n.value=await a.value.account.whitelist.all()});async function c(){const u=new d(o.value.publicKey);d.findProgramAddressSync([new d(r.value).toBytes(),u.toBytes()],a.value.programId);try{const s=await a.value.methods.deleteWhitelist(o.value.account.name).accounts({whitelist:u,authority:$().publicKey.value}).rpc();console.log(s),y.create({message:"TX-Signature: "+s,timeout:5e3})}catch(s){console.log(s),y.create({color:"red",message:`${s}`,timeout:5e3})}}return(u,s)=>{var i;return p(),f("div",ie,[t(M,{color:"primary",label:((i=o.value)==null?void 0:i.account.name)??"please select a whitelist"},{default:l(()=>[t(T,null,{default:l(()=>[(p(!0),f(S,null,C(n.value,e=>P((p(),k(K,{clickable:"",key:e,onClick:v=>o.value=e},{default:l(()=>[t(F,null,{default:l(()=>[t(I,null,{default:l(()=>[g(B(e==null?void 0:e.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[X]])),128))]),_:1})]),_:1},8,["label"]),t(V,{color:"primary",onClick:s[0]||(s[0]=e=>c())},{default:l(()=>[g("Delete")]),_:1})])}}}),Ve=w({__name:"WhitelistPage",setup(_){const a=m("create");return te(),(r,n)=>(p(),k(E,{class:"col text-center"},{default:l(()=>[t(q,{"no-caps":"","outside-arrows":"","mobile-arrows":"",modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=o=>a.value=o),class:"shadow-2",align:"justify"},{default:l(()=>[t(b,{name:"create",label:"Create Whitelist"}),t(b,{name:"add",label:"Add Address to Whitelist"}),t(b,{name:"remove",label:"Remove address from Whitelist"}),t(b,{name:"delete",label:"Delete Whitelist"}),t(b,{name:"view",label:"View "})]),_:1},8,["modelValue"]),t(R,{dark:"",modelValue:a.value,"onUpdate:modelValue":n[1]||(n[1]=o=>a.value=o),animated:"",class:"q-mx-xl"},{default:l(()=>[t(h,{name:"create"},{default:l(()=>[t(le)]),_:1}),t(h,{name:"add"},{default:l(()=>[t(se)]),_:1}),t(h,{name:"remove"},{default:l(()=>[t(ce)]),_:1}),t(h,{name:"delete"},{default:l(()=>[t(de)]),_:1}),t(h,{name:"view"},{default:l(()=>[t(ne)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{Ve as default};
