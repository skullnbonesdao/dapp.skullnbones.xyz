import{a as ul,Q as fw}from"./QTabs.dee7cd49.js";import{Q as hw}from"./QPage.c561ded1.js";import{Q as pw}from"./QCardSection.321be64b.js";import{Q as yw}from"./QCard.67de6af8.js";import{dF as Kc,dG as zp,dH as Wp,dI as Vp,dJ as Nc,dK as Dc,dL as $c,dM as zc,dN as Wc,cY as ge,dO as Vc,dP as Uc,bY as Fc,dQ as L,dR as we,d1 as C,dB as M,dC as Me,d2 as ee,dS as Ie,dT as Pt,dE as De,dU as si,da as he,dV as pe,dp as Qn,dW as Ps,dX as Gt,dY as Rd,dZ as Td,d_ as Od,db as Bd,dc as ta,eg as cc,bW as Hs,bX as z,e3 as Up,e4 as Xf,e5 as Vl,e6 as Fp,e7 as jp,e8 as uc,e9 as gw,P as un,d4 as Ul,cp as on,c_ as mw,dn as bw,eh as ww,ei as kw,cU as Ko,cV as Sw,cP as vw,au as qp,aX as _w,bs as Aw,b1 as Ya,ai as Gp,bx as lc,as as yi,al as Fe,a1 as es,V as Ur,J as Iw,ak as Zf,cn as Ew}from"./index.e3ff99be.js";import{v as Pw}from"./vaultTransactionCreate.c9b9fc1a.js";import{l as jt,a as Hp}from"./lodash.3db5a0dd.js";import{s as $i}from"./sha256.01ed7ba3.js";import{_ as ho,a as Rw}from"./Amount.8849044d.js";import{h as Tw}from"./handle_confirmation.32d1bee1.js";import{t as Ow}from"./token.b279cd56.js";import{g as po}from"./extensionType.5a624cd0.js";import"./uid.42677368.js";import"./rtl.fb727fdd.js";import"./errors.825970a3.js";import"./web3.754607a0.js";import"./bigint.f636ac3d.js";var sn={},jc={},Yp={},Jp={};Object.defineProperty(Jp,"__esModule",{value:!0});var qc={},vn={},Ei={};class Bw extends TypeError{constructor(e,t){let n;const{message:i,...s}=e,{path:o}=e,a=o.length===0?i:"At path: "+o.join(".")+" -- "+i;super(a),Object.assign(this,s),this.name=this.constructor.name,this.failures=()=>{var c;return(c=n)!=null?c:n=[e,...t()]}}}function xw(r){return Gr(r)&&typeof r[Symbol.iterator]=="function"}function Gr(r){return typeof r=="object"&&r!=null}function Xn(r){return typeof r=="string"?JSON.stringify(r):""+r}function Cw(r){const{done:e,value:t}=r.next();return e?void 0:t}function Mw(r,e,t,n){if(r===!0)return;r===!1?r={}:typeof r=="string"&&(r={message:r});const{path:i,branch:s}=e,{type:o}=t,{refinement:a,message:c="Expected a value of type `"+o+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+Xn(n)+"`"}=r;return{value:n,type:o,refinement:a,key:i[i.length-1],path:i,branch:s,...r,message:c}}function*eh(r,e,t,n){xw(r)||(r=[r]);for(const i of r){const s=Mw(i,e,t,n);s&&(yield s)}}function*xd(r,e,t={}){const{path:n=[],branch:i=[r],coerce:s=!1,mask:o=!1}=t,a={path:n,branch:i};if(s&&(r=e.coercer(r,a),o&&e.type!=="type"&&Gr(e.schema)&&Gr(r)&&!Array.isArray(r)))for(const l in r)e.schema[l]===void 0&&delete r[l];let c=!0;for(const l of e.validator(r,a))c=!1,yield[l,void 0];for(let[l,u,f]of e.entries(r,a)){const m=xd(u,f,{path:l===void 0?n:[...n,l],branch:l===void 0?i:[...i,u],coerce:s,mask:o});for(const y of m)y[0]?(c=!1,yield[y[0],void 0]):s&&(u=y[1],l===void 0?r=u:r instanceof Map?r.set(l,u):r instanceof Set?r.add(u):Gr(r)&&(r[l]=u))}if(c)for(const l of e.refiner(r,a))c=!1,yield[l,void 0];c&&(yield[void 0,r])}class kr{constructor(e){const{type:t,schema:n,validator:i,refiner:s,coercer:o=c=>c,entries:a=function*(){}}=e;this.type=t,this.schema=n,this.entries=a,this.coercer=o,i?this.validator=(c,l)=>{const u=i(c,l);return eh(u,l,this,c)}:this.validator=()=>[],s?this.refiner=(c,l)=>{const u=s(c,l);return eh(u,l,this,c)}:this.refiner=()=>[]}assert(e){return Qp(e,this)}create(e){return ie(e,this)}is(e){return Xp(e,this)}mask(e){return Lw(e,this)}validate(e,t={}){return na(e,this,t)}}function Qp(r,e){const t=na(r,e);if(t[0])throw t[0]}function ie(r,e){const t=na(r,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function Lw(r,e){const t=na(r,e,{coerce:!0,mask:!0});if(t[0])throw t[0];return t[1]}function Xp(r,e){return!na(r,e)[0]}function na(r,e,t={}){const n=xd(r,e,t),i=Cw(n);if(i[0])return[new Bw(i[0],function*(){for(const o of n)o[0]&&(yield o[0])}),void 0];{const s=i[1];return[void 0,s]}}function zi(r,e){return new kr({type:r,schema:null,validator:e})}function Kw(){return zi("any",()=>!0)}function se(r){return new kr({type:"array",schema:r,*entries(e){if(r&&Array.isArray(e))for(const[t,n]of e.entries())yield[t,n,r]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||"Expected an array value, but received: "+Xn(e)}})}function mr(){return zi("boolean",r=>typeof r=="boolean")}function Cd(r){return zi("instance",e=>e instanceof r||"Expected a `"+r.name+"` instance, but received: "+Xn(e))}function gt(r){const e=Xn(r),t=typeof r;return new kr({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?r:null,validator(n){return n===r||"Expected the literal `"+e+"`, but received: "+Xn(n)}})}function Nw(){return zi("never",()=>!1)}function oe(r){return new kr({...r,validator:(e,t)=>e===null||r.validator(e,t),refiner:(e,t)=>e===null||r.refiner(e,t)})}function D(){return zi("number",r=>typeof r=="number"&&!isNaN(r)||"Expected a number, but received: "+Xn(r))}function be(r){return new kr({...r,validator:(e,t)=>e===void 0||r.validator(e,t),refiner:(e,t)=>e===void 0||r.refiner(e,t)})}function Zp(r,e){return new kr({type:"record",schema:null,*entries(t){if(Gr(t))for(const n in t){const i=t[n];yield[n,n,r],yield[n,i,e]}},validator(t){return Gr(t)||"Expected an object, but received: "+Xn(t)}})}function ne(){return zi("string",r=>typeof r=="string"||"Expected a string, but received: "+Xn(r))}function Md(r){const e=Nw();return new kr({type:"tuple",schema:null,*entries(t){if(Array.isArray(t)){const n=Math.max(r.length,t.length);for(let i=0;i<n;i++)yield[i,t[i],r[i]||e]}},validator(t){return Array.isArray(t)||"Expected an array, but received: "+Xn(t)}})}function J(r){const e=Object.keys(r);return new kr({type:"type",schema:r,*entries(t){if(Gr(t))for(const n of e)yield[n,t[n],r[n]]},validator(t){return Gr(t)||"Expected an object, but received: "+Xn(t)}})}function wn(r){const e=r.map(t=>t.type).join(" | ");return new kr({type:"union",schema:null,validator(t,n){const i=[];for(const s of r){const[...o]=xd(t,s,n),[a]=o;if(a[0])for(const[c]of o)c&&i.push(c);else return[]}return["Expected the value to satisfy a union of `"+e+"`, but received: "+Xn(t),...i]}})}function ra(){return zi("unknown",()=>!0)}function ia(r,e,t){return new kr({...r,coercer:(n,i)=>Xp(n,e)?r.coercer(t(n,i),i):r.coercer(n,i)})}const Dw=Kc.v4,$w=function(r,e,t,n){if(typeof r!="string")throw new TypeError(r+" must be a string");n=n||{};const i=typeof n.version=="number"?n.version:2;if(i!==1&&i!==2)throw new TypeError(i+" must be 1 or 2");const s={method:r};if(i===2&&(s.jsonrpc="2.0"),e){if(typeof e!="object"&&!Array.isArray(e))throw new TypeError(e+" must be an object, array or omitted");s.params=e}if(typeof t>"u"){const o=typeof n.generator=="function"?n.generator:function(){return Dw()};s.id=o(s,n)}else i===2&&t===null?n.notificationIdNull&&(s.id=null):s.id=t;return s};var zw=$w;const Ww=Kc.v4,Vw=zw,No=function(r,e){if(!(this instanceof No))return new No(r,e);e||(e={}),this.options={reviver:typeof e.reviver<"u"?e.reviver:null,replacer:typeof e.replacer<"u"?e.replacer:null,generator:typeof e.generator<"u"?e.generator:function(){return Ww()},version:typeof e.version<"u"?e.version:2,notificationIdNull:typeof e.notificationIdNull=="boolean"?e.notificationIdNull:!1},this.callServer=r};var Uw=No;No.prototype.request=function(r,e,t,n){const i=this;let s=null;const o=Array.isArray(r)&&typeof e=="function";if(this.options.version===1&&o)throw new TypeError("JSON-RPC 1.0 does not support batching");if(o||!o&&r&&typeof r=="object"&&typeof e=="function")n=e,s=r;else{typeof t=="function"&&(n=t,t=void 0);const l=typeof n=="function";try{s=Vw(r,e,t,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(u){if(l)return n(u);throw u}if(!l)return s}let c;try{c=JSON.stringify(s,this.options.replacer)}catch(l){return n(l)}return this.callServer(c,function(l,u){i._parseResponse(l,u,n)}),s};No.prototype._parseResponse=function(r,e,t){if(r){t(r);return}if(!e)return t();let n;try{n=JSON.parse(e,this.options.reviver)}catch(i){return t(i)}if(t.length===3)if(Array.isArray(n)){const i=function(o){return typeof o.error<"u"},s=function(o){return!i(o)};return t(null,n.filter(i),n.filter(s))}else return t(null,n.error,n.result);t(null,n)};var ey={};(function(r){var e=Vc.exports;Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var t=e(zp),n=e(Wp.exports),i=e(Vp.exports),s=e(Nc.exports),o=e(Dc.exports),a=e($c.exports),c=e(zc.exports),l=e(Wc.exports),u=Uc.exports;function f(p){var w=m();return function(){var E=(0,l.default)(p),P;if(w){var K=(0,l.default)(this).constructor;P=Reflect.construct(E,arguments,K)}else P=E.apply(this,arguments);return(0,c.default)(this,P)}}function m(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var y=function(p,w){var v={};for(var E in p)Object.prototype.hasOwnProperty.call(p,E)&&w.indexOf(E)<0&&(v[E]=p[E]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function")for(var P=0,E=Object.getOwnPropertySymbols(p);P<E.length;P++)w.indexOf(E[P])<0&&Object.prototype.propertyIsEnumerable.call(p,E[P])&&(v[E[P]]=p[E[P]]);return v},S=function(p){(0,a.default)(v,p);var w=f(v);function v(E){var P,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"ws://localhost:8080",T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},b=arguments.length>3?arguments[3]:void 0;(0,s.default)(this,v);var _=T.autoconnect,R=_===void 0?!0:_,W=T.reconnect,B=W===void 0?!0:W,V=T.reconnect_interval,q=V===void 0?1e3:V,I=T.max_reconnects,$=I===void 0?5:I,G=y(T,["autoconnect","reconnect","reconnect_interval","max_reconnects"]);return P=w.call(this),P.webSocketFactory=E,P.queue={},P.rpc_id=0,P.address=K,P.autoconnect=R,P.ready=!1,P.reconnect=B,P.reconnect_timer_id=void 0,P.reconnect_interval=q,P.max_reconnects=$,P.rest_options=G,P.current_reconnects=0,P.generate_request_id=b||function(){return++P.rpc_id},P.autoconnect&&P._connect(P.address,Object.assign({autoconnect:P.autoconnect,reconnect:P.reconnect,reconnect_interval:P.reconnect_interval,max_reconnects:P.max_reconnects},P.rest_options)),P}return(0,o.default)(v,[{key:"connect",value:function(){this.socket||this._connect(this.address,Object.assign({autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects},this.rest_options))}},{key:"call",value:function(P,K,T,b){var _=this;return!b&&(0,i.default)(T)==="object"&&(b=T,T=null),new Promise(function(R,W){if(!_.ready)return W(new Error("socket not ready"));var B=_.generate_request_id(P,K),V={jsonrpc:"2.0",method:P,params:K||null,id:B};_.socket.send(JSON.stringify(V),b,function(q){if(q)return W(q);_.queue[B]={promise:[R,W]},T&&(_.queue[B].timeout=setTimeout(function(){delete _.queue[B],W(new Error("reply timeout"))},T))})})}},{key:"login",value:function(){var E=(0,n.default)(t.default.mark(function K(T){var b;return t.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,this.call("rpc.login",T);case 2:if(b=R.sent,b){R.next=5;break}throw new Error("authentication failed");case 5:return R.abrupt("return",b);case 6:case"end":return R.stop()}},K,this)}));function P(K){return E.apply(this,arguments)}return P}()},{key:"listMethods",value:function(){var E=(0,n.default)(t.default.mark(function K(){return t.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.call("__listMethods");case 2:return b.abrupt("return",b.sent);case 3:case"end":return b.stop()}},K,this)}));function P(){return E.apply(this,arguments)}return P}()},{key:"notify",value:function(P,K){var T=this;return new Promise(function(b,_){if(!T.ready)return _(new Error("socket not ready"));var R={jsonrpc:"2.0",method:P,params:K||null};T.socket.send(JSON.stringify(R),function(W){if(W)return _(W);b()})})}},{key:"subscribe",value:function(){var E=(0,n.default)(t.default.mark(function K(T){var b;return t.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return typeof T=="string"&&(T=[T]),R.next=3,this.call("rpc.on",T);case 3:if(b=R.sent,!(typeof T=="string"&&b[T]!=="ok")){R.next=6;break}throw new Error("Failed subscribing to an event '"+T+"' with: "+b[T]);case 6:return R.abrupt("return",b);case 7:case"end":return R.stop()}},K,this)}));function P(K){return E.apply(this,arguments)}return P}()},{key:"unsubscribe",value:function(){var E=(0,n.default)(t.default.mark(function K(T){var b;return t.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return typeof T=="string"&&(T=[T]),R.next=3,this.call("rpc.off",T);case 3:if(b=R.sent,!(typeof T=="string"&&b[T]!=="ok")){R.next=6;break}throw new Error("Failed unsubscribing from an event with: "+b);case 6:return R.abrupt("return",b);case 7:case"end":return R.stop()}},K,this)}));function P(K){return E.apply(this,arguments)}return P}()},{key:"close",value:function(P,K){this.socket.close(P||1e3,K)}},{key:"_connect",value:function(P,K){var T=this;clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(P,K),this.socket.addEventListener("open",function(){T.ready=!0,T.emit("open"),T.current_reconnects=0}),this.socket.addEventListener("message",function(b){var _=b.data;_ instanceof ArrayBuffer&&(_=ge.Buffer.from(_).toString());try{_=JSON.parse(_)}catch{return}if(_.notification&&T.listeners(_.notification).length){if(!Object.keys(_.params).length)return T.emit(_.notification);var R=[_.notification];if(_.params.constructor===Object)R.push(_.params);else for(var W=0;W<_.params.length;W++)R.push(_.params[W]);return Promise.resolve().then(function(){T.emit.apply(T,R)})}if(!T.queue[_.id])return _.method&&_.params?Promise.resolve().then(function(){T.emit(_.method,_.params)}):void 0;"error"in _=="result"in _&&T.queue[_.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),T.queue[_.id].timeout&&clearTimeout(T.queue[_.id].timeout),_.error?T.queue[_.id].promise[1](_.error):T.queue[_.id].promise[0](_.result),delete T.queue[_.id]}),this.socket.addEventListener("error",function(b){return T.emit("error",b)}),this.socket.addEventListener("close",function(b){var _=b.code,R=b.reason;T.ready&&setTimeout(function(){return T.emit("close",_,R)},0),T.ready=!1,T.socket=void 0,_!==1e3&&(T.current_reconnects++,T.reconnect&&(T.max_reconnects>T.current_reconnects||T.max_reconnects===0)&&(T.reconnect_timer_id=setTimeout(function(){return T._connect(P,K)},T.reconnect_interval)))})}}]),v}(u.EventEmitter);r.default=S})(ey);var Fw=Fc(ey),ty={};(function(r){var e=Vc.exports;Object.defineProperty(r,"__esModule",{value:!0}),r.default=f;var t=e(Nc.exports),n=e(Dc.exports),i=e($c.exports),s=e(zc.exports),o=e(Wc.exports),a=Uc.exports;function c(m){var y=l();return function(){var p=(0,o.default)(m),w;if(y){var v=(0,o.default)(this).constructor;w=Reflect.construct(p,arguments,v)}else w=p.apply(this,arguments);return(0,s.default)(this,w)}}function l(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var u=function(m){(0,i.default)(S,m);var y=c(S);function S(p,w,v){var E;return(0,t.default)(this,S),E=y.call(this),E.socket=new window.WebSocket(p,v),E.socket.onopen=function(){return E.emit("open")},E.socket.onmessage=function(P){return E.emit("message",P.data)},E.socket.onerror=function(P){return E.emit("error",P)},E.socket.onclose=function(P){E.emit("close",P.code,P.reason)},E}return(0,n.default)(S,[{key:"send",value:function(w,v,E){var P=E||v;try{this.socket.send(w),P()}catch(K){P(K)}}},{key:"close",value:function(w,v){this.socket.close(w,v)}},{key:"addEventListener",value:function(w,v,E){this.socket.addEventListener(w,v,E)}}]),S}(a.EventEmitter);function f(m,y){return new u(m,y)}})(ty);var jw=Fc(ty);const qw=Gt.utils.randomPrivateKey,th=()=>{const r=Gt.utils.randomPrivateKey(),e=dc(r),t=new Uint8Array(64);return t.set(r),t.set(e,32),{publicKey:e,secretKey:t}},dc=Gt.getPublicKey;function nh(r){try{return Gt.ExtendedPoint.fromHex(r),!0}catch{return!1}}const Ld=(r,e)=>Gt.sign(r,e.slice(0,32)),Gw=Gt.verify,Re=r=>L.Buffer.isBuffer(r)?r:r instanceof Uint8Array?L.Buffer.from(r.buffer,r.byteOffset,r.byteLength):L.Buffer.from(r);class Kd{constructor(e){Object.assign(this,e)}encode(){return L.Buffer.from(Rd(Io,this))}static decode(e){return Td(Io,this,e)}static decodeUnchecked(e){return Od(Io,this,e)}}class Hw extends Kd{constructor(e){if(super(e),this.enum="",Object.keys(e).length!==1)throw new Error("Enum can only take single value");Object.keys(e).map(t=>{this.enum=t})}}const Io=new Map;var ny;let ry;const iy=32,On=32;function Yw(r){return r._bn!==void 0}let rh=1;ry=Symbol.toStringTag;class Y extends Kd{constructor(e){if(super({}),this._bn=void 0,Yw(e))this._bn=e._bn;else{if(typeof e=="string"){const t=pe.decode(e);if(t.length!=On)throw new Error("Invalid public key input");this._bn=new Qn(t)}else this._bn=new Qn(e);if(this._bn.byteLength()>On)throw new Error("Invalid public key input")}}static unique(){const e=new Y(rh);return rh+=1,new Y(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return pe.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(L.Buffer);if(e.length===On)return e;const t=L.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[ry](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,n){const i=L.Buffer.concat([e.toBuffer(),L.Buffer.from(t),n.toBuffer()]),s=Ps(i);return new Y(s)}static createProgramAddressSync(e,t){let n=L.Buffer.alloc(0);e.forEach(function(s){if(s.length>iy)throw new TypeError("Max seed length exceeded");n=L.Buffer.concat([n,Re(s)])}),n=L.Buffer.concat([n,t.toBuffer(),L.Buffer.from("ProgramDerivedAddress")]);const i=Ps(n);if(nh(i))throw new Error("Invalid seeds, address must fall off the curve");return new Y(i)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let n=255,i;for(;n!=0;){try{const s=e.concat(L.Buffer.from([n]));i=this.createProgramAddressSync(s,t)}catch(s){if(s instanceof TypeError)throw s;n--;continue}return[i,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new Y(e);return nh(t.toBytes())}}ny=Y;Y.default=new ny("11111111111111111111111111111111");Io.set(Y,{kind:"struct",fields:[["_bn","u256"]]});class Jw{constructor(e){if(this._publicKey=void 0,this._secretKey=void 0,e){const t=Re(e);if(e.length!==64)throw new Error("bad secret key size");this._publicKey=t.slice(32,64),this._secretKey=t.slice(0,32)}else this._secretKey=Re(qw()),this._publicKey=Re(dc(this._secretKey))}get publicKey(){return new Y(this._publicKey)}get secretKey(){return L.Buffer.concat([this._secretKey,this._publicKey],64)}}const Qw=new Y("BPFLoader1111111111111111111111111111111111"),Hr=1280-40-8,Gc=127,Rs=64;class Nd extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Nd.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class Dd extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Dd.prototype,"name",{value:"TransactionExpiredTimeoutError"});class ls extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(ls.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class Do{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const n=new Map;this.keySegments().flat().forEach((s,o)=>{n.set(s.toBase58(),o)});const i=s=>{const o=n.get(s.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(s=>({programIdIndex:i(s.programId),accountKeyIndexes:s.keys.map(o=>i(o.pubkey)),data:s.data}))}}const xe=(r="publicKey")=>he(32,r),Xw=(r="signature")=>he(64,r),bi=(r="string")=>{const e=C([M("length"),M("lengthPadding"),he(Pt(M(),-8),"chars")],r),t=e.decode.bind(e),n=e.encode.bind(e),i=e;return i.decode=(s,o)=>t(s,o).chars.toString(),i.encode=(s,o,a)=>{const c={chars:L.Buffer.from(s,"utf8")};return n(c,o,a)},i.alloc=s=>M().span+M().span+L.Buffer.from(s,"utf8").length,i},Zw=(r="authorized")=>C([xe("staker"),xe("withdrawer")],r),ek=(r="lockup")=>C([Me("unixTimestamp"),Me("epoch"),xe("custodian")],r),tk=(r="voteInit")=>C([xe("nodePubkey"),xe("authorizedVoter"),xe("authorizedWithdrawer"),ee("commission")],r),nk=(r="voteAuthorizeWithSeedArgs")=>C([M("voteAuthorizationType"),xe("currentAuthorityDerivedKeyOwnerPubkey"),bi("currentAuthorityDerivedKeySeed"),xe("newAuthorized")],r);function sy(r,e){const t=i=>{if(i.span>=0)return i.span;if(typeof i.alloc=="function")return i.alloc(e[i.property]);if("count"in i&&"elementLayout"in i){const s=e[i.property];if(Array.isArray(s))return s.length*t(i.elementLayout)}else if("fields"in i)return sy({layout:i},e[i.property]);return 0};let n=0;return r.layout.fields.forEach(i=>{n+=t(i)}),n}function hn(r){let e=0,t=0;for(;;){let n=r.shift();if(e|=(n&127)<<t*7,t+=1,(n&128)===0)break}return e}function En(r,e){let t=e;for(;;){let n=t&127;if(t>>=7,t==0){r.push(n);break}else n|=128,r.push(n)}}function We(r,e){if(!r)throw new Error(e||"Assertion failed")}class Hc{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const n=new Map,i=o=>{const a=o.toBase58();let c=n.get(a);return c===void 0&&(c={isSigner:!1,isWritable:!1,isInvoked:!1},n.set(a,c)),c},s=i(t);s.isSigner=!0,s.isWritable=!0;for(const o of e){i(o.programId).isInvoked=!0;for(const a of o.keys){const c=i(a.pubkey);c.isSigner||=a.isSigner,c.isWritable||=a.isWritable}}return new Hc(t,n)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];We(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,c])=>c.isSigner&&c.isWritable),n=e.filter(([,c])=>c.isSigner&&!c.isWritable),i=e.filter(([,c])=>!c.isSigner&&c.isWritable),s=e.filter(([,c])=>!c.isSigner&&!c.isWritable),o={numRequiredSignatures:t.length+n.length,numReadonlySignedAccounts:n.length,numReadonlyUnsignedAccounts:s.length};{We(t.length>0,"Expected at least one writable signer key");const[c]=t[0];We(c===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...t.map(([c])=>new Y(c)),...n.map(([c])=>new Y(c)),...i.map(([c])=>new Y(c)),...s.map(([c])=>new Y(c))];return[o,a]}extractTableLookup(e){const[t,n]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[i,s]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&i.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:i},{writable:n,readonly:s}]}drainKeysFoundInLookupTable(e,t){const n=new Array,i=new Array;for(const[s,o]of this.keyMetaMap.entries())if(t(o)){const a=new Y(s),c=e.findIndex(l=>l.equals(a));c>=0&&(We(c<256,"Max lookup table index exceeded"),n.push(c),i.push(a),this.keyMetaMap.delete(s))}return[n,i]}}class Zn{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new Y(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:pe.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new Do(this.staticAccountKeys)}static compile(e){const t=Hc.compile(e.instructions,e.payerKey),[n,i]=t.getMessageComponents(),o=new Do(i).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:pe.encode(a.data)}));return new Zn({header:n,accountKeys:i,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const n=e-t,s=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return n<s}else{const n=t-this.header.numReadonlySignedAccounts;return e<n}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];En(t,e);const n=this.instructions.map(f=>{const{accounts:m,programIdIndex:y}=f,S=Array.from(pe.decode(f.data));let p=[];En(p,m.length);let w=[];return En(w,S.length),{programIdIndex:y,keyIndicesCount:L.Buffer.from(p),keyIndices:m,dataLength:L.Buffer.from(w),data:S}});let i=[];En(i,n.length);let s=L.Buffer.alloc(Hr);L.Buffer.from(i).copy(s);let o=i.length;n.forEach(f=>{o+=C([ee("programIdIndex"),he(f.keyIndicesCount.length,"keyIndicesCount"),Ie(ee("keyIndex"),f.keyIndices.length,"keyIndices"),he(f.dataLength.length,"dataLength"),Ie(ee("userdatum"),f.data.length,"data")]).encode(f,s,o)}),s=s.slice(0,o);const a=C([he(1,"numRequiredSignatures"),he(1,"numReadonlySignedAccounts"),he(1,"numReadonlyUnsignedAccounts"),he(t.length,"keyCount"),Ie(xe("key"),e,"keys"),xe("recentBlockhash")]),c={numRequiredSignatures:L.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:L.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:L.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:L.Buffer.from(t),keys:this.accountKeys.map(f=>Re(f.toBytes())),recentBlockhash:pe.decode(this.recentBlockhash)};let l=L.Buffer.alloc(2048);const u=a.encode(c,l);return s.copy(l,u),l.slice(0,u+s.length)}static from(e){let t=[...e];const n=t.shift();if(n!==(n&Gc))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const i=t.shift(),s=t.shift(),o=hn(t);let a=[];for(let m=0;m<o;m++){const y=t.slice(0,On);t=t.slice(On),a.push(new Y(L.Buffer.from(y)))}const c=t.slice(0,On);t=t.slice(On);const l=hn(t);let u=[];for(let m=0;m<l;m++){const y=t.shift(),S=hn(t),p=t.slice(0,S);t=t.slice(S);const w=hn(t),v=t.slice(0,w),E=pe.encode(L.Buffer.from(v));t=t.slice(w),u.push({programIdIndex:y,accounts:p,data:E})}const f={header:{numRequiredSignatures:n,numReadonlySignedAccounts:i,numReadonlyUnsignedAccounts:s},recentBlockhash:pe.encode(L.Buffer.from(c)),accountKeys:a,instructions:u};return new Zn(f)}}class Pi{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new Do(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,n=this.staticAccountKeys.length;if(e>=n){const i=e-n,s=this.addressTableLookups.reduce((o,a)=>o+a.writableIndexes.length,0);return i<s}else if(e>=this.header.numRequiredSignatures){const i=e-t,o=n-t-this.header.numReadonlyUnsignedAccounts;return i<o}else{const i=t-this.header.numReadonlySignedAccounts;return e<i}}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const n of this.addressTableLookups){const i=e.find(s=>s.key.equals(n.accountKey));if(!i)throw new Error(`Failed to find address lookup table account for table key ${n.accountKey.toBase58()}`);for(const s of n.writableIndexes)if(s<i.state.addresses.length)t.writable.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${n.accountKey.toBase58()}`);for(const s of n.readonlyIndexes)if(s<i.state.addresses.length)t.readonly.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${n.accountKey.toBase58()}`)}return t}static compile(e){const t=Hc.compile(e.instructions,e.payerKey),n=new Array,i={writable:new Array,readonly:new Array},s=e.addressLookupTableAccounts||[];for(const u of s){const f=t.extractTableLookup(u);if(f!==void 0){const[m,{writable:y,readonly:S}]=f;n.push(m),i.writable.push(...y),i.readonly.push(...S)}}const[o,a]=t.getMessageComponents(),l=new Do(a,i).compileInstructions(e.instructions);return new Pi({header:o,staticAccountKeys:a,recentBlockhash:e.recentBlockhash,compiledInstructions:l,addressTableLookups:n})}serialize(){const e=Array();En(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),n=Array();En(n,this.compiledInstructions.length);const i=this.serializeAddressTableLookups(),s=Array();En(s,this.addressTableLookups.length);const o=C([ee("prefix"),C([ee("numRequiredSignatures"),ee("numReadonlySignedAccounts"),ee("numReadonlyUnsignedAccounts")],"header"),he(e.length,"staticAccountKeysLength"),Ie(xe(),this.staticAccountKeys.length,"staticAccountKeys"),xe("recentBlockhash"),he(n.length,"instructionsLength"),he(t.length,"serializedInstructions"),he(s.length,"addressTableLookupsLength"),he(i.length,"serializedAddressTableLookups")]),a=new Uint8Array(Hr),c=1<<7,l=o.encode({prefix:c,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(u=>u.toBytes()),recentBlockhash:pe.decode(this.recentBlockhash),instructionsLength:new Uint8Array(n),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(s),serializedAddressTableLookups:i},a);return a.slice(0,l)}serializeInstructions(){let e=0;const t=new Uint8Array(Hr);for(const n of this.compiledInstructions){const i=Array();En(i,n.accountKeyIndexes.length);const s=Array();En(s,n.data.length),e+=C([ee("programIdIndex"),he(i.length,"encodedAccountKeyIndexesLength"),Ie(ee(),n.accountKeyIndexes.length,"accountKeyIndexes"),he(s.length,"encodedDataLength"),he(n.data.length,"data")]).encode({programIdIndex:n.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(i),accountKeyIndexes:n.accountKeyIndexes,encodedDataLength:new Uint8Array(s),data:n.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(Hr);for(const n of this.addressTableLookups){const i=Array();En(i,n.writableIndexes.length);const s=Array();En(s,n.readonlyIndexes.length),e+=C([xe("accountKey"),he(i.length,"encodedWritableIndexesLength"),Ie(ee(),n.writableIndexes.length,"writableIndexes"),he(s.length,"encodedReadonlyIndexesLength"),Ie(ee(),n.readonlyIndexes.length,"readonlyIndexes")]).encode({accountKey:n.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(i),writableIndexes:n.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(s),readonlyIndexes:n.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const n=t.shift(),i=n&Gc;We(n!==i,"Expected versioned message but received legacy message");const s=i;We(s===0,`Expected versioned message with version 0 but found version ${s}`);const o={numRequiredSignatures:t.shift(),numReadonlySignedAccounts:t.shift(),numReadonlyUnsignedAccounts:t.shift()},a=[],c=hn(t);for(let S=0;S<c;S++)a.push(new Y(t.splice(0,On)));const l=pe.encode(t.splice(0,On)),u=hn(t),f=[];for(let S=0;S<u;S++){const p=t.shift(),w=hn(t),v=t.splice(0,w),E=hn(t),P=new Uint8Array(t.splice(0,E));f.push({programIdIndex:p,accountKeyIndexes:v,data:P})}const m=hn(t),y=[];for(let S=0;S<m;S++){const p=new Y(t.splice(0,On)),w=hn(t),v=t.splice(0,w),E=hn(t),P=t.splice(0,E);y.push({accountKey:p,writableIndexes:v,readonlyIndexes:P})}return new Pi({header:o,staticAccountKeys:a,recentBlockhash:l,compiledInstructions:f,addressTableLookups:y})}}const $d={deserializeMessageVersion(r){const e=r[0],t=e&Gc;return t===e?"legacy":t},deserialize:r=>{const e=$d.deserializeMessageVersion(r);if(e==="legacy")return Zn.from(r);if(e===0)return Pi.deserialize(r);throw new Error(`Transaction message version ${e} deserialization is not supported`)}};let Ir=function(r){return r[r.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",r[r.PROCESSED=1]="PROCESSED",r[r.TIMED_OUT=2]="TIMED_OUT",r[r.NONCE_INVALID=3]="NONCE_INVALID",r}({});const rk=L.Buffer.alloc(Rs).fill(0);class Qe{constructor(e){this.keys=void 0,this.programId=void 0,this.data=L.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:n})=>({pubkey:e.toJSON(),isSigner:t,isWritable:n})),programId:this.programId.toJSON(),data:[...this.data]}}}class ze{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:n}=e;this.minNonceContextSlot=t,this.nonceInfo=n}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:n}=e;this.recentBlockhash=t,this.lastValidBlockHeight=n}else{const{recentBlockhash:t,nonceInfo:n}=e;n&&(this.nonceInfo=n),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new Qe(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let n;if(this.feePayer)n=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)n=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let p=0;p<t.length;p++)if(t[p].programId===void 0)throw new Error(`Transaction instruction index ${p} has undefined program id`);const i=[],s=[];t.forEach(p=>{p.keys.forEach(v=>{s.push({...v})});const w=p.programId.toString();i.includes(w)||i.push(w)}),i.forEach(p=>{s.push({pubkey:new Y(p),isSigner:!1,isWritable:!1})});const o=[];s.forEach(p=>{const w=p.pubkey.toString(),v=o.findIndex(E=>E.pubkey.toString()===w);v>-1?(o[v].isWritable=o[v].isWritable||p.isWritable,o[v].isSigner=o[v].isSigner||p.isSigner):o.push(p)}),o.sort(function(p,w){if(p.isSigner!==w.isSigner)return p.isSigner?-1:1;if(p.isWritable!==w.isWritable)return p.isWritable?-1:1;const v={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return p.pubkey.toBase58().localeCompare(w.pubkey.toBase58(),"en",v)});const a=o.findIndex(p=>p.pubkey.equals(n));if(a>-1){const[p]=o.splice(a,1);p.isSigner=!0,p.isWritable=!0,o.unshift(p)}else o.unshift({pubkey:n,isSigner:!0,isWritable:!0});for(const p of this.signatures){const w=o.findIndex(v=>v.pubkey.equals(p.publicKey));if(w>-1)o[w].isSigner||(o[w].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${p.publicKey.toString()}`)}let c=0,l=0,u=0;const f=[],m=[];o.forEach(({pubkey:p,isSigner:w,isWritable:v})=>{w?(f.push(p.toString()),c+=1,v||(l+=1)):(m.push(p.toString()),v||(u+=1))});const y=f.concat(m),S=t.map(p=>{const{data:w,programId:v}=p;return{programIdIndex:y.indexOf(v.toString()),accounts:p.keys.map(E=>y.indexOf(E.pubkey.toString())),data:pe.encode(w)}});return S.forEach(p=>{We(p.programIdIndex>=0),p.accounts.forEach(w=>We(w>=0))}),new Zn({header:{numRequiredSignatures:c,numReadonlySignedAccounts:l,numReadonlyUnsignedAccounts:u},accountKeys:y,recentBlockhash:e,instructions:S})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((i,s)=>t[s].equals(i.publicKey))||(this.signatures=t.map(n=>({signature:null,publicKey:n}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(n=>{const i=n.toString();return t.has(i)?!1:(t.add(i),!0)}).map(n=>({signature:null,publicKey:n}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}this.signatures=n.map(s=>({signature:null,publicKey:s.publicKey}));const i=this._compile();this._partialSign(i,...n)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}const i=this._compile();this._partialSign(i,...n)}_partialSign(e,...t){const n=e.serialize();t.forEach(i=>{const s=Ld(n,i.secretKey);this._addSignature(i.publicKey,Re(s))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){We(t.length===64);const n=this.signatures.findIndex(i=>e.equals(i.publicKey));if(n<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[n].signature=L.Buffer.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:n,publicKey:i}of this.signatures)if(n===null){if(t)return!1}else if(!Gw(n,e,i.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:n}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),i=this.serializeMessage();if(n&&!this._verifySignatures(i,t))throw new Error("Signature verification failed");return this._serialize(i)}_serialize(e){const{signatures:t}=this,n=[];En(n,t.length);const i=n.length+t.length*64+e.length,s=L.Buffer.alloc(i);return We(t.length<256),L.Buffer.from(n).copy(s,0),t.forEach(({signature:o},a)=>{o!==null&&(We(o.length===64,"signature has invalid length"),L.Buffer.from(o).copy(s,n.length+a*64))}),e.copy(s,n.length+t.length*64),We(s.length<=Hr,`Transaction too large: ${s.length} > ${Hr}`),s}get keys(){return We(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return We(this.instructions.length===1),this.instructions[0].programId}get data(){return We(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const n=hn(t);let i=[];for(let s=0;s<n;s++){const o=t.slice(0,Rs);t=t.slice(Rs),i.push(pe.encode(L.Buffer.from(o)))}return ze.populate(Zn.from(t),i)}static populate(e,t=[]){const n=new ze;return n.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(n.feePayer=e.accountKeys[0]),t.forEach((i,s)=>{const o={signature:i==pe.encode(rk)?null:pe.decode(i),publicKey:e.accountKeys[s]};n.signatures.push(o)}),e.instructions.forEach(i=>{const s=i.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:n.signatures.some(c=>c.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});n.instructions.push(new Qe({keys:s,programId:e.accountKeys[i.programIdIndex],data:pe.decode(i.data)}))}),n._message=e,n._json=n.toJSON(),n}}class zd{constructor(e){this.payerKey=void 0,this.instructions=void 0,this.recentBlockhash=void 0,this.payerKey=e.payerKey,this.instructions=e.instructions,this.recentBlockhash=e.recentBlockhash}static decompile(e,t){const{header:n,compiledInstructions:i,recentBlockhash:s}=e,{numRequiredSignatures:o,numReadonlySignedAccounts:a,numReadonlyUnsignedAccounts:c}=n,l=o-a;We(l>0,"Message header is invalid");const u=e.staticAccountKeys.length-o-c;We(u>=0,"Message header is invalid");const f=e.getAccountKeys(t),m=f.get(0);if(m===void 0)throw new Error("Failed to decompile message because no account keys were found");const y=[];for(const S of i){const p=[];for(const v of S.accountKeyIndexes){const E=f.get(v);if(E===void 0)throw new Error(`Failed to find key for account key index ${v}`);const P=v<o;let K;P?K=v<l:v<f.staticAccountKeys.length?K=v-o<u:K=v-f.staticAccountKeys.length<f.accountKeysFromLookups.writable.length,p.push({pubkey:E,isSigner:v<n.numRequiredSignatures,isWritable:K})}const w=f.get(S.programIdIndex);if(w===void 0)throw new Error(`Failed to find program id for program id index ${S.programIdIndex}`);y.push(new Qe({programId:w,data:Re(S.data),keys:p}))}return new zd({payerKey:m,instructions:y,recentBlockhash:s})}compileToLegacyMessage(){return Zn.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions})}compileToV0Message(e){return Pi.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions,addressLookupTableAccounts:e})}}class Wd{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,t!==void 0)We(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{const n=[];for(let i=0;i<e.header.numRequiredSignatures;i++)n.push(new Uint8Array(Rs));this.signatures=n}this.message=e}serialize(){const e=this.message.serialize(),t=Array();En(t,this.signatures.length);const n=C([he(t.length,"encodedSignaturesLength"),Ie(Xw(),this.signatures.length,"signatures"),he(e.length,"serializedMessage")]),i=new Uint8Array(2048),s=n.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},i);return i.slice(0,s)}static deserialize(e){let t=[...e];const n=[],i=hn(t);for(let o=0;o<i;o++)n.push(new Uint8Array(t.splice(0,Rs)));const s=$d.deserialize(new Uint8Array(t));return new Wd(s,n)}sign(e){const t=this.message.serialize(),n=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const i of e){const s=n.findIndex(o=>o.equals(i.publicKey));We(s>=0,`Cannot sign with non signer key ${i.publicKey.toBase58()}`),this.signatures[s]=Ld(t,i.secretKey)}}addSignature(e,t){We(t.byteLength===64,"Signature must be 64 bytes long");const i=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(s=>s.equals(e));We(i>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[i]=t}}const ik=160,sk=64,ok=ik/sk,oy=1e3/ok,cr=new Y("SysvarC1ock11111111111111111111111111111111"),ak=new Y("SysvarEpochSchedu1e111111111111111111111111"),ck=new Y("Sysvar1nstructions1111111111111111111111111"),Ja=new Y("SysvarRecentB1ockHashes11111111111111111111"),Ri=new Y("SysvarRent111111111111111111111111111111111"),uk=new Y("SysvarRewards111111111111111111111111111111"),lk=new Y("SysvarS1otHashes111111111111111111111111111"),dk=new Y("SysvarS1otHistory11111111111111111111111111"),Qa=new Y("SysvarStakeHistory1111111111111111111111111");async function Fl(r,e,t,n){const i=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot},s=await r.sendTransaction(e,t,i);let o;if(e.recentBlockhash!=null&&e.lastValidBlockHeight!=null)o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,signature:s,blockhash:e.recentBlockhash,lastValidBlockHeight:e.lastValidBlockHeight},n&&n.commitment)).value;else if(e.minNonceContextSlot!=null&&e.nonceInfo!=null){const{nonceInstruction:a}=e.nonceInfo,c=a.keys[0].pubkey;o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,minContextSlot:e.minNonceContextSlot,nonceAccountPubkey:c,nonceValue:e.nonceInfo.nonce,signature:s},n&&n.commitment)).value}else(n==null?void 0:n.abortSignal)!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),o=(await r.confirmTransaction(s,n&&n.commitment)).value;if(o.err)throw new Error(`Transaction ${s} failed (${JSON.stringify(o)})`);return s}function gi(r){return new Promise(e=>setTimeout(e,r))}function Le(r,e){const t=r.layout.span>=0?r.layout.span:sy(r,e),n=L.Buffer.alloc(t),i=Object.assign({instruction:r.index},e);return r.layout.encode(i,n),n}function He(r,e){let t;try{t=r.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.instruction!==r.index)throw new Error(`invalid instruction; instruction index mismatch ${t.instruction} != ${r.index}`);return t}const ay=we("lamportsPerSignature"),cy=C([M("version"),M("state"),xe("authorizedPubkey"),xe("nonce"),C([ay],"feeCalculator")]),jl=cy.span;class Yc{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=cy.decode(Re(e),0);return new Yc({authorizedPubkey:new Y(t.authorizedPubkey),nonce:new Y(t.nonce).toString(),feeCalculator:t.feeCalculator})}}const fk=r=>{const e=r.decode.bind(r),t=r.encode.bind(r);return{decode:e,encode:t}},hk=r=>e=>{const t=he(r,e),{encode:n,decode:i}=fk(t),s=t;return s.decode=(o,a)=>{const c=i(o,a);return Bd(L.Buffer.from(c))},s.encode=(o,a,c)=>{const l=ta(o,r);return n(l,a,c)},s},Ts=hk(8);class pk{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(it))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a SystemInstruction");return i}static decodeCreateAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t,space:n,programId:i}=He(it.Create,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,lamports:t,space:n,programId:new Y(i)}}static decodeTransfer(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t}=He(it.Transfer,e.data);return{fromPubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,lamports:t}}static decodeTransferWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t,seed:n,programId:i}=He(it.TransferWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,basePubkey:e.keys[1].pubkey,toPubkey:e.keys[2].pubkey,lamports:t,seed:n,programId:new Y(i)}}static decodeAllocate(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{space:t}=He(it.Allocate,e.data);return{accountPubkey:e.keys[0].pubkey,space:t}}static decodeAllocateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:n,space:i,programId:s}=He(it.AllocateWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new Y(t),seed:n,space:i,programId:new Y(s)}}static decodeAssign(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{programId:t}=He(it.Assign,e.data);return{accountPubkey:e.keys[0].pubkey,programId:new Y(t)}}static decodeAssignWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:n,programId:i}=He(it.AssignWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new Y(t),seed:n,programId:new Y(i)}}static decodeCreateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{base:t,seed:n,lamports:i,space:s,programId:o}=He(it.CreateWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,basePubkey:new Y(t),seed:n,lamports:i,space:s,programId:new Y(o)}}static decodeNonceInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{authorized:t}=He(it.InitializeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:new Y(t)}}static decodeNonceAdvance(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),He(it.AdvanceNonceAccount,e.data),{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static decodeNonceWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=He(it.WithdrawNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t}}static decodeNonceAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t}=He(it.AuthorizeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[1].pubkey,newAuthorizedPubkey:new Y(t)}}static checkProgramId(e){if(!e.equals(Et.programId))throw new Error("invalid instruction; programId is not SystemProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const it=Object.freeze({Create:{index:0,layout:C([M("instruction"),Me("lamports"),Me("space"),xe("programId")])},Assign:{index:1,layout:C([M("instruction"),xe("programId")])},Transfer:{index:2,layout:C([M("instruction"),Ts("lamports")])},CreateWithSeed:{index:3,layout:C([M("instruction"),xe("base"),bi("seed"),Me("lamports"),Me("space"),xe("programId")])},AdvanceNonceAccount:{index:4,layout:C([M("instruction")])},WithdrawNonceAccount:{index:5,layout:C([M("instruction"),Me("lamports")])},InitializeNonceAccount:{index:6,layout:C([M("instruction"),xe("authorized")])},AuthorizeNonceAccount:{index:7,layout:C([M("instruction"),xe("authorized")])},Allocate:{index:8,layout:C([M("instruction"),Me("space")])},AllocateWithSeed:{index:9,layout:C([M("instruction"),xe("base"),bi("seed"),Me("space"),xe("programId")])},AssignWithSeed:{index:10,layout:C([M("instruction"),xe("base"),bi("seed"),xe("programId")])},TransferWithSeed:{index:11,layout:C([M("instruction"),Ts("lamports"),bi("seed"),xe("programId")])},UpgradeNonceAccount:{index:12,layout:C([M("instruction")])}});class Et{constructor(){}static createAccount(e){const t=it.Create,n=Le(t,{lamports:e.lamports,space:e.space,programId:Re(e.programId.toBuffer())});return new Qe({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:n})}static transfer(e){let t,n;if("basePubkey"in e){const i=it.TransferWithSeed;t=Le(i,{lamports:BigInt(e.lamports),seed:e.seed,programId:Re(e.programId.toBuffer())}),n=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}else{const i=it.Transfer;t=Le(i,{lamports:BigInt(e.lamports)}),n=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}return new Qe({keys:n,programId:this.programId,data:t})}static assign(e){let t,n;if("basePubkey"in e){const i=it.AssignWithSeed;t=Le(i,{base:Re(e.basePubkey.toBuffer()),seed:e.seed,programId:Re(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=it.Assign;t=Le(i,{programId:Re(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new Qe({keys:n,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=it.CreateWithSeed,n=Le(t,{base:Re(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:Re(e.programId.toBuffer())});let i=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey!=e.fromPubkey&&i.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new Qe({keys:i,programId:this.programId,data:n})}static createNonceAccount(e){const t=new ze;"basePubkey"in e&&"seed"in e?t.add(Et.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:jl,programId:this.programId})):t.add(Et.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:jl,programId:this.programId}));const n={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(n)),t}static nonceInitialize(e){const t=it.InitializeNonceAccount,n=Le(t,{authorized:Re(e.authorizedPubkey.toBuffer())}),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Ja,isSigner:!1,isWritable:!1},{pubkey:Ri,isSigner:!1,isWritable:!1}],programId:this.programId,data:n};return new Qe(i)}static nonceAdvance(e){const t=it.AdvanceNonceAccount,n=Le(t),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Ja,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n};return new Qe(i)}static nonceWithdraw(e){const t=it.WithdrawNonceAccount,n=Le(t,{lamports:e.lamports});return new Qe({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:Ja,isSigner:!1,isWritable:!1},{pubkey:Ri,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static nonceAuthorize(e){const t=it.AuthorizeNonceAccount,n=Le(t,{authorized:Re(e.newAuthorizedPubkey.toBuffer())});return new Qe({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static allocate(e){let t,n;if("basePubkey"in e){const i=it.AllocateWithSeed;t=Le(i,{base:Re(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:Re(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=it.Allocate;t=Le(i,{space:e.space}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new Qe({keys:n,programId:this.programId,data:t})}}Et.programId=new Y("11111111111111111111111111111111");const yk=Hr-300;class Ti{constructor(){}static getMinNumSignatures(e){return 2*(Math.ceil(e/Ti.chunkSize)+1+1)}static async load(e,t,n,i,s){{const f=await e.getMinimumBalanceForRentExemption(s.length),m=await e.getAccountInfo(n.publicKey,"confirmed");let y=null;if(m!==null){if(m.executable)return console.error("Program load failed, account is already executable"),!1;m.data.length!==s.length&&(y=y||new ze,y.add(Et.allocate({accountPubkey:n.publicKey,space:s.length}))),m.owner.equals(i)||(y=y||new ze,y.add(Et.assign({accountPubkey:n.publicKey,programId:i}))),m.lamports<f&&(y=y||new ze,y.add(Et.transfer({fromPubkey:t.publicKey,toPubkey:n.publicKey,lamports:f-m.lamports})))}else y=new ze().add(Et.createAccount({fromPubkey:t.publicKey,newAccountPubkey:n.publicKey,lamports:f>0?f:1,space:s.length,programId:i}));y!==null&&await Fl(e,y,[t,n],{commitment:"confirmed"})}const o=C([M("instruction"),M("offset"),M("bytesLength"),M("bytesLengthPadding"),Ie(ee("byte"),Pt(M(),-8),"bytes")]),a=Ti.chunkSize;let c=0,l=s,u=[];for(;l.length>0;){const f=l.slice(0,a),m=L.Buffer.alloc(a+16);o.encode({instruction:0,offset:c,bytes:f,bytesLength:0,bytesLengthPadding:0},m);const y=new ze().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0}],programId:i,data:m});u.push(Fl(e,y,[t,n],{commitment:"confirmed"})),e._rpcEndpoint.includes("solana.com")&&await gi(1e3/4),c+=a,l=l.slice(a)}await Promise.all(u);{const f=C([M("instruction")]),m=L.Buffer.alloc(f.span);f.encode({instruction:1},m);const y=new ze().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0},{pubkey:Ri,isSigner:!1,isWritable:!1}],programId:i,data:m}),S="processed",p=await e.sendTransaction(y,[t,n],{preflightCommitment:S}),{context:w,value:v}=await e.confirmTransaction({signature:p,lastValidBlockHeight:y.lastValidBlockHeight,blockhash:y.recentBlockhash},S);if(v.err)throw new Error(`Transaction ${p} failed (${JSON.stringify(v)})`);for(;;){try{if(await e.getSlot({commitment:S})>w.slot)break}catch{}await new Promise(E=>setTimeout(E,Math.round(oy/2)))}}return!0}}Ti.chunkSize=yk;const gk=new Y("BPFLoader2111111111111111111111111111111111");class mk{static getMinNumSignatures(e){return Ti.getMinNumSignatures(e)}static load(e,t,n,i,s){return Ti.load(e,t,n,s,i)}}function bk(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var wk=Object.prototype.toString,kk=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};function ko(r,e){var t,n,i,s,o,a,c;if(r===!0)return"true";if(r===!1)return"false";switch(typeof r){case"object":if(r===null)return null;if(r.toJSON&&typeof r.toJSON=="function")return ko(r.toJSON(),e);if(c=wk.call(r),c==="[object Array]"){for(i="[",n=r.length-1,t=0;t<n;t++)i+=ko(r[t],!0)+",";return n>-1&&(i+=ko(r[t],!0)),i+"]"}else if(c==="[object Object]"){for(s=kk(r).sort(),n=s.length,i="",t=0;t<n;)o=s[t],a=ko(r[o],!1),a!==void 0&&(i&&(i+=","),i+=JSON.stringify(o)+":"+a),t++;return"{"+i+"}"}else return JSON.stringify(r);case"function":case"undefined":return e?null:void 0;case"string":return JSON.stringify(r);default:return isFinite(r)?r:null}}var Sk=function(r){var e=ko(r,!1);if(e!==void 0)return""+e},ih=bk(Sk);const yo=32;function ll(r){let e=0;for(;r>1;)r/=2,e++;return e}function vk(r){return r===0?1:(r--,r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16,r|=r>>32,r+1)}class uy{constructor(e,t,n,i,s){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=n,this.firstNormalEpoch=i,this.firstNormalSlot=s}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const t=ll(vk(e+yo+1))-ll(yo)-1,n=this.getSlotsInEpoch(t),i=e-(n-yo);return[t,i]}else{const t=e-this.firstNormalSlot,n=Math.floor(t/this.slotsPerEpoch),i=this.firstNormalEpoch+n,s=t%this.slotsPerEpoch;return[i,s]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*yo:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+ll(yo)):this.slotsPerEpoch}}class $o extends Error{constructor(e,t){super(e),this.logs=void 0,this.logs=t}}const _k={JSON_RPC_SERVER_ERROR_BLOCK_CLEANED_UP:-32001,JSON_RPC_SERVER_ERROR_SEND_TRANSACTION_PREFLIGHT_FAILURE:-32002,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_VERIFICATION_FAILURE:-32003,JSON_RPC_SERVER_ERROR_BLOCK_NOT_AVAILABLE:-32004,JSON_RPC_SERVER_ERROR_NODE_UNHEALTHY:-32005,JSON_RPC_SERVER_ERROR_TRANSACTION_PRECOMPILE_VERIFICATION_FAILURE:-32006,JSON_RPC_SERVER_ERROR_SLOT_SKIPPED:-32007,JSON_RPC_SERVER_ERROR_NO_SNAPSHOT:-32008,JSON_RPC_SERVER_ERROR_LONG_TERM_STORAGE_SLOT_SKIPPED:-32009,JSON_RPC_SERVER_ERROR_KEY_EXCLUDED_FROM_SECONDARY_INDEX:-32010,JSON_RPC_SERVER_ERROR_TRANSACTION_HISTORY_NOT_AVAILABLE:-32011,JSON_RPC_SCAN_ERROR:-32012,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_LEN_MISMATCH:-32013,JSON_RPC_SERVER_ERROR_BLOCK_STATUS_NOT_AVAILABLE_YET:-32014,JSON_RPC_SERVER_ERROR_UNSUPPORTED_TRANSACTION_VERSION:-32015,JSON_RPC_SERVER_ERROR_MIN_CONTEXT_SLOT_NOT_REACHED:-32016};class le extends Error{constructor({code:e,message:t,data:n},i){super(i!=null?`${i}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=n,this.name="SolanaJSONRPCError"}}var Ak=globalThis.fetch;class Ik extends Fw{constructor(e,t,n){const i=s=>{const o=jw(s,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in o?this.underlyingSocket=o.socket:this.underlyingSocket=o,o};super(i,e,t,n),this.underlyingSocket=void 0}call(...e){var n;const t=(n=this.underlyingSocket)==null?void 0:n.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){var n;const t=(n=this.underlyingSocket)==null?void 0:n.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}function Ek(r,e){let t;try{t=r.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.typeIndex!==r.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${r.index}`);return t}const sh=56;class ql{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=Ek(Pk,e),n=e.length-sh;We(n>=0,"lookup table is invalid"),We(n%32===0,"lookup table is invalid");const i=n/32,{addresses:s}=C([Ie(xe(),i,"addresses")]).decode(e.slice(sh));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new Y(t.authority[0]):void 0,addresses:s.map(o=>new Y(o))}}}const Pk={index:1,layout:C([M("typeIndex"),Ts("deactivationSlot"),we("lastExtendedSlot"),ee("lastExtendedStartIndex"),ee(),Ie(xe(),Pt(ee(),-1),"authority")])},Rk=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function Tk(r){const e=r.match(Rk);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${r}\``);const[t,n,i,s]=e,o=r.startsWith("https:")?"wss:":"ws:",a=i==null?null:parseInt(i.slice(1),10),c=a==null?"":`:${a+1}`;return`${o}//${n}${c}${s}`}const Rt=ia(Cd(Y),ne(),r=>new Y(r)),ly=Md([ne(),gt("base64")]),Vd=ia(Cd(L.Buffer),ly,r=>L.Buffer.from(r[0],"base64")),dy=30*1e3;function Ok(r){if(/^https?:/.test(r)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return r}function ct(r){let e,t;if(typeof r=="string")e=r;else if(r){const{commitment:n,...i}=r;e=n,t=i}return{commitment:e,config:t}}function fy(r){return wn([J({jsonrpc:gt("2.0"),id:ne(),result:r}),J({jsonrpc:gt("2.0"),id:ne(),error:J({code:ra(),message:ne(),data:be(Kw())})})])}const Bk=fy(ra());function Ee(r){return ia(fy(r),Bk,e=>"error"in e?e:{...e,result:ie(e.result,r)})}function wt(r){return Ee(J({context:J({slot:D()}),value:r}))}function Jc(r){return J({context:J({slot:D()}),value:r})}function dl(r,e){return r===0?new Pi({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new Y(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:pe.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new Zn(e)}const xk=J({foundation:D(),foundationTerm:D(),initial:D(),taper:D(),terminal:D()}),Ck=Ee(se(oe(J({epoch:D(),effectiveSlot:D(),amount:D(),postBalance:D(),commission:be(oe(D()))})))),Mk=se(J({slot:D(),prioritizationFee:D()})),Lk=J({total:D(),validator:D(),foundation:D(),epoch:D()}),Kk=J({epoch:D(),slotIndex:D(),slotsInEpoch:D(),absoluteSlot:D(),blockHeight:be(D()),transactionCount:be(D())}),Nk=J({slotsPerEpoch:D(),leaderScheduleSlotOffset:D(),warmup:mr(),firstNormalEpoch:D(),firstNormalSlot:D()}),Dk=Zp(ne(),se(D())),Wi=oe(wn([J({}),ne()])),$k=J({err:Wi}),zk=gt("receivedSignature"),Wk=J({"solana-core":ne(),"feature-set":be(D())}),oh=wt(J({err:oe(wn([J({}),ne()])),logs:oe(se(ne())),accounts:be(oe(se(oe(J({executable:mr(),owner:ne(),lamports:D(),data:se(ne()),rentEpoch:be(D())}))))),unitsConsumed:be(D()),returnData:be(oe(J({programId:ne(),data:Md([ne(),gt("base64")])})))})),Vk=wt(J({byIdentity:Zp(ne(),se(D())),range:J({firstSlot:D(),lastSlot:D()})}));function Uk(r,e,t,n,i,s){const o=t||Ak;let a;s!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let c;return n&&(c=async(u,f)=>{const m=await new Promise((y,S)=>{try{n(u,f,(p,w)=>y([p,w]))}catch(p){S(p)}});return await o(...m)}),new Uw(async(u,f)=>{const m={method:"POST",body:u,agent:a,headers:Object.assign({"Content-Type":"application/json"},e||{},FS)};try{let y=5,S,p=500;for(;c?S=await c(r,m):S=await o(r,m),!(S.status!==429||i===!0||(y-=1,y===0));)console.log(`Server responded with ${S.status} ${S.statusText}.  Retrying after ${p}ms delay...`),await gi(p),p*=2;const w=await S.text();S.ok?f(null,w):f(new Error(`${S.status} ${S.statusText}: ${w}`))}catch(y){y instanceof Error&&f(y)}},{})}function Fk(r){return(e,t)=>new Promise((n,i)=>{r.request(e,t,(s,o)=>{if(s){i(s);return}n(o)})})}function jk(r){return e=>new Promise((t,n)=>{e.length===0&&t([]);const i=e.map(s=>r.request(s.methodName,s.args));r.request(i,(s,o)=>{if(s){n(s);return}t(o)})})}const qk=Ee(xk),Gk=Ee(Lk),Hk=Ee(Mk),Yk=Ee(Kk),Jk=Ee(Nk),Qk=Ee(Dk),Xk=Ee(D()),Zk=wt(J({total:D(),circulating:D(),nonCirculating:D(),nonCirculatingAccounts:se(Rt)})),Gl=J({amount:ne(),uiAmount:oe(D()),decimals:D(),uiAmountString:be(ne())}),eS=wt(se(J({address:Rt,amount:ne(),uiAmount:oe(D()),decimals:D(),uiAmountString:be(ne())}))),tS=wt(se(J({pubkey:Rt,account:J({executable:mr(),owner:Rt,lamports:D(),data:Vd,rentEpoch:D()})}))),Hl=J({program:ne(),parsed:ra(),space:D()}),nS=wt(se(J({pubkey:Rt,account:J({executable:mr(),owner:Rt,lamports:D(),data:Hl,rentEpoch:D()})}))),rS=wt(se(J({lamports:D(),address:Rt}))),zo=J({executable:mr(),owner:Rt,lamports:D(),data:Vd,rentEpoch:D()}),iS=J({pubkey:Rt,account:zo}),sS=ia(wn([Cd(L.Buffer),Hl]),wn([ly,Hl]),r=>Array.isArray(r)?ie(r,Vd):r),Yl=J({executable:mr(),owner:Rt,lamports:D(),data:sS,rentEpoch:D()}),oS=J({pubkey:Rt,account:Yl}),aS=J({state:wn([gt("active"),gt("inactive"),gt("activating"),gt("deactivating")]),active:D(),inactive:D()}),cS=Ee(se(J({signature:ne(),slot:D(),err:Wi,memo:oe(ne()),blockTime:be(oe(D()))}))),uS=Ee(se(J({signature:ne(),slot:D(),err:Wi,memo:oe(ne()),blockTime:be(oe(D()))}))),lS=J({subscription:D(),result:Jc(zo)}),dS=J({pubkey:Rt,account:zo}),fS=J({subscription:D(),result:Jc(dS)}),hS=J({parent:D(),slot:D(),root:D()}),pS=J({subscription:D(),result:hS}),yS=wn([J({type:wn([gt("firstShredReceived"),gt("completed"),gt("optimisticConfirmation"),gt("root")]),slot:D(),timestamp:D()}),J({type:gt("createdBank"),parent:D(),slot:D(),timestamp:D()}),J({type:gt("frozen"),slot:D(),timestamp:D(),stats:J({numTransactionEntries:D(),numSuccessfulTransactions:D(),numFailedTransactions:D(),maxTransactionsPerEntry:D()})}),J({type:gt("dead"),slot:D(),timestamp:D(),err:ne()})]),gS=J({subscription:D(),result:yS}),mS=J({subscription:D(),result:Jc(wn([$k,zk]))}),bS=J({subscription:D(),result:D()}),wS=J({pubkey:ne(),gossip:oe(ne()),tpu:oe(ne()),rpc:oe(ne()),version:oe(ne())}),ah=J({votePubkey:ne(),nodePubkey:ne(),activatedStake:D(),epochVoteAccount:mr(),epochCredits:se(Md([D(),D(),D()])),commission:D(),lastVote:D(),rootSlot:oe(D())}),kS=Ee(J({current:se(ah),delinquent:se(ah)})),SS=wn([gt("processed"),gt("confirmed"),gt("finalized")]),vS=J({slot:D(),confirmations:oe(D()),err:Wi,confirmationStatus:be(SS)}),_S=wt(se(oe(vS))),AS=Ee(D()),hy=J({accountKey:Rt,writableIndexes:se(D()),readonlyIndexes:se(D())}),Ud=J({signatures:se(ne()),message:J({accountKeys:se(ne()),header:J({numRequiredSignatures:D(),numReadonlySignedAccounts:D(),numReadonlyUnsignedAccounts:D()}),instructions:se(J({accounts:se(D()),data:ne(),programIdIndex:D()})),recentBlockhash:ne(),addressTableLookups:be(se(hy))})}),py=J({pubkey:Rt,signer:mr(),writable:mr(),source:be(wn([gt("transaction"),gt("lookupTable")]))}),yy=J({accountKeys:se(py),signatures:se(ne())}),gy=J({parsed:ra(),program:ne(),programId:Rt}),my=J({accounts:se(Rt),data:ne(),programId:Rt}),IS=wn([my,gy]),ES=wn([J({parsed:ra(),program:ne(),programId:ne()}),J({accounts:se(ne()),data:ne(),programId:ne()})]),by=ia(IS,ES,r=>"accounts"in r?ie(r,my):ie(r,gy)),wy=J({signatures:se(ne()),message:J({accountKeys:se(py),instructions:se(by),recentBlockhash:ne(),addressTableLookups:be(oe(se(hy)))})}),fc=J({accountIndex:D(),mint:ne(),owner:be(ne()),uiTokenAmount:Gl}),ky=J({writable:se(Rt),readonly:se(Rt)}),Qc=J({err:Wi,fee:D(),innerInstructions:be(oe(se(J({index:D(),instructions:se(J({accounts:se(D()),data:ne(),programIdIndex:D()}))})))),preBalances:se(D()),postBalances:se(D()),logMessages:be(oe(se(ne()))),preTokenBalances:be(oe(se(fc))),postTokenBalances:be(oe(se(fc))),loadedAddresses:be(ky),computeUnitsConsumed:be(D())}),Fd=J({err:Wi,fee:D(),innerInstructions:be(oe(se(J({index:D(),instructions:se(by)})))),preBalances:se(D()),postBalances:se(D()),logMessages:be(oe(se(ne()))),preTokenBalances:be(oe(se(fc))),postTokenBalances:be(oe(se(fc))),loadedAddresses:be(ky),computeUnitsConsumed:be(D())}),Ys=wn([gt(0),gt("legacy")]),Vi=J({pubkey:ne(),lamports:D(),postBalance:oe(D()),rewardType:oe(ne()),commission:be(oe(D()))}),PS=Ee(oe(J({blockhash:ne(),previousBlockhash:ne(),parentSlot:D(),transactions:se(J({transaction:Ud,meta:oe(Qc),version:be(Ys)})),rewards:be(se(Vi)),blockTime:oe(D()),blockHeight:oe(D())}))),RS=Ee(oe(J({blockhash:ne(),previousBlockhash:ne(),parentSlot:D(),rewards:be(se(Vi)),blockTime:oe(D()),blockHeight:oe(D())}))),TS=Ee(oe(J({blockhash:ne(),previousBlockhash:ne(),parentSlot:D(),transactions:se(J({transaction:yy,meta:oe(Qc),version:be(Ys)})),rewards:be(se(Vi)),blockTime:oe(D()),blockHeight:oe(D())}))),OS=Ee(oe(J({blockhash:ne(),previousBlockhash:ne(),parentSlot:D(),transactions:se(J({transaction:wy,meta:oe(Fd),version:be(Ys)})),rewards:be(se(Vi)),blockTime:oe(D()),blockHeight:oe(D())}))),BS=Ee(oe(J({blockhash:ne(),previousBlockhash:ne(),parentSlot:D(),transactions:se(J({transaction:yy,meta:oe(Fd),version:be(Ys)})),rewards:be(se(Vi)),blockTime:oe(D()),blockHeight:oe(D())}))),xS=Ee(oe(J({blockhash:ne(),previousBlockhash:ne(),parentSlot:D(),rewards:be(se(Vi)),blockTime:oe(D()),blockHeight:oe(D())}))),CS=Ee(oe(J({blockhash:ne(),previousBlockhash:ne(),parentSlot:D(),transactions:se(J({transaction:Ud,meta:oe(Qc)})),rewards:be(se(Vi)),blockTime:oe(D())}))),ch=Ee(oe(J({blockhash:ne(),previousBlockhash:ne(),parentSlot:D(),signatures:se(ne()),blockTime:oe(D())}))),fl=Ee(oe(J({slot:D(),meta:Qc,blockTime:be(oe(D())),transaction:Ud,version:be(Ys)}))),Ra=Ee(oe(J({slot:D(),transaction:wy,meta:oe(Fd),blockTime:be(oe(D())),version:be(Ys)}))),MS=wt(J({blockhash:ne(),feeCalculator:J({lamportsPerSignature:D()})})),LS=wt(J({blockhash:ne(),lastValidBlockHeight:D()})),KS=wt(mr()),NS=J({slot:D(),numTransactions:D(),numSlots:D(),samplePeriodSecs:D()}),DS=Ee(se(NS)),$S=wt(oe(J({feeCalculator:J({lamportsPerSignature:D()})}))),zS=Ee(ne()),WS=Ee(ne()),VS=J({err:Wi,logs:se(ne()),signature:ne()}),US=J({result:Jc(VS),subscription:D()}),FS={"solana-client":"js/0.0.0-development"};class jS{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const l={};return async u=>{const{commitment:f,config:m}=ct(u),y=this._buildArgs([],f,void 0,m),S=ih(y);return l[S]=l[S]??(async()=>{try{const p=await this._rpcRequest("getBlockHeight",y),w=ie(p,Ee(D()));if("error"in w)throw new le(w.error,"failed to get block height information");return w.result}finally{delete l[S]}})(),await l[S]}})();let n,i,s,o,a,c;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,n=t.wsEndpoint,i=t.httpHeaders,s=t.fetch,o=t.fetchMiddleware,a=t.disableRetryOnRateLimit,c=t.httpAgent),this._rpcEndpoint=Ok(e),this._rpcWsEndpoint=n||Tk(e),this._rpcClient=Uk(e,i,s,o,a,c),this._rpcRequest=Fk(this._rpcClient),this._rpcBatchRequest=jk(this._rpcClient),this._rpcWebSocket=new Ik(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:n,config:i}=ct(t),s=this._buildArgs([e.toBase58()],n,void 0,i),o=await this._rpcRequest("getBalance",s),a=ie(o,wt(D()));if("error"in a)throw new le(a.error,`failed to get balance for ${e.toBase58()}`);return a.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+n)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),n=ie(t,Ee(oe(D())));if("error"in n)throw new le(n.error,`failed to get block time for slot ${e}`);return n.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=ie(e,Ee(D()));if("error"in t)throw new le(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=ie(e,Xk);if("error"in t)throw new le(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};const n=await this._rpcRequest("getSupply",[t]),i=ie(n,Zk);if("error"in i)throw new le(i.error,"failed to get supply");return i.result}async getTokenSupply(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenSupply",n),s=ie(i,wt(Gl));if("error"in s)throw new le(s.error,"failed to get token supply");return s.result}async getTokenAccountBalance(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenAccountBalance",n),s=ie(i,wt(Gl));if("error"in s)throw new le(s.error,"failed to get token account balance");return s.result}async getTokenAccountsByOwner(e,t,n){const{commitment:i,config:s}=ct(n);let o=[e.toBase58()];"mint"in t?o.push({mint:t.mint.toBase58()}):o.push({programId:t.programId.toBase58()});const a=this._buildArgs(o,i,"base64",s),c=await this._rpcRequest("getTokenAccountsByOwner",a),l=ie(c,tS);if("error"in l)throw new le(l.error,`failed to get token accounts owned by account ${e.toBase58()}`);return l.result}async getParsedTokenAccountsByOwner(e,t,n){let i=[e.toBase58()];"mint"in t?i.push({mint:t.mint.toBase58()}):i.push({programId:t.programId.toBase58()});const s=this._buildArgs(i,n,"jsonParsed"),o=await this._rpcRequest("getTokenAccountsByOwner",s),a=ie(o,nS);if("error"in a)throw new le(a.error,`failed to get token accounts owned by account ${e.toBase58()}`);return a.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},n=t.filter||t.commitment?[t]:[],i=await this._rpcRequest("getLargestAccounts",n),s=ie(i,rS);if("error"in s)throw new le(s.error,"failed to get largest accounts");return s.result}async getTokenLargestAccounts(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenLargestAccounts",n),s=ie(i,eS);if("error"in s)throw new le(s.error,"failed to get token largest accounts");return s.result}async getAccountInfoAndContext(e,t){const{commitment:n,config:i}=ct(t),s=this._buildArgs([e.toBase58()],n,"base64",i),o=await this._rpcRequest("getAccountInfo",s),a=ie(o,wt(oe(zo)));if("error"in a)throw new le(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getParsedAccountInfo(e,t){const{commitment:n,config:i}=ct(t),s=this._buildArgs([e.toBase58()],n,"jsonParsed",i),o=await this._rpcRequest("getAccountInfo",s),a=ie(o,wt(oe(Yl)));if("error"in a)throw new le(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(n){throw new Error("failed to get info about account "+e.toBase58()+": "+n)}}async getMultipleParsedAccounts(e,t){const{commitment:n,config:i}=ct(t),s=e.map(l=>l.toBase58()),o=this._buildArgs([s],n,"jsonParsed",i),a=await this._rpcRequest("getMultipleAccounts",o),c=ie(a,wt(se(oe(Yl))));if("error"in c)throw new le(c.error,`failed to get info for accounts ${s}`);return c.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:n,config:i}=ct(t),s=e.map(l=>l.toBase58()),o=this._buildArgs([s],n,"base64",i),a=await this._rpcRequest("getMultipleAccounts",o),c=ie(a,wt(se(oe(zo))));if("error"in c)throw new le(c.error,`failed to get info for accounts ${s}`);return c.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,n){const{commitment:i,config:s}=ct(t),o=this._buildArgs([e.toBase58()],i,void 0,{...s,epoch:n??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getStakeActivation",o),c=ie(a,Ee(aS));if("error"in c)throw new le(c.error,`failed to get Stake Activation ${e.toBase58()}`);return c.result}async getProgramAccounts(e,t){const{commitment:n,config:i}=ct(t),{encoding:s,...o}=i||{},a=this._buildArgs([e.toBase58()],n,s||"base64",o),c=await this._rpcRequest("getProgramAccounts",a),l=se(iS),u=o.withContext===!0?ie(c,wt(l)):ie(c,Ee(l));if("error"in u)throw new le(u.error,`failed to get accounts owned by program ${e.toBase58()}`);return u.result}async getParsedProgramAccounts(e,t){const{commitment:n,config:i}=ct(t),s=this._buildArgs([e.toBase58()],n,"jsonParsed",i),o=await this._rpcRequest("getProgramAccounts",s),a=ie(o,Ee(se(oS)));if("error"in a)throw new le(a.error,`failed to get accounts owned by program ${e.toBase58()}`);return a.result}async confirmTransaction(e,t){var s;let n;if(typeof e=="string")n=e;else{const o=e;if((s=o.abortSignal)!=null&&s.aborted)return Promise.reject(o.abortSignal.reason);n=o.signature}let i;try{i=pe.decode(n)}catch{throw new Error("signature must be base58 encoded: "+n)}return We(i.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:n}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,n)=>{e!=null&&(e.aborted?n(e.reason):e.addEventListener("abort",()=>{n(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let n,i,s=!1;const o=new Promise((c,l)=>{try{n=this.onSignature(t,(f,m)=>{n=void 0;const y={context:m,value:f};c({__type:Ir.PROCESSED,response:y})},e);const u=new Promise(f=>{n==null?f():i=this._onSubscriptionStateChange(n,m=>{m==="subscribed"&&f()})});(async()=>{if(await u,s)return;const f=await this.getSignatureStatus(t);if(s||f==null)return;const{context:m,value:y}=f;if(y!=null)if(y!=null&&y.err)l(y.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(y.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(y.confirmationStatus==="processed"||y.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}s=!0,c({__type:Ir.PROCESSED,response:{context:m,value:y}})}})()}catch(u){l(u)}});return{abortConfirmation:()=>{i&&(i(),i=void 0),n!=null&&(this.removeSignatureListener(n),n=void 0)},confirmationPromise:o}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:n,signature:i}}){let s=!1;const o=new Promise(f=>{const m=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let y=await m();if(!s){for(;y<=n;)if(await gi(1e3),s||(y=await m(),s))return;f({__type:Ir.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:a,confirmationPromise:c}=this.getTransactionConfirmationPromise({commitment:e,signature:i}),l=this.getCancellationPromise(t);let u;try{const f=await Promise.race([l,c,o]);if(f.__type===Ir.PROCESSED)u=f.response;else throw new Nd(i)}finally{s=!0,a()}return u}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:n,nonceAccountPubkey:i,nonceValue:s,signature:o}}){let a=!1;const c=new Promise(y=>{let S=s,p=null;const w=async()=>{try{const{context:v,value:E}=await this.getNonceAndContext(i,{commitment:e,minContextSlot:n});return p=v.slot,E==null?void 0:E.nonce}catch{return S}};(async()=>{if(S=await w(),!a)for(;;){if(s!==S){y({__type:Ir.NONCE_INVALID,slotInWhichNonceDidAdvance:p});return}if(await gi(2e3),a||(S=await w(),a))return}})()}),{abortConfirmation:l,confirmationPromise:u}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),f=this.getCancellationPromise(t);let m;try{const y=await Promise.race([f,u,c]);if(y.__type===Ir.PROCESSED)m=y.response;else{let S;for(;;){const p=await this.getSignatureStatus(o);if(p==null)break;if(p.context.slot<(y.slotInWhichNonceDidAdvance??n)){await gi(400);continue}S=p;break}if(S!=null&&S.value){const p=e||"finalized",{confirmationStatus:w}=S.value;switch(p){case"processed":case"recent":if(w!=="processed"&&w!=="confirmed"&&w!=="finalized")throw new ls(o);break;case"confirmed":case"single":case"singleGossip":if(w!=="confirmed"&&w!=="finalized")throw new ls(o);break;case"finalized":case"max":case"root":if(w!=="finalized")throw new ls(o);break;default:(v=>{})(p)}m={context:S.context,value:{err:S.value.err}}}else throw new ls(o)}}finally{a=!0,l()}return m}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let n;const i=new Promise(c=>{let l=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{l=this._confirmTransactionInitialTimeout||3e4;break}}n=setTimeout(()=>c({__type:Ir.TIMED_OUT,timeoutMs:l}),l)}),{abortConfirmation:s,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let a;try{const c=await Promise.race([o,i]);if(c.__type===Ir.PROCESSED)a=c.response;else throw new Dd(t,c.timeoutMs/1e3)}finally{clearTimeout(n),s()}return a}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=ie(e,Ee(se(wS)));if("error"in t)throw new le(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getVoteAccounts",t),i=ie(n,kS);if("error"in i)throw new le(i.error,"failed to get vote accounts");return i.result}async getSlot(e){const{commitment:t,config:n}=ct(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getSlot",i),o=ie(s,Ee(D()));if("error"in o)throw new le(o.error,"failed to get slot");return o.result}async getSlotLeader(e){const{commitment:t,config:n}=ct(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getSlotLeader",i),o=ie(s,Ee(ne()));if("error"in o)throw new le(o.error,"failed to get slot leader");return o.result}async getSlotLeaders(e,t){const n=[e,t],i=await this._rpcRequest("getSlotLeaders",n),s=ie(i,Ee(se(Rt)));if("error"in s)throw new le(s.error,"failed to get slot leaders");return s.result}async getSignatureStatus(e,t){const{context:n,value:i}=await this.getSignatureStatuses([e],t);We(i.length===1);const s=i[0];return{context:n,value:s}}async getSignatureStatuses(e,t){const n=[e];t&&n.push(t);const i=await this._rpcRequest("getSignatureStatuses",n),s=ie(i,_S);if("error"in s)throw new le(s.error,"failed to get signature status");return s.result}async getTransactionCount(e){const{commitment:t,config:n}=ct(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getTransactionCount",i),o=ie(s,Ee(D()));if("error"in o)throw new le(o.error,"failed to get transaction count");return o.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getInflationGovernor",t),i=ie(n,qk);if("error"in i)throw new le(i.error,"failed to get inflation");return i.result}async getInflationReward(e,t,n){const{commitment:i,config:s}=ct(n),o=this._buildArgs([e.map(l=>l.toBase58())],i,void 0,{...s,epoch:t??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getInflationReward",o),c=ie(a,Ck);if("error"in c)throw new le(c.error,"failed to get inflation reward");return c.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=ie(e,Gk);if("error"in t)throw new le(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:n}=ct(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getEpochInfo",i),o=ie(s,Yk);if("error"in o)throw new le(o.error,"failed to get epoch info");return o.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=ie(e,Jk);if("error"in t)throw new le(t.error,"failed to get epoch schedule");const n=t.result;return new uy(n.slotsPerEpoch,n.leaderScheduleSlotOffset,n.warmup,n.firstNormalEpoch,n.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=ie(e,Qk);if("error"in t)throw new le(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const n=this._buildArgs([e],t),i=await this._rpcRequest("getMinimumBalanceForRentExemption",n),s=ie(i,AS);return"error"in s?(console.warn("Unable to fetch minimum balance for rent exemption"),0):s.result}async getRecentBlockhashAndContext(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getRecentBlockhash",t),i=ie(n,MS);if("error"in i)throw new le(i.error,"failed to get recent blockhash");return i.result}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),n=ie(t,DS);if("error"in n)throw new le(n.error,"failed to get recent performance samples");return n.result}async getFeeCalculatorForBlockhash(e,t){const n=this._buildArgs([e],t),i=await this._rpcRequest("getFeeCalculatorForBlockhash",n),s=ie(i,$S);if("error"in s)throw new le(s.error,"failed to get fee calculator");const{context:o,value:a}=s.result;return{context:o,value:a!==null?a.feeCalculator:null}}async getFeeForMessage(e,t){const n=Re(e.serialize()).toString("base64"),i=this._buildArgs([n],t),s=await this._rpcRequest("getFeeForMessage",i),o=ie(s,wt(oe(D())));if("error"in o)throw new le(o.error,"failed to get fee for message");if(o.result===null)throw new Error("invalid blockhash");return o.result}async getRecentPrioritizationFees(e){var o;const t=(o=e==null?void 0:e.lockedWritableAccounts)==null?void 0:o.map(a=>a.toBase58()),n=t!=null&&t.length?[t]:[],i=await this._rpcRequest("getRecentPrioritizationFees",n),s=ie(i,Hk);if("error"in s)throw new le(s.error,"failed to get recent prioritization fees");return s.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:n}=ct(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getLatestBlockhash",i),o=ie(s,LS);if("error"in o)throw new le(o.error,"failed to get latest blockhash");return o.result}async isBlockhashValid(e,t){const{commitment:n,config:i}=ct(t),s=this._buildArgs([e],n,void 0,i),o=await this._rpcRequest("isBlockhashValid",s),a=ie(o,KS);if("error"in a)throw new le(a.error,"failed to determine if the blockhash `"+e+"`is valid");return a.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=ie(e,Ee(Wk));if("error"in t)throw new le(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=ie(e,Ee(ne()));if("error"in t)throw new le(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:n,config:i}=ct(t),s=this._buildArgsAtLeastConfirmed([e],n,void 0,i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=ie(o,TS);if("error"in a)throw a.error;return a.result}case"none":{const a=ie(o,RS);if("error"in a)throw a.error;return a.result}default:{const a=ie(o,PS);if("error"in a)throw a.error;const{result:c}=a;return c?{...c,transactions:c.transactions.map(({transaction:l,meta:u,version:f})=>({meta:u,transaction:{...l,message:dl(f,l.message)},version:f}))}:null}}}catch(a){throw new le(a,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:n,config:i}=ct(t),s=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=ie(o,BS);if("error"in a)throw a.error;return a.result}case"none":{const a=ie(o,xS);if("error"in a)throw a.error;return a.result}default:{const a=ie(o,OS);if("error"in a)throw a.error;return a.result}}}catch(a){throw new le(a,"failed to get block")}}async getBlockProduction(e){let t,n;if(typeof e=="string")n=e;else if(e){const{commitment:a,...c}=e;n=a,t=c}const i=this._buildArgs([],n,"base64",t),s=await this._rpcRequest("getBlockProduction",i),o=ie(s,Vk);if("error"in o)throw new le(o.error,"failed to get block production information");return o.result}async getTransaction(e,t){const{commitment:n,config:i}=ct(t),s=this._buildArgsAtLeastConfirmed([e],n,void 0,i),o=await this._rpcRequest("getTransaction",s),a=ie(o,fl);if("error"in a)throw new le(a.error,"failed to get transaction");const c=a.result;return c&&{...c,transaction:{...c.transaction,message:dl(c.version,c.transaction.message)}}}async getParsedTransaction(e,t){const{commitment:n,config:i}=ct(t),s=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",i),o=await this._rpcRequest("getTransaction",s),a=ie(o,Ra);if("error"in a)throw new le(a.error,"failed to get transaction");return a.result}async getParsedTransactions(e,t){const{commitment:n,config:i}=ct(t),s=e.map(c=>{const l=this._buildArgsAtLeastConfirmed([c],n,"jsonParsed",i);return{methodName:"getTransaction",args:l}});return(await this._rpcBatchRequest(s)).map(c=>{const l=ie(c,Ra);if("error"in l)throw new le(l.error,"failed to get transactions");return l.result})}async getTransactions(e,t){const{commitment:n,config:i}=ct(t),s=e.map(c=>{const l=this._buildArgsAtLeastConfirmed([c],n,void 0,i);return{methodName:"getTransaction",args:l}});return(await this._rpcBatchRequest(s)).map(c=>{const l=ie(c,fl);if("error"in l)throw new le(l.error,"failed to get transactions");const u=l.result;return u&&{...u,transaction:{...u.transaction,message:dl(u.version,u.transaction.message)}}})}async getConfirmedBlock(e,t){const n=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getConfirmedBlock",n),s=ie(i,CS);if("error"in s)throw new le(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");const a={...o,transactions:o.transactions.map(({transaction:c,meta:l})=>{const u=new Zn(c.message);return{meta:l,transaction:{...c,message:u}}})};return{...a,transactions:a.transactions.map(({transaction:c,meta:l})=>({meta:l,transaction:ze.populate(c.message,c.signatures)}))}}async getBlocks(e,t,n){const i=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],n),s=await this._rpcRequest("getBlocks",i),o=ie(s,Ee(se(D())));if("error"in o)throw new le(o.error,"failed to get blocks");return o.result}async getBlockSignatures(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getBlock",n),s=ie(i,ch);if("error"in s)throw new le(s.error,"failed to get block");const o=s.result;if(!o)throw new Error("Block "+e+" not found");return o}async getConfirmedBlockSignatures(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getConfirmedBlock",n),s=ie(i,ch);if("error"in s)throw new le(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");return o}async getConfirmedTransaction(e,t){const n=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getConfirmedTransaction",n),s=ie(i,fl);if("error"in s)throw new le(s.error,"failed to get transaction");const o=s.result;if(!o)return o;const a=new Zn(o.transaction.message),c=o.transaction.signatures;return{...o,transaction:ze.populate(a,c)}}async getParsedConfirmedTransaction(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),i=await this._rpcRequest("getConfirmedTransaction",n),s=ie(i,Ra);if("error"in s)throw new le(s.error,"failed to get confirmed transaction");return s.result}async getParsedConfirmedTransactions(e,t){const n=e.map(o=>{const a=this._buildArgsAtLeastConfirmed([o],t,"jsonParsed");return{methodName:"getConfirmedTransaction",args:a}});return(await this._rpcBatchRequest(n)).map(o=>{const a=ie(o,Ra);if("error"in a)throw new le(a.error,"failed to get confirmed transactions");return a.result})}async getConfirmedSignaturesForAddress(e,t,n){let i={},s=await this.getFirstAvailableBlock();for(;!("until"in i)&&(t--,!(t<=0||t<s));)try{const c=await this.getConfirmedBlockSignatures(t,"finalized");c.signatures.length>0&&(i.until=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}let o=await this.getSlot("finalized");for(;!("before"in i)&&(n++,!(n>o));)try{const c=await this.getConfirmedBlockSignatures(n);c.signatures.length>0&&(i.before=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}return(await this.getConfirmedSignaturesForAddress2(e,i)).map(c=>c.signature)}async getConfirmedSignaturesForAddress2(e,t,n){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),s=await this._rpcRequest("getConfirmedSignaturesForAddress2",i),o=ie(s,cS);if("error"in o)throw new le(o.error,"failed to get confirmed signatures for address");return o.result}async getSignaturesForAddress(e,t,n){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),s=await this._rpcRequest("getSignaturesForAddress",i),o=ie(s,uS);if("error"in o)throw new le(o.error,"failed to get signatures for address");return o.result}async getAddressLookupTable(e,t){const{context:n,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=new ql({key:e,state:ql.deserialize(i.data)})),{context:n,value:s}}async getNonceAndContext(e,t){const{context:n,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=Yc.fromAccountData(i.data)),{context:n,value:s}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+n)})}async requestAirdrop(e,t){const n=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),i=ie(n,zS);if("error"in i)throw new le(i.error,`airdrop to ${e.toBase58()} failed`);return i.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await gi(100);const n=Date.now()-this._blockhashInfo.lastFetch>=dy;if(this._blockhashInfo.latestBlockhash!==null&&!n)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,n=t?t.blockhash:null;for(let i=0;i<50;i++){const s=await this.getLatestBlockhash("finalized");if(n!==s.blockhash)return this._blockhashInfo={latestBlockhash:s,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},s;await gi(oy/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:n}=ct(e),i=this._buildArgs([],t,"base64",n),s=await this._rpcRequest("getStakeMinimumDelegation",i),o=ie(s,wt(D()));if("error"in o)throw new le(o.error,"failed to get stake minimum delegation");return o.result}async simulateTransaction(e,t,n){if("message"in e){const p=e.serialize(),w=L.Buffer.from(p).toString("base64");if(Array.isArray(t)||n!==void 0)throw new Error("Invalid arguments");const v=t||{};v.encoding="base64","commitment"in v||(v.commitment=this.commitment);const E=[w,v],P=await this._rpcRequest("simulateTransaction",E),K=ie(P,oh);if("error"in K)throw new Error("failed to simulate transaction: "+K.error.message);return K.result}let i;if(e instanceof ze){let S=e;i=new ze,i.feePayer=S.feePayer,i.instructions=e.instructions,i.nonceInfo=S.nonceInfo,i.signatures=S.signatures}else i=ze.populate(e),i._message=i._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");const s=t;if(i.nonceInfo&&s)i.sign(...s);else{let S=this._disableBlockhashCaching;for(;;){const p=await this._blockhashWithExpiryBlockHeight(S);if(i.lastValidBlockHeight=p.lastValidBlockHeight,i.recentBlockhash=p.blockhash,!s)break;if(i.sign(...s),!i.signature)throw new Error("!signature");const w=i.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(w)&&!this._blockhashInfo.transactionSignatures.includes(w)){this._blockhashInfo.simulatedSignatures.push(w);break}else S=!0}}const o=i._compile(),a=o.serialize(),l=i._serialize(a).toString("base64"),u={encoding:"base64",commitment:this.commitment};if(n){const S=(Array.isArray(n)?n:o.nonProgramIds()).map(p=>p.toBase58());u.accounts={encoding:"base64",addresses:S}}s&&(u.sigVerify=!0);const f=[l,u],m=await this._rpcRequest("simulateTransaction",f),y=ie(m,oh);if("error"in y){let S;if("data"in y.error&&(S=y.error.data.logs,S&&Array.isArray(S))){const p=`
    `,w=p+S.join(p);console.error(y.error.message,w)}throw new $o("failed to simulate transaction: "+y.error.message,S)}return y.result}async sendTransaction(e,t,n){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const o=e.serialize();return await this.sendRawTransaction(o,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");const i=t;if(e.nonceInfo)e.sign(...i);else{let o=this._disableBlockhashCaching;for(;;){const a=await this._blockhashWithExpiryBlockHeight(o);if(e.lastValidBlockHeight=a.lastValidBlockHeight,e.recentBlockhash=a.blockhash,e.sign(...i),!e.signature)throw new Error("!signature");const c=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(c))o=!0;else{this._blockhashInfo.transactionSignatures.push(c);break}}}const s=e.serialize();return await this.sendRawTransaction(s,n)}async sendRawTransaction(e,t){const n=Re(e).toString("base64");return await this.sendEncodedTransaction(n,t)}async sendEncodedTransaction(e,t){const n={encoding:"base64"},i=t&&t.skipPreflight,s=t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(n.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(n.minContextSlot=t.minContextSlot),i&&(n.skipPreflight=i),s&&(n.preflightCommitment=s);const o=[e,n],a=await this._rpcRequest("sendTransaction",o),c=ie(a,WS);if("error"in c){let l;throw"data"in c.error&&(l=c.error.data.logs),new $o("failed to send transaction: "+c.error.message,l)}return c.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,n])=>{this._setSubscription(t,{...n,state:"pending"})})}_setSubscription(e,t){var i;const n=(i=this._subscriptionsByHash[e])==null?void 0:i.state;if(this._subscriptionsByHash[e]=t,n!==t.state){const s=this._subscriptionStateChangeCallbacksByHash[e];s&&s.forEach(o=>{try{o(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){const n=this._subscriptionHashByClientSubscriptionId[e];if(n==null)return()=>{};const i=this._subscriptionStateChangeCallbacksByHash[n]||=new Set;return i.add(t),()=>{i.delete(t),i.size===0&&delete this._subscriptionStateChangeCallbacksByHash[n]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(n){n instanceof Error&&console.log(`Error when closing socket connection: ${n.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async n=>{const i=this._subscriptionsByHash[n];if(i!==void 0)switch(i.state){case"pending":case"unsubscribed":if(i.callbacks.size===0){delete this._subscriptionsByHash[n],i.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[i.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:s,method:o}=i;try{this._setSubscription(n,{...i,state:"subscribing"});const a=await this._rpcWebSocket.call(o,s);this._setSubscription(n,{...i,serverSubscriptionId:a,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[a]=i.callbacks,await this._updateSubscriptions()}catch(a){if(a instanceof Error&&console.error(`${o} error for argument`,s,a.message),!t())return;this._setSubscription(n,{...i,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":i.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:s,unsubscribeMethod:o}=i;if(this._subscriptionsAutoDisposedByRpc.has(s))this._subscriptionsAutoDisposedByRpc.delete(s);else{this._setSubscription(n,{...i,state:"unsubscribing"}),this._setSubscription(n,{...i,state:"unsubscribing"});try{await this._rpcWebSocket.call(o,[s])}catch(a){if(a instanceof Error&&console.error(`${o} error:`,a.message),!t())return;this._setSubscription(n,{...i,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(n,{...i,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){const n=this._subscriptionCallbacksByServerSubscriptionId[e];n!==void 0&&n.forEach(i=>{try{i(...t)}catch(s){console.error(s)}})}_wsOnAccountNotification(e){const{result:t,subscription:n}=ie(e,lS);this._handleServerNotification(n,[t.value,t.context])}_makeSubscription(e,t){const n=this._nextClientSubscriptionId++,i=ih([e.method,t],!0),s=this._subscriptionsByHash[i];return s===void 0?this._subscriptionsByHash[i]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:s.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[n]=i,this._subscriptionDisposeFunctionsByClientSubscriptionId[n]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[n],delete this._subscriptionHashByClientSubscriptionId[n];const o=this._subscriptionsByHash[i];We(o!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${n}`),o.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),n}onAccountChange(e,t,n){const i=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64");return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},i)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:n}=ie(e,fS);this._handleServerNotification(n,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,n,i){const s=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64",i?{filters:i}:void 0);return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},s)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,n){const i=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],n||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},i)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:n}=ie(e,US);this._handleServerNotification(n,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:n}=ie(e,pS);this._handleServerNotification(n,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:n}=ie(e,gS);this._handleServerNotification(n,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const n=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];n?await n():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,n,i){const s=t||this._commitment;if(s||n||i){let o={};n&&(o.encoding=n),s&&(o.commitment=s),i&&(o=Object.assign(o,i)),e.push(o)}return e}_buildArgsAtLeastConfirmed(e,t,n,i){const s=t||this._commitment;if(s&&!["confirmed","finalized"].includes(s))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,n,i)}_wsOnSignatureNotification(e){const{result:t,subscription:n}=ie(e,mS);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(n),this._handleServerNotification(n,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,n){const i=this._buildArgs([e],n||this._commitment||"finalized"),s=this._makeSubscription({callback:(o,a)=>{if(o.type==="status"){t(o.result,a);try{this.removeSignatureListener(s)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},i);return s}onSignatureWithOptions(e,t,n){const{commitment:i,...s}={...n,commitment:n&&n.commitment||this._commitment||"finalized"},o=this._buildArgs([e],i,void 0,s),a=this._makeSubscription({callback:(c,l)=>{t(c,l);try{this.removeSignatureListener(a)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return a}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:n}=ie(e,bS);this._handleServerNotification(n,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class bs{constructor(e){this._keypair=void 0,this._keypair=e??th()}static generate(){return new bs(th())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const n=e.slice(32,64);if(!t||!t.skipValidation){const i=e.slice(0,32),s=dc(i);for(let o=0;o<32;o++)if(n[o]!==s[o])throw new Error("provided secretKey is invalid")}return new bs({publicKey:n,secretKey:e})}static fromSeed(e){const t=dc(e),n=new Uint8Array(64);return n.set(e),n.set(t,32),new bs({publicKey:t,secretKey:n})}get publicKey(){return new Y(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}const Rr=Object.freeze({CreateLookupTable:{index:0,layout:C([M("instruction"),Ts("recentSlot"),ee("bumpSeed")])},FreezeLookupTable:{index:1,layout:C([M("instruction")])},ExtendLookupTable:{index:2,layout:C([M("instruction"),Ts(),Ie(xe(),Pt(M(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:C([M("instruction")])},CloseLookupTable:{index:4,layout:C([M("instruction")])}});class qS{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Rr))if(o.index==n){i=s;break}if(!i)throw new Error("Invalid Instruction. Should be a LookupTable Instruction");return i}static decodeCreateLookupTable(e){this.checkProgramId(e.programId),this.checkKeysLength(e.keys,4);const{recentSlot:t}=He(Rr.CreateLookupTable,e.data);return{authority:e.keys[1].pubkey,payer:e.keys[2].pubkey,recentSlot:Number(t)}}static decodeExtendLookupTable(e){if(this.checkProgramId(e.programId),e.keys.length<2)throw new Error(`invalid instruction; found ${e.keys.length} keys, expected at least 2`);const{addresses:t}=He(Rr.ExtendLookupTable,e.data);return{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,payer:e.keys.length>2?e.keys[2].pubkey:void 0,addresses:t.map(n=>new Y(n))}}static decodeCloseLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,3),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,recipient:e.keys[2].pubkey}}static decodeFreezeLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static decodeDeactivateLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(jd.programId))throw new Error("invalid instruction; programId is not AddressLookupTable Program")}static checkKeysLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}class jd{constructor(){}static createLookupTable(e){const[t,n]=Y.findProgramAddressSync([e.authority.toBuffer(),ta(BigInt(e.recentSlot),8)],this.programId),i=Rr.CreateLookupTable,s=Le(i,{recentSlot:BigInt(e.recentSlot),bumpSeed:n}),o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:Et.programId,isSigner:!1,isWritable:!1}];return[new Qe({programId:this.programId,keys:o,data:s}),t]}static freezeLookupTable(e){const t=Rr.FreezeLookupTable,n=Le(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new Qe({programId:this.programId,keys:i,data:n})}static extendLookupTable(e){const t=Rr.ExtendLookupTable,n=Le(t,{addresses:e.addresses.map(s=>s.toBytes())}),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return e.payer&&i.push({pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:Et.programId,isSigner:!1,isWritable:!1}),new Qe({programId:this.programId,keys:i,data:n})}static deactivateLookupTable(e){const t=Rr.DeactivateLookupTable,n=Le(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new Qe({programId:this.programId,keys:i,data:n})}static closeLookupTable(e){const t=Rr.CloseLookupTable,n=Le(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.recipient,isSigner:!1,isWritable:!0}];return new Qe({programId:this.programId,keys:i,data:n})}}jd.programId=new Y("AddressLookupTab1e1111111111111111111111111");class GS{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=ee("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(dr))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a ComputeBudgetInstruction");return i}static decodeRequestUnits(e){this.checkProgramId(e.programId);const{units:t,additionalFee:n}=He(dr.RequestUnits,e.data);return{units:t,additionalFee:n}}static decodeRequestHeapFrame(e){this.checkProgramId(e.programId);const{bytes:t}=He(dr.RequestHeapFrame,e.data);return{bytes:t}}static decodeSetComputeUnitLimit(e){this.checkProgramId(e.programId);const{units:t}=He(dr.SetComputeUnitLimit,e.data);return{units:t}}static decodeSetComputeUnitPrice(e){this.checkProgramId(e.programId);const{microLamports:t}=He(dr.SetComputeUnitPrice,e.data);return{microLamports:t}}static checkProgramId(e){if(!e.equals(qd.programId))throw new Error("invalid instruction; programId is not ComputeBudgetProgram")}}const dr=Object.freeze({RequestUnits:{index:0,layout:C([ee("instruction"),M("units"),M("additionalFee")])},RequestHeapFrame:{index:1,layout:C([ee("instruction"),M("bytes")])},SetComputeUnitLimit:{index:2,layout:C([ee("instruction"),M("units")])},SetComputeUnitPrice:{index:3,layout:C([ee("instruction"),Ts("microLamports")])}});class qd{constructor(){}static requestUnits(e){const t=dr.RequestUnits,n=Le(t,e);return new Qe({keys:[],programId:this.programId,data:n})}static requestHeapFrame(e){const t=dr.RequestHeapFrame,n=Le(t,e);return new Qe({keys:[],programId:this.programId,data:n})}static setComputeUnitLimit(e){const t=dr.SetComputeUnitLimit,n=Le(t,e);return new Qe({keys:[],programId:this.programId,data:n})}static setComputeUnitPrice(e){const t=dr.SetComputeUnitPrice,n=Le(t,{microLamports:BigInt(e.microLamports)});return new Qe({keys:[],programId:this.programId,data:n})}}qd.programId=new Y("ComputeBudget111111111111111111111111111111");const uh=64,lh=32,dh=64,fh=C([ee("numSignatures"),ee("padding"),De("signatureOffset"),De("signatureInstructionIndex"),De("publicKeyOffset"),De("publicKeyInstructionIndex"),De("messageDataOffset"),De("messageDataSize"),De("messageInstructionIndex")]);class Xc{constructor(){}static createInstructionWithPublicKey(e){const{publicKey:t,message:n,signature:i,instructionIndex:s}=e;We(t.length===lh,`Public Key must be ${lh} bytes but received ${t.length} bytes`),We(i.length===dh,`Signature must be ${dh} bytes but received ${i.length} bytes`);const o=fh.span,a=o+t.length,c=a+i.length,l=1,u=L.Buffer.alloc(c+n.length),f=s??65535;return fh.encode({numSignatures:l,padding:0,signatureOffset:a,signatureInstructionIndex:f,publicKeyOffset:o,publicKeyInstructionIndex:f,messageDataOffset:c,messageDataSize:n.length,messageInstructionIndex:f},u),u.fill(t,o),u.fill(i,a),u.fill(n,c),new Qe({keys:[],programId:Xc.programId,data:u})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:n,instructionIndex:i}=e;We(t.length===uh,`Private key must be ${uh} bytes but received ${t.length} bytes`);try{const s=bs.fromSecretKey(t),o=s.publicKey.toBytes(),a=Ld(n,s.secretKey);return this.createInstructionWithPublicKey({publicKey:o,message:n,signature:a,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}Xc.programId=new Y("Ed25519SigVerify111111111111111111111111111");const HS=(r,e)=>{const t=si.sign(r,e);return[t.toCompactRawBytes(),t.recovery]};si.utils.isValidPrivateKey;const YS=si.getPublicKey,hh=32,hl=20,ph=64,JS=11,pl=C([ee("numSignatures"),De("signatureOffset"),ee("signatureInstructionIndex"),De("ethAddressOffset"),ee("ethAddressInstructionIndex"),De("messageDataOffset"),De("messageDataSize"),ee("messageInstructionIndex"),he(20,"ethAddress"),he(64,"signature"),ee("recoveryId")]);class ws{constructor(){}static publicKeyToEthAddress(e){We(e.length===ph,`Public key must be ${ph} bytes but received ${e.length} bytes`);try{return L.Buffer.from(cc(Re(e))).slice(-hl)}catch(t){throw new Error(`Error constructing Ethereum address: ${t}`)}}static createInstructionWithPublicKey(e){const{publicKey:t,message:n,signature:i,recoveryId:s,instructionIndex:o}=e;return ws.createInstructionWithEthAddress({ethAddress:ws.publicKeyToEthAddress(t),message:n,signature:i,recoveryId:s,instructionIndex:o})}static createInstructionWithEthAddress(e){const{ethAddress:t,message:n,signature:i,recoveryId:s,instructionIndex:o=0}=e;let a;typeof t=="string"?t.startsWith("0x")?a=L.Buffer.from(t.substr(2),"hex"):a=L.Buffer.from(t,"hex"):a=t,We(a.length===hl,`Address must be ${hl} bytes but received ${a.length} bytes`);const c=1+JS,l=c,u=c+a.length,f=u+i.length+1,m=1,y=L.Buffer.alloc(pl.span+n.length);return pl.encode({numSignatures:m,signatureOffset:u,signatureInstructionIndex:o,ethAddressOffset:l,ethAddressInstructionIndex:o,messageDataOffset:f,messageDataSize:n.length,messageInstructionIndex:o,signature:Re(i),ethAddress:Re(a),recoveryId:s},y),y.fill(Re(n),pl.span),new Qe({keys:[],programId:ws.programId,data:y})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:n,instructionIndex:i}=e;We(t.length===hh,`Private key must be ${hh} bytes but received ${t.length} bytes`);try{const s=Re(t),o=YS(s,!1).slice(1),a=L.Buffer.from(cc(Re(n))),[c,l]=HS(a,s);return this.createInstructionWithPublicKey({publicKey:o,message:n,signature:c,recoveryId:l,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}ws.programId=new Y("KeccakSecp256k11111111111111111111111111111");var Sy;const vy=new Y("StakeConfig11111111111111111111111111111111");class _y{constructor(e,t){this.staker=void 0,this.withdrawer=void 0,this.staker=e,this.withdrawer=t}}class sa{constructor(e,t,n){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=n}}Sy=sa;sa.default=new Sy(0,0,Y.default);class QS{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(zt))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a StakeInstruction");return i}static decodeInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t,lockup:n}=He(zt.Initialize,e.data);return{stakePubkey:e.keys[0].pubkey,authorized:new _y(new Y(t.staker),new Y(t.withdrawer)),lockup:new sa(n.unixTimestamp,n.epoch,new Y(n.custodian))}}static decodeDelegate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,6),He(zt.Delegate,e.data),{stakePubkey:e.keys[0].pubkey,votePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[5].pubkey}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,stakeAuthorizationType:n}=He(zt.Authorize,e.data),i={stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new Y(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(i.custodianPubkey=e.keys[3].pubkey),i}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{newAuthorized:t,stakeAuthorizationType:n,authoritySeed:i,authorityOwner:s}=He(zt.AuthorizeWithSeed,e.data),o={stakePubkey:e.keys[0].pubkey,authorityBase:e.keys[1].pubkey,authoritySeed:i,authorityOwner:new Y(s),newAuthorizedPubkey:new Y(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(o.custodianPubkey=e.keys[3].pubkey),o}static decodeSplit(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=He(zt.Split,e.data);return{stakePubkey:e.keys[0].pubkey,splitStakePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[2].pubkey,lamports:t}}static decodeMerge(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),He(zt.Merge,e.data),{stakePubkey:e.keys[0].pubkey,sourceStakePubKey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=He(zt.Withdraw,e.data),n={stakePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t};return e.keys.length>5&&(n.custodianPubkey=e.keys[5].pubkey),n}static decodeDeactivate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),He(zt.Deactivate,e.data),{stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static checkProgramId(e){if(!e.equals(Zc.programId))throw new Error("invalid instruction; programId is not StakeProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const zt=Object.freeze({Initialize:{index:0,layout:C([M("instruction"),Zw(),ek()])},Authorize:{index:1,layout:C([M("instruction"),xe("newAuthorized"),M("stakeAuthorizationType")])},Delegate:{index:2,layout:C([M("instruction")])},Split:{index:3,layout:C([M("instruction"),Me("lamports")])},Withdraw:{index:4,layout:C([M("instruction"),Me("lamports")])},Deactivate:{index:5,layout:C([M("instruction")])},Merge:{index:7,layout:C([M("instruction")])},AuthorizeWithSeed:{index:8,layout:C([M("instruction"),xe("newAuthorized"),M("stakeAuthorizationType"),bi("authoritySeed"),xe("authorityOwner")])}}),XS=Object.freeze({Staker:{index:0},Withdrawer:{index:1}});class Zc{constructor(){}static initialize(e){const{stakePubkey:t,authorized:n,lockup:i}=e,s=i||sa.default,o=zt.Initialize,a=Le(o,{authorized:{staker:Re(n.staker.toBuffer()),withdrawer:Re(n.withdrawer.toBuffer())},lockup:{unixTimestamp:s.unixTimestamp,epoch:s.epoch,custodian:Re(s.custodian.toBuffer())}}),c={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Ri,isSigner:!1,isWritable:!1}],programId:this.programId,data:a};return new Qe(c)}static createAccountWithSeed(e){const t=new ze;t.add(Et.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:n,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:n,authorized:i,lockup:s}))}static createAccount(e){const t=new ze;t.add(Et.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:n,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:n,authorized:i,lockup:s}))}static delegate(e){const{stakePubkey:t,authorizedPubkey:n,votePubkey:i}=e,s=zt.Delegate,o=Le(s);return new ze().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:cr,isSigner:!1,isWritable:!1},{pubkey:Qa,isSigner:!1,isWritable:!1},{pubkey:vy,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static authorize(e){const{stakePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:i,stakeAuthorizationType:s,custodianPubkey:o}=e,a=zt.Authorize,c=Le(a,{newAuthorized:Re(i.toBuffer()),stakeAuthorizationType:s.index}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:cr,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return o&&l.push({pubkey:o,isSigner:!1,isWritable:!1}),new ze().add({keys:l,programId:this.programId,data:c})}static authorizeWithSeed(e){const{stakePubkey:t,authorityBase:n,authoritySeed:i,authorityOwner:s,newAuthorizedPubkey:o,stakeAuthorizationType:a,custodianPubkey:c}=e,l=zt.AuthorizeWithSeed,u=Le(l,{newAuthorized:Re(o.toBuffer()),stakeAuthorizationType:a.index,authoritySeed:i,authorityOwner:Re(s.toBuffer())}),f=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:cr,isSigner:!1,isWritable:!1}];return c&&f.push({pubkey:c,isSigner:!1,isWritable:!1}),new ze().add({keys:f,programId:this.programId,data:u})}static splitInstruction(e){const{stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,lamports:s}=e,o=zt.Split,a=Le(o,{lamports:s});return new Qe({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:a})}static split(e){const t=new ze;return t.add(Et.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:0,space:this.space,programId:this.programId})),t.add(this.splitInstruction(e))}static splitWithSeed(e){const{stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,basePubkey:s,seed:o,lamports:a}=e,c=new ze;return c.add(Et.allocate({accountPubkey:i,basePubkey:s,seed:o,space:this.space,programId:this.programId})),c.add(this.splitInstruction({stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,lamports:a}))}static merge(e){const{stakePubkey:t,sourceStakePubKey:n,authorizedPubkey:i}=e,s=zt.Merge,o=Le(s);return new ze().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:cr,isSigner:!1,isWritable:!1},{pubkey:Qa,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static withdraw(e){const{stakePubkey:t,authorizedPubkey:n,toPubkey:i,lamports:s,custodianPubkey:o}=e,a=zt.Withdraw,c=Le(a,{lamports:s}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:cr,isSigner:!1,isWritable:!1},{pubkey:Qa,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return o&&l.push({pubkey:o,isSigner:!1,isWritable:!1}),new ze().add({keys:l,programId:this.programId,data:c})}static deactivate(e){const{stakePubkey:t,authorizedPubkey:n}=e,i=zt.Deactivate,s=Le(i);return new ze().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:cr,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:s})}}Zc.programId=new Y("Stake11111111111111111111111111111111111111");Zc.space=200;class Ay{constructor(e,t,n,i){this.nodePubkey=void 0,this.authorizedVoter=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.nodePubkey=e,this.authorizedVoter=t,this.authorizedWithdrawer=n,this.commission=i}}class ZS{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Tr))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a VoteInstruction");return i}static decodeInitializeAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,4);const{voteInit:t}=He(Tr.InitializeAccount,e.data);return{votePubkey:e.keys[0].pubkey,nodePubkey:e.keys[3].pubkey,voteInit:new Ay(new Y(t.nodePubkey),new Y(t.authorizedVoter),new Y(t.authorizedWithdrawer),t.commission)}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,voteAuthorizationType:n}=He(Tr.Authorize,e.data);return{votePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new Y(t),voteAuthorizationType:{index:n}}}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:t,currentAuthorityDerivedKeySeed:n,newAuthorized:i,voteAuthorizationType:s}}=He(Tr.AuthorizeWithSeed,e.data);return{currentAuthorityDerivedKeyBasePubkey:e.keys[2].pubkey,currentAuthorityDerivedKeyOwnerPubkey:new Y(t),currentAuthorityDerivedKeySeed:n,newAuthorizedPubkey:new Y(i),voteAuthorizationType:{index:s},votePubkey:e.keys[0].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=He(Tr.Withdraw,e.data);return{votePubkey:e.keys[0].pubkey,authorizedWithdrawerPubkey:e.keys[2].pubkey,lamports:t,toPubkey:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(Js.programId))throw new Error("invalid instruction; programId is not VoteProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const Tr=Object.freeze({InitializeAccount:{index:0,layout:C([M("instruction"),tk()])},Authorize:{index:1,layout:C([M("instruction"),xe("newAuthorized"),M("voteAuthorizationType")])},Withdraw:{index:3,layout:C([M("instruction"),Me("lamports")])},AuthorizeWithSeed:{index:10,layout:C([M("instruction"),nk()])}}),ev=Object.freeze({Voter:{index:0},Withdrawer:{index:1}});class Js{constructor(){}static initializeAccount(e){const{votePubkey:t,nodePubkey:n,voteInit:i}=e,s=Tr.InitializeAccount,o=Le(s,{voteInit:{nodePubkey:Re(i.nodePubkey.toBuffer()),authorizedVoter:Re(i.authorizedVoter.toBuffer()),authorizedWithdrawer:Re(i.authorizedWithdrawer.toBuffer()),commission:i.commission}}),a={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Ri,isSigner:!1,isWritable:!1},{pubkey:cr,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:o};return new Qe(a)}static createAccount(e){const t=new ze;return t.add(Et.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}static authorize(e){const{votePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:i,voteAuthorizationType:s}=e,o=Tr.Authorize,a=Le(o,{newAuthorized:Re(i.toBuffer()),voteAuthorizationType:s.index}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:cr,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return new ze().add({keys:c,programId:this.programId,data:a})}static authorizeWithSeed(e){const{currentAuthorityDerivedKeyBasePubkey:t,currentAuthorityDerivedKeyOwnerPubkey:n,currentAuthorityDerivedKeySeed:i,newAuthorizedPubkey:s,voteAuthorizationType:o,votePubkey:a}=e,c=Tr.AuthorizeWithSeed,l=Le(c,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:Re(n.toBuffer()),currentAuthorityDerivedKeySeed:i,newAuthorized:Re(s.toBuffer()),voteAuthorizationType:o.index}}),u=[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:cr,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return new ze().add({keys:u,programId:this.programId,data:l})}static withdraw(e){const{votePubkey:t,authorizedWithdrawerPubkey:n,lamports:i,toPubkey:s}=e,o=Tr.Withdraw,a=Le(o,{lamports:i}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return new ze().add({keys:c,programId:this.programId,data:a})}static safeWithdraw(e,t,n){if(e.lamports>t-n)throw new Error("Withdraw will leave vote account with insuffcient funds.");return Js.withdraw(e)}}Js.programId=new Y("Vote111111111111111111111111111111111111111");Js.space=3731;const Iy=new Y("Va1idator1nfo111111111111111111111111111111"),tv=J({name:ne(),website:be(ne()),details:be(ne()),keybaseUsername:be(ne())});class Gd{constructor(e,t){this.key=void 0,this.info=void 0,this.key=e,this.info=t}static fromConfigData(e){let t=[...e];if(hn(t)!==2)return null;const i=[];for(let s=0;s<2;s++){const o=new Y(t.slice(0,On));t=t.slice(On);const a=t.slice(0,1)[0]===1;t=t.slice(1),i.push({publicKey:o,isSigner:a})}if(i[0].publicKey.equals(Iy)&&i[1].isSigner){const s=bi().decode(L.Buffer.from(t)),o=JSON.parse(s);return Qp(o,tv),new Gd(i[1].publicKey,o)}return null}}const nv=new Y("Vote111111111111111111111111111111111111111"),rv=C([xe("nodePubkey"),xe("authorizedWithdrawer"),ee("commission"),we(),Ie(C([we("slot"),M("confirmationCount")]),Pt(M(),-8),"votes"),ee("rootSlotValid"),we("rootSlot"),we(),Ie(C([we("epoch"),xe("authorizedVoter")]),Pt(M(),-8),"authorizedVoters"),C([Ie(C([xe("authorizedPubkey"),we("epochOfLastAuthorizedSwitch"),we("targetEpoch")]),32,"buf"),we("idx"),ee("isEmpty")],"priorVoters"),we(),Ie(C([we("epoch"),we("credits"),we("prevCredits")]),Pt(M(),-8),"epochCredits"),C([we("slot"),we("timestamp")],"lastTimestamp")]);class Hd{constructor(e){this.nodePubkey=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.rootSlot=void 0,this.votes=void 0,this.authorizedVoters=void 0,this.priorVoters=void 0,this.epochCredits=void 0,this.lastTimestamp=void 0,this.nodePubkey=e.nodePubkey,this.authorizedWithdrawer=e.authorizedWithdrawer,this.commission=e.commission,this.rootSlot=e.rootSlot,this.votes=e.votes,this.authorizedVoters=e.authorizedVoters,this.priorVoters=e.priorVoters,this.epochCredits=e.epochCredits,this.lastTimestamp=e.lastTimestamp}static fromAccountData(e){const n=rv.decode(Re(e),4);let i=n.rootSlot;return n.rootSlotValid||(i=null),new Hd({nodePubkey:new Y(n.nodePubkey),authorizedWithdrawer:new Y(n.authorizedWithdrawer),commission:n.commission,votes:n.votes,rootSlot:i,authorizedVoters:n.authorizedVoters.map(iv),priorVoters:sv(n.priorVoters),epochCredits:n.epochCredits,lastTimestamp:n.lastTimestamp})}}function iv({authorizedVoter:r,epoch:e}){return{epoch:e,authorizedVoter:new Y(r)}}function yh({authorizedPubkey:r,epochOfLastAuthorizedSwitch:e,targetEpoch:t}){return{authorizedPubkey:new Y(r),epochOfLastAuthorizedSwitch:e,targetEpoch:t}}function sv({buf:r,idx:e,isEmpty:t}){return t?[]:[...r.slice(e+1).map(yh),...r.slice(0,e).map(yh)]}const gh={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function ov(r,e){const t=e===!1?"http":"https";if(!r)return gh[t].devnet;const n=gh[t][r];if(!n)throw new Error(`Unknown ${t} cluster: ${r}`);return n}async function av(r,e,t,n){let i,s;t&&Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")||t&&Object.prototype.hasOwnProperty.call(t,"nonceValue")?(i=t,s=n):s=t;const o=s&&{skipPreflight:s.skipPreflight,preflightCommitment:s.preflightCommitment||s.commitment,minContextSlot:s.minContextSlot},a=await r.sendRawTransaction(e,o),c=s&&s.commitment,u=(await(i?r.confirmTransaction(i,c):r.confirmTransaction(a,c))).value;if(u.err)throw new Error(`Raw transaction ${a} failed (${JSON.stringify(u)})`);return a}const cv=1e9;var Ey=Object.freeze(Object.defineProperty({__proto__:null,Account:Jw,AddressLookupTableAccount:ql,AddressLookupTableInstruction:qS,AddressLookupTableProgram:jd,Authorized:_y,BLOCKHASH_CACHE_TIMEOUT_MS:dy,BPF_LOADER_DEPRECATED_PROGRAM_ID:Qw,BPF_LOADER_PROGRAM_ID:gk,BpfLoader:mk,COMPUTE_BUDGET_INSTRUCTION_LAYOUTS:dr,ComputeBudgetInstruction:GS,ComputeBudgetProgram:qd,Connection:jS,Ed25519Program:Xc,Enum:Hw,EpochSchedule:uy,FeeCalculatorLayout:ay,Keypair:bs,LAMPORTS_PER_SOL:cv,LOOKUP_TABLE_INSTRUCTION_LAYOUTS:Rr,Loader:Ti,Lockup:sa,MAX_SEED_LENGTH:iy,Message:Zn,MessageAccountKeys:Do,MessageV0:Pi,NONCE_ACCOUNT_LENGTH:jl,NonceAccount:Yc,PACKET_DATA_SIZE:Hr,PUBLIC_KEY_LENGTH:On,PublicKey:Y,SIGNATURE_LENGTH_IN_BYTES:Rs,SOLANA_SCHEMA:Io,STAKE_CONFIG_ID:vy,STAKE_INSTRUCTION_LAYOUTS:zt,SYSTEM_INSTRUCTION_LAYOUTS:it,SYSVAR_CLOCK_PUBKEY:cr,SYSVAR_EPOCH_SCHEDULE_PUBKEY:ak,SYSVAR_INSTRUCTIONS_PUBKEY:ck,SYSVAR_RECENT_BLOCKHASHES_PUBKEY:Ja,SYSVAR_RENT_PUBKEY:Ri,SYSVAR_REWARDS_PUBKEY:uk,SYSVAR_SLOT_HASHES_PUBKEY:lk,SYSVAR_SLOT_HISTORY_PUBKEY:dk,SYSVAR_STAKE_HISTORY_PUBKEY:Qa,Secp256k1Program:ws,SendTransactionError:$o,SolanaJSONRPCError:le,SolanaJSONRPCErrorCode:_k,StakeAuthorizationLayout:XS,StakeInstruction:QS,StakeProgram:Zc,Struct:Kd,SystemInstruction:pk,SystemProgram:Et,Transaction:ze,TransactionExpiredBlockheightExceededError:Nd,TransactionExpiredNonceInvalidError:ls,TransactionExpiredTimeoutError:Dd,TransactionInstruction:Qe,TransactionMessage:zd,TransactionStatus:Ir,VALIDATOR_INFO_KEY:Iy,VERSION_PREFIX_MASK:Gc,VOTE_PROGRAM_ID:nv,ValidatorInfo:Gd,VersionedMessage:$d,VersionedTransaction:Wd,VoteAccount:Hd,VoteAuthorizationLayout:ev,VoteInit:Ay,VoteInstruction:ZS,VoteProgram:Js,clusterApiUrl:ov,sendAndConfirmRawTransaction:av,sendAndConfirmTransaction:Fl},Symbol.toStringTag,{value:"Module"})),Ae={},Py=Hs(Ey);(function(r){var e=z&&z.__importDefault||function(B){return B&&B.__esModule?B:{default:B}};Object.defineProperty(r,"__esModule",{value:!0}),r.map=r.array=r.rustEnum=r.str=r.vecU8=r.tagged=r.vec=r.bool=r.option=r.publicKey=r.i128=r.u128=r.i64=r.u64=r.struct=r.f64=r.f32=r.i32=r.u32=r.i16=r.u16=r.i8=r.u8=void 0;const t=Xf,n=Py,i=e(Up.exports);var s=Xf;Object.defineProperty(r,"u8",{enumerable:!0,get:function(){return s.u8}}),Object.defineProperty(r,"i8",{enumerable:!0,get:function(){return s.s8}}),Object.defineProperty(r,"u16",{enumerable:!0,get:function(){return s.u16}}),Object.defineProperty(r,"i16",{enumerable:!0,get:function(){return s.s16}}),Object.defineProperty(r,"u32",{enumerable:!0,get:function(){return s.u32}}),Object.defineProperty(r,"i32",{enumerable:!0,get:function(){return s.s32}}),Object.defineProperty(r,"f32",{enumerable:!0,get:function(){return s.f32}}),Object.defineProperty(r,"f64",{enumerable:!0,get:function(){return s.f64}}),Object.defineProperty(r,"struct",{enumerable:!0,get:function(){return s.struct}});class o extends t.Layout{constructor(V,q,I){super(V,I),this.blob=t.blob(V),this.signed=q}decode(V,q=0){const I=new i.default(this.blob.decode(V,q),10,"le");return this.signed?I.fromTwos(this.span*8).clone():I}encode(V,q,I=0){return this.signed&&(V=V.toTwos(this.span*8)),this.blob.encode(V.toArrayLike(ge.Buffer,"le",this.span),q,I)}}function a(B){return new o(8,!1,B)}r.u64=a;function c(B){return new o(8,!0,B)}r.i64=c;function l(B){return new o(16,!1,B)}r.u128=l;function u(B){return new o(16,!0,B)}r.i128=u;class f extends t.Layout{constructor(V,q,I,$){super(V.span,$),this.layout=V,this.decoder=q,this.encoder=I}decode(V,q){return this.decoder(this.layout.decode(V,q))}encode(V,q,I){return this.layout.encode(this.encoder(V),q,I)}getSpan(V,q){return this.layout.getSpan(V,q)}}function m(B){return new f(t.blob(32),V=>new n.PublicKey(V),V=>V.toBuffer(),B)}r.publicKey=m;class y extends t.Layout{constructor(V,q){super(-1,q),this.layout=V,this.discriminator=t.u8()}encode(V,q,I=0){return V==null?this.discriminator.encode(0,q,I):(this.discriminator.encode(1,q,I),this.layout.encode(V,q,I+1)+1)}decode(V,q=0){const I=this.discriminator.decode(V,q);if(I===0)return null;if(I===1)return this.layout.decode(V,q+1);throw new Error("Invalid option "+this.property)}getSpan(V,q=0){const I=this.discriminator.decode(V,q);if(I===0)return 1;if(I===1)return this.layout.getSpan(V,q+1)+1;throw new Error("Invalid option "+this.property)}}function S(B,V){return new y(B,V)}r.option=S;function p(B){return new f(t.u8(),w,v,B)}r.bool=p;function w(B){if(B===0)return!1;if(B===1)return!0;throw new Error("Invalid bool: "+B)}function v(B){return B?1:0}function E(B,V){const q=t.u32("length"),I=t.struct([q,t.seq(B,t.offset(q,-q.span),"values")]);return new f(I,({values:$})=>$,$=>({values:$}),V)}r.vec=E;function P(B,V,q){const I=t.struct([a("tag"),V.replicate("data")]);function $({tag:G,data:ke}){if(!G.eq(B))throw new Error("Invalid tag, expected: "+B.toString("hex")+", got: "+G.toString("hex"));return ke}return new f(I,$,G=>({tag:B,data:G}),q)}r.tagged=P;function K(B){const V=t.u32("length"),q=t.struct([V,t.blob(t.offset(V,-V.span),"data")]);return new f(q,({data:I})=>I,I=>({data:I}),B)}r.vecU8=K;function T(B){return new f(K(),V=>V.toString("utf-8"),V=>ge.Buffer.from(V,"utf-8"),B)}r.str=T;function b(B,V,q){const I=t.union(q??t.u8(),V);return B.forEach(($,G)=>I.addVariant(G,$,$.property)),I}r.rustEnum=b;function _(B,V,q){const I=t.struct([t.seq(B,V,"values")]);return new f(I,({values:$})=>$,$=>({values:$}),q)}r.array=_;class R extends t.Layout{constructor(V,q,I){super(V.span+q.span,I),this.keyLayout=V,this.valueLayout=q}decode(V,q){q=q||0;const I=this.keyLayout.decode(V,q),$=this.valueLayout.decode(V,q+this.keyLayout.getSpan(V,q));return[I,$]}encode(V,q,I){I=I||0;const $=this.keyLayout.encode(V[0],q,I),G=this.valueLayout.encode(V[1],q,I+$);return $+G}getSpan(V,q){return this.keyLayout.getSpan(V,q)+this.valueLayout.getSpan(V,q)}}function W(B,V,q){const I=t.u32("length"),$=t.struct([I,t.seq(new R(B,V),t.offset(I,-I.span),"values")]);return new f($,({values:G})=>new Map(G),G=>({values:Array.from(G.entries())}),q)}r.map=W})(Ae);var uv=Object.freeze({__proto__:null,encode:function(r){return r.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),"0x")},decode:function(r){r.indexOf("0x")===0&&(r=r.substr(2)),r.length%2==1&&(r="0"+r);let e=r.match(/.{2}/g);return e===null?L.Buffer.from([]):L.Buffer.from(e.map(t=>parseInt(t,16)))}});function Ry(r){return new TextDecoder("utf-8").decode(r)}function Ty(r){return new TextEncoder().encode(r)}var lv=Object.freeze({__proto__:null,decode:Ry,encode:Ty});function Oy(r){return pe.encode(r)}var dv=Object.freeze({__proto__:null,encode:Oy,decode:function(r){return pe.decode(r)}});function By(r){return L.Buffer.from(Fp(r))}var fv=Object.freeze({__proto__:null,encode:function(r){return Vl(r)},decode:By}),hv=Object.freeze({__proto__:null,hex:uv,utf8:lv,bs58:dv,base64:fv});function Yd(r){const e=new Map;return r.errors&&r.errors.forEach(t=>{var n;let i=(n=t.msg)!==null&&n!==void 0?n:t.name;e.set(t.code,i)}),e}function xy(r,...e){if(r.args.length!=e.length)throw new Error("Invalid argument length");const t={};let n=0;return r.args.forEach(i=>{t[i.name]=e[n],n+=1}),t}function eu(r,e={}){r.forEach(t=>{if("accounts"in t)eu(t.accounts,e[t.name]);else if(e[t.name]===void 0)throw new Error(`Invalid arguments: ${t.name} not provided.`)})}function qn(r){return r instanceof Y?r:new Y(r)}class pv extends TypeError{constructor(e,t){let n;const{message:i,...s}=e,{path:o}=e;super(o.length===0?i:"At path: "+o.join(".")+" -- "+i),Object.assign(this,s),this.name=this.constructor.name,this.failures=()=>{var a;return(a=n)!=null?a:n=[e,...t()]}}}function ks(r){return typeof r=="object"&&r!=null}function ti(r){return typeof r=="string"?JSON.stringify(r):""+r}function yv(r,e,t,n){if(r===!0)return;r===!1?r={}:typeof r=="string"&&(r={message:r});const{path:i,branch:s}=e,{type:o}=t,{refinement:a,message:c="Expected a value of type `"+o+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+ti(n)+"`"}=r;return{value:n,type:o,refinement:a,key:i[i.length-1],path:i,branch:s,...r,message:c}}function*mh(r,e,t,n){var i;ks(i=r)&&typeof i[Symbol.iterator]=="function"||(r=[r]);for(const s of r){const o=yv(s,e,t,n);o&&(yield o)}}function*Jd(r,e,t={}){const{path:n=[],branch:i=[r],coerce:s=!1,mask:o=!1}=t,a={path:n,branch:i};if(s&&(r=e.coercer(r,a),o&&e.type!=="type"&&ks(e.schema)&&ks(r)&&!Array.isArray(r)))for(const l in r)e.schema[l]===void 0&&delete r[l];let c=!0;for(const l of e.validator(r,a))c=!1,yield[l,void 0];for(let[l,u,f]of e.entries(r,a)){const m=Jd(u,f,{path:l===void 0?n:[...n,l],branch:l===void 0?i:[...i,u],coerce:s,mask:o});for(const y of m)y[0]?(c=!1,yield[y[0],void 0]):s&&(u=y[1],l===void 0?r=u:r instanceof Map?r.set(l,u):r instanceof Set?r.add(u):ks(r)&&(r[l]=u))}if(c)for(const l of e.refiner(r,a))c=!1,yield[l,void 0];c&&(yield[void 0,r])}class oi{constructor(e){const{type:t,schema:n,validator:i,refiner:s,coercer:o=c=>c,entries:a=function*(){}}=e;this.type=t,this.schema=n,this.entries=a,this.coercer=o,this.validator=i?(c,l)=>mh(i(c,l),l,this,c):()=>[],this.refiner=s?(c,l)=>mh(s(c,l),l,this,c):()=>[]}assert(e){return function(t,n){const i=Eo(t,n);if(i[0])throw i[0]}(e,this)}create(e){return Qd(e,this)}is(e){return Cy(e,this)}mask(e){return function(t,n){const i=Eo(t,n,{coerce:!0,mask:!0});if(i[0])throw i[0];return i[1]}(e,this)}validate(e,t={}){return Eo(e,this,t)}}function Qd(r,e){const t=Eo(r,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function Cy(r,e){return!Eo(r,e)[0]}function Eo(r,e,t={}){const n=Jd(r,e,t),i=function(s){const{done:o,value:a}=s.next();return o?void 0:a}(n);return i[0]?[new pv(i[0],function*(){for(const s of n)s[0]&&(yield s[0])}),void 0]:[void 0,i[1]]}function oa(r,e){return new oi({type:r,schema:null,validator:e})}function yl(r){return new oi({type:"array",schema:r,*entries(e){if(r&&Array.isArray(e))for(const[t,n]of e.entries())yield[t,n,r]},coercer:e=>Array.isArray(e)?e.slice():e,validator:e=>Array.isArray(e)||"Expected an array value, but received: "+ti(e)})}function bh(r){const e=ti(r),t=typeof r;return new oi({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?r:null,validator:n=>n===r||"Expected the literal `"+e+"`, but received: "+ti(n)})}function Ta(r){return new oi({...r,validator:(e,t)=>e===null||r.validator(e,t),refiner:(e,t)=>e===null||r.refiner(e,t)})}function Oa(){return oa("number",r=>typeof r=="number"&&!isNaN(r)||"Expected a number, but received: "+ti(r))}function Xa(r){return new oi({...r,validator:(e,t)=>e===void 0||r.validator(e,t),refiner:(e,t)=>e===void 0||r.refiner(e,t)})}function wi(){return oa("string",r=>typeof r=="string"||"Expected a string, but received: "+ti(r))}function Fr(r){const e=Object.keys(r);return new oi({type:"type",schema:r,*entries(t){if(ks(t))for(const n of e)yield[n,t[n],r[n]]},validator:t=>ks(t)||"Expected an object, but received: "+ti(t)})}function My(r){const e=r.map(t=>t.type).join(" | ");return new oi({type:"union",schema:null,validator(t,n){const i=[];for(const s of r){const[...o]=Jd(t,s,n),[a]=o;if(!a[0])return[];for(const[c]of o)c&&i.push(c)}return["Expected the value to satisfy a union of `"+e+"`, but received: "+ti(t),...i]}})}function Ly(){return oa("unknown",()=>!0)}async function Ky(r,e,t){if(e.length<=99)return await wh(r,e,t);{const n=function(i,s){return Array.apply(0,new Array(Math.ceil(i.length/s))).map((o,a)=>i.slice(a*s,(a+1)*s))}(e,99);return(await Promise.all(n.map(i=>wh(r,i,t)))).flat()}}async function wh(r,e,t){const n=t??r.commitment;return(await r.getMultipleAccountsInfo(e,n)).map((i,s)=>i===null?null:{publicKey:e[s],account:i})}async function Ny(r,e,t,n,i){t&&t.length>0&&e.sign(...t);const s=e._compile(),o=s.serialize(),a=e._serialize(o).toString("base64"),c={encoding:"base64",commitment:n??r.commitment};if(i){const f=(Array.isArray(i)?i:s.nonProgramIds()).map(m=>m.toBase58());c.accounts={encoding:"base64",addresses:f}}t&&(c.sigVerify=!0);const l=[a,c],u=Qd(await r._rpcRequest("simulateTransaction",l),bv);if("error"in u){let f;if("data"in u.error&&(f=u.error.data.logs,f&&Array.isArray(f))){const m=`
    `,y=m+f.join(m);console.error(u.error.message,y)}throw new $o("failed to simulate transaction: "+u.error.message,f)}return u.result}function gv(r){return function(e,t,n){return new oi({...e,coercer:(i,s)=>Cy(i,t)?e.coercer(n(i,s),s):e.coercer(i,s)})}(Dy(r),mv,e=>"error"in e?e:{...e,result:Qd(e.result,r)})}const mv=Dy(Ly());function Dy(r){return My([Fr({jsonrpc:bh("2.0"),id:wi(),result:r}),Fr({jsonrpc:bh("2.0"),id:wi(),error:Fr({code:Ly(),message:wi(),data:Xa(oa("any",()=>!0))})})])}const bv=(kh=Fr({err:Ta(My([Fr({}),wi()])),logs:Ta(yl(wi())),accounts:Xa(Ta(yl(Ta(Fr({executable:oa("boolean",r=>typeof r=="boolean"),owner:wi(),lamports:Oa(),data:yl(wi()),rentEpoch:Xa(Oa())}))))),unitsConsumed:Xa(Oa())}),gv(Fr({context:Fr({slot:Oa()}),value:kh})));var kh,wv=Object.freeze({__proto__:null,invoke:async function(r,e,t,n){r=qn(r),n||(n=Os());const i=new ze;if(i.add(new Qe({programId:r,keys:e??[],data:t})),n.sendAndConfirm===void 0)throw new Error("This function requires 'Provider.sendAndConfirm' to be implemented.");return await n.sendAndConfirm(i,[])},getMultipleAccounts:Ky,simulateTransaction:Ny});class $y{constructor(e,t,n){this.connection=e,this.wallet=t,this.opts=n}static defaultOptions(){return{preflightCommitment:"processed",commitment:"processed"}}static local(e,t){throw new Error("Provider local is not available on browser.")}static env(){throw new Error("Provider env is not available on browser.")}async sendAndConfirm(e,t,n){var i;n===void 0&&(n=this.opts),e.feePayer=this.wallet.publicKey,e.recentBlockhash=(await this.connection.getRecentBlockhash(n.preflightCommitment)).blockhash,e=await this.wallet.signTransaction(e),(t??[]).forEach(o=>{e.partialSign(o)});const s=e.serialize();try{return await Sh(this.connection,s,n)}catch(o){if(o instanceof zy){const a=await this.connection.getTransaction(Oy(e.signature),{commitment:"confirmed"});if(a){const c=(i=a.meta)===null||i===void 0?void 0:i.logMessages;throw c?new $o(o.message,c):o}throw o}throw o}}async sendAll(e,t){t===void 0&&(t=this.opts);const n=await this.connection.getRecentBlockhash(t.preflightCommitment);let i=e.map(a=>{var c;let l=a.tx,u=(c=a.signers)!==null&&c!==void 0?c:[];return l.feePayer=this.wallet.publicKey,l.recentBlockhash=n.blockhash,u.forEach(f=>{l.partialSign(f)}),l});const s=await this.wallet.signAllTransactions(i),o=[];for(let a=0;a<i.length;a+=1){const c=s[a].serialize();o.push(await Sh(this.connection,c,t))}return o}async simulate(e,t,n,i){e.feePayer=this.wallet.publicKey,e.recentBlockhash=(await this.connection.getLatestBlockhash(n??this.connection.commitment)).blockhash,e=await this.wallet.signTransaction(e);const s=await Ny(this.connection,e,t,n,i);if(s.value.err)throw new kv(s.value);return s.value}}class kv extends Error{constructor(e,t){super(t),this.simulationResponse=e}}async function Sh(r,e,t){const n=t&&{skipPreflight:t.skipPreflight,preflightCommitment:t.preflightCommitment||t.commitment},i=await r.sendRawTransaction(e,n),s=(await r.confirmTransaction(i,t&&t.commitment)).value;if(s.err)throw new zy(`Raw transaction ${i} failed (${JSON.stringify(s)})`);return i}class zy extends Error{constructor(e){super(e)}}function Sv(r){Jl=r}function Os(){return Jl===null?$y.local():Jl}let Jl=null;const vv=new Set(["anchor-deprecated-state","debug-logs"]),Wy=new Map;function tu(r){return Wy.get(r)!==void 0}var _v=Object.freeze({__proto__:null,set:function(r){if(!vv.has(r))throw new Error("Invalid feature");Wy.set(r,!0)},isSet:tu});class Wo extends Error{constructor(e){super(e),this.name="IdlError"}}class Qs{constructor(e){this.stack=e}static parse(e){var t;const n=/^Program (\w*) invoke/,i=/^Program \w* success/,s=[];for(let o=0;o<e.length;o++){if(i.exec(e[o])){s.pop();continue}const a=(t=n.exec(e[o]))===null||t===void 0?void 0:t[1];a&&s.push(new Y(a))}return new Qs(s)}}class Ss extends Error{constructor(e,t,n,i,s,o){super(n.join(`
`).replace("Program log: ","")),this.errorLogs=n,this.logs=i,this.error={errorCode:e,errorMessage:t,comparedValues:o,origin:s},this._programErrorStack=Qs.parse(i)}static parse(e){if(!e)return null;const t=e.findIndex(l=>l.startsWith("Program log: AnchorError"));if(t===-1)return null;const n=e[t],i=[n];let s;if(t+1<e.length){if(e[t+1]==="Program log: Left:"){const l=/^Program log: (.*)$/,u=l.exec(e[t+2])[1],f=l.exec(e[t+4])[1];s=[new Y(u),new Y(f)],i.push(...e.slice(t+1,t+5))}else if(e[t+1].startsWith("Program log: Left:")){const l=/^Program log: (Left|Right): (.*)$/,u=l.exec(e[t+1])[2],f=l.exec(e[t+2])[2];i.push(...e.slice(t+1,t+3)),s=[u,f]}}const o=/^Program log: AnchorError occurred\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n),a=/^Program log: AnchorError thrown in (.*):(\d*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n),c=/^Program log: AnchorError caused by account: (.*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n);if(o){const[l,u,f]=o.slice(1,4),m={code:l,number:parseInt(u)};return new Ss(m,f,i,e,void 0,s)}if(a){const[l,u,f,m,y]=a.slice(1,6),S={code:f,number:parseInt(m)},p={file:l,line:parseInt(u)};return new Ss(S,y,i,e,p,s)}if(c){const[l,u,f,m]=c.slice(1,5),y=l,S={code:u,number:parseInt(f)};return new Ss(S,m,i,e,y,s)}return null}get program(){return this._programErrorStack.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){return this._programErrorStack.stack}toString(){return this.message}}class Vo extends Error{constructor(e,t,n){super(),this.code=e,this.msg=t,this.logs=n,n&&(this._programErrorStack=Qs.parse(n))}static parse(e,t){const n=e.toString();let i,s;if(n.includes("custom program error:")){let a=n.split("custom program error: ");if(a.length!==2)return null;i=a[1]}else{const a=n.match(/"Custom":([0-9]+)}/g);if(!a||a.length>1)return null;i=a[0].match(/([0-9]+)/g)[0]}try{s=parseInt(i)}catch{return null}let o=t.get(s);return o!==void 0?new Vo(s,o,e.logs):(o=Vy.get(s),o!==void 0?new Vo(s,o,e.logs):null)}get program(){var e;return(e=this._programErrorStack)===null||e===void 0?void 0:e.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){var e;return(e=this._programErrorStack)===null||e===void 0?void 0:e.stack}toString(){return this.msg}}function Xd(r,e){tu("debug-logs")&&console.log("Translating error:",r);const t=Ss.parse(r.logs);if(t)return t;const n=Vo.parse(r,e);if(n)return n;if(r.logs){const i={get:function(s,o){return o==="programErrorStack"?s.programErrorStack.stack:o==="program"?s.programErrorStack.stack[r.programErrorStack.stack.length-1]:Reflect.get(...arguments)}};return r.programErrorStack=Qs.parse(r.logs),new Proxy(r,i)}return r}const ye={InstructionMissing:100,InstructionFallbackNotFound:101,InstructionDidNotDeserialize:102,InstructionDidNotSerialize:103,IdlInstructionStub:1e3,IdlInstructionInvalidProgram:1001,ConstraintMut:2e3,ConstraintHasOne:2001,ConstraintSigner:2002,ConstraintRaw:2003,ConstraintOwner:2004,ConstraintRentExempt:2005,ConstraintSeeds:2006,ConstraintExecutable:2007,ConstraintState:2008,ConstraintAssociated:2009,ConstraintAssociatedInit:2010,ConstraintClose:2011,ConstraintAddress:2012,ConstraintZero:2013,ConstraintTokenMint:2014,ConstraintTokenOwner:2015,ConstraintMintMintAuthority:2016,ConstraintMintFreezeAuthority:2017,ConstraintMintDecimals:2018,ConstraintSpace:2019,RequireViolated:2500,RequireEqViolated:2501,RequireKeysEqViolated:2502,RequireNeqViolated:2503,RequireKeysNeqViolated:2504,RequireGtViolated:2505,RequireGteViolated:2506,AccountDiscriminatorAlreadySet:3e3,AccountDiscriminatorNotFound:3001,AccountDiscriminatorMismatch:3002,AccountDidNotDeserialize:3003,AccountDidNotSerialize:3004,AccountNotEnoughKeys:3005,AccountNotMutable:3006,AccountOwnedByWrongProgram:3007,InvalidProgramId:3008,InvalidProgramExecutable:3009,AccountNotSigner:3010,AccountNotSystemOwned:3011,AccountNotInitialized:3012,AccountNotProgramData:3013,AccountNotAssociatedTokenAccount:3014,AccountSysvarMismatch:3015,StateInvalidAddress:4e3,DeclaredProgramIdMismatch:4100,Deprecated:5e3},Vy=new Map([[ye.InstructionMissing,"8 byte instruction identifier not provided"],[ye.InstructionFallbackNotFound,"Fallback functions are not supported"],[ye.InstructionDidNotDeserialize,"The program could not deserialize the given instruction"],[ye.InstructionDidNotSerialize,"The program could not serialize the given instruction"],[ye.IdlInstructionStub,"The program was compiled without idl instructions"],[ye.IdlInstructionInvalidProgram,"The transaction was given an invalid program for the IDL instruction"],[ye.ConstraintMut,"A mut constraint was violated"],[ye.ConstraintHasOne,"A has_one constraint was violated"],[ye.ConstraintSigner,"A signer constraint was violated"],[ye.ConstraintRaw,"A raw constraint was violated"],[ye.ConstraintOwner,"An owner constraint was violated"],[ye.ConstraintRentExempt,"A rent exemption constraint was violated"],[ye.ConstraintSeeds,"A seeds constraint was violated"],[ye.ConstraintExecutable,"An executable constraint was violated"],[ye.ConstraintState,"A state constraint was violated"],[ye.ConstraintAssociated,"An associated constraint was violated"],[ye.ConstraintAssociatedInit,"An associated init constraint was violated"],[ye.ConstraintClose,"A close constraint was violated"],[ye.ConstraintAddress,"An address constraint was violated"],[ye.ConstraintZero,"Expected zero account discriminant"],[ye.ConstraintTokenMint,"A token mint constraint was violated"],[ye.ConstraintTokenOwner,"A token owner constraint was violated"],[ye.ConstraintMintMintAuthority,"A mint mint authority constraint was violated"],[ye.ConstraintMintFreezeAuthority,"A mint freeze authority constraint was violated"],[ye.ConstraintMintDecimals,"A mint decimals constraint was violated"],[ye.ConstraintSpace,"A space constraint was violated"],[ye.RequireViolated,"A require expression was violated"],[ye.RequireEqViolated,"A require_eq expression was violated"],[ye.RequireKeysEqViolated,"A require_keys_eq expression was violated"],[ye.RequireNeqViolated,"A require_neq expression was violated"],[ye.RequireKeysNeqViolated,"A require_keys_neq expression was violated"],[ye.RequireGtViolated,"A require_gt expression was violated"],[ye.RequireGteViolated,"A require_gte expression was violated"],[ye.AccountDiscriminatorAlreadySet,"The account discriminator was already set on this account"],[ye.AccountDiscriminatorNotFound,"No 8 byte discriminator was found on the account"],[ye.AccountDiscriminatorMismatch,"8 byte discriminator did not match what was expected"],[ye.AccountDidNotDeserialize,"Failed to deserialize the account"],[ye.AccountDidNotSerialize,"Failed to serialize the account"],[ye.AccountNotEnoughKeys,"Not enough account keys given to the instruction"],[ye.AccountNotMutable,"The given account is not mutable"],[ye.AccountOwnedByWrongProgram,"The given account is owned by a different program than expected"],[ye.InvalidProgramId,"Program ID was not as expected"],[ye.InvalidProgramExecutable,"Program account is not executable"],[ye.AccountNotSigner,"The given account did not sign"],[ye.AccountNotSystemOwned,"The given account is not owned by the system program"],[ye.AccountNotInitialized,"The program expected this account to be already initialized"],[ye.AccountNotProgramData,"The given account is not a program data account"],[ye.AccountNotAssociatedTokenAccount,"The given account is not the associated token account"],[ye.AccountSysvarMismatch,"The given public key does not match the required sysvar"],[ye.StateInvalidAddress,"The given state account does not have the correct address"],[ye.DeclaredProgramIdMismatch,"The declared program id does not match the actual program id"],[ye.Deprecated,"The API being used is deprecated and should no longer be used"]]);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var hc=function(){return hc=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i]);return r},hc.apply(this,arguments)};function Av(r){return r.toLowerCase()}var Iv=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],Ev=/[^A-Z0-9]+/gi;function vh(r,e,t){return e instanceof RegExp?r.replace(e,t):e.reduce(function(n,i){return n.replace(i,t)},r)}function Pv(r,e){return e===void 0&&(e={}),function(t,n){n===void 0&&(n={});for(var i=n.splitRegexp,s=i===void 0?Iv:i,o=n.stripRegexp,a=o===void 0?Ev:o,c=n.transform,l=c===void 0?Av:c,u=n.delimiter,f=u===void 0?" ":u,m=vh(vh(t,s,"$1\0$2"),a,"\0"),y=0,S=m.length;m.charAt(y)==="\0";)y++;for(;m.charAt(S-1)==="\0";)S--;return m.slice(y,S).split("\0").map(l).join(f)}(r,hc({delimiter:"."},e))}class Rn{static fieldLayout(e,t){const n=e.name!==void 0?jt(e.name):void 0;switch(e.type){case"bool":return Ae.bool(n);case"u8":return Ae.u8(n);case"i8":return Ae.i8(n);case"u16":return Ae.u16(n);case"i16":return Ae.i16(n);case"u32":return Ae.u32(n);case"i32":return Ae.i32(n);case"f32":return Ae.f32(n);case"u64":return Ae.u64(n);case"i64":return Ae.i64(n);case"f64":return Ae.f64(n);case"u128":return Ae.u128(n);case"i128":return Ae.i128(n);case"bytes":return Ae.vecU8(n);case"string":return Ae.str(n);case"publicKey":return Ae.publicKey(n);default:if("vec"in e.type)return Ae.vec(Rn.fieldLayout({name:void 0,type:e.type.vec},t),n);if("option"in e.type)return Ae.option(Rn.fieldLayout({name:void 0,type:e.type.option},t),n);if("defined"in e.type){const i=e.type.defined;if(t===void 0)throw new Wo("User defined types not provided");const s=t.filter(o=>o.name===i);if(s.length!==1)throw new Wo(`Type not found: ${JSON.stringify(e)}`);return Rn.typeDefLayout(s[0],t,n)}if("array"in e.type){let i=e.type.array[0],s=e.type.array[1],o=Rn.fieldLayout({name:void 0,type:i},t);return Ae.array(o,s,n)}throw new Error(`Not yet implemented: ${e}`)}}static typeDefLayout(e,t=[],n){if(e.type.kind==="struct"){const i=e.type.fields.map(s=>Rn.fieldLayout(s,t));return Ae.struct(i,n)}if(e.type.kind==="enum"){let i=e.type.variants.map(s=>{const o=jt(s.name);if(s.fields===void 0)return Ae.struct([],o);const a=s.fields.map(c=>{if(!c.hasOwnProperty("name"))throw new Error("Tuple enum variants not yet implemented.");return Rn.fieldLayout(c,t)});return Ae.struct(a,o)});return n!==void 0?Ae.rustEnum(i).replicate(n):Ae.rustEnum(i,n)}throw new Error(`Unknown type kint: ${e}`)}}class nu{constructor(e){this.idl=e,this.ixLayout=nu.parseIxLayout(e);const t=new Map;e.instructions.forEach(n=>{const i=gl("global",n.name);t.set(pe.encode(i),{layout:this.ixLayout.get(n.name),name:n.name})}),e.state&&e.state.methods.map(n=>{const i=gl("state",n.name);t.set(pe.encode(i),{layout:this.ixLayout.get(n.name),name:n.name})}),this.sighashLayouts=t}encode(e,t){return this._encode("global",e,t)}encodeState(e,t){return this._encode("state",e,t)}_encode(e,t,n){const i=L.Buffer.alloc(1e3),s=jt(t),o=this.ixLayout.get(s);if(!o)throw new Error(`Unknown method: ${s}`);const a=o.encode(n,i),c=i.slice(0,a);return L.Buffer.concat([gl(e,t),c])}static parseIxLayout(e){const t=(e.state?e.state.methods:[]).map(n=>{let i=n.args.map(o=>{var a,c;return Rn.fieldLayout(o,Array.from([...(a=e.accounts)!==null&&a!==void 0?a:[],...(c=e.types)!==null&&c!==void 0?c:[]]))});const s=jt(n.name);return[s,Ae.struct(i,s)]}).concat(e.instructions.map(n=>{let i=n.args.map(o=>{var a,c;return Rn.fieldLayout(o,Array.from([...(a=e.accounts)!==null&&a!==void 0?a:[],...(c=e.types)!==null&&c!==void 0?c:[]]))});const s=jt(n.name);return[s,Ae.struct(i,s)]}));return new Map(t)}decode(e,t="hex"){typeof e=="string"&&(e=t==="hex"?L.Buffer.from(e,"hex"):pe.decode(e));let n=pe.encode(e.slice(0,8)),i=e.slice(8);const s=this.sighashLayouts.get(n);return s?{data:s.layout.decode(i),name:s.name}:null}format(e,t){return Pr.format(e,t,this.idl)}}class Pr{static format(e,t,n){const i=n.instructions.filter(a=>e.name===a.name)[0];if(i===void 0)return console.error("Invalid instruction given"),null;const s=i.args.map(a=>({name:a.name,type:Pr.formatIdlType(a.type),data:Pr.formatIdlData(a,e.data[a.name],n.types)})),o=Pr.flattenIdlAccounts(i.accounts);return{args:s,accounts:t.map((a,c)=>c<o.length?{name:o[c].name,...a}:{name:void 0,...a})}}static formatIdlType(e){if(typeof e=="string")return e;if("vec"in e)return`Vec<${this.formatIdlType(e.vec)}>`;if("option"in e)return`Option<${this.formatIdlType(e.option)}>`;if("defined"in e)return e.defined;if("array"in e)return`Array<${e.array[0]}; ${e.array[1]}>`;throw new Error(`Unknown IDL type: ${e}`)}static formatIdlData(e,t,n){if(typeof e.type=="string")return t.toString();if(e.type.hasOwnProperty("vec"))return"["+t.map(i=>this.formatIdlData({name:"",type:e.type.vec},i)).join(", ")+"]";if(e.type.hasOwnProperty("option"))return t===null?"null":this.formatIdlData({name:"",type:e.type.option},t,n);if(e.type.hasOwnProperty("defined")){if(n===void 0)throw new Error("User defined types not provided");const i=n.filter(s=>s.name===e.type.defined);if(i.length!==1)throw new Error(`Type not found: ${e.type.defined}`);return Pr.formatIdlDataDefined(i[0],t,n)}return"unknown"}static formatIdlDataDefined(e,t,n){if(e.type.kind==="struct"){const i=e.type;return"{ "+Object.keys(t).map(s=>{const o=i.fields.filter(a=>a.name===s)[0];if(o===void 0)throw new Error("Unable to find type");return s+": "+Pr.formatIdlData(o,t[s],n)}).join(", ")+" }"}if(e.type.variants.length===0)return"{}";if(e.type.variants[0].name){const i=e.type.variants,s=Object.keys(t)[0],o=t[s],a=Object.keys(o).map(l=>{var u;const f=o[l],m=(u=i[s])===null||u===void 0?void 0:u.filter(y=>y.name===l)[0];if(m===void 0)throw new Error("Unable to find variant");return l+": "+Pr.formatIdlData(m,f,n)}).join(", "),c=jt(s,{pascalCase:!0});return a.length===0?c:`${c} { ${a} }`}return"Tuple formatting not yet implemented"}static flattenIdlAccounts(e,t){return e.map(n=>{const i=function(s){const o=s.replace(/([A-Z])/g," $1");return o.charAt(0).toUpperCase()+o.slice(1)}(n.name);if(n.hasOwnProperty("accounts")){const s=t?`${t} > ${i}`:i;return Pr.flattenIdlAccounts(n.accounts,s)}return{...n,name:t?`${t} > ${i}`:i}}).flat()}}function gl(r,e){var t;let n=`${r}:${t===void 0&&(t={}),Pv(e,hc({delimiter:"_"},t))}`;return L.Buffer.from($i.exports.sha256.digest(n)).slice(0,8)}function Zd(r,e){if(e.type.kind==="enum"){let t=e.type.variants.map(n=>n.fields===void 0?0:n.fields.map(i=>{if(typeof i!="object"||!("name"in i))throw new Error("Tuple enum variants not yet implemented.");return Po(r,i.type)}).reduce((i,s)=>i+s));return Math.max(...t)+1}return e.type.fields===void 0?0:e.type.fields.map(t=>Po(r,t.type)).reduce((t,n)=>t+n,0)}function Po(r,e){var t,n;switch(e){case"bool":case"u8":case"i8":case"bytes":case"string":return 1;case"i16":case"u16":return 2;case"u32":case"i32":case"f32":return 4;case"u64":case"i64":case"f64":return 8;case"u128":case"i128":return 16;case"publicKey":return 32;default:if("vec"in e)return 1;if("option"in e)return 1+Po(r,e.option);if("coption"in e)return 4+Po(r,e.coption);if("defined"in e){const i=(n=(t=r.types)===null||t===void 0?void 0:t.filter(s=>s.name===e.defined))!==null&&n!==void 0?n:[];if(i.length!==1)throw new Wo(`Type not found: ${JSON.stringify(e)}`);return Zd(r,i[0])}if("array"in e){let i=e.array[0],s=e.array[1];return Po(r,i)*s}throw new Error(`Invalid type ${JSON.stringify(e)}`)}}const Rv=8;class vs{constructor(e){if(e.accounts===void 0)return void(this.accountLayouts=new Map);const t=e.accounts.map(n=>[n.name,Rn.typeDefLayout(n,e.types)]);this.accountLayouts=new Map(t),this.idl=e}async encode(e,t){const n=L.Buffer.alloc(1e3),i=this.accountLayouts.get(e);if(!i)throw new Error(`Unknown account: ${e}`);const s=i.encode(t,n);let o=n.slice(0,s),a=vs.accountDiscriminator(e);return L.Buffer.concat([a,o])}decode(e,t){if(vs.accountDiscriminator(e).compare(t.slice(0,8)))throw new Error("Invalid account discriminator");return this.decodeUnchecked(e,t)}decodeUnchecked(e,t){const n=t.slice(8),i=this.accountLayouts.get(e);if(!i)throw new Error(`Unknown account: ${e}`);return i.decode(n)}memcmp(e,t){const n=vs.accountDiscriminator(e);return{offset:0,bytes:pe.encode(t?L.Buffer.concat([n,t]):n)}}size(e){var t;return 8+((t=Zd(this.idl,e))!==null&&t!==void 0?t:0)}static accountDiscriminator(e){return L.Buffer.from($i.exports.sha256.digest(`account:${jt(e,{pascalCase:!0})}`)).slice(0,8)}}class Uy{constructor(e){if(e.events===void 0)return void(this.layouts=new Map);const t=e.events.map(n=>{let i={name:n.name,type:{kind:"struct",fields:n.fields.map(s=>({name:s.name,type:s.type}))}};return[n.name,Rn.typeDefLayout(i,e.types)]});this.layouts=new Map(t),this.discriminators=new Map(e.events===void 0?[]:e.events.map(n=>[Vl(Fy(n.name)),n.name]))}decode(e){let t;try{t=L.Buffer.from(Fp(e))}catch{return null}const n=Vl(t.slice(0,8)),i=this.discriminators.get(n);if(i===void 0)return null;const s=this.layouts.get(i);if(!s)throw new Error(`Unknown event: ${i}`);return{data:s.decode(t.slice(8)),name:i}}}function Fy(r){return L.Buffer.from($i.exports.sha256.digest(`event:${r}`)).slice(0,8)}class jy{constructor(e){if(e.state===void 0)throw new Error("Idl state not defined.");this.layout=Rn.typeDefLayout(e.state.struct,e.types)}async encode(e,t){const n=L.Buffer.alloc(1e3),i=this.layout.encode(t,n),s=await ef(e),o=n.slice(0,i);return L.Buffer.concat([s,o])}decode(e){const t=e.slice(8);return this.layout.decode(t)}}async function ef(r){let e=tu("anchor-deprecated-state")?"account":"state";return L.Buffer.from($i.exports.sha256.digest(`${e}:${r}`)).slice(0,8)}class ru{constructor(e){this.instruction=new nu(e),this.accounts=new vs(e),this.events=new Uy(e),e.state&&(this.state=new jy(e))}}var Tv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ge.global<"u"?ge.global:typeof self<"u"?self:{};function Ov(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}class xn{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}decode(e,t){throw new Error("Layout is abstract")}encode(e,t,n){throw new Error("Layout is abstract")}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}var qy=xn;class ki extends xn{isCount(){throw new Error("ExternalLayout is abstract")}}class Bv extends ki{constructor(e,t,n){if(!(e instanceof xn))throw new TypeError("layout must be a Layout");if(t===void 0)t=0;else if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,n||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof iu||this.layout instanceof Gy}decode(e,t){return t===void 0&&(t=0),this.layout.decode(e,t+this.offset)}encode(e,t,n){return n===void 0&&(n=0),this.layout.encode(e,t,n+this.offset)}}class iu extends xn{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntLE(t,this.span)}encode(e,t,n){return n===void 0&&(n=0),t.writeUIntLE(e,n,this.span),this.span}}class Gy extends xn{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntBE(t,this.span)}encode(e,t,n){return n===void 0&&(n=0),t.writeUIntBE(e,n,this.span),this.span}}const ml=Math.pow(2,32);class xv extends xn{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const n=e.readUInt32LE(t);return function(i,s){return i*ml+s}(e.readUInt32LE(t+4),n)}encode(e,t,n){n===void 0&&(n=0);const i=function(s){const o=Math.floor(s/ml);return{hi32:o,lo32:s-o*ml}}(e);return t.writeUInt32LE(i.lo32,n),t.writeUInt32LE(i.hi32,n+4),8}}class Cv extends xn{constructor(e,t,n){if(!Array.isArray(e)||!e.reduce((s,o)=>s&&o instanceof xn,!0))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&n===void 0&&(n=t,t=void 0);for(const s of e)if(0>s.span&&s.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let i=-1;try{i=e.reduce((s,o)=>s+o.getSpan(),0)}catch{}super(i,t),this.fields=e,this.decodePrefixes=!!n}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let n=0;try{n=this.fields.reduce((i,s)=>{const o=s.getSpan(e,t);return t+=o,i+o},0)}catch{throw new RangeError("indeterminate span")}return n}decode(e,t){t===void 0&&(t=0);const n=this.makeDestinationObject();for(const i of this.fields)if(i.property!==void 0&&(n[i.property]=i.decode(e,t)),t+=i.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return n}encode(e,t,n){n===void 0&&(n=0);const i=n;let s=0,o=0;for(const a of this.fields){let c=a.span;if(o=0<c?c:0,a.property!==void 0){const l=e[a.property];l!==void 0&&(o=a.encode(l,t,n),0>c&&(c=a.getSpan(t,n)))}s=n,n+=c}return s+o-i}fromArray(e){const t=this.makeDestinationObject();for(const n of this.fields)n.property!==void 0&&0<e.length&&(t[n.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const n of this.fields){if(n.property===e)return t;0>n.span?t=-1:0<=t&&(t+=n.span)}}}class Hy{constructor(e){this.property=e}decode(){throw new Error("UnionDiscriminator is abstract")}encode(){throw new Error("UnionDiscriminator is abstract")}}class _h extends Hy{constructor(e,t){if(!(e instanceof ki&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,n){return this.layout.encode(e,t,n)}}class Yy extends xn{constructor(e,t,n){const i=e instanceof iu||e instanceof Gy;if(i)e=new _h(new Bv(e));else if(e instanceof ki&&e.isCount())e=new _h(e);else if(!(e instanceof Hy))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(t===void 0&&(t=null),!(t===null||t instanceof xn))throw new TypeError("defaultLayout must be null or a Layout");if(t!==null){if(0>t.span)throw new Error("defaultLayout must have constant span");t.property===void 0&&(t=t.replicate("content"))}let s=-1;t&&(s=t.span,0<=s&&i&&(s+=e.layout.span)),super(s,n),this.discriminator=e,this.usesPrefixDiscriminator=i,this.defaultLayout=t,this.registry={};let o=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(a){return o(a)},this.configGetSourceVariant=function(a){o=a.bind(this)}}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);const n=this.getVariant(e,t);if(!n)throw new Error("unable to determine span for unrecognized variant");return n.getSpan(e,t)}defaultGetSourceVariant(e){if(e.hasOwnProperty(this.discriminator.property)){if(this.defaultLayout&&e.hasOwnProperty(this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||e.hasOwnProperty(t.property)))return t}else for(const t in this.registry){const n=this.registry[t];if(e.hasOwnProperty(n.property))return n}throw new Error("unable to infer src variant")}decode(e,t){let n;t===void 0&&(t=0);const i=this.discriminator,s=i.decode(e,t);let o=this.registry[s];if(o===void 0){let a=0;o=this.defaultLayout,this.usesPrefixDiscriminator&&(a=i.layout.span),n=this.makeDestinationObject(),n[i.property]=s,n[o.property]=this.defaultLayout.decode(e,t+a)}else n=o.decode(e,t);return n}encode(e,t,n){n===void 0&&(n=0);const i=this.getSourceVariant(e);if(i===void 0){const s=this.discriminator,o=this.defaultLayout;let a=0;return this.usesPrefixDiscriminator&&(a=s.layout.span),s.encode(e[s.property],t,n),a+o.encode(e[o.property],t,n+a)}return i.encode(e,t,n)}addVariant(e,t,n){const i=new Mv(this,e,t,n);return this.registry[e]=i,i}getVariant(e,t){let n=e;return ge.Buffer.isBuffer(e)&&(t===void 0&&(t=0),n=this.discriminator.decode(e,t)),this.registry[n]}}class Mv extends xn{constructor(e,t,n,i){if(!(e instanceof Yy))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if(typeof n=="string"&&i===void 0&&(i=n,n=null),n){if(!(n instanceof xn))throw new TypeError("layout must be a Layout");if(e.defaultLayout!==null&&0<=n.span&&n.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof i!="string")throw new TypeError("variant must have a String property")}let s=e.span;0>e.span&&(s=n?n.span:0,0<=s&&e.usesPrefixDiscriminator&&(s+=e.discriminator.layout.span)),super(s,i),this.union=e,this.variant=t,this.layout=n||null}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let n=0;return this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),n+this.layout.getSpan(e,t+n)}decode(e,t){const n=this.makeDestinationObject();if(t===void 0&&(t=0),this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let i=0;return this.union.usesPrefixDiscriminator&&(i=this.union.discriminator.layout.span),this.layout?n[this.property]=this.layout.decode(e,t+i):this.property?n[this.property]=!0:this.union.usesPrefixDiscriminator&&(n[this.union.discriminator.property]=this.variant),n}encode(e,t,n){n===void 0&&(n=0);let i=0;if(this.union.usesPrefixDiscriminator&&(i=this.union.discriminator.layout.span),this.layout&&!e.hasOwnProperty(this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,n);let s=i;if(this.layout&&(this.layout.encode(e[this.property],t,n+i),s+=this.layout.getSpan(t,n+i),0<=this.union.span&&s>this.union.span))throw new Error("encoded variant overruns containing union");return s}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}class Lv extends xn{constructor(e,t){if(!(e instanceof ki&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;e instanceof ki||(n=e),super(n,t),this.length=e}getSpan(e,t){let n=this.span;return 0>n&&(n=this.length.decode(e,t)),n}decode(e,t){t===void 0&&(t=0);let n=this.span;return 0>n&&(n=this.length.decode(e,t)),e.slice(t,t+n)}encode(e,t,n){let i=this.length;if(this.length instanceof ki&&(i=e.length),!ge.Buffer.isBuffer(e)||i!==e.length)throw new TypeError((s="Blob.encode",((o=this).property?s+"["+o.property+"]":s)+" requires (length "+i+") Buffer as src"));var s,o;if(n+i>t.length)throw new RangeError("encoding overruns Buffer");return t.write(e.toString("hex"),n,i,"hex"),this.length instanceof ki&&this.length.encode(i,t,n),i}}var Qt=r=>new iu(1,r),zr=r=>new xv(r),ht=(r,e,t)=>new Cv(r,e,t),su=(r,e)=>new Lv(r,e);class Kv{constructor(e){}encode(e,t){switch(jt(e)){case"initializeMint":return function({decimals:n,mintAuthority:i,freezeAuthority:s}){return vt({initializeMint:{decimals:n,mintAuthority:i.toBuffer(),freezeAuthorityOption:!!s,freezeAuthority:(s||Y.default).toBuffer()}})}(t);case"initializeAccount":return vt({initializeAccount:{}});case"initializeMultisig":return function({m:n}){return vt({initializeMultisig:{m:n}})}(t);case"transfer":return function({amount:n}){return vt({transfer:{amount:n}})}(t);case"approve":return function({amount:n}){return vt({approve:{amount:n}})}(t);case"revoke":return vt({revoke:{}});case"setAuthority":return function({authorityType:n,newAuthority:i}){return vt({setAuthority:{authorityType:n,newAuthority:i}})}(t);case"mintTo":return function({amount:n}){return vt({mintTo:{amount:n}})}(t);case"burn":return function({amount:n}){return vt({burn:{amount:n}})}(t);case"closeAccount":return vt({closeAccount:{}});case"freezeAccount":return vt({freezeAccount:{}});case"thawAccount":return vt({thawAccount:{}});case"transferChecked":return function({amount:n,decimals:i}){return vt({transferChecked:{amount:n,decimals:i}})}(t);case"approvedChecked":return function({amount:n,decimals:i}){return vt({approveChecked:{amount:n,decimals:i}})}(t);case"mintToChecked":return function({amount:n,decimals:i}){return vt({mintToChecked:{amount:n,decimals:i}})}(t);case"burnChecked":return function({amount:n,decimals:i}){return vt({burnChecked:{amount:n,decimals:i}})}(t);case"intializeAccount2":return function({authority:n}){return vt({initilaizeAccount2:{authority:n}})}(t);case"syncNative":return vt({syncNative:{}});case"initializeAccount3":return function({authority:n}){return vt({initializeAccount3:{authority:n}})}(t);case"initializeMultisig2":return function({m:n}){return vt({initializeMultisig2:{m:n}})}(t);case"initializeMint2":return function({decimals:n,mintAuthority:i,freezeAuthority:s}){return vt({encodeInitializeMint2:{decimals:n,mintAuthority:i,freezeAuthority:s}})}(t);default:throw new Error(`Invalid instruction: ${e}`)}}encodeState(e,t){throw new Error("SPL token does not have state")}}const pt=(Ah=Qt("instruction"),new Yy(Ah,Nv,Dv));var Ah,Nv,Dv;function ts(r){return su(32,r)}function vt(r){let e=ge.Buffer.alloc($v),t=pt.encode(r,e);return e.slice(0,t)}pt.addVariant(0,ht([Qt("decimals"),su(32,"mintAuthority"),Qt("freezeAuthorityOption"),ts("freezeAuthority")]),"initializeMint"),pt.addVariant(1,ht([]),"initializeAccount"),pt.addVariant(2,ht([Qt("m")]),"initializeMultisig"),pt.addVariant(3,ht([zr("amount")]),"transfer"),pt.addVariant(4,ht([zr("amount")]),"approve"),pt.addVariant(5,ht([]),"revoke"),pt.addVariant(6,ht([Qt("authorityType"),Qt("newAuthorityOption"),ts("newAuthority")]),"setAuthority"),pt.addVariant(7,ht([zr("amount")]),"mintTo"),pt.addVariant(8,ht([zr("amount")]),"burn"),pt.addVariant(9,ht([]),"closeAccount"),pt.addVariant(10,ht([]),"freezeAccount"),pt.addVariant(11,ht([]),"thawAccount"),pt.addVariant(12,ht([zr("amount"),Qt("decimals")]),"transferChecked"),pt.addVariant(13,ht([zr("amount"),Qt("decimals")]),"approvedChecked"),pt.addVariant(14,ht([zr("amount"),Qt("decimals")]),"mintToChecked"),pt.addVariant(15,ht([zr("amount"),Qt("decimals")]),"burnedChecked"),pt.addVariant(16,ht([ts("authority")]),"InitializeAccount2"),pt.addVariant(17,ht([]),"syncNative"),pt.addVariant(18,ht([ts("authority")]),"initializeAccount3"),pt.addVariant(19,ht([Qt("m")]),"initializeMultisig2"),pt.addVariant(20,ht([Qt("decimals"),ts("mintAuthority"),Qt("freezeAuthorityOption"),ts("freezeAuthority")]),"initializeMint2");const $v=Math.max(...Object.values(pt.registry).map(r=>r.span));class zv{constructor(e){}encode(e,t){throw new Error("SPL token does not have state")}decode(e){throw new Error("SPL token does not have state")}}function Za(r){return new tf(su(8),e=>nf.fromBuffer(e),e=>e.toBuffer(),r)}function ds(r){return new tf(su(32),e=>new Y(e),e=>e.toBuffer(),r)}function Ro(r,e){return new Wv(r,e)}class tf extends qy{constructor(e,t,n,i){super(e.span,i),this.layout=e,this.decoder=t,this.encoder=n}decode(e,t){return this.decoder(this.layout.decode(e,t))}encode(e,t,n){return this.layout.encode(this.encoder(e),t,n)}getSpan(e,t){return this.layout.getSpan(e,t)}}class Wv extends qy{constructor(e,t){super(-1,t),this.layout=e,this.discriminator=(n=>new iu(4,n))()}encode(e,t,n=0){return e==null?this.layout.span+this.discriminator.encode(0,t,n):(this.discriminator.encode(1,t,n),this.layout.encode(e,t,n+4)+4)}decode(e,t=0){const n=this.discriminator.decode(e,t);if(n===0)return null;if(n===1)return this.layout.decode(e,t+4);throw new Error("Invalid coption "+this.layout.property)}getSpan(e,t=0){return this.layout.getSpan(e,t+4)+4}}function Vv(r){if(r===0)return!1;if(r===1)return!0;throw new Error("Invalid bool: "+r)}function Uv(r){return r?1:0}class nf extends Qn{toBuffer(){const e=super.toArray().reverse(),t=ge.Buffer.from(e);if(t.length===8)return t;if(t.length>=8)throw new Error("u64 too large");const n=ge.Buffer.alloc(8);return t.copy(n),n}static fromBuffer(e){if(e.length!==8)throw new Error(`Invalid buffer length: ${e.length}`);return new nf([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}class Fv{constructor(e){this.idl=e}async encode(e,t){switch(e){case"token":{const n=ge.Buffer.alloc(165),i=Eh.encode(t,n);return n.slice(0,i)}case"mint":{const n=ge.Buffer.alloc(82),i=Ih.encode(t,n);return n.slice(0,i)}default:throw new Error(`Invalid account name: ${e}`)}}decode(e,t){return this.decodeUnchecked(e,t)}decodeUnchecked(e,t){switch(e){case"token":return function(n){return Eh.decode(n)}(t);case"mint":return function(n){return Ih.decode(n)}(t);default:throw new Error(`Invalid account name: ${e}`)}}memcmp(e,t){switch(e){case"token":return{dataSize:165};case"mint":return{dataSize:82};default:throw new Error(`Invalid account name: ${e}`)}}size(e){var t;return(t=Zd(this.idl,e))!==null&&t!==void 0?t:0}}const Ih=ht([Ro(ds(),"mintAuthority"),Za("supply"),Qt("decimals"),function(r){return new tf(Qt(),Vv,Uv,r)}("isInitialized"),Ro(ds(),"freezeAuthority")]),Eh=ht([ds("mint"),ds("authority"),Za("amount"),Ro(ds(),"delegate"),Qt("state"),Ro(Za(),"isNative"),Za("delegatedAmount"),Ro(ds(),"closeAuthority")]);class jv{constructor(e){}decode(e){throw new Error("SPL token program does not have events")}}class Jy{constructor(e){this.instruction=new Kv(e),this.accounts=new Fv(e),this.events=new jv(e),this.state=new zv(e)}}var qv=Object.freeze({__proto__:null,hash:function(r){return $i.exports.sha256(r)}});function Qy(r,e,t){const n=L.Buffer.concat([r.toBuffer(),L.Buffer.from(e),t.toBuffer()]),i=$i.exports.sha256.digest(n);return new Y(L.Buffer.from(i))}function Xy(r,e){let t=L.Buffer.alloc(0);r.forEach(function(s){if(s.length>32)throw new TypeError("Max seed length exceeded");t=L.Buffer.concat([t,Gv(s)])}),t=L.Buffer.concat([t,e.toBuffer(),L.Buffer.from("ProgramDerivedAddress")]);let n=$i.exports.sha256(new Uint8Array(t)),i=new Qn(n,16).toArray(void 0,32);if(Y.isOnCurve(new Uint8Array(i)))throw new Error("Invalid seeds, address must fall off the curve");return new Y(i)}function rf(r,e){let t,n=255;for(;n!=0;){try{t=Xy(r.concat(L.Buffer.from([n])),e)}catch(i){if(i instanceof TypeError)throw i;n--;continue}return[t,n]}throw new Error("Unable to find a viable program address nonce")}const Gv=r=>r instanceof L.Buffer?r:r instanceof Uint8Array?L.Buffer.from(r.buffer,r.byteOffset,r.byteLength):L.Buffer.from(r);async function Zy(r,...e){let t=[L.Buffer.from([97,110,99,104,111,114])];e.forEach(i=>{t.push(i instanceof L.Buffer?i:qn(i).toBuffer())});const[n]=await Y.findProgramAddress(t,qn(r));return n}var Hv=Object.freeze({__proto__:null,createWithSeedSync:Qy,createProgramAddressSync:Xy,findProgramAddressSync:rf,associated:Zy});const Ql=new Y("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),Xl=new Y("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");var Yv=Object.freeze({__proto__:null,TOKEN_PROGRAM_ID:Ql,ASSOCIATED_PROGRAM_ID:Xl,associatedAddress:async function({mint:r,owner:e}){return(await Y.findProgramAddress([e.toBuffer(),Ql.toBuffer(),r.toBuffer()],Xl))[0]}}),Zl={exports:{}};(function(r,e){var t=typeof self<"u"?self:Tv,n=function(){function s(){this.fetch=!1,this.DOMException=t.DOMException}return s.prototype=t,new s}();(function(s){(function(o){var a="URLSearchParams"in s,c="Symbol"in s&&"iterator"in Symbol,l="FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),u="FormData"in s,f="ArrayBuffer"in s;if(f)var m=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],y=ArrayBuffer.isView||function(I){return I&&m.indexOf(Object.prototype.toString.call(I))>-1};function S(I){if(typeof I!="string"&&(I=String(I)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(I))throw new TypeError("Invalid character in header field name");return I.toLowerCase()}function p(I){return typeof I!="string"&&(I=String(I)),I}function w(I){var $={next:function(){var G=I.shift();return{done:G===void 0,value:G}}};return c&&($[Symbol.iterator]=function(){return $}),$}function v(I){this.map={},I instanceof v?I.forEach(function($,G){this.append(G,$)},this):Array.isArray(I)?I.forEach(function($){this.append($[0],$[1])},this):I&&Object.getOwnPropertyNames(I).forEach(function($){this.append($,I[$])},this)}function E(I){if(I.bodyUsed)return Promise.reject(new TypeError("Already read"));I.bodyUsed=!0}function P(I){return new Promise(function($,G){I.onload=function(){$(I.result)},I.onerror=function(){G(I.error)}})}function K(I){var $=new FileReader,G=P($);return $.readAsArrayBuffer(I),G}function T(I){if(I.slice)return I.slice(0);var $=new Uint8Array(I.byteLength);return $.set(new Uint8Array(I)),$.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(I){var $;this._bodyInit=I,I?typeof I=="string"?this._bodyText=I:l&&Blob.prototype.isPrototypeOf(I)?this._bodyBlob=I:u&&FormData.prototype.isPrototypeOf(I)?this._bodyFormData=I:a&&URLSearchParams.prototype.isPrototypeOf(I)?this._bodyText=I.toString():f&&l&&($=I)&&DataView.prototype.isPrototypeOf($)?(this._bodyArrayBuffer=T(I.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):f&&(ArrayBuffer.prototype.isPrototypeOf(I)||y(I))?this._bodyArrayBuffer=T(I):this._bodyText=I=Object.prototype.toString.call(I):this._bodyText="",this.headers.get("content-type")||(typeof I=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a&&URLSearchParams.prototype.isPrototypeOf(I)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l&&(this.blob=function(){var I=E(this);if(I)return I;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?E(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(K)}),this.text=function(){var I=E(this);if(I)return I;if(this._bodyBlob)return function($){var G=new FileReader,ke=P(G);return G.readAsText($),ke}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function($){for(var G=new Uint8Array($),ke=new Array(G.length),ae=0;ae<G.length;ae++)ke[ae]=String.fromCharCode(G[ae]);return ke.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},u&&(this.formData=function(){return this.text().then(W)}),this.json=function(){return this.text().then(JSON.parse)},this}v.prototype.append=function(I,$){I=S(I),$=p($);var G=this.map[I];this.map[I]=G?G+", "+$:$},v.prototype.delete=function(I){delete this.map[S(I)]},v.prototype.get=function(I){return I=S(I),this.has(I)?this.map[I]:null},v.prototype.has=function(I){return this.map.hasOwnProperty(S(I))},v.prototype.set=function(I,$){this.map[S(I)]=p($)},v.prototype.forEach=function(I,$){for(var G in this.map)this.map.hasOwnProperty(G)&&I.call($,this.map[G],G,this)},v.prototype.keys=function(){var I=[];return this.forEach(function($,G){I.push(G)}),w(I)},v.prototype.values=function(){var I=[];return this.forEach(function($){I.push($)}),w(I)},v.prototype.entries=function(){var I=[];return this.forEach(function($,G){I.push([G,$])}),w(I)},c&&(v.prototype[Symbol.iterator]=v.prototype.entries);var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function R(I,$){var G,ke,ae=($=$||{}).body;if(I instanceof R){if(I.bodyUsed)throw new TypeError("Already read");this.url=I.url,this.credentials=I.credentials,$.headers||(this.headers=new v(I.headers)),this.method=I.method,this.mode=I.mode,this.signal=I.signal,ae||I._bodyInit==null||(ae=I._bodyInit,I.bodyUsed=!0)}else this.url=String(I);if(this.credentials=$.credentials||this.credentials||"same-origin",!$.headers&&this.headers||(this.headers=new v($.headers)),this.method=(G=$.method||this.method||"GET",ke=G.toUpperCase(),_.indexOf(ke)>-1?ke:G),this.mode=$.mode||this.mode||null,this.signal=$.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&ae)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(ae)}function W(I){var $=new FormData;return I.trim().split("&").forEach(function(G){if(G){var ke=G.split("="),ae=ke.shift().replace(/\+/g," "),ve=ke.join("=").replace(/\+/g," ");$.append(decodeURIComponent(ae),decodeURIComponent(ve))}}),$}function B(I,$){$||($={}),this.type="default",this.status=$.status===void 0?200:$.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in $?$.statusText:"OK",this.headers=new v($.headers),this.url=$.url||"",this._initBody(I)}R.prototype.clone=function(){return new R(this,{body:this._bodyInit})},b.call(R.prototype),b.call(B.prototype),B.prototype.clone=function(){return new B(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new v(this.headers),url:this.url})},B.error=function(){var I=new B(null,{status:0,statusText:""});return I.type="error",I};var V=[301,302,303,307,308];B.redirect=function(I,$){if(V.indexOf($)===-1)throw new RangeError("Invalid status code");return new B(null,{status:$,headers:{location:I}})},o.DOMException=s.DOMException;try{new o.DOMException}catch{o.DOMException=function($,G){this.message=$,this.name=G;var ke=Error($);this.stack=ke.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function q(I,$){return new Promise(function(G,ke){var ae=new R(I,$);if(ae.signal&&ae.signal.aborted)return ke(new o.DOMException("Aborted","AbortError"));var ve=new XMLHttpRequest;function Dt(){ve.abort()}ve.onload=function(){var nn,me,Be={status:ve.status,statusText:ve.statusText,headers:(nn=ve.getAllResponseHeaders()||"",me=new v,nn.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(Yt){var $t=Yt.split(":"),ft=$t.shift().trim();if(ft){var rr=$t.join(":").trim();me.append(ft,rr)}}),me)};Be.url="responseURL"in ve?ve.responseURL:Be.headers.get("X-Request-URL");var Ut="response"in ve?ve.response:ve.responseText;G(new B(Ut,Be))},ve.onerror=function(){ke(new TypeError("Network request failed"))},ve.ontimeout=function(){ke(new TypeError("Network request failed"))},ve.onabort=function(){ke(new o.DOMException("Aborted","AbortError"))},ve.open(ae.method,ae.url,!0),ae.credentials==="include"?ve.withCredentials=!0:ae.credentials==="omit"&&(ve.withCredentials=!1),"responseType"in ve&&l&&(ve.responseType="blob"),ae.headers.forEach(function(nn,me){ve.setRequestHeader(me,nn)}),ae.signal&&(ae.signal.addEventListener("abort",Dt),ve.onreadystatechange=function(){ve.readyState===4&&ae.signal.removeEventListener("abort",Dt)}),ve.send(ae._bodyInit===void 0?null:ae._bodyInit)})}q.polyfill=!0,s.fetch||(s.fetch=q,s.Headers=v,s.Request=R,s.Response=B),o.Headers=v,o.Request=R,o.Response=B,o.fetch=q,Object.defineProperty(o,"__esModule",{value:!0})})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=n;(e=i.fetch).default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,r.exports=e})(Zl,Zl.exports);var Jv=Ov(Zl.exports);async function Ph(r,e){const t=await r.getAccountInfo(e);if(t===null)throw new Error("program account not found");const{program:n}=ed(t.data),i=await r.getAccountInfo(n.programdataAddress);if(i===null)throw new Error("program data account not found");const{programData:s}=ed(i.data);return s}const Qv=Ae.rustEnum([Ae.struct([],"uninitialized"),Ae.struct([Ae.option(Ae.publicKey(),"authorityAddress")],"buffer"),Ae.struct([Ae.publicKey("programdataAddress")],"program"),Ae.struct([Ae.u64("slot"),Ae.option(Ae.publicKey(),"upgradeAuthorityAddress")],"programData")],void 0,Ae.u32());function ed(r){return Qv.decode(r)}var Xv=Object.freeze({__proto__:null,verifiedBuild:async function(r,e,t=5){const n=`https://anchor.projectserum.com/api/v0/program/${e.toString()}/latest?limit=${t}`,[i,s]=await Promise.all([Ph(r,e),Jv(n)]),o=(await s.json()).filter(c=>!c.aborted&&c.state==="Built"&&c.verified==="Verified");if(o.length===0)return null;const a=o[0];return i.slot.toNumber()!==a.verified_slot?null:a},fetchData:Ph,decodeUpgradeableLoaderState:ed}),Zv=Object.freeze({__proto__:null,sha256:qv,rpc:wv,publicKey:Hv,bytes:hv,token:Yv,features:_v,registry:Xv});const e_=Ae.struct([Ae.publicKey("authority"),Ae.vecU8("data")]);function aa(r,e){var t,n;let i={};const s=r.args?r.args.length:0;if(e.length>s){if(e.length!==s+1)throw new Error(`provided too many arguments ${e} to instruction ${r==null?void 0:r.name} expecting: ${(n=(t=r.args)===null||t===void 0?void 0:t.map(o=>o.name))!==null&&n!==void 0?n:[]}`);i=e.pop()}return[e,i]}class Bs{static build(e,t,n){if(e.name==="_inner")throw new Wo("the _inner name is reserved");const i=(...s)=>{const[o,a]=aa(e,[...s]);eu(e.accounts,a.accounts);const c=i.accounts(a.accounts);return a.remainingAccounts!==void 0&&c.push(...a.remainingAccounts),tu("debug-logs")&&console.log("Outgoing account metas:",c),new Qe({keys:c,programId:n,data:t(e.name,xy(e,...o))})};return i.accounts=s=>Bs.accountsArray(s,e.accounts,e.name),i}static accountsArray(e,t,n){return e?t.map(i=>{if(("accounts"in i?i.accounts:void 0)!==void 0){const s=e[i.name];return Bs.accountsArray(s,i.accounts,n).flat()}{const s=i;let o;try{o=qn(e[i.name])}catch{throw new Error(`Wrong input type for account "${i.name}" in the instruction accounts object${n!==void 0?' for instruction "'+n+'"':""}. Expected PublicKey or string.`)}return{pubkey:o,isWritable:s.isMut,isSigner:s.isSigner}}}).flat():[]}}class eg{static build(e,t,n,i){return async(...s)=>{var o;const a=t(...s),[,c]=aa(e,[...s]);if(i.sendAndConfirm===void 0)throw new Error("This function requires 'Provider.sendAndConfirm' to be implemented.");try{return await i.sendAndConfirm(a,(o=c.signers)!==null&&o!==void 0?o:[],c.options)}catch(l){throw Xd(l,n)}}}}class tg{static build(e,t){return(...n)=>{var i,s,o;const[,a]=aa(e,[...n]),c=new ze;if(a.preInstructions&&a.instructions)throw new Error("instructions is deprecated, use preInstructions");return(i=a.preInstructions)===null||i===void 0||i.forEach(l=>c.add(l)),(s=a.instructions)===null||s===void 0||s.forEach(l=>c.add(l)),c.add(t(...n)),(o=a.postInstructions)===null||o===void 0||o.forEach(l=>c.add(l)),c}}}class ng{constructor(e,t,n=Os(),i=new ru(e)){this.provider=n,this.coder=i,this._idl=e,this._programId=t,this._address=bl(t),this._sub=null;const[s,o,a]=(()=>{var c;let l={},u={},f={};return(c=e.state)===null||c===void 0||c.methods.forEach(m=>{const y=Bs.build(m,(v,E)=>i.instruction.encodeState(v,E),t);y.accounts=v=>function(P,K,T,b){if(T.name==="new"){const[_]=rf([],P);if(K.wallet===void 0)throw new Error("This function requires the Provider interface implementor to have a 'wallet' field.");return[{pubkey:K.wallet.publicKey,isWritable:!1,isSigner:!0},{pubkey:bl(P),isWritable:!0,isSigner:!1},{pubkey:_,isWritable:!1,isSigner:!1},{pubkey:Et.programId,isWritable:!1,isSigner:!1},{pubkey:P,isWritable:!1,isSigner:!1}]}return eu(T.accounts,b),[{pubkey:bl(P),isWritable:!0,isSigner:!1}]}(t,n,m,v).concat(Bs.accountsArray(v,m.accounts,m.name));const S=tg.build(m,y),p=eg.build(m,S,Yd(e),n),w=jt(m.name);l[w]=y,u[w]=S,f[w]=p}),[l,u,f]})();this.instruction=s,this.transaction=o,this.rpc=a}get programId(){return this._programId}async fetch(){const e=this.address(),t=await this.provider.connection.getAccountInfo(e);if(t===null)throw new Error(`Account does not exist ${e.toString()}`);const n=this._idl.state;if(!n)throw new Error("State is not specified in IDL.");if((await ef(n.struct.name)).compare(t.data.slice(0,8)))throw new Error("Invalid account discriminator");return this.coder.state.decode(t.data)}address(){return this._address}subscribe(e){if(this._sub!==null)return this._sub.ee;const t=new jp,n=this.provider.connection.onAccountChange(this.address(),i=>{const s=this.coder.state.decode(i.data);t.emit("change",s)},e);return this._sub={ee:t,listener:n},t}unsubscribe(){this._sub!==null&&this.provider.connection.removeAccountChangeListener(this._sub.listener).then(async()=>{this._sub=null}).catch(console.error)}}function bl(r){let[e]=rf([],r);return Qy(e,"unversioned",r)}class rg{constructor(e,t,n,i,s){this._idlAccount=t,this._programId=n,this._provider=i??Os(),this._coder=s??new ru(e),this._size=this._coder.accounts.size(t)}get size(){return this._size}get programId(){return this._programId}get provider(){return this._provider}get coder(){return this._coder}async fetchNullable(e,t){const n=await this.getAccountInfo(e,t);return n===null?null:this._coder.accounts.decode(this._idlAccount.name,n.data)}async fetch(e,t){const n=await this.fetchNullable(e,t);if(n===null)throw new Error(`Account does not exist ${e.toString()}`);return n}async fetchMultiple(e,t){return(await Ky(this._provider.connection,e.map(n=>qn(n)),t)).map(n=>n==null?null:this._coder.accounts.decode(this._idlAccount.name,n==null?void 0:n.account.data))}async all(e){return(await this._provider.connection.getProgramAccounts(this._programId,{commitment:this._provider.connection.commitment,filters:[{memcmp:this.coder.accounts.memcmp(this._idlAccount.name,e instanceof ge.Buffer?e:void 0)},...Array.isArray(e)?e:[]]})).map(({pubkey:t,account:n})=>({publicKey:t,account:this._coder.accounts.decode(this._idlAccount.name,n.data)}))}subscribe(e,t){const n=go.get(e.toString());if(n)return n.ee;const i=new jp;e=qn(e);const s=this._provider.connection.onAccountChange(e,o=>{const a=this._coder.accounts.decode(this._idlAccount.name,o.data);i.emit("change",a)},t);return go.set(e.toString(),{ee:i,listener:s}),i}async unsubscribe(e){let t=go.get(e.toString());t?go&&await this._provider.connection.removeAccountChangeListener(t.listener).then(()=>{go.delete(e.toString())}).catch(console.error):console.warn("Address is not subscribed")}async createInstruction(e,t){const n=this.size;if(this._provider.wallet===void 0)throw new Error("This function requires the Provider interface implementor to have a 'wallet' field.");return Et.createAccount({fromPubkey:this._provider.wallet.publicKey,newAccountPubkey:e.publicKey,space:t??n,lamports:await this._provider.connection.getMinimumBalanceForRentExemption(t??n),programId:this._programId})}async associated(...e){const t=await this.associatedAddress(...e);return await this.fetch(t)}async associatedAddress(...e){return await Zy(this._programId,...e)}async getAccountInfo(e,t){return await this._provider.connection.getAccountInfo(qn(e),t)}}const go=new Map,t_=13,n_=14;class ig{constructor(e,t,n){this._programId=e,this._provider=t,this._eventParser=new sf(e,n),this._eventCallbacks=new Map,this._eventListeners=new Map,this._listenerIdCount=0}addEventListener(e,t){var n;let i=this._listenerIdCount;return this._listenerIdCount+=1,e in this._eventCallbacks||this._eventListeners.set(e,[]),this._eventListeners.set(e,((n=this._eventListeners.get(e))!==null&&n!==void 0?n:[]).concat(i)),this._eventCallbacks.set(i,[e,t]),this._onLogsSubscriptionId!==void 0||(this._onLogsSubscriptionId=this._provider.connection.onLogs(this._programId,(s,o)=>{s.err||this._eventParser.parseLogs(s.logs,a=>{const c=this._eventListeners.get(a.name);c&&c.forEach(l=>{const u=this._eventCallbacks.get(l);if(u){const[,f]=u;f(a.data,o.slot)}})})})),i}async removeEventListener(e){const t=this._eventCallbacks.get(e);if(!t)throw new Error(`Event listener ${e} doesn't exist!`);const[n]=t;let i=this._eventListeners.get(n);if(!i)throw new Error(`Event listeners don't exist for ${n}!`);this._eventCallbacks.delete(e),i=i.filter(s=>s!==e),i.length===0&&this._eventListeners.delete(n),this._eventCallbacks.size==0&&(uc.exports.ok(this._eventListeners.size===0),this._onLogsSubscriptionId!==void 0&&(await this._provider.connection.removeOnLogsListener(this._onLogsSubscriptionId),this._onLogsSubscriptionId=void 0))}}class sf{constructor(e,t){this.coder=t,this.programId=e}parseLogs(e,t){const n=new i_(e),i=new r_;let s=n.next();for(;s!==null;){let[o,a,c]=this.handleLog(i,s);o&&t(o),a&&i.push(a),c&&i.pop(),s=n.next()}}handleLog(e,t){return e.stack.length>0&&e.program()===this.programId.toString()?this.handleProgramLog(t):[null,...this.handleSystemLog(t)]}handleProgramLog(e){if(e.startsWith("Program log: ")||e.startsWith("Program data: ")){const t=e.startsWith("Program log: ")?e.slice(t_):e.slice(n_);return[this.coder.events.decode(t),null,!1]}return[null,...this.handleSystemLog(e)]}handleSystemLog(e){const t=e.split(":")[0];return t.match(/^Program (.*) success/g)!==null?[null,!0]:t.startsWith(`Program ${this.programId.toString()} invoke`)?[this.programId.toString(),!1]:t.includes("invoke")?["cpi",!1]:[null,!1]}}class r_{constructor(){this.stack=[]}program(){return uc.exports.ok(this.stack.length>0),this.stack[this.stack.length-1]}push(e){this.stack.push(e)}pop(){uc.exports.ok(this.stack.length>0),this.stack.pop()}}class i_{constructor(e){this.logs=e}next(){if(this.logs.length===0)return null;let e=this.logs[0];return this.logs=this.logs.slice(1),e}}const s_=new Y("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");function sg(){return new Jy(og)}const og={version:"0.1.0",name:"spl_token",instructions:[{name:"initializeMint",accounts:[{name:"mint",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"decimals",type:"u8"},{name:"mintAuthority",type:"publicKey"},{name:"freezeAuthority",type:{coption:"publicKey"}}]},{name:"initializeAccount",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[]},{name:"initializeMultisig",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"m",type:"u8"}]},{name:"transfer",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"destination",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"}]},{name:"approve",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"delegate",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"}]},{name:"revoke",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[]},{name:"setAuthority",accounts:[{name:"mint",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"authorityType",type:"u8"},{name:"newAuthority",type:{coption:"publicKey"}}]},{name:"mintTo",accounts:[{name:"mint",isMut:!0,isSigner:!1},{name:"to",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"}]},{name:"burn",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"mint",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"}]},{name:"closeAccount",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"destination",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!1}],args:[]},{name:"freezeAccount",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[]},{name:"thawAccount",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[]},{name:"transferChecked",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"destination",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"},{name:"decimals",type:"u8"}]},{name:"approveChecked",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"delegate",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"},{name:"decimals",type:"u8"}]},{name:"mintToChecked",accounts:[{name:"mint",isMut:!0,isSigner:!1},{name:"to",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"},{name:"decimals",type:"u8"}]},{name:"burnChecked",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"mint",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"},{name:"decimals",type:"u8"}]},{name:"initializeAccount2",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"authority",type:"publicKey"}]},{name:"syncNative",accounts:[{name:"account",isMut:!0,isSigner:!1}],args:[]},{name:"initializeAccount3",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1}],args:[{name:"authority",type:"publicKey"}]},{name:"initializeMultisig2",accounts:[{name:"account",isMut:!0,isSigner:!1}],args:[{name:"m",type:"u8"}]},{name:"initializeMint2",accounts:[{name:"mint",isMut:!0,isSigner:!1}],args:[{name:"decimals",type:"u8"},{name:"mintAuthority",type:"publicKey"},{name:"freezeAuthority",type:{coption:"publicKey"}}]}],accounts:[{name:"mint",type:{kind:"struct",fields:[{name:"mintAuthority",type:{coption:"publicKey"}},{name:"supply",type:"u64"},{name:"decimals",type:"u8"},{name:"isInitialized",type:"bool"},{name:"freezeAuthority",type:{coption:"publicKey"}}]}},{name:"token",type:{kind:"struct",fields:[{name:"mint",type:"publicKey"},{name:"authority",type:"publicKey"},{name:"amount",type:"u64"},{name:"delegate",type:{coption:"publicKey"}},{name:"state",type:"u8"},{name:"isNative",type:{coption:"u64"}},{name:"delegatedAmount",type:"u64"},{name:"closeAuthority",type:{coption:"publicKey"}}]}}]};class Uo{constructor(e,t,n,i,s,o){this._args=e,this._accounts=t,this._provider=n,this._programId=i,this._idlIx=s,this._accountStore=new o_(n,o)}async resolve(){for(let e=0;e<this._idlIx.accounts.length;e+=1){const t=this._idlIx.accounts[e],n=jt(t.name);if(t.pda&&t.pda.seeds.length>0&&!this._accounts[n])await this.autoPopulatePda(t);else if(!t.isSigner||this._accounts[n])Reflect.has(Uo.CONST_ACCOUNTS,n)&&!this._accounts[n]&&(this._accounts[n]=Uo.CONST_ACCOUNTS[n]);else{if(this._provider.wallet===void 0)throw new Error("This function requires the Provider interface implementor to have a 'wallet' field.");this._accounts[n]=this._provider.wallet.publicKey}}}async autoPopulatePda(e){if(!e.pda||!e.pda.seeds)throw new Error("Must have seeds");const t=await Promise.all(e.pda.seeds.map(s=>this.toBuffer(s))),n=await this.parseProgramId(e),[i]=await Y.findProgramAddress(t,n);this._accounts[jt(e.name)]=i}async parseProgramId(e){var t;if(!(!((t=e.pda)===null||t===void 0)&&t.programId))return this._programId;switch(e.pda.programId.kind){case"const":return new Y(this.toBufferConst(e.pda.programId.value));case"arg":return this.argValue(e.pda.programId);case"account":return await this.accountValue(e.pda.programId);default:throw new Error(`Unexpected program seed kind: ${e.pda.programId.kind}`)}}async toBuffer(e){switch(e.kind){case"const":return this.toBufferConst(e);case"arg":return await this.toBufferArg(e);case"account":return await this.toBufferAccount(e);default:throw new Error(`Unexpected seed kind: ${e.kind}`)}}toBufferConst(e){return this.toBufferValue(e.type,e.value)}async toBufferArg(e){const t=this.argValue(e);return this.toBufferValue(e.type,t)}argValue(e){const t=jt(e.path.split(".")[0]),n=this._idlIx.args.findIndex(i=>i.name===t);if(n===-1)throw new Error(`Unable to find argument for seed: ${t}`);return this._args[n]}async toBufferAccount(e){const t=await this.accountValue(e);return this.toBufferValue(e.type,t)}async accountValue(e){const t=e.path.split("."),n=t[0],i=this._accounts[jt(n)];if(t.length===1)return i;const s=await this._accountStore.fetchAccount(e.account,i);return this.parseAccountValue(s,t.slice(1))}parseAccountValue(e,t){let n;for(;t.length>0;)n=e[jt(t[0])],t=t.slice(1);return n}toBufferValue(e,t){switch(e){case"u8":return ge.Buffer.from([t]);case"u16":let n=ge.Buffer.alloc(2);return n.writeUInt16LE(t),n;case"u32":let i=ge.Buffer.alloc(4);return i.writeUInt32LE(t),i;case"u64":let s=ge.Buffer.alloc(8);return s.writeBigUInt64LE(BigInt(t)),s;case"string":return ge.Buffer.from(Ty(t));case"publicKey":return t.toBuffer();default:if(e.array)return ge.Buffer.from(t);throw new Error(`Unexpected seed type: ${e}`)}}}Uo.CONST_ACCOUNTS={systemProgram:Et.programId,tokenProgram:Ql,associatedTokenProgram:Xl,rent:Ri};class o_{constructor(e,t){this._provider=e,this._accounts=t,this._cache=new Map}async fetchAccount(e,t){const n=t.toString();if(!this._cache.has(n))if(e==="TokenAccount"){const i=await this._provider.connection.getAccountInfo(t);if(i===null)throw new Error(`invalid account info for ${n}`);const s=sg().accounts.decode("token",i.data);this._cache.set(n,s)}else{const i=this._accounts[jt(e)].fetch(t);this._cache.set(n,i)}return this._cache.get(n)}}class ag{static build(e,t,n,i,s,o,a,c,l){return(...u)=>new a_(u,i,s,o,a,c,e,t,n,l)}}class a_{constructor(e,t,n,i,s,o,a,c,l,u){this._args=e,this._ixFn=t,this._txFn=n,this._rpcFn=i,this._simulateFn=s,this._viewFn=o,this._accounts={},this._remainingAccounts=[],this._signers=[],this._preInstructions=[],this._postInstructions=[],this._accountsResolver=new Uo(e,this._accounts,a,c,l,u)}async pubkeys(){return await this._accountsResolver.resolve(),this._accounts}accounts(e){return Object.assign(this._accounts,e),this}signers(e){return this._signers=this._signers.concat(e),this}remainingAccounts(e){return this._remainingAccounts=this._remainingAccounts.concat(e),this}preInstructions(e){return this._preInstructions=this._preInstructions.concat(e),this}postInstructions(e){return this._postInstructions=this._postInstructions.concat(e),this}async rpc(e){return await this._accountsResolver.resolve(),this._rpcFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async view(e){if(await this._accountsResolver.resolve(),!this._viewFn)throw new Error("Method does not support views");return this._viewFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async simulate(e){return await this._accountsResolver.resolve(),this._simulateFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async instruction(){return await this._accountsResolver.resolve(),this._ixFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions})}async transaction(){return await this._accountsResolver.resolve(),this._txFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions})}}class Fo{constructor(e,t,n,i){t=qn(t),n||(n=Os()),this._idl=e,this._provider=n,this._programId=t,this._coder=i??new ru(e),this._events=new ig(this._programId,n,this._coder);const[s,o,a,c,l,u,f,m]=class{static build(y,S,p,w){const v={},E={},P={},K={},T={},b={},_=Yd(y),R=y.accounts?class{static build(B,V,q,I){var $;const G={};return($=B.accounts)===null||$===void 0||$.forEach(ke=>{const ae=jt(ke.name);G[ae]=new rg(B,ke,q,I,V)}),G}}.build(y,S,p,w):{},W=class{static build(B,V,q,I){if(B.state!==void 0)return new ng(B,q,I,V)}}.build(y,S,p,w);return y.instructions.forEach(B=>{const V=Bs.build(B,(ve,Dt)=>S.instruction.encode(ve,Dt),p),q=tg.build(B,V),I=eg.build(B,q,_,w),$=class{static build(ve,Dt,nn,me,Be,Ut,Yt){return async(...$t)=>{var ft;const rr=Dt(...$t),[,rn]=aa(ve,[...$t]);let ir;if(me.simulate===void 0)throw new Error("This function requires 'Provider.simulate' to be implemented.");try{ir=await me.simulate(rr,rn.signers,(ft=rn.options)===null||ft===void 0?void 0:ft.commitment)}catch(Dr){throw Xd(Dr,nn)}if(ir===void 0)throw new Error("Unable to simulate transaction");const Nr=ir.logs;if(!Nr)throw new Error("Simulated logs not found");const pi=[];return Yt.events&&new sf(Ut,Be).parseLogs(Nr,Dr=>{pi.push(Dr)}),{events:pi,raw:Nr}}}}.build(B,q,_,w,S,p,y),G=class{static build(ve,Dt,nn,me){const Be=Dt.accounts.find(Yt=>Yt.isMut),Ut=!!Dt.returns;if(!Be&&Ut)return async(...Yt)=>{var $t,ft;let rr=await nn(...Yt);const rn=`Program return: ${ve} `;let ir=rr.raw.find(Dr=>Dr.startsWith(rn));if(!ir)throw new Error("View expected return log");let Nr=By(ir.slice(rn.length)),pi=Dt.returns;if(!pi)throw new Error("View expected return type");return Rn.fieldLayout({type:pi},Array.from([...($t=me.accounts)!==null&&$t!==void 0?$t:[],...(ft=me.types)!==null&&ft!==void 0?ft:[]])).decode(Nr)}}}.build(p,B,$,y),ke=ag.build(w,p,B,V,q,I,$,G,R),ae=jt(B.name);E[ae]=V,P[ae]=q,v[ae]=I,K[ae]=$,T[ae]=ke,G&&(b[ae]=G)}),[v,E,P,R,K,T,W,b]}}.build(e,this._coder,t,n);this.rpc=s,this.instruction=o,this.transaction=a,this.account=c,this.simulate=l,this.methods=u,this.state=f,this.views=m}get programId(){return this._programId}get idl(){return this._idl}get coder(){return this._coder}get provider(){return this._provider}static async at(e,t){const n=qn(e),i=await Fo.fetchIdl(n,t);if(!i)throw new Error(`IDL not found for program: ${e.toString()}`);return new Fo(i,n,t)}static async fetchIdl(e,t){t=t??Os();const n=qn(e),i=await async function(l){const u=(await Y.findProgramAddress([],l))[0];return await Y.createWithSeed(u,"anchor:idl",l)}(n),s=await t.connection.getAccountInfo(i);if(!s)return null;let o=(a=s.data.slice(8),e_.decode(a));var a;const c=gw(o.data);return JSON.parse(Ry(c))}addEventListener(e,t){return this._events.addEventListener(e,t)}async removeEventListener(e){return await this._events.removeEventListener(e)}}class c_{static token(e){return function(t){return new Fo(og,s_,t,sg())}(e)}}var u_=Object.freeze(Object.defineProperty({__proto__:null,web3:Ey,ACCOUNT_DISCRIMINATOR_SIZE:Rv,AccountClient:rg,AnchorError:Ss,AnchorProvider:$y,BorshAccountsCoder:vs,BorshCoder:ru,BorshEventCoder:Uy,BorshInstructionCoder:nu,BorshStateCoder:jy,EventManager:ig,EventParser:sf,IdlError:Wo,LangErrorCode:ye,LangErrorMessage:Vy,MethodsBuilderFactory:ag,Program:Fo,ProgramError:Vo,ProgramErrorStack:Qs,Spl:c_,SplTokenCoder:Jy,StateClient:ng,eventDiscriminator:Fy,getProvider:Os,parseIdlErrors:Yd,setProvider:Sv,splitArgsAndCtx:aa,stateDiscriminator:ef,toInstruction:xy,translateAddress:qn,translateError:Xd,utils:Zv,validateAccounts:eu,BN:Qn},Symbol.toStringTag,{value:"Module"})),et=Hs(u_),ca={};Object.defineProperty(ca,"__esModule",{value:!0});ca.stakingIdl=void 0;ca.stakingIdl={version:"0.1.0",name:"atlas_staking",instructions:[{name:"cancelUnstake",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",path:"user"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}}],args:[]},{name:"createStakingAccount",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",path:"user"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"harvest",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"rewardMint",isMut:!1,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",account:"StakingAccount",path:"staking_account.owner"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"userRewardAccount",isMut:!0,isSigner:!1},{name:"rewardAta",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"initializeStaking",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"stakingVarsAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-vars"}]}},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"registerStake",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"stakingVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-vars"}]}},{name:"stakeMint",isMut:!1,isSigner:!1},{name:"rewardMint",isMut:!1,isSigner:!1},{name:"registeredStake",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",path:"authority"},{kind:"account",type:"publicKey",account:"Mint",path:"stake_mint"},{kind:"account",type:"publicKey",account:"Mint",path:"reward_mint"}]}},{name:"rewardAta",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"rewardMultiplier",type:"u64"},{name:"cooldownPeriod",type:"u64"}]},{name:"settle",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",path:"authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",account:"StakingAccount",path:"staking_account.owner"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}}],args:[{name:"updatedStakingPeriod",type:"u16"}]},{name:"stakeTokens",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"stakeMint",isMut:!1,isSigner:!1},{name:"tokenSource",isMut:!0,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",path:"user"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"tokenEscrow",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"stakeAmount",type:"u64"}]},{name:"unstakeTokens",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"rewardMint",isMut:!1,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",account:"StakingAccount",path:"staking_account.owner"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"userRewardAccount",isMut:!0,isSigner:!1},{name:"rewardAta",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"updateCooldownPeriod",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",path:"authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}}],args:[{name:"cooldownPeriod",type:"u64"}]},{name:"updateRewardMultiplier",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",path:"authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}}],args:[{name:"rewardMultiplier",type:"u64"},{name:"newStakingPeriod",type:"u16"}]},{name:"withdrawTokens",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"stakeMint",isMut:!1,isSigner:!1},{name:"tokenSource",isMut:!0,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",account:"StakingAccount",path:"staking_account.owner"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"tokenEscrow",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[]}],accounts:[{name:"RegisteredStake",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"stakeMint",type:"publicKey"},{name:"rewardMint",type:"publicKey"},{name:"currentPeriod",type:"u16"},{name:"rewardMultiplier",type:"u64"},{name:"cooldownPeriod",type:"u64"},{name:"bump",type:"u8"}]}},{name:"StakingAccount",type:{kind:"struct",fields:[{name:"owner",type:"publicKey"},{name:"registeredStake",type:"publicKey"},{name:"stakeMint",type:"publicKey"},{name:"totalStake",type:"u64"},{name:"activeStake",type:"u64"},{name:"pendingRewards",type:"u64"},{name:"paidRewards",type:"u64"},{name:"currentPeriod",type:"u16"},{name:"stakedAtTs",type:"i64"},{name:"lastPendingRewardCalcTs",type:"i64"},{name:"lastHarvestTs",type:"i64"},{name:"unstakedTs",type:"i64"},{name:"bump",type:"u8"}]}},{name:"StakingVars",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"bump",type:"u8"}]}}],errors:[{code:6e3,name:"InvalidMint",msg:"Invalid Token Mint"},{code:6001,name:"InvalidOwner",msg:"Account now owned by user"},{code:6002,name:"InsufficientFunds",msg:"Insufficient token balance"},{code:6003,name:"InvalidAuthority",msg:"Invalid authority for this account"},{code:6004,name:"InvalidDepositQty",msg:"Invalid deposit quantity"},{code:6005,name:"NumericalOverflowError",msg:"Numerical overflow error"},{code:6006,name:"StakeOnCooldown",msg:"Cannot stake while account is on cooldown"},{code:6007,name:"InvalidEscrowAuth",msg:"Invalid escrow authority"},{code:6008,name:"WithdrawOnCooldown",msg:"Cannot withdraw before cooldown period has elapsed"},{code:6009,name:"InvalidPeriod",msg:"Staking account must be in the same period as the Registered Stake"},{code:6010,name:"NotOnCooldown",msg:"Staking account is not on cooldown"}],metadata:{}};Object.defineProperty(Ei,"__esModule",{value:!0});Ei.getStakingProgram=Ei.getStakingIdl=void 0;const Rh=et,l_=ca;function cg(r){const e=l_.stakingIdl;return e.metadata.address=r.toBase58(),e}Ei.getStakingIdl=cg;function d_({connection:r,programId:e}){const t=cg(e),n=new Rh.AnchorProvider(r,null,null);return new Rh.Program(t,e,n)}Ei.getStakingProgram=d_;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Ei,r)})(vn);var f_=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(qc,"__esModule",{value:!0});qc.cancelUnstakeInstruction=void 0;const h_=vn;function p_({connection:r,user:e,registeredStake:t,programId:n}){return f_(this,void 0,void 0,function*(){const i=(0,h_.getStakingProgram)({connection:r,programId:n}),s={instructions:[],signers:[]},o=yield i.methods.cancelUnstake().accounts({user:e,registeredStake:t}).instruction();return s.instructions.push(o),s})}qc.cancelUnstakeInstruction=p_;var ou={},y_=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(ou,"__esModule",{value:!0});ou.createStakingAccountInstruction=void 0;const g_=vn;function m_({connection:r,user:e,registeredStake:t,programId:n}){return y_(this,void 0,void 0,function*(){const i=(0,g_.getStakingProgram)({connection:r,programId:n}),s={instructions:[],signers:[]},o=yield i.methods.createStakingAccount().accounts({user:e,registeredStake:t}).instruction();return s.instructions.push(o),s})}ou.createStakingAccountInstruction=m_;var au={},Ui={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.associatedAddress=r.ASSOCIATED_PROGRAM_ID=r.TOKEN_PROGRAM_ID=void 0;const e=Py;r.TOKEN_PROGRAM_ID=new e.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),r.ASSOCIATED_PROGRAM_ID=new e.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");async function t({mint:n,owner:i}){return(await e.PublicKey.findProgramAddress([i.toBuffer(),r.TOKEN_PROGRAM_ID.toBuffer(),n.toBuffer()],r.ASSOCIATED_PROGRAM_ID))[0]}r.associatedAddress=t})(Ui);var Fn={},xt={};class b_ extends TypeError{constructor(e,t){let n;const{message:i,...s}=e,{path:o}=e,a=o.length===0?i:"At path: "+o.join(".")+" -- "+i;super(a),Object.assign(this,s),this.name=this.constructor.name,this.failures=()=>{var c;return(c=n)!=null?c:n=[e,...t()]}}}function w_(r){return Yr(r)&&typeof r[Symbol.iterator]=="function"}function Yr(r){return typeof r=="object"&&r!=null}function er(r){return typeof r=="string"?JSON.stringify(r):""+r}function k_(r){const{done:e,value:t}=r.next();return e?void 0:t}function S_(r,e,t,n){if(r===!0)return;r===!1?r={}:typeof r=="string"&&(r={message:r});const{path:i,branch:s}=e,{type:o}=t,{refinement:a,message:c="Expected a value of type `"+o+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+er(n)+"`"}=r;return{value:n,type:o,refinement:a,key:i[i.length-1],path:i,branch:s,...r,message:c}}function*Th(r,e,t,n){w_(r)||(r=[r]);for(const i of r){const s=S_(i,e,t,n);s&&(yield s)}}function*of(r,e,t={}){const{path:n=[],branch:i=[r],coerce:s=!1,mask:o=!1}=t,a={path:n,branch:i};if(s&&(r=e.coercer(r,a),o&&e.type!=="type"&&Yr(e.schema)&&Yr(r)&&!Array.isArray(r)))for(const l in r)e.schema[l]===void 0&&delete r[l];let c=!0;for(const l of e.validator(r,a))c=!1,yield[l,void 0];for(let[l,u,f]of e.entries(r,a)){const m=of(u,f,{path:l===void 0?n:[...n,l],branch:l===void 0?i:[...i,u],coerce:s,mask:o});for(const y of m)y[0]?(c=!1,yield[y[0],void 0]):s&&(u=y[1],l===void 0?r=u:r instanceof Map?r.set(l,u):r instanceof Set?r.add(u):Yr(r)&&(r[l]=u))}if(c)for(const l of e.refiner(r,a))c=!1,yield[l,void 0];c&&(yield[void 0,r])}class Sr{constructor(e){const{type:t,schema:n,validator:i,refiner:s,coercer:o=c=>c,entries:a=function*(){}}=e;this.type=t,this.schema=n,this.entries=a,this.coercer=o,i?this.validator=(c,l)=>{const u=i(c,l);return Th(u,l,this,c)}:this.validator=()=>[],s?this.refiner=(c,l)=>{const u=s(c,l);return Th(u,l,this,c)}:this.refiner=()=>[]}assert(e){return ug(e,this)}create(e){return te(e,this)}is(e){return lg(e,this)}mask(e){return v_(e,this)}validate(e,t={}){return ua(e,this,t)}}function ug(r,e){const t=ua(r,e);if(t[0])throw t[0]}function te(r,e){const t=ua(r,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function v_(r,e){const t=ua(r,e,{coerce:!0,mask:!0});if(t[0])throw t[0];return t[1]}function lg(r,e){return!ua(r,e)[0]}function ua(r,e,t={}){const n=of(r,e,t),i=k_(n);if(i[0])return[new b_(i[0],function*(){for(const o of n)o[0]&&(yield o[0])}),void 0];{const s=i[1];return[void 0,s]}}function Fi(r,e){return new Sr({type:r,schema:null,validator:e})}function dg(){return Fi("any",()=>!0)}function j(r){return new Sr({type:"array",schema:r,*entries(e){if(r&&Array.isArray(e))for(const[t,n]of e.entries())yield[t,n,r]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||"Expected an array value, but received: "+er(e)}})}function Tt(){return Fi("boolean",r=>typeof r=="boolean")}function Xs(r){return Fi("instance",e=>e instanceof r||"Expected a `"+r.name+"` instance, but received: "+er(e))}function Se(r){const e=er(r),t=typeof r;return new Sr({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?r:null,validator(n){return n===r||"Expected the literal `"+e+"`, but received: "+er(n)}})}function __(){return Fi("never",()=>!1)}function F(r){return new Sr({...r,validator:(e,t)=>e===null||r.validator(e,t),refiner:(e,t)=>e===null||r.refiner(e,t)})}function k(){return Fi("number",r=>typeof r=="number"&&!isNaN(r)||"Expected a number, but received: "+er(r))}function X(r){return new Sr({...r,validator:(e,t)=>e===void 0||r.validator(e,t),refiner:(e,t)=>e===void 0||r.refiner(e,t)})}function cu(r,e){return new Sr({type:"record",schema:null,*entries(t){if(Yr(t))for(const n in t){const i=t[n];yield[n,n,r],yield[n,i,e]}},validator(t){return Yr(t)||"Expected an object, but received: "+er(t)}})}function N(){return Fi("string",r=>typeof r=="string"||"Expected a string, but received: "+er(r))}function Zs(r){const e=__();return new Sr({type:"tuple",schema:null,*entries(t){if(Array.isArray(t)){const n=Math.max(r.length,t.length);for(let i=0;i<n;i++)yield[i,t[i],r[i]||e]}},validator(t){return Array.isArray(t)||"Expected an array, but received: "+er(t)}})}function O(r){const e=Object.keys(r);return new Sr({type:"type",schema:r,*entries(t){if(Yr(t))for(const n of e)yield[n,t[n],r[n]]},validator(t){return Yr(t)||"Expected an object, but received: "+er(t)}})}function Ze(r){const e=r.map(t=>t.type).join(" | ");return new Sr({type:"union",schema:null,validator(t,n){const i=[];for(const s of r){const[...o]=of(t,s,n),[a]=o;if(a[0])for(const[c]of o)c&&i.push(c);else return[]}return["Expected the value to satisfy a union of `"+e+"`, but received: "+er(t),...i]}})}function vr(){return Fi("unknown",()=>!0)}function _r(r,e,t){return new Sr({...r,coercer:(n,i)=>lg(n,e)?r.coercer(t(n,i),i):r.coercer(n,i)})}const A_=Kc.v4,I_=function(r,e,t,n){if(typeof r!="string")throw new TypeError(r+" must be a string");n=n||{};const i=typeof n.version=="number"?n.version:2;if(i!==1&&i!==2)throw new TypeError(i+" must be 1 or 2");const s={method:r};if(i===2&&(s.jsonrpc="2.0"),e){if(typeof e!="object"&&!Array.isArray(e))throw new TypeError(e+" must be an object, array or omitted");s.params=e}if(typeof t>"u"){const o=typeof n.generator=="function"?n.generator:function(){return A_()};s.id=o(s,n)}else i===2&&t===null?n.notificationIdNull&&(s.id=null):s.id=t;return s};var E_=I_;const P_=Kc.v4,R_=E_,jo=function(r,e){if(!(this instanceof jo))return new jo(r,e);e||(e={}),this.options={reviver:typeof e.reviver<"u"?e.reviver:null,replacer:typeof e.replacer<"u"?e.replacer:null,generator:typeof e.generator<"u"?e.generator:function(){return P_()},version:typeof e.version<"u"?e.version:2,notificationIdNull:typeof e.notificationIdNull=="boolean"?e.notificationIdNull:!1},this.callServer=r};var T_=jo;jo.prototype.request=function(r,e,t,n){const i=this;let s=null;const o=Array.isArray(r)&&typeof e=="function";if(this.options.version===1&&o)throw new TypeError("JSON-RPC 1.0 does not support batching");if(o||!o&&r&&typeof r=="object"&&typeof e=="function")n=e,s=r;else{typeof t=="function"&&(n=t,t=void 0);const l=typeof n=="function";try{s=R_(r,e,t,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(u){if(l)return n(u);throw u}if(!l)return s}let c;try{c=JSON.stringify(s,this.options.replacer)}catch(l){return n(l)}return this.callServer(c,function(l,u){i._parseResponse(l,u,n)}),s};jo.prototype._parseResponse=function(r,e,t){if(r){t(r);return}if(!e)return t();let n;try{n=JSON.parse(e,this.options.reviver)}catch(i){return t(i)}if(t.length===3)if(Array.isArray(n)){const i=function(o){return typeof o.error<"u"},s=function(o){return!i(o)};return t(null,n.filter(i),n.filter(s))}else return t(null,n.error,n.result);t(null,n)};var fg={};(function(r){var e=Vc.exports;Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var t=e(zp),n=e(Wp.exports),i=e(Vp.exports),s=e(Nc.exports),o=e(Dc.exports),a=e($c.exports),c=e(zc.exports),l=e(Wc.exports),u=Uc.exports;function f(p){var w=m();return function(){var E=(0,l.default)(p),P;if(w){var K=(0,l.default)(this).constructor;P=Reflect.construct(E,arguments,K)}else P=E.apply(this,arguments);return(0,c.default)(this,P)}}function m(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var y=function(p,w){var v={};for(var E in p)Object.prototype.hasOwnProperty.call(p,E)&&w.indexOf(E)<0&&(v[E]=p[E]);if(p!=null&&typeof Object.getOwnPropertySymbols=="function")for(var P=0,E=Object.getOwnPropertySymbols(p);P<E.length;P++)w.indexOf(E[P])<0&&Object.prototype.propertyIsEnumerable.call(p,E[P])&&(v[E[P]]=p[E[P]]);return v},S=function(p){(0,a.default)(v,p);var w=f(v);function v(E){var P,K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"ws://localhost:8080",T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},b=arguments.length>3?arguments[3]:void 0;(0,s.default)(this,v);var _=T.autoconnect,R=_===void 0?!0:_,W=T.reconnect,B=W===void 0?!0:W,V=T.reconnect_interval,q=V===void 0?1e3:V,I=T.max_reconnects,$=I===void 0?5:I,G=y(T,["autoconnect","reconnect","reconnect_interval","max_reconnects"]);return P=w.call(this),P.webSocketFactory=E,P.queue={},P.rpc_id=0,P.address=K,P.autoconnect=R,P.ready=!1,P.reconnect=B,P.reconnect_timer_id=void 0,P.reconnect_interval=q,P.max_reconnects=$,P.rest_options=G,P.current_reconnects=0,P.generate_request_id=b||function(){return++P.rpc_id},P.autoconnect&&P._connect(P.address,Object.assign({autoconnect:P.autoconnect,reconnect:P.reconnect,reconnect_interval:P.reconnect_interval,max_reconnects:P.max_reconnects},P.rest_options)),P}return(0,o.default)(v,[{key:"connect",value:function(){this.socket||this._connect(this.address,Object.assign({autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects},this.rest_options))}},{key:"call",value:function(P,K,T,b){var _=this;return!b&&(0,i.default)(T)==="object"&&(b=T,T=null),new Promise(function(R,W){if(!_.ready)return W(new Error("socket not ready"));var B=_.generate_request_id(P,K),V={jsonrpc:"2.0",method:P,params:K||null,id:B};_.socket.send(JSON.stringify(V),b,function(q){if(q)return W(q);_.queue[B]={promise:[R,W]},T&&(_.queue[B].timeout=setTimeout(function(){delete _.queue[B],W(new Error("reply timeout"))},T))})})}},{key:"login",value:function(){var E=(0,n.default)(t.default.mark(function K(T){var b;return t.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return R.next=2,this.call("rpc.login",T);case 2:if(b=R.sent,b){R.next=5;break}throw new Error("authentication failed");case 5:return R.abrupt("return",b);case 6:case"end":return R.stop()}},K,this)}));function P(K){return E.apply(this,arguments)}return P}()},{key:"listMethods",value:function(){var E=(0,n.default)(t.default.mark(function K(){return t.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.call("__listMethods");case 2:return b.abrupt("return",b.sent);case 3:case"end":return b.stop()}},K,this)}));function P(){return E.apply(this,arguments)}return P}()},{key:"notify",value:function(P,K){var T=this;return new Promise(function(b,_){if(!T.ready)return _(new Error("socket not ready"));var R={jsonrpc:"2.0",method:P,params:K||null};T.socket.send(JSON.stringify(R),function(W){if(W)return _(W);b()})})}},{key:"subscribe",value:function(){var E=(0,n.default)(t.default.mark(function K(T){var b;return t.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return typeof T=="string"&&(T=[T]),R.next=3,this.call("rpc.on",T);case 3:if(b=R.sent,!(typeof T=="string"&&b[T]!=="ok")){R.next=6;break}throw new Error("Failed subscribing to an event '"+T+"' with: "+b[T]);case 6:return R.abrupt("return",b);case 7:case"end":return R.stop()}},K,this)}));function P(K){return E.apply(this,arguments)}return P}()},{key:"unsubscribe",value:function(){var E=(0,n.default)(t.default.mark(function K(T){var b;return t.default.wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return typeof T=="string"&&(T=[T]),R.next=3,this.call("rpc.off",T);case 3:if(b=R.sent,!(typeof T=="string"&&b[T]!=="ok")){R.next=6;break}throw new Error("Failed unsubscribing from an event with: "+b);case 6:return R.abrupt("return",b);case 7:case"end":return R.stop()}},K,this)}));function P(K){return E.apply(this,arguments)}return P}()},{key:"close",value:function(P,K){this.socket.close(P||1e3,K)}},{key:"_connect",value:function(P,K){var T=this;clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(P,K),this.socket.addEventListener("open",function(){T.ready=!0,T.emit("open"),T.current_reconnects=0}),this.socket.addEventListener("message",function(b){var _=b.data;_ instanceof ArrayBuffer&&(_=ge.Buffer.from(_).toString());try{_=JSON.parse(_)}catch{return}if(_.notification&&T.listeners(_.notification).length){if(!Object.keys(_.params).length)return T.emit(_.notification);var R=[_.notification];if(_.params.constructor===Object)R.push(_.params);else for(var W=0;W<_.params.length;W++)R.push(_.params[W]);return Promise.resolve().then(function(){T.emit.apply(T,R)})}if(!T.queue[_.id])return _.method&&_.params?Promise.resolve().then(function(){T.emit(_.method,_.params)}):void 0;"error"in _=="result"in _&&T.queue[_.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),T.queue[_.id].timeout&&clearTimeout(T.queue[_.id].timeout),_.error?T.queue[_.id].promise[1](_.error):T.queue[_.id].promise[0](_.result),delete T.queue[_.id]}),this.socket.addEventListener("error",function(b){return T.emit("error",b)}),this.socket.addEventListener("close",function(b){var _=b.code,R=b.reason;T.ready&&setTimeout(function(){return T.emit("close",_,R)},0),T.ready=!1,T.socket=void 0,_!==1e3&&(T.current_reconnects++,T.reconnect&&(T.max_reconnects>T.current_reconnects||T.max_reconnects===0)&&(T.reconnect_timer_id=setTimeout(function(){return T._connect(P,K)},T.reconnect_interval)))})}}]),v}(u.EventEmitter);r.default=S})(fg);var O_=Fc(fg),hg={};(function(r){var e=Vc.exports;Object.defineProperty(r,"__esModule",{value:!0}),r.default=f;var t=e(Nc.exports),n=e(Dc.exports),i=e($c.exports),s=e(zc.exports),o=e(Wc.exports),a=Uc.exports;function c(m){var y=l();return function(){var p=(0,o.default)(m),w;if(y){var v=(0,o.default)(this).constructor;w=Reflect.construct(p,arguments,v)}else w=p.apply(this,arguments);return(0,s.default)(this,w)}}function l(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var u=function(m){(0,i.default)(S,m);var y=c(S);function S(p,w,v){var E;return(0,t.default)(this,S),E=y.call(this),E.socket=new window.WebSocket(p,v),E.socket.onopen=function(){return E.emit("open")},E.socket.onmessage=function(P){return E.emit("message",P.data)},E.socket.onerror=function(P){return E.emit("error",P)},E.socket.onclose=function(P){E.emit("close",P.code,P.reason)},E}return(0,n.default)(S,[{key:"send",value:function(w,v,E){var P=E||v;try{this.socket.send(w),P()}catch(K){P(K)}}},{key:"close",value:function(w,v){this.socket.close(w,v)}},{key:"addEventListener",value:function(w,v,E){this.socket.addEventListener(w,v,E)}}]),S}(a.EventEmitter);function f(m,y){return new u(m,y)}})(hg);var B_=Fc(hg);const x_=Gt.utils.randomPrivateKey,Oh=()=>{const r=Gt.utils.randomPrivateKey(),e=pc(r),t=new Uint8Array(64);return t.set(r),t.set(e,32),{publicKey:e,secretKey:t}},pc=Gt.getPublicKey;function Bh(r){try{return Gt.ExtendedPoint.fromHex(r),!0}catch{return!1}}const af=(r,e)=>Gt.sign(r,e.slice(0,32)),C_=Gt.verify,Te=r=>L.Buffer.isBuffer(r)?r:r instanceof Uint8Array?L.Buffer.from(r.buffer,r.byteOffset,r.byteLength):L.Buffer.from(r);class cf{constructor(e){Object.assign(this,e)}encode(){return L.Buffer.from(Rd(To,this))}static decode(e){return Td(To,this,e)}static decodeUnchecked(e){return Od(To,this,e)}}class M_ extends cf{constructor(e){if(super(e),this.enum="",Object.keys(e).length!==1)throw new Error("Enum can only take single value");Object.keys(e).map(t=>{this.enum=t})}}const To=new Map;var pg;let yg;const gg=32,Bn=32;function L_(r){return r._bn!==void 0}let xh=1;yg=Symbol.toStringTag;class re extends cf{constructor(e){if(super({}),this._bn=void 0,L_(e))this._bn=e._bn;else{if(typeof e=="string"){const t=pe.decode(e);if(t.length!=Bn)throw new Error("Invalid public key input");this._bn=new Qn(t)}else this._bn=new Qn(e);if(this._bn.byteLength()>Bn)throw new Error("Invalid public key input")}}static unique(){const e=new re(xh);return xh+=1,new re(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return pe.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(L.Buffer);if(e.length===Bn)return e;const t=L.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[yg](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,n){const i=L.Buffer.concat([e.toBuffer(),L.Buffer.from(t),n.toBuffer()]),s=Ps(i);return new re(s)}static createProgramAddressSync(e,t){let n=L.Buffer.alloc(0);e.forEach(function(s){if(s.length>gg)throw new TypeError("Max seed length exceeded");n=L.Buffer.concat([n,Te(s)])}),n=L.Buffer.concat([n,t.toBuffer(),L.Buffer.from("ProgramDerivedAddress")]);const i=Ps(n);if(Bh(i))throw new Error("Invalid seeds, address must fall off the curve");return new re(i)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let n=255,i;for(;n!=0;){try{const s=e.concat(L.Buffer.from([n]));i=this.createProgramAddressSync(s,t)}catch(s){if(s instanceof TypeError)throw s;n--;continue}return[i,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new re(e);return Bh(t.toBytes())}}pg=re;re.default=new pg("11111111111111111111111111111111");To.set(re,{kind:"struct",fields:[["_bn","u256"]]});class K_{constructor(e){if(this._publicKey=void 0,this._secretKey=void 0,e){const t=Te(e);if(e.length!==64)throw new Error("bad secret key size");this._publicKey=t.slice(32,64),this._secretKey=t.slice(0,32)}else this._secretKey=Te(x_()),this._publicKey=Te(pc(this._secretKey))}get publicKey(){return new re(this._publicKey)}get secretKey(){return L.Buffer.concat([this._secretKey,this._publicKey],64)}}const N_=new re("BPFLoader1111111111111111111111111111111111"),Jr=1280-40-8,uu=127,xs=64;class uf extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(uf.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class lf extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(lf.prototype,"name",{value:"TransactionExpiredTimeoutError"});class fs extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(fs.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class qo{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const n=new Map;this.keySegments().flat().forEach((s,o)=>{n.set(s.toBase58(),o)});const i=s=>{const o=n.get(s.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(s=>({programIdIndex:i(s.programId),accountKeyIndexes:s.keys.map(o=>i(o.pubkey)),data:s.data}))}}const Ce=(r="publicKey")=>he(32,r),D_=(r="signature")=>he(64,r),Si=(r="string")=>{const e=C([M("length"),M("lengthPadding"),he(Pt(M(),-8),"chars")],r),t=e.decode.bind(e),n=e.encode.bind(e),i=e;return i.decode=(s,o)=>t(s,o).chars.toString(),i.encode=(s,o,a)=>{const c={chars:L.Buffer.from(s,"utf8")};return n(c,o,a)},i.alloc=s=>M().span+M().span+L.Buffer.from(s,"utf8").length,i},$_=(r="authorized")=>C([Ce("staker"),Ce("withdrawer")],r),z_=(r="lockup")=>C([Me("unixTimestamp"),Me("epoch"),Ce("custodian")],r),W_=(r="voteInit")=>C([Ce("nodePubkey"),Ce("authorizedVoter"),Ce("authorizedWithdrawer"),ee("commission")],r),V_=(r="voteAuthorizeWithSeedArgs")=>C([M("voteAuthorizationType"),Ce("currentAuthorityDerivedKeyOwnerPubkey"),Si("currentAuthorityDerivedKeySeed"),Ce("newAuthorized")],r);function mg(r,e){const t=i=>{if(i.span>=0)return i.span;if(typeof i.alloc=="function")return i.alloc(e[i.property]);if("count"in i&&"elementLayout"in i){const s=e[i.property];if(Array.isArray(s))return s.length*t(i.elementLayout)}else if("fields"in i)return mg({layout:i},e[i.property]);return 0};let n=0;return r.layout.fields.forEach(i=>{n+=t(i)}),n}function pn(r){let e=0,t=0;for(;;){let n=r.shift();if(e|=(n&127)<<t*7,t+=1,(n&128)===0)break}return e}function Pn(r,e){let t=e;for(;;){let n=t&127;if(t>>=7,t==0){r.push(n);break}else n|=128,r.push(n)}}function Ve(r,e){if(!r)throw new Error(e||"Assertion failed")}class lu{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const n=new Map,i=o=>{const a=o.toBase58();let c=n.get(a);return c===void 0&&(c={isSigner:!1,isWritable:!1,isInvoked:!1},n.set(a,c)),c},s=i(t);s.isSigner=!0,s.isWritable=!0;for(const o of e){i(o.programId).isInvoked=!0;for(const a of o.keys){const c=i(a.pubkey);c.isSigner||=a.isSigner,c.isWritable||=a.isWritable}}return new lu(t,n)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];Ve(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,c])=>c.isSigner&&c.isWritable),n=e.filter(([,c])=>c.isSigner&&!c.isWritable),i=e.filter(([,c])=>!c.isSigner&&c.isWritable),s=e.filter(([,c])=>!c.isSigner&&!c.isWritable),o={numRequiredSignatures:t.length+n.length,numReadonlySignedAccounts:n.length,numReadonlyUnsignedAccounts:s.length};{Ve(t.length>0,"Expected at least one writable signer key");const[c]=t[0];Ve(c===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...t.map(([c])=>new re(c)),...n.map(([c])=>new re(c)),...i.map(([c])=>new re(c)),...s.map(([c])=>new re(c))];return[o,a]}extractTableLookup(e){const[t,n]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[i,s]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&i.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:i},{writable:n,readonly:s}]}drainKeysFoundInLookupTable(e,t){const n=new Array,i=new Array;for(const[s,o]of this.keyMetaMap.entries())if(t(o)){const a=new re(s),c=e.findIndex(l=>l.equals(a));c>=0&&(Ve(c<256,"Max lookup table index exceeded"),n.push(c),i.push(a),this.keyMetaMap.delete(s))}return[n,i]}}class tr{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new re(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:pe.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new qo(this.staticAccountKeys)}static compile(e){const t=lu.compile(e.instructions,e.payerKey),[n,i]=t.getMessageComponents(),o=new qo(i).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:pe.encode(a.data)}));return new tr({header:n,accountKeys:i,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const n=e-t,s=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return n<s}else{const n=t-this.header.numReadonlySignedAccounts;return e<n}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];Pn(t,e);const n=this.instructions.map(f=>{const{accounts:m,programIdIndex:y}=f,S=Array.from(pe.decode(f.data));let p=[];Pn(p,m.length);let w=[];return Pn(w,S.length),{programIdIndex:y,keyIndicesCount:L.Buffer.from(p),keyIndices:m,dataLength:L.Buffer.from(w),data:S}});let i=[];Pn(i,n.length);let s=L.Buffer.alloc(Jr);L.Buffer.from(i).copy(s);let o=i.length;n.forEach(f=>{o+=C([ee("programIdIndex"),he(f.keyIndicesCount.length,"keyIndicesCount"),Ie(ee("keyIndex"),f.keyIndices.length,"keyIndices"),he(f.dataLength.length,"dataLength"),Ie(ee("userdatum"),f.data.length,"data")]).encode(f,s,o)}),s=s.slice(0,o);const a=C([he(1,"numRequiredSignatures"),he(1,"numReadonlySignedAccounts"),he(1,"numReadonlyUnsignedAccounts"),he(t.length,"keyCount"),Ie(Ce("key"),e,"keys"),Ce("recentBlockhash")]),c={numRequiredSignatures:L.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:L.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:L.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:L.Buffer.from(t),keys:this.accountKeys.map(f=>Te(f.toBytes())),recentBlockhash:pe.decode(this.recentBlockhash)};let l=L.Buffer.alloc(2048);const u=a.encode(c,l);return s.copy(l,u),l.slice(0,u+s.length)}static from(e){let t=[...e];const n=t.shift();if(n!==(n&uu))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const i=t.shift(),s=t.shift(),o=pn(t);let a=[];for(let m=0;m<o;m++){const y=t.slice(0,Bn);t=t.slice(Bn),a.push(new re(L.Buffer.from(y)))}const c=t.slice(0,Bn);t=t.slice(Bn);const l=pn(t);let u=[];for(let m=0;m<l;m++){const y=t.shift(),S=pn(t),p=t.slice(0,S);t=t.slice(S);const w=pn(t),v=t.slice(0,w),E=pe.encode(L.Buffer.from(v));t=t.slice(w),u.push({programIdIndex:y,accounts:p,data:E})}const f={header:{numRequiredSignatures:n,numReadonlySignedAccounts:i,numReadonlyUnsignedAccounts:s},recentBlockhash:pe.encode(L.Buffer.from(c)),accountKeys:a,instructions:u};return new tr(f)}}class Oi{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new qo(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,n=this.staticAccountKeys.length;if(e>=n){const i=e-n,s=this.addressTableLookups.reduce((o,a)=>o+a.writableIndexes.length,0);return i<s}else if(e>=this.header.numRequiredSignatures){const i=e-t,o=n-t-this.header.numReadonlyUnsignedAccounts;return i<o}else{const i=t-this.header.numReadonlySignedAccounts;return e<i}}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const n of this.addressTableLookups){const i=e.find(s=>s.key.equals(n.accountKey));if(!i)throw new Error(`Failed to find address lookup table account for table key ${n.accountKey.toBase58()}`);for(const s of n.writableIndexes)if(s<i.state.addresses.length)t.writable.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${n.accountKey.toBase58()}`);for(const s of n.readonlyIndexes)if(s<i.state.addresses.length)t.readonly.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${n.accountKey.toBase58()}`)}return t}static compile(e){const t=lu.compile(e.instructions,e.payerKey),n=new Array,i={writable:new Array,readonly:new Array},s=e.addressLookupTableAccounts||[];for(const u of s){const f=t.extractTableLookup(u);if(f!==void 0){const[m,{writable:y,readonly:S}]=f;n.push(m),i.writable.push(...y),i.readonly.push(...S)}}const[o,a]=t.getMessageComponents(),l=new qo(a,i).compileInstructions(e.instructions);return new Oi({header:o,staticAccountKeys:a,recentBlockhash:e.recentBlockhash,compiledInstructions:l,addressTableLookups:n})}serialize(){const e=Array();Pn(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),n=Array();Pn(n,this.compiledInstructions.length);const i=this.serializeAddressTableLookups(),s=Array();Pn(s,this.addressTableLookups.length);const o=C([ee("prefix"),C([ee("numRequiredSignatures"),ee("numReadonlySignedAccounts"),ee("numReadonlyUnsignedAccounts")],"header"),he(e.length,"staticAccountKeysLength"),Ie(Ce(),this.staticAccountKeys.length,"staticAccountKeys"),Ce("recentBlockhash"),he(n.length,"instructionsLength"),he(t.length,"serializedInstructions"),he(s.length,"addressTableLookupsLength"),he(i.length,"serializedAddressTableLookups")]),a=new Uint8Array(Jr),c=1<<7,l=o.encode({prefix:c,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(u=>u.toBytes()),recentBlockhash:pe.decode(this.recentBlockhash),instructionsLength:new Uint8Array(n),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(s),serializedAddressTableLookups:i},a);return a.slice(0,l)}serializeInstructions(){let e=0;const t=new Uint8Array(Jr);for(const n of this.compiledInstructions){const i=Array();Pn(i,n.accountKeyIndexes.length);const s=Array();Pn(s,n.data.length),e+=C([ee("programIdIndex"),he(i.length,"encodedAccountKeyIndexesLength"),Ie(ee(),n.accountKeyIndexes.length,"accountKeyIndexes"),he(s.length,"encodedDataLength"),he(n.data.length,"data")]).encode({programIdIndex:n.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(i),accountKeyIndexes:n.accountKeyIndexes,encodedDataLength:new Uint8Array(s),data:n.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(Jr);for(const n of this.addressTableLookups){const i=Array();Pn(i,n.writableIndexes.length);const s=Array();Pn(s,n.readonlyIndexes.length),e+=C([Ce("accountKey"),he(i.length,"encodedWritableIndexesLength"),Ie(ee(),n.writableIndexes.length,"writableIndexes"),he(s.length,"encodedReadonlyIndexesLength"),Ie(ee(),n.readonlyIndexes.length,"readonlyIndexes")]).encode({accountKey:n.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(i),writableIndexes:n.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(s),readonlyIndexes:n.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const n=t.shift(),i=n&uu;Ve(n!==i,"Expected versioned message but received legacy message");const s=i;Ve(s===0,`Expected versioned message with version 0 but found version ${s}`);const o={numRequiredSignatures:t.shift(),numReadonlySignedAccounts:t.shift(),numReadonlyUnsignedAccounts:t.shift()},a=[],c=pn(t);for(let S=0;S<c;S++)a.push(new re(t.splice(0,Bn)));const l=pe.encode(t.splice(0,Bn)),u=pn(t),f=[];for(let S=0;S<u;S++){const p=t.shift(),w=pn(t),v=t.splice(0,w),E=pn(t),P=new Uint8Array(t.splice(0,E));f.push({programIdIndex:p,accountKeyIndexes:v,data:P})}const m=pn(t),y=[];for(let S=0;S<m;S++){const p=new re(t.splice(0,Bn)),w=pn(t),v=t.splice(0,w),E=pn(t),P=t.splice(0,E);y.push({accountKey:p,writableIndexes:v,readonlyIndexes:P})}return new Oi({header:o,staticAccountKeys:a,recentBlockhash:l,compiledInstructions:f,addressTableLookups:y})}}const df={deserializeMessageVersion(r){const e=r[0],t=e&uu;return t===e?"legacy":t},deserialize:r=>{const e=df.deserializeMessageVersion(r);if(e==="legacy")return tr.from(r);if(e===0)return Oi.deserialize(r);throw new Error(`Transaction message version ${e} deserialization is not supported`)}};let Er=function(r){return r[r.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",r[r.PROCESSED=1]="PROCESSED",r[r.TIMED_OUT=2]="TIMED_OUT",r[r.NONCE_INVALID=3]="NONCE_INVALID",r}({});const U_=L.Buffer.alloc(xs).fill(0);class rt{constructor(e){this.keys=void 0,this.programId=void 0,this.data=L.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:n})=>({pubkey:e.toJSON(),isSigner:t,isWritable:n})),programId:this.programId.toJSON(),data:[...this.data]}}}class Je{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:n}=e;this.minNonceContextSlot=t,this.nonceInfo=n}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:n}=e;this.recentBlockhash=t,this.lastValidBlockHeight=n}else{const{recentBlockhash:t,nonceInfo:n}=e;n&&(this.nonceInfo=n),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new rt(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let n;if(this.feePayer)n=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)n=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let p=0;p<t.length;p++)if(t[p].programId===void 0)throw new Error(`Transaction instruction index ${p} has undefined program id`);const i=[],s=[];t.forEach(p=>{p.keys.forEach(v=>{s.push({...v})});const w=p.programId.toString();i.includes(w)||i.push(w)}),i.forEach(p=>{s.push({pubkey:new re(p),isSigner:!1,isWritable:!1})});const o=[];s.forEach(p=>{const w=p.pubkey.toString(),v=o.findIndex(E=>E.pubkey.toString()===w);v>-1?(o[v].isWritable=o[v].isWritable||p.isWritable,o[v].isSigner=o[v].isSigner||p.isSigner):o.push(p)}),o.sort(function(p,w){if(p.isSigner!==w.isSigner)return p.isSigner?-1:1;if(p.isWritable!==w.isWritable)return p.isWritable?-1:1;const v={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return p.pubkey.toBase58().localeCompare(w.pubkey.toBase58(),"en",v)});const a=o.findIndex(p=>p.pubkey.equals(n));if(a>-1){const[p]=o.splice(a,1);p.isSigner=!0,p.isWritable=!0,o.unshift(p)}else o.unshift({pubkey:n,isSigner:!0,isWritable:!0});for(const p of this.signatures){const w=o.findIndex(v=>v.pubkey.equals(p.publicKey));if(w>-1)o[w].isSigner||(o[w].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${p.publicKey.toString()}`)}let c=0,l=0,u=0;const f=[],m=[];o.forEach(({pubkey:p,isSigner:w,isWritable:v})=>{w?(f.push(p.toString()),c+=1,v||(l+=1)):(m.push(p.toString()),v||(u+=1))});const y=f.concat(m),S=t.map(p=>{const{data:w,programId:v}=p;return{programIdIndex:y.indexOf(v.toString()),accounts:p.keys.map(E=>y.indexOf(E.pubkey.toString())),data:pe.encode(w)}});return S.forEach(p=>{Ve(p.programIdIndex>=0),p.accounts.forEach(w=>Ve(w>=0))}),new tr({header:{numRequiredSignatures:c,numReadonlySignedAccounts:l,numReadonlyUnsignedAccounts:u},accountKeys:y,recentBlockhash:e,instructions:S})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((i,s)=>t[s].equals(i.publicKey))||(this.signatures=t.map(n=>({signature:null,publicKey:n}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(n=>{const i=n.toString();return t.has(i)?!1:(t.add(i),!0)}).map(n=>({signature:null,publicKey:n}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}this.signatures=n.map(s=>({signature:null,publicKey:s.publicKey}));const i=this._compile();this._partialSign(i,...n)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}const i=this._compile();this._partialSign(i,...n)}_partialSign(e,...t){const n=e.serialize();t.forEach(i=>{const s=af(n,i.secretKey);this._addSignature(i.publicKey,Te(s))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){Ve(t.length===64);const n=this.signatures.findIndex(i=>e.equals(i.publicKey));if(n<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[n].signature=L.Buffer.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:n,publicKey:i}of this.signatures)if(n===null){if(t)return!1}else if(!C_(n,e,i.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:n}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),i=this.serializeMessage();if(n&&!this._verifySignatures(i,t))throw new Error("Signature verification failed");return this._serialize(i)}_serialize(e){const{signatures:t}=this,n=[];Pn(n,t.length);const i=n.length+t.length*64+e.length,s=L.Buffer.alloc(i);return Ve(t.length<256),L.Buffer.from(n).copy(s,0),t.forEach(({signature:o},a)=>{o!==null&&(Ve(o.length===64,"signature has invalid length"),L.Buffer.from(o).copy(s,n.length+a*64))}),e.copy(s,n.length+t.length*64),Ve(s.length<=Jr,`Transaction too large: ${s.length} > ${Jr}`),s}get keys(){return Ve(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return Ve(this.instructions.length===1),this.instructions[0].programId}get data(){return Ve(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const n=pn(t);let i=[];for(let s=0;s<n;s++){const o=t.slice(0,xs);t=t.slice(xs),i.push(pe.encode(L.Buffer.from(o)))}return Je.populate(tr.from(t),i)}static populate(e,t=[]){const n=new Je;return n.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(n.feePayer=e.accountKeys[0]),t.forEach((i,s)=>{const o={signature:i==pe.encode(U_)?null:pe.decode(i),publicKey:e.accountKeys[s]};n.signatures.push(o)}),e.instructions.forEach(i=>{const s=i.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:n.signatures.some(c=>c.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});n.instructions.push(new rt({keys:s,programId:e.accountKeys[i.programIdIndex],data:pe.decode(i.data)}))}),n._message=e,n._json=n.toJSON(),n}}class ff{constructor(e){this.payerKey=void 0,this.instructions=void 0,this.recentBlockhash=void 0,this.payerKey=e.payerKey,this.instructions=e.instructions,this.recentBlockhash=e.recentBlockhash}static decompile(e,t){const{header:n,compiledInstructions:i,recentBlockhash:s}=e,{numRequiredSignatures:o,numReadonlySignedAccounts:a,numReadonlyUnsignedAccounts:c}=n,l=o-a;Ve(l>0,"Message header is invalid");const u=e.staticAccountKeys.length-o-c;Ve(u>=0,"Message header is invalid");const f=e.getAccountKeys(t),m=f.get(0);if(m===void 0)throw new Error("Failed to decompile message because no account keys were found");const y=[];for(const S of i){const p=[];for(const v of S.accountKeyIndexes){const E=f.get(v);if(E===void 0)throw new Error(`Failed to find key for account key index ${v}`);const P=v<o;let K;P?K=v<l:v<f.staticAccountKeys.length?K=v-o<u:K=v-f.staticAccountKeys.length<f.accountKeysFromLookups.writable.length,p.push({pubkey:E,isSigner:v<n.numRequiredSignatures,isWritable:K})}const w=f.get(S.programIdIndex);if(w===void 0)throw new Error(`Failed to find program id for program id index ${S.programIdIndex}`);y.push(new rt({programId:w,data:Te(S.data),keys:p}))}return new ff({payerKey:m,instructions:y,recentBlockhash:s})}compileToLegacyMessage(){return tr.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions})}compileToV0Message(e){return Oi.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions,addressLookupTableAccounts:e})}}class hf{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,t!==void 0)Ve(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{const n=[];for(let i=0;i<e.header.numRequiredSignatures;i++)n.push(new Uint8Array(xs));this.signatures=n}this.message=e}serialize(){const e=this.message.serialize(),t=Array();Pn(t,this.signatures.length);const n=C([he(t.length,"encodedSignaturesLength"),Ie(D_(),this.signatures.length,"signatures"),he(e.length,"serializedMessage")]),i=new Uint8Array(2048),s=n.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},i);return i.slice(0,s)}static deserialize(e){let t=[...e];const n=[],i=pn(t);for(let o=0;o<i;o++)n.push(new Uint8Array(t.splice(0,xs)));const s=df.deserialize(new Uint8Array(t));return new hf(s,n)}sign(e){const t=this.message.serialize(),n=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const i of e){const s=n.findIndex(o=>o.equals(i.publicKey));Ve(s>=0,`Cannot sign with non signer key ${i.publicKey.toBase58()}`),this.signatures[s]=af(t,i.secretKey)}}addSignature(e,t){Ve(t.byteLength===64,"Signature must be 64 bytes long");const i=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(s=>s.equals(e));Ve(i>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[i]=t}}const F_=160,j_=64,q_=F_/j_,bg=1e3/q_,ur=new re("SysvarC1ock11111111111111111111111111111111"),G_=new re("SysvarEpochSchedu1e111111111111111111111111"),H_=new re("Sysvar1nstructions1111111111111111111111111"),ec=new re("SysvarRecentB1ockHashes11111111111111111111"),Cs=new re("SysvarRent111111111111111111111111111111111"),Y_=new re("SysvarRewards111111111111111111111111111111"),J_=new re("SysvarS1otHashes111111111111111111111111111"),Q_=new re("SysvarS1otHistory11111111111111111111111111"),tc=new re("SysvarStakeHistory1111111111111111111111111");async function td(r,e,t,n){const i=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot},s=await r.sendTransaction(e,t,i);let o;if(e.recentBlockhash!=null&&e.lastValidBlockHeight!=null)o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,signature:s,blockhash:e.recentBlockhash,lastValidBlockHeight:e.lastValidBlockHeight},n&&n.commitment)).value;else if(e.minNonceContextSlot!=null&&e.nonceInfo!=null){const{nonceInstruction:a}=e.nonceInfo,c=a.keys[0].pubkey;o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,minContextSlot:e.minNonceContextSlot,nonceAccountPubkey:c,nonceValue:e.nonceInfo.nonce,signature:s},n&&n.commitment)).value}else(n==null?void 0:n.abortSignal)!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),o=(await r.confirmTransaction(s,n&&n.commitment)).value;if(o.err)throw new Error(`Transaction ${s} failed (${JSON.stringify(o)})`);return s}function mi(r){return new Promise(e=>setTimeout(e,r))}function Ke(r,e){const t=r.layout.span>=0?r.layout.span:mg(r,e),n=L.Buffer.alloc(t),i=Object.assign({instruction:r.index},e);return r.layout.encode(i,n),n}function Ye(r,e){let t;try{t=r.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.instruction!==r.index)throw new Error(`invalid instruction; instruction index mismatch ${t.instruction} != ${r.index}`);return t}const wg=we("lamportsPerSignature"),kg=C([M("version"),M("state"),Ce("authorizedPubkey"),Ce("nonce"),C([wg],"feeCalculator")]),nd=kg.span;class du{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=kg.decode(Te(e),0);return new du({authorizedPubkey:new re(t.authorizedPubkey),nonce:new re(t.nonce).toString(),feeCalculator:t.feeCalculator})}}const X_=r=>{const e=r.decode.bind(r),t=r.encode.bind(r);return{decode:e,encode:t}},Z_=r=>e=>{const t=he(r,e),{encode:n,decode:i}=X_(t),s=t;return s.decode=(o,a)=>{const c=i(o,a);return Bd(L.Buffer.from(c))},s.encode=(o,a,c)=>{const l=ta(o,r);return n(l,a,c)},s},Ms=Z_(8);class eA{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(st))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a SystemInstruction");return i}static decodeCreateAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t,space:n,programId:i}=Ye(st.Create,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,lamports:t,space:n,programId:new re(i)}}static decodeTransfer(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t}=Ye(st.Transfer,e.data);return{fromPubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,lamports:t}}static decodeTransferWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t,seed:n,programId:i}=Ye(st.TransferWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,basePubkey:e.keys[1].pubkey,toPubkey:e.keys[2].pubkey,lamports:t,seed:n,programId:new re(i)}}static decodeAllocate(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{space:t}=Ye(st.Allocate,e.data);return{accountPubkey:e.keys[0].pubkey,space:t}}static decodeAllocateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:n,space:i,programId:s}=Ye(st.AllocateWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new re(t),seed:n,space:i,programId:new re(s)}}static decodeAssign(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{programId:t}=Ye(st.Assign,e.data);return{accountPubkey:e.keys[0].pubkey,programId:new re(t)}}static decodeAssignWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:n,programId:i}=Ye(st.AssignWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new re(t),seed:n,programId:new re(i)}}static decodeCreateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{base:t,seed:n,lamports:i,space:s,programId:o}=Ye(st.CreateWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,basePubkey:new re(t),seed:n,lamports:i,space:s,programId:new re(o)}}static decodeNonceInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{authorized:t}=Ye(st.InitializeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:new re(t)}}static decodeNonceAdvance(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Ye(st.AdvanceNonceAccount,e.data),{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static decodeNonceWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Ye(st.WithdrawNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t}}static decodeNonceAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t}=Ye(st.AuthorizeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[1].pubkey,newAuthorizedPubkey:new re(t)}}static checkProgramId(e){if(!e.equals(qt.programId))throw new Error("invalid instruction; programId is not SystemProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const st=Object.freeze({Create:{index:0,layout:C([M("instruction"),Me("lamports"),Me("space"),Ce("programId")])},Assign:{index:1,layout:C([M("instruction"),Ce("programId")])},Transfer:{index:2,layout:C([M("instruction"),Ms("lamports")])},CreateWithSeed:{index:3,layout:C([M("instruction"),Ce("base"),Si("seed"),Me("lamports"),Me("space"),Ce("programId")])},AdvanceNonceAccount:{index:4,layout:C([M("instruction")])},WithdrawNonceAccount:{index:5,layout:C([M("instruction"),Me("lamports")])},InitializeNonceAccount:{index:6,layout:C([M("instruction"),Ce("authorized")])},AuthorizeNonceAccount:{index:7,layout:C([M("instruction"),Ce("authorized")])},Allocate:{index:8,layout:C([M("instruction"),Me("space")])},AllocateWithSeed:{index:9,layout:C([M("instruction"),Ce("base"),Si("seed"),Me("space"),Ce("programId")])},AssignWithSeed:{index:10,layout:C([M("instruction"),Ce("base"),Si("seed"),Ce("programId")])},TransferWithSeed:{index:11,layout:C([M("instruction"),Ms("lamports"),Si("seed"),Ce("programId")])},UpgradeNonceAccount:{index:12,layout:C([M("instruction")])}});class qt{constructor(){}static createAccount(e){const t=st.Create,n=Ke(t,{lamports:e.lamports,space:e.space,programId:Te(e.programId.toBuffer())});return new rt({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:n})}static transfer(e){let t,n;if("basePubkey"in e){const i=st.TransferWithSeed;t=Ke(i,{lamports:BigInt(e.lamports),seed:e.seed,programId:Te(e.programId.toBuffer())}),n=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}else{const i=st.Transfer;t=Ke(i,{lamports:BigInt(e.lamports)}),n=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}return new rt({keys:n,programId:this.programId,data:t})}static assign(e){let t,n;if("basePubkey"in e){const i=st.AssignWithSeed;t=Ke(i,{base:Te(e.basePubkey.toBuffer()),seed:e.seed,programId:Te(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=st.Assign;t=Ke(i,{programId:Te(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new rt({keys:n,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=st.CreateWithSeed,n=Ke(t,{base:Te(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:Te(e.programId.toBuffer())});let i=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey!=e.fromPubkey&&i.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new rt({keys:i,programId:this.programId,data:n})}static createNonceAccount(e){const t=new Je;"basePubkey"in e&&"seed"in e?t.add(qt.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:nd,programId:this.programId})):t.add(qt.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:nd,programId:this.programId}));const n={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(n)),t}static nonceInitialize(e){const t=st.InitializeNonceAccount,n=Ke(t,{authorized:Te(e.authorizedPubkey.toBuffer())}),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:ec,isSigner:!1,isWritable:!1},{pubkey:Cs,isSigner:!1,isWritable:!1}],programId:this.programId,data:n};return new rt(i)}static nonceAdvance(e){const t=st.AdvanceNonceAccount,n=Ke(t),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:ec,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n};return new rt(i)}static nonceWithdraw(e){const t=st.WithdrawNonceAccount,n=Ke(t,{lamports:e.lamports});return new rt({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:ec,isSigner:!1,isWritable:!1},{pubkey:Cs,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static nonceAuthorize(e){const t=st.AuthorizeNonceAccount,n=Ke(t,{authorized:Te(e.newAuthorizedPubkey.toBuffer())});return new rt({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static allocate(e){let t,n;if("basePubkey"in e){const i=st.AllocateWithSeed;t=Ke(i,{base:Te(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:Te(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=st.Allocate;t=Ke(i,{space:e.space}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new rt({keys:n,programId:this.programId,data:t})}}qt.programId=new re("11111111111111111111111111111111");const tA=Jr-300;class Bi{constructor(){}static getMinNumSignatures(e){return 2*(Math.ceil(e/Bi.chunkSize)+1+1)}static async load(e,t,n,i,s){{const f=await e.getMinimumBalanceForRentExemption(s.length),m=await e.getAccountInfo(n.publicKey,"confirmed");let y=null;if(m!==null){if(m.executable)return console.error("Program load failed, account is already executable"),!1;m.data.length!==s.length&&(y=y||new Je,y.add(qt.allocate({accountPubkey:n.publicKey,space:s.length}))),m.owner.equals(i)||(y=y||new Je,y.add(qt.assign({accountPubkey:n.publicKey,programId:i}))),m.lamports<f&&(y=y||new Je,y.add(qt.transfer({fromPubkey:t.publicKey,toPubkey:n.publicKey,lamports:f-m.lamports})))}else y=new Je().add(qt.createAccount({fromPubkey:t.publicKey,newAccountPubkey:n.publicKey,lamports:f>0?f:1,space:s.length,programId:i}));y!==null&&await td(e,y,[t,n],{commitment:"confirmed"})}const o=C([M("instruction"),M("offset"),M("bytesLength"),M("bytesLengthPadding"),Ie(ee("byte"),Pt(M(),-8),"bytes")]),a=Bi.chunkSize;let c=0,l=s,u=[];for(;l.length>0;){const f=l.slice(0,a),m=L.Buffer.alloc(a+16);o.encode({instruction:0,offset:c,bytes:f,bytesLength:0,bytesLengthPadding:0},m);const y=new Je().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0}],programId:i,data:m});u.push(td(e,y,[t,n],{commitment:"confirmed"})),e._rpcEndpoint.includes("solana.com")&&await mi(1e3/4),c+=a,l=l.slice(a)}await Promise.all(u);{const f=C([M("instruction")]),m=L.Buffer.alloc(f.span);f.encode({instruction:1},m);const y=new Je().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0},{pubkey:Cs,isSigner:!1,isWritable:!1}],programId:i,data:m}),S="processed",p=await e.sendTransaction(y,[t,n],{preflightCommitment:S}),{context:w,value:v}=await e.confirmTransaction({signature:p,lastValidBlockHeight:y.lastValidBlockHeight,blockhash:y.recentBlockhash},S);if(v.err)throw new Error(`Transaction ${p} failed (${JSON.stringify(v)})`);for(;;){try{if(await e.getSlot({commitment:S})>w.slot)break}catch{}await new Promise(E=>setTimeout(E,Math.round(bg/2)))}}return!0}}Bi.chunkSize=tA;const nA=new re("BPFLoader2111111111111111111111111111111111");class rA{static getMinNumSignatures(e){return Bi.getMinNumSignatures(e)}static load(e,t,n,i,s){return Bi.load(e,t,n,s,i)}}function iA(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var sA=Object.prototype.toString,oA=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};function So(r,e){var t,n,i,s,o,a,c;if(r===!0)return"true";if(r===!1)return"false";switch(typeof r){case"object":if(r===null)return null;if(r.toJSON&&typeof r.toJSON=="function")return So(r.toJSON(),e);if(c=sA.call(r),c==="[object Array]"){for(i="[",n=r.length-1,t=0;t<n;t++)i+=So(r[t],!0)+",";return n>-1&&(i+=So(r[t],!0)),i+"]"}else if(c==="[object Object]"){for(s=oA(r).sort(),n=s.length,i="",t=0;t<n;)o=s[t],a=So(r[o],!1),a!==void 0&&(i&&(i+=","),i+=JSON.stringify(o)+":"+a),t++;return"{"+i+"}"}else return JSON.stringify(r);case"function":case"undefined":return e?null:void 0;case"string":return JSON.stringify(r);default:return isFinite(r)?r:null}}var aA=function(r){var e=So(r,!1);if(e!==void 0)return""+e},Ch=iA(aA);const mo=32;function wl(r){let e=0;for(;r>1;)r/=2,e++;return e}function cA(r){return r===0?1:(r--,r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16,r|=r>>32,r+1)}class Sg{constructor(e,t,n,i,s){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=n,this.firstNormalEpoch=i,this.firstNormalSlot=s}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const t=wl(cA(e+mo+1))-wl(mo)-1,n=this.getSlotsInEpoch(t),i=e-(n-mo);return[t,i]}else{const t=e-this.firstNormalSlot,n=Math.floor(t/this.slotsPerEpoch),i=this.firstNormalEpoch+n,s=t%this.slotsPerEpoch;return[i,s]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*mo:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+wl(mo)):this.slotsPerEpoch}}class rd extends Error{constructor(e,t){super(e),this.logs=void 0,this.logs=t}}const uA={JSON_RPC_SERVER_ERROR_BLOCK_CLEANED_UP:-32001,JSON_RPC_SERVER_ERROR_SEND_TRANSACTION_PREFLIGHT_FAILURE:-32002,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_VERIFICATION_FAILURE:-32003,JSON_RPC_SERVER_ERROR_BLOCK_NOT_AVAILABLE:-32004,JSON_RPC_SERVER_ERROR_NODE_UNHEALTHY:-32005,JSON_RPC_SERVER_ERROR_TRANSACTION_PRECOMPILE_VERIFICATION_FAILURE:-32006,JSON_RPC_SERVER_ERROR_SLOT_SKIPPED:-32007,JSON_RPC_SERVER_ERROR_NO_SNAPSHOT:-32008,JSON_RPC_SERVER_ERROR_LONG_TERM_STORAGE_SLOT_SKIPPED:-32009,JSON_RPC_SERVER_ERROR_KEY_EXCLUDED_FROM_SECONDARY_INDEX:-32010,JSON_RPC_SERVER_ERROR_TRANSACTION_HISTORY_NOT_AVAILABLE:-32011,JSON_RPC_SCAN_ERROR:-32012,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_LEN_MISMATCH:-32013,JSON_RPC_SERVER_ERROR_BLOCK_STATUS_NOT_AVAILABLE_YET:-32014,JSON_RPC_SERVER_ERROR_UNSUPPORTED_TRANSACTION_VERSION:-32015,JSON_RPC_SERVER_ERROR_MIN_CONTEXT_SLOT_NOT_REACHED:-32016};class de extends Error{constructor({code:e,message:t,data:n},i){super(i!=null?`${i}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=n,this.name="SolanaJSONRPCError"}}var lA=globalThis.fetch;class dA extends O_{constructor(e,t,n){const i=s=>{const o=B_(s,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in o?this.underlyingSocket=o.socket:this.underlyingSocket=o,o};super(i,e,t,n),this.underlyingSocket=void 0}call(...e){var n;const t=(n=this.underlyingSocket)==null?void 0:n.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){var n;const t=(n=this.underlyingSocket)==null?void 0:n.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}function fA(r,e){let t;try{t=r.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.typeIndex!==r.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${r.index}`);return t}const Mh=56;class id{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=fA(hA,e),n=e.length-Mh;Ve(n>=0,"lookup table is invalid"),Ve(n%32===0,"lookup table is invalid");const i=n/32,{addresses:s}=C([Ie(Ce(),i,"addresses")]).decode(e.slice(Mh));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new re(t.authority[0]):void 0,addresses:s.map(o=>new re(o))}}}const hA={index:1,layout:C([M("typeIndex"),Ms("deactivationSlot"),we("lastExtendedSlot"),ee("lastExtendedStartIndex"),ee(),Ie(Ce(),Pt(ee(),-1),"authority")])},pA=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function yA(r){const e=r.match(pA);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${r}\``);const[t,n,i,s]=e,o=r.startsWith("https:")?"wss:":"ws:",a=i==null?null:parseInt(i.slice(1),10),c=a==null?"":`:${a+1}`;return`${o}//${n}${c}${s}`}const Ot=_r(Xs(re),N(),r=>new re(r)),vg=Zs([N(),Se("base64")]),pf=_r(Xs(L.Buffer),vg,r=>L.Buffer.from(r[0],"base64")),_g=30*1e3;function gA(r){if(/^https?:/.test(r)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return r}function ut(r){let e,t;if(typeof r=="string")e=r;else if(r){const{commitment:n,...i}=r;e=n,t=i}return{commitment:e,config:t}}function Ag(r){return Ze([O({jsonrpc:Se("2.0"),id:N(),result:r}),O({jsonrpc:Se("2.0"),id:N(),error:O({code:vr(),message:N(),data:X(dg())})})])}const mA=Ag(vr());function Pe(r){return _r(Ag(r),mA,e=>"error"in e?e:{...e,result:te(e.result,r)})}function kt(r){return Pe(O({context:O({slot:k()}),value:r}))}function fu(r){return O({context:O({slot:k()}),value:r})}function kl(r,e){return r===0?new Oi({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new re(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:pe.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new tr(e)}const bA=O({foundation:k(),foundationTerm:k(),initial:k(),taper:k(),terminal:k()}),wA=Pe(j(F(O({epoch:k(),effectiveSlot:k(),amount:k(),postBalance:k(),commission:X(F(k()))})))),kA=j(O({slot:k(),prioritizationFee:k()})),SA=O({total:k(),validator:k(),foundation:k(),epoch:k()}),vA=O({epoch:k(),slotIndex:k(),slotsInEpoch:k(),absoluteSlot:k(),blockHeight:X(k()),transactionCount:X(k())}),_A=O({slotsPerEpoch:k(),leaderScheduleSlotOffset:k(),warmup:Tt(),firstNormalEpoch:k(),firstNormalSlot:k()}),AA=cu(N(),j(k())),ji=F(Ze([O({}),N()])),IA=O({err:ji}),EA=Se("receivedSignature"),PA=O({"solana-core":N(),"feature-set":X(k())}),Lh=kt(O({err:F(Ze([O({}),N()])),logs:F(j(N())),accounts:X(F(j(F(O({executable:Tt(),owner:N(),lamports:k(),data:j(N()),rentEpoch:X(k())}))))),unitsConsumed:X(k()),returnData:X(F(O({programId:N(),data:Zs([N(),Se("base64")])})))})),RA=kt(O({byIdentity:cu(N(),j(k())),range:O({firstSlot:k(),lastSlot:k()})}));function TA(r,e,t,n,i,s){const o=t||lA;let a;s!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let c;return n&&(c=async(u,f)=>{const m=await new Promise((y,S)=>{try{n(u,f,(p,w)=>y([p,w]))}catch(p){S(p)}});return await o(...m)}),new T_(async(u,f)=>{const m={method:"POST",body:u,agent:a,headers:Object.assign({"Content-Type":"application/json"},e||{},O1)};try{let y=5,S,p=500;for(;c?S=await c(r,m):S=await o(r,m),!(S.status!==429||i===!0||(y-=1,y===0));)console.log(`Server responded with ${S.status} ${S.statusText}.  Retrying after ${p}ms delay...`),await mi(p),p*=2;const w=await S.text();S.ok?f(null,w):f(new Error(`${S.status} ${S.statusText}: ${w}`))}catch(y){y instanceof Error&&f(y)}},{})}function OA(r){return(e,t)=>new Promise((n,i)=>{r.request(e,t,(s,o)=>{if(s){i(s);return}n(o)})})}function BA(r){return e=>new Promise((t,n)=>{e.length===0&&t([]);const i=e.map(s=>r.request(s.methodName,s.args));r.request(i,(s,o)=>{if(s){n(s);return}t(o)})})}const xA=Pe(bA),CA=Pe(SA),MA=Pe(kA),LA=Pe(vA),KA=Pe(_A),NA=Pe(AA),DA=Pe(k()),$A=kt(O({total:k(),circulating:k(),nonCirculating:k(),nonCirculatingAccounts:j(Ot)})),sd=O({amount:N(),uiAmount:F(k()),decimals:k(),uiAmountString:X(N())}),zA=kt(j(O({address:Ot,amount:N(),uiAmount:F(k()),decimals:k(),uiAmountString:X(N())}))),WA=kt(j(O({pubkey:Ot,account:O({executable:Tt(),owner:Ot,lamports:k(),data:pf,rentEpoch:k()})}))),od=O({program:N(),parsed:vr(),space:k()}),VA=kt(j(O({pubkey:Ot,account:O({executable:Tt(),owner:Ot,lamports:k(),data:od,rentEpoch:k()})}))),UA=kt(j(O({lamports:k(),address:Ot}))),Go=O({executable:Tt(),owner:Ot,lamports:k(),data:pf,rentEpoch:k()}),FA=O({pubkey:Ot,account:Go}),jA=_r(Ze([Xs(L.Buffer),od]),Ze([vg,od]),r=>Array.isArray(r)?te(r,pf):r),ad=O({executable:Tt(),owner:Ot,lamports:k(),data:jA,rentEpoch:k()}),qA=O({pubkey:Ot,account:ad}),GA=O({state:Ze([Se("active"),Se("inactive"),Se("activating"),Se("deactivating")]),active:k(),inactive:k()}),HA=Pe(j(O({signature:N(),slot:k(),err:ji,memo:F(N()),blockTime:X(F(k()))}))),YA=Pe(j(O({signature:N(),slot:k(),err:ji,memo:F(N()),blockTime:X(F(k()))}))),JA=O({subscription:k(),result:fu(Go)}),QA=O({pubkey:Ot,account:Go}),XA=O({subscription:k(),result:fu(QA)}),ZA=O({parent:k(),slot:k(),root:k()}),e1=O({subscription:k(),result:ZA}),t1=Ze([O({type:Ze([Se("firstShredReceived"),Se("completed"),Se("optimisticConfirmation"),Se("root")]),slot:k(),timestamp:k()}),O({type:Se("createdBank"),parent:k(),slot:k(),timestamp:k()}),O({type:Se("frozen"),slot:k(),timestamp:k(),stats:O({numTransactionEntries:k(),numSuccessfulTransactions:k(),numFailedTransactions:k(),maxTransactionsPerEntry:k()})}),O({type:Se("dead"),slot:k(),timestamp:k(),err:N()})]),n1=O({subscription:k(),result:t1}),r1=O({subscription:k(),result:fu(Ze([IA,EA]))}),i1=O({subscription:k(),result:k()}),s1=O({pubkey:N(),gossip:F(N()),tpu:F(N()),rpc:F(N()),version:F(N())}),Kh=O({votePubkey:N(),nodePubkey:N(),activatedStake:k(),epochVoteAccount:Tt(),epochCredits:j(Zs([k(),k(),k()])),commission:k(),lastVote:k(),rootSlot:F(k())}),o1=Pe(O({current:j(Kh),delinquent:j(Kh)})),a1=Ze([Se("processed"),Se("confirmed"),Se("finalized")]),c1=O({slot:k(),confirmations:F(k()),err:ji,confirmationStatus:X(a1)}),u1=kt(j(F(c1))),l1=Pe(k()),Ig=O({accountKey:Ot,writableIndexes:j(k()),readonlyIndexes:j(k())}),yf=O({signatures:j(N()),message:O({accountKeys:j(N()),header:O({numRequiredSignatures:k(),numReadonlySignedAccounts:k(),numReadonlyUnsignedAccounts:k()}),instructions:j(O({accounts:j(k()),data:N(),programIdIndex:k()})),recentBlockhash:N(),addressTableLookups:X(j(Ig))})}),Eg=O({pubkey:Ot,signer:Tt(),writable:Tt(),source:X(Ze([Se("transaction"),Se("lookupTable")]))}),Pg=O({accountKeys:j(Eg),signatures:j(N())}),Rg=O({parsed:vr(),program:N(),programId:Ot}),Tg=O({accounts:j(Ot),data:N(),programId:Ot}),d1=Ze([Tg,Rg]),f1=Ze([O({parsed:vr(),program:N(),programId:N()}),O({accounts:j(N()),data:N(),programId:N()})]),Og=_r(d1,f1,r=>"accounts"in r?te(r,Tg):te(r,Rg)),Bg=O({signatures:j(N()),message:O({accountKeys:j(Eg),instructions:j(Og),recentBlockhash:N(),addressTableLookups:X(F(j(Ig)))})}),yc=O({accountIndex:k(),mint:N(),owner:X(N()),uiTokenAmount:sd}),xg=O({writable:j(Ot),readonly:j(Ot)}),hu=O({err:ji,fee:k(),innerInstructions:X(F(j(O({index:k(),instructions:j(O({accounts:j(k()),data:N(),programIdIndex:k()}))})))),preBalances:j(k()),postBalances:j(k()),logMessages:X(F(j(N()))),preTokenBalances:X(F(j(yc))),postTokenBalances:X(F(j(yc))),loadedAddresses:X(xg),computeUnitsConsumed:X(k())}),gf=O({err:ji,fee:k(),innerInstructions:X(F(j(O({index:k(),instructions:j(Og)})))),preBalances:j(k()),postBalances:j(k()),logMessages:X(F(j(N()))),preTokenBalances:X(F(j(yc))),postTokenBalances:X(F(j(yc))),loadedAddresses:X(xg),computeUnitsConsumed:X(k())}),eo=Ze([Se(0),Se("legacy")]),qi=O({pubkey:N(),lamports:k(),postBalance:F(k()),rewardType:F(N()),commission:X(F(k()))}),h1=Pe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:yf,meta:F(hu),version:X(eo)})),rewards:X(j(qi)),blockTime:F(k()),blockHeight:F(k())}))),p1=Pe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),rewards:X(j(qi)),blockTime:F(k()),blockHeight:F(k())}))),y1=Pe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:Pg,meta:F(hu),version:X(eo)})),rewards:X(j(qi)),blockTime:F(k()),blockHeight:F(k())}))),g1=Pe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:Bg,meta:F(gf),version:X(eo)})),rewards:X(j(qi)),blockTime:F(k()),blockHeight:F(k())}))),m1=Pe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:Pg,meta:F(gf),version:X(eo)})),rewards:X(j(qi)),blockTime:F(k()),blockHeight:F(k())}))),b1=Pe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),rewards:X(j(qi)),blockTime:F(k()),blockHeight:F(k())}))),w1=Pe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:yf,meta:F(hu)})),rewards:X(j(qi)),blockTime:F(k())}))),Nh=Pe(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),signatures:j(N()),blockTime:F(k())}))),Sl=Pe(F(O({slot:k(),meta:F(hu),blockTime:X(F(k())),transaction:yf,version:X(eo)}))),Ba=Pe(F(O({slot:k(),transaction:Bg,meta:F(gf),blockTime:X(F(k())),version:X(eo)}))),k1=kt(O({blockhash:N(),feeCalculator:O({lamportsPerSignature:k()})})),S1=kt(O({blockhash:N(),lastValidBlockHeight:k()})),v1=kt(Tt()),_1=O({slot:k(),numTransactions:k(),numSlots:k(),samplePeriodSecs:k()}),A1=Pe(j(_1)),I1=kt(F(O({feeCalculator:O({lamportsPerSignature:k()})}))),E1=Pe(N()),P1=Pe(N()),R1=O({err:ji,logs:j(N()),signature:N()}),T1=O({result:fu(R1),subscription:k()}),O1={"solana-client":"js/0.0.0-development"};class B1{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const l={};return async u=>{const{commitment:f,config:m}=ut(u),y=this._buildArgs([],f,void 0,m),S=Ch(y);return l[S]=l[S]??(async()=>{try{const p=await this._rpcRequest("getBlockHeight",y),w=te(p,Pe(k()));if("error"in w)throw new de(w.error,"failed to get block height information");return w.result}finally{delete l[S]}})(),await l[S]}})();let n,i,s,o,a,c;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,n=t.wsEndpoint,i=t.httpHeaders,s=t.fetch,o=t.fetchMiddleware,a=t.disableRetryOnRateLimit,c=t.httpAgent),this._rpcEndpoint=gA(e),this._rpcWsEndpoint=n||yA(e),this._rpcClient=TA(e,i,s,o,a,c),this._rpcRequest=OA(this._rpcClient),this._rpcBatchRequest=BA(this._rpcClient),this._rpcWebSocket=new dA(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:n,config:i}=ut(t),s=this._buildArgs([e.toBase58()],n,void 0,i),o=await this._rpcRequest("getBalance",s),a=te(o,kt(k()));if("error"in a)throw new de(a.error,`failed to get balance for ${e.toBase58()}`);return a.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+n)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),n=te(t,Pe(F(k())));if("error"in n)throw new de(n.error,`failed to get block time for slot ${e}`);return n.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=te(e,Pe(k()));if("error"in t)throw new de(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=te(e,DA);if("error"in t)throw new de(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};const n=await this._rpcRequest("getSupply",[t]),i=te(n,$A);if("error"in i)throw new de(i.error,"failed to get supply");return i.result}async getTokenSupply(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenSupply",n),s=te(i,kt(sd));if("error"in s)throw new de(s.error,"failed to get token supply");return s.result}async getTokenAccountBalance(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenAccountBalance",n),s=te(i,kt(sd));if("error"in s)throw new de(s.error,"failed to get token account balance");return s.result}async getTokenAccountsByOwner(e,t,n){const{commitment:i,config:s}=ut(n);let o=[e.toBase58()];"mint"in t?o.push({mint:t.mint.toBase58()}):o.push({programId:t.programId.toBase58()});const a=this._buildArgs(o,i,"base64",s),c=await this._rpcRequest("getTokenAccountsByOwner",a),l=te(c,WA);if("error"in l)throw new de(l.error,`failed to get token accounts owned by account ${e.toBase58()}`);return l.result}async getParsedTokenAccountsByOwner(e,t,n){let i=[e.toBase58()];"mint"in t?i.push({mint:t.mint.toBase58()}):i.push({programId:t.programId.toBase58()});const s=this._buildArgs(i,n,"jsonParsed"),o=await this._rpcRequest("getTokenAccountsByOwner",s),a=te(o,VA);if("error"in a)throw new de(a.error,`failed to get token accounts owned by account ${e.toBase58()}`);return a.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},n=t.filter||t.commitment?[t]:[],i=await this._rpcRequest("getLargestAccounts",n),s=te(i,UA);if("error"in s)throw new de(s.error,"failed to get largest accounts");return s.result}async getTokenLargestAccounts(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenLargestAccounts",n),s=te(i,zA);if("error"in s)throw new de(s.error,"failed to get token largest accounts");return s.result}async getAccountInfoAndContext(e,t){const{commitment:n,config:i}=ut(t),s=this._buildArgs([e.toBase58()],n,"base64",i),o=await this._rpcRequest("getAccountInfo",s),a=te(o,kt(F(Go)));if("error"in a)throw new de(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getParsedAccountInfo(e,t){const{commitment:n,config:i}=ut(t),s=this._buildArgs([e.toBase58()],n,"jsonParsed",i),o=await this._rpcRequest("getAccountInfo",s),a=te(o,kt(F(ad)));if("error"in a)throw new de(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(n){throw new Error("failed to get info about account "+e.toBase58()+": "+n)}}async getMultipleParsedAccounts(e,t){const{commitment:n,config:i}=ut(t),s=e.map(l=>l.toBase58()),o=this._buildArgs([s],n,"jsonParsed",i),a=await this._rpcRequest("getMultipleAccounts",o),c=te(a,kt(j(F(ad))));if("error"in c)throw new de(c.error,`failed to get info for accounts ${s}`);return c.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:n,config:i}=ut(t),s=e.map(l=>l.toBase58()),o=this._buildArgs([s],n,"base64",i),a=await this._rpcRequest("getMultipleAccounts",o),c=te(a,kt(j(F(Go))));if("error"in c)throw new de(c.error,`failed to get info for accounts ${s}`);return c.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,n){const{commitment:i,config:s}=ut(t),o=this._buildArgs([e.toBase58()],i,void 0,{...s,epoch:n??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getStakeActivation",o),c=te(a,Pe(GA));if("error"in c)throw new de(c.error,`failed to get Stake Activation ${e.toBase58()}`);return c.result}async getProgramAccounts(e,t){const{commitment:n,config:i}=ut(t),{encoding:s,...o}=i||{},a=this._buildArgs([e.toBase58()],n,s||"base64",o),c=await this._rpcRequest("getProgramAccounts",a),l=j(FA),u=o.withContext===!0?te(c,kt(l)):te(c,Pe(l));if("error"in u)throw new de(u.error,`failed to get accounts owned by program ${e.toBase58()}`);return u.result}async getParsedProgramAccounts(e,t){const{commitment:n,config:i}=ut(t),s=this._buildArgs([e.toBase58()],n,"jsonParsed",i),o=await this._rpcRequest("getProgramAccounts",s),a=te(o,Pe(j(qA)));if("error"in a)throw new de(a.error,`failed to get accounts owned by program ${e.toBase58()}`);return a.result}async confirmTransaction(e,t){var s;let n;if(typeof e=="string")n=e;else{const o=e;if((s=o.abortSignal)!=null&&s.aborted)return Promise.reject(o.abortSignal.reason);n=o.signature}let i;try{i=pe.decode(n)}catch{throw new Error("signature must be base58 encoded: "+n)}return Ve(i.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:n}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,n)=>{e!=null&&(e.aborted?n(e.reason):e.addEventListener("abort",()=>{n(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let n,i,s=!1;const o=new Promise((c,l)=>{try{n=this.onSignature(t,(f,m)=>{n=void 0;const y={context:m,value:f};c({__type:Er.PROCESSED,response:y})},e);const u=new Promise(f=>{n==null?f():i=this._onSubscriptionStateChange(n,m=>{m==="subscribed"&&f()})});(async()=>{if(await u,s)return;const f=await this.getSignatureStatus(t);if(s||f==null)return;const{context:m,value:y}=f;if(y!=null)if(y!=null&&y.err)l(y.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(y.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(y.confirmationStatus==="processed"||y.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}s=!0,c({__type:Er.PROCESSED,response:{context:m,value:y}})}})()}catch(u){l(u)}});return{abortConfirmation:()=>{i&&(i(),i=void 0),n!=null&&(this.removeSignatureListener(n),n=void 0)},confirmationPromise:o}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:n,signature:i}}){let s=!1;const o=new Promise(f=>{const m=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let y=await m();if(!s){for(;y<=n;)if(await mi(1e3),s||(y=await m(),s))return;f({__type:Er.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:a,confirmationPromise:c}=this.getTransactionConfirmationPromise({commitment:e,signature:i}),l=this.getCancellationPromise(t);let u;try{const f=await Promise.race([l,c,o]);if(f.__type===Er.PROCESSED)u=f.response;else throw new uf(i)}finally{s=!0,a()}return u}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:n,nonceAccountPubkey:i,nonceValue:s,signature:o}}){let a=!1;const c=new Promise(y=>{let S=s,p=null;const w=async()=>{try{const{context:v,value:E}=await this.getNonceAndContext(i,{commitment:e,minContextSlot:n});return p=v.slot,E==null?void 0:E.nonce}catch{return S}};(async()=>{if(S=await w(),!a)for(;;){if(s!==S){y({__type:Er.NONCE_INVALID,slotInWhichNonceDidAdvance:p});return}if(await mi(2e3),a||(S=await w(),a))return}})()}),{abortConfirmation:l,confirmationPromise:u}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),f=this.getCancellationPromise(t);let m;try{const y=await Promise.race([f,u,c]);if(y.__type===Er.PROCESSED)m=y.response;else{let S;for(;;){const p=await this.getSignatureStatus(o);if(p==null)break;if(p.context.slot<(y.slotInWhichNonceDidAdvance??n)){await mi(400);continue}S=p;break}if(S!=null&&S.value){const p=e||"finalized",{confirmationStatus:w}=S.value;switch(p){case"processed":case"recent":if(w!=="processed"&&w!=="confirmed"&&w!=="finalized")throw new fs(o);break;case"confirmed":case"single":case"singleGossip":if(w!=="confirmed"&&w!=="finalized")throw new fs(o);break;case"finalized":case"max":case"root":if(w!=="finalized")throw new fs(o);break;default:(v=>{})(p)}m={context:S.context,value:{err:S.value.err}}}else throw new fs(o)}}finally{a=!0,l()}return m}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let n;const i=new Promise(c=>{let l=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{l=this._confirmTransactionInitialTimeout||3e4;break}}n=setTimeout(()=>c({__type:Er.TIMED_OUT,timeoutMs:l}),l)}),{abortConfirmation:s,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let a;try{const c=await Promise.race([o,i]);if(c.__type===Er.PROCESSED)a=c.response;else throw new lf(t,c.timeoutMs/1e3)}finally{clearTimeout(n),s()}return a}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=te(e,Pe(j(s1)));if("error"in t)throw new de(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getVoteAccounts",t),i=te(n,o1);if("error"in i)throw new de(i.error,"failed to get vote accounts");return i.result}async getSlot(e){const{commitment:t,config:n}=ut(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getSlot",i),o=te(s,Pe(k()));if("error"in o)throw new de(o.error,"failed to get slot");return o.result}async getSlotLeader(e){const{commitment:t,config:n}=ut(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getSlotLeader",i),o=te(s,Pe(N()));if("error"in o)throw new de(o.error,"failed to get slot leader");return o.result}async getSlotLeaders(e,t){const n=[e,t],i=await this._rpcRequest("getSlotLeaders",n),s=te(i,Pe(j(Ot)));if("error"in s)throw new de(s.error,"failed to get slot leaders");return s.result}async getSignatureStatus(e,t){const{context:n,value:i}=await this.getSignatureStatuses([e],t);Ve(i.length===1);const s=i[0];return{context:n,value:s}}async getSignatureStatuses(e,t){const n=[e];t&&n.push(t);const i=await this._rpcRequest("getSignatureStatuses",n),s=te(i,u1);if("error"in s)throw new de(s.error,"failed to get signature status");return s.result}async getTransactionCount(e){const{commitment:t,config:n}=ut(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getTransactionCount",i),o=te(s,Pe(k()));if("error"in o)throw new de(o.error,"failed to get transaction count");return o.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getInflationGovernor",t),i=te(n,xA);if("error"in i)throw new de(i.error,"failed to get inflation");return i.result}async getInflationReward(e,t,n){const{commitment:i,config:s}=ut(n),o=this._buildArgs([e.map(l=>l.toBase58())],i,void 0,{...s,epoch:t??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getInflationReward",o),c=te(a,wA);if("error"in c)throw new de(c.error,"failed to get inflation reward");return c.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=te(e,CA);if("error"in t)throw new de(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:n}=ut(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getEpochInfo",i),o=te(s,LA);if("error"in o)throw new de(o.error,"failed to get epoch info");return o.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=te(e,KA);if("error"in t)throw new de(t.error,"failed to get epoch schedule");const n=t.result;return new Sg(n.slotsPerEpoch,n.leaderScheduleSlotOffset,n.warmup,n.firstNormalEpoch,n.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=te(e,NA);if("error"in t)throw new de(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const n=this._buildArgs([e],t),i=await this._rpcRequest("getMinimumBalanceForRentExemption",n),s=te(i,l1);return"error"in s?(console.warn("Unable to fetch minimum balance for rent exemption"),0):s.result}async getRecentBlockhashAndContext(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getRecentBlockhash",t),i=te(n,k1);if("error"in i)throw new de(i.error,"failed to get recent blockhash");return i.result}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),n=te(t,A1);if("error"in n)throw new de(n.error,"failed to get recent performance samples");return n.result}async getFeeCalculatorForBlockhash(e,t){const n=this._buildArgs([e],t),i=await this._rpcRequest("getFeeCalculatorForBlockhash",n),s=te(i,I1);if("error"in s)throw new de(s.error,"failed to get fee calculator");const{context:o,value:a}=s.result;return{context:o,value:a!==null?a.feeCalculator:null}}async getFeeForMessage(e,t){const n=Te(e.serialize()).toString("base64"),i=this._buildArgs([n],t),s=await this._rpcRequest("getFeeForMessage",i),o=te(s,kt(F(k())));if("error"in o)throw new de(o.error,"failed to get fee for message");if(o.result===null)throw new Error("invalid blockhash");return o.result}async getRecentPrioritizationFees(e){var o;const t=(o=e==null?void 0:e.lockedWritableAccounts)==null?void 0:o.map(a=>a.toBase58()),n=t!=null&&t.length?[t]:[],i=await this._rpcRequest("getRecentPrioritizationFees",n),s=te(i,MA);if("error"in s)throw new de(s.error,"failed to get recent prioritization fees");return s.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:n}=ut(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getLatestBlockhash",i),o=te(s,S1);if("error"in o)throw new de(o.error,"failed to get latest blockhash");return o.result}async isBlockhashValid(e,t){const{commitment:n,config:i}=ut(t),s=this._buildArgs([e],n,void 0,i),o=await this._rpcRequest("isBlockhashValid",s),a=te(o,v1);if("error"in a)throw new de(a.error,"failed to determine if the blockhash `"+e+"`is valid");return a.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=te(e,Pe(PA));if("error"in t)throw new de(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=te(e,Pe(N()));if("error"in t)throw new de(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:n,config:i}=ut(t),s=this._buildArgsAtLeastConfirmed([e],n,void 0,i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=te(o,y1);if("error"in a)throw a.error;return a.result}case"none":{const a=te(o,p1);if("error"in a)throw a.error;return a.result}default:{const a=te(o,h1);if("error"in a)throw a.error;const{result:c}=a;return c?{...c,transactions:c.transactions.map(({transaction:l,meta:u,version:f})=>({meta:u,transaction:{...l,message:kl(f,l.message)},version:f}))}:null}}}catch(a){throw new de(a,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:n,config:i}=ut(t),s=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=te(o,m1);if("error"in a)throw a.error;return a.result}case"none":{const a=te(o,b1);if("error"in a)throw a.error;return a.result}default:{const a=te(o,g1);if("error"in a)throw a.error;return a.result}}}catch(a){throw new de(a,"failed to get block")}}async getBlockProduction(e){let t,n;if(typeof e=="string")n=e;else if(e){const{commitment:a,...c}=e;n=a,t=c}const i=this._buildArgs([],n,"base64",t),s=await this._rpcRequest("getBlockProduction",i),o=te(s,RA);if("error"in o)throw new de(o.error,"failed to get block production information");return o.result}async getTransaction(e,t){const{commitment:n,config:i}=ut(t),s=this._buildArgsAtLeastConfirmed([e],n,void 0,i),o=await this._rpcRequest("getTransaction",s),a=te(o,Sl);if("error"in a)throw new de(a.error,"failed to get transaction");const c=a.result;return c&&{...c,transaction:{...c.transaction,message:kl(c.version,c.transaction.message)}}}async getParsedTransaction(e,t){const{commitment:n,config:i}=ut(t),s=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",i),o=await this._rpcRequest("getTransaction",s),a=te(o,Ba);if("error"in a)throw new de(a.error,"failed to get transaction");return a.result}async getParsedTransactions(e,t){const{commitment:n,config:i}=ut(t),s=e.map(c=>{const l=this._buildArgsAtLeastConfirmed([c],n,"jsonParsed",i);return{methodName:"getTransaction",args:l}});return(await this._rpcBatchRequest(s)).map(c=>{const l=te(c,Ba);if("error"in l)throw new de(l.error,"failed to get transactions");return l.result})}async getTransactions(e,t){const{commitment:n,config:i}=ut(t),s=e.map(c=>{const l=this._buildArgsAtLeastConfirmed([c],n,void 0,i);return{methodName:"getTransaction",args:l}});return(await this._rpcBatchRequest(s)).map(c=>{const l=te(c,Sl);if("error"in l)throw new de(l.error,"failed to get transactions");const u=l.result;return u&&{...u,transaction:{...u.transaction,message:kl(u.version,u.transaction.message)}}})}async getConfirmedBlock(e,t){const n=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getConfirmedBlock",n),s=te(i,w1);if("error"in s)throw new de(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");const a={...o,transactions:o.transactions.map(({transaction:c,meta:l})=>{const u=new tr(c.message);return{meta:l,transaction:{...c,message:u}}})};return{...a,transactions:a.transactions.map(({transaction:c,meta:l})=>({meta:l,transaction:Je.populate(c.message,c.signatures)}))}}async getBlocks(e,t,n){const i=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],n),s=await this._rpcRequest("getBlocks",i),o=te(s,Pe(j(k())));if("error"in o)throw new de(o.error,"failed to get blocks");return o.result}async getBlockSignatures(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getBlock",n),s=te(i,Nh);if("error"in s)throw new de(s.error,"failed to get block");const o=s.result;if(!o)throw new Error("Block "+e+" not found");return o}async getConfirmedBlockSignatures(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getConfirmedBlock",n),s=te(i,Nh);if("error"in s)throw new de(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");return o}async getConfirmedTransaction(e,t){const n=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getConfirmedTransaction",n),s=te(i,Sl);if("error"in s)throw new de(s.error,"failed to get transaction");const o=s.result;if(!o)return o;const a=new tr(o.transaction.message),c=o.transaction.signatures;return{...o,transaction:Je.populate(a,c)}}async getParsedConfirmedTransaction(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),i=await this._rpcRequest("getConfirmedTransaction",n),s=te(i,Ba);if("error"in s)throw new de(s.error,"failed to get confirmed transaction");return s.result}async getParsedConfirmedTransactions(e,t){const n=e.map(o=>{const a=this._buildArgsAtLeastConfirmed([o],t,"jsonParsed");return{methodName:"getConfirmedTransaction",args:a}});return(await this._rpcBatchRequest(n)).map(o=>{const a=te(o,Ba);if("error"in a)throw new de(a.error,"failed to get confirmed transactions");return a.result})}async getConfirmedSignaturesForAddress(e,t,n){let i={},s=await this.getFirstAvailableBlock();for(;!("until"in i)&&(t--,!(t<=0||t<s));)try{const c=await this.getConfirmedBlockSignatures(t,"finalized");c.signatures.length>0&&(i.until=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}let o=await this.getSlot("finalized");for(;!("before"in i)&&(n++,!(n>o));)try{const c=await this.getConfirmedBlockSignatures(n);c.signatures.length>0&&(i.before=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}return(await this.getConfirmedSignaturesForAddress2(e,i)).map(c=>c.signature)}async getConfirmedSignaturesForAddress2(e,t,n){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),s=await this._rpcRequest("getConfirmedSignaturesForAddress2",i),o=te(s,HA);if("error"in o)throw new de(o.error,"failed to get confirmed signatures for address");return o.result}async getSignaturesForAddress(e,t,n){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),s=await this._rpcRequest("getSignaturesForAddress",i),o=te(s,YA);if("error"in o)throw new de(o.error,"failed to get signatures for address");return o.result}async getAddressLookupTable(e,t){const{context:n,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=new id({key:e,state:id.deserialize(i.data)})),{context:n,value:s}}async getNonceAndContext(e,t){const{context:n,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=du.fromAccountData(i.data)),{context:n,value:s}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+n)})}async requestAirdrop(e,t){const n=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),i=te(n,E1);if("error"in i)throw new de(i.error,`airdrop to ${e.toBase58()} failed`);return i.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await mi(100);const n=Date.now()-this._blockhashInfo.lastFetch>=_g;if(this._blockhashInfo.latestBlockhash!==null&&!n)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,n=t?t.blockhash:null;for(let i=0;i<50;i++){const s=await this.getLatestBlockhash("finalized");if(n!==s.blockhash)return this._blockhashInfo={latestBlockhash:s,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},s;await mi(bg/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:n}=ut(e),i=this._buildArgs([],t,"base64",n),s=await this._rpcRequest("getStakeMinimumDelegation",i),o=te(s,kt(k()));if("error"in o)throw new de(o.error,"failed to get stake minimum delegation");return o.result}async simulateTransaction(e,t,n){if("message"in e){const p=e.serialize(),w=L.Buffer.from(p).toString("base64");if(Array.isArray(t)||n!==void 0)throw new Error("Invalid arguments");const v=t||{};v.encoding="base64","commitment"in v||(v.commitment=this.commitment);const E=[w,v],P=await this._rpcRequest("simulateTransaction",E),K=te(P,Lh);if("error"in K)throw new Error("failed to simulate transaction: "+K.error.message);return K.result}let i;if(e instanceof Je){let S=e;i=new Je,i.feePayer=S.feePayer,i.instructions=e.instructions,i.nonceInfo=S.nonceInfo,i.signatures=S.signatures}else i=Je.populate(e),i._message=i._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");const s=t;if(i.nonceInfo&&s)i.sign(...s);else{let S=this._disableBlockhashCaching;for(;;){const p=await this._blockhashWithExpiryBlockHeight(S);if(i.lastValidBlockHeight=p.lastValidBlockHeight,i.recentBlockhash=p.blockhash,!s)break;if(i.sign(...s),!i.signature)throw new Error("!signature");const w=i.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(w)&&!this._blockhashInfo.transactionSignatures.includes(w)){this._blockhashInfo.simulatedSignatures.push(w);break}else S=!0}}const o=i._compile(),a=o.serialize(),l=i._serialize(a).toString("base64"),u={encoding:"base64",commitment:this.commitment};if(n){const S=(Array.isArray(n)?n:o.nonProgramIds()).map(p=>p.toBase58());u.accounts={encoding:"base64",addresses:S}}s&&(u.sigVerify=!0);const f=[l,u],m=await this._rpcRequest("simulateTransaction",f),y=te(m,Lh);if("error"in y){let S;if("data"in y.error&&(S=y.error.data.logs,S&&Array.isArray(S))){const p=`
    `,w=p+S.join(p);console.error(y.error.message,w)}throw new rd("failed to simulate transaction: "+y.error.message,S)}return y.result}async sendTransaction(e,t,n){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const o=e.serialize();return await this.sendRawTransaction(o,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");const i=t;if(e.nonceInfo)e.sign(...i);else{let o=this._disableBlockhashCaching;for(;;){const a=await this._blockhashWithExpiryBlockHeight(o);if(e.lastValidBlockHeight=a.lastValidBlockHeight,e.recentBlockhash=a.blockhash,e.sign(...i),!e.signature)throw new Error("!signature");const c=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(c))o=!0;else{this._blockhashInfo.transactionSignatures.push(c);break}}}const s=e.serialize();return await this.sendRawTransaction(s,n)}async sendRawTransaction(e,t){const n=Te(e).toString("base64");return await this.sendEncodedTransaction(n,t)}async sendEncodedTransaction(e,t){const n={encoding:"base64"},i=t&&t.skipPreflight,s=t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(n.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(n.minContextSlot=t.minContextSlot),i&&(n.skipPreflight=i),s&&(n.preflightCommitment=s);const o=[e,n],a=await this._rpcRequest("sendTransaction",o),c=te(a,P1);if("error"in c){let l;throw"data"in c.error&&(l=c.error.data.logs),new rd("failed to send transaction: "+c.error.message,l)}return c.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,n])=>{this._setSubscription(t,{...n,state:"pending"})})}_setSubscription(e,t){var i;const n=(i=this._subscriptionsByHash[e])==null?void 0:i.state;if(this._subscriptionsByHash[e]=t,n!==t.state){const s=this._subscriptionStateChangeCallbacksByHash[e];s&&s.forEach(o=>{try{o(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){const n=this._subscriptionHashByClientSubscriptionId[e];if(n==null)return()=>{};const i=this._subscriptionStateChangeCallbacksByHash[n]||=new Set;return i.add(t),()=>{i.delete(t),i.size===0&&delete this._subscriptionStateChangeCallbacksByHash[n]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(n){n instanceof Error&&console.log(`Error when closing socket connection: ${n.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async n=>{const i=this._subscriptionsByHash[n];if(i!==void 0)switch(i.state){case"pending":case"unsubscribed":if(i.callbacks.size===0){delete this._subscriptionsByHash[n],i.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[i.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:s,method:o}=i;try{this._setSubscription(n,{...i,state:"subscribing"});const a=await this._rpcWebSocket.call(o,s);this._setSubscription(n,{...i,serverSubscriptionId:a,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[a]=i.callbacks,await this._updateSubscriptions()}catch(a){if(a instanceof Error&&console.error(`${o} error for argument`,s,a.message),!t())return;this._setSubscription(n,{...i,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":i.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:s,unsubscribeMethod:o}=i;if(this._subscriptionsAutoDisposedByRpc.has(s))this._subscriptionsAutoDisposedByRpc.delete(s);else{this._setSubscription(n,{...i,state:"unsubscribing"}),this._setSubscription(n,{...i,state:"unsubscribing"});try{await this._rpcWebSocket.call(o,[s])}catch(a){if(a instanceof Error&&console.error(`${o} error:`,a.message),!t())return;this._setSubscription(n,{...i,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(n,{...i,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){const n=this._subscriptionCallbacksByServerSubscriptionId[e];n!==void 0&&n.forEach(i=>{try{i(...t)}catch(s){console.error(s)}})}_wsOnAccountNotification(e){const{result:t,subscription:n}=te(e,JA);this._handleServerNotification(n,[t.value,t.context])}_makeSubscription(e,t){const n=this._nextClientSubscriptionId++,i=Ch([e.method,t],!0),s=this._subscriptionsByHash[i];return s===void 0?this._subscriptionsByHash[i]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:s.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[n]=i,this._subscriptionDisposeFunctionsByClientSubscriptionId[n]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[n],delete this._subscriptionHashByClientSubscriptionId[n];const o=this._subscriptionsByHash[i];Ve(o!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${n}`),o.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),n}onAccountChange(e,t,n){const i=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64");return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},i)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:n}=te(e,XA);this._handleServerNotification(n,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,n,i){const s=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64",i?{filters:i}:void 0);return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},s)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,n){const i=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],n||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},i)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:n}=te(e,T1);this._handleServerNotification(n,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:n}=te(e,e1);this._handleServerNotification(n,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:n}=te(e,n1);this._handleServerNotification(n,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const n=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];n?await n():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,n,i){const s=t||this._commitment;if(s||n||i){let o={};n&&(o.encoding=n),s&&(o.commitment=s),i&&(o=Object.assign(o,i)),e.push(o)}return e}_buildArgsAtLeastConfirmed(e,t,n,i){const s=t||this._commitment;if(s&&!["confirmed","finalized"].includes(s))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,n,i)}_wsOnSignatureNotification(e){const{result:t,subscription:n}=te(e,r1);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(n),this._handleServerNotification(n,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,n){const i=this._buildArgs([e],n||this._commitment||"finalized"),s=this._makeSubscription({callback:(o,a)=>{if(o.type==="status"){t(o.result,a);try{this.removeSignatureListener(s)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},i);return s}onSignatureWithOptions(e,t,n){const{commitment:i,...s}={...n,commitment:n&&n.commitment||this._commitment||"finalized"},o=this._buildArgs([e],i,void 0,s),a=this._makeSubscription({callback:(c,l)=>{t(c,l);try{this.removeSignatureListener(a)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return a}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:n}=te(e,i1);this._handleServerNotification(n,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class _s{constructor(e){this._keypair=void 0,this._keypair=e??Oh()}static generate(){return new _s(Oh())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const n=e.slice(32,64);if(!t||!t.skipValidation){const i=e.slice(0,32),s=pc(i);for(let o=0;o<32;o++)if(n[o]!==s[o])throw new Error("provided secretKey is invalid")}return new _s({publicKey:n,secretKey:e})}static fromSeed(e){const t=pc(e),n=new Uint8Array(64);return n.set(e),n.set(t,32),new _s({publicKey:t,secretKey:n})}get publicKey(){return new re(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}const Or=Object.freeze({CreateLookupTable:{index:0,layout:C([M("instruction"),Ms("recentSlot"),ee("bumpSeed")])},FreezeLookupTable:{index:1,layout:C([M("instruction")])},ExtendLookupTable:{index:2,layout:C([M("instruction"),Ms(),Ie(Ce(),Pt(M(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:C([M("instruction")])},CloseLookupTable:{index:4,layout:C([M("instruction")])}});class x1{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Or))if(o.index==n){i=s;break}if(!i)throw new Error("Invalid Instruction. Should be a LookupTable Instruction");return i}static decodeCreateLookupTable(e){this.checkProgramId(e.programId),this.checkKeysLength(e.keys,4);const{recentSlot:t}=Ye(Or.CreateLookupTable,e.data);return{authority:e.keys[1].pubkey,payer:e.keys[2].pubkey,recentSlot:Number(t)}}static decodeExtendLookupTable(e){if(this.checkProgramId(e.programId),e.keys.length<2)throw new Error(`invalid instruction; found ${e.keys.length} keys, expected at least 2`);const{addresses:t}=Ye(Or.ExtendLookupTable,e.data);return{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,payer:e.keys.length>2?e.keys[2].pubkey:void 0,addresses:t.map(n=>new re(n))}}static decodeCloseLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,3),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,recipient:e.keys[2].pubkey}}static decodeFreezeLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static decodeDeactivateLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(mf.programId))throw new Error("invalid instruction; programId is not AddressLookupTable Program")}static checkKeysLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}class mf{constructor(){}static createLookupTable(e){const[t,n]=re.findProgramAddressSync([e.authority.toBuffer(),ta(BigInt(e.recentSlot),8)],this.programId),i=Or.CreateLookupTable,s=Ke(i,{recentSlot:BigInt(e.recentSlot),bumpSeed:n}),o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:qt.programId,isSigner:!1,isWritable:!1}];return[new rt({programId:this.programId,keys:o,data:s}),t]}static freezeLookupTable(e){const t=Or.FreezeLookupTable,n=Ke(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new rt({programId:this.programId,keys:i,data:n})}static extendLookupTable(e){const t=Or.ExtendLookupTable,n=Ke(t,{addresses:e.addresses.map(s=>s.toBytes())}),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return e.payer&&i.push({pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:qt.programId,isSigner:!1,isWritable:!1}),new rt({programId:this.programId,keys:i,data:n})}static deactivateLookupTable(e){const t=Or.DeactivateLookupTable,n=Ke(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new rt({programId:this.programId,keys:i,data:n})}static closeLookupTable(e){const t=Or.CloseLookupTable,n=Ke(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.recipient,isSigner:!1,isWritable:!0}];return new rt({programId:this.programId,keys:i,data:n})}}mf.programId=new re("AddressLookupTab1e1111111111111111111111111");class C1{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=ee("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(fr))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a ComputeBudgetInstruction");return i}static decodeRequestUnits(e){this.checkProgramId(e.programId);const{units:t,additionalFee:n}=Ye(fr.RequestUnits,e.data);return{units:t,additionalFee:n}}static decodeRequestHeapFrame(e){this.checkProgramId(e.programId);const{bytes:t}=Ye(fr.RequestHeapFrame,e.data);return{bytes:t}}static decodeSetComputeUnitLimit(e){this.checkProgramId(e.programId);const{units:t}=Ye(fr.SetComputeUnitLimit,e.data);return{units:t}}static decodeSetComputeUnitPrice(e){this.checkProgramId(e.programId);const{microLamports:t}=Ye(fr.SetComputeUnitPrice,e.data);return{microLamports:t}}static checkProgramId(e){if(!e.equals(bf.programId))throw new Error("invalid instruction; programId is not ComputeBudgetProgram")}}const fr=Object.freeze({RequestUnits:{index:0,layout:C([ee("instruction"),M("units"),M("additionalFee")])},RequestHeapFrame:{index:1,layout:C([ee("instruction"),M("bytes")])},SetComputeUnitLimit:{index:2,layout:C([ee("instruction"),M("units")])},SetComputeUnitPrice:{index:3,layout:C([ee("instruction"),Ms("microLamports")])}});class bf{constructor(){}static requestUnits(e){const t=fr.RequestUnits,n=Ke(t,e);return new rt({keys:[],programId:this.programId,data:n})}static requestHeapFrame(e){const t=fr.RequestHeapFrame,n=Ke(t,e);return new rt({keys:[],programId:this.programId,data:n})}static setComputeUnitLimit(e){const t=fr.SetComputeUnitLimit,n=Ke(t,e);return new rt({keys:[],programId:this.programId,data:n})}static setComputeUnitPrice(e){const t=fr.SetComputeUnitPrice,n=Ke(t,{microLamports:BigInt(e.microLamports)});return new rt({keys:[],programId:this.programId,data:n})}}bf.programId=new re("ComputeBudget111111111111111111111111111111");const Dh=64,$h=32,zh=64,Wh=C([ee("numSignatures"),ee("padding"),De("signatureOffset"),De("signatureInstructionIndex"),De("publicKeyOffset"),De("publicKeyInstructionIndex"),De("messageDataOffset"),De("messageDataSize"),De("messageInstructionIndex")]);class pu{constructor(){}static createInstructionWithPublicKey(e){const{publicKey:t,message:n,signature:i,instructionIndex:s}=e;Ve(t.length===$h,`Public Key must be ${$h} bytes but received ${t.length} bytes`),Ve(i.length===zh,`Signature must be ${zh} bytes but received ${i.length} bytes`);const o=Wh.span,a=o+t.length,c=a+i.length,l=1,u=L.Buffer.alloc(c+n.length),f=s??65535;return Wh.encode({numSignatures:l,padding:0,signatureOffset:a,signatureInstructionIndex:f,publicKeyOffset:o,publicKeyInstructionIndex:f,messageDataOffset:c,messageDataSize:n.length,messageInstructionIndex:f},u),u.fill(t,o),u.fill(i,a),u.fill(n,c),new rt({keys:[],programId:pu.programId,data:u})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:n,instructionIndex:i}=e;Ve(t.length===Dh,`Private key must be ${Dh} bytes but received ${t.length} bytes`);try{const s=_s.fromSecretKey(t),o=s.publicKey.toBytes(),a=af(n,s.secretKey);return this.createInstructionWithPublicKey({publicKey:o,message:n,signature:a,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}pu.programId=new re("Ed25519SigVerify111111111111111111111111111");const M1=(r,e)=>{const t=si.sign(r,e);return[t.toCompactRawBytes(),t.recovery]};si.utils.isValidPrivateKey;const L1=si.getPublicKey,Vh=32,vl=20,Uh=64,K1=11,_l=C([ee("numSignatures"),De("signatureOffset"),ee("signatureInstructionIndex"),De("ethAddressOffset"),ee("ethAddressInstructionIndex"),De("messageDataOffset"),De("messageDataSize"),ee("messageInstructionIndex"),he(20,"ethAddress"),he(64,"signature"),ee("recoveryId")]);class As{constructor(){}static publicKeyToEthAddress(e){Ve(e.length===Uh,`Public key must be ${Uh} bytes but received ${e.length} bytes`);try{return L.Buffer.from(cc(Te(e))).slice(-vl)}catch(t){throw new Error(`Error constructing Ethereum address: ${t}`)}}static createInstructionWithPublicKey(e){const{publicKey:t,message:n,signature:i,recoveryId:s,instructionIndex:o}=e;return As.createInstructionWithEthAddress({ethAddress:As.publicKeyToEthAddress(t),message:n,signature:i,recoveryId:s,instructionIndex:o})}static createInstructionWithEthAddress(e){const{ethAddress:t,message:n,signature:i,recoveryId:s,instructionIndex:o=0}=e;let a;typeof t=="string"?t.startsWith("0x")?a=L.Buffer.from(t.substr(2),"hex"):a=L.Buffer.from(t,"hex"):a=t,Ve(a.length===vl,`Address must be ${vl} bytes but received ${a.length} bytes`);const c=1+K1,l=c,u=c+a.length,f=u+i.length+1,m=1,y=L.Buffer.alloc(_l.span+n.length);return _l.encode({numSignatures:m,signatureOffset:u,signatureInstructionIndex:o,ethAddressOffset:l,ethAddressInstructionIndex:o,messageDataOffset:f,messageDataSize:n.length,messageInstructionIndex:o,signature:Te(i),ethAddress:Te(a),recoveryId:s},y),y.fill(Te(n),_l.span),new rt({keys:[],programId:As.programId,data:y})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:n,instructionIndex:i}=e;Ve(t.length===Vh,`Private key must be ${Vh} bytes but received ${t.length} bytes`);try{const s=Te(t),o=L1(s,!1).slice(1),a=L.Buffer.from(cc(Te(n))),[c,l]=M1(a,s);return this.createInstructionWithPublicKey({publicKey:o,message:n,signature:c,recoveryId:l,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}As.programId=new re("KeccakSecp256k11111111111111111111111111111");var Cg;const Mg=new re("StakeConfig11111111111111111111111111111111");class Lg{constructor(e,t){this.staker=void 0,this.withdrawer=void 0,this.staker=e,this.withdrawer=t}}class la{constructor(e,t,n){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=n}}Cg=la;la.default=new Cg(0,0,re.default);class N1{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Wt))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a StakeInstruction");return i}static decodeInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t,lockup:n}=Ye(Wt.Initialize,e.data);return{stakePubkey:e.keys[0].pubkey,authorized:new Lg(new re(t.staker),new re(t.withdrawer)),lockup:new la(n.unixTimestamp,n.epoch,new re(n.custodian))}}static decodeDelegate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,6),Ye(Wt.Delegate,e.data),{stakePubkey:e.keys[0].pubkey,votePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[5].pubkey}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,stakeAuthorizationType:n}=Ye(Wt.Authorize,e.data),i={stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new re(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(i.custodianPubkey=e.keys[3].pubkey),i}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{newAuthorized:t,stakeAuthorizationType:n,authoritySeed:i,authorityOwner:s}=Ye(Wt.AuthorizeWithSeed,e.data),o={stakePubkey:e.keys[0].pubkey,authorityBase:e.keys[1].pubkey,authoritySeed:i,authorityOwner:new re(s),newAuthorizedPubkey:new re(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(o.custodianPubkey=e.keys[3].pubkey),o}static decodeSplit(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Ye(Wt.Split,e.data);return{stakePubkey:e.keys[0].pubkey,splitStakePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[2].pubkey,lamports:t}}static decodeMerge(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Ye(Wt.Merge,e.data),{stakePubkey:e.keys[0].pubkey,sourceStakePubKey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Ye(Wt.Withdraw,e.data),n={stakePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t};return e.keys.length>5&&(n.custodianPubkey=e.keys[5].pubkey),n}static decodeDeactivate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Ye(Wt.Deactivate,e.data),{stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static checkProgramId(e){if(!e.equals(yu.programId))throw new Error("invalid instruction; programId is not StakeProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const Wt=Object.freeze({Initialize:{index:0,layout:C([M("instruction"),$_(),z_()])},Authorize:{index:1,layout:C([M("instruction"),Ce("newAuthorized"),M("stakeAuthorizationType")])},Delegate:{index:2,layout:C([M("instruction")])},Split:{index:3,layout:C([M("instruction"),Me("lamports")])},Withdraw:{index:4,layout:C([M("instruction"),Me("lamports")])},Deactivate:{index:5,layout:C([M("instruction")])},Merge:{index:7,layout:C([M("instruction")])},AuthorizeWithSeed:{index:8,layout:C([M("instruction"),Ce("newAuthorized"),M("stakeAuthorizationType"),Si("authoritySeed"),Ce("authorityOwner")])}}),D1=Object.freeze({Staker:{index:0},Withdrawer:{index:1}});class yu{constructor(){}static initialize(e){const{stakePubkey:t,authorized:n,lockup:i}=e,s=i||la.default,o=Wt.Initialize,a=Ke(o,{authorized:{staker:Te(n.staker.toBuffer()),withdrawer:Te(n.withdrawer.toBuffer())},lockup:{unixTimestamp:s.unixTimestamp,epoch:s.epoch,custodian:Te(s.custodian.toBuffer())}}),c={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Cs,isSigner:!1,isWritable:!1}],programId:this.programId,data:a};return new rt(c)}static createAccountWithSeed(e){const t=new Je;t.add(qt.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:n,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:n,authorized:i,lockup:s}))}static createAccount(e){const t=new Je;t.add(qt.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:n,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:n,authorized:i,lockup:s}))}static delegate(e){const{stakePubkey:t,authorizedPubkey:n,votePubkey:i}=e,s=Wt.Delegate,o=Ke(s);return new Je().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:ur,isSigner:!1,isWritable:!1},{pubkey:tc,isSigner:!1,isWritable:!1},{pubkey:Mg,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static authorize(e){const{stakePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:i,stakeAuthorizationType:s,custodianPubkey:o}=e,a=Wt.Authorize,c=Ke(a,{newAuthorized:Te(i.toBuffer()),stakeAuthorizationType:s.index}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:ur,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return o&&l.push({pubkey:o,isSigner:!1,isWritable:!1}),new Je().add({keys:l,programId:this.programId,data:c})}static authorizeWithSeed(e){const{stakePubkey:t,authorityBase:n,authoritySeed:i,authorityOwner:s,newAuthorizedPubkey:o,stakeAuthorizationType:a,custodianPubkey:c}=e,l=Wt.AuthorizeWithSeed,u=Ke(l,{newAuthorized:Te(o.toBuffer()),stakeAuthorizationType:a.index,authoritySeed:i,authorityOwner:Te(s.toBuffer())}),f=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:ur,isSigner:!1,isWritable:!1}];return c&&f.push({pubkey:c,isSigner:!1,isWritable:!1}),new Je().add({keys:f,programId:this.programId,data:u})}static splitInstruction(e){const{stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,lamports:s}=e,o=Wt.Split,a=Ke(o,{lamports:s});return new rt({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:a})}static split(e){const t=new Je;return t.add(qt.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:0,space:this.space,programId:this.programId})),t.add(this.splitInstruction(e))}static splitWithSeed(e){const{stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,basePubkey:s,seed:o,lamports:a}=e,c=new Je;return c.add(qt.allocate({accountPubkey:i,basePubkey:s,seed:o,space:this.space,programId:this.programId})),c.add(this.splitInstruction({stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,lamports:a}))}static merge(e){const{stakePubkey:t,sourceStakePubKey:n,authorizedPubkey:i}=e,s=Wt.Merge,o=Ke(s);return new Je().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:ur,isSigner:!1,isWritable:!1},{pubkey:tc,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static withdraw(e){const{stakePubkey:t,authorizedPubkey:n,toPubkey:i,lamports:s,custodianPubkey:o}=e,a=Wt.Withdraw,c=Ke(a,{lamports:s}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:ur,isSigner:!1,isWritable:!1},{pubkey:tc,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return o&&l.push({pubkey:o,isSigner:!1,isWritable:!1}),new Je().add({keys:l,programId:this.programId,data:c})}static deactivate(e){const{stakePubkey:t,authorizedPubkey:n}=e,i=Wt.Deactivate,s=Ke(i);return new Je().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:ur,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:s})}}yu.programId=new re("Stake11111111111111111111111111111111111111");yu.space=200;class Kg{constructor(e,t,n,i){this.nodePubkey=void 0,this.authorizedVoter=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.nodePubkey=e,this.authorizedVoter=t,this.authorizedWithdrawer=n,this.commission=i}}class $1{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=M("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Br))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a VoteInstruction");return i}static decodeInitializeAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,4);const{voteInit:t}=Ye(Br.InitializeAccount,e.data);return{votePubkey:e.keys[0].pubkey,nodePubkey:e.keys[3].pubkey,voteInit:new Kg(new re(t.nodePubkey),new re(t.authorizedVoter),new re(t.authorizedWithdrawer),t.commission)}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,voteAuthorizationType:n}=Ye(Br.Authorize,e.data);return{votePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new re(t),voteAuthorizationType:{index:n}}}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:t,currentAuthorityDerivedKeySeed:n,newAuthorized:i,voteAuthorizationType:s}}=Ye(Br.AuthorizeWithSeed,e.data);return{currentAuthorityDerivedKeyBasePubkey:e.keys[2].pubkey,currentAuthorityDerivedKeyOwnerPubkey:new re(t),currentAuthorityDerivedKeySeed:n,newAuthorizedPubkey:new re(i),voteAuthorizationType:{index:s},votePubkey:e.keys[0].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Ye(Br.Withdraw,e.data);return{votePubkey:e.keys[0].pubkey,authorizedWithdrawerPubkey:e.keys[2].pubkey,lamports:t,toPubkey:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(to.programId))throw new Error("invalid instruction; programId is not VoteProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const Br=Object.freeze({InitializeAccount:{index:0,layout:C([M("instruction"),W_()])},Authorize:{index:1,layout:C([M("instruction"),Ce("newAuthorized"),M("voteAuthorizationType")])},Withdraw:{index:3,layout:C([M("instruction"),Me("lamports")])},AuthorizeWithSeed:{index:10,layout:C([M("instruction"),V_()])}}),z1=Object.freeze({Voter:{index:0},Withdrawer:{index:1}});class to{constructor(){}static initializeAccount(e){const{votePubkey:t,nodePubkey:n,voteInit:i}=e,s=Br.InitializeAccount,o=Ke(s,{voteInit:{nodePubkey:Te(i.nodePubkey.toBuffer()),authorizedVoter:Te(i.authorizedVoter.toBuffer()),authorizedWithdrawer:Te(i.authorizedWithdrawer.toBuffer()),commission:i.commission}}),a={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Cs,isSigner:!1,isWritable:!1},{pubkey:ur,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:o};return new rt(a)}static createAccount(e){const t=new Je;return t.add(qt.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}static authorize(e){const{votePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:i,voteAuthorizationType:s}=e,o=Br.Authorize,a=Ke(o,{newAuthorized:Te(i.toBuffer()),voteAuthorizationType:s.index}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:ur,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return new Je().add({keys:c,programId:this.programId,data:a})}static authorizeWithSeed(e){const{currentAuthorityDerivedKeyBasePubkey:t,currentAuthorityDerivedKeyOwnerPubkey:n,currentAuthorityDerivedKeySeed:i,newAuthorizedPubkey:s,voteAuthorizationType:o,votePubkey:a}=e,c=Br.AuthorizeWithSeed,l=Ke(c,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:Te(n.toBuffer()),currentAuthorityDerivedKeySeed:i,newAuthorized:Te(s.toBuffer()),voteAuthorizationType:o.index}}),u=[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:ur,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return new Je().add({keys:u,programId:this.programId,data:l})}static withdraw(e){const{votePubkey:t,authorizedWithdrawerPubkey:n,lamports:i,toPubkey:s}=e,o=Br.Withdraw,a=Ke(o,{lamports:i}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return new Je().add({keys:c,programId:this.programId,data:a})}static safeWithdraw(e,t,n){if(e.lamports>t-n)throw new Error("Withdraw will leave vote account with insuffcient funds.");return to.withdraw(e)}}to.programId=new re("Vote111111111111111111111111111111111111111");to.space=3731;const Ng=new re("Va1idator1nfo111111111111111111111111111111"),W1=O({name:N(),website:X(N()),details:X(N()),keybaseUsername:X(N())});class wf{constructor(e,t){this.key=void 0,this.info=void 0,this.key=e,this.info=t}static fromConfigData(e){let t=[...e];if(pn(t)!==2)return null;const i=[];for(let s=0;s<2;s++){const o=new re(t.slice(0,Bn));t=t.slice(Bn);const a=t.slice(0,1)[0]===1;t=t.slice(1),i.push({publicKey:o,isSigner:a})}if(i[0].publicKey.equals(Ng)&&i[1].isSigner){const s=Si().decode(L.Buffer.from(t)),o=JSON.parse(s);return ug(o,W1),new wf(i[1].publicKey,o)}return null}}const V1=new re("Vote111111111111111111111111111111111111111"),U1=C([Ce("nodePubkey"),Ce("authorizedWithdrawer"),ee("commission"),we(),Ie(C([we("slot"),M("confirmationCount")]),Pt(M(),-8),"votes"),ee("rootSlotValid"),we("rootSlot"),we(),Ie(C([we("epoch"),Ce("authorizedVoter")]),Pt(M(),-8),"authorizedVoters"),C([Ie(C([Ce("authorizedPubkey"),we("epochOfLastAuthorizedSwitch"),we("targetEpoch")]),32,"buf"),we("idx"),ee("isEmpty")],"priorVoters"),we(),Ie(C([we("epoch"),we("credits"),we("prevCredits")]),Pt(M(),-8),"epochCredits"),C([we("slot"),we("timestamp")],"lastTimestamp")]);class kf{constructor(e){this.nodePubkey=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.rootSlot=void 0,this.votes=void 0,this.authorizedVoters=void 0,this.priorVoters=void 0,this.epochCredits=void 0,this.lastTimestamp=void 0,this.nodePubkey=e.nodePubkey,this.authorizedWithdrawer=e.authorizedWithdrawer,this.commission=e.commission,this.rootSlot=e.rootSlot,this.votes=e.votes,this.authorizedVoters=e.authorizedVoters,this.priorVoters=e.priorVoters,this.epochCredits=e.epochCredits,this.lastTimestamp=e.lastTimestamp}static fromAccountData(e){const n=U1.decode(Te(e),4);let i=n.rootSlot;return n.rootSlotValid||(i=null),new kf({nodePubkey:new re(n.nodePubkey),authorizedWithdrawer:new re(n.authorizedWithdrawer),commission:n.commission,votes:n.votes,rootSlot:i,authorizedVoters:n.authorizedVoters.map(F1),priorVoters:j1(n.priorVoters),epochCredits:n.epochCredits,lastTimestamp:n.lastTimestamp})}}function F1({authorizedVoter:r,epoch:e}){return{epoch:e,authorizedVoter:new re(r)}}function Fh({authorizedPubkey:r,epochOfLastAuthorizedSwitch:e,targetEpoch:t}){return{authorizedPubkey:new re(r),epochOfLastAuthorizedSwitch:e,targetEpoch:t}}function j1({buf:r,idx:e,isEmpty:t}){return t?[]:[...r.slice(e+1).map(Fh),...r.slice(0,e).map(Fh)]}const jh={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function q1(r,e){const t=e===!1?"http":"https";if(!r)return jh[t].devnet;const n=jh[t][r];if(!n)throw new Error(`Unknown ${t} cluster: ${r}`);return n}async function G1(r,e,t,n){let i,s;t&&Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")||t&&Object.prototype.hasOwnProperty.call(t,"nonceValue")?(i=t,s=n):s=t;const o=s&&{skipPreflight:s.skipPreflight,preflightCommitment:s.preflightCommitment||s.commitment,minContextSlot:s.minContextSlot},a=await r.sendRawTransaction(e,o),c=s&&s.commitment,u=(await(i?r.confirmTransaction(i,c):r.confirmTransaction(a,c))).value;if(u.err)throw new Error(`Raw transaction ${a} failed (${JSON.stringify(u)})`);return a}const H1=1e9;var Y1=Object.freeze(Object.defineProperty({__proto__:null,Account:K_,AddressLookupTableAccount:id,AddressLookupTableInstruction:x1,AddressLookupTableProgram:mf,Authorized:Lg,BLOCKHASH_CACHE_TIMEOUT_MS:_g,BPF_LOADER_DEPRECATED_PROGRAM_ID:N_,BPF_LOADER_PROGRAM_ID:nA,BpfLoader:rA,COMPUTE_BUDGET_INSTRUCTION_LAYOUTS:fr,ComputeBudgetInstruction:C1,ComputeBudgetProgram:bf,Connection:B1,Ed25519Program:pu,Enum:M_,EpochSchedule:Sg,FeeCalculatorLayout:wg,Keypair:_s,LAMPORTS_PER_SOL:H1,LOOKUP_TABLE_INSTRUCTION_LAYOUTS:Or,Loader:Bi,Lockup:la,MAX_SEED_LENGTH:gg,Message:tr,MessageAccountKeys:qo,MessageV0:Oi,NONCE_ACCOUNT_LENGTH:nd,NonceAccount:du,PACKET_DATA_SIZE:Jr,PUBLIC_KEY_LENGTH:Bn,PublicKey:re,SIGNATURE_LENGTH_IN_BYTES:xs,SOLANA_SCHEMA:To,STAKE_CONFIG_ID:Mg,STAKE_INSTRUCTION_LAYOUTS:Wt,SYSTEM_INSTRUCTION_LAYOUTS:st,SYSVAR_CLOCK_PUBKEY:ur,SYSVAR_EPOCH_SCHEDULE_PUBKEY:G_,SYSVAR_INSTRUCTIONS_PUBKEY:H_,SYSVAR_RECENT_BLOCKHASHES_PUBKEY:ec,SYSVAR_RENT_PUBKEY:Cs,SYSVAR_REWARDS_PUBKEY:Y_,SYSVAR_SLOT_HASHES_PUBKEY:J_,SYSVAR_SLOT_HISTORY_PUBKEY:Q_,SYSVAR_STAKE_HISTORY_PUBKEY:tc,Secp256k1Program:As,SendTransactionError:rd,SolanaJSONRPCError:de,SolanaJSONRPCErrorCode:uA,StakeAuthorizationLayout:D1,StakeInstruction:N1,StakeProgram:yu,Struct:cf,SystemInstruction:eA,SystemProgram:qt,Transaction:Je,TransactionExpiredBlockheightExceededError:uf,TransactionExpiredNonceInvalidError:fs,TransactionExpiredTimeoutError:lf,TransactionInstruction:rt,TransactionMessage:ff,TransactionStatus:Er,VALIDATOR_INFO_KEY:Ng,VERSION_PREFIX_MASK:uu,VOTE_PROGRAM_ID:V1,ValidatorInfo:wf,VersionedMessage:df,VersionedTransaction:hf,VoteAccount:kf,VoteAuthorizationLayout:z1,VoteInit:Kg,VoteInstruction:$1,VoteProgram:to,clusterApiUrl:q1,sendAndConfirmRawTransaction:G1,sendAndConfirmTransaction:td},Symbol.toStringTag,{value:"Module"})),Lr=Hs(Y1);const qh=()=>{const r=Gt.utils.randomPrivateKey(),e=cd(r),t=new Uint8Array(64);return t.set(r),t.set(e,32),{publicKey:e,secretKey:t}},cd=Gt.getPublicKey;function Gh(r){try{return Gt.ExtendedPoint.fromHex(r),!0}catch{return!1}}const J1=(r,e)=>Gt.sign(r,e.slice(0,32)),Q1=Gt.verify,fn=r=>L.Buffer.isBuffer(r)?r:r instanceof Uint8Array?L.Buffer.from(r.buffer,r.byteOffset,r.byteLength):L.Buffer.from(r);class X1{constructor(e){Object.assign(this,e)}encode(){return L.Buffer.from(Rd(nc,this))}static decode(e){return Td(nc,this,e)}static decodeUnchecked(e){return Od(nc,this,e)}}const nc=new Map;var Dg;let $g;const Z1=32,vi=32;function e0(r){return r._bn!==void 0}let Hh=1;$g=Symbol.toStringTag;class ue extends X1{constructor(e){if(super({}),this._bn=void 0,e0(e))this._bn=e._bn;else{if(typeof e=="string"){const t=pe.decode(e);if(t.length!=vi)throw new Error("Invalid public key input");this._bn=new Qn(t)}else this._bn=new Qn(e);if(this._bn.byteLength()>vi)throw new Error("Invalid public key input")}}static unique(){const e=new ue(Hh);return Hh+=1,new ue(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return pe.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(L.Buffer);if(e.length===vi)return e;const t=L.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[$g](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,n){const i=L.Buffer.concat([e.toBuffer(),L.Buffer.from(t),n.toBuffer()]),s=Ps(i);return new ue(s)}static createProgramAddressSync(e,t){let n=L.Buffer.alloc(0);e.forEach(function(s){if(s.length>Z1)throw new TypeError("Max seed length exceeded");n=L.Buffer.concat([n,fn(s)])}),n=L.Buffer.concat([n,t.toBuffer(),L.Buffer.from("ProgramDerivedAddress")]);const i=Ps(n);if(Gh(i))throw new Error("Invalid seeds, address must fall off the curve");return new ue(i)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let n=255,i;for(;n!=0;){try{const s=e.concat(L.Buffer.from([n]));i=this.createProgramAddressSync(s,t)}catch(s){if(s instanceof TypeError)throw s;n--;continue}return[i,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new ue(e);return Gh(t.toBytes())}}Dg=ue;ue.default=new Dg("11111111111111111111111111111111");nc.set(ue,{kind:"struct",fields:[["_bn","u256"]]});new ue("BPFLoader1111111111111111111111111111111111");const ud=1280-40-8,t0=127,ld=64;class Yh{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const n=new Map;this.keySegments().flat().forEach((s,o)=>{n.set(s.toBase58(),o)});const i=s=>{const o=n.get(s.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(s=>({programIdIndex:i(s.programId),accountKeyIndexes:s.keys.map(o=>i(o.pubkey)),data:s.data}))}}const Ne=(r="publicKey")=>he(32,r),hs=(r="string")=>{const e=C([M("length"),M("lengthPadding"),he(Pt(M(),-8),"chars")],r),t=e.decode.bind(e),n=e.encode.bind(e),i=e;return i.decode=(s,o)=>t(s,o).chars.toString(),i.encode=(s,o,a)=>{const c={chars:L.Buffer.from(s,"utf8")};return n(c,o,a)},i.alloc=s=>M().span+M().span+L.Buffer.from(s,"utf8").length,i},n0=(r="authorized")=>C([Ne("staker"),Ne("withdrawer")],r),r0=(r="lockup")=>C([Me("unixTimestamp"),Me("epoch"),Ne("custodian")],r),i0=(r="voteInit")=>C([Ne("nodePubkey"),Ne("authorizedVoter"),Ne("authorizedWithdrawer"),ee("commission")],r),s0=(r="voteAuthorizeWithSeedArgs")=>C([M("voteAuthorizationType"),Ne("currentAuthorityDerivedKeyOwnerPubkey"),hs("currentAuthorityDerivedKeySeed"),Ne("newAuthorized")],r);function zg(r,e){const t=i=>{if(i.span>=0)return i.span;if(typeof i.alloc=="function")return i.alloc(e[i.property]);if("count"in i&&"elementLayout"in i){const s=e[i.property];if(Array.isArray(s))return s.length*t(i.elementLayout)}else if("fields"in i)return zg({layout:i},e[i.property]);return 0};let n=0;return r.layout.fields.forEach(i=>{n+=t(i)}),n}function vo(r){let e=0,t=0;for(;;){let n=r.shift();if(e|=(n&127)<<t*7,t+=1,(n&128)===0)break}return e}function _o(r,e){let t=e;for(;;){let n=t&127;if(t>>=7,t==0){r.push(n);break}else n|=128,r.push(n)}}function In(r,e){if(!r)throw new Error(e||"Assertion failed")}class Sf{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const n=new Map,i=o=>{const a=o.toBase58();let c=n.get(a);return c===void 0&&(c={isSigner:!1,isWritable:!1,isInvoked:!1},n.set(a,c)),c},s=i(t);s.isSigner=!0,s.isWritable=!0;for(const o of e){i(o.programId).isInvoked=!0;for(const a of o.keys){const c=i(a.pubkey);c.isSigner||=a.isSigner,c.isWritable||=a.isWritable}}return new Sf(t,n)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];In(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,c])=>c.isSigner&&c.isWritable),n=e.filter(([,c])=>c.isSigner&&!c.isWritable),i=e.filter(([,c])=>!c.isSigner&&c.isWritable),s=e.filter(([,c])=>!c.isSigner&&!c.isWritable),o={numRequiredSignatures:t.length+n.length,numReadonlySignedAccounts:n.length,numReadonlyUnsignedAccounts:s.length};{In(t.length>0,"Expected at least one writable signer key");const[c]=t[0];In(c===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...t.map(([c])=>new ue(c)),...n.map(([c])=>new ue(c)),...i.map(([c])=>new ue(c)),...s.map(([c])=>new ue(c))];return[o,a]}extractTableLookup(e){const[t,n]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[i,s]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&i.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:i},{writable:n,readonly:s}]}drainKeysFoundInLookupTable(e,t){const n=new Array,i=new Array;for(const[s,o]of this.keyMetaMap.entries())if(t(o)){const a=new ue(s),c=e.findIndex(l=>l.equals(a));c>=0&&(In(c<256,"Max lookup table index exceeded"),n.push(c),i.push(a),this.keyMetaMap.delete(s))}return[n,i]}}class Ho{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new ue(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:pe.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new Yh(this.staticAccountKeys)}static compile(e){const t=Sf.compile(e.instructions,e.payerKey),[n,i]=t.getMessageComponents(),o=new Yh(i).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:pe.encode(a.data)}));return new Ho({header:n,accountKeys:i,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const n=e-t,s=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return n<s}else{const n=t-this.header.numReadonlySignedAccounts;return e<n}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];_o(t,e);const n=this.instructions.map(f=>{const{accounts:m,programIdIndex:y}=f,S=Array.from(pe.decode(f.data));let p=[];_o(p,m.length);let w=[];return _o(w,S.length),{programIdIndex:y,keyIndicesCount:L.Buffer.from(p),keyIndices:m,dataLength:L.Buffer.from(w),data:S}});let i=[];_o(i,n.length);let s=L.Buffer.alloc(ud);L.Buffer.from(i).copy(s);let o=i.length;n.forEach(f=>{o+=C([ee("programIdIndex"),he(f.keyIndicesCount.length,"keyIndicesCount"),Ie(ee("keyIndex"),f.keyIndices.length,"keyIndices"),he(f.dataLength.length,"dataLength"),Ie(ee("userdatum"),f.data.length,"data")]).encode(f,s,o)}),s=s.slice(0,o);const a=C([he(1,"numRequiredSignatures"),he(1,"numReadonlySignedAccounts"),he(1,"numReadonlyUnsignedAccounts"),he(t.length,"keyCount"),Ie(Ne("key"),e,"keys"),Ne("recentBlockhash")]),c={numRequiredSignatures:L.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:L.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:L.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:L.Buffer.from(t),keys:this.accountKeys.map(f=>fn(f.toBytes())),recentBlockhash:pe.decode(this.recentBlockhash)};let l=L.Buffer.alloc(2048);const u=a.encode(c,l);return s.copy(l,u),l.slice(0,u+s.length)}static from(e){let t=[...e];const n=t.shift();if(n!==(n&t0))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const i=t.shift(),s=t.shift(),o=vo(t);let a=[];for(let m=0;m<o;m++){const y=t.slice(0,vi);t=t.slice(vi),a.push(new ue(L.Buffer.from(y)))}const c=t.slice(0,vi);t=t.slice(vi);const l=vo(t);let u=[];for(let m=0;m<l;m++){const y=t.shift(),S=vo(t),p=t.slice(0,S);t=t.slice(S);const w=vo(t),v=t.slice(0,w),E=pe.encode(L.Buffer.from(v));t=t.slice(w),u.push({programIdIndex:y,accounts:p,data:E})}const f={header:{numRequiredSignatures:n,numReadonlySignedAccounts:i,numReadonlyUnsignedAccounts:s},recentBlockhash:pe.encode(L.Buffer.from(c)),accountKeys:a,instructions:u};return new Ho(f)}}const o0=L.Buffer.alloc(ld).fill(0);class Xe{constructor(e){this.keys=void 0,this.programId=void 0,this.data=L.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:n})=>({pubkey:e.toJSON(),isSigner:t,isWritable:n})),programId:this.programId.toJSON(),data:[...this.data]}}}class yt{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:n}=e;this.minNonceContextSlot=t,this.nonceInfo=n}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:n}=e;this.recentBlockhash=t,this.lastValidBlockHeight=n}else{const{recentBlockhash:t,nonceInfo:n}=e;n&&(this.nonceInfo=n),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new Xe(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let n;if(this.feePayer)n=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)n=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let p=0;p<t.length;p++)if(t[p].programId===void 0)throw new Error(`Transaction instruction index ${p} has undefined program id`);const i=[],s=[];t.forEach(p=>{p.keys.forEach(v=>{s.push({...v})});const w=p.programId.toString();i.includes(w)||i.push(w)}),i.forEach(p=>{s.push({pubkey:new ue(p),isSigner:!1,isWritable:!1})});const o=[];s.forEach(p=>{const w=p.pubkey.toString(),v=o.findIndex(E=>E.pubkey.toString()===w);v>-1?(o[v].isWritable=o[v].isWritable||p.isWritable,o[v].isSigner=o[v].isSigner||p.isSigner):o.push(p)}),o.sort(function(p,w){if(p.isSigner!==w.isSigner)return p.isSigner?-1:1;if(p.isWritable!==w.isWritable)return p.isWritable?-1:1;const v={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return p.pubkey.toBase58().localeCompare(w.pubkey.toBase58(),"en",v)});const a=o.findIndex(p=>p.pubkey.equals(n));if(a>-1){const[p]=o.splice(a,1);p.isSigner=!0,p.isWritable=!0,o.unshift(p)}else o.unshift({pubkey:n,isSigner:!0,isWritable:!0});for(const p of this.signatures){const w=o.findIndex(v=>v.pubkey.equals(p.publicKey));if(w>-1)o[w].isSigner||(o[w].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${p.publicKey.toString()}`)}let c=0,l=0,u=0;const f=[],m=[];o.forEach(({pubkey:p,isSigner:w,isWritable:v})=>{w?(f.push(p.toString()),c+=1,v||(l+=1)):(m.push(p.toString()),v||(u+=1))});const y=f.concat(m),S=t.map(p=>{const{data:w,programId:v}=p;return{programIdIndex:y.indexOf(v.toString()),accounts:p.keys.map(E=>y.indexOf(E.pubkey.toString())),data:pe.encode(w)}});return S.forEach(p=>{In(p.programIdIndex>=0),p.accounts.forEach(w=>In(w>=0))}),new Ho({header:{numRequiredSignatures:c,numReadonlySignedAccounts:l,numReadonlyUnsignedAccounts:u},accountKeys:y,recentBlockhash:e,instructions:S})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((i,s)=>t[s].equals(i.publicKey))||(this.signatures=t.map(n=>({signature:null,publicKey:n}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(n=>{const i=n.toString();return t.has(i)?!1:(t.add(i),!0)}).map(n=>({signature:null,publicKey:n}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}this.signatures=n.map(s=>({signature:null,publicKey:s.publicKey}));const i=this._compile();this._partialSign(i,...n)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}const i=this._compile();this._partialSign(i,...n)}_partialSign(e,...t){const n=e.serialize();t.forEach(i=>{const s=J1(n,i.secretKey);this._addSignature(i.publicKey,fn(s))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){In(t.length===64);const n=this.signatures.findIndex(i=>e.equals(i.publicKey));if(n<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[n].signature=L.Buffer.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:n,publicKey:i}of this.signatures)if(n===null){if(t)return!1}else if(!Q1(n,e,i.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:n}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),i=this.serializeMessage();if(n&&!this._verifySignatures(i,t))throw new Error("Signature verification failed");return this._serialize(i)}_serialize(e){const{signatures:t}=this,n=[];_o(n,t.length);const i=n.length+t.length*64+e.length,s=L.Buffer.alloc(i);return In(t.length<256),L.Buffer.from(n).copy(s,0),t.forEach(({signature:o},a)=>{o!==null&&(In(o.length===64,"signature has invalid length"),L.Buffer.from(o).copy(s,n.length+a*64))}),e.copy(s,n.length+t.length*64),In(s.length<=ud,`Transaction too large: ${s.length} > ${ud}`),s}get keys(){return In(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return In(this.instructions.length===1),this.instructions[0].programId}get data(){return In(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const n=vo(t);let i=[];for(let s=0;s<n;s++){const o=t.slice(0,ld);t=t.slice(ld),i.push(pe.encode(L.Buffer.from(o)))}return yt.populate(Ho.from(t),i)}static populate(e,t=[]){const n=new yt;return n.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(n.feePayer=e.accountKeys[0]),t.forEach((i,s)=>{const o={signature:i==pe.encode(o0)?null:pe.decode(i),publicKey:e.accountKeys[s]};n.signatures.push(o)}),e.instructions.forEach(i=>{const s=i.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:n.signatures.some(c=>c.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});n.instructions.push(new Xe({keys:s,programId:e.accountKeys[i.programIdIndex],data:pe.decode(i.data)}))}),n._message=e,n._json=n.toJSON(),n}}new ue("SysvarC1ock11111111111111111111111111111111");new ue("SysvarEpochSchedu1e111111111111111111111111");new ue("Sysvar1nstructions1111111111111111111111111");const Al=new ue("SysvarRecentB1ockHashes11111111111111111111"),ps=new ue("SysvarRent111111111111111111111111111111111");new ue("SysvarRewards111111111111111111111111111111");new ue("SysvarS1otHashes111111111111111111111111111");new ue("SysvarS1otHistory11111111111111111111111111");new ue("SysvarStakeHistory1111111111111111111111111");async function a0(r,e,t,n){const i=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot},s=await r.sendTransaction(e,t,i);let o;if(e.recentBlockhash!=null&&e.lastValidBlockHeight!=null)o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,signature:s,blockhash:e.recentBlockhash,lastValidBlockHeight:e.lastValidBlockHeight},n&&n.commitment)).value;else if(e.minNonceContextSlot!=null&&e.nonceInfo!=null){const{nonceInstruction:a}=e.nonceInfo,c=a.keys[0].pubkey;o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,minContextSlot:e.minNonceContextSlot,nonceAccountPubkey:c,nonceValue:e.nonceInfo.nonce,signature:s},n&&n.commitment)).value}else(n==null?void 0:n.abortSignal)!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),o=(await r.confirmTransaction(s,n&&n.commitment)).value;if(o.err)throw new Error(`Transaction ${s} failed (${JSON.stringify(o)})`);return s}function Ln(r,e){const t=r.layout.span>=0?r.layout.span:zg(r,e),n=L.Buffer.alloc(t),i=Object.assign({instruction:r.index},e);return r.layout.encode(i,n),n}const c0=we("lamportsPerSignature"),u0=C([M("version"),M("state"),Ne("authorizedPubkey"),Ne("nonce"),C([c0],"feeCalculator")]),Jh=u0.span,l0=r=>{const e=r.decode.bind(r),t=r.encode.bind(r);return{decode:e,encode:t}},d0=r=>e=>{const t=he(r,e),{encode:n,decode:i}=l0(t),s=t;return s.decode=(o,a)=>{const c=i(o,a);return Bd(L.Buffer.from(c))},s.encode=(o,a,c)=>{const l=ta(o,r);return n(l,a,c)},s},Ls=d0(8),Kn=Object.freeze({Create:{index:0,layout:C([M("instruction"),Me("lamports"),Me("space"),Ne("programId")])},Assign:{index:1,layout:C([M("instruction"),Ne("programId")])},Transfer:{index:2,layout:C([M("instruction"),Ls("lamports")])},CreateWithSeed:{index:3,layout:C([M("instruction"),Ne("base"),hs("seed"),Me("lamports"),Me("space"),Ne("programId")])},AdvanceNonceAccount:{index:4,layout:C([M("instruction")])},WithdrawNonceAccount:{index:5,layout:C([M("instruction"),Me("lamports")])},InitializeNonceAccount:{index:6,layout:C([M("instruction"),Ne("authorized")])},AuthorizeNonceAccount:{index:7,layout:C([M("instruction"),Ne("authorized")])},Allocate:{index:8,layout:C([M("instruction"),Me("space")])},AllocateWithSeed:{index:9,layout:C([M("instruction"),Ne("base"),hs("seed"),Me("space"),Ne("programId")])},AssignWithSeed:{index:10,layout:C([M("instruction"),Ne("base"),hs("seed"),Ne("programId")])},TransferWithSeed:{index:11,layout:C([M("instruction"),Ls("lamports"),hs("seed"),Ne("programId")])},UpgradeNonceAccount:{index:12,layout:C([M("instruction")])}});class lr{constructor(){}static createAccount(e){const t=Kn.Create,n=Ln(t,{lamports:e.lamports,space:e.space,programId:fn(e.programId.toBuffer())});return new Xe({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:n})}static transfer(e){let t,n;if("basePubkey"in e){const i=Kn.TransferWithSeed;t=Ln(i,{lamports:BigInt(e.lamports),seed:e.seed,programId:fn(e.programId.toBuffer())}),n=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}else{const i=Kn.Transfer;t=Ln(i,{lamports:BigInt(e.lamports)}),n=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}return new Xe({keys:n,programId:this.programId,data:t})}static assign(e){let t,n;if("basePubkey"in e){const i=Kn.AssignWithSeed;t=Ln(i,{base:fn(e.basePubkey.toBuffer()),seed:e.seed,programId:fn(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=Kn.Assign;t=Ln(i,{programId:fn(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new Xe({keys:n,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=Kn.CreateWithSeed,n=Ln(t,{base:fn(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:fn(e.programId.toBuffer())});let i=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey!=e.fromPubkey&&i.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new Xe({keys:i,programId:this.programId,data:n})}static createNonceAccount(e){const t=new yt;"basePubkey"in e&&"seed"in e?t.add(lr.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:Jh,programId:this.programId})):t.add(lr.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:Jh,programId:this.programId}));const n={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(n)),t}static nonceInitialize(e){const t=Kn.InitializeNonceAccount,n=Ln(t,{authorized:fn(e.authorizedPubkey.toBuffer())}),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Al,isSigner:!1,isWritable:!1},{pubkey:ps,isSigner:!1,isWritable:!1}],programId:this.programId,data:n};return new Xe(i)}static nonceAdvance(e){const t=Kn.AdvanceNonceAccount,n=Ln(t),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Al,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n};return new Xe(i)}static nonceWithdraw(e){const t=Kn.WithdrawNonceAccount,n=Ln(t,{lamports:e.lamports});return new Xe({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:Al,isSigner:!1,isWritable:!1},{pubkey:ps,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static nonceAuthorize(e){const t=Kn.AuthorizeNonceAccount,n=Ln(t,{authorized:fn(e.newAuthorizedPubkey.toBuffer())});return new Xe({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static allocate(e){let t,n;if("basePubkey"in e){const i=Kn.AllocateWithSeed;t=Ln(i,{base:fn(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:fn(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=Kn.Allocate;t=Ln(i,{space:e.space}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new Xe({keys:n,programId:this.programId,data:t})}}lr.programId=new ue("11111111111111111111111111111111");new ue("BPFLoader2111111111111111111111111111111111");C([M("typeIndex"),Ls("deactivationSlot"),we("lastExtendedSlot"),ee("lastExtendedStartIndex"),ee(),Ie(Ne(),Pt(ee(),-1),"authority")]);const Mt=_r(Xs(ue),N(),r=>new ue(r)),Wg=Zs([N(),Se("base64")]),vf=_r(Xs(L.Buffer),Wg,r=>L.Buffer.from(r[0],"base64"));function Vg(r){return Ze([O({jsonrpc:Se("2.0"),id:N(),result:r}),O({jsonrpc:Se("2.0"),id:N(),error:O({code:vr(),message:N(),data:X(dg())})})])}const f0=Vg(vr());function ot(r){return _r(Vg(r),f0,e=>"error"in e?e:{...e,result:te(e.result,r)})}function jn(r){return ot(O({context:O({slot:k()}),value:r}))}function gu(r){return O({context:O({slot:k()}),value:r})}const h0=O({foundation:k(),foundationTerm:k(),initial:k(),taper:k(),terminal:k()});ot(j(F(O({epoch:k(),effectiveSlot:k(),amount:k(),postBalance:k(),commission:X(F(k()))}))));const p0=j(O({slot:k(),prioritizationFee:k()})),y0=O({total:k(),validator:k(),foundation:k(),epoch:k()}),g0=O({epoch:k(),slotIndex:k(),slotsInEpoch:k(),absoluteSlot:k(),blockHeight:X(k()),transactionCount:X(k())}),m0=O({slotsPerEpoch:k(),leaderScheduleSlotOffset:k(),warmup:Tt(),firstNormalEpoch:k(),firstNormalSlot:k()}),b0=cu(N(),j(k())),Gi=F(Ze([O({}),N()])),w0=O({err:Gi}),k0=Se("receivedSignature");O({"solana-core":N(),"feature-set":X(k())});jn(O({err:F(Ze([O({}),N()])),logs:F(j(N())),accounts:X(F(j(F(O({executable:Tt(),owner:N(),lamports:k(),data:j(N()),rentEpoch:X(k())}))))),unitsConsumed:X(k()),returnData:X(F(O({programId:N(),data:Zs([N(),Se("base64")])})))}));jn(O({byIdentity:cu(N(),j(k())),range:O({firstSlot:k(),lastSlot:k()})}));ot(h0);ot(y0);ot(p0);ot(g0);ot(m0);ot(b0);ot(k());jn(O({total:k(),circulating:k(),nonCirculating:k(),nonCirculatingAccounts:j(Mt)}));const S0=O({amount:N(),uiAmount:F(k()),decimals:k(),uiAmountString:X(N())});jn(j(O({address:Mt,amount:N(),uiAmount:F(k()),decimals:k(),uiAmountString:X(N())})));jn(j(O({pubkey:Mt,account:O({executable:Tt(),owner:Mt,lamports:k(),data:vf,rentEpoch:k()})})));const dd=O({program:N(),parsed:vr(),space:k()});jn(j(O({pubkey:Mt,account:O({executable:Tt(),owner:Mt,lamports:k(),data:dd,rentEpoch:k()})})));jn(j(O({lamports:k(),address:Mt})));const _f=O({executable:Tt(),owner:Mt,lamports:k(),data:vf,rentEpoch:k()});O({pubkey:Mt,account:_f});const v0=_r(Ze([Xs(L.Buffer),dd]),Ze([Wg,dd]),r=>Array.isArray(r)?te(r,vf):r),_0=O({executable:Tt(),owner:Mt,lamports:k(),data:v0,rentEpoch:k()});O({pubkey:Mt,account:_0});O({state:Ze([Se("active"),Se("inactive"),Se("activating"),Se("deactivating")]),active:k(),inactive:k()});ot(j(O({signature:N(),slot:k(),err:Gi,memo:F(N()),blockTime:X(F(k()))})));ot(j(O({signature:N(),slot:k(),err:Gi,memo:F(N()),blockTime:X(F(k()))})));O({subscription:k(),result:gu(_f)});const A0=O({pubkey:Mt,account:_f});O({subscription:k(),result:gu(A0)});const I0=O({parent:k(),slot:k(),root:k()});O({subscription:k(),result:I0});const E0=Ze([O({type:Ze([Se("firstShredReceived"),Se("completed"),Se("optimisticConfirmation"),Se("root")]),slot:k(),timestamp:k()}),O({type:Se("createdBank"),parent:k(),slot:k(),timestamp:k()}),O({type:Se("frozen"),slot:k(),timestamp:k(),stats:O({numTransactionEntries:k(),numSuccessfulTransactions:k(),numFailedTransactions:k(),maxTransactionsPerEntry:k()})}),O({type:Se("dead"),slot:k(),timestamp:k(),err:N()})]);O({subscription:k(),result:E0});O({subscription:k(),result:gu(Ze([w0,k0]))});O({subscription:k(),result:k()});O({pubkey:N(),gossip:F(N()),tpu:F(N()),rpc:F(N()),version:F(N())});const Qh=O({votePubkey:N(),nodePubkey:N(),activatedStake:k(),epochVoteAccount:Tt(),epochCredits:j(Zs([k(),k(),k()])),commission:k(),lastVote:k(),rootSlot:F(k())});ot(O({current:j(Qh),delinquent:j(Qh)}));const P0=Ze([Se("processed"),Se("confirmed"),Se("finalized")]),R0=O({slot:k(),confirmations:F(k()),err:Gi,confirmationStatus:X(P0)});jn(j(F(R0)));ot(k());const Ug=O({accountKey:Mt,writableIndexes:j(k()),readonlyIndexes:j(k())}),Af=O({signatures:j(N()),message:O({accountKeys:j(N()),header:O({numRequiredSignatures:k(),numReadonlySignedAccounts:k(),numReadonlyUnsignedAccounts:k()}),instructions:j(O({accounts:j(k()),data:N(),programIdIndex:k()})),recentBlockhash:N(),addressTableLookups:X(j(Ug))})}),Fg=O({pubkey:Mt,signer:Tt(),writable:Tt(),source:X(Ze([Se("transaction"),Se("lookupTable")]))}),jg=O({accountKeys:j(Fg),signatures:j(N())}),qg=O({parsed:vr(),program:N(),programId:Mt}),Gg=O({accounts:j(Mt),data:N(),programId:Mt}),T0=Ze([Gg,qg]),O0=Ze([O({parsed:vr(),program:N(),programId:N()}),O({accounts:j(N()),data:N(),programId:N()})]),Hg=_r(T0,O0,r=>"accounts"in r?te(r,Gg):te(r,qg)),Yg=O({signatures:j(N()),message:O({accountKeys:j(Fg),instructions:j(Hg),recentBlockhash:N(),addressTableLookups:X(F(j(Ug)))})}),gc=O({accountIndex:k(),mint:N(),owner:X(N()),uiTokenAmount:S0}),Jg=O({writable:j(Mt),readonly:j(Mt)}),mu=O({err:Gi,fee:k(),innerInstructions:X(F(j(O({index:k(),instructions:j(O({accounts:j(k()),data:N(),programIdIndex:k()}))})))),preBalances:j(k()),postBalances:j(k()),logMessages:X(F(j(N()))),preTokenBalances:X(F(j(gc))),postTokenBalances:X(F(j(gc))),loadedAddresses:X(Jg),computeUnitsConsumed:X(k())}),If=O({err:Gi,fee:k(),innerInstructions:X(F(j(O({index:k(),instructions:j(Hg)})))),preBalances:j(k()),postBalances:j(k()),logMessages:X(F(j(N()))),preTokenBalances:X(F(j(gc))),postTokenBalances:X(F(j(gc))),loadedAddresses:X(Jg),computeUnitsConsumed:X(k())}),no=Ze([Se(0),Se("legacy")]),Hi=O({pubkey:N(),lamports:k(),postBalance:F(k()),rewardType:F(N()),commission:X(F(k()))});ot(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:Af,meta:F(mu),version:X(no)})),rewards:X(j(Hi)),blockTime:F(k()),blockHeight:F(k())})));ot(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),rewards:X(j(Hi)),blockTime:F(k()),blockHeight:F(k())})));ot(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:jg,meta:F(mu),version:X(no)})),rewards:X(j(Hi)),blockTime:F(k()),blockHeight:F(k())})));ot(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:Yg,meta:F(If),version:X(no)})),rewards:X(j(Hi)),blockTime:F(k()),blockHeight:F(k())})));ot(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:jg,meta:F(If),version:X(no)})),rewards:X(j(Hi)),blockTime:F(k()),blockHeight:F(k())})));ot(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),rewards:X(j(Hi)),blockTime:F(k()),blockHeight:F(k())})));ot(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),transactions:j(O({transaction:Af,meta:F(mu)})),rewards:X(j(Hi)),blockTime:F(k())})));ot(F(O({blockhash:N(),previousBlockhash:N(),parentSlot:k(),signatures:j(N()),blockTime:F(k())})));ot(F(O({slot:k(),meta:mu,blockTime:X(F(k())),transaction:Af,version:X(no)})));ot(F(O({slot:k(),transaction:Yg,meta:F(If),blockTime:X(F(k())),version:X(no)})));jn(O({blockhash:N(),feeCalculator:O({lamportsPerSignature:k()})}));jn(O({blockhash:N(),lastValidBlockHeight:k()}));jn(Tt());const B0=O({slot:k(),numTransactions:k(),numSlots:k(),samplePeriodSecs:k()});ot(j(B0));jn(F(O({feeCalculator:O({lamportsPerSignature:k()})})));ot(N());ot(N());const x0=O({err:Gi,logs:j(N()),signature:N()});O({result:gu(x0),subscription:k()});class jr{constructor(e){this._keypair=void 0,this._keypair=e??qh()}static generate(){return new jr(qh())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const n=e.slice(32,64);if(!t||!t.skipValidation){const i=e.slice(0,32),s=cd(i);for(let o=0;o<32;o++)if(n[o]!==s[o])throw new Error("provided secretKey is invalid")}return new jr({publicKey:n,secretKey:e})}static fromSeed(e){const t=cd(e),n=new Uint8Array(64);return n.set(e),n.set(t,32),new jr({publicKey:t,secretKey:n})}get publicKey(){return new ue(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}Object.freeze({CreateLookupTable:{index:0,layout:C([M("instruction"),Ls("recentSlot"),ee("bumpSeed")])},FreezeLookupTable:{index:1,layout:C([M("instruction")])},ExtendLookupTable:{index:2,layout:C([M("instruction"),Ls(),Ie(Ne(),Pt(M(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:C([M("instruction")])},CloseLookupTable:{index:4,layout:C([M("instruction")])}});new ue("AddressLookupTab1e1111111111111111111111111");Object.freeze({RequestUnits:{index:0,layout:C([ee("instruction"),M("units"),M("additionalFee")])},RequestHeapFrame:{index:1,layout:C([ee("instruction"),M("bytes")])},SetComputeUnitLimit:{index:2,layout:C([ee("instruction"),M("units")])},SetComputeUnitPrice:{index:3,layout:C([ee("instruction"),Ls("microLamports")])}});new ue("ComputeBudget111111111111111111111111111111");C([ee("numSignatures"),ee("padding"),De("signatureOffset"),De("signatureInstructionIndex"),De("publicKeyOffset"),De("publicKeyInstructionIndex"),De("messageDataOffset"),De("messageDataSize"),De("messageInstructionIndex")]);new ue("Ed25519SigVerify111111111111111111111111111");si.utils.isValidPrivateKey;si.getPublicKey;C([ee("numSignatures"),De("signatureOffset"),ee("signatureInstructionIndex"),De("ethAddressOffset"),ee("ethAddressInstructionIndex"),De("messageDataOffset"),De("messageDataSize"),ee("messageInstructionIndex"),he(20,"ethAddress"),he(64,"signature"),ee("recoveryId")]);new ue("KeccakSecp256k11111111111111111111111111111");var Qg;new ue("StakeConfig11111111111111111111111111111111");class Xg{constructor(e,t,n){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=n}}Qg=Xg;Xg.default=new Qg(0,0,ue.default);Object.freeze({Initialize:{index:0,layout:C([M("instruction"),n0(),r0()])},Authorize:{index:1,layout:C([M("instruction"),Ne("newAuthorized"),M("stakeAuthorizationType")])},Delegate:{index:2,layout:C([M("instruction")])},Split:{index:3,layout:C([M("instruction"),Me("lamports")])},Withdraw:{index:4,layout:C([M("instruction"),Me("lamports")])},Deactivate:{index:5,layout:C([M("instruction")])},Merge:{index:7,layout:C([M("instruction")])},AuthorizeWithSeed:{index:8,layout:C([M("instruction"),Ne("newAuthorized"),M("stakeAuthorizationType"),hs("authoritySeed"),Ne("authorityOwner")])}});Object.freeze({Staker:{index:0},Withdrawer:{index:1}});new ue("Stake11111111111111111111111111111111111111");Object.freeze({InitializeAccount:{index:0,layout:C([M("instruction"),i0()])},Authorize:{index:1,layout:C([M("instruction"),Ne("newAuthorized"),M("voteAuthorizationType")])},Withdraw:{index:3,layout:C([M("instruction"),Me("lamports")])},AuthorizeWithSeed:{index:10,layout:C([M("instruction"),s0()])}});Object.freeze({Voter:{index:0},Withdrawer:{index:1}});new ue("Vote111111111111111111111111111111111111111");new ue("Va1idator1nfo111111111111111111111111111111");O({name:N(),website:X(N()),details:X(N()),keybaseUsername:X(N())});new ue("Vote111111111111111111111111111111111111111");C([Ne("nodePubkey"),Ne("authorizedWithdrawer"),ee("commission"),we(),Ie(C([we("slot"),M("confirmationCount")]),Pt(M(),-8),"votes"),ee("rootSlotValid"),we("rootSlot"),we(),Ie(C([we("epoch"),Ne("authorizedVoter")]),Pt(M(),-8),"authorizedVoters"),C([Ie(C([Ne("authorizedPubkey"),we("epochOfLastAuthorizedSwitch"),we("targetEpoch")]),32,"buf"),we("idx"),ee("isEmpty")],"priorVoters"),we(),Ie(C([we("epoch"),we("credits"),we("prevCredits")]),Pt(M(),-8),"epochCredits"),C([we("slot"),we("timestamp")],"lastTimestamp")]);var je={},bu={};bu.byteLength=L0;bu.toByteArray=N0;bu.fromByteArray=z0;var hr=[],Nn=[],C0=typeof Uint8Array<"u"?Uint8Array:Array,Il="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var ns=0,M0=Il.length;ns<M0;++ns)hr[ns]=Il[ns],Nn[Il.charCodeAt(ns)]=ns;Nn["-".charCodeAt(0)]=62;Nn["_".charCodeAt(0)]=63;function Zg(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function L0(r){var e=Zg(r),t=e[0],n=e[1];return(t+n)*3/4-n}function K0(r,e,t){return(e+t)*3/4-t}function N0(r){var e,t=Zg(r),n=t[0],i=t[1],s=new C0(K0(r,n,i)),o=0,a=i>0?n-4:n,c;for(c=0;c<a;c+=4)e=Nn[r.charCodeAt(c)]<<18|Nn[r.charCodeAt(c+1)]<<12|Nn[r.charCodeAt(c+2)]<<6|Nn[r.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=Nn[r.charCodeAt(c)]<<2|Nn[r.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=Nn[r.charCodeAt(c)]<<10|Nn[r.charCodeAt(c+1)]<<4|Nn[r.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function D0(r){return hr[r>>18&63]+hr[r>>12&63]+hr[r>>6&63]+hr[r&63]}function $0(r,e,t){for(var n,i=[],s=e;s<t;s+=3)n=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),i.push(D0(n));return i.join("")}function z0(r){for(var e,t=r.length,n=t%3,i=[],s=16383,o=0,a=t-n;o<a;o+=s)i.push($0(r,o,o+s>a?a:o+s));return n===1?(e=r[t-1],i.push(hr[e>>2]+hr[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push(hr[e>>10]+hr[e>>4&63]+hr[e<<2&63]+"=")),i.join("")}var Ef={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Ef.read=function(r,e,t,n,i){var s,o,a=i*8-n-1,c=(1<<a)-1,l=c>>1,u=-7,f=t?i-1:0,m=t?-1:1,y=r[e+f];for(f+=m,s=y&(1<<-u)-1,y>>=-u,u+=a;u>0;s=s*256+r[e+f],f+=m,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=o*256+r[e+f],f+=m,u-=8);if(s===0)s=1-l;else{if(s===c)return o?NaN:(y?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-l}return(y?-1:1)*o*Math.pow(2,s-n)};Ef.write=function(r,e,t,n,i,s){var o,a,c,l=s*8-i-1,u=(1<<l)-1,f=u>>1,m=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=n?0:s-1,S=n?1:-1,p=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+f>=1?e+=m/c:e+=m*Math.pow(2,1-f),e*c>=2&&(o++,c/=2),o+f>=u?(a=0,o=u):o+f>=1?(a=(e*c-1)*Math.pow(2,i),o=o+f):(a=e*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;r[t+y]=a&255,y+=S,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;r[t+y]=o&255,y+=S,o/=256,l-=8);r[t+y-S]|=p*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){const e=bu,t=Ef,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=a,r.SlowBuffer=E,r.INSPECT_MAX_BYTES=50;const i=2147483647;r.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const g=new Uint8Array(1),d={foo:function(){return 42}};return Object.setPrototypeOf(d,Uint8Array.prototype),Object.setPrototypeOf(g,d),g.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(!!a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(!!a.isBuffer(this))return this.byteOffset}});function o(g){if(g>i)throw new RangeError('The value "'+g+'" is invalid for option "size"');const d=new Uint8Array(g);return Object.setPrototypeOf(d,a.prototype),d}function a(g,d,h){if(typeof g=="number"){if(typeof d=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(g)}return c(g,d,h)}a.poolSize=8192;function c(g,d,h){if(typeof g=="string")return m(g,d);if(ArrayBuffer.isView(g))return S(g);if(g==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g);if(sr(g,ArrayBuffer)||g&&sr(g.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(sr(g,SharedArrayBuffer)||g&&sr(g.buffer,SharedArrayBuffer)))return p(g,d,h);if(typeof g=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const A=g.valueOf&&g.valueOf();if(A!=null&&A!==g)return a.from(A,d,h);const x=w(g);if(x)return x;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof g[Symbol.toPrimitive]=="function")return a.from(g[Symbol.toPrimitive]("string"),d,h);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof g)}a.from=function(g,d,h){return c(g,d,h)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(g){if(typeof g!="number")throw new TypeError('"size" argument must be of type number');if(g<0)throw new RangeError('The value "'+g+'" is invalid for option "size"')}function u(g,d,h){return l(g),g<=0?o(g):d!==void 0?typeof h=="string"?o(g).fill(d,h):o(g).fill(d):o(g)}a.alloc=function(g,d,h){return u(g,d,h)};function f(g){return l(g),o(g<0?0:v(g)|0)}a.allocUnsafe=function(g){return f(g)},a.allocUnsafeSlow=function(g){return f(g)};function m(g,d){if((typeof d!="string"||d==="")&&(d="utf8"),!a.isEncoding(d))throw new TypeError("Unknown encoding: "+d);const h=P(g,d)|0;let A=o(h);const x=A.write(g,d);return x!==h&&(A=A.slice(0,x)),A}function y(g){const d=g.length<0?0:v(g.length)|0,h=o(d);for(let A=0;A<d;A+=1)h[A]=g[A]&255;return h}function S(g){if(sr(g,Uint8Array)){const d=new Uint8Array(g);return p(d.buffer,d.byteOffset,d.byteLength)}return y(g)}function p(g,d,h){if(d<0||g.byteLength<d)throw new RangeError('"offset" is outside of buffer bounds');if(g.byteLength<d+(h||0))throw new RangeError('"length" is outside of buffer bounds');let A;return d===void 0&&h===void 0?A=new Uint8Array(g):h===void 0?A=new Uint8Array(g,d):A=new Uint8Array(g,d,h),Object.setPrototypeOf(A,a.prototype),A}function w(g){if(a.isBuffer(g)){const d=v(g.length)|0,h=o(d);return h.length===0||g.copy(h,0,0,d),h}if(g.length!==void 0)return typeof g.length!="number"||cl(g.length)?o(0):y(g);if(g.type==="Buffer"&&Array.isArray(g.data))return y(g.data)}function v(g){if(g>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return g|0}function E(g){return+g!=g&&(g=0),a.alloc(+g)}a.isBuffer=function(d){return d!=null&&d._isBuffer===!0&&d!==a.prototype},a.compare=function(d,h){if(sr(d,Uint8Array)&&(d=a.from(d,d.offset,d.byteLength)),sr(h,Uint8Array)&&(h=a.from(h,h.offset,h.byteLength)),!a.isBuffer(d)||!a.isBuffer(h))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(d===h)return 0;let A=d.length,x=h.length;for(let U=0,H=Math.min(A,x);U<H;++U)if(d[U]!==h[U]){A=d[U],x=h[U];break}return A<x?-1:x<A?1:0},a.isEncoding=function(d){switch(String(d).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(d,h){if(!Array.isArray(d))throw new TypeError('"list" argument must be an Array of Buffers');if(d.length===0)return a.alloc(0);let A;if(h===void 0)for(h=0,A=0;A<d.length;++A)h+=d[A].length;const x=a.allocUnsafe(h);let U=0;for(A=0;A<d.length;++A){let H=d[A];if(sr(H,Uint8Array))U+H.length>x.length?(a.isBuffer(H)||(H=a.from(H)),H.copy(x,U)):Uint8Array.prototype.set.call(x,H,U);else if(a.isBuffer(H))H.copy(x,U);else throw new TypeError('"list" argument must be an Array of Buffers');U+=H.length}return x};function P(g,d){if(a.isBuffer(g))return g.length;if(ArrayBuffer.isView(g)||sr(g,ArrayBuffer))return g.byteLength;if(typeof g!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof g);const h=g.length,A=arguments.length>2&&arguments[2]===!0;if(!A&&h===0)return 0;let x=!1;for(;;)switch(d){case"ascii":case"latin1":case"binary":return h;case"utf8":case"utf-8":return al(g).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return h*2;case"hex":return h>>>1;case"base64":return Qf(g).length;default:if(x)return A?-1:al(g).length;d=(""+d).toLowerCase(),x=!0}}a.byteLength=P;function K(g,d,h){let A=!1;if((d===void 0||d<0)&&(d=0),d>this.length||((h===void 0||h>this.length)&&(h=this.length),h<=0)||(h>>>=0,d>>>=0,h<=d))return"";for(g||(g="utf8");;)switch(g){case"hex":return Dt(this,d,h);case"utf8":case"utf-8":return $(this,d,h);case"ascii":return ae(this,d,h);case"latin1":case"binary":return ve(this,d,h);case"base64":return I(this,d,h);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return nn(this,d,h);default:if(A)throw new TypeError("Unknown encoding: "+g);g=(g+"").toLowerCase(),A=!0}}a.prototype._isBuffer=!0;function T(g,d,h){const A=g[d];g[d]=g[h],g[h]=A}a.prototype.swap16=function(){const d=this.length;if(d%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let h=0;h<d;h+=2)T(this,h,h+1);return this},a.prototype.swap32=function(){const d=this.length;if(d%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let h=0;h<d;h+=4)T(this,h,h+3),T(this,h+1,h+2);return this},a.prototype.swap64=function(){const d=this.length;if(d%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let h=0;h<d;h+=8)T(this,h,h+7),T(this,h+1,h+6),T(this,h+2,h+5),T(this,h+3,h+4);return this},a.prototype.toString=function(){const d=this.length;return d===0?"":arguments.length===0?$(this,0,d):K.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(d){if(!a.isBuffer(d))throw new TypeError("Argument must be a Buffer");return this===d?!0:a.compare(this,d)===0},a.prototype.inspect=function(){let d="";const h=r.INSPECT_MAX_BYTES;return d=this.toString("hex",0,h).replace(/(.{2})/g,"$1 ").trim(),this.length>h&&(d+=" ... "),"<Buffer "+d+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(d,h,A,x,U){if(sr(d,Uint8Array)&&(d=a.from(d,d.offset,d.byteLength)),!a.isBuffer(d))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof d);if(h===void 0&&(h=0),A===void 0&&(A=d?d.length:0),x===void 0&&(x=0),U===void 0&&(U=this.length),h<0||A>d.length||x<0||U>this.length)throw new RangeError("out of range index");if(x>=U&&h>=A)return 0;if(x>=U)return-1;if(h>=A)return 1;if(h>>>=0,A>>>=0,x>>>=0,U>>>=0,this===d)return 0;let H=U-x,Oe=A-h;const mt=Math.min(H,Oe),at=this.slice(x,U),bt=d.slice(h,A);for(let tt=0;tt<mt;++tt)if(at[tt]!==bt[tt]){H=at[tt],Oe=bt[tt];break}return H<Oe?-1:Oe<H?1:0};function b(g,d,h,A,x){if(g.length===0)return-1;if(typeof h=="string"?(A=h,h=0):h>2147483647?h=2147483647:h<-2147483648&&(h=-2147483648),h=+h,cl(h)&&(h=x?0:g.length-1),h<0&&(h=g.length+h),h>=g.length){if(x)return-1;h=g.length-1}else if(h<0)if(x)h=0;else return-1;if(typeof d=="string"&&(d=a.from(d,A)),a.isBuffer(d))return d.length===0?-1:_(g,d,h,A,x);if(typeof d=="number")return d=d&255,typeof Uint8Array.prototype.indexOf=="function"?x?Uint8Array.prototype.indexOf.call(g,d,h):Uint8Array.prototype.lastIndexOf.call(g,d,h):_(g,[d],h,A,x);throw new TypeError("val must be string, number or Buffer")}function _(g,d,h,A,x){let U=1,H=g.length,Oe=d.length;if(A!==void 0&&(A=String(A).toLowerCase(),A==="ucs2"||A==="ucs-2"||A==="utf16le"||A==="utf-16le")){if(g.length<2||d.length<2)return-1;U=2,H/=2,Oe/=2,h/=2}function mt(bt,tt){return U===1?bt[tt]:bt.readUInt16BE(tt*U)}let at;if(x){let bt=-1;for(at=h;at<H;at++)if(mt(g,at)===mt(d,bt===-1?0:at-bt)){if(bt===-1&&(bt=at),at-bt+1===Oe)return bt*U}else bt!==-1&&(at-=at-bt),bt=-1}else for(h+Oe>H&&(h=H-Oe),at=h;at>=0;at--){let bt=!0;for(let tt=0;tt<Oe;tt++)if(mt(g,at+tt)!==mt(d,tt)){bt=!1;break}if(bt)return at}return-1}a.prototype.includes=function(d,h,A){return this.indexOf(d,h,A)!==-1},a.prototype.indexOf=function(d,h,A){return b(this,d,h,A,!0)},a.prototype.lastIndexOf=function(d,h,A){return b(this,d,h,A,!1)};function R(g,d,h,A){h=Number(h)||0;const x=g.length-h;A?(A=Number(A),A>x&&(A=x)):A=x;const U=d.length;A>U/2&&(A=U/2);let H;for(H=0;H<A;++H){const Oe=parseInt(d.substr(H*2,2),16);if(cl(Oe))return H;g[h+H]=Oe}return H}function W(g,d,h,A){return Pa(al(d,g.length-h),g,h,A)}function B(g,d,h,A){return Pa(cw(d),g,h,A)}function V(g,d,h,A){return Pa(Qf(d),g,h,A)}function q(g,d,h,A){return Pa(uw(d,g.length-h),g,h,A)}a.prototype.write=function(d,h,A,x){if(h===void 0)x="utf8",A=this.length,h=0;else if(A===void 0&&typeof h=="string")x=h,A=this.length,h=0;else if(isFinite(h))h=h>>>0,isFinite(A)?(A=A>>>0,x===void 0&&(x="utf8")):(x=A,A=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const U=this.length-h;if((A===void 0||A>U)&&(A=U),d.length>0&&(A<0||h<0)||h>this.length)throw new RangeError("Attempt to write outside buffer bounds");x||(x="utf8");let H=!1;for(;;)switch(x){case"hex":return R(this,d,h,A);case"utf8":case"utf-8":return W(this,d,h,A);case"ascii":case"latin1":case"binary":return B(this,d,h,A);case"base64":return V(this,d,h,A);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,d,h,A);default:if(H)throw new TypeError("Unknown encoding: "+x);x=(""+x).toLowerCase(),H=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(g,d,h){return d===0&&h===g.length?e.fromByteArray(g):e.fromByteArray(g.slice(d,h))}function $(g,d,h){h=Math.min(g.length,h);const A=[];let x=d;for(;x<h;){const U=g[x];let H=null,Oe=U>239?4:U>223?3:U>191?2:1;if(x+Oe<=h){let mt,at,bt,tt;switch(Oe){case 1:U<128&&(H=U);break;case 2:mt=g[x+1],(mt&192)===128&&(tt=(U&31)<<6|mt&63,tt>127&&(H=tt));break;case 3:mt=g[x+1],at=g[x+2],(mt&192)===128&&(at&192)===128&&(tt=(U&15)<<12|(mt&63)<<6|at&63,tt>2047&&(tt<55296||tt>57343)&&(H=tt));break;case 4:mt=g[x+1],at=g[x+2],bt=g[x+3],(mt&192)===128&&(at&192)===128&&(bt&192)===128&&(tt=(U&15)<<18|(mt&63)<<12|(at&63)<<6|bt&63,tt>65535&&tt<1114112&&(H=tt))}}H===null?(H=65533,Oe=1):H>65535&&(H-=65536,A.push(H>>>10&1023|55296),H=56320|H&1023),A.push(H),x+=Oe}return ke(A)}const G=4096;function ke(g){const d=g.length;if(d<=G)return String.fromCharCode.apply(String,g);let h="",A=0;for(;A<d;)h+=String.fromCharCode.apply(String,g.slice(A,A+=G));return h}function ae(g,d,h){let A="";h=Math.min(g.length,h);for(let x=d;x<h;++x)A+=String.fromCharCode(g[x]&127);return A}function ve(g,d,h){let A="";h=Math.min(g.length,h);for(let x=d;x<h;++x)A+=String.fromCharCode(g[x]);return A}function Dt(g,d,h){const A=g.length;(!d||d<0)&&(d=0),(!h||h<0||h>A)&&(h=A);let x="";for(let U=d;U<h;++U)x+=lw[g[U]];return x}function nn(g,d,h){const A=g.slice(d,h);let x="";for(let U=0;U<A.length-1;U+=2)x+=String.fromCharCode(A[U]+A[U+1]*256);return x}a.prototype.slice=function(d,h){const A=this.length;d=~~d,h=h===void 0?A:~~h,d<0?(d+=A,d<0&&(d=0)):d>A&&(d=A),h<0?(h+=A,h<0&&(h=0)):h>A&&(h=A),h<d&&(h=d);const x=this.subarray(d,h);return Object.setPrototypeOf(x,a.prototype),x};function me(g,d,h){if(g%1!==0||g<0)throw new RangeError("offset is not uint");if(g+d>h)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(d,h,A){d=d>>>0,h=h>>>0,A||me(d,h,this.length);let x=this[d],U=1,H=0;for(;++H<h&&(U*=256);)x+=this[d+H]*U;return x},a.prototype.readUintBE=a.prototype.readUIntBE=function(d,h,A){d=d>>>0,h=h>>>0,A||me(d,h,this.length);let x=this[d+--h],U=1;for(;h>0&&(U*=256);)x+=this[d+--h]*U;return x},a.prototype.readUint8=a.prototype.readUInt8=function(d,h){return d=d>>>0,h||me(d,1,this.length),this[d]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(d,h){return d=d>>>0,h||me(d,2,this.length),this[d]|this[d+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(d,h){return d=d>>>0,h||me(d,2,this.length),this[d]<<8|this[d+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(d,h){return d=d>>>0,h||me(d,4,this.length),(this[d]|this[d+1]<<8|this[d+2]<<16)+this[d+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(d,h){return d=d>>>0,h||me(d,4,this.length),this[d]*16777216+(this[d+1]<<16|this[d+2]<<8|this[d+3])},a.prototype.readBigUInt64LE=$r(function(d){d=d>>>0,Zi(d,"offset");const h=this[d],A=this[d+7];(h===void 0||A===void 0)&&fo(d,this.length-8);const x=h+this[++d]*2**8+this[++d]*2**16+this[++d]*2**24,U=this[++d]+this[++d]*2**8+this[++d]*2**16+A*2**24;return BigInt(x)+(BigInt(U)<<BigInt(32))}),a.prototype.readBigUInt64BE=$r(function(d){d=d>>>0,Zi(d,"offset");const h=this[d],A=this[d+7];(h===void 0||A===void 0)&&fo(d,this.length-8);const x=h*2**24+this[++d]*2**16+this[++d]*2**8+this[++d],U=this[++d]*2**24+this[++d]*2**16+this[++d]*2**8+A;return(BigInt(x)<<BigInt(32))+BigInt(U)}),a.prototype.readIntLE=function(d,h,A){d=d>>>0,h=h>>>0,A||me(d,h,this.length);let x=this[d],U=1,H=0;for(;++H<h&&(U*=256);)x+=this[d+H]*U;return U*=128,x>=U&&(x-=Math.pow(2,8*h)),x},a.prototype.readIntBE=function(d,h,A){d=d>>>0,h=h>>>0,A||me(d,h,this.length);let x=h,U=1,H=this[d+--x];for(;x>0&&(U*=256);)H+=this[d+--x]*U;return U*=128,H>=U&&(H-=Math.pow(2,8*h)),H},a.prototype.readInt8=function(d,h){return d=d>>>0,h||me(d,1,this.length),this[d]&128?(255-this[d]+1)*-1:this[d]},a.prototype.readInt16LE=function(d,h){d=d>>>0,h||me(d,2,this.length);const A=this[d]|this[d+1]<<8;return A&32768?A|4294901760:A},a.prototype.readInt16BE=function(d,h){d=d>>>0,h||me(d,2,this.length);const A=this[d+1]|this[d]<<8;return A&32768?A|4294901760:A},a.prototype.readInt32LE=function(d,h){return d=d>>>0,h||me(d,4,this.length),this[d]|this[d+1]<<8|this[d+2]<<16|this[d+3]<<24},a.prototype.readInt32BE=function(d,h){return d=d>>>0,h||me(d,4,this.length),this[d]<<24|this[d+1]<<16|this[d+2]<<8|this[d+3]},a.prototype.readBigInt64LE=$r(function(d){d=d>>>0,Zi(d,"offset");const h=this[d],A=this[d+7];(h===void 0||A===void 0)&&fo(d,this.length-8);const x=this[d+4]+this[d+5]*2**8+this[d+6]*2**16+(A<<24);return(BigInt(x)<<BigInt(32))+BigInt(h+this[++d]*2**8+this[++d]*2**16+this[++d]*2**24)}),a.prototype.readBigInt64BE=$r(function(d){d=d>>>0,Zi(d,"offset");const h=this[d],A=this[d+7];(h===void 0||A===void 0)&&fo(d,this.length-8);const x=(h<<24)+this[++d]*2**16+this[++d]*2**8+this[++d];return(BigInt(x)<<BigInt(32))+BigInt(this[++d]*2**24+this[++d]*2**16+this[++d]*2**8+A)}),a.prototype.readFloatLE=function(d,h){return d=d>>>0,h||me(d,4,this.length),t.read(this,d,!0,23,4)},a.prototype.readFloatBE=function(d,h){return d=d>>>0,h||me(d,4,this.length),t.read(this,d,!1,23,4)},a.prototype.readDoubleLE=function(d,h){return d=d>>>0,h||me(d,8,this.length),t.read(this,d,!0,52,8)},a.prototype.readDoubleBE=function(d,h){return d=d>>>0,h||me(d,8,this.length),t.read(this,d,!1,52,8)};function Be(g,d,h,A,x,U){if(!a.isBuffer(g))throw new TypeError('"buffer" argument must be a Buffer instance');if(d>x||d<U)throw new RangeError('"value" argument is out of bounds');if(h+A>g.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(d,h,A,x){if(d=+d,h=h>>>0,A=A>>>0,!x){const Oe=Math.pow(2,8*A)-1;Be(this,d,h,A,Oe,0)}let U=1,H=0;for(this[h]=d&255;++H<A&&(U*=256);)this[h+H]=d/U&255;return h+A},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(d,h,A,x){if(d=+d,h=h>>>0,A=A>>>0,!x){const Oe=Math.pow(2,8*A)-1;Be(this,d,h,A,Oe,0)}let U=A-1,H=1;for(this[h+U]=d&255;--U>=0&&(H*=256);)this[h+U]=d/H&255;return h+A},a.prototype.writeUint8=a.prototype.writeUInt8=function(d,h,A){return d=+d,h=h>>>0,A||Be(this,d,h,1,255,0),this[h]=d&255,h+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(d,h,A){return d=+d,h=h>>>0,A||Be(this,d,h,2,65535,0),this[h]=d&255,this[h+1]=d>>>8,h+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(d,h,A){return d=+d,h=h>>>0,A||Be(this,d,h,2,65535,0),this[h]=d>>>8,this[h+1]=d&255,h+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(d,h,A){return d=+d,h=h>>>0,A||Be(this,d,h,4,4294967295,0),this[h+3]=d>>>24,this[h+2]=d>>>16,this[h+1]=d>>>8,this[h]=d&255,h+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(d,h,A){return d=+d,h=h>>>0,A||Be(this,d,h,4,4294967295,0),this[h]=d>>>24,this[h+1]=d>>>16,this[h+2]=d>>>8,this[h+3]=d&255,h+4};function Ut(g,d,h,A,x){Dr(d,A,x,g,h,7);let U=Number(d&BigInt(4294967295));g[h++]=U,U=U>>8,g[h++]=U,U=U>>8,g[h++]=U,U=U>>8,g[h++]=U;let H=Number(d>>BigInt(32)&BigInt(4294967295));return g[h++]=H,H=H>>8,g[h++]=H,H=H>>8,g[h++]=H,H=H>>8,g[h++]=H,h}function Yt(g,d,h,A,x){Dr(d,A,x,g,h,7);let U=Number(d&BigInt(4294967295));g[h+7]=U,U=U>>8,g[h+6]=U,U=U>>8,g[h+5]=U,U=U>>8,g[h+4]=U;let H=Number(d>>BigInt(32)&BigInt(4294967295));return g[h+3]=H,H=H>>8,g[h+2]=H,H=H>>8,g[h+1]=H,H=H>>8,g[h]=H,h+8}a.prototype.writeBigUInt64LE=$r(function(d,h=0){return Ut(this,d,h,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=$r(function(d,h=0){return Yt(this,d,h,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(d,h,A,x){if(d=+d,h=h>>>0,!x){const mt=Math.pow(2,8*A-1);Be(this,d,h,A,mt-1,-mt)}let U=0,H=1,Oe=0;for(this[h]=d&255;++U<A&&(H*=256);)d<0&&Oe===0&&this[h+U-1]!==0&&(Oe=1),this[h+U]=(d/H>>0)-Oe&255;return h+A},a.prototype.writeIntBE=function(d,h,A,x){if(d=+d,h=h>>>0,!x){const mt=Math.pow(2,8*A-1);Be(this,d,h,A,mt-1,-mt)}let U=A-1,H=1,Oe=0;for(this[h+U]=d&255;--U>=0&&(H*=256);)d<0&&Oe===0&&this[h+U+1]!==0&&(Oe=1),this[h+U]=(d/H>>0)-Oe&255;return h+A},a.prototype.writeInt8=function(d,h,A){return d=+d,h=h>>>0,A||Be(this,d,h,1,127,-128),d<0&&(d=255+d+1),this[h]=d&255,h+1},a.prototype.writeInt16LE=function(d,h,A){return d=+d,h=h>>>0,A||Be(this,d,h,2,32767,-32768),this[h]=d&255,this[h+1]=d>>>8,h+2},a.prototype.writeInt16BE=function(d,h,A){return d=+d,h=h>>>0,A||Be(this,d,h,2,32767,-32768),this[h]=d>>>8,this[h+1]=d&255,h+2},a.prototype.writeInt32LE=function(d,h,A){return d=+d,h=h>>>0,A||Be(this,d,h,4,2147483647,-2147483648),this[h]=d&255,this[h+1]=d>>>8,this[h+2]=d>>>16,this[h+3]=d>>>24,h+4},a.prototype.writeInt32BE=function(d,h,A){return d=+d,h=h>>>0,A||Be(this,d,h,4,2147483647,-2147483648),d<0&&(d=4294967295+d+1),this[h]=d>>>24,this[h+1]=d>>>16,this[h+2]=d>>>8,this[h+3]=d&255,h+4},a.prototype.writeBigInt64LE=$r(function(d,h=0){return Ut(this,d,h,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=$r(function(d,h=0){return Yt(this,d,h,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function $t(g,d,h,A,x,U){if(h+A>g.length)throw new RangeError("Index out of range");if(h<0)throw new RangeError("Index out of range")}function ft(g,d,h,A,x){return d=+d,h=h>>>0,x||$t(g,d,h,4),t.write(g,d,h,A,23,4),h+4}a.prototype.writeFloatLE=function(d,h,A){return ft(this,d,h,!0,A)},a.prototype.writeFloatBE=function(d,h,A){return ft(this,d,h,!1,A)};function rr(g,d,h,A,x){return d=+d,h=h>>>0,x||$t(g,d,h,8),t.write(g,d,h,A,52,8),h+8}a.prototype.writeDoubleLE=function(d,h,A){return rr(this,d,h,!0,A)},a.prototype.writeDoubleBE=function(d,h,A){return rr(this,d,h,!1,A)},a.prototype.copy=function(d,h,A,x){if(!a.isBuffer(d))throw new TypeError("argument should be a Buffer");if(A||(A=0),!x&&x!==0&&(x=this.length),h>=d.length&&(h=d.length),h||(h=0),x>0&&x<A&&(x=A),x===A||d.length===0||this.length===0)return 0;if(h<0)throw new RangeError("targetStart out of bounds");if(A<0||A>=this.length)throw new RangeError("Index out of range");if(x<0)throw new RangeError("sourceEnd out of bounds");x>this.length&&(x=this.length),d.length-h<x-A&&(x=d.length-h+A);const U=x-A;return this===d&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(h,A,x):Uint8Array.prototype.set.call(d,this.subarray(A,x),h),U},a.prototype.fill=function(d,h,A,x){if(typeof d=="string"){if(typeof h=="string"?(x=h,h=0,A=this.length):typeof A=="string"&&(x=A,A=this.length),x!==void 0&&typeof x!="string")throw new TypeError("encoding must be a string");if(typeof x=="string"&&!a.isEncoding(x))throw new TypeError("Unknown encoding: "+x);if(d.length===1){const H=d.charCodeAt(0);(x==="utf8"&&H<128||x==="latin1")&&(d=H)}}else typeof d=="number"?d=d&255:typeof d=="boolean"&&(d=Number(d));if(h<0||this.length<h||this.length<A)throw new RangeError("Out of range index");if(A<=h)return this;h=h>>>0,A=A===void 0?this.length:A>>>0,d||(d=0);let U;if(typeof d=="number")for(U=h;U<A;++U)this[U]=d;else{const H=a.isBuffer(d)?d:a.from(d,x),Oe=H.length;if(Oe===0)throw new TypeError('The value "'+d+'" is invalid for argument "value"');for(U=0;U<A-h;++U)this[U+h]=H[U%Oe]}return this};const rn={};function ir(g,d,h){rn[g]=class extends h{constructor(){super(),Object.defineProperty(this,"message",{value:d.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${g}]`,this.stack,delete this.name}get code(){return g}set code(x){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:x,writable:!0})}toString(){return`${this.name} [${g}]: ${this.message}`}}}ir("ERR_BUFFER_OUT_OF_BOUNDS",function(g){return g?`${g} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ir("ERR_INVALID_ARG_TYPE",function(g,d){return`The "${g}" argument must be of type number. Received type ${typeof d}`},TypeError),ir("ERR_OUT_OF_RANGE",function(g,d,h){let A=`The value of "${g}" is out of range.`,x=h;return Number.isInteger(h)&&Math.abs(h)>2**32?x=Nr(String(h)):typeof h=="bigint"&&(x=String(h),(h>BigInt(2)**BigInt(32)||h<-(BigInt(2)**BigInt(32)))&&(x=Nr(x)),x+="n"),A+=` It must be ${d}. Received ${x}`,A},RangeError);function Nr(g){let d="",h=g.length;const A=g[0]==="-"?1:0;for(;h>=A+4;h-=3)d=`_${g.slice(h-3,h)}${d}`;return`${g.slice(0,h)}${d}`}function pi(g,d,h){Zi(d,"offset"),(g[d]===void 0||g[d+h]===void 0)&&fo(d,g.length-(h+1))}function Dr(g,d,h,A,x,U){if(g>h||g<d){const H=typeof d=="bigint"?"n":"";let Oe;throw U>3?d===0||d===BigInt(0)?Oe=`>= 0${H} and < 2${H} ** ${(U+1)*8}${H}`:Oe=`>= -(2${H} ** ${(U+1)*8-1}${H}) and < 2 ** ${(U+1)*8-1}${H}`:Oe=`>= ${d}${H} and <= ${h}${H}`,new rn.ERR_OUT_OF_RANGE("value",Oe,g)}pi(A,x,U)}function Zi(g,d){if(typeof g!="number")throw new rn.ERR_INVALID_ARG_TYPE(d,"number",g)}function fo(g,d,h){throw Math.floor(g)!==g?(Zi(g,h),new rn.ERR_OUT_OF_RANGE(h||"offset","an integer",g)):d<0?new rn.ERR_BUFFER_OUT_OF_BOUNDS:new rn.ERR_OUT_OF_RANGE(h||"offset",`>= ${h?1:0} and <= ${d}`,g)}const ow=/[^+/0-9A-Za-z-_]/g;function aw(g){if(g=g.split("=")[0],g=g.trim().replace(ow,""),g.length<2)return"";for(;g.length%4!==0;)g=g+"=";return g}function al(g,d){d=d||1/0;let h;const A=g.length;let x=null;const U=[];for(let H=0;H<A;++H){if(h=g.charCodeAt(H),h>55295&&h<57344){if(!x){if(h>56319){(d-=3)>-1&&U.push(239,191,189);continue}else if(H+1===A){(d-=3)>-1&&U.push(239,191,189);continue}x=h;continue}if(h<56320){(d-=3)>-1&&U.push(239,191,189),x=h;continue}h=(x-55296<<10|h-56320)+65536}else x&&(d-=3)>-1&&U.push(239,191,189);if(x=null,h<128){if((d-=1)<0)break;U.push(h)}else if(h<2048){if((d-=2)<0)break;U.push(h>>6|192,h&63|128)}else if(h<65536){if((d-=3)<0)break;U.push(h>>12|224,h>>6&63|128,h&63|128)}else if(h<1114112){if((d-=4)<0)break;U.push(h>>18|240,h>>12&63|128,h>>6&63|128,h&63|128)}else throw new Error("Invalid code point")}return U}function cw(g){const d=[];for(let h=0;h<g.length;++h)d.push(g.charCodeAt(h)&255);return d}function uw(g,d){let h,A,x;const U=[];for(let H=0;H<g.length&&!((d-=2)<0);++H)h=g.charCodeAt(H),A=h>>8,x=h%256,U.push(x),U.push(A);return U}function Qf(g){return e.toByteArray(aw(g))}function Pa(g,d,h,A){let x;for(x=0;x<A&&!(x+h>=d.length||x>=g.length);++x)d[x+h]=g[x];return x}function sr(g,d){return g instanceof d||g!=null&&g.constructor!=null&&g.constructor.name!=null&&g.constructor.name===d.name}function cl(g){return g!==g}const lw=function(){const g="0123456789abcdef",d=new Array(256);for(let h=0;h<16;++h){const A=h*16;for(let x=0;x<16;++x)d[A+x]=g[h]+g[x]}return d}();function $r(g){return typeof BigInt>"u"?dw:g}function dw(){throw new Error("BigInt not supported")}})(je);var W0=typeof ge.global<"u"?ge.global:typeof self<"u"?self:typeof window<"u"?window:{},fd;typeof Object.create=="function"?fd=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:fd=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e};var V0=fd;function Ai(r,e){var t={seen:[],stylize:F0};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),em(e)?t.showHidden=e:e&&Q0(t,e),ys(t.showHidden)&&(t.showHidden=!1),ys(t.depth)&&(t.depth=2),ys(t.colors)&&(t.colors=!1),ys(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=U0),mc(t,r,t.depth)}Ai.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Ai.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function U0(r,e){var t=Ai.styles[e];return t?"\x1B["+Ai.colors[t][0]+"m"+r+"\x1B["+Ai.colors[t][1]+"m":r}function F0(r,e){return r}function j0(r){var e={};return r.forEach(function(t,n){e[t]=!0}),e}function mc(r,e,t){if(r.customInspect&&e&&Bo(e.inspect)&&e.inspect!==Ai&&!(e.constructor&&e.constructor.prototype===e)){var n=e.inspect(t,r);return nm(n)||(n=mc(r,n,t)),n}var i=q0(r,e);if(i)return i;var s=Object.keys(e),o=j0(s);if(r.showHidden&&(s=Object.getOwnPropertyNames(e)),rc(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return El(e);if(s.length===0){if(Bo(e)){var a=e.name?": "+e.name:"";return r.stylize("[Function"+a+"]","special")}if(Oo(e))return r.stylize(RegExp.prototype.toString.call(e),"regexp");if(bc(e))return r.stylize(Date.prototype.toString.call(e),"date");if(rc(e))return El(e)}var c="",l=!1,u=["{","}"];if(Y0(e)&&(l=!0,u=["[","]"]),Bo(e)){var f=e.name?": "+e.name:"";c=" [Function"+f+"]"}if(Oo(e)&&(c=" "+RegExp.prototype.toString.call(e)),bc(e)&&(c=" "+Date.prototype.toUTCString.call(e)),rc(e)&&(c=" "+El(e)),s.length===0&&(!l||e.length==0))return u[0]+c+u[1];if(t<0)return Oo(e)?r.stylize(RegExp.prototype.toString.call(e),"regexp"):r.stylize("[Object]","special");r.seen.push(e);var m;return l?m=G0(r,e,t,o,s):m=s.map(function(y){return hd(r,e,t,o,y,l)}),r.seen.pop(),H0(m,c,u)}function q0(r,e){if(ys(e))return r.stylize("undefined","undefined");if(nm(e)){var t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(t,"string")}if(J0(e))return r.stylize(""+e,"number");if(em(e))return r.stylize(""+e,"boolean");if(tm(e))return r.stylize("null","null")}function El(r){return"["+Error.prototype.toString.call(r)+"]"}function G0(r,e,t,n,i){for(var s=[],o=0,a=e.length;o<a;++o)rm(e,String(o))?s.push(hd(r,e,t,n,String(o),!0)):s.push("");return i.forEach(function(c){c.match(/^\d+$/)||s.push(hd(r,e,t,n,c,!0))}),s}function hd(r,e,t,n,i,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},c.get?c.set?a=r.stylize("[Getter/Setter]","special"):a=r.stylize("[Getter]","special"):c.set&&(a=r.stylize("[Setter]","special")),rm(n,i)||(o="["+i+"]"),a||(r.seen.indexOf(c.value)<0?(tm(t)?a=mc(r,c.value,null):a=mc(r,c.value,t-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(l){return"  "+l}).join(`
`).substr(2):a=`
`+a.split(`
`).map(function(l){return"   "+l}).join(`
`))):a=r.stylize("[Circular]","special")),ys(o)){if(s&&i.match(/^\d+$/))return a;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=r.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=r.stylize(o,"string"))}return o+": "+a}function H0(r,e,t){var n=r.reduce(function(i,s){return s.indexOf(`
`)>=0,i+s.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?t[0]+(e===""?"":e+`
 `)+" "+r.join(`,
  `)+" "+t[1]:t[0]+e+" "+r.join(", ")+" "+t[1]}function Y0(r){return Array.isArray(r)}function em(r){return typeof r=="boolean"}function tm(r){return r===null}function J0(r){return typeof r=="number"}function nm(r){return typeof r=="string"}function ys(r){return r===void 0}function Oo(r){return wu(r)&&Pf(r)==="[object RegExp]"}function wu(r){return typeof r=="object"&&r!==null}function bc(r){return wu(r)&&Pf(r)==="[object Date]"}function rc(r){return wu(r)&&(Pf(r)==="[object Error]"||r instanceof Error)}function Bo(r){return typeof r=="function"}function Xh(r){return r===null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||typeof r=="symbol"||typeof r>"u"}function Pf(r){return Object.prototype.toString.call(r)}function Q0(r,e){if(!e||!wu(e))return r;for(var t=Object.keys(e),n=t.length;n--;)r[t[n]]=e[t[n]];return r}function rm(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Zh(r,e){if(r===e)return 0;for(var t=r.length,n=e.length,i=0,s=Math.min(t,n);i<s;++i)if(r[i]!==e[i]){t=r[i],n=e[i];break}return t<n?-1:n<t?1:0}var X0=Object.prototype.hasOwnProperty,ep=Object.keys||function(r){var e=[];for(var t in r)X0.call(r,t)&&e.push(t);return e},tp=Array.prototype.slice,Pl;function im(){return typeof Pl<"u"?Pl:Pl=function(){return function(){}.name==="foo"}()}function np(r){return Object.prototype.toString.call(r)}function rp(r){return je.isBuffer(r)||typeof W0.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r?!!(r instanceof DataView||r.buffer&&r.buffer instanceof ArrayBuffer):!1}function Zt(r,e){r||kn(r,!0,e,"==",Tf)}var Z0=/\s*function\s+([^\(\s]*)\s*/;function sm(r){if(!!Bo(r)){if(im())return r.name;var e=r.toString(),t=e.match(Z0);return t&&t[1]}}Zt.AssertionError=Rf;function Rf(r){this.name="AssertionError",this.actual=r.actual,this.expected=r.expected,this.operator=r.operator,r.message?(this.message=r.message,this.generatedMessage=!1):(this.message=eI(this),this.generatedMessage=!0);var e=r.stackStartFunction||kn;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var t=new Error;if(t.stack){var n=t.stack,i=sm(e),s=n.indexOf(`
`+i);if(s>=0){var o=n.indexOf(`
`,s+1);n=n.substring(o+1)}this.stack=n}}}V0(Rf,Error);function ip(r,e){return typeof r=="string"?r.length<e?r:r.slice(0,e):r}function sp(r){if(im()||!Bo(r))return Ai(r);var e=sm(r),t=e?": "+e:"";return"[Function"+t+"]"}function eI(r){return ip(sp(r.actual),128)+" "+r.operator+" "+ip(sp(r.expected),128)}function kn(r,e,t,n,i){throw new Rf({message:t,actual:r,expected:e,operator:n,stackStartFunction:i})}Zt.fail=kn;function Tf(r,e){r||kn(r,!0,e,"==",Tf)}Zt.ok=Tf;Zt.equal=om;function om(r,e,t){r!=e&&kn(r,e,t,"==",om)}Zt.notEqual=am;function am(r,e,t){r==e&&kn(r,e,t,"!=",am)}Zt.deepEqual=cm;function cm(r,e,t){Ks(r,e,!1)||kn(r,e,t,"deepEqual",cm)}Zt.deepStrictEqual=um;function um(r,e,t){Ks(r,e,!0)||kn(r,e,t,"deepStrictEqual",um)}function Ks(r,e,t,n){if(r===e)return!0;if(je.isBuffer(r)&&je.isBuffer(e))return Zh(r,e)===0;if(bc(r)&&bc(e))return r.getTime()===e.getTime();if(Oo(r)&&Oo(e))return r.source===e.source&&r.global===e.global&&r.multiline===e.multiline&&r.lastIndex===e.lastIndex&&r.ignoreCase===e.ignoreCase;if((r===null||typeof r!="object")&&(e===null||typeof e!="object"))return t?r===e:r==e;if(rp(r)&&rp(e)&&np(r)===np(e)&&!(r instanceof Float32Array||r instanceof Float64Array))return Zh(new Uint8Array(r.buffer),new Uint8Array(e.buffer))===0;if(je.isBuffer(r)!==je.isBuffer(e))return!1;n=n||{actual:[],expected:[]};var i=n.actual.indexOf(r);return i!==-1&&i===n.expected.indexOf(e)?!0:(n.actual.push(r),n.expected.push(e),tI(r,e,t,n))}function op(r){return Object.prototype.toString.call(r)=="[object Arguments]"}function tI(r,e,t,n){if(r==null||e===null||e===void 0)return!1;if(Xh(r)||Xh(e))return r===e;if(t&&Object.getPrototypeOf(r)!==Object.getPrototypeOf(e))return!1;var i=op(r),s=op(e);if(i&&!s||!i&&s)return!1;if(i)return r=tp.call(r),e=tp.call(e),Ks(r,e,t);var o=ep(r),a=ep(e),c,l;if(o.length!==a.length)return!1;for(o.sort(),a.sort(),l=o.length-1;l>=0;l--)if(o[l]!==a[l])return!1;for(l=o.length-1;l>=0;l--)if(c=o[l],!Ks(r[c],e[c],t,n))return!1;return!0}Zt.notDeepEqual=lm;function lm(r,e,t){Ks(r,e,!1)&&kn(r,e,t,"notDeepEqual",lm)}Zt.notDeepStrictEqual=dm;function dm(r,e,t){Ks(r,e,!0)&&kn(r,e,t,"notDeepStrictEqual",dm)}Zt.strictEqual=fm;function fm(r,e,t){r!==e&&kn(r,e,t,"===",fm)}Zt.notStrictEqual=hm;function hm(r,e,t){r===e&&kn(r,e,t,"!==",hm)}function ap(r,e){if(!r||!e)return!1;if(Object.prototype.toString.call(e)=="[object RegExp]")return e.test(r);try{if(r instanceof e)return!0}catch{}return Error.isPrototypeOf(e)?!1:e.call({},r)===!0}function nI(r){var e;try{r()}catch(t){e=t}return e}function pm(r,e,t,n){var i;if(typeof e!="function")throw new TypeError('"block" argument must be a function');typeof t=="string"&&(n=t,t=null),i=nI(e),n=(t&&t.name?" ("+t.name+").":".")+(n?" "+n:"."),r&&!i&&kn(i,t,"Missing expected exception"+n);var s=typeof n=="string",o=!r&&rc(i),a=!r&&i&&!t;if((o&&s&&ap(i,t)||a)&&kn(i,t,"Got unwanted exception"+n),r&&i&&t&&!ap(i,t)||!r&&i)throw i}Zt.throws=rI;function rI(r,e,t){pm(!0,r,e,t)}Zt.doesNotThrow=iI;function iI(r,e,t){pm(!1,r,e,t)}Zt.ifError=sI;function sI(r){if(r)throw r}class Yo{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}decode(e,t){throw new Error("Layout is abstract")}encode(e,t,n){throw new Error("Layout is abstract")}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}function oI(r,e){return e.property?r+"["+e.property+"]":r}class xa extends Yo{isCount(){throw new Error("ExternalLayout is abstract")}}class ym extends Yo{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntLE(t,this.span)}encode(e,t,n){return n===void 0&&(n=0),t.writeUIntLE(e,n,this.span),this.span}}class aI extends Yo{constructor(e,t,n){if(!(Array.isArray(e)&&e.reduce((s,o)=>s&&o instanceof Yo,!0)))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&n===void 0&&(n=t,t=void 0);for(const s of e)if(0>s.span&&s.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let i=-1;try{i=e.reduce((s,o)=>s+o.getSpan(),0)}catch{}super(i,t),this.fields=e,this.decodePrefixes=!!n}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let n=0;try{n=this.fields.reduce((i,s)=>{const o=s.getSpan(e,t);return t+=o,i+o},0)}catch{throw new RangeError("indeterminate span")}return n}decode(e,t){t===void 0&&(t=0);const n=this.makeDestinationObject();for(const i of this.fields)if(i.property!==void 0&&(n[i.property]=i.decode(e,t)),t+=i.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return n}encode(e,t,n){n===void 0&&(n=0);const i=n;let s=0,o=0;for(const a of this.fields){let c=a.span;if(o=0<c?c:0,a.property!==void 0){const l=e[a.property];l!==void 0&&(o=a.encode(l,t,n),0>c&&(c=a.getSpan(t,n)))}s=n,n+=c}return s+o-i}fromArray(e){const t=this.makeDestinationObject();for(const n of this.fields)n.property!==void 0&&0<e.length&&(t[n.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const n of this.fields){if(n.property===e)return t;0>n.span?t=-1:0<=t&&(t+=n.span)}}}class cI extends Yo{constructor(e,t){if(!(e instanceof xa&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;e instanceof xa||(n=e),super(n,t),this.length=e}getSpan(e,t){let n=this.span;return 0>n&&(n=this.length.decode(e,t)),n}decode(e,t){t===void 0&&(t=0);let n=this.span;return 0>n&&(n=this.length.decode(e,t)),e.slice(t,t+n)}encode(e,t,n){let i=this.length;if(this.length instanceof xa&&(i=e.length),!(je.Buffer.isBuffer(e)&&i===e.length))throw new TypeError(oI("Blob.encode",this)+" requires (length "+i+") Buffer as src");if(n+i>t.length)throw new RangeError("encoding overruns Buffer");return t.write(e.toString("hex"),n,i,"hex"),this.length instanceof xa&&this.length.encode(i,t,n),i}}var $e=r=>new ym(1,r),xo=r=>new ym(4,r),_t=(r,e,t)=>new aI(r,e,t),gm=(r,e)=>new cI(r,e);const At=(r="publicKey")=>gm(32,r),Dn=(r="uint64")=>gm(8,r);function Bt(r,e,t,...n){return a0(e,t,n,{skipPreflight:!1})}const uI=new ue("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),mm=new ue("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"),cp="Failed to find account",up="Invalid account owner";function Rl(r){return je.Buffer.from(r.toBuffer())}class Jt extends Qn{toBuffer(){const e=super.toArray().reverse(),t=je.Buffer.from(e);if(t.length===8)return t;Zt(t.length<8,"u64 too large");const n=je.Buffer.alloc(8);return t.copy(n),n}static fromBuffer(e){return Zt(e.length===8,`Invalid buffer length: ${e.length}`),new Jt([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}function An(r){return"publicKey"in r}const lI={MintTokens:0,FreezeAccount:1,AccountOwner:2,CloseAccount:3},bm=new ue("So11111111111111111111111111111111111111112"),Ao=_t([xo("mintAuthorityOption"),At("mintAuthority"),Dn("supply"),$e("decimals"),$e("isInitialized"),xo("freezeAuthorityOption"),At("freezeAuthority")]),cs=_t([At("mint"),At("owner"),Dn("amount"),xo("delegateOption"),At("delegate"),$e("state"),xo("isNativeOption"),Dn("isNative"),Dn("delegatedAmount"),xo("closeAuthorityOption"),At("closeAuthority")]),Ca=_t([$e("m"),$e("n"),$e("is_initialized"),At("signer1"),At("signer2"),At("signer3"),At("signer4"),At("signer5"),At("signer6"),At("signer7"),At("signer8"),At("signer9"),At("signer10"),At("signer11")]);class nt{constructor(e,t,n,i){ho(this,"connection",void 0),ho(this,"publicKey",void 0),ho(this,"programId",void 0),ho(this,"associatedProgramId",void 0),ho(this,"payer",void 0),Object.assign(this,{connection:e,publicKey:t,programId:n,payer:i,associatedProgramId:mm})}static async getMinBalanceRentForExemptMint(e){return await e.getMinimumBalanceForRentExemption(Ao.span)}static async getMinBalanceRentForExemptAccount(e){return await e.getMinimumBalanceForRentExemption(cs.span)}static async getMinBalanceRentForExemptMultisig(e){return await e.getMinimumBalanceForRentExemption(Ca.span)}static async createMint(e,t,n,i,s,o){const a=jr.generate(),c=new nt(e,a.publicKey,o,t),l=await nt.getMinBalanceRentForExemptMint(e),u=new yt;return u.add(lr.createAccount({fromPubkey:t.publicKey,newAccountPubkey:a.publicKey,lamports:l,space:Ao.span,programId:o})),u.add(nt.createInitMintInstruction(o,a.publicKey,s,n,i)),await Bt("createAccount and InitializeMint",e,u,t,a),c}async createAccount(e){const t=await nt.getMinBalanceRentForExemptAccount(this.connection),n=jr.generate(),i=new yt;i.add(lr.createAccount({fromPubkey:this.payer.publicKey,newAccountPubkey:n.publicKey,lamports:t,space:cs.span,programId:this.programId}));const s=this.publicKey;return i.add(nt.createInitAccountInstruction(this.programId,s,n.publicKey,e)),await Bt("createAccount and InitializeAccount",this.connection,i,this.payer,n),n.publicKey}async createAssociatedTokenAccount(e){const t=await nt.getAssociatedTokenAddress(this.associatedProgramId,this.programId,this.publicKey,e);return this.createAssociatedTokenAccountInternal(e,t)}async createAssociatedTokenAccountInternal(e,t){return await Bt("CreateAssociatedTokenAccount",this.connection,new yt().add(nt.createAssociatedTokenAccountInstruction(this.associatedProgramId,this.programId,this.publicKey,t,e,this.payer.publicKey)),this.payer),t}async getOrCreateAssociatedAccountInfo(e){const t=await nt.getAssociatedTokenAddress(this.associatedProgramId,this.programId,this.publicKey,e);try{return await this.getAccountInfo(t)}catch(n){if(n.message===cp||n.message===up){try{await this.createAssociatedTokenAccountInternal(e,t)}catch{}return await this.getAccountInfo(t)}else throw n}}static async createWrappedNativeAccount(e,t,n,i,s){const o=await nt.getMinBalanceRentForExemptAccount(e),a=jr.generate(),c=new yt;return c.add(lr.createAccount({fromPubkey:i.publicKey,newAccountPubkey:a.publicKey,lamports:o,space:cs.span,programId:t})),c.add(lr.transfer({fromPubkey:i.publicKey,toPubkey:a.publicKey,lamports:s})),c.add(nt.createInitAccountInstruction(t,bm,a.publicKey,n)),await Bt("createAccount, transfer, and initializeAccount",e,c,i,a),a.publicKey}async createMultisig(e,t){const n=jr.generate(),i=await nt.getMinBalanceRentForExemptMultisig(this.connection),s=new yt;s.add(lr.createAccount({fromPubkey:this.payer.publicKey,newAccountPubkey:n.publicKey,lamports:i,space:Ca.span,programId:this.programId}));let o=[{pubkey:n.publicKey,isSigner:!1,isWritable:!0},{pubkey:ps,isSigner:!1,isWritable:!1}];t.forEach(l=>o.push({pubkey:l,isSigner:!1,isWritable:!1}));const a=_t([$e("instruction"),$e("m")]),c=je.Buffer.alloc(a.span);return a.encode({instruction:2,m:e},c),s.add({keys:o,programId:this.programId,data:c}),await Bt("createAccount and InitializeMultisig",this.connection,s,this.payer,n),n.publicKey}async getMintInfo(){const e=await this.connection.getAccountInfo(this.publicKey);if(e===null)throw new Error("Failed to find mint account");if(!e.owner.equals(this.programId))throw new Error(`Invalid mint owner: ${JSON.stringify(e.owner)}`);if(e.data.length!=Ao.span)throw new Error("Invalid mint size");const t=je.Buffer.from(e.data),n=Ao.decode(t);return n.mintAuthorityOption===0?n.mintAuthority=null:n.mintAuthority=new ue(n.mintAuthority),n.supply=Jt.fromBuffer(n.supply),n.isInitialized=n.isInitialized!=0,n.freezeAuthorityOption===0?n.freezeAuthority=null:n.freezeAuthority=new ue(n.freezeAuthority),n}async getAccountInfo(e,t){const n=await this.connection.getAccountInfo(e,t);if(n===null)throw new Error(cp);if(!n.owner.equals(this.programId))throw new Error(up);if(n.data.length!=cs.span)throw new Error("Invalid account size");const i=je.Buffer.from(n.data),s=cs.decode(i);if(s.address=e,s.mint=new ue(s.mint),s.owner=new ue(s.owner),s.amount=Jt.fromBuffer(s.amount),s.delegateOption===0?(s.delegate=null,s.delegatedAmount=new Jt):(s.delegate=new ue(s.delegate),s.delegatedAmount=Jt.fromBuffer(s.delegatedAmount)),s.isInitialized=s.state!==0,s.isFrozen=s.state===2,s.isNativeOption===1?(s.rentExemptReserve=Jt.fromBuffer(s.isNative),s.isNative=!0):(s.rentExemptReserve=null,s.isNative=!1),s.closeAuthorityOption===0?s.closeAuthority=null:s.closeAuthority=new ue(s.closeAuthority),!s.mint.equals(this.publicKey))throw new Error(`Invalid account mint: ${JSON.stringify(s.mint)} !== ${JSON.stringify(this.publicKey)}`);return s}async getMultisigInfo(e){const t=await this.connection.getAccountInfo(e);if(t===null)throw new Error("Failed to find multisig");if(!t.owner.equals(this.programId))throw new Error("Invalid multisig owner");if(t.data.length!=Ca.span)throw new Error("Invalid multisig size");const n=je.Buffer.from(t.data),i=Ca.decode(n);return i.signer1=new ue(i.signer1),i.signer2=new ue(i.signer2),i.signer3=new ue(i.signer3),i.signer4=new ue(i.signer4),i.signer5=new ue(i.signer5),i.signer6=new ue(i.signer6),i.signer7=new ue(i.signer7),i.signer8=new ue(i.signer8),i.signer9=new ue(i.signer9),i.signer10=new ue(i.signer10),i.signer11=new ue(i.signer11),i}async transfer(e,t,n,i,s){let o,a;return An(n)?(o=n.publicKey,a=[n]):(o=n,a=i),await Bt("Transfer",this.connection,new yt().add(nt.createTransferInstruction(this.programId,e,t,o,i,s)),this.payer,...a)}async approve(e,t,n,i,s){let o,a;An(n)?(o=n.publicKey,a=[n]):(o=n,a=i),await Bt("Approve",this.connection,new yt().add(nt.createApproveInstruction(this.programId,e,t,o,i,s)),this.payer,...a)}async revoke(e,t,n){let i,s;An(t)?(i=t.publicKey,s=[t]):(i=t,s=n),await Bt("Revoke",this.connection,new yt().add(nt.createRevokeInstruction(this.programId,e,i,n)),this.payer,...s)}async setAuthority(e,t,n,i,s){let o,a;An(i)?(o=i.publicKey,a=[i]):(o=i,a=s),await Bt("SetAuthority",this.connection,new yt().add(nt.createSetAuthorityInstruction(this.programId,e,t,n,o,s)),this.payer,...a)}async mintTo(e,t,n,i){let s,o;An(t)?(s=t.publicKey,o=[t]):(s=t,o=n),await Bt("MintTo",this.connection,new yt().add(nt.createMintToInstruction(this.programId,this.publicKey,e,s,n,i)),this.payer,...o)}async burn(e,t,n,i){let s,o;An(t)?(s=t.publicKey,o=[t]):(s=t,o=n),await Bt("Burn",this.connection,new yt().add(nt.createBurnInstruction(this.programId,this.publicKey,e,s,n,i)),this.payer,...o)}async closeAccount(e,t,n,i){let s,o;An(n)?(s=n.publicKey,o=[n]):(s=n,o=i),await Bt("CloseAccount",this.connection,new yt().add(nt.createCloseAccountInstruction(this.programId,e,t,s,i)),this.payer,...o)}async freezeAccount(e,t,n){let i,s;An(t)?(i=t.publicKey,s=[t]):(i=t,s=n),await Bt("FreezeAccount",this.connection,new yt().add(nt.createFreezeAccountInstruction(this.programId,e,this.publicKey,i,n)),this.payer,...s)}async thawAccount(e,t,n){let i,s;An(t)?(i=t.publicKey,s=[t]):(i=t,s=n),await Bt("ThawAccount",this.connection,new yt().add(nt.createThawAccountInstruction(this.programId,e,this.publicKey,i,n)),this.payer,...s)}async transferChecked(e,t,n,i,s,o){let a,c;return An(n)?(a=n.publicKey,c=[n]):(a=n,c=i),await Bt("TransferChecked",this.connection,new yt().add(nt.createTransferCheckedInstruction(this.programId,e,this.publicKey,t,a,i,s,o)),this.payer,...c)}async approveChecked(e,t,n,i,s,o){let a,c;An(n)?(a=n.publicKey,c=[n]):(a=n,c=i),await Bt("ApproveChecked",this.connection,new yt().add(nt.createApproveCheckedInstruction(this.programId,e,this.publicKey,t,a,i,s,o)),this.payer,...c)}async mintToChecked(e,t,n,i,s){let o,a;An(t)?(o=t.publicKey,a=[t]):(o=t,a=n),await Bt("MintToChecked",this.connection,new yt().add(nt.createMintToCheckedInstruction(this.programId,this.publicKey,e,o,n,i,s)),this.payer,...a)}async burnChecked(e,t,n,i,s){let o,a;An(t)?(o=t.publicKey,a=[t]):(o=t,a=n),await Bt("BurnChecked",this.connection,new yt().add(nt.createBurnCheckedInstruction(this.programId,this.publicKey,e,o,n,i,s)),this.payer,...a)}async syncNative(e){await Bt("SyncNative",this.connection,new yt().add(nt.createSyncNativeInstruction(this.programId,e)),this.payer)}static createInitMintInstruction(e,t,n,i,s){let o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:ps,isSigner:!1,isWritable:!1}];const a=_t([$e("instruction"),$e("decimals"),At("mintAuthority"),$e("option"),At("freezeAuthority")]);let c=je.Buffer.alloc(1024);{const l=a.encode({instruction:0,decimals:n,mintAuthority:Rl(i),option:s===null?0:1,freezeAuthority:Rl(s||new ue(0))},c);c=c.slice(0,l)}return new Xe({keys:o,programId:e,data:c})}static createInitAccountInstruction(e,t,n,i){const s=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:ps,isSigner:!1,isWritable:!1}],o=_t([$e("instruction")]),a=je.Buffer.alloc(o.span);return o.encode({instruction:1},a),new Xe({keys:s,programId:e,data:a})}static createTransferInstruction(e,t,n,i,s,o){const a=_t([$e("instruction"),Dn("amount")]),c=je.Buffer.alloc(a.span);a.encode({instruction:3,amount:new Jt(o).toBuffer()},c);let l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0}];return s.length===0?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new Xe({keys:l,programId:e,data:c})}static createApproveInstruction(e,t,n,i,s,o){const a=_t([$e("instruction"),Dn("amount")]),c=je.Buffer.alloc(a.span);a.encode({instruction:4,amount:new Jt(o).toBuffer()},c);let l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1}];return s.length===0?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new Xe({keys:l,programId:e,data:c})}static createRevokeInstruction(e,t,n,i){const s=_t([$e("instruction")]),o=je.Buffer.alloc(s.span);s.encode({instruction:5},o);let a=[{pubkey:t,isSigner:!1,isWritable:!0}];return i.length===0?a.push({pubkey:n,isSigner:!0,isWritable:!1}):(a.push({pubkey:n,isSigner:!1,isWritable:!1}),i.forEach(c=>a.push({pubkey:c.publicKey,isSigner:!0,isWritable:!1}))),new Xe({keys:a,programId:e,data:o})}static createSetAuthorityInstruction(e,t,n,i,s,o){const a=_t([$e("instruction"),$e("authorityType"),$e("option"),At("newAuthority")]);let c=je.Buffer.alloc(1024);{const u=a.encode({instruction:6,authorityType:lI[i],option:n===null?0:1,newAuthority:Rl(n||new ue(0))},c);c=c.slice(0,u)}let l=[{pubkey:t,isSigner:!1,isWritable:!0}];return o.length===0?l.push({pubkey:s,isSigner:!0,isWritable:!1}):(l.push({pubkey:s,isSigner:!1,isWritable:!1}),o.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new Xe({keys:l,programId:e,data:c})}static createMintToInstruction(e,t,n,i,s,o){const a=_t([$e("instruction"),Dn("amount")]),c=je.Buffer.alloc(a.span);a.encode({instruction:7,amount:new Jt(o).toBuffer()},c);let l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0}];return s.length===0?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new Xe({keys:l,programId:e,data:c})}static createBurnInstruction(e,t,n,i,s,o){const a=_t([$e("instruction"),Dn("amount")]),c=je.Buffer.alloc(a.span);a.encode({instruction:8,amount:new Jt(o).toBuffer()},c);let l=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}];return s.length===0?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new Xe({keys:l,programId:e,data:c})}static createCloseAccountInstruction(e,t,n,i,s){const o=_t([$e("instruction")]),a=je.Buffer.alloc(o.span);o.encode({instruction:9},a);let c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0}];return s.length===0?c.push({pubkey:i,isSigner:!0,isWritable:!1}):(c.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(l=>c.push({pubkey:l.publicKey,isSigner:!0,isWritable:!1}))),new Xe({keys:c,programId:e,data:a})}static createFreezeAccountInstruction(e,t,n,i,s){const o=_t([$e("instruction")]),a=je.Buffer.alloc(o.span);o.encode({instruction:10},a);let c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1}];return s.length===0?c.push({pubkey:i,isSigner:!0,isWritable:!1}):(c.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(l=>c.push({pubkey:l.publicKey,isSigner:!0,isWritable:!1}))),new Xe({keys:c,programId:e,data:a})}static createThawAccountInstruction(e,t,n,i,s){const o=_t([$e("instruction")]),a=je.Buffer.alloc(o.span);o.encode({instruction:11},a);let c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1}];return s.length===0?c.push({pubkey:i,isSigner:!0,isWritable:!1}):(c.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(l=>c.push({pubkey:l.publicKey,isSigner:!0,isWritable:!1}))),new Xe({keys:c,programId:e,data:a})}static createTransferCheckedInstruction(e,t,n,i,s,o,a,c){const l=_t([$e("instruction"),Dn("amount"),$e("decimals")]),u=je.Buffer.alloc(l.span);l.encode({instruction:12,amount:new Jt(a).toBuffer(),decimals:c},u);let f=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0}];return o.length===0?f.push({pubkey:s,isSigner:!0,isWritable:!1}):(f.push({pubkey:s,isSigner:!1,isWritable:!1}),o.forEach(m=>f.push({pubkey:m.publicKey,isSigner:!0,isWritable:!1}))),new Xe({keys:f,programId:e,data:u})}static createApproveCheckedInstruction(e,t,n,i,s,o,a,c){const l=_t([$e("instruction"),Dn("amount"),$e("decimals")]),u=je.Buffer.alloc(l.span);l.encode({instruction:13,amount:new Jt(a).toBuffer(),decimals:c},u);let f=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1}];return o.length===0?f.push({pubkey:s,isSigner:!0,isWritable:!1}):(f.push({pubkey:s,isSigner:!1,isWritable:!1}),o.forEach(m=>f.push({pubkey:m.publicKey,isSigner:!0,isWritable:!1}))),new Xe({keys:f,programId:e,data:u})}static createMintToCheckedInstruction(e,t,n,i,s,o,a){const c=_t([$e("instruction"),Dn("amount"),$e("decimals")]),l=je.Buffer.alloc(c.span);c.encode({instruction:14,amount:new Jt(o).toBuffer(),decimals:a},l);let u=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0}];return s.length===0?u.push({pubkey:i,isSigner:!0,isWritable:!1}):(u.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(f=>u.push({pubkey:f.publicKey,isSigner:!0,isWritable:!1}))),new Xe({keys:u,programId:e,data:l})}static createBurnCheckedInstruction(e,t,n,i,s,o,a){const c=_t([$e("instruction"),Dn("amount"),$e("decimals")]),l=je.Buffer.alloc(c.span);c.encode({instruction:15,amount:new Jt(o).toBuffer(),decimals:a},l);let u=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}];return s.length===0?u.push({pubkey:i,isSigner:!0,isWritable:!1}):(u.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(f=>u.push({pubkey:f.publicKey,isSigner:!0,isWritable:!1}))),new Xe({keys:u,programId:e,data:l})}static createSyncNativeInstruction(e,t){const n=_t([$e("instruction")]),i=je.Buffer.alloc(n.span);n.encode({instruction:17},i);let s=[{pubkey:t,isSigner:!1,isWritable:!0}];return new Xe({keys:s,programId:e,data:i})}static async getAssociatedTokenAddress(e,t,n,i,s=!1){if(!s&&!ue.isOnCurve(i.toBuffer()))throw new Error(`Owner cannot sign: ${i.toString()}`);return(await ue.findProgramAddress([i.toBuffer(),t.toBuffer(),n.toBuffer()],e))[0]}static createAssociatedTokenAccountInstruction(e,t,n,i,s,o){const a=je.Buffer.alloc(0);let c=[{pubkey:o,isSigner:!0,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:lr.programId,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:ps,isSigner:!1,isWritable:!1}];return new Xe({keys:c,programId:e,data:a})}}var dI=Object.freeze(Object.defineProperty({__proto__:null,ASSOCIATED_TOKEN_PROGRAM_ID:mm,AccountLayout:cs,MintLayout:Ao,NATIVE_MINT:bm,TOKEN_PROGRAM_ID:uI,Token:nt,u64:Jt},Symbol.toStringTag,{value:"Module"})),da=Hs(dI),ku=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(xt,"__esModule",{value:!0});xt.getAccountInfo=xt.getTokenAccount=xt.getAssociatedTokenAddress=xt.convertFactionStringToNum=xt.longToByteArray=xt.byteArrayToLong=xt.stringToByteArray=xt.byteArrayToString=void 0;const Ma=sn,La=et,ic=Lr,ar=da;function fI(r){return String.fromCharCode(...r)}xt.byteArrayToString=fI;function hI(r,e){if(r.length>e)return null;let t=[];for(let n=0;n<e;n+=1){let i=32;n<r.length&&(i=r.charCodeAt(n)),t=t.concat([i])}return t}xt.stringToByteArray=hI;function pI(r){let e=0;for(let t=r.length-1;t>=0;t-=1)e=e*256+r[t];return e}xt.byteArrayToLong=pI;function yI(r){const e=[0,0,0,0,0,0,0,0];for(let t=0;t<e.length;t+=1){const n=r&255;e[t]=n,r=(r-n)/256}return e}xt.longToByteArray=yI;function gI(r){return ku(this,void 0,void 0,function*(){switch(r.toLowerCase()){case"mud":return Ma.FactionType.MUD;case"oni":return Ma.FactionType.ONI;case"ustur":return Ma.FactionType.Ustur;default:return Ma.FactionType.Unenlisted}})}xt.convertFactionStringToNum=gI;function wm(r,e){return ku(this,void 0,void 0,function*(){const[t]=yield ic.PublicKey.findProgramAddress([r.toBuffer(),ar.TOKEN_PROGRAM_ID.toBuffer(),e.toBuffer()],ar.ASSOCIATED_TOKEN_PROGRAM_ID);return t})}xt.getAssociatedTokenAddress=wm;function mI(r,e,t,n=e,i){return ku(this,void 0,void 0,function*(){const{value:s}=yield r.getParsedTokenAccountsByOwner(e,{mint:t});let o=null;if(i===void 0){let a=null;for(const c of s)if(c.account.data.parsed.type==="account"){const l=c.account.data.parsed,u=new La.BN(l.info.tokenAmount.amount);(a===null||u.gt(a))&&(o=c.pubkey,a=u)}}else{let a=null;for(const c of s)if(c.account.data.parsed.type==="account"){const l=c.account.data.parsed,u=new La.BN(l.info.tokenAmount.amount);u.gt(new La.BN(i))&&(a===null||u.lt(a))&&(o=c.pubkey,a=u)}}if(o===null){const a=yield wm(e,t),{value:c}=yield r.getParsedAccountInfo(a,"confirmed");if(c===null||c.owner.equals(ic.SystemProgram.programId))return{tokenAccount:a,createInstruction:[ar.Token.createAssociatedTokenAccountInstruction(ar.ASSOCIATED_TOKEN_PROGRAM_ID,ar.TOKEN_PROGRAM_ID,t,a,e,n)]};if("program"in c.data&&c.data.parsed.type==="account"&&new ic.PublicKey(c.data.parsed.info.owner).equals(e))return{tokenAccount:a};{const l=La.web3.Keypair.generate();return{tokenAccount:l,createInstruction:[ic.SystemProgram.createAccount({fromPubkey:n,newAccountPubkey:l.publicKey,lamports:yield ar.Token.getMinBalanceRentForExemptAccount(r),space:ar.AccountLayout.span,programId:ar.TOKEN_PROGRAM_ID}),ar.Token.createInitAccountInstruction(ar.TOKEN_PROGRAM_ID,t,l.publicKey,e)]}}}else return{tokenAccount:o}})}xt.getTokenAccount=mI;function bI(r,e){return ku(this,void 0,void 0,function*(){const{value:t}=yield r.getParsedAccountInfo(e);return t.data})}xt.getAccountInfo=bI;var Su={},wI=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Su,"__esModule",{value:!0});Su.sendAndConfirmTransaction=void 0;const kI=Lr;function SI(r,e,...t){return wI(this,void 0,void 0,function*(){let n="";try{n=yield(0,kI.sendAndConfirmTransaction)(r,e,t,{skipPreflight:!0,commitment:"singleGossip",preflightCommitment:null})}catch(i){console.log(i)}return n})}Su.sendAndConfirmTransaction=SI;var xi={},Of={},Bf={},km={};Object.defineProperty(km,"__esModule",{value:!0});var vu={},ai={},Xt={},Gn={},fa={};Object.defineProperty(fa,"__esModule",{value:!0});fa.baseIdl=void 0;fa.baseIdl={version:"0.1.0",name:"marketplace",instructions:[{name:"addRoyaltyTier",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"RegisteredCurrency",path:"registered_currency.token_mint"}]}}],args:[{name:"stakeAmount",type:"u64"},{name:"discount",type:"u64"}]},{name:"deleteRoyaltyTier",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"RegisteredCurrency",path:"registered_currency.token_mint"}]}}],args:[{name:"stakeAmount",type:"u64"}]},{name:"deregisterCurrency",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"initializeMarketplace",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"registerCurrency",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"saCurrencyVault",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"royalty",type:"u64"}]},{name:"updateCurrencyVault",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"saCurrencyVault",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"updateCurrencyRoyalty",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"royalty",type:"u64"}]},{name:"updateRoyaltyTier",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"RegisteredCurrency",path:"registered_currency.token_mint"}]}}],args:[{name:"stakeAmount",type:"u64"},{name:"discount",type:"u64"}]},{name:"addFeeExemption",accounts:[{name:"updateAuthorityMaster",isMut:!1,isSigner:!0},{name:"funder",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1},{name:"feeExemptTarget",isMut:!1,isSigner:!1},{name:"feeExemptAccount",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"discount",type:"u64"}]},{name:"removeFeeExemption",accounts:[{name:"updateAuthorityMaster",isMut:!1,isSigner:!0},{name:"funder",isMut:!0,isSigner:!1},{name:"marketVarsAccount",isMut:!1,isSigner:!1},{name:"feeExemptAccount",isMut:!0,isSigner:!1}],args:[]},{name:"processInitializeBuy",accounts:[{name:"orderInitializer",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"depositMint",isMut:!1,isSigner:!1},{name:"receiveMint",isMut:!1,isSigner:!1},{name:"orderVaultAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-account"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"orderVaultAuthority",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-auth"},{kind:"account",type:"publicKey",path:"order_initializer"}]}},{name:"initializerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"initializerReceiveTokenAccount",isMut:!0,isSigner:!1},{name:"orderAccount",isMut:!0,isSigner:!1},{name:"registeredCurrency",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"openOrdersCounter",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"open-orders-counter"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"price",type:"u64"},{name:"originationQty",type:"u64"}]},{name:"processInitializeSell",accounts:[{name:"orderInitializer",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"depositMint",isMut:!1,isSigner:!1},{name:"receiveMint",isMut:!1,isSigner:!1},{name:"orderVaultAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-account"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"orderVaultAuthority",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-auth"},{kind:"account",type:"publicKey",path:"order_initializer"}]}},{name:"initializerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"initializerReceiveTokenAccount",isMut:!1,isSigner:!1},{name:"orderAccount",isMut:!0,isSigner:!1},{name:"registeredCurrency",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"receive_mint"}]}},{name:"openOrdersCounter",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"open-orders-counter"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"price",type:"u64"},{name:"originationQty",type:"u64"}]},{name:"processExchange",accounts:[{name:"orderTaker",isMut:!0,isSigner:!0},{name:"orderTakerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"orderTakerReceiveTokenAccount",isMut:!0,isSigner:!1},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"assetMint",isMut:!1,isSigner:!1},{name:"orderInitializer",isMut:!0,isSigner:!1},{name:"initializerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"initializerReceiveTokenAccount",isMut:!0,isSigner:!1},{name:"orderVaultAccount",isMut:!0,isSigner:!1},{name:"orderVaultAuthority",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-auth"},{kind:"account",type:"publicKey",account:"OrderAccount",path:"order_account.order_initializer_pubkey"}]}},{name:"orderAccount",isMut:!0,isSigner:!1},{name:"saVault",isMut:!0,isSigner:!1},{name:"registeredCurrency",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"openOrdersCounter",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"atlasStaking",isMut:!1,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1},{name:"stakingAccount",isMut:!1,isSigner:!1},{name:"feeReduction",isMut:!1,isSigner:!1}],args:[{name:"purchaseQuantity",type:"u64"},{name:"expectedPrice",type:"u64"},{name:"seller",type:"publicKey"}]},{name:"processCancel",accounts:[{name:"signer",isMut:!0,isSigner:!0},{name:"orderInitializer",isMut:!0,isSigner:!1},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"depositMint",isMut:!1,isSigner:!1},{name:"initializerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"orderVaultAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-account"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"orderVaultAuthority",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-auth"},{kind:"account",type:"publicKey",path:"order_initializer"}]}},{name:"orderAccount",isMut:!0,isSigner:!1},{name:"openOrdersCounter",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"open-orders-counter"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[]},{name:"initializeOpenOrdersCounter",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"user",isMut:!1,isSigner:!1},{name:"openOrdersCounter",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"open-orders-counter"},{kind:"account",type:"publicKey",path:"user"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"depositMint",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]}],accounts:[{name:"FeeReduction",type:{kind:"struct",fields:[{name:"account",type:"publicKey"},{name:"bump",type:"u8"},{name:"discount",type:"u64"}]}},{name:"MarketVars",type:{kind:"struct",fields:[{name:"updateAuthorityMaster",type:"publicKey"},{name:"bump",type:"u8"}]}},{name:"OpenOrdersCounter",type:{kind:"struct",fields:[{name:"openOrderCount",type:"u64"},{name:"bump",type:"u8"}]}},{name:"OrderAccount",type:{kind:"struct",fields:[{name:"orderInitializerPubkey",type:"publicKey"},{name:"currencyMint",type:"publicKey"},{name:"assetMint",type:"publicKey"},{name:"initializerCurrencyTokenAccount",type:"publicKey"},{name:"initializerAssetTokenAccount",type:"publicKey"},{name:"orderSide",type:{defined:"OrderSide"}},{name:"price",type:"u64"},{name:"orderOriginationQty",type:"u64"},{name:"orderRemainingQty",type:"u64"},{name:"createdAtTimestamp",type:"i64"}]}},{name:"RegisteredCurrency",type:{kind:"struct",fields:[{name:"tokenMint",type:"publicKey"},{name:"saCurrencyVault",type:"publicKey"},{name:"royalty",type:"u64"},{name:"bump",type:"u8"},{name:"royaltyTiers",type:{vec:{defined:"RoyaltyTier"}}}]}}],types:[{name:"RoyaltyTier",type:{kind:"struct",fields:[{name:"stakeAmount",type:"u64"},{name:"discount",type:"u64"}]}},{name:"OrderSide",type:{kind:"enum",variants:[{name:"Buy"},{name:"Sell"}]}},{name:"TokenType",type:{kind:"enum",variants:[{name:"Asset"},{name:"Currency"}]}}],errors:[{code:6e3,name:"InvalidDestinationAccount",msg:"Invalid Destination Token Account"},{code:6001,name:"InvalidInstruction",msg:"Invalid instruction."},{code:6002,name:"InvalidMint",msg:"Invalid SPL Token mint"},{code:6003,name:"InvalidOfferAccountOwner",msg:"Invalid Offer Account Owner"},{code:6004,name:"InvalidTokenAccount",msg:"Invalid SPL Token account"},{code:6005,name:"NumericalOverflowError",msg:"Numerical overflow error"},{code:6006,name:"InvalidUpdateAuthorityAccount",msg:"Invalid Update Authority account"},{code:6007,name:"InvalidOrderVaultAuthorityAccount",msg:"Invalid Order Vault Authority account"},{code:6008,name:"UninitializedTokenAccount",msg:"Uninitialized Token Account"},{code:6009,name:"InsufficientBalance",msg:"Insufficient Balance"},{code:6010,name:"InvalidOrderDuration",msg:"Invalid Order Duration"},{code:6011,name:"InvalidOriginationQty",msg:"Origination quantity must be greater than 0"},{code:6012,name:"InsufficientOrderQty",msg:"Insufficient Order Quantity Remaining"},{code:6013,name:"InvalidRoyalty",msg:"Invalid Royalty Value"},{code:6014,name:"InvalidCounter",msg:"Invalid Open Order Counter"},{code:6015,name:"MintDecimalError",msg:"Mint must be zero decimal"},{code:6016,name:"InvalidOrderAccountError",msg:"Order Account does not match provided account"},{code:6017,name:"InvalidRoyaltyTier",msg:"No royalty tier exists with provided stake amount"},{code:6018,name:"RoyaltyTierLength",msg:"Royalty Tier vector cannot hold any additional tiers"},{code:6019,name:"InvalidOrderPrice",msg:"Order price did not match expected price"},{code:6020,name:"DuplicateRoyaltyTier",msg:"Royalty tier already exists"},{code:6021,name:"InvalidSeller",msg:"Order seller did not match expected seller"}],metadata:{}};var _u={};Object.defineProperty(_u,"__esModule",{value:!0});_u.baseIdl=void 0;_u.baseIdl={version:"0.1.0",name:"gm_logs",instructions:[],events:[{name:"RegisterCurrencyMemo",fields:[{name:"updateAuthorityAccount",type:"publicKey",index:!1},{name:"registeredCurrency",type:"publicKey",index:!1},{name:"currencyMint",type:"publicKey",index:!1},{name:"saCurrencyVault",type:"publicKey",index:!1},{name:"royalty",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"InitializeMemo",fields:[{name:"orderInitializerPubkey",type:"publicKey",index:!1},{name:"currencyMint",type:"publicKey",index:!1},{name:"assetMint",type:"publicKey",index:!1},{name:"initializerCurrencyTokenAccount",type:"publicKey",index:!1},{name:"initializerAssetTokenAccount",type:"publicKey",index:!1},{name:"orderSide",type:"u8",index:!1},{name:"price",type:"u64",index:!1},{name:"orderOriginationQty",type:"u64",index:!1},{name:"orderRemainingQty",type:"u64",index:!1},{name:"createdAtTimestamp",type:"i64",index:!1},{name:"orderId",type:"publicKey",index:!1}]},{name:"ExchangeMemo",fields:[{name:"orderInitializerPubkey",type:"publicKey",index:!1},{name:"currencyMint",type:"publicKey",index:!1},{name:"assetMint",type:"publicKey",index:!1},{name:"initializerCurrencyTokenAccount",type:"publicKey",index:!1},{name:"initializerAssetTokenAccount",type:"publicKey",index:!1},{name:"orderSide",type:"u8",index:!1},{name:"price",type:"u64",index:!1},{name:"orderOriginationQty",type:"u64",index:!1},{name:"orderRemainingQty",type:"u64",index:!1},{name:"createdAtTimestamp",type:"i64",index:!1},{name:"orderId",type:"publicKey",index:!1}]},{name:"CancelOrderMemo",fields:[{name:"orderInitializerPubkey",type:"publicKey",index:!1},{name:"currencyMint",type:"publicKey",index:!1},{name:"assetMint",type:"publicKey",index:!1},{name:"initializerCurrencyTokenAccount",type:"publicKey",index:!1},{name:"initializerAssetTokenAccount",type:"publicKey",index:!1},{name:"orderSide",type:"u8",index:!1},{name:"price",type:"u64",index:!1},{name:"orderOriginationQty",type:"u64",index:!1},{name:"orderRemainingQty",type:"u64",index:!1},{name:"createdAtTimestamp",type:"i64",index:!1},{name:"orderId",type:"publicKey",index:!1}]},{name:"StakeMemo",fields:[{name:"user",type:"publicKey",index:!1},{name:"registeredStake",type:"publicKey",index:!1},{name:"stakingAccount",type:"publicKey",index:!1},{name:"stakeAmount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"TransferMemo",fields:[{name:"user",type:"publicKey",index:!1},{name:"registeredStake",type:"publicKey",index:!1},{name:"stakingAccount",type:"publicKey",index:!1},{name:"transferAmount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"WithdrawMemo",fields:[{name:"user",type:"publicKey",index:!1},{name:"registeredStake",type:"publicKey",index:!1},{name:"stakingAccount",type:"publicKey",index:!1},{name:"withdrawAmount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"SettleMemo",fields:[{name:"user",type:"publicKey",index:!1},{name:"registeredStake",type:"publicKey",index:!1},{name:"stakingAccount",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]}],metadata:{}};var vI=z&&z.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),_I=z&&z.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),AI=z&&z.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&vI(e,r,t);return _I(e,r),e};Object.defineProperty(Gn,"__esModule",{value:!0});Gn.getMarketplaceProgram=Gn.getGmLogsIDL=Gn.getGmIDL=void 0;const lp=et,II=fa,EI=AI(_u);function Sm(r){const e=II.baseIdl;return e.metadata.address=r.toBase58(),e}Gn.getGmIDL=Sm;function PI(r){const e=EI.baseIdl;return e.metadata.address=r.toBase58(),e}Gn.getGmLogsIDL=PI;function RI({connection:r,programId:e}){const t=Sm(e),n=new lp.AnchorProvider(r,null,null);return new lp.Program(t,e,n)}Gn.getMarketplaceProgram=RI;var Yi=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.getSingleOrder=Xt.getOpenOrdersForPlayerAndAsset=Xt.getOpenOrdersForPlayerAndCurrency=Xt.getOpenOrdersForAsset=Xt.getOpenOrdersForCurrency=Xt.getOpenOrdersForPlayer=Xt.getAllOpenOrders=void 0;const Sn=et,Ji=Gn;function TI(r,e){return Yi(this,void 0,void 0,function*(){const t=new Sn.AnchorProvider(r,null,null),n=(0,Ji.getGmIDL)(e),i=new Sn.Program(n,e,t),s=[{dataSize:201}];return yield i.account.orderAccount.all(s)})}Xt.getAllOpenOrders=TI;function OI(r,e,t){return Yi(this,void 0,void 0,function*(){const n=new Sn.AnchorProvider(r,null,null),i=(0,Ji.getGmIDL)(t),s=new Sn.Program(i,t,n),o=[{dataSize:201},{memcmp:{offset:8,bytes:e.toBase58()}}];return yield s.account.orderAccount.all(o)})}Xt.getOpenOrdersForPlayer=OI;function BI(r,e,t){return Yi(this,void 0,void 0,function*(){const n=new Sn.AnchorProvider(r,null,null),i=(0,Ji.getGmIDL)(t),s=new Sn.Program(i,t,n),o=[{dataSize:201},{memcmp:{offset:40,bytes:e.toBase58()}}];return yield s.account.orderAccount.all(o)})}Xt.getOpenOrdersForCurrency=BI;function xI(r,e,t){return Yi(this,void 0,void 0,function*(){const n=new Sn.AnchorProvider(r,null,null),i=(0,Ji.getGmIDL)(t),s=new Sn.Program(i,t,n),o=[{dataSize:201},{memcmp:{offset:72,bytes:e.toBase58()}}];return yield s.account.orderAccount.all(o)})}Xt.getOpenOrdersForAsset=xI;function CI(r,e,t,n){return Yi(this,void 0,void 0,function*(){const i=new Sn.AnchorProvider(r,null,null),s=(0,Ji.getGmIDL)(n),o=new Sn.Program(s,n,i),a=[{dataSize:201},{memcmp:{offset:40,bytes:t.toBase58()}},{memcmp:{offset:8,bytes:e.toBase58()}}];return yield o.account.orderAccount.all(a)})}Xt.getOpenOrdersForPlayerAndCurrency=CI;function MI(r,e,t,n){return Yi(this,void 0,void 0,function*(){const i=new Sn.AnchorProvider(r,null,null),s=(0,Ji.getGmIDL)(n),o=new Sn.Program(s,n,i),a=[{dataSize:201},{memcmp:{offset:72,bytes:t.toBase58()}},{memcmp:{offset:8,bytes:e.toBase58()}}];return yield o.account.orderAccount.all(a)})}Xt.getOpenOrdersForPlayerAndAsset=MI;function LI(r,e,t){return Yi(this,void 0,void 0,function*(){const n=new Sn.AnchorProvider(r,null,null),i=(0,Ji.getGmIDL)(t);return yield new Sn.Program(i,t,n).account.orderAccount.fetch(e)})}Xt.getSingleOrder=LI;var Ct={},an={};Object.defineProperty(an,"__esModule",{value:!0});an.FEE_EXEMPT_SEED=an.OPEN_ORDERS_COUNTER=an.REGISTERED_CURRENCY_SEED=an.ORDER_VAULT_AUTH_SEED=an.ORDER_VAULT_SEED=an.MARKET_VARS_SEED=void 0;an.MARKET_VARS_SEED=ge.Buffer.from("market-vars");an.ORDER_VAULT_SEED=ge.Buffer.from("order-vault-account");an.ORDER_VAULT_AUTH_SEED=ge.Buffer.from("order-vault-auth");an.REGISTERED_CURRENCY_SEED=ge.Buffer.from("registered-currency");an.OPEN_ORDERS_COUNTER=ge.Buffer.from("open-orders-counter");an.FEE_EXEMPT_SEED=ge.Buffer.from("fee_exempt");var KI=z&&z.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),NI=z&&z.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),DI=z&&z.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&KI(e,r,t);return NI(e,r),e},ci=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Ct,"__esModule",{value:!0});Ct.getAllFeeExemptAccounts=Ct.getFeeExemptAccount=Ct.getOpenOrdersCounter=Ct.getAllRegisteredCurrencies=Ct.getRegisteredCurrencyAccount=Ct.getOrderVaultAuth=Ct.getOrderVault=Ct.getMarketVarsAccount=void 0;const wc=et,ro=Lr,io=DI(an),vm=Gn;function $I(r){return ci(this,void 0,void 0,function*(){return ro.PublicKey.findProgramAddress([io.MARKET_VARS_SEED],r)})}Ct.getMarketVarsAccount=$I;function zI(r,e,t){return ci(this,void 0,void 0,function*(){return ro.PublicKey.findProgramAddress([io.ORDER_VAULT_SEED,r.toBuffer(),e.toBuffer()],t)})}Ct.getOrderVault=zI;function WI(r,e){return ci(this,void 0,void 0,function*(){return ro.PublicKey.findProgramAddress([io.ORDER_VAULT_AUTH_SEED,r.toBuffer()],e)})}Ct.getOrderVaultAuth=WI;function VI(r,e){return ci(this,void 0,void 0,function*(){return ro.PublicKey.findProgramAddress([io.REGISTERED_CURRENCY_SEED,e.toBuffer()],r)})}Ct.getRegisteredCurrencyAccount=VI;function UI(r,e){return ci(this,void 0,void 0,function*(){const t=new wc.AnchorProvider(r,null,null),n=(0,vm.getGmIDL)(e),i=new wc.Program(n,e,t),s=[{dataSize:1686}],o=yield i.account.registeredCurrency.all(s),a=[];for(const c of o){const l={mint:c.account.tokenMint,royalty:c.account.royalty,saVault:c.account.saCurrencyVault};a.push(l)}return a})}Ct.getAllRegisteredCurrencies=UI;function FI(r,e,t){return ci(this,void 0,void 0,function*(){return ro.PublicKey.findProgramAddress([io.OPEN_ORDERS_COUNTER,r.toBuffer(),e.toBuffer()],t)})}Ct.getOpenOrdersCounter=FI;function jI(r,e){return ci(this,void 0,void 0,function*(){return ro.PublicKey.findProgramAddress([io.FEE_EXEMPT_SEED,r.toBuffer()],e)})}Ct.getFeeExemptAccount=jI;function qI(r,e){return ci(this,void 0,void 0,function*(){const t=new wc.AnchorProvider(r,null,null),n=(0,vm.getGmIDL)(e);return yield new wc.Program(n,e,t).account.feeReduction.all()})}Ct.getAllFeeExemptAccounts=qI;var yn={},so=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(yn,"__esModule",{value:!0});yn.getRoyaltyReductionForStakingAccount=yn.getRoyaltyReductionForUserAndMint=yn.getRegisteredCurrencyInfoFromPubkey=yn.getRegisteredCurrencyAccountInfo=yn.getFeeExemptAccountInfo=yn.getMarketVarsAccountInfo=void 0;const kc=et,xf=Ct,Au=Gn,pd=jc;function GI(r,e){return so(this,void 0,void 0,function*(){const t=(0,Au.getMarketplaceProgram)({connection:r,programId:e}),[n]=yield(0,xf.getMarketVarsAccount)(e);return yield t.account.marketVars.fetch(n)})}yn.getMarketVarsAccountInfo=GI;function HI(r,e,t){return so(this,void 0,void 0,function*(){const n=(0,Au.getMarketplaceProgram)({connection:r,programId:t}),[i]=yield(0,xf.getFeeExemptAccount)(e,t);return yield n.account.feeExempt.fetch(i)})}yn.getFeeExemptAccountInfo=HI;function YI(r,e,t){return so(this,void 0,void 0,function*(){const n=(0,Au.getMarketplaceProgram)({connection:r,programId:e}),[i]=yield(0,xf.getRegisteredCurrencyAccount)(e,t);return yield n.account.registeredCurrency.fetch(i)})}yn.getRegisteredCurrencyAccountInfo=YI;function Cf(r,e,t){return so(this,void 0,void 0,function*(){return yield(0,Au.getMarketplaceProgram)({connection:r,programId:e}).account.registeredCurrency.fetch(t)})}yn.getRegisteredCurrencyInfoFromPubkey=Cf;function JI(r,e,t,n,i,s){return so(this,void 0,void 0,function*(){let o=0;const a=yield Cf(r,e,i),[c]=yield(0,pd.getStakingAccount)(t,n,s),l=yield(0,pd.getStakingAccountInfo)(r,c,t);if(l.unstakedTs.eq(new kc.BN(0))){const u=a.royaltyTiers;let f=new kc.BN(0);for(const m of u)l.totalStake.gte(m.stakeAmount)&&(f=m.discount);o=f.toNumber()/1e4}return o})}yn.getRoyaltyReductionForUserAndMint=JI;function QI(r,e,t,n,i){return so(this,void 0,void 0,function*(){let s=0;const o=yield Cf(r,e,i),a=yield(0,pd.getStakingAccountInfo)(r,n,t);if(a.unstakedTs.eq(new kc.BN(0))){const c=o.royaltyTiers;let l=new kc.BN(0);for(const u of c)a.totalStake.gte(u.stakeAmount)&&(l=u.discount);s=l.toNumber()/1e4}return s})}yn.getRoyaltyReductionForStakingAccount=QI;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Xt,r),t(Ct,r),t(yn,r),t(an,r)})(ai);var ha={},_n={},Qr={},XI=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Qr,"__esModule",{value:!0});Qr.convertDecimalPriceToBn=Qr.initializeAtaForMint=Qr.getOrderSide=void 0;const ZI=et,eE=Ui,Tl=da,tE=r=>JSON.stringify(r.orderSide)===JSON.stringify({buy:{}})?"BuySide":"SellSide";Qr.getOrderSide=tE;function nE({mint:r,owner:e,connection:t}){return XI(this,void 0,void 0,function*(){const n=[],i=yield(0,eE.associatedAddress)({mint:r,owner:e});return(yield t.getAccountInfo(i))===null&&n.push(Tl.Token.createAssociatedTokenAccountInstruction(Tl.ASSOCIATED_TOKEN_PROGRAM_ID,Tl.TOKEN_PROGRAM_ID,r,i,e,e)),{account:i,instructions:n}})}Qr.initializeAtaForMint=nE;const rE=(r,e)=>new ZI.BN(r*Math.pow(10,e));Qr.convertDecimalPriceToBn=rE;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Gn,r),t(Qr,r)})(_n);var iE=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(ha,"__esModule",{value:!0});ha.createOrderCounterInstruction=void 0;const sE=_n;function oE({connection:r,payer:e,initializerMainAccount:t,depositMint:n,programId:i}){return iE(this,void 0,void 0,function*(){return yield(0,sE.getMarketplaceProgram)({connection:r,programId:i}).methods.initializeOpenOrdersCounter().accounts({payer:e,user:t,depositMint:n}).instruction()})}ha.createOrderCounterInstruction=oE;var aE=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(vu,"__esModule",{value:!0});vu.createCancelOrderInstruction=void 0;const cE=et,uE=ai,lE=ha,dp=_n,dE=Fn;function fE({connection:r,orderInitializer:e,orderAccount:t,programId:n,payer:i=e}){return aE(this,void 0,void 0,function*(){const s=(0,dp.getMarketplaceProgram)({connection:r,programId:n}),o={signers:[],instructions:[]},a=yield s.account.orderAccount.fetch(t),l=(0,dp.getOrderSide)(a)==="SellSide"?a.assetMint:a.currencyMint;let u=null,f=null;const m=yield(0,dE.getTokenAccount)(r,e,l);u=m.tokenAccount,"createInstruction"in m&&o.instructions.push(...m.createInstruction),u instanceof cE.web3.Keypair?(f=u.publicKey,o.signers.push(u)):f=u;const[y]=yield(0,uE.getOpenOrdersCounter)(e,l,n);if((yield r.getAccountInfo(y))===null){const w=yield(0,lE.createOrderCounterInstruction)({connection:r,payer:i,initializerMainAccount:e,depositMint:l,programId:n});o.instructions.push(w)}const p=yield s.methods.processCancel().accounts({signer:i,depositMint:l,orderInitializer:e,initializerDepositTokenAccount:f,orderAccount:t}).instruction();return o.instructions.push(p),o})}vu.createCancelOrderInstruction=fE;var Ns={},_m=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Ns,"__esModule",{value:!0});Ns.createInitializeSellOrderInstruction=Ns.createInitializeBuyOrderInstruction=void 0;const Is=et,Am=_n,Im=Fn,Em=ai,Pm=ha,Rm=Fn;function hE({connection:r,initializerMainAccount:e,initializerDepositTokenAccount:t,price:n,originationQty:i,depositMint:s,receiveMint:o,programId:a}){return _m(this,void 0,void 0,function*(){const c=(0,Am.getMarketplaceProgram)({connection:r,programId:a}),l={signers:[],instructions:[]};let u=null,f=null;const m=yield(0,Im.getTokenAccount)(r,e,o);u=m.tokenAccount,"createInstruction"in m&&l.instructions.push(...m.createInstruction),u instanceof Is.web3.Keypair?(f=u.publicKey,l.signers.push(u)):f=u;const[y]=yield(0,Em.getOpenOrdersCounter)(e,s,a);if((yield r.getAccountInfo(y))===null){const E=yield(0,Pm.createOrderCounterInstruction)({connection:r,payer:e,initializerMainAccount:e,depositMint:s,programId:a});l.instructions.push(E)}const p=Is.web3.Keypair.generate();l.signers.push(p);const w=yield(0,Rm.createAccountInstruction)(r,e,p,a);l.instructions.push(w);const v=yield c.methods.processInitializeBuy(n,new Is.BN(i)).accounts({orderInitializer:e,initializerDepositTokenAccount:t,initializerReceiveTokenAccount:f,orderAccount:p.publicKey,depositMint:s,receiveMint:o}).signers([p]).instruction();return l.instructions.push(v),{orderAccount:p.publicKey,ixSet:l}})}Ns.createInitializeBuyOrderInstruction=hE;function pE({connection:r,initializerMainAccount:e,initializerDepositTokenAccount:t,price:n,originationQty:i,depositMint:s,receiveMint:o,programId:a}){return _m(this,void 0,void 0,function*(){const c=(0,Am.getMarketplaceProgram)({connection:r,programId:a}),l={signers:[],instructions:[]};let u=null,f=null;const m=yield(0,Im.getTokenAccount)(r,e,o);u=m.tokenAccount,"createInstruction"in m&&l.instructions.push(...m.createInstruction),u instanceof Is.web3.Keypair?(f=u.publicKey,l.signers.push(u)):f=u;const[y]=yield(0,Em.getOpenOrdersCounter)(e,s,a);if((yield r.getAccountInfo(y))===null){const E=yield(0,Pm.createOrderCounterInstruction)({connection:r,payer:e,initializerMainAccount:e,depositMint:s,programId:a});l.instructions.push(E)}const p=Is.web3.Keypair.generate();l.signers.push(p);const w=yield(0,Rm.createAccountInstruction)(r,e,p,a);l.instructions.push(w);const v=yield c.methods.processInitializeSell(n,new Is.BN(i)).accounts({orderInitializer:e,initializerDepositTokenAccount:t,initializerReceiveTokenAccount:f,orderAccount:p.publicKey,depositMint:s,receiveMint:o}).signers([p]).instruction();return l.instructions.push(v),{orderAccount:p.publicKey,ixSet:l}})}Ns.createInitializeSellOrderInstruction=pE;var Iu={},yE=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Iu,"__esModule",{value:!0});Iu.createDeregisterCurrencyInstruction=void 0;const gE=_n;function mE({connection:r,updateAuthorityAccount:e,currencyMint:t,programId:n}){return yE(this,void 0,void 0,function*(){const s=[yield(0,gE.getMarketplaceProgram)({connection:r,programId:n}).methods.deregisterCurrency().accounts({updateAuthorityAccount:e,currencyMint:t}).instruction()];return{accounts:[],instructions:s}})}Iu.createDeregisterCurrencyInstruction=mE;var Eu={},Pu={},Ru={},Tm={exports:{}};(function(r){(function(e){var t,n=20,i=1,s=1e6,o=1e6,a=-7,c=21,l=!1,u="[big.js] ",f=u+"Invalid ",m=f+"decimal places",y=f+"rounding mode",S=u+"Division by zero",p={},w=void 0,v=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function E(){function b(_){var R=this;if(!(R instanceof b))return _===w?E():new b(_);if(_ instanceof b)R.s=_.s,R.e=_.e,R.c=_.c.slice();else{if(typeof _!="string"){if(b.strict===!0&&typeof _!="bigint")throw TypeError(f+"value");_=_===0&&1/_<0?"-0":String(_)}P(R,_)}R.constructor=b}return b.prototype=p,b.DP=n,b.RM=i,b.NE=a,b.PE=c,b.strict=l,b.roundDown=0,b.roundHalfUp=1,b.roundHalfEven=2,b.roundUp=3,b}function P(b,_){var R,W,B;if(!v.test(_))throw Error(f+"number");for(b.s=_.charAt(0)=="-"?(_=_.slice(1),-1):1,(R=_.indexOf("."))>-1&&(_=_.replace(".","")),(W=_.search(/e/i))>0?(R<0&&(R=W),R+=+_.slice(W+1),_=_.substring(0,W)):R<0&&(R=_.length),B=_.length,W=0;W<B&&_.charAt(W)=="0";)++W;if(W==B)b.c=[b.e=0];else{for(;B>0&&_.charAt(--B)=="0";);for(b.e=R-W-1,b.c=[],R=0;W<=B;)b.c[R++]=+_.charAt(W++)}return b}function K(b,_,R,W){var B=b.c;if(R===w&&(R=b.constructor.RM),R!==0&&R!==1&&R!==2&&R!==3)throw Error(y);if(_<1)W=R===3&&(W||!!B[0])||_===0&&(R===1&&B[0]>=5||R===2&&(B[0]>5||B[0]===5&&(W||B[1]!==w))),B.length=1,W?(b.e=b.e-_+1,B[0]=1):B[0]=b.e=0;else if(_<B.length){if(W=R===1&&B[_]>=5||R===2&&(B[_]>5||B[_]===5&&(W||B[_+1]!==w||B[_-1]&1))||R===3&&(W||!!B[0]),B.length=_,W){for(;++B[--_]>9;)if(B[_]=0,_===0){++b.e,B.unshift(1);break}}for(_=B.length;!B[--_];)B.pop()}return b}function T(b,_,R){var W=b.e,B=b.c.join(""),V=B.length;if(_)B=B.charAt(0)+(V>1?"."+B.slice(1):"")+(W<0?"e":"e+")+W;else if(W<0){for(;++W;)B="0"+B;B="0."+B}else if(W>0)if(++W>V)for(W-=V;W--;)B+="0";else W<V&&(B=B.slice(0,W)+"."+B.slice(W));else V>1&&(B=B.charAt(0)+"."+B.slice(1));return b.s<0&&R?"-"+B:B}p.abs=function(){var b=new this.constructor(this);return b.s=1,b},p.cmp=function(b){var _,R=this,W=R.c,B=(b=new R.constructor(b)).c,V=R.s,q=b.s,I=R.e,$=b.e;if(!W[0]||!B[0])return W[0]?V:B[0]?-q:0;if(V!=q)return V;if(_=V<0,I!=$)return I>$^_?1:-1;for(q=(I=W.length)<($=B.length)?I:$,V=-1;++V<q;)if(W[V]!=B[V])return W[V]>B[V]^_?1:-1;return I==$?0:I>$^_?1:-1},p.div=function(b){var _=this,R=_.constructor,W=_.c,B=(b=new R(b)).c,V=_.s==b.s?1:-1,q=R.DP;if(q!==~~q||q<0||q>s)throw Error(m);if(!B[0])throw Error(S);if(!W[0])return b.s=V,b.c=[b.e=0],b;var I,$,G,ke,ae,ve=B.slice(),Dt=I=B.length,nn=W.length,me=W.slice(0,I),Be=me.length,Ut=b,Yt=Ut.c=[],$t=0,ft=q+(Ut.e=_.e-b.e)+1;for(Ut.s=V,V=ft<0?0:ft,ve.unshift(0);Be++<I;)me.push(0);do{for(G=0;G<10;G++){if(I!=(Be=me.length))ke=I>Be?1:-1;else for(ae=-1,ke=0;++ae<I;)if(B[ae]!=me[ae]){ke=B[ae]>me[ae]?1:-1;break}if(ke<0){for($=Be==I?B:ve;Be;){if(me[--Be]<$[Be]){for(ae=Be;ae&&!me[--ae];)me[ae]=9;--me[ae],me[Be]+=10}me[Be]-=$[Be]}for(;!me[0];)me.shift()}else break}Yt[$t++]=ke?G:++G,me[0]&&ke?me[Be]=W[Dt]||0:me=[W[Dt]]}while((Dt++<nn||me[0]!==w)&&V--);return!Yt[0]&&$t!=1&&(Yt.shift(),Ut.e--,ft--),$t>ft&&K(Ut,ft,R.RM,me[0]!==w),Ut},p.eq=function(b){return this.cmp(b)===0},p.gt=function(b){return this.cmp(b)>0},p.gte=function(b){return this.cmp(b)>-1},p.lt=function(b){return this.cmp(b)<0},p.lte=function(b){return this.cmp(b)<1},p.minus=p.sub=function(b){var _,R,W,B,V=this,q=V.constructor,I=V.s,$=(b=new q(b)).s;if(I!=$)return b.s=-$,V.plus(b);var G=V.c.slice(),ke=V.e,ae=b.c,ve=b.e;if(!G[0]||!ae[0])return ae[0]?b.s=-$:G[0]?b=new q(V):b.s=1,b;if(I=ke-ve){for((B=I<0)?(I=-I,W=G):(ve=ke,W=ae),W.reverse(),$=I;$--;)W.push(0);W.reverse()}else for(R=((B=G.length<ae.length)?G:ae).length,I=$=0;$<R;$++)if(G[$]!=ae[$]){B=G[$]<ae[$];break}if(B&&(W=G,G=ae,ae=W,b.s=-b.s),($=(R=ae.length)-(_=G.length))>0)for(;$--;)G[_++]=0;for($=_;R>I;){if(G[--R]<ae[R]){for(_=R;_&&!G[--_];)G[_]=9;--G[_],G[R]+=10}G[R]-=ae[R]}for(;G[--$]===0;)G.pop();for(;G[0]===0;)G.shift(),--ve;return G[0]||(b.s=1,G=[ve=0]),b.c=G,b.e=ve,b},p.mod=function(b){var _,R=this,W=R.constructor,B=R.s,V=(b=new W(b)).s;if(!b.c[0])throw Error(S);return R.s=b.s=1,_=b.cmp(R)==1,R.s=B,b.s=V,_?new W(R):(B=W.DP,V=W.RM,W.DP=W.RM=0,R=R.div(b),W.DP=B,W.RM=V,this.minus(R.times(b)))},p.neg=function(){var b=new this.constructor(this);return b.s=-b.s,b},p.plus=p.add=function(b){var _,R,W,B=this,V=B.constructor;if(b=new V(b),B.s!=b.s)return b.s=-b.s,B.minus(b);var q=B.e,I=B.c,$=b.e,G=b.c;if(!I[0]||!G[0])return G[0]||(I[0]?b=new V(B):b.s=B.s),b;if(I=I.slice(),_=q-$){for(_>0?($=q,W=G):(_=-_,W=I),W.reverse();_--;)W.push(0);W.reverse()}for(I.length-G.length<0&&(W=G,G=I,I=W),_=G.length,R=0;_;I[_]%=10)R=(I[--_]=I[_]+G[_]+R)/10|0;for(R&&(I.unshift(R),++$),_=I.length;I[--_]===0;)I.pop();return b.c=I,b.e=$,b},p.pow=function(b){var _=this,R=new _.constructor("1"),W=R,B=b<0;if(b!==~~b||b<-o||b>o)throw Error(f+"exponent");for(B&&(b=-b);b&1&&(W=W.times(_)),b>>=1,!!b;)_=_.times(_);return B?R.div(W):W},p.prec=function(b,_){if(b!==~~b||b<1||b>s)throw Error(f+"precision");return K(new this.constructor(this),b,_)},p.round=function(b,_){if(b===w)b=0;else if(b!==~~b||b<-s||b>s)throw Error(m);return K(new this.constructor(this),b+this.e+1,_)},p.sqrt=function(){var b,_,R,W=this,B=W.constructor,V=W.s,q=W.e,I=new B("0.5");if(!W.c[0])return new B(W);if(V<0)throw Error(u+"No square root");V=Math.sqrt(W+""),V===0||V===1/0?(_=W.c.join(""),_.length+q&1||(_+="0"),V=Math.sqrt(_),q=((q+1)/2|0)-(q<0||q&1),b=new B((V==1/0?"5e":(V=V.toExponential()).slice(0,V.indexOf("e")+1))+q)):b=new B(V+""),q=b.e+(B.DP+=4);do R=b,b=I.times(R.plus(W.div(R)));while(R.c.slice(0,q).join("")!==b.c.slice(0,q).join(""));return K(b,(B.DP-=4)+b.e+1,B.RM)},p.times=p.mul=function(b){var _,R=this,W=R.constructor,B=R.c,V=(b=new W(b)).c,q=B.length,I=V.length,$=R.e,G=b.e;if(b.s=R.s==b.s?1:-1,!B[0]||!V[0])return b.c=[b.e=0],b;for(b.e=$+G,q<I&&(_=B,B=V,V=_,G=q,q=I,I=G),_=new Array(G=q+I);G--;)_[G]=0;for($=I;$--;){for(I=0,G=q+$;G>$;)I=_[G]+V[$]*B[G-$-1]+I,_[G--]=I%10,I=I/10|0;_[G]=I}for(I?++b.e:_.shift(),$=_.length;!_[--$];)_.pop();return b.c=_,b},p.toExponential=function(b,_){var R=this,W=R.c[0];if(b!==w){if(b!==~~b||b<0||b>s)throw Error(m);for(R=K(new R.constructor(R),++b,_);R.c.length<b;)R.c.push(0)}return T(R,!0,!!W)},p.toFixed=function(b,_){var R=this,W=R.c[0];if(b!==w){if(b!==~~b||b<0||b>s)throw Error(m);for(R=K(new R.constructor(R),b+R.e+1,_),b=b+R.e+1;R.c.length<b;)R.c.push(0)}return T(R,!1,!!W)},p.toJSON=p.toString=function(){var b=this,_=b.constructor;return T(b,b.e<=_.NE||b.e>=_.PE,!!b.c[0])},p.toNumber=function(){var b=Number(T(this,!0,!0));if(this.constructor.strict===!0&&!this.eq(b.toString()))throw Error(u+"Imprecise conversion");return b},p.toPrecision=function(b,_){var R=this,W=R.constructor,B=R.c[0];if(b!==w){if(b!==~~b||b<1||b>s)throw Error(f+"precision");for(R=K(new W(R),b,_);R.c.length<b;)R.c.push(0)}return T(R,b<=R.e||R.e<=W.NE||R.e>=W.PE,!!B)},p.valueOf=function(){var b=this,_=b.constructor;if(_.strict===!0)throw Error(u+"valueOf disallowed");return T(b,b.e<=_.NE||b.e>=_.PE,!0)},t=E(),t.default=t.Big=t,r.exports?r.exports=t:e.Big=t})(z)})(Tm);function _e(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];throw new Error(typeof r=="number"?"[MobX] minified error nr: "+r+(t.length?" "+t.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+r)}var bE={};function Mf(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ge.global<"u"?ge.global:typeof self<"u"?self:bE}var Om=Object.assign,Sc=Object.getOwnPropertyDescriptor,yr=Object.defineProperty,pa=Object.prototype,yd=[];Object.freeze(yd);var Lf={};Object.freeze(Lf);var wE=typeof Proxy<"u",kE=Object.toString();function Bm(){wE||_e("Proxy not available")}function xm(r){var e=!1;return function(){if(!e)return e=!0,r.apply(this,arguments)}}var gs=function(){};function Cn(r){return typeof r=="function"}function Ci(r){var e=typeof r;switch(e){case"string":case"symbol":case"number":return!0}return!1}function Tu(r){return r!==null&&typeof r=="object"}function Mr(r){if(!Tu(r))return!1;var e=Object.getPrototypeOf(r);if(e==null)return!0;var t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t.toString()===kE}function Cm(r){var e=r==null?void 0:r.constructor;return e?e.name==="GeneratorFunction"||e.displayName==="GeneratorFunction":!1}function ya(r,e,t){yr(r,e,{enumerable:!1,writable:!0,configurable:!0,value:t})}function Mm(r,e,t){yr(r,e,{enumerable:!1,writable:!1,configurable:!0,value:t})}function ui(r,e){var t="isMobX"+r;return e.prototype[t]=!0,function(n){return Tu(n)&&n[t]===!0}}function oo(r){return r instanceof Map}function ga(r){return r instanceof Set}var Lm=typeof Object.getOwnPropertySymbols<"u";function SE(r){var e=Object.keys(r);if(!Lm)return e;var t=Object.getOwnPropertySymbols(r);return t.length?[].concat(e,t.filter(function(n){return pa.propertyIsEnumerable.call(r,n)})):e}var Ds=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Lm?function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:Object.getOwnPropertyNames;function Km(r){return r===null?null:typeof r=="object"?""+r:r}function xr(r,e){return pa.hasOwnProperty.call(r,e)}var vE=Object.getOwnPropertyDescriptors||function(e){var t={};return Ds(e).forEach(function(n){t[n]=Sc(e,n)}),t};function fp(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,IE(n.key),n)}}function Kf(r,e,t){return e&&fp(r.prototype,e),t&&fp(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function ni(){return ni=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},ni.apply(this,arguments)}function Nm(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,gd(r,e)}function gd(r,e){return gd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},gd(r,e)}function Ol(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _E(r,e){if(!!r){if(typeof r=="string")return hp(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return hp(r,e)}}function hp(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function ms(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=_E(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AE(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function IE(r){var e=AE(r,"string");return typeof e=="symbol"?e:String(e)}var pr=Symbol("mobx-stored-annotations");function Hn(r){function e(t,n){if(ma(n))return r.decorate_20223_(t,n);ao(t,n,r)}return Object.assign(e,r)}function ao(r,e,t){xr(r,pr)||ya(r,pr,ni({},r[pr])),ME(t)||(r[pr][e]=t)}function EE(r){return xr(r,pr)||ya(r,pr,ni({},r[pr])),r[pr]}function ma(r){return typeof r=="object"&&typeof r.kind=="string"}var fe=Symbol("mobx administration"),ba=function(){function r(t){t===void 0&&(t="Atom"),this.name_=void 0,this.isPendingUnobservation_=!1,this.isBeingObserved_=!1,this.observers_=new Set,this.batchId_=void 0,this.diffValue_=0,this.lastAccessedBy_=0,this.lowestObserverState_=Ue.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=t,this.batchId_=Z.inBatch?Z.batchId:NaN}var e=r.prototype;return e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.reportObserved=function(){return ib(this)},e.reportChanged=function(){(!Z.inBatch||this.batchId_!==Z.batchId)&&(Z.stateVersion=Z.stateVersion<Number.MAX_SAFE_INTEGER?Z.stateVersion+1:Number.MIN_SAFE_INTEGER,this.batchId_=NaN),gn(),sb(this),mn()},e.toString=function(){return this.name_},r}(),Nf=ui("Atom",ba);function Ou(r,e,t){e===void 0&&(e=gs),t===void 0&&(t=gs);var n=new ba(r);return e!==gs&&pb(n,e),t!==gs&&Sa(n,t),n}function PE(r,e){return r===e}function RE(r,e){return jf(r,e)}function TE(r,e){return jf(r,e,1)}function OE(r,e){return Object.is?Object.is(r,e):r===e?r!==0||1/r===1/e:r!==r&&e!==e}var Mi={identity:PE,structural:RE,default:OE,shallow:TE};function Li(r,e,t){return Du(r)?r:Array.isArray(r)?lt.array(r,{name:t}):Mr(r)?lt.object(r,void 0,{name:t}):oo(r)?lt.map(r,{name:t}):ga(r)?lt.set(r,{name:t}):typeof r=="function"&&!li(r)&&!Vs(r)?Cm(r)?Di(r):Ws(t,r):r}function BE(r,e,t){if(r==null||Lt(r)||Vt(r)||Nt(r)||ln(r))return r;if(Array.isArray(r))return lt.array(r,{name:t,deep:!1});if(Mr(r))return lt.object(r,void 0,{name:t,deep:!1});if(oo(r))return lt.map(r,{name:t,deep:!1});if(ga(r))return lt.set(r,{name:t,deep:!1})}function Bu(r){return r}function xE(r,e){return jf(r,e)?e:r}var Dm="override",CE=Hn({annotationType_:Dm,make_:LE,extend_:KE,decorate_20223_:NE});function ME(r){return r.annotationType_===Dm}function LE(r,e){return 0}function KE(r,e,t,n){_e("'"+this.annotationType_+"' can only be used with 'makeObservable'")}function NE(r,e){console.warn("'"+this.annotationType_+"' cannot be used with decorators - this is a no-op")}function wa(r,e){return{annotationType_:r,options_:e,make_:DE,extend_:$E,decorate_20223_:zE}}function DE(r,e,t,n){var i;if((i=this.options_)!=null&&i.bound)return this.extend_(r,e,t,!1)===null?0:1;if(n===r.target_)return this.extend_(r,e,t,!1)===null?0:2;if(li(t.value))return 1;var s=$m(r,this,e,t,!1);return yr(n,e,s),2}function $E(r,e,t,n){var i=$m(r,this,e,t);return r.defineProperty_(e,i,n)}function zE(r,e){var t=e.kind,n=e.name,i=e.addInitializer,s=this,o=function(l){var u,f,m,y;return ri((u=(f=s.options_)==null?void 0:f.name)!=null?u:n.toString(),l,(m=(y=s.options_)==null?void 0:y.autoAction)!=null?m:!1)};if(t=="field"){i(function(){ao(this,n,s)});return}if(t=="method"){var a;return li(r)||(r=o(r)),(a=this.options_)!=null&&a.bound&&i(function(){var c=this,l=c[n].bind(c);l.isMobxAction=!0,c[n]=l}),r}_e("Cannot apply '"+s.annotationType_+"' to '"+String(n)+"' (kind: "+t+"):"+(`
'`+s.annotationType_+"' can only be used on properties with a function value."))}function WE(r,e,t,n){e.annotationType_,n.value}function $m(r,e,t,n,i){var s,o,a,c,l,u,f;i===void 0&&(i=Z.safeDescriptors),WE(r,e,t,n);var m=n.value;if((s=e.options_)!=null&&s.bound){var y;m=m.bind((y=r.proxy_)!=null?y:r.target_)}return{value:ri((o=(a=e.options_)==null?void 0:a.name)!=null?o:t.toString(),m,(c=(l=e.options_)==null?void 0:l.autoAction)!=null?c:!1,(u=e.options_)!=null&&u.bound?(f=r.proxy_)!=null?f:r.target_:void 0),configurable:i?r.isPlainObject_:!0,enumerable:!1,writable:!i}}function zm(r,e){return{annotationType_:r,options_:e,make_:VE,extend_:UE,decorate_20223_:FE}}function VE(r,e,t,n){var i;if(n===r.target_)return this.extend_(r,e,t,!1)===null?0:2;if((i=this.options_)!=null&&i.bound&&(!xr(r.target_,e)||!Vs(r.target_[e]))&&this.extend_(r,e,t,!1)===null)return 0;if(Vs(t.value))return 1;var s=Wm(r,this,e,t,!1,!1);return yr(n,e,s),2}function UE(r,e,t,n){var i,s=Wm(r,this,e,t,(i=this.options_)==null?void 0:i.bound);return r.defineProperty_(e,s,n)}function FE(r,e){var t,n=e.name,i=e.addInitializer;return Vs(r)||(r=Di(r)),(t=this.options_)!=null&&t.bound&&i(function(){var s=this,o=s[n].bind(s);o.isMobXFlow=!0,s[n]=o}),r}function jE(r,e,t,n){e.annotationType_,n.value}function Wm(r,e,t,n,i,s){s===void 0&&(s=Z.safeDescriptors),jE(r,e,t,n);var o=n.value;if(Vs(o)||(o=Di(o)),i){var a;o=o.bind((a=r.proxy_)!=null?a:r.target_),o.isMobXFlow=!0}return{value:o,configurable:s?r.isPlainObject_:!0,enumerable:!1,writable:!s}}function Df(r,e){return{annotationType_:r,options_:e,make_:qE,extend_:GE,decorate_20223_:HE}}function qE(r,e,t){return this.extend_(r,e,t,!1)===null?0:1}function GE(r,e,t,n){return YE(r,this,e,t),r.defineComputedProperty_(e,ni({},this.options_,{get:t.get,set:t.set}),n)}function HE(r,e){var t=this,n=e.name,i=e.addInitializer;return i(function(){var s=Xi(this)[fe],o=ni({},t.options_,{get:r,context:this});o.name||(o.name="ObservableObject."+n.toString()),s.values_.set(n,new zs(o))}),function(){return this[fe].getObservablePropValue_(n)}}function YE(r,e,t,n){e.annotationType_,n.get}function xu(r,e){return{annotationType_:r,options_:e,make_:JE,extend_:QE,decorate_20223_:XE}}function JE(r,e,t){return this.extend_(r,e,t,!1)===null?0:1}function QE(r,e,t,n){var i,s;return ZE(r,this),r.defineObservableProperty_(e,t.value,(i=(s=this.options_)==null?void 0:s.enhancer)!=null?i:Li,n)}function XE(r,e){var t=this,n=e.kind,i=e.name,s=new WeakSet;function o(a,c){var l,u,f=Xi(a)[fe],m=new Xr(c,(l=(u=t.options_)==null?void 0:u.enhancer)!=null?l:Li,"ObservableObject."+i.toString(),!1);f.values_.set(i,m),s.add(a)}if(n=="accessor")return{get:function(){return s.has(this)||o(this,r.get.call(this)),this[fe].getObservablePropValue_(i)},set:function(c){return s.has(this)||o(this,c),this[fe].setObservablePropValue_(i,c)},init:function(c){return s.has(this)||o(this,c),c}}}function ZE(r,e,t,n){e.annotationType_}var eP="true",tP=Vm();function Vm(r){return{annotationType_:eP,options_:r,make_:nP,extend_:rP,decorate_20223_:iP}}function nP(r,e,t,n){var i,s;if(t.get)return Vn.make_(r,e,t,n);if(t.set){var o=ri(e.toString(),t.set);return n===r.target_?r.defineProperty_(e,{configurable:Z.safeDescriptors?r.isPlainObject_:!0,set:o})===null?0:2:(yr(n,e,{configurable:!0,set:o}),2)}if(n!==r.target_&&typeof t.value=="function"){var a;if(Cm(t.value)){var c,l=(c=this.options_)!=null&&c.autoBind?Di.bound:Di;return l.make_(r,e,t,n)}var u=(a=this.options_)!=null&&a.autoBind?Ws.bound:Ws;return u.make_(r,e,t,n)}var f=((i=this.options_)==null?void 0:i.deep)===!1?lt.ref:lt;if(typeof t.value=="function"&&(s=this.options_)!=null&&s.autoBind){var m;t.value=t.value.bind((m=r.proxy_)!=null?m:r.target_)}return f.make_(r,e,t,n)}function rP(r,e,t,n){var i,s;if(t.get)return Vn.extend_(r,e,t,n);if(t.set)return r.defineProperty_(e,{configurable:Z.safeDescriptors?r.isPlainObject_:!0,set:ri(e.toString(),t.set)},n);if(typeof t.value=="function"&&(i=this.options_)!=null&&i.autoBind){var o;t.value=t.value.bind((o=r.proxy_)!=null?o:r.target_)}var a=((s=this.options_)==null?void 0:s.deep)===!1?lt.ref:lt;return a.extend_(r,e,t,n)}function iP(r,e){_e("'"+this.annotationType_+"' cannot be used as a decorator")}var sP="observable",oP="observable.ref",aP="observable.shallow",cP="observable.struct",Um={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(Um);function Ka(r){return r||Um}var md=xu(sP),uP=xu(oP,{enhancer:Bu}),lP=xu(aP,{enhancer:BE}),dP=xu(cP,{enhancer:xE}),Fm=Hn(md);function Na(r){return r.deep===!0?Li:r.deep===!1?Bu:hP(r.defaultDecorator)}function fP(r){var e;return r?(e=r.defaultDecorator)!=null?e:Vm(r):void 0}function hP(r){var e,t;return r&&(e=(t=r.options_)==null?void 0:t.enhancer)!=null?e:Li}function jm(r,e,t){if(ma(e))return md.decorate_20223_(r,e);if(Ci(e)){ao(r,e,md);return}return Du(r)?r:Mr(r)?lt.object(r,e,t):Array.isArray(r)?lt.array(r,e):oo(r)?lt.map(r,e):ga(r)?lt.set(r,e):typeof r=="object"&&r!==null?r:lt.box(r,e)}Om(jm,Fm);var pP={box:function(e,t){var n=Ka(t);return new Xr(e,Na(n),n.name,!0,n.equals)},array:function(e,t){var n=Ka(t);return(Z.useProxies===!1||n.proxy===!1?IR:yR)(e,Na(n),n.name)},map:function(e,t){var n=Ka(t);return new $u(e,Na(n),n.name)},set:function(e,t){var n=Ka(t);return new Uf(e,Na(n),n.name)},object:function(e,t,n){return fi(function(){return Ku(Z.useProxies===!1||(n==null?void 0:n.proxy)===!1?Xi({},n):dR({},n),e,t)})},ref:Hn(uP),shallow:Hn(lP),deep:Fm,struct:Hn(dP)},lt=Om(jm,pP),qm="computed",yP="computed.struct",bd=Df(qm),gP=Df(yP,{equals:Mi.structural}),Vn=function(e,t){if(ma(t))return bd.decorate_20223_(e,t);if(Ci(t))return ao(e,t,bd);if(Mr(e))return Hn(Df(qm,e));var n=Mr(t)?t:{};return n.get=e,n.name||(n.name=e.name||""),new zs(n)};Object.assign(Vn,bd);Vn.struct=Hn(gP);var pp,yp,vc=0,mP=1,bP=(pp=(yp=Sc(function(){},"name"))==null?void 0:yp.configurable)!=null?pp:!1,gp={value:"action",configurable:!0,writable:!1,enumerable:!1};function ri(r,e,t,n){t===void 0&&(t=!1);function i(){return Gm(r,t,e,n||this,arguments)}return i.isMobxAction=!0,bP&&(gp.value=r,yr(i,"name",gp)),i}function Gm(r,e,t,n,i){var s=Hm(r,e);try{return t.apply(n,i)}catch(o){throw s.error_=o,o}finally{Ym(s)}}function Hm(r,e,t,n){var i=!1,s=0,o=Z.trackingDerivation,a=!e||!o;gn();var c=Z.allowStateChanges;a&&(Qi(),c=Cu(!0));var l=Lu(!0),u={runAsAction_:a,prevDerivation_:o,prevAllowStateChanges_:c,prevAllowStateReads_:l,notifySpy_:i,startTime_:s,actionId_:mP++,parentActionId_:vc};return vc=u.actionId_,u}function Ym(r){vc!==r.actionId_&&_e(30),vc=r.parentActionId_,r.error_!==void 0&&(Z.suppressReactionErrors=!0),Mu(r.prevAllowStateChanges_),Es(r.prevAllowStateReads_),mn(),r.runAsAction_&&Cr(r.prevDerivation_),Z.suppressReactionErrors=!1}function $s(r,e){var t=Cu(r);try{return e()}finally{Mu(t)}}function Cu(r){var e=Z.allowStateChanges;return Z.allowStateChanges=r,e}function Mu(r){Z.allowStateChanges=r}var Jm;Jm=Symbol.toPrimitive;var Xr=function(r){Nm(e,r);function e(n,i,s,o,a){var c;return s===void 0&&(s="ObservableValue"),a===void 0&&(a=Mi.default),c=r.call(this,s)||this,c.enhancer=void 0,c.name_=void 0,c.equals=void 0,c.hasUnreportedChange_=!1,c.interceptors_=void 0,c.changeListeners_=void 0,c.value_=void 0,c.dehancer=void 0,c.enhancer=i,c.name_=s,c.equals=a,c.value_=i(n,void 0,s),c}var t=e.prototype;return t.dehanceValue=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.set=function(i){this.value_,i=this.prepareNewValue_(i),i!==Z.UNCHANGED&&this.setNewValue_(i)},t.prepareNewValue_=function(i){if(zn(this)){var s=Wn(this,{object:this,type:gr,newValue:i});if(!s)return Z.UNCHANGED;i=s.newValue}return i=this.enhancer(i,this.value_,this.name_),this.equals(this.value_,i)?Z.UNCHANGED:i},t.setNewValue_=function(i){var s=this.value_;this.value_=i,this.reportChanged(),Yn(this)&&Jn(this,{type:gr,object:this,newValue:i,oldValue:s})},t.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},t.intercept_=function(i){return va(this,i)},t.observe_=function(i,s){return s&&i({observableKind:"value",debugObjectName:this.name_,object:this,type:gr,newValue:this.value_,oldValue:void 0}),_a(this,i)},t.raw=function(){return this.value_},t.toJSON=function(){return this.get()},t.toString=function(){return this.name_+"["+this.value_+"]"},t.valueOf=function(){return Km(this.get())},t[Jm]=function(){return this.valueOf()},e}(ba),$f=ui("ObservableValue",Xr),Qm;Qm=Symbol.toPrimitive;var zs=function(){function r(t){this.dependenciesState_=Ue.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.isBeingObserved_=!1,this.isPendingUnobservation_=!1,this.observers_=new Set,this.diffValue_=0,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=Ue.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new Ac(null),this.name_=void 0,this.triggeredBy_=void 0,this.isComputing_=!1,this.isRunningSetter_=!1,this.derivation=void 0,this.setter_=void 0,this.isTracing_=_c.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,t.get||_e(31),this.derivation=t.get,this.name_=t.name||"ComputedValue",t.set&&(this.setter_=ri("ComputedValue-setter",t.set)),this.equals_=t.equals||(t.compareStructural||t.struct?Mi.structural:Mi.default),this.scope_=t.context,this.requiresReaction_=t.requiresReaction,this.keepAlive_=!!t.keepAlive}var e=r.prototype;return e.onBecomeStale_=function(){PP(this)},e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.get=function(){if(this.isComputing_&&_e(32,this.name_,this.derivation),Z.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)wd(this)&&(this.warnAboutUntrackedRead_(),gn(),this.value_=this.computeValue_(!1),mn());else if(ib(this),wd(this)){var n=Z.trackingContext;this.keepAlive_&&!n&&(Z.trackingContext=this),this.trackAndCompute()&&EP(this),Z.trackingContext=n}var i=this.value_;if(sc(i))throw i.cause;return i},e.set=function(n){if(this.setter_){this.isRunningSetter_&&_e(33,this.name_),this.isRunningSetter_=!0;try{this.setter_.call(this.scope_,n)}finally{this.isRunningSetter_=!1}}else _e(34,this.name_)},e.trackAndCompute=function(){var n=this.value_,i=this.dependenciesState_===Ue.NOT_TRACKING_,s=this.computeValue_(!0),o=i||sc(n)||sc(s)||!this.equals_(n,s);return o&&(this.value_=s),o},e.computeValue_=function(n){this.isComputing_=!0;var i=Cu(!1),s;if(n)s=Xm(this,this.derivation,this.scope_);else if(Z.disableErrorBoundaries===!0)s=this.derivation.call(this.scope_);else try{s=this.derivation.call(this.scope_)}catch(o){s=new Ac(o)}return Mu(i),this.isComputing_=!1,s},e.suspend_=function(){this.keepAlive_||(kd(this),this.value_=void 0)},e.observe_=function(n,i){var s=this,o=!0,a=void 0;return Ni(function(){var c=s.get();if(!o||i){var l=Qi();n({observableKind:"computed",debugObjectName:s.name_,type:gr,object:s,newValue:c,oldValue:a}),Cr(l)}o=!1,a=c})},e.warnAboutUntrackedRead_=function(){},e.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},e.valueOf=function(){return Km(this.get())},e[Qm]=function(){return this.valueOf()},r}(),Ki=ui("ComputedValue",zs),Ue;(function(r){r[r.NOT_TRACKING_=-1]="NOT_TRACKING_",r[r.UP_TO_DATE_=0]="UP_TO_DATE_",r[r.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",r[r.STALE_=2]="STALE_"})(Ue||(Ue={}));var _c;(function(r){r[r.NONE=0]="NONE",r[r.LOG=1]="LOG",r[r.BREAK=2]="BREAK"})(_c||(_c={}));var Ac=function(e){this.cause=void 0,this.cause=e};function sc(r){return r instanceof Ac}function wd(r){switch(r.dependenciesState_){case Ue.UP_TO_DATE_:return!1;case Ue.NOT_TRACKING_:case Ue.STALE_:return!0;case Ue.POSSIBLY_STALE_:{for(var e=Lu(!0),t=Qi(),n=r.observing_,i=n.length,s=0;s<i;s++){var o=n[s];if(Ki(o)){if(Z.disableErrorBoundaries)o.get();else try{o.get()}catch{return Cr(t),Es(e),!0}if(r.dependenciesState_===Ue.STALE_)return Cr(t),Es(e),!0}}return Zm(r),Cr(t),Es(e),!1}}}function ka(){return Z.trackingDerivation!==null}function Xm(r,e,t){var n=Lu(!0);Zm(r),r.newObserving_=new Array(r.observing_.length+100),r.unboundDepsCount_=0,r.runId_=++Z.runId;var i=Z.trackingDerivation;Z.trackingDerivation=r,Z.inBatch++;var s;if(Z.disableErrorBoundaries===!0)s=e.call(t);else try{s=e.call(t)}catch(o){s=new Ac(o)}return Z.inBatch--,Z.trackingDerivation=i,wP(r),Es(n),s}function wP(r){for(var e=r.observing_,t=r.observing_=r.newObserving_,n=Ue.UP_TO_DATE_,i=0,s=r.unboundDepsCount_,o=0;o<s;o++){var a=t[o];a.diffValue_===0&&(a.diffValue_=1,i!==o&&(t[i]=a),i++),a.dependenciesState_>n&&(n=a.dependenciesState_)}for(t.length=i,r.newObserving_=null,s=e.length;s--;){var c=e[s];c.diffValue_===0&&nb(c,r),c.diffValue_=0}for(;i--;){var l=t[i];l.diffValue_===1&&(l.diffValue_=0,IP(l,r))}n!==Ue.UP_TO_DATE_&&(r.dependenciesState_=n,r.onBecomeStale_())}function kd(r){var e=r.observing_;r.observing_=[];for(var t=e.length;t--;)nb(e[t],r);r.dependenciesState_=Ue.NOT_TRACKING_}function zf(r){var e=Qi();try{return r()}finally{Cr(e)}}function Qi(){var r=Z.trackingDerivation;return Z.trackingDerivation=null,r}function Cr(r){Z.trackingDerivation=r}function Lu(r){var e=Z.allowStateReads;return Z.allowStateReads=r,e}function Es(r){Z.allowStateReads=r}function Zm(r){if(r.dependenciesState_!==Ue.UP_TO_DATE_){r.dependenciesState_=Ue.UP_TO_DATE_;for(var e=r.observing_,t=e.length;t--;)e[t].lowestObserverState_=Ue.UP_TO_DATE_}}var kP=["mobxGuid","spyListeners","enforceActions","computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","allowStateReads","disableErrorBoundaries","runId","UNCHANGED","useProxies"],Co=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.batchId=Number.MIN_SAFE_INTEGER,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0,this.stateVersion=Number.MIN_SAFE_INTEGER},oc=!0,eb=!1,Z=function(){var r=Mf();return r.__mobxInstanceCount>0&&!r.__mobxGlobals&&(oc=!1),r.__mobxGlobals&&r.__mobxGlobals.version!==new Co().version&&(oc=!1),oc?r.__mobxGlobals?(r.__mobxInstanceCount+=1,r.__mobxGlobals.UNCHANGED||(r.__mobxGlobals.UNCHANGED={}),r.__mobxGlobals):(r.__mobxInstanceCount=1,r.__mobxGlobals=new Co):(setTimeout(function(){eb||_e(35)},1),new Co)}();function SP(){if((Z.pendingReactions.length||Z.inBatch||Z.isRunningReactions)&&_e(36),eb=!0,oc){var r=Mf();--r.__mobxInstanceCount===0&&(r.__mobxGlobals=void 0),Z=new Co}}function tb(){return Z}function vP(){var r=new Co;for(var e in r)kP.indexOf(e)===-1&&(Z[e]=r[e]);Z.allowStateChanges=!Z.enforceActions}function _P(r){return r.observers_&&r.observers_.size>0}function AP(r){return r.observers_}function IP(r,e){r.observers_.add(e),r.lowestObserverState_>e.dependenciesState_&&(r.lowestObserverState_=e.dependenciesState_)}function nb(r,e){r.observers_.delete(e),r.observers_.size===0&&rb(r)}function rb(r){r.isPendingUnobservation_===!1&&(r.isPendingUnobservation_=!0,Z.pendingUnobservations.push(r))}function gn(){Z.inBatch===0&&(Z.batchId=Z.batchId<Number.MAX_SAFE_INTEGER?Z.batchId+1:Number.MIN_SAFE_INTEGER),Z.inBatch++}function mn(){if(--Z.inBatch===0){ob();for(var r=Z.pendingUnobservations,e=0;e<r.length;e++){var t=r[e];t.isPendingUnobservation_=!1,t.observers_.size===0&&(t.isBeingObserved_&&(t.isBeingObserved_=!1,t.onBUO()),t instanceof zs&&t.suspend_())}Z.pendingUnobservations=[]}}function ib(r){var e=Z.trackingDerivation;return e!==null?(e.runId_!==r.lastAccessedBy_&&(r.lastAccessedBy_=e.runId_,e.newObserving_[e.unboundDepsCount_++]=r,!r.isBeingObserved_&&Z.trackingContext&&(r.isBeingObserved_=!0,r.onBO())),r.isBeingObserved_):(r.observers_.size===0&&Z.inBatch>0&&rb(r),!1)}function sb(r){r.lowestObserverState_!==Ue.STALE_&&(r.lowestObserverState_=Ue.STALE_,r.observers_.forEach(function(e){e.dependenciesState_===Ue.UP_TO_DATE_&&e.onBecomeStale_(),e.dependenciesState_=Ue.STALE_}))}function EP(r){r.lowestObserverState_!==Ue.STALE_&&(r.lowestObserverState_=Ue.STALE_,r.observers_.forEach(function(e){e.dependenciesState_===Ue.POSSIBLY_STALE_?e.dependenciesState_=Ue.STALE_:e.dependenciesState_===Ue.UP_TO_DATE_&&(r.lowestObserverState_=Ue.UP_TO_DATE_)}))}function PP(r){r.lowestObserverState_===Ue.UP_TO_DATE_&&(r.lowestObserverState_=Ue.POSSIBLY_STALE_,r.observers_.forEach(function(e){e.dependenciesState_===Ue.UP_TO_DATE_&&(e.dependenciesState_=Ue.POSSIBLY_STALE_,e.onBecomeStale_())}))}var Jo=function(){function r(t,n,i,s){t===void 0&&(t="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=Ue.NOT_TRACKING_,this.diffValue_=0,this.runId_=0,this.unboundDepsCount_=0,this.isDisposed_=!1,this.isScheduled_=!1,this.isTrackPending_=!1,this.isRunning_=!1,this.isTracing_=_c.NONE,this.name_=t,this.onInvalidate_=n,this.errorHandler_=i,this.requiresObservable_=s}var e=r.prototype;return e.onBecomeStale_=function(){this.schedule_()},e.schedule_=function(){this.isScheduled_||(this.isScheduled_=!0,Z.pendingReactions.push(this),ob())},e.isScheduled=function(){return this.isScheduled_},e.runReaction_=function(){if(!this.isDisposed_){gn(),this.isScheduled_=!1;var n=Z.trackingContext;if(Z.trackingContext=this,wd(this)){this.isTrackPending_=!0;try{this.onInvalidate_()}catch(i){this.reportExceptionInDerivation_(i)}}Z.trackingContext=n,mn()}},e.track=function(n){if(!this.isDisposed_){gn(),this.isRunning_=!0;var i=Z.trackingContext;Z.trackingContext=this;var s=Xm(this,n,void 0);Z.trackingContext=i,this.isRunning_=!1,this.isTrackPending_=!1,this.isDisposed_&&kd(this),sc(s)&&this.reportExceptionInDerivation_(s.cause),mn()}},e.reportExceptionInDerivation_=function(n){var i=this;if(this.errorHandler_){this.errorHandler_(n,this);return}if(Z.disableErrorBoundaries)throw n;var s="[mobx] uncaught error in '"+this+"'";Z.suppressReactionErrors||console.error(s,n),Z.globalReactionErrorHandlers.forEach(function(o){return o(n,i)})},e.dispose=function(){this.isDisposed_||(this.isDisposed_=!0,this.isRunning_||(gn(),kd(this),mn()))},e.getDisposer_=function(n){var i=this,s=function o(){i.dispose(),n==null||n.removeEventListener==null||n.removeEventListener("abort",o)};return n==null||n.addEventListener==null||n.addEventListener("abort",s),s[fe]=this,s},e.toString=function(){return"Reaction["+this.name_+"]"},e.trace=function(n){},r}();function RP(r){return Z.globalReactionErrorHandlers.push(r),function(){var e=Z.globalReactionErrorHandlers.indexOf(r);e>=0&&Z.globalReactionErrorHandlers.splice(e,1)}}var TP=100,Sd=function(e){return e()};function ob(){Z.inBatch>0||Z.isRunningReactions||Sd(OP)}function OP(){Z.isRunningReactions=!0;for(var r=Z.pendingReactions,e=0;r.length>0;){++e===TP&&(console.error("[mobx] cycle in reaction: "+r[0]),r.splice(0));for(var t=r.splice(0),n=0,i=t.length;n<i;n++)t[n].runReaction_()}Z.isRunningReactions=!1}var Ic=ui("Reaction",Jo);function BP(r){var e=Sd;Sd=function(n){return r(function(){return e(n)})}}function Mo(){return!1}function ab(r){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var cb="action",xP="action.bound",ub="autoAction",CP="autoAction.bound",lb="<unnamed action>",vd=wa(cb),MP=wa(xP,{bound:!0}),_d=wa(ub,{autoAction:!0}),LP=wa(CP,{autoAction:!0,bound:!0});function db(r){var e=function(n,i){if(Cn(n))return ri(n.name||lb,n,r);if(Cn(i))return ri(n,i,r);if(ma(i))return(r?_d:vd).decorate_20223_(n,i);if(Ci(i))return ao(n,i,r?_d:vd);if(Ci(n))return Hn(wa(r?ub:cb,{name:n,autoAction:r}))};return e}var St=db(!1);Object.assign(St,vd);var Ws=db(!0);Object.assign(Ws,_d);St.bound=Hn(MP);Ws.bound=Hn(LP);function Qo(r){return Gm(r.name||lb,!1,r,this,void 0)}function li(r){return Cn(r)&&r.isMobxAction===!0}function Ni(r,e){var t,n,i,s,o;e===void 0&&(e=Lf);var a=(t=(n=e)==null?void 0:n.name)!=null?t:"Autorun",c=!e.scheduler&&!e.delay,l;if(c)l=new Jo(a,function(){this.track(m)},e.onError,e.requiresObservable);else{var u=fb(e),f=!1;l=new Jo(a,function(){f||(f=!0,u(function(){f=!1,l.isDisposed_||l.track(m)}))},e.onError,e.requiresObservable)}function m(){r(l)}return(i=e)!=null&&(s=i.signal)!=null&&s.aborted||l.schedule_(),l.getDisposer_((o=e)==null?void 0:o.signal)}var KP=function(e){return e()};function fb(r){return r.scheduler?r.scheduler:r.delay?function(e){return setTimeout(e,r.delay)}:KP}function hb(r,e,t){var n,i,s,o;t===void 0&&(t=Lf);var a=(n=t.name)!=null?n:"Reaction",c=St(a,t.onError?NP(t.onError,e):e),l=!t.scheduler&&!t.delay,u=fb(t),f=!0,m=!1,y,S,p=t.compareStructural?Mi.structural:t.equals||Mi.default,w=new Jo(a,function(){f||l?v():m||(m=!0,u(v))},t.onError,t.requiresObservable);function v(){if(m=!1,!w.isDisposed_){var E=!1;w.track(function(){var P=$s(!1,function(){return r(w)});E=f||!p(y,P),S=y,y=P}),(f&&t.fireImmediately||!f&&E)&&c(y,S,w),f=!1}}return(i=t)!=null&&(s=i.signal)!=null&&s.aborted||w.schedule_(),w.getDisposer_((o=t)==null?void 0:o.signal)}function NP(r,e){return function(){try{return e.apply(this,arguments)}catch(t){r.call(this,t)}}}var DP="onBO",$P="onBUO";function pb(r,e,t){return yb(DP,r,e,t)}function Sa(r,e,t){return yb($P,r,e,t)}function yb(r,e,t,n){var i=typeof n=="function"?br(e,t):br(e),s=Cn(n)?n:t,o=r+"L";return i[o]?i[o].add(s):i[o]=new Set([s]),function(){var a=i[o];a&&(a.delete(s),a.size===0&&delete i[o])}}var zP="never",Da="always",WP="observed";function VP(r){r.isolateGlobalState===!0&&SP();var e=r.useProxies,t=r.enforceActions;if(e!==void 0&&(Z.useProxies=e===Da?!0:e===zP?!1:typeof Proxy<"u"),e==="ifavailable"&&(Z.verifyProxies=!0),t!==void 0){var n=t===Da?Da:t===WP;Z.enforceActions=n,Z.allowStateChanges=!(n===!0||n===Da)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(i){i in r&&(Z[i]=!!r[i])}),Z.allowStateReads=!Z.observableRequiresReaction,r.reactionScheduler&&BP(r.reactionScheduler)}function Ku(r,e,t,n){var i=vE(e);return fi(function(){var s=Xi(r,n)[fe];Ds(i).forEach(function(o){s.extend_(o,i[o],t&&o in t?t[o]:!0)})}),r}function UP(r,e){return gb(br(r,e))}function gb(r){var e={name:r.name_};return r.observing_&&r.observing_.length>0&&(e.dependencies=jP(r.observing_).map(gb)),e}function FP(r,e){return mb(br(r,e))}function mb(r){var e={name:r.name_};return _P(r)&&(e.observers=Array.from(AP(r)).map(mb)),e}function jP(r){return Array.from(new Set(r))}var qP=0;function Nu(){this.message="FLOW_CANCELLED"}Nu.prototype=Object.create(Error.prototype);function GP(r){return r instanceof Nu}var Bl=zm("flow"),HP=zm("flow.bound",{bound:!0}),Di=Object.assign(function(e,t){if(ma(t))return Bl.decorate_20223_(e,t);if(Ci(t))return ao(e,t,Bl);var n=e,i=n.name||"<unnamed flow>",s=function(){var a=this,c=arguments,l=++qP,u=St(i+" - runid: "+l+" - init",n).apply(a,c),f,m=void 0,y=new Promise(function(S,p){var w=0;f=p;function v(K){m=void 0;var T;try{T=St(i+" - runid: "+l+" - yield "+w++,u.next).call(u,K)}catch(b){return p(b)}P(T)}function E(K){m=void 0;var T;try{T=St(i+" - runid: "+l+" - yield "+w++,u.throw).call(u,K)}catch(b){return p(b)}P(T)}function P(K){if(Cn(K==null?void 0:K.then)){K.then(P,p);return}return K.done?S(K.value):(m=Promise.resolve(K.value),m.then(v,E))}v(void 0)});return y.cancel=St(i+" - runid: "+l+" - cancel",function(){try{m&&mp(m);var S=u.return(void 0),p=Promise.resolve(S.value);p.then(gs,gs),mp(p),f(new Nu)}catch(w){f(w)}}),y};return s.isMobXFlow=!0,s},Bl);Di.bound=Hn(HP);function mp(r){Cn(r.cancel)&&r.cancel()}function YP(r){return r}function Vs(r){return(r==null?void 0:r.isMobXFlow)===!0}function JP(r,e,t){var n;return Nt(r)||Vt(r)||$f(r)?n=wr(r):Lt(r)&&(n=wr(r,e)),n.dehancer=typeof e=="function"?e:t,function(){n.dehancer=void 0}}function QP(r,e,t){return Cn(t)?ZP(r,e,t):XP(r,e)}function XP(r,e){return wr(r).intercept_(e)}function ZP(r,e,t){return wr(r,e).intercept_(t)}function bb(r,e){if(e===void 0)return Ki(r);if(Lt(r)===!1||!r[fe].values_.has(e))return!1;var t=br(r,e);return Ki(t)}function wb(r){return bb(r)}function ac(r,e){return bb(r,e)}function kb(r,e){return r?e!==void 0?Lt(r)?r[fe].values_.has(e):!1:Lt(r)||!!r[fe]||Nf(r)||Ic(r)||Ki(r):!1}function Du(r){return kb(r)}function eR(r,e){return kb(r,e)}function Us(r){if(Lt(r))return r[fe].keys_();if(Nt(r)||ln(r))return Array.from(r.keys());if(Vt(r))return r.map(function(e,t){return t});_e(5)}function Sb(r){if(Lt(r))return Us(r).map(function(e){return r[e]});if(Nt(r))return Us(r).map(function(e){return r.get(e)});if(ln(r))return Array.from(r.values());if(Vt(r))return r.slice();_e(6)}function vb(r){if(Lt(r))return Us(r).map(function(e){return[e,r[e]]});if(Nt(r))return Us(r).map(function(e){return[e,r.get(e)]});if(ln(r))return Array.from(r.entries());if(Vt(r))return r.map(function(e,t){return[t,e]});_e(7)}function _b(r,e,t){if(arguments.length===2&&!ln(r)){gn();var n=e;try{for(var i in n)_b(r,i,n[i])}finally{mn()}return}Lt(r)?r[fe].set_(e,t):Nt(r)?r.set(e,t):ln(r)?r.add(e):Vt(r)?(typeof e!="number"&&(e=parseInt(e,10)),e<0&&_e("Invalid index: '"+e+"'"),gn(),e>=r.length&&(r.length=e+1),r[e]=t,mn()):_e(8)}function tR(r,e){Lt(r)?r[fe].delete_(e):Nt(r)||ln(r)?r.delete(e):Vt(r)?(typeof e!="number"&&(e=parseInt(e,10)),r.splice(e,1)):_e(9)}function Ab(r,e){if(Lt(r))return r[fe].has_(e);if(Nt(r))return r.has(e);if(ln(r))return r.has(e);if(Vt(r))return e>=0&&e<r.length;_e(10)}function nR(r,e){if(!!Ab(r,e)){if(Lt(r))return r[fe].get_(e);if(Nt(r))return r.get(e);if(Vt(r))return r[e];_e(11)}}function rR(r,e,t){if(Lt(r))return r[fe].defineProperty_(e,t);_e(39)}function Ib(r){if(Lt(r))return r[fe].ownKeys_();_e(38)}function Fs(r,e,t,n){return Cn(t)?sR(r,e,t,n):iR(r,e,t)}function iR(r,e,t){return wr(r).observe_(e,t)}function sR(r,e,t,n){return wr(r,e).observe_(t,n)}function $a(r,e,t){return r.set(e,t),t}function us(r,e){if(r==null||typeof r!="object"||r instanceof Date||!Du(r))return r;if($f(r)||Ki(r))return us(r.get(),e);if(e.has(r))return e.get(r);if(Vt(r)){var t=$a(e,r,new Array(r.length));return r.forEach(function(o,a){t[a]=us(o,e)}),t}if(ln(r)){var n=$a(e,r,new Set);return r.forEach(function(o){n.add(us(o,e))}),n}if(Nt(r)){var i=$a(e,r,new Map);return r.forEach(function(o,a){i.set(a,us(o,e))}),i}else{var s=$a(e,r,{});return Ib(r).forEach(function(o){pa.propertyIsEnumerable.call(r,o)&&(s[o]=us(r[o],e))}),s}}function oR(r,e){return us(r,new Map)}function aR(){}function $n(r,e){e===void 0&&(e=void 0),gn();try{return r.apply(e)}finally{mn()}}function cR(r,e,t){return arguments.length===1||e&&typeof e=="object"?uR(r,e):Eb(r,e,t||{})}function Eb(r,e,t){var n;if(typeof t.timeout=="number"){var i=new Error("WHEN_TIMEOUT");n=setTimeout(function(){if(!o[fe].isDisposed_)if(o(),t.onError)t.onError(i);else throw i},t.timeout)}t.name="When";var s=ri("When-effect",e),o=Ni(function(a){var c=$s(!1,r);c&&(a.dispose(),n&&clearTimeout(n),s())},t);return o}function uR(r,e){var t;if(e!=null&&(t=e.signal)!=null&&t.aborted)return Object.assign(Promise.reject(new Error("WHEN_ABORTED")),{cancel:function(){return null}});var n,i,s=new Promise(function(o,a){var c,l=Eb(r,o,ni({},e,{onError:a}));n=function(){l(),a(new Error("WHEN_CANCELLED"))},i=function(){l(),a(new Error("WHEN_ABORTED"))},e==null||(c=e.signal)==null||c.addEventListener==null||c.addEventListener("abort",i)}).finally(function(){var o;return e==null||(o=e.signal)==null||o.removeEventListener==null?void 0:o.removeEventListener("abort",i)});return s.cancel=n,s}function rs(r){return r[fe]}var lR={has:function(e,t){return rs(e).has_(t)},get:function(e,t){return rs(e).get_(t)},set:function(e,t,n){var i;return Ci(t)?(i=rs(e).set_(t,n,!0))!=null?i:!0:!1},deleteProperty:function(e,t){var n;return Ci(t)?(n=rs(e).delete_(t,!0))!=null?n:!0:!1},defineProperty:function(e,t,n){var i;return(i=rs(e).defineProperty_(t,n))!=null?i:!0},ownKeys:function(e){return rs(e).ownKeys_()},preventExtensions:function(e){_e(13)}};function dR(r,e){var t,n;return Bm(),r=Xi(r,e),(n=(t=r[fe]).proxy_)!=null?n:t.proxy_=new Proxy(r,lR)}function zn(r){return r.interceptors_!==void 0&&r.interceptors_.length>0}function va(r,e){var t=r.interceptors_||(r.interceptors_=[]);return t.push(e),xm(function(){var n=t.indexOf(e);n!==-1&&t.splice(n,1)})}function Wn(r,e){var t=Qi();try{for(var n=[].concat(r.interceptors_||[]),i=0,s=n.length;i<s&&(e=n[i](e),e&&!e.type&&_e(14),!!e);i++);return e}finally{Cr(t)}}function Yn(r){return r.changeListeners_!==void 0&&r.changeListeners_.length>0}function _a(r,e){var t=r.changeListeners_||(r.changeListeners_=[]);return t.push(e),xm(function(){var n=t.indexOf(e);n!==-1&&t.splice(n,1)})}function Jn(r,e){var t=Qi(),n=r.changeListeners_;if(!!n){n=n.slice();for(var i=0,s=n.length;i<s;i++)n[i](e);Cr(t)}}function Wf(r,e,t){return fi(function(){var n,i=Xi(r,t)[fe];(n=e)!=null||(e=EE(r)),Ds(e).forEach(function(s){return i.make_(s,e[s])})}),r}var xl=Symbol("mobx-keys");function fR(r,e,t){return Mr(r)?Ku(r,r,e,t):(fi(function(){var n=Xi(r,t)[fe];if(!r[xl]){var i=Object.getPrototypeOf(r),s=new Set([].concat(Ds(r),Ds(i)));s.delete("constructor"),s.delete(fe),ya(i,xl,s)}r[xl].forEach(function(o){return n.make_(o,e&&o in e?e[o]:!0)})}),r)}var bp="splice",gr="update",hR=1e4,pR={get:function(e,t){var n=e[fe];return t===fe?n:t==="length"?n.getArrayLength_():typeof t=="string"&&!isNaN(t)?n.get_(parseInt(t)):xr(Ec,t)?Ec[t]:e[t]},set:function(e,t,n){var i=e[fe];return t==="length"&&i.setArrayLength_(n),typeof t=="symbol"||isNaN(t)?e[t]=n:i.set_(parseInt(t),n),!0},preventExtensions:function(){_e(15)}},Vf=function(){function r(t,n,i,s){t===void 0&&(t="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=i,this.legacyMode_=s,this.atom_=new ba(t),this.enhancer_=function(o,a){return n(o,a,"ObservableArray[..]")}}var e=r.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.dehanceValues_=function(n){return this.dehancer!==void 0&&n.length>0?n.map(this.dehancer):n},e.intercept_=function(n){return va(this,n)},e.observe_=function(n,i){return i===void 0&&(i=!1),i&&n({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),_a(this,n)},e.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},e.setArrayLength_=function(n){(typeof n!="number"||isNaN(n)||n<0)&&_e("Out of range: "+n);var i=this.values_.length;if(n!==i)if(n>i){for(var s=new Array(n-i),o=0;o<n-i;o++)s[o]=void 0;this.spliceWithArray_(i,0,s)}else this.spliceWithArray_(n,i-n)},e.updateArrayLength_=function(n,i){n!==this.lastKnownLength_&&_e(16),this.lastKnownLength_+=i,this.legacyMode_&&i>0&&Lb(n+i+1)},e.spliceWithArray_=function(n,i,s){var o=this;this.atom_;var a=this.values_.length;if(n===void 0?n=0:n>a?n=a:n<0&&(n=Math.max(0,a+n)),arguments.length===1?i=a-n:i==null?i=0:i=Math.max(0,Math.min(i,a-n)),s===void 0&&(s=yd),zn(this)){var c=Wn(this,{object:this.proxy_,type:bp,index:n,removedCount:i,added:s});if(!c)return yd;i=c.removedCount,s=c.added}if(s=s.length===0?s:s.map(function(f){return o.enhancer_(f,void 0)}),this.legacyMode_){var l=s.length-i;this.updateArrayLength_(a,l)}var u=this.spliceItemsIntoValues_(n,i,s);return(i!==0||s.length!==0)&&this.notifyArraySplice_(n,s,u),this.dehanceValues_(u)},e.spliceItemsIntoValues_=function(n,i,s){if(s.length<hR){var o;return(o=this.values_).splice.apply(o,[n,i].concat(s))}else{var a=this.values_.slice(n,n+i),c=this.values_.slice(n+i);this.values_.length+=s.length-i;for(var l=0;l<s.length;l++)this.values_[n+l]=s[l];for(var u=0;u<c.length;u++)this.values_[n+s.length+u]=c[u];return a}},e.notifyArrayChildUpdate_=function(n,i,s){var o=!this.owned_&&Mo(),a=Yn(this),c=a||o?{observableKind:"array",object:this.proxy_,type:gr,debugObjectName:this.atom_.name_,index:n,newValue:i,oldValue:s}:null;this.atom_.reportChanged(),a&&Jn(this,c)},e.notifyArraySplice_=function(n,i,s){var o=!this.owned_&&Mo(),a=Yn(this),c=a||o?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:bp,index:n,removed:s,added:i,removedCount:s.length,addedCount:i.length}:null;this.atom_.reportChanged(),a&&Jn(this,c)},e.get_=function(n){if(this.legacyMode_&&n>=this.values_.length){console.warn("[mobx] Out of bounds read: "+n);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[n])},e.set_=function(n,i){var s=this.values_;if(this.legacyMode_&&n>s.length&&_e(17,n,s.length),n<s.length){this.atom_;var o=s[n];if(zn(this)){var a=Wn(this,{type:gr,object:this.proxy_,index:n,newValue:i});if(!a)return;i=a.newValue}i=this.enhancer_(i,o);var c=i!==o;c&&(s[n]=i,this.notifyArrayChildUpdate_(n,i,o))}else{for(var l=new Array(n+1-s.length),u=0;u<l.length-1;u++)l[u]=void 0;l[l.length-1]=i,this.spliceWithArray_(s.length,0,l)}},r}();function yR(r,e,t,n){return t===void 0&&(t="ObservableArray"),n===void 0&&(n=!1),Bm(),fi(function(){var i=new Vf(t,e,n,!1);Mm(i.values_,fe,i);var s=new Proxy(i.values_,pR);return i.proxy_=s,r&&r.length&&i.spliceWithArray_(0,0,r),s})}var Ec={clear:function(){return this.splice(0)},replace:function(e){var t=this[fe];return t.spliceWithArray_(0,t.values_.length,e)},toJSON:function(){return this.slice()},splice:function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];var o=this[fe];switch(arguments.length){case 0:return[];case 1:return o.spliceWithArray_(e);case 2:return o.spliceWithArray_(e,t)}return o.spliceWithArray_(e,t,i)},spliceWithArray:function(e,t,n){return this[fe].spliceWithArray_(e,t,n)},push:function(){for(var e=this[fe],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.spliceWithArray_(e.values_.length,0,n),e.values_.length},pop:function(){return this.splice(Math.max(this[fe].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=this[fe],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.spliceWithArray_(0,0,n),e.values_.length},reverse:function(){return Z.trackingDerivation&&_e(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){Z.trackingDerivation&&_e(37,"sort");var e=this.slice();return e.sort.apply(e,arguments),this.replace(e),this},remove:function(e){var t=this[fe],n=t.dehanceValues_(t.values_).indexOf(e);return n>-1?(this.splice(n,1),!0):!1}};Kt("concat",Kr);Kt("flat",Kr);Kt("includes",Kr);Kt("indexOf",Kr);Kt("join",Kr);Kt("lastIndexOf",Kr);Kt("slice",Kr);Kt("toString",Kr);Kt("toLocaleString",Kr);Kt("every",di);Kt("filter",di);Kt("find",di);Kt("findIndex",di);Kt("flatMap",di);Kt("forEach",di);Kt("map",di);Kt("some",di);Kt("reduce",Pb);Kt("reduceRight",Pb);function Kt(r,e){typeof Array.prototype[r]=="function"&&(Ec[r]=e(r))}function Kr(r){return function(){var e=this[fe];e.atom_.reportObserved();var t=e.dehanceValues_(e.values_);return t[r].apply(t,arguments)}}function di(r){return function(e,t){var n=this,i=this[fe];i.atom_.reportObserved();var s=i.dehanceValues_(i.values_);return s[r](function(o,a){return e.call(t,o,a,n)})}}function Pb(r){return function(){var e=this,t=this[fe];t.atom_.reportObserved();var n=t.dehanceValues_(t.values_),i=arguments[0];return arguments[0]=function(s,o,a){return i(s,o,a,e)},n[r].apply(n,arguments)}}var gR=ui("ObservableArrayAdministration",Vf);function Vt(r){return Tu(r)&&gR(r[fe])}var Rb,Tb,mR={},qr="add",Pc="delete";Rb=Symbol.iterator;Tb=Symbol.toStringTag;var $u=function(){function r(t,n,i){var s=this;n===void 0&&(n=Li),i===void 0&&(i="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[fe]=mR,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=n,this.name_=i,Cn(Map)||_e(18),fi(function(){s.keysAtom_=Ou("ObservableMap.keys()"),s.data_=new Map,s.hasMap_=new Map,t&&s.merge(t)})}var e=r.prototype;return e.has_=function(n){return this.data_.has(n)},e.has=function(n){var i=this;if(!Z.trackingDerivation)return this.has_(n);var s=this.hasMap_.get(n);if(!s){var o=s=new Xr(this.has_(n),Bu,"ObservableMap.key?",!1);this.hasMap_.set(n,o),Sa(o,function(){return i.hasMap_.delete(n)})}return s.get()},e.set=function(n,i){var s=this.has_(n);if(zn(this)){var o=Wn(this,{type:s?gr:qr,object:this,newValue:i,name:n});if(!o)return this;i=o.newValue}return s?this.updateValue_(n,i):this.addValue_(n,i),this},e.delete=function(n){var i=this;if(this.keysAtom_,zn(this)){var s=Wn(this,{type:Pc,object:this,name:n});if(!s)return!1}if(this.has_(n)){var o=Mo(),a=Yn(this),c=a||o?{observableKind:"map",debugObjectName:this.name_,type:Pc,object:this,oldValue:this.data_.get(n).value_,name:n}:null;return $n(function(){var l;i.keysAtom_.reportChanged(),(l=i.hasMap_.get(n))==null||l.setNewValue_(!1);var u=i.data_.get(n);u.setNewValue_(void 0),i.data_.delete(n)}),a&&Jn(this,c),!0}return!1},e.updateValue_=function(n,i){var s=this.data_.get(n);if(i=s.prepareNewValue_(i),i!==Z.UNCHANGED){var o=Mo(),a=Yn(this),c=a||o?{observableKind:"map",debugObjectName:this.name_,type:gr,object:this,oldValue:s.value_,name:n,newValue:i}:null;s.setNewValue_(i),a&&Jn(this,c)}},e.addValue_=function(n,i){var s=this;this.keysAtom_,$n(function(){var l,u=new Xr(i,s.enhancer_,"ObservableMap.key",!1);s.data_.set(n,u),i=u.value_,(l=s.hasMap_.get(n))==null||l.setNewValue_(!0),s.keysAtom_.reportChanged()});var o=Mo(),a=Yn(this),c=a||o?{observableKind:"map",debugObjectName:this.name_,type:qr,object:this,name:n,newValue:i}:null;a&&Jn(this,c)},e.get=function(n){return this.has(n)?this.dehanceValue_(this.data_.get(n).get()):this.dehanceValue_(void 0)},e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},e.values=function(){var n=this,i=this.keys();return Xo({next:function(){var o=i.next(),a=o.done,c=o.value;return{done:a,value:a?void 0:n.get(c)}}})},e.entries=function(){var n=this,i=this.keys();return Xo({next:function(){var o=i.next(),a=o.done,c=o.value;return{done:a,value:a?void 0:[c,n.get(c)]}}})},e[Rb]=function(){return this.entries()},e.forEach=function(n,i){for(var s=ms(this),o;!(o=s()).done;){var a=o.value,c=a[0],l=a[1];n.call(i,l,c,this)}},e.merge=function(n){var i=this;return Nt(n)&&(n=new Map(n)),$n(function(){Mr(n)?SE(n).forEach(function(s){return i.set(s,n[s])}):Array.isArray(n)?n.forEach(function(s){var o=s[0],a=s[1];return i.set(o,a)}):oo(n)?(n.constructor!==Map&&_e(19,n),n.forEach(function(s,o){return i.set(o,s)})):n!=null&&_e(20,n)}),this},e.clear=function(){var n=this;$n(function(){zf(function(){for(var i=ms(n.keys()),s;!(s=i()).done;){var o=s.value;n.delete(o)}})})},e.replace=function(n){var i=this;return $n(function(){for(var s=bR(n),o=new Map,a=!1,c=ms(i.data_.keys()),l;!(l=c()).done;){var u=l.value;if(!s.has(u)){var f=i.delete(u);if(f)a=!0;else{var m=i.data_.get(u);o.set(u,m)}}}for(var y=ms(s.entries()),S;!(S=y()).done;){var p=S.value,w=p[0],v=p[1],E=i.data_.has(w);if(i.set(w,v),i.data_.has(w)){var P=i.data_.get(w);o.set(w,P),E||(a=!0)}}if(!a)if(i.data_.size!==o.size)i.keysAtom_.reportChanged();else for(var K=i.data_.keys(),T=o.keys(),b=K.next(),_=T.next();!b.done;){if(b.value!==_.value){i.keysAtom_.reportChanged();break}b=K.next(),_=T.next()}i.data_=o}),this},e.toString=function(){return"[object ObservableMap]"},e.toJSON=function(){return Array.from(this)},e.observe_=function(n,i){return _a(this,n)},e.intercept_=function(n){return va(this,n)},Kf(r,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Tb,get:function(){return"Map"}}]),r}(),Nt=ui("ObservableMap",$u);function bR(r){if(oo(r)||Nt(r))return r;if(Array.isArray(r))return new Map(r);if(Mr(r)){var e=new Map;for(var t in r)e.set(t,r[t]);return e}else return _e(21,r)}var Ob,Bb,wR={};Ob=Symbol.iterator;Bb=Symbol.toStringTag;var Uf=function(){function r(t,n,i){var s=this;n===void 0&&(n=Li),i===void 0&&(i="ObservableSet"),this.name_=void 0,this[fe]=wR,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=i,Cn(Set)||_e(22),this.enhancer_=function(o,a){return n(o,a,i)},fi(function(){s.atom_=Ou(s.name_),t&&s.replace(t)})}var e=r.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.clear=function(){var n=this;$n(function(){zf(function(){for(var i=ms(n.data_.values()),s;!(s=i()).done;){var o=s.value;n.delete(o)}})})},e.forEach=function(n,i){for(var s=ms(this),o;!(o=s()).done;){var a=o.value;n.call(i,a,a,this)}},e.add=function(n){var i=this;if(this.atom_,zn(this)){var s=Wn(this,{type:qr,object:this,newValue:n});if(!s)return this}if(!this.has(n)){$n(function(){i.data_.add(i.enhancer_(n,void 0)),i.atom_.reportChanged()});var o=!1,a=Yn(this),c=a||o?{observableKind:"set",debugObjectName:this.name_,type:qr,object:this,newValue:n}:null;a&&Jn(this,c)}return this},e.delete=function(n){var i=this;if(zn(this)){var s=Wn(this,{type:Pc,object:this,oldValue:n});if(!s)return!1}if(this.has(n)){var o=!1,a=Yn(this),c=a||o?{observableKind:"set",debugObjectName:this.name_,type:Pc,object:this,oldValue:n}:null;return $n(function(){i.atom_.reportChanged(),i.data_.delete(n)}),a&&Jn(this,c),!0}return!1},e.has=function(n){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(n))},e.entries=function(){var n=0,i=Array.from(this.keys()),s=Array.from(this.values());return Xo({next:function(){var a=n;return n+=1,a<s.length?{value:[i[a],s[a]],done:!1}:{done:!0}}})},e.keys=function(){return this.values()},e.values=function(){this.atom_.reportObserved();var n=this,i=0,s=Array.from(this.data_.values());return Xo({next:function(){return i<s.length?{value:n.dehanceValue_(s[i++]),done:!1}:{done:!0}}})},e.replace=function(n){var i=this;return ln(n)&&(n=new Set(n)),$n(function(){Array.isArray(n)?(i.clear(),n.forEach(function(s){return i.add(s)})):ga(n)?(i.clear(),n.forEach(function(s){return i.add(s)})):n!=null&&_e("Cannot initialize set from "+n)}),this},e.observe_=function(n,i){return _a(this,n)},e.intercept_=function(n){return va(this,n)},e.toJSON=function(){return Array.from(this)},e.toString=function(){return"[object ObservableSet]"},e[Ob]=function(){return this.values()},Kf(r,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Bb,get:function(){return"Set"}}]),r}(),ln=ui("ObservableSet",Uf),wp=Object.create(null),kp="remove",xb=function(){function r(t,n,i,s){n===void 0&&(n=new Map),s===void 0&&(s=tP),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=t,this.values_=n,this.name_=i,this.defaultAnnotation_=s,this.keysAtom_=new ba("ObservableObject.keys"),this.isPlainObject_=Mr(this.target_)}var e=r.prototype;return e.getObservablePropValue_=function(n){return this.values_.get(n).get()},e.setObservablePropValue_=function(n,i){var s=this.values_.get(n);if(s instanceof zs)return s.set(i),!0;if(zn(this)){var o=Wn(this,{type:gr,object:this.proxy_||this.target_,name:n,newValue:i});if(!o)return null;i=o.newValue}if(i=s.prepareNewValue_(i),i!==Z.UNCHANGED){var a=Yn(this),c=!1,l=a||c?{type:gr,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:s.value_,name:n,newValue:i}:null;s.setNewValue_(i),a&&Jn(this,l)}return!0},e.get_=function(n){return Z.trackingDerivation&&!xr(this.target_,n)&&this.has_(n),this.target_[n]},e.set_=function(n,i,s){return s===void 0&&(s=!1),xr(this.target_,n)?this.values_.has(n)?this.setObservablePropValue_(n,i):s?Reflect.set(this.target_,n,i):(this.target_[n]=i,!0):this.extend_(n,{value:i,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,s)},e.has_=function(n){if(!Z.trackingDerivation)return n in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var i=this.pendingKeys_.get(n);return i||(i=new Xr(n in this.target_,Bu,"ObservableObject.key?",!1),this.pendingKeys_.set(n,i)),i.get()},e.make_=function(n,i){if(i===!0&&(i=this.defaultAnnotation_),i!==!1){if(!(n in this.target_)){var s;if((s=this.target_[pr])!=null&&s[n])return;_e(1,i.annotationType_,this.name_+"."+n.toString())}for(var o=this.target_;o&&o!==pa;){var a=Sc(o,n);if(a){var c=i.make_(this,n,a,o);if(c===0)return;if(c===1)break}o=Object.getPrototypeOf(o)}vp(this,i,n)}},e.extend_=function(n,i,s,o){if(o===void 0&&(o=!1),s===!0&&(s=this.defaultAnnotation_),s===!1)return this.defineProperty_(n,i,o);var a=s.extend_(this,n,i,o);return a&&vp(this,s,n),a},e.defineProperty_=function(n,i,s){s===void 0&&(s=!1),this.keysAtom_;try{gn();var o=this.delete_(n);if(!o)return o;if(zn(this)){var a=Wn(this,{object:this.proxy_||this.target_,name:n,type:qr,newValue:i.value});if(!a)return null;var c=a.newValue;i.value!==c&&(i=ni({},i,{value:c}))}if(s){if(!Reflect.defineProperty(this.target_,n,i))return!1}else yr(this.target_,n,i);this.notifyPropertyAddition_(n,i.value)}finally{mn()}return!0},e.defineObservableProperty_=function(n,i,s,o){o===void 0&&(o=!1),this.keysAtom_;try{gn();var a=this.delete_(n);if(!a)return a;if(zn(this)){var c=Wn(this,{object:this.proxy_||this.target_,name:n,type:qr,newValue:i});if(!c)return null;i=c.newValue}var l=Sp(n),u={configurable:Z.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:l.get,set:l.set};if(o){if(!Reflect.defineProperty(this.target_,n,u))return!1}else yr(this.target_,n,u);var f=new Xr(i,s,"ObservableObject.key",!1);this.values_.set(n,f),this.notifyPropertyAddition_(n,f.value_)}finally{mn()}return!0},e.defineComputedProperty_=function(n,i,s){s===void 0&&(s=!1),this.keysAtom_;try{gn();var o=this.delete_(n);if(!o)return o;if(zn(this)){var a=Wn(this,{object:this.proxy_||this.target_,name:n,type:qr,newValue:void 0});if(!a)return null}i.name||(i.name="ObservableObject.key"),i.context=this.proxy_||this.target_;var c=Sp(n),l={configurable:Z.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:c.get,set:c.set};if(s){if(!Reflect.defineProperty(this.target_,n,l))return!1}else yr(this.target_,n,l);this.values_.set(n,new zs(i)),this.notifyPropertyAddition_(n,void 0)}finally{mn()}return!0},e.delete_=function(n,i){if(i===void 0&&(i=!1),this.keysAtom_,!xr(this.target_,n))return!0;if(zn(this)){var s=Wn(this,{object:this.proxy_||this.target_,name:n,type:kp});if(!s)return null}try{var o,a;gn();var c=Yn(this),l=!1,u=this.values_.get(n),f=void 0;if(!u&&(c||l)){var m;f=(m=Sc(this.target_,n))==null?void 0:m.value}if(i){if(!Reflect.deleteProperty(this.target_,n))return!1}else delete this.target_[n];if(u&&(this.values_.delete(n),u instanceof Xr&&(f=u.value_),sb(u)),this.keysAtom_.reportChanged(),(o=this.pendingKeys_)==null||(a=o.get(n))==null||a.set(n in this.target_),c||l){var y={type:kp,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:f,name:n};c&&Jn(this,y)}}finally{mn()}return!0},e.observe_=function(n,i){return _a(this,n)},e.intercept_=function(n){return va(this,n)},e.notifyPropertyAddition_=function(n,i){var s,o,a=Yn(this),c=!1;if(a||c){var l=a||c?{type:qr,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:n,newValue:i}:null;a&&Jn(this,l)}(s=this.pendingKeys_)==null||(o=s.get(n))==null||o.set(!0),this.keysAtom_.reportChanged()},e.ownKeys_=function(){return this.keysAtom_.reportObserved(),Ds(this.target_)},e.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},r}();function Xi(r,e){var t;if(xr(r,fe))return r;var n=(t=e==null?void 0:e.name)!=null?t:"ObservableObject",i=new xb(r,new Map,String(n),fP(e));return ya(r,fe,i),r}var kR=ui("ObservableObjectAdministration",xb);function Sp(r){return wp[r]||(wp[r]={get:function(){return this[fe].getObservablePropValue_(r)},set:function(t){return this[fe].setObservablePropValue_(r,t)}})}function Lt(r){return Tu(r)?kR(r[fe]):!1}function vp(r,e,t){var n;(n=r.target_[pr])==null||delete n[t]}var SR=Mb(0),vR=function(){var r=!1,e={};return Object.defineProperty(e,"0",{set:function(){r=!0}}),Object.create(e)[0]=1,r===!1}(),Cl=0,Cb=function(){};function _R(r,e){Object.setPrototypeOf?Object.setPrototypeOf(r.prototype,e):r.prototype.__proto__!==void 0?r.prototype.__proto__=e:r.prototype=e}_R(Cb,Array.prototype);var Ff=function(r,e,t){Nm(n,r);function n(s,o,a,c){var l;return a===void 0&&(a="ObservableArray"),c===void 0&&(c=!1),l=r.call(this)||this,fi(function(){var u=new Vf(a,o,c,!0);u.proxy_=Ol(l),Mm(Ol(l),fe,u),s&&s.length&&l.spliceWithArray(0,0,s),vR&&Object.defineProperty(Ol(l),"0",SR)}),l}var i=n.prototype;return i.concat=function(){this[fe].atom_.reportObserved();for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return Array.prototype.concat.apply(this.slice(),a.map(function(l){return Vt(l)?l.slice():l}))},i[t]=function(){var s=this,o=0;return Xo({next:function(){return o<s.length?{value:s[o++],done:!1}:{done:!0,value:void 0}}})},Kf(n,[{key:"length",get:function(){return this[fe].getArrayLength_()},set:function(o){this[fe].setArrayLength_(o)}},{key:e,get:function(){return"Array"}}]),n}(Cb,Symbol.toStringTag,Symbol.iterator);Object.entries(Ec).forEach(function(r){var e=r[0],t=r[1];e!=="concat"&&ya(Ff.prototype,e,t)});function Mb(r){return{enumerable:!1,configurable:!0,get:function(){return this[fe].get_(r)},set:function(t){this[fe].set_(r,t)}}}function AR(r){yr(Ff.prototype,""+r,Mb(r))}function Lb(r){if(r>Cl){for(var e=Cl;e<r+100;e++)AR(e);Cl=r}}Lb(1e3);function IR(r,e,t){return new Ff(r,e,t)}function br(r,e){if(typeof r=="object"&&r!==null){if(Vt(r))return e!==void 0&&_e(23),r[fe].atom_;if(ln(r))return r.atom_;if(Nt(r)){if(e===void 0)return r.keysAtom_;var t=r.data_.get(e)||r.hasMap_.get(e);return t||_e(25,e,Rc(r)),t}if(Lt(r)){if(!e)return _e(26);var n=r[fe].values_.get(e);return n||_e(27,e,Rc(r)),n}if(Nf(r)||Ki(r)||Ic(r))return r}else if(Cn(r)&&Ic(r[fe]))return r[fe];_e(28)}function wr(r,e){if(r||_e(29),e!==void 0)return wr(br(r,e));if(Nf(r)||Ki(r)||Ic(r)||Nt(r)||ln(r))return r;if(r[fe])return r[fe];_e(24,r)}function Rc(r,e){var t;if(e!==void 0)t=br(r,e);else{if(li(r))return r.name;Lt(r)||Nt(r)||ln(r)?t=wr(r):t=br(r)}return t.name_}function fi(r){var e=Qi(),t=Cu(!0);gn();try{return r()}finally{mn(),Mu(t),Cr(e)}}var _p=pa.toString;function jf(r,e,t){return t===void 0&&(t=-1),Ad(r,e,t)}function Ad(r,e,t,n,i){if(r===e)return r!==0||1/r===1/e;if(r==null||e==null)return!1;if(r!==r)return e!==e;var s=typeof r;if(s!=="function"&&s!=="object"&&typeof e!="object")return!1;var o=_p.call(r);if(o!==_p.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+r==""+e;case"[object Number]":return+r!=+r?+e!=+e:+r==0?1/+r===1/e:+r==+e;case"[object Date]":case"[object Boolean]":return+r==+e;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(r)===Symbol.valueOf.call(e);case"[object Map]":case"[object Set]":t>=0&&t++;break}r=Ap(r),e=Ap(e);var a=o==="[object Array]";if(!a){if(typeof r!="object"||typeof e!="object")return!1;var c=r.constructor,l=e.constructor;if(c!==l&&!(Cn(c)&&c instanceof c&&Cn(l)&&l instanceof l)&&"constructor"in r&&"constructor"in e)return!1}if(t===0)return!1;t<0&&(t=-1),n=n||[],i=i||[];for(var u=n.length;u--;)if(n[u]===r)return i[u]===e;if(n.push(r),i.push(e),a){if(u=r.length,u!==e.length)return!1;for(;u--;)if(!Ad(r[u],e[u],t-1,n,i))return!1}else{var f=Object.keys(r),m;if(u=f.length,Object.keys(e).length!==u)return!1;for(;u--;)if(m=f[u],!(xr(e,m)&&Ad(r[m],e[m],t-1,n,i)))return!1}return n.pop(),i.pop(),!0}function Ap(r){return Vt(r)?r.slice():oo(r)||Nt(r)||ga(r)||ln(r)?Array.from(r.entries()):r}function Xo(r){return r[Symbol.iterator]=ER,r}function ER(){return this}["Symbol","Map","Set"].forEach(function(r){var e=Mf();typeof e[r]>"u"&&_e("MobX requires global '"+r+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:ab,extras:{getDebugName:Rc},$mobx:fe});var PR=Object.freeze(Object.defineProperty({__proto__:null,$mobx:fe,FlowCancellationError:Nu,ObservableMap:$u,ObservableSet:Uf,Reaction:Jo,_allowStateChanges:$s,_allowStateChangesInsideComputed:Qo,_allowStateReadsEnd:Es,_allowStateReadsStart:Lu,_autoAction:Ws,_endAction:Ym,_getAdministration:wr,_getGlobalState:tb,_interceptReads:JP,_isComputingDerivation:ka,_resetGlobalState:vP,_startAction:Hm,action:St,autorun:Ni,comparer:Mi,computed:Vn,configure:VP,createAtom:Ou,defineProperty:rR,entries:vb,extendObservable:Ku,flow:Di,flowResult:YP,get:nR,getAtom:br,getDebugName:Rc,getDependencyTree:UP,getObserverTree:FP,has:Ab,intercept:QP,isAction:li,isBoxedObservable:$f,isComputed:wb,isComputedProp:ac,isFlow:Vs,isFlowCancellationError:GP,isObservable:Du,isObservableArray:Vt,isObservableMap:Nt,isObservableObject:Lt,isObservableProp:eR,isObservableSet:ln,keys:Us,makeAutoObservable:fR,makeObservable:Wf,observable:lt,observe:Fs,onBecomeObserved:pb,onBecomeUnobserved:Sa,onReactionError:RP,override:CE,ownKeys:Ib,reaction:hb,remove:tR,runInAction:Qo,set:_b,spy:ab,toJS:oR,trace:aR,transaction:$n,untracked:zf,values:Sb,when:cR},Symbol.toStringTag,{value:"Module"})),Kb=Hs(PR);(function(r){var e=z&&z.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(r,"__esModule",{value:!0}),r.Order=r.OrderSide=void 0;const t=et,n=e(Tm.exports),i=Kb;var s;(function(a){a.Buy="buy",a.Sell="sell"})(s=r.OrderSide||(r.OrderSide={}));class o{constructor(c){this.id="",this.orderType=s.Buy,this.orderMint="",this.currencyMint="",this.currencyDecimals=0,this.price=new t.BN(0),this.orderQtyRemaining=0,this.orderOriginationQty=0,this.owner="",this.ownerAssetTokenAccount="",this.ownerCurrencyTokenAccount="",this.createdAt=0,this.slotContext=0,c&&(this.id=c.id,this.orderType=c.orderType,this.orderMint=c.orderMint,this.currencyMint=c.currencyMint,this.currencyDecimals=c.currencyDecimals,this.price=c.price,this.orderQtyRemaining=c.orderQtyRemaining,this.orderOriginationQty=c.orderOriginationQty,this.owner=c.owner,this.ownerAssetTokenAccount=c.ownerAssetTokenAccount,this.ownerCurrencyTokenAccount=c.ownerCurrencyTokenAccount,this.createdAt=c.createdAt,this.slotContext=c.slotContext),(0,i.makeObservable)(this,{orderQtyRemaining:i.observable})}get decimalDivisor(){return new n.default(10).pow(this.currencyDecimals)}get bigNumberPrice(){return new n.default(this.price.toString())}get uiPrice(){return this.bigNumberPrice.div(this.decimalDivisor).toNumber()}priceForQuantity(c=1){return this.bigNumberPrice.mul(c).div(this.decimalDivisor).toNumber()}}r.Order=o})(Ru);(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Ru,r)})(Pu);var RR=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Eu,"__esModule",{value:!0});Eu.createExchangeInstruction=void 0;const za=et,Wa=Lr,TR=_n,Ip=ai,OR=ai,Ml=Fn,Ll=Pu;function BR({connection:r,orderAccount:e,purchaseQty:t,orderTaker:n,orderTakerDepositTokenAccount:i,programId:s,expectedPrice:o,orderType:a,assetMint:c,currencyMint:l,orderInitializer:u,saVault:f,stakingProgramId:m,registeredStake:y,stakingAccount:S,extraAccounts:p=[]}){return RR(this,void 0,void 0,function*(){const w=(0,TR.getMarketplaceProgram)({connection:r,programId:s}),v={signers:[],instructions:[]},E=a===Ll.OrderSide.Sell?new Wa.PublicKey(c):new Wa.PublicKey(l),P=a===Ll.OrderSide.Sell?new Wa.PublicKey(l):new Wa.PublicKey(c);let K=null,T=null,b=null,_=yield(0,Ml.getTokenAccount)(r,u,E,n);"createInstruction"in _?(v.instructions.push(..._.createInstruction),_.tokenAccount instanceof za.web3.Keypair?(K=_.tokenAccount.publicKey,v.signers.push(_.tokenAccount)):K=_.tokenAccount):K=_.tokenAccount,_=yield(0,Ml.getTokenAccount)(r,u,P,n),"createInstruction"in _?(v.instructions.push(..._.createInstruction),_.tokenAccount instanceof za.web3.Keypair?(T=_.tokenAccount.publicKey,v.signers.push(_.tokenAccount)):T=_.tokenAccount):T=_.tokenAccount;const[R]=yield(0,Ip.getOrderVault)(u,E,s),[W]=yield(0,OR.getOpenOrdersCounter)(u,E,s);_=yield(0,Ml.getTokenAccount)(r,n,E),"createInstruction"in _?(v.instructions.push(..._.createInstruction),_.tokenAccount instanceof za.web3.Keypair?(b=_.tokenAccount.publicKey,v.signers.push(_.tokenAccount)):b=_.tokenAccount):b=_.tokenAccount;const B=a===Ll.OrderSide.Buy?n:u,[V]=yield(0,Ip.getFeeExemptAccount)(B,s),q=yield w.methods.processExchange(new za.BN(t),o,B).accounts({orderTaker:n,orderTakerDepositTokenAccount:i,orderTakerReceiveTokenAccount:b,currencyMint:l,assetMint:c,orderInitializer:u,initializerDepositTokenAccount:K,initializerReceiveTokenAccount:T,orderVaultAccount:R,orderAccount:e,openOrdersCounter:W,saVault:f,atlasStaking:m,registeredStake:y,stakingAccount:S,feeReduction:V}).remainingAccounts(p).instruction();return v.instructions.push(q),v})}Eu.createExchangeInstruction=BR;var zu={},xR=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(zu,"__esModule",{value:!0});zu.createInitializeMarketInstruction=void 0;const CR=_n;function MR({connection:r,updateAuthorityAccount:e,programId:t}){return xR(this,void 0,void 0,function*(){const i=[yield(0,CR.getMarketplaceProgram)({connection:r,programId:t}).methods.initializeMarketplace().accounts({updateAuthorityAccount:e}).instruction()];return{accounts:[],instructions:i}})}zu.createInitializeMarketInstruction=MR;var Wu={},LR=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Wu,"__esModule",{value:!0});Wu.createRegisterCurrencyInstruction=void 0;const KR=et,NR=_n;function DR({connection:r,updateAuthorityAccount:e,royalty:t,saCurrencyVault:n,currencyMint:i,programId:s}){return LR(this,void 0,void 0,function*(){const a=[yield(0,NR.getMarketplaceProgram)({connection:r,programId:s}).methods.registerCurrency(new KR.BN(t)).accounts({updateAuthorityAccount:e,saCurrencyVault:n,currencyMint:i}).instruction()];return{accounts:[],instructions:a}})}Wu.createRegisterCurrencyInstruction=DR;var Zr={},qf=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Zr,"__esModule",{value:!0});Zr.updateRoyaltyTier=Zr.deleteRoyaltyTier=Zr.addRoyaltyTier=void 0;const Zo=et,Gf=_n;function $R({connection:r,updateAuthorityAccount:e,registeredCurrency:t,stakeAmount:n,discount:i,programId:s}){return qf(this,void 0,void 0,function*(){const o=(0,Gf.getMarketplaceProgram)({connection:r,programId:s}),a={signers:[],instructions:[]},c=yield o.methods.addRoyaltyTier(new Zo.BN(n),new Zo.BN(i)).accounts({updateAuthorityAccount:e,registeredCurrency:t}).instruction();return a.instructions.push(c),a})}Zr.addRoyaltyTier=$R;function zR({connection:r,updateAuthorityAccount:e,registeredCurrency:t,stakeAmount:n,programId:i}){return qf(this,void 0,void 0,function*(){const s=(0,Gf.getMarketplaceProgram)({connection:r,programId:i}),o={signers:[],instructions:[]},a=yield s.methods.deleteRoyaltyTier(new Zo.BN(n)).accounts({updateAuthorityAccount:e,registeredCurrency:t}).instruction();return o.instructions.push(a),o})}Zr.deleteRoyaltyTier=zR;function WR({connection:r,updateAuthorityAccount:e,registeredCurrency:t,stakeAmount:n,discount:i,programId:s}){return qf(this,void 0,void 0,function*(){const o=(0,Gf.getMarketplaceProgram)({connection:r,programId:s}),a={signers:[],instructions:[]},c=yield o.methods.updateRoyaltyTier(new Zo.BN(n),new Zo.BN(i)).accounts({updateAuthorityAccount:e,registeredCurrency:t}).instruction();return a.instructions.push(c),a})}Zr.updateRoyaltyTier=WR;var js={},Nb=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(js,"__esModule",{value:!0});js.createUpdateRegisteredCurrencyVaultInstruction=js.createUpdateRegisteredCurrencyRoyaltyInstruction=void 0;const VR=et,Db=_n;function UR({connection:r,updateAuthorityAccount:e,royalty:t,currencyMint:n,programId:i}){return Nb(this,void 0,void 0,function*(){return[yield(0,Db.getMarketplaceProgram)({connection:r,programId:i}).methods.updateCurrencyRoyalty(new VR.BN(t)).accounts({updateAuthorityAccount:e,currencyMint:n}).instruction()]})}js.createUpdateRegisteredCurrencyRoyaltyInstruction=UR;function FR({connection:r,updateAuthorityAccount:e,saCurrencyVault:t,currencyMint:n,programId:i}){return Nb(this,void 0,void 0,function*(){return[yield(0,Db.getMarketplaceProgram)({connection:r,programId:i}).methods.updateCurrencyVault().accounts({updateAuthorityAccount:e,saCurrencyVault:t,currencyMint:n}).instruction()]})}js.createUpdateRegisteredCurrencyVaultInstruction=FR;var qs={},$b=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(qs,"__esModule",{value:!0});qs.createRemoveFeeExemptionInstruction=qs.createAddFeeExemptionInstruction=void 0;const jR=et,zb=_n,Tc=ai;function qR({connection:r,updateAuthorityAccount:e,funder:t,feeExemptTarget:n,programId:i}){return $b(this,void 0,void 0,function*(){const s=(0,zb.getMarketplaceProgram)({connection:r,programId:i}),o={signers:[],instructions:[]},a=1e6,[c]=yield(0,Tc.getFeeExemptAccount)(n,i),[l]=yield(0,Tc.getMarketVarsAccount)(i),u=[yield s.methods.addFeeExemption(new jR.BN(a)).accounts({updateAuthorityMaster:e,funder:t,feeExemptTarget:n,feeExemptAccount:c,marketVarsAccount:l}).instruction()];return o.instructions.push(...u),o})}qs.createAddFeeExemptionInstruction=qR;function GR({connection:r,updateAuthorityAccount:e,funder:t,feeExemptTarget:n,programId:i}){return $b(this,void 0,void 0,function*(){const s=(0,zb.getMarketplaceProgram)({connection:r,programId:i}),o={signers:[],instructions:[]},[a]=yield(0,Tc.getFeeExemptAccount)(n,i),[c]=yield(0,Tc.getMarketVarsAccount)(i),l=[yield s.methods.removeFeeExemption().accounts({updateAuthorityMaster:e,funder:t,feeExemptAccount:a,feeExemptTarget:n,marketVarsAccount:c}).instruction()];return o.instructions.push(...l),o})}qs.createRemoveFeeExemptionInstruction=GR;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(km,r),t(vu,r),t(Ns,r),t(Iu,r),t(Eu,r),t(zu,r),t(Wu,r),t(Zr,r),t(js,r),t(qs,r)})(Bf);var co={},Wb={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.GmLogs=void 0,function(e){e.CancelOrderMemo="CancelOrderMemo",e.ExchangeMemo="ExchangeMemo",e.InitializeMemo="InitializeMemo",e.RegisterCurrencyMemo="RegisterCurrencyMemo"}(r.GmLogs||(r.GmLogs={}))})(Wb);var Vb={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.GmEventType=void 0,function(e){e[e.orderAdded=0]="orderAdded",e[e.orderRemoved=1]="orderRemoved",e[e.orderModified=2]="orderModified"}(r.GmEventType||(r.GmEventType={}))})(Vb);(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(fa,r),t(Wb,r),t(Vb,r)})(co);var Ub={},Vu={},Fb=function(){},HR=function(r){return r};function jb(r){throw new Error("[mobx-utils] "+r)}function ii(r,e){e===void 0&&(e="Illegal state"),r||jb(e)}function qb(r,e,t){Object.defineProperty(r,e,{enumerable:!1,writable:!0,configurable:!0,value:t})}var Gb=function(r){return r&&r!==Object.prototype&&Object.getOwnPropertyNames(r).concat(Gb(Object.getPrototypeOf(r))||[])},YR=function(r){var e=Gb(r),t=e.filter(function(n,i){return e.indexOf(n)===i});return t},Id=function(r){return YR(r).filter(function(e){return e!=="constructor"&&!~e.indexOf("__")})},Oc="pending",ea="fulfilled",Uu="rejected";function JR(r){switch(this.state){case Oc:return r.pending&&r.pending(this.value);case Uu:return r.rejected&&r.rejected(this.value);case ea:return r.fulfilled?r.fulfilled(this.value):this.value}}function Ed(r,e){if(ii(arguments.length<=2,"fromPromise expects up to two arguments"),ii(typeof r=="function"||typeof r=="object"&&r&&typeof r.then=="function","Please pass a promise or function to fromPromise"),r.isPromiseBasedObservable===!0)return r;typeof r=="function"&&(r=new Promise(r));var t=r;r.then(St("observableFromPromise-resolve",function(i){t.value=i,t.state=ea}),St("observableFromPromise-reject",function(i){t.value=i,t.state=Uu})),t.isPromiseBasedObservable=!0,t.case=JR;var n=e&&(e.state===ea||e.state===Oc)?e.value:void 0;return Ku(t,{value:n,state:Oc},{},{deep:!1}),t}(function(r){r.reject=St("fromPromise.reject",function(t){var n=r(Promise.reject(t));return n.state=Uu,n.value=t,n});function e(t){t===void 0&&(t=void 0);var n=r(Promise.resolve(t));return n.state=ea,n.value=t,n}r.resolve=St("fromPromise.resolve",e)})(Ed||(Ed={}));function QR(r){return r&&r.isPromiseBasedObservable===!0}var Ep=function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n};function XR(r,e,t){if(Pp(r,e),Pp(r,t),e!==t){var n=r.slice(),i;return e<t?i=Ep(n.slice(0,e),n.slice(e+1,t+1),[n[e]],n.slice(t+1)):i=Ep(n.slice(0,t),[n[e]],n.slice(t,e),n.slice(e+1)),r.replace(i),r}}function Pp(r,e){if(e<0)throw new Error("[mobx.array] Index out of bounds: "+e+" is negative");var t=r.length;if(e>=t)throw new Error("[mobx.array] Index out of bounds: "+e+" is not smaller than "+t)}function ZR(r,e){e===void 0&&(e=void 0);var t=!1,n=lt.box(e,{deep:!1}),i=lt.box(!1),s=function(){return t||(t=!0,$s(!0,function(){i.set(!0)}),r(function(a){$s(!0,function(){n.set(a),i.set(!1)})})),n.get()},o=St("lazyObservable-reset",function(){return t=!1,n.set(e),n.get()});return{current:s,refresh:function(){return t?(t=!1,s()):n.get()},reset:function(){return o()},get pending(){return i.get()}}}function Hf(r,e,t){e===void 0&&(e=Fb),t===void 0&&(t=void 0);var n=!1,i=!1,s=t,o=function(){n&&(n=!1,e())},a=Ou("ResourceBasedObservable",function(){ii(!n&&!i),n=!0,r(function(c){$s(!0,function(){s=c,a.reportChanged()})})},o);return{current:function(){ii(!i,"subscribingObservable has already been disposed");var c=a.reportObserved();return!c&&!n&&console.warn("Called `get` of a subscribingObservable outside a reaction. Current value will be returned but no new subscription has started"),s},dispose:function(){i=!0,o()},isAlive:function(){return n}}}var Va=function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s};function eT(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}function tT(r,e){var t;e===void 0&&(e=!1);var n=Vn(r);return t={subscribe:function(i){return typeof i=="function"?{unsubscribe:Fs(n,function(s){var o=s.newValue;return i(o)},e)}:i&&typeof i=="object"&&i.next?{unsubscribe:Fs(n,function(s){var o=s.newValue;return i.next(o)},e)}:{unsubscribe:function(){}}}},t[eT()]=function(){return this},t}var nT=function(){function r(e,t){var n=this;Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"subscription",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Wf(this),Qo(function(){n.current=t,n.subscription=e.subscribe(n)})}return Object.defineProperty(r.prototype,"dispose",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.subscription&&this.subscription.unsubscribe()}}),Object.defineProperty(r.prototype,"next",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.current=e}}),Object.defineProperty(r.prototype,"complete",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.dispose()}}),Object.defineProperty(r.prototype,"error",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.current=e,this.dispose()}}),Va([lt.ref],r.prototype,"current",void 0),Va([St.bound],r.prototype,"next",null),Va([St.bound],r.prototype,"complete",null),Va([St.bound],r.prototype,"error",null),r}();function rT(r,e){return e===void 0&&(e=void 0),new nT(r,e)}var Bc=function(){return Bc=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Bc.apply(this,arguments)},bo=function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},iT=["model","reset","submit","isDirty","isPropertyDirty","resetProperty"],Hb=function(){function r(e){var t=this;Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"localValues",{enumerable:!0,configurable:!0,writable:!0,value:lt.map({})}),Object.defineProperty(this,"localComputedValues",{enumerable:!0,configurable:!0,writable:!0,value:lt.map({})}),Object.defineProperty(this,"isPropertyDirty",{enumerable:!0,configurable:!0,writable:!0,value:function(i){return t.localValues.has(i)}}),Wf(this),ii(Lt(e),"createViewModel expects an observable object");var n=Id(this);Id(e).forEach(function(i){var s;if(!n.includes(i)&&!(i===fe||i==="__mobxDidRunLazyInitializers")){if(ii(iT.indexOf(i)===-1,"The propertyname "+i+" is reserved and cannot be used with viewModels"),ac(e,i)){var o=wr(e,i),a=o.derivation.bind(t),c=(s=o.setter_)===null||s===void 0?void 0:s.bind(t);t.localComputedValues.set(i,Vn(a,{set:c}))}var l=Object.getOwnPropertyDescriptor(e,i),u=l?{enumerable:l.enumerable}:{};Object.defineProperty(t,i,Bc(Bc({},u),{configurable:!0,get:function(){return ac(e,i)?t.localComputedValues.get(i).get():t.isPropertyDirty(i)?t.localValues.get(i):t.model[i]},set:St(function(f){ac(e,i)?t.localComputedValues.get(i).set(f):f!==t.model[i]?t.localValues.set(i,f):t.localValues.delete(i)})}))}})}return Object.defineProperty(r.prototype,"isDirty",{get:function(){return this.localValues.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"changedValues",{get:function(){return new Map(this.localValues)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"submit",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;Us(this.localValues).forEach(function(t){var n=e.localValues.get(t),i=e.model[t];Vt(i)?i.replace(n):Nt(i)?(i.clear(),i.merge(n)):wb(n)||(e.model[t]=n)}),this.localValues.clear()}}),Object.defineProperty(r.prototype,"reset",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.localValues.clear()}}),Object.defineProperty(r.prototype,"resetProperty",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.localValues.delete(e)}}),bo([Vn],r.prototype,"isDirty",null),bo([Vn],r.prototype,"changedValues",null),bo([St.bound],r.prototype,"submit",null),bo([St.bound],r.prototype,"reset",null),bo([St.bound],r.prototype,"resetProperty",null),r}();function sT(r){return new Hb(r)}function oT(r,e){var t=br(r,e);if(!t)throw new Error("No computed provided, please provide an object created with `computed(() => expr)` or an object + property name");return Fs(t,function(){})}function aT(r,e,t){if(t===void 0&&(t=0),!Vt(r))throw new Error("Expected observable array as first argument");li(e)||(e=St("queueProcessor",e));var n=function(){var i=r.slice(0);Qo(function(){return r.splice(0)}),i.forEach(e)};return t>0?Ni(n,{delay:t}):Ni(n)}function cT(r,e,t,n){if(t===void 0&&(t=0),n===void 0&&(n=0),!Vt(r))throw new Error("Expected observable array as first argument");li(e)||(e=St("chunkProcessor",e));var i=function(){for(var s=function(){var o=n===0?r.length:Math.min(r.length,n),a=r.slice(0,o);Qo(function(){return r.splice(0,o)}),e(a)};r.length>0;)s()};return t>0?Ni(i,{delay:t}):Ni(i)}var _i={};function uT(){for(var r=0,e=Object.getOwnPropertyNames(_i);r<e.length;r++){var t=e[r];_i[t].dispose(),delete _i[t]}}function lT(r){return r===void 0&&(r=1e3),ka()?(_i[r]||(typeof r=="number"?_i[r]=dT(r):_i[r]=fT()),_i[r].current()):Date.now()}function dT(r){var e;return Hf(function(t){t(Date.now()),e=setInterval(function(){return t(Date.now())},r)},function(){clearInterval(e)},Date.now())}function fT(){var r=Hf(function(e){e(Date.now());function t(){window.requestAnimationFrame(function(){e(Date.now()),r.isAlive()&&t()})}t()},function(){},Date.now());return r}function hT(r){return ka()||console.warn("'expr' should only be used inside other reactive functions."),Vn(r).get()}var xc=function(){return xc=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},xc.apply(this,arguments)},pT=0;function yT(r,e){ii(typeof r=="function"&&r.length<2,"createTransformer expects a function that accepts one argument");var t={},n=void 0,i=!1,s=void 0;typeof e=="object"?(n=e.onCleanup,i=e.keepAlive!==void 0?e.keepAlive:!1,s=e.debugNameGenerator):typeof e=="function"&&(n=e);function o(c,l){var u,f={};typeof e=="object"?(n=e.onCleanup,s=e.debugNameGenerator,f=e):typeof e=="function"?n=e:(n=void 0,s=void 0);var m=s?s(l):"Transformer-"+r.name+"-"+c,y=Vn(function(){return u=r(l)},xc(xc({},f),{name:m}));if(!i)var S=Sa(y,function(){delete t[c],S(),n&&n(u,l)});return y}var a=!1;return function(c){var l=gT(c),u=t[l];if(u)return u.get();if(!i&&!ka()){a||(console.warn("invoking a transformer from outside a reactive context won't memorized and is cleaned up immediately, unless keepAlive is set"),a=!0);var f=r(c);return n&&n(f,c),f}return u=t[l]=o(l,c),u.get()}}function gT(r){var e=typeof r;if(e==="string")return"string:"+r;if(e==="number")return"number:"+r;if(r===null||e!=="object"&&e!=="function")throw new Error("[mobx-utils] transform expected an object, function, string or number, got: "+String(r));var t=r.$transformId;return t===void 0&&(t="memoizationId:"+ ++pT,qb(r,"$transformId",t)),t}function Kl(r){if(!r)return"ROOT";for(var e=[];r.parent;)e.push(r.path),r=r.parent;return e.reverse().join("/")}function Nl(r){return Lt(r)||Vt(r)||Nt(r)}function mT(r,e){var t=new WeakMap;function n(a){var c=t.get(a.object);i(a,c),e(a,Kl(c),r)}function i(a,c){switch(a.type){case"add":s(a.newValue,c,a.name);break;case"update":o(a.oldValue),s(a.newValue,c,a.name||""+a.index);break;case"remove":case"delete":o(a.oldValue);break;case"splice":a.removed.map(o),a.added.forEach(function(f,m){return s(f,c,""+(a.index+m))});for(var l=a.index+a.addedCount;l<a.object.length;l++)if(Nl(a.object[l])){var u=t.get(a.object[l]);u&&(u.path=""+l)}break}}function s(a,c,l){if(Nl(a)){var u=t.get(a);if(u){if(u.parent!==c||u.path!==l)throw new Error("The same observable object cannot appear twice in the same tree,"+(" trying to assign it to '"+Kl(c)+"/"+l+"',")+(" but it already exists at '"+Kl(u.parent)+"/"+u.path+"'"))}else{var f={parent:c,path:l,dispose:Fs(a,n)};t.set(a,f),vb(a).forEach(function(m){var y=m[0],S=m[1];return s(S,f,y)})}}}function o(a){if(Nl(a)){var c=t.get(a);if(!c)return;t.delete(a),c.dispose(),Sb(a).forEach(o)}}return s(r,void 0,""),function(){o(r)}}var bT=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),wT=function(r){bT(e,r);function e(t,n,i){var s=i===void 0?{}:i,o=s.name,a=o===void 0?"ogm"+(Math.random()*1e3|0):o,c=s.keyToName,l=c===void 0?function(m){return""+m}:c,u=r.call(this)||this;Object.defineProperty(u,"_base",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"_ogmInfoKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"_groupBy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"_keyToName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"_disposeBaseObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),u._keyToName=l,u._groupBy=n,u._ogmInfoKey=Symbol("ogmInfo"+a),u._base=t;for(var f=0;f<t.length;f++)u._addItem(t[f]);return u._disposeBaseObserver=Fs(u._base,function(m){if(m.type==="splice")$n(function(){for(var y=0,S=m.removed;y<S.length;y++){var p=S[y];u._removeItem(p)}for(var w=0,v=m.added;w<v.length;w++){var E=v[w];u._addItem(E)}});else if(m.type==="update")$n(function(){u._removeItem(m.oldValue),u._addItem(m.newValue)});else throw new Error("illegal state")}),u}return Object.defineProperty(e.prototype,"clear",{enumerable:!1,configurable:!0,writable:!0,value:function(){throw new Error("not supported")}}),Object.defineProperty(e.prototype,"delete",{enumerable:!1,configurable:!0,writable:!0,value:function(t){throw new Error("not supported")}}),Object.defineProperty(e.prototype,"set",{enumerable:!1,configurable:!0,writable:!0,value:function(t,n){throw new Error("not supported")}}),Object.defineProperty(e.prototype,"dispose",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._disposeBaseObserver();for(var t=0;t<this._base.length;t++){var n=this._base[t],i=n[this._ogmInfoKey];i.reaction(),delete n[this._ogmInfoKey]}}}),Object.defineProperty(e.prototype,"_getGroupArr",{enumerable:!1,configurable:!0,writable:!0,value:function(t){var n=r.prototype.get.call(this,t);return n===void 0&&(n=lt([],{name:"GroupArray["+this._keyToName(t)+"]",deep:!1}),r.prototype.set.call(this,t,n)),n}}),Object.defineProperty(e.prototype,"_removeFromGroupArr",{enumerable:!1,configurable:!0,writable:!0,value:function(t,n){var i=r.prototype.get.call(this,t);i.length===1?r.prototype.delete.call(this,t):(n===i.length-1||(i[n]=i[i.length-1],i[n][this._ogmInfoKey].groupArrIndex=n),i.length--)}}),Object.defineProperty(e.prototype,"_addItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t){var n=this,i=this._groupBy(t),s=this._getGroupArr(i),o={groupByValue:i,groupArrIndex:s.length,reaction:hb(function(){return n._groupBy(t)},function(a,c){var l=t[n._ogmInfoKey];n._removeFromGroupArr(l.groupByValue,l.groupArrIndex);var u=n._getGroupArr(a),f=u.length;u.push(t),l.groupByValue=a,l.groupArrIndex=f})};Object.defineProperty(t,this._ogmInfoKey,{configurable:!0,enumerable:!1,value:o}),s.push(t)}}),Object.defineProperty(e.prototype,"_removeItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t){var n=t[this._ogmInfoKey];this._removeFromGroupArr(n.groupByValue,n.groupArrIndex),n.reaction(),delete t[this._ogmInfoKey]}}),e}($u),kT=function(){function r(e,t){Object.defineProperty(this,"base",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"closest",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"closestIdx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"isDisposed",{enumerable:!0,configurable:!0,writable:!0,value:!1});for(var n=this.closest=this.root=e,i=0;i<this.args.length-1&&(n=n.get(t[i]),n);i++)this.closest=n;this.closestIdx=i}return Object.defineProperty(r.prototype,"exists",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.assertNotDisposed();var e=this.args.length;return this.closestIdx>=e-1&&this.closest.has(this.args[e-1])}}),Object.defineProperty(r.prototype,"get",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(this.assertNotDisposed(),!this.exists())throw new Error("Entry doesn't exist");return this.closest.get(this.args[this.args.length-1])}}),Object.defineProperty(r.prototype,"set",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.assertNotDisposed();for(var t=this.args.length,n=this.closest,i=this.closestIdx;i<t-1;i++){var s=new Map;n.set(this.args[i],s),n=s}this.closestIdx=t-1,this.closest=n,n.set(this.args[t-1],e)}}),Object.defineProperty(r.prototype,"delete",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(this.assertNotDisposed(),!this.exists())throw new Error("Entry doesn't exist");var e=this.args.length;this.closest.delete(this.args[e-1]);for(var t=this.root,n=[t],i=0;i<e-1;i++)t=t.get(this.args[i]),n.push(t);for(var i=n.length-1;i>0;i--)n[i].size===0&&n[i-1].delete(this.args[i-1]);this.isDisposed=!0}}),Object.defineProperty(r.prototype,"assertNotDisposed",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(this.isDisposed)throw new Error("Concurrent modification exception")}}),r}(),ST=function(){function r(){Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"argsLength",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}return Object.defineProperty(r.prototype,"entry",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(this.argsLength===-1)this.argsLength=e.length;else if(this.argsLength!==e.length)throw new Error("DeepMap should be used with functions with a consistent length, expected: "+this.argsLength+", got: "+e.length);return this.last&&(this.last.isDisposed=!0),this.last=new kT(this.store,e)}}),r}(),Cc=function(){return Cc=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Cc.apply(this,arguments)},vT=function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n};function _T(r,e){if(e===void 0&&(e=!1),li(r))throw new Error("computedFn shouldn't be used on actions");var t=!1,n=0,i=typeof e=="boolean"?{keepAlive:e}:e,s=new ST;return function(){for(var o=this,a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];var l=s.entry(a);if(l.exists())return l.get().get();if(!i.keepAlive&&!ka())return!t&&tb().computedRequiresReaction&&(console.warn("invoking a computedFn from outside an reactive context won't be memoized, unless keepAlive is set"),t=!0),r.apply(this,a);var u,f=Vn(function(){return u=r.apply(o,a)},Cc(Cc({},i),{name:"computedFn("+(i.name||r.name)+"#"+ ++n+")"}));return l.set(f),i.keepAlive||Sa(f,function(){s.entry(a).delete(),i.onCleanup&&i.onCleanup.apply(i,vT([u],a)),u=void 0}),f.get()}}var AT=Object.freeze(Object.defineProperty({__proto__:null,FULFILLED:ea,IDENTITY:HR,NOOP:Fb,ObservableGroupMap:wT,PENDING:Oc,REJECTED:Uu,ViewModel:Hb,addHiddenProp:qb,chunkProcessor:cT,computedFn:_T,createTransformer:yT,createViewModel:sT,deepObserve:mT,expr:hT,fail:jb,get fromPromise(){return Ed},fromResource:Hf,fromStream:rT,getAllMethodsAndProperties:Id,invariant:ii,isPromiseBasedObservable:QR,keepAlive:oT,lazyObservable:ZR,moveItem:XR,now:lT,queueProcessor:aT,resetNowInternalState:uT,toStream:tT},Symbol.toStringTag,{value:"Module"})),IT=Hs(AT),Fu={};Object.defineProperty(Fu,"__esModule",{value:!0});Fu.OrderCacheService=void 0;const Rp=Hp.exports,or=Kb,Tp=Ru,Ua=co;class ET{constructor(){this.endTriggered=!1,this.observableData={buyOrdersCache:new Map,sellOrdersCache:new Map},this.orderChanges=(0,or.observable)([]),this.observableData=(0,or.makeAutoObservable)(this.observableData),(0,or.makeObservable)(this,{buyOrdersCache:or.computed,sellOrdersCache:or.computed,allOrdersCache:or.computed})}get buyOrdersCache(){return this.observableData.buyOrdersCache}get sellOrdersCache(){return this.observableData.sellOrdersCache}get allOrdersCache(){const e=new Map;return this.buyOrdersCache.forEach(t=>{t.forEach((n,i)=>{e.set(i,n)})}),this.sellOrdersCache.forEach(t=>{t.forEach((n,i)=>{e.set(i,n)})}),e}get mints(){return(0,Rp.union)(Array.from(this.buyOrdersCache.keys()),Array.from(this.sellOrdersCache.keys()))}get orders(){return this.allOrdersCache}get buyOrders(){const e=new Map;return this.buyOrdersCache.forEach(t=>{t.forEach(n=>{e.set(n.id,n)})}),e}get sellOrders(){const e=new Map;return this.sellOrdersCache.forEach(t=>{t.forEach(n=>{e.set(n.id,n)})}),e}clearOrders(){const{allOrdersCache:e}=this;e.forEach(t=>{(0,or.runInAction)(()=>{this.orderChanges.push({eventType:Ua.GmEventType.orderRemoved,order:t})})}),this.buyOrdersCache.clear(),this.sellOrdersCache.clear()}getAllOrdersCache(){return this.allOrdersCache}getOrderCacheByType(e){return e===Tp.OrderSide.Buy?this.getBuyOrderCache():this.getSellOrderCache()}getBuyOrderCache(){return new Map(this.buyOrdersCache)}getSellOrderCache(){return new Map(this.sellOrdersCache)}getOrderById(e){return this.allOrdersCache.get(e)}addOrder(e){const t=this.getOrdersForType(e.orderType);t.get(e.orderMint)||t.set(e.orderMint,new Map);const n=t.get(e.orderMint),i=n.get(e.id);return i&&i.slotContext>e.slotContext?i:(n.set(e.id,e),(0,or.runInAction)(()=>{this.orderChanges.push({eventType:Ua.GmEventType.orderAdded,order:e})}),e)}updateOrder(e){const n=this.getOrdersForType(e.orderType).get(e.orderMint),i=n.get(e.id);if(!!i){if(i.orderQtyRemaining!==e.orderQtyRemaining&&e.slotContext>i.slotContext){const s=(0,Rp.clone)(i);s.orderQtyRemaining=e.orderQtyRemaining,n.set(e.id,s),(0,or.runInAction)(()=>{this.orderChanges.push({eventType:Ua.GmEventType.orderModified,order:e})})}return e}}cancelOrder(e){return this.getOrdersForType(e.orderType).get(e.orderMint).delete(e.id)?((0,or.runInAction)(()=>{this.orderChanges.push({eventType:Ua.GmEventType.orderRemoved,order:e})}),!0):!1}getOrdersForType(e){return e===Tp.OrderSide.Buy?this.buyOrdersCache:this.sellOrdersCache}}Fu.OrderCacheService=ET;var uo={},ju={};Object.defineProperty(ju,"__esModule",{value:!0});ju.createTransactionFromInstructions=void 0;const PT=Lr,RT=r=>{const e=new PT.Transaction;return e.add(...r),e};ju.createTransactionFromInstructions=RT;var Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.TEN_THOUSAND=Gs.ONE_MILLION=void 0;Gs.ONE_MILLION=1e6;Gs.TEN_THOUSAND=1e4;var dn=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(uo,"__esModule",{value:!0});uo.GmClientService=void 0;const Wr=Lr,Fa=Bf,Ar=ai,Dl=ju,Op=Fn,is=Ru,Bp=Gs,TT=_n,OT=jc;class BT{constructor(){this.currencyInfo=[]}getRegisteredCurrencies(e,t,n=!1){var i;return dn(this,void 0,void 0,function*(){if(((i=this.currencyInfo)===null||i===void 0?void 0:i.length)&&!n)return this.currencyInfo;const s=[],o=yield(0,Ar.getAllRegisteredCurrencies)(e,t);for(const a of o){const{mint:c,royalty:l,saVault:u}=a,f=yield e.getTokenSupply(c,"recent"),{decimals:m}=f.value;s.push({decimals:m,mint:c.toString(),royaltyPercentageAsDecimal:l.toNumber()/Bp.ONE_MILLION,saVault:u.toString()})}return this.currencyInfo=s,this.currencyInfo})}getAllOpenOrders(e,t){return dn(this,void 0,void 0,function*(){const n=yield(0,Ar.getAllOpenOrders)(e,t),i=yield e.getSlot();return this.accountItemsToOrders(e,t,n,i)})}getOpenOrdersForPlayer(e,t,n){return dn(this,void 0,void 0,function*(){const i=yield(0,Ar.getOpenOrdersForPlayer)(e,t,n),s=yield e.getSlot();return this.accountItemsToOrders(e,n,i,s)})}getOpenOrdersForCurrency(e,t,n){return dn(this,void 0,void 0,function*(){const i=yield(0,Ar.getOpenOrdersForCurrency)(e,t,n),s=yield e.getSlot();return this.accountItemsToOrders(e,n,i,s)})}getOpenOrdersForAsset(e,t,n){return dn(this,void 0,void 0,function*(){const i=yield(0,Ar.getOpenOrdersForAsset)(e,t,n),s=yield e.getSlot();return this.accountItemsToOrders(e,n,i,s)})}getOpenOrdersForPlayerAndCurrency(e,t,n,i){return dn(this,void 0,void 0,function*(){const s=yield(0,Ar.getOpenOrdersForPlayerAndCurrency)(e,t,n,i),o=yield e.getSlot();return this.accountItemsToOrders(e,i,s,o)})}getOpenOrdersForPlayerAndAsset(e,t,n,i){return dn(this,void 0,void 0,function*(){const s=yield(0,Ar.getOpenOrdersForPlayerAndAsset)(e,t,n,i),o=yield e.getSlot();return this.accountItemsToOrders(e,i,s,o)})}getOpenOrder(e,t,n){return dn(this,void 0,void 0,function*(){const i=yield(0,Ar.getSingleOrder)(e,t,n),s={publicKey:t,account:i},o=yield e.getSlot(),[a]=yield this.accountItemsToOrders(e,n,[s],o);return a})}getInitializeOrderTransaction(e,t,n,i,s,o,a,c){return dn(this,void 0,void 0,function*(){let l=Fa.createInitializeSellOrderInstruction,u=n,f=i;c===is.OrderSide.Buy&&(l=Fa.createInitializeBuyOrderInstruction,u=i,f=n);const m=yield(0,Op.getAssociatedTokenAddress)(t,u),{ixSet:y}=yield l({connection:e,depositMint:u,initializerDepositTokenAccount:m,initializerMainAccount:t,originationQty:s,price:o,programId:a,receiveMint:f}),{signers:S,instructions:p}=y;return{transaction:(0,Dl.createTransactionFromInstructions)(p),signers:S}})}getBnPriceForCurrency(e,t,n,i){return dn(this,void 0,void 0,function*(){const s=yield this.getRegisteredCurrencies(e,i),{decimals:o}=s.find(a=>a.mint.toString()===n.toString());return(0,TT.convertDecimalPriceToBn)(t,o)})}getCancelOrderTransaction(e,t,n,i){return dn(this,void 0,void 0,function*(){const{instructions:s,signers:o}=yield(0,Fa.createCancelOrderInstruction)({connection:e,orderAccount:t,orderInitializer:n,programId:i});return{transaction:(0,Dl.createTransactionFromInstructions)(s),signers:o}})}getCreateExchangeTransaction(e,t,n,i,s,o=new Wr.PublicKey("ATLocKpzDbTokxgvnLew3d7drZkEzLzDpzwgrgWKDbmc"),a=new Wr.PublicKey("J5GhV1WKcEU98c1kZt36ixjaErrrPNWbZhg3JQDg114E")){return dn(this,void 0,void 0,function*(){const c=new Wr.PublicKey(t.id),l=new Wr.PublicKey(t.orderMint),u=new Wr.PublicKey(t.currencyMint),f=new Wr.PublicKey(t.owner),m=t.orderType===is.OrderSide.Buy?n:new Wr.PublicKey(t.owner),y=yield(0,Op.getAssociatedTokenAddress)(n,t.orderType===is.OrderSide.Buy?l:u),S=yield this.getRegisteredCurrencies(e,s),{saVault:p}=S.find(K=>K.mint===t.currencyMint),[w]=yield(0,OT.getStakingAccount)(o,m,a),{instructions:v,signers:E}=yield(0,Fa.createExchangeInstruction)({connection:e,orderAccount:c,purchaseQty:i,orderTaker:n,orderTakerDepositTokenAccount:y,programId:s,expectedPrice:t.price,orderType:t.orderType,assetMint:l,currencyMint:u,orderInitializer:f,saVault:new Wr.PublicKey(p),stakingProgramId:o,registeredStake:a,stakingAccount:w});return{transaction:(0,Dl.createTransactionFromInstructions)(v),signers:E}})}accountItemsToOrders(e,t,n,i){return dn(this,void 0,void 0,function*(){if(!n.length)return[];const s=yield this.getRegisteredCurrencies(e,t);return n.map(o=>{const a=o.publicKey.toString(),c=Object.keys(o.account.orderSide)[0]==="buy"?is.OrderSide.Buy:is.OrderSide.Sell,l=o.account.assetMint.toString(),u=o.account.currencyMint.toString(),f=o.account.price,m=o.account.orderRemainingQty.toNumber(),y=o.account.orderOriginationQty.toNumber(),S=o.account.orderInitializerPubkey.toString(),p=o.account.initializerAssetTokenAccount.toString(),w=o.account.initializerCurrencyTokenAccount.toString(),v=o.account.createdAtTimestamp.toNumber(),{decimals:E}=s.find(P=>P.mint.toString()===u);return new is.Order({id:a,orderType:c,orderMint:l,currencyMint:u,currencyDecimals:E,price:f,orderQtyRemaining:m,orderOriginationQty:y,owner:S,ownerAssetTokenAccount:p,ownerCurrencyTokenAccount:w,createdAt:v,slotContext:i})})})}getAllFeeExemptions(e,t){return dn(this,void 0,void 0,function*(){const n=[],i=yield(0,Ar.getAllFeeExemptAccounts)(e,t);for(const s of i)n.push({publicKey:s.account.account.toString(),feeReductionPercentageAsDecimal:s.account.discount.toNumber()/Bp.TEN_THOUSAND});return n})}}uo.GmClientService=BT;var Aa={},ja=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Aa,"__esModule",{value:!0});Aa.GmEventService=void 0;const wo=et,$l=Pu,zl=co,xT=uo,CT=_n,qa=co;class MT{constructor(e,t,n){this.registeredCurrencyInfo={},this.eventListeners=[],this.queuedEvents=[],this.connection=e,this.programId=t,this.commitment=n||e.commitment,this.handleOrderCreated=this.handleOrderCreated.bind(this),this.handleOrderExchanged=this.handleOrderExchanged.bind(this),this.handleOrderCanceled=this.handleOrderCanceled.bind(this),this.setCurrencyInfo=this.setCurrencyInfo.bind(this),this.handleCurrencyRegistered=this.handleCurrencyRegistered.bind(this)}initialize(){return ja(this,void 0,void 0,function*(){this.idl=(0,CT.getGmLogsIDL)(this.programId),this.provider=new wo.AnchorProvider(this.connection,null,{commitment:this.commitment}),this.program=new wo.Program(this.idl,this.programId,this.provider,{instruction:new wo.BorshInstructionCoder(this.idl),accounts:new wo.BorshAccountsCoder(this.idl),state:null,events:new wo.BorshEventCoder(this.idl)}),yield this.setCurrencyInfo();const e=this.program.addEventListener(qa.GmLogs.InitializeMemo,this.handleOrderCreated),t=this.program.addEventListener(qa.GmLogs.ExchangeMemo,this.handleOrderExchanged),n=this.program.addEventListener(qa.GmLogs.CancelOrderMemo,this.handleOrderCanceled),i=this.program.addEventListener(qa.GmLogs.RegisterCurrencyMemo,this.handleCurrencyRegistered);this.eventListeners.push(e,t,n,i)})}end(){return ja(this,void 0,void 0,function*(){for(const e of this.eventListeners)yield this.program.removeEventListener(e);this.eventListeners=[],this.onEvent=null})}setEventHandler(e){this.onEvent=e;for(const t of this.queuedEvents)this.onEvent(t.eventType,t.order,t.slotContext)}setCurrencyInfo(){return ja(this,void 0,void 0,function*(){const t=yield new xT.GmClientService().getRegisteredCurrencies(this.connection,this.programId,!0);for(const n of t)this.registeredCurrencyInfo[n.mint]=n})}getParsedOrderFromEvent(e,t){const n=this.registeredCurrencyInfo[e.currencyMint.toString()];if(!n)return null;const{decimals:i}=n;return new $l.Order({id:e.orderId.toString(),orderType:e.orderSide===0?$l.OrderSide.Buy:$l.OrderSide.Sell,orderMint:e.assetMint.toString(),currencyMint:e.currencyMint.toString(),currencyDecimals:i,price:e.price,orderQtyRemaining:e.orderRemainingQty.toNumber(),orderOriginationQty:e.orderOriginationQty.toNumber(),owner:e.orderInitializerPubkey.toString(),ownerAssetTokenAccount:e.initializerAssetTokenAccount.toString(),ownerCurrencyTokenAccount:e.initializerCurrencyTokenAccount.toString(),createdAt:e.createdAtTimestamp.toNumber(),slotContext:t})}handleOrderCreated(e,t){this.processEvent(zl.GmEventType.orderAdded,this.getParsedOrderFromEvent(e,t),t)}handleOrderExchanged(e,t){this.processEvent(zl.GmEventType.orderModified,this.getParsedOrderFromEvent(e,t),t)}handleOrderCanceled(e,t){this.processEvent(zl.GmEventType.orderRemoved,this.getParsedOrderFromEvent(e,t),t)}processEvent(e,t,n){if(!this.onEvent){this.queuedEvents.push({eventType:e,order:t,slotContext:n});return}this.onEvent(e,t,n)}handleCurrencyRegistered(){return ja(this,void 0,void 0,function*(){yield this.setCurrencyInfo()})}}Aa.GmEventService=MT;var ss=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Vu,"__esModule",{value:!0});Vu.GmOrderbookService=void 0;const LT=IT,KT=Hp.exports,NT=Fu,Wl=co,xp=uo,Cp=Aa;class qu{constructor(e,t,n=60){this.gmClientService=new xp.GmClientService,this.eventCallBacks=[],this.changeObserverDisposer=null,this.lastEventTimestamp=this.getNow(),this.isReloading=!1,this.connection=e,this.marketplaceProgramId=t,this.healthcheckThreshold=n,this.orderCacheService=new NT.OrderCacheService,this.gmClientService=new xp.GmClientService,this.gmEventService=new Cp.GmEventService(this.connection,this.marketplaceProgramId),this.handleMarketplaceEvent=this.handleMarketplaceEvent.bind(this)}initialize(){return ss(this,void 0,void 0,function*(){return yield this.gmEventService.initialize(),this.changeObserverDisposer=(0,LT.queueProcessor)(this.orderCacheService.orderChanges,e=>{this.eventCallBacks.forEach(t=>t.onEvent(e))},250),this.gmEventService.setEventHandler(this.handleMarketplaceEvent),yield this.loadInitialOrders(),this.healthcheckTimer=setInterval(()=>{!this.getIsServiceHealthy()&&!this.isReloading&&this.resetOrdersData()},qu.HEALTH_CHECK_RATE),this.orderCacheService.mints.length})}end(){return ss(this,void 0,void 0,function*(){return yield this.gmEventService.end(),this.eventCallBacks=[],this.changeObserverDisposer=null,!0})}getIsServiceHealthy(){return this.getNow()-this.lastEventTimestamp<=this.healthcheckThreshold}resetOrdersData(){return ss(this,void 0,void 0,function*(){this.isReloading||(this.isReloading=!0,yield this.resetEventService(),yield this.refetchOrderData(),this.lastEventTimestamp=this.getNow(),this.isReloading=!1)})}resetEventService(){return ss(this,void 0,void 0,function*(){yield this.gmEventService.end(),this.gmEventService=new Cp.GmEventService(this.connection,this.marketplaceProgramId),this.gmEventService.setEventHandler(this.handleMarketplaceEvent),yield this.gmEventService.initialize()})}refetchOrderData(){return ss(this,void 0,void 0,function*(){const e=this.orderCacheService.getAllOrdersCache();try{const t=yield this.connection.getSlot("confirmed"),n=yield this.gmClientService.getAllOpenOrders(this.connection,this.marketplaceProgramId),i=new Map;for(const s of n){i.set(s.id,s);const o=e.get(s.id);o?o&&o.orderQtyRemaining!==s.orderQtyRemaining&&this.updateOrderInCache(s):this.addOrderToCache(s)}for(const s of Array.from(e.values()))s.slotContext<t&&!i.get(s.id)&&this.removeOrderFromCache(s)}catch(t){console.log("There was an error refreshing all marketplace data",t)}})}addOnEventHandler(e){this.eventCallBacks.push(e)}removeOnEventHandler(e){(0,KT.pull)(this.eventCallBacks,e)}loadInitialOrders(){return ss(this,void 0,void 0,function*(){try{const e=yield this.gmClientService.getAllOpenOrders(this.connection,this.marketplaceProgramId);for(const t of e)this.addOrderToCache(t)}catch(e){console.log(e)}return this.orderCacheService.getAllOrdersCache().size})}addOrderToCache(e){return this.orderCacheService.addOrder(e)}removeOrderFromCache(e){return this.orderCacheService.cancelOrder(e)}updateOrderInCache(e){return this.orderCacheService.updateOrder(e)}getBuyOrders(){return this.orderCacheService.buyOrdersCache}getBuyOrdersForMint(e){return this.orderCacheService.buyOrdersCache.get(e)}getSellOrders(){return this.orderCacheService.sellOrdersCache}getSellOrdersForMint(e){return this.orderCacheService.sellOrdersCache.get(e)}getOrdersByType(e){return e==="buy"?this.getBuyOrders():this.getSellOrders()}getBuyOrdersByCurrencyAndItem(e,t){const n=this.getBuyOrdersForMint(t);if(!n)return[];const i=[...n.values()];return i.length?this.filterOrdersByCurrency(e,i):[]}getSellOrdersByCurrencyAndItem(e,t){const n=this.getSellOrdersForMint(t);if(!n)return[];const i=[...n.values()];return i.length?this.filterOrdersByCurrency(e,i):[]}filterOrdersByCurrency(e,t){return t.length?t.filter(n=>n.currencyMint===e):[]}getOrderById(e){return this.orderCacheService.getOrderById(e)}getAllOrdersByItemMint(e){const t=new Map,n=this.getSellOrdersForMint(e),i=this.getBuyOrdersForMint(e);if(n)for(const s of n.values())t.set(s.id,s);if(i)for(const s of i.values())t.set(s.id,s);return t}getAllMints(){return this.orderCacheService.mints}getAllOrdersForUserAddress(e){const t=this.orderCacheService.getAllOrdersCache();return Array.from(t.values()).filter(s=>s.owner===e)}handleOrderAddedEvent(e){this.addOrderToCache(e)}handleOrderModifiedEvent(e){if(e.orderQtyRemaining===0){this.removeOrderFromCache(e);return}this.updateOrderInCache(e)}handleOrderCanceledEvent(e){this.removeOrderFromCache(e)}handleMarketplaceEvent(e,t){if(!!t)switch(this.lastEventTimestamp=this.getNow(),e){case Wl.GmEventType.orderAdded:this.handleOrderAddedEvent(t);break;case Wl.GmEventType.orderModified:this.handleOrderModifiedEvent(t);break;case Wl.GmEventType.orderRemoved:this.handleOrderCanceledEvent(t);break}}getNow(){return new Date().getTime()/1e3}}Vu.GmOrderbookService=qu;qu.HEALTH_CHECK_RATE=5e3;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Vu,r),t(uo,r),t(Aa,r)})(Ub);(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Bf,r),t(ai,r),t(co,r),t(_n,r),t(Pu,r),t(Ub,r)})(Of);var Yb=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(xi,"__esModule",{value:!0});xi.createAccountTransaction=xi.createAccountInstruction=void 0;const Mc=et,Pd=Lr,Jb=Of;function DT(r,e,t,n){return Yb(this,void 0,void 0,function*(){const i=(0,Jb.getGmIDL)(n),s=new Mc.AnchorProvider(r,null,null),o=new Mc.Program(i,n,s);return Pd.SystemProgram.createAccount({fromPubkey:e,newAccountPubkey:t.publicKey,space:o.account.orderAccount.size,lamports:yield r.getMinimumBalanceForRentExemption(o.account.orderAccount.size),programId:n})})}xi.createAccountInstruction=DT;function $T(r,e,t,n){return Yb(this,void 0,void 0,function*(){const i=(0,Jb.getGmIDL)(n),s=new Mc.AnchorProvider(r,null,null),o=new Mc.Program(i,n,s),a=new Pd.Transaction({recentBlockhash:(yield r.getLatestBlockhash()).blockhash,feePayer:e});return a.add(Pd.SystemProgram.createAccount({fromPubkey:e,newAccountPubkey:t.publicKey,space:o.account.orderAccount.size,lamports:yield r.getMinimumBalanceForRentExemption(o.account.orderAccount.size),programId:n})),a})}xi.createAccountTransaction=$T;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(xt,r),t(Su,r),t(xi,r)})(Fn);var zT=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(au,"__esModule",{value:!0});au.harvestRewardsInstruction=void 0;const WT=et,VT=Ui,UT=Fn,FT=vn;function jT({connection:r,user:e,rewardMint:t,registeredStake:n,stakingAccount:i,programId:s}){return zT(this,void 0,void 0,function*(){const o=(0,FT.getStakingProgram)({connection:r,programId:s}),a={signers:[],instructions:[]};let c=null,l=null;const u=yield(0,UT.getTokenAccount)(r,e,t);c=u.tokenAccount,"createInstruction"in u&&a.instructions.push(...u.createInstruction),c instanceof WT.web3.Keypair?(l=c.publicKey,a.signers.push(c)):l=c;const f=yield(0,VT.associatedAddress)({owner:n,mint:t}),m=yield o.methods.harvest().accounts({user:e,rewardMint:t,registeredStake:n,stakingAccount:i,userRewardAccount:l,rewardAta:f}).instruction();return a.instructions.push(m),a})}au.harvestRewardsInstruction=jT;var Gu={},qT=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Gu,"__esModule",{value:!0});Gu.createInitializeStakingInstruction=void 0;const GT=vn;function HT({connection:r,updateAuthorityAccount:e,programId:t}){return qT(this,void 0,void 0,function*(){const n=(0,GT.getStakingProgram)({connection:r,programId:t}),i={signers:[],instructions:[]},s=yield n.methods.initializeStaking().accounts({updateAuthorityAccount:e}).instruction();return i.instructions.push(s),i})}Gu.createInitializeStakingInstruction=HT;var Hu={},Yu={},cn={},Ft={};Object.defineProperty(Ft,"__esModule",{value:!0});Ft.ESCROW_AUTH=Ft.STAKING_VARS=Ft.STAKING_ESCROW=Ft.STAKING_ACCOUNT=Ft.REWARD_AUTH=Ft.REWARD_ACCOUNT=Ft.REGISTERED_STAKE=void 0;Ft.REGISTERED_STAKE=ge.Buffer.from("registered-stake");Ft.REWARD_ACCOUNT=ge.Buffer.from("reward-account");Ft.REWARD_AUTH=ge.Buffer.from("reward-vault-authority");Ft.STAKING_ACCOUNT=ge.Buffer.from("staking-account");Ft.STAKING_ESCROW=ge.Buffer.from("staking-escrow");Ft.STAKING_VARS=ge.Buffer.from("staking-vars");Ft.ESCROW_AUTH=ge.Buffer.from("escrow-auth");var lo=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(cn,"__esModule",{value:!0});cn.getRewardAuth=cn.getTokenEscrow=cn.getStakingVarsAccount=cn.getStakingAccountsForRegisteredStake=cn.getStakingAccount=cn.getRegisteredStake=void 0;const Mp=et,Ia=Lr,YT=vn,Ea=Ft;function JT(r,e,t,n){return lo(this,void 0,void 0,function*(){return Ia.PublicKey.findProgramAddress([Ea.REGISTERED_STAKE,e.toBuffer(),t.toBuffer(),n.toBuffer()],r)})}cn.getRegisteredStake=JT;function QT(r,e,t){return lo(this,void 0,void 0,function*(){return Ia.PublicKey.findProgramAddress([Ea.STAKING_ACCOUNT,e.toBuffer(),t.toBuffer()],r)})}cn.getStakingAccount=QT;function XT(r,e,t){return lo(this,void 0,void 0,function*(){const n=new Mp.AnchorProvider(r,null,null),i=(0,YT.getStakingIdl)(e),s=new Mp.Program(i,e,n),o=[{dataSize:171},{memcmp:{offset:40,bytes:t.toBase58()}}];return yield s.account.stakingAccount.all(o)})}cn.getStakingAccountsForRegisteredStake=XT;function ZT(r){return lo(this,void 0,void 0,function*(){return Ia.PublicKey.findProgramAddress([Ea.STAKING_VARS],r)})}cn.getStakingVarsAccount=ZT;function eO(r,e,t){return lo(this,void 0,void 0,function*(){return Ia.PublicKey.findProgramAddress([Ea.STAKING_ESCROW,e.toBuffer(),t.toBuffer()],r)})}cn.getTokenEscrow=eO;function tO(r,e){return lo(this,void 0,void 0,function*(){return Ia.PublicKey.findProgramAddress([Ea.REWARD_AUTH,e.toBuffer()],r)})}cn.getRewardAuth=tO;var ei={},Yf=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(ei,"__esModule",{value:!0});ei.getStakingVarsAccountInfo=ei.getStakingAccountInfo=ei.getRegisteredStakeAccountInfo=void 0;const Jf=Ei,nO=cn;function rO(r,e,t){return Yf(this,void 0,void 0,function*(){return yield(0,Jf.getStakingProgram)({connection:r,programId:t}).account.registeredStake.fetch(e)})}ei.getRegisteredStakeAccountInfo=rO;function iO(r,e,t){return Yf(this,void 0,void 0,function*(){return yield(0,Jf.getStakingProgram)({connection:r,programId:t}).account.stakingAccount.fetch(e)})}ei.getStakingAccountInfo=iO;function sO(r,e){return Yf(this,void 0,void 0,function*(){const t=(0,Jf.getStakingProgram)({connection:r,programId:e}),[n]=yield(0,nO.getStakingVarsAccount)(e);return yield t.account.stakingVars.fetch(n)})}ei.getStakingVarsAccountInfo=sO;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(cn,r),t(ei,r),t(Ft,r)})(Yu);var oO=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Hu,"__esModule",{value:!0});Hu.registerStakeInstruction=void 0;const Lp=et,aO=Ui,cO=Yu,uO=vn;function lO({connection:r,authority:e,rewardMultiplier:t,stakeMint:n,rewardMint:i,cooldownPeriod:s,programId:o}){return oO(this,void 0,void 0,function*(){const a=(0,uO.getStakingProgram)({connection:r,programId:o}),c={instructions:[],signers:[]},[l]=yield(0,cO.getRegisteredStake)(o,e,n,i),u=yield(0,aO.associatedAddress)({owner:l,mint:i}),f=yield a.methods.registerStake(new Lp.BN(t),new Lp.BN(s)).accounts({authority:e,stakeMint:n,rewardMint:i,rewardAta:u}).instruction();return c.instructions.push(f),c})}Hu.registerStakeInstruction=lO;var Ju={},dO=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Ju,"__esModule",{value:!0});Ju.createSettleStakingAccountInstruction=void 0;const fO=vn;function hO({connection:r,authority:e,registeredStake:t,stakingAccount:n,updatedStakingPeriod:i,programId:s}){return dO(this,void 0,void 0,function*(){const o=(0,fO.getStakingProgram)({connection:r,programId:s}),a={instructions:[],signers:[]},c=yield o.methods.settle(i).accounts({authority:e,registeredStake:t,stakingAccount:n}).instruction();return a.instructions.push(c),a})}Ju.createSettleStakingAccountInstruction=hO;var Qu={},pO=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Qu,"__esModule",{value:!0});Qu.stakeTokensInstruction=void 0;const yO=Ui,gO=vn;function mO({connection:r,user:e,stakeMint:t,tokenSource:n,stakeQuantity:i,registeredStake:s,stakingAccount:o,programId:a}){return pO(this,void 0,void 0,function*(){const c=(0,gO.getStakingProgram)({connection:r,programId:a}),l=yield(0,yO.associatedAddress)({owner:o,mint:t}),u={instructions:[],signers:[]},f=yield c.methods.stakeTokens(i).accounts({user:e,stakeMint:t,tokenSource:n,registeredStake:s,tokenEscrow:l}).instruction();return u.instructions.push(f),u})}Qu.stakeTokensInstruction=mO;var Xu={},bO=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Xu,"__esModule",{value:!0});Xu.unstakeTokensInstruction=void 0;const wO=et,kO=Ui,SO=Fn,vO=Yu,_O=vn;function AO({connection:r,user:e,registeredStake:t,stakingAccount:n,programId:i}){return bO(this,void 0,void 0,function*(){const s=(0,_O.getStakingProgram)({connection:r,programId:i}),o={signers:[],instructions:[]},c=(yield(0,vO.getRegisteredStakeAccountInfo)(r,t,i)).rewardMint;let l=null,u=null;const f=yield(0,SO.getTokenAccount)(r,e,c);l=f.tokenAccount,"createInstruction"in f&&o.instructions.push(...f.createInstruction),l instanceof wO.web3.Keypair?(u=l.publicKey,o.signers.push(l)):u=l;const m=yield(0,kO.associatedAddress)({owner:t,mint:c}),y=yield s.methods.unstakeTokens().accounts({user:e,rewardMint:c,registeredStake:t,stakingAccount:n,userRewardAccount:u,rewardAta:m}).instruction();return o.instructions.push(y),o})}Xu.unstakeTokensInstruction=AO;var Zu={},IO=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Zu,"__esModule",{value:!0});Zu.updateCooldownPeriodInstruction=void 0;const EO=et,PO=vn;function RO({connection:r,authority:e,registeredStake:t,cooldownPeriod:n,programId:i}){return IO(this,void 0,void 0,function*(){const s=(0,PO.getStakingProgram)({connection:r,programId:i}),o={instructions:[],signers:[]},a=yield s.methods.updateCooldownPeriod(new EO.BN(n)).accounts({authority:e,registeredStake:t}).instruction();return o.instructions.push(a),o})}Zu.updateCooldownPeriodInstruction=RO;var el={},TO=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(el,"__esModule",{value:!0});el.updateRewardMultiplierInstruction=void 0;const OO=et,BO=vn;function xO({connection:r,authority:e,rewardMultiplier:t,registeredStake:n,newStakingPeriod:i,programId:s}){return TO(this,void 0,void 0,function*(){const o=(0,BO.getStakingProgram)({connection:r,programId:s}),a={instructions:[],signers:[]},c=yield o.methods.updateRewardMultiplier(new OO.BN(t),i).accounts({authority:e,registeredStake:n}).instruction();return a.instructions.push(c),a})}el.updateRewardMultiplierInstruction=xO;var tl={},CO=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(tl,"__esModule",{value:!0});tl.withdrawTokensInstruction=void 0;const MO=et,LO=Ui,KO=vn,NO=Fn;function DO({connection:r,authority:e,user:t,stakeMint:n,registeredStake:i,stakingAccount:s,programId:o}){return CO(this,void 0,void 0,function*(){const a=(0,KO.getStakingProgram)({connection:r,programId:o}),c=yield(0,LO.associatedAddress)({owner:s,mint:n}),l={signers:[],instructions:[]};let u=null,f=null;const m=yield(0,NO.getTokenAccount)(r,t,n);u=m.tokenAccount,"createInstruction"in m&&l.instructions.push(...m.createInstruction),u instanceof MO.web3.Keypair?(f=u.publicKey,l.signers.push(u)):f=u;const y=yield a.methods.withdrawTokens().accounts({user:t,authority:e,stakeMint:n,tokenSource:f,registeredStake:i,stakingAccount:s,tokenEscrow:c}).instruction();return l.instructions.push(y),l})}tl.withdrawTokensInstruction=DO;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Jp,r),t(qc,r),t(ou,r),t(au,r),t(Gu,r),t(Hu,r),t(Ju,r),t(Qu,r),t(Xu,r),t(Zu,r),t(el,r),t(tl,r)})(Yp);var Qb={},Xb={};Object.defineProperty(Xb,"__esModule",{value:!0});(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(ca,r),t(Xb,r)})(Qb);(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Yp,r),t(Yu,r),t(Qb,r),t(vn,r)})(jc);var Zb={};(function(r){var e=z&&z.__awaiter||function(f,m,y,S){function p(w){return w instanceof y?w:new y(function(v){v(w)})}return new(y||(y=Promise))(function(w,v){function E(T){try{K(S.next(T))}catch(b){v(b)}}function P(T){try{K(S.throw(T))}catch(b){v(b)}}function K(T){T.done?w(T.value):p(T.value).then(E,P)}K((S=S.apply(f,m||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.getPlayersOfFaction=r.getAllPlayers=r.getPlayer=r.enlistToFaction=r.getPlayerFactionPDA=r.getIDL=r.FactionType=void 0;const t=et,n={version:"0.0.0",name:"enlist_to_faction",instructions:[{name:"processEnlistPlayer",accounts:[{name:"playerFactionAccount",isMut:!0,isSigner:!1},{name:"playerAccount",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"factionId",type:"u8"}]}],accounts:[{name:"PlayerFactionData",type:{kind:"struct",fields:[{name:"owner",type:"publicKey"},{name:"enlistedAtTimestamp",type:"i64"},{name:"factionId",type:"u8"},{name:"bump",type:"u8"},{name:"padding",type:{array:["u64",5]}}]}}],errors:[{code:300,name:"FactionTypeError",msg:"Faction ID must be 0, 1, or 2."}],metadata:{}},i="FACTION_ENLISTMENT";(function(f){f[f.Unenlisted=-1]="Unenlisted",f[f.MUD=0]="MUD",f[f.ONI=1]="ONI",f[f.Ustur=2]="Ustur"})(r.FactionType||(r.FactionType={}));function s(f){const m=n;return m.metadata.address=f.toBase58(),m}r.getIDL=s;function o(f,m){return e(this,void 0,void 0,function*(){return t.web3.PublicKey.findProgramAddress([ge.Buffer.from(i,"utf8"),f.toBuffer()],m)})}r.getPlayerFactionPDA=o;function a(f,m,y,S){return e(this,void 0,void 0,function*(){const[p,w]=yield o(y,S),v=s(S),E=new t.AnchorProvider(f,null,null);return yield new t.Program(v,S,E).instruction.processEnlistPlayer(w,m,{accounts:{playerFactionAccount:p,playerAccount:y,systemProgram:t.web3.SystemProgram.programId,clock:t.web3.SYSVAR_CLOCK_PUBKEY}})})}r.enlistToFaction=a;function c(f,m,y){return e(this,void 0,void 0,function*(){const S=new t.AnchorProvider(f,null,null),p=s(y),w=new t.Program(p,y,S),[v]=yield o(m,y);return yield w.account.playerFactionData.fetch(v)})}r.getPlayer=c;function l(f,m){return e(this,void 0,void 0,function*(){const y=new t.AnchorProvider(f,null,null),S=s(m);return(yield new t.Program(S,m,y).account.playerFactionData.all()).map(E=>E.account)})}r.getAllPlayers=l;function u(f,m,y){return e(this,void 0,void 0,function*(){const S=new t.AnchorProvider(f,null,null),p=s(y);return(yield new t.Program(p,y,S).account.playerFactionData.all()).map(P=>P.account).filter(P=>P.factionId==m)})}r.getPlayersOfFaction=u})(Zb);var ew={},nl={};Object.defineProperty(nl,"__esModule",{value:!0});nl.gumDropIdl=void 0;nl.gumDropIdl={version:"0.0.0",name:"merkle_distributor",instructions:[{name:"newDistributor",accounts:[{name:"base",isMut:!1,isSigner:!0},{name:"distributor",isMut:!0,isSigner:!1},{name:"payer",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"root",type:{array:["u8",32]}},{name:"temporal",type:"publicKey"}]},{name:"closeDistributor",accounts:[{name:"base",isMut:!1,isSigner:!0},{name:"distributor",isMut:!0,isSigner:!1},{name:"distributorWallet",isMut:!0,isSigner:!1},{name:"receiver",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"walletBump",type:"u8"}]},{name:"claim",accounts:[{name:"distributor",isMut:!0,isSigner:!1},{name:"claimStatus",isMut:!0,isSigner:!1},{name:"from",isMut:!0,isSigner:!1},{name:"to",isMut:!0,isSigner:!1},{name:"temporal",isMut:!1,isSigner:!0},{name:"payer",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"index",type:"u64"},{name:"amount",type:"u64"},{name:"claimantSecret",type:"publicKey"},{name:"proof",type:{vec:{array:["u8",32]}}}]},{name:"claimCandy",accounts:[{name:"distributor",isMut:!0,isSigner:!1},{name:"distributorWallet",isMut:!0,isSigner:!1},{name:"claimCount",isMut:!0,isSigner:!1},{name:"temporal",isMut:!1,isSigner:!0},{name:"payer",isMut:!1,isSigner:!0},{name:"candyMachineConfig",isMut:!1,isSigner:!1},{name:"candyMachine",isMut:!0,isSigner:!1},{name:"candyMachineWallet",isMut:!0,isSigner:!1},{name:"candyMachineMint",isMut:!0,isSigner:!1},{name:"candyMachineMetadata",isMut:!0,isSigner:!1},{name:"candyMachineMasterEdition",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"tokenMetadataProgram",isMut:!1,isSigner:!1},{name:"candyMachineProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1}],args:[{name:"walletBump",type:"u8"},{name:"claimBump",type:"u8"},{name:"index",type:"u64"},{name:"amount",type:"u64"},{name:"claimantSecret",type:"publicKey"},{name:"proof",type:{vec:{array:["u8",32]}}}]}],accounts:[{name:"MerkleDistributor",type:{kind:"struct",fields:[{name:"base",type:"publicKey"},{name:"bump",type:"u8"},{name:"root",type:{array:["u8",32]}},{name:"temporal",type:"publicKey"}]}},{name:"ClaimStatus",type:{kind:"struct",fields:[{name:"isClaimed",type:"bool"},{name:"claimant",type:"publicKey"},{name:"claimedAt",type:"i64"},{name:"amount",type:"u64"}]}},{name:"ClaimCount",type:{kind:"struct",fields:[{name:"count",type:"u64"},{name:"claimant",type:"publicKey"}]}},{name:"CandyMachine",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"wallet",type:"publicKey"},{name:"tokenMint",type:{option:"publicKey"}},{name:"config",type:"publicKey"},{name:"data",type:{defined:"CandyMachineData"}},{name:"itemsRedeemed",type:"u64"},{name:"bump",type:"u8"}]}}],types:[{name:"CandyMachineData",type:{kind:"struct",fields:[{name:"uuid",type:"string"},{name:"price",type:"u64"},{name:"itemsAvailable",type:"u64"},{name:"goLiveDate",type:{option:"i64"}}]}}],events:[{name:"ClaimedEvent",fields:[{name:"index",type:"u64",index:!1},{name:"claimant",type:"publicKey",index:!1},{name:"amount",type:"u64",index:!1}]}],errors:[{code:300,name:"InvalidProof",msg:"Invalid Merkle proof."},{code:301,name:"DropAlreadyClaimed",msg:"Drop already claimed."},{code:302,name:"Unauthorized",msg:"Account is not authorized to execute this instruction"},{code:303,name:"OwnerMismatch",msg:"Token account owner did not match intended owner"},{code:304,name:"TemporalMismatch",msg:"Temporal signer did not match distributor"}]};(function(r){var e=z&&z.__createBinding||(Object.create?function(p,w,v,E){E===void 0&&(E=v);var P=Object.getOwnPropertyDescriptor(w,v);(!P||("get"in P?!w.__esModule:P.writable||P.configurable))&&(P={enumerable:!0,get:function(){return w[v]}}),Object.defineProperty(p,E,P)}:function(p,w,v,E){E===void 0&&(E=v),p[E]=w[v]}),t=z&&z.__setModuleDefault||(Object.create?function(p,w){Object.defineProperty(p,"default",{enumerable:!0,value:w})}:function(p,w){p.default=w}),n=z&&z.__importStar||function(p){if(p&&p.__esModule)return p;var w={};if(p!=null)for(var v in p)v!=="default"&&Object.prototype.hasOwnProperty.call(p,v)&&e(w,p,v);return t(w,p),w},i=z&&z.__awaiter||function(p,w,v,E){function P(K){return K instanceof v?K:new v(function(T){T(K)})}return new(v||(v=Promise))(function(K,T){function b(W){try{R(E.next(W))}catch(B){T(B)}}function _(W){try{R(E.throw(W))}catch(B){T(B)}}function R(W){W.done?K(W.value):P(W.value).then(b,_)}R((E=E.apply(p,w||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.claimTokenInstructions=r.getMultipleClaimStatusAccounts=r.getClaimStatusAccount=r.getClaimStatusKey=void 0;const s=et,o=da,a=n(pe),c=xt,l=nl,u=new s.web3.PublicKey("gdrpGjVffourzkdDRrQmySw4aTHr8a3xmQzzxSwFD1a"),f=(p,w,v=u)=>i(void 0,void 0,void 0,function*(){return yield s.web3.PublicKey.findProgramAddress([ge.Buffer.from("ClaimStatus"),p.toArrayLike(ge.Buffer,"le",8),w.toBuffer()],v)});r.getClaimStatusKey=f;const m=(p,w,v,E=u)=>i(void 0,void 0,void 0,function*(){const P=new s.AnchorProvider(p,null,null),K=new s.Program(l.gumDropIdl,E,P),T=yield(0,r.getClaimStatusKey)(w,v,E);try{return yield K.account.claimStatus.fetch(T[0])}catch{return null}});r.getClaimStatusAccount=m;const y=(p,w,v,E=u)=>i(void 0,void 0,void 0,function*(){const P=new s.AnchorProvider(p,null,null),K=new s.Program(l.gumDropIdl,E,P),T=w.map(R=>(0,r.getClaimStatusKey)(R,v,E)),b=(yield Promise.all(T)).map(R=>R[0]);return yield K.account.claimStatus.fetchMultiple(b)});r.getMultipleClaimStatusAccounts=y;const S=p=>i(void 0,void 0,void 0,function*(){const{connection:w,claimUrl:v,playerPublicKey:E,programId:P}=p,K=new URLSearchParams(v.split("?")[1]),T=K.get("distributor"),b=K.get("handle"),_=K.get("amount"),R=K.get("index"),W=K.get("proof"),B=K.get("tokenAcc");if(!T||!b||!_||!R||!W||!B)throw new Error("Invalid claim");const V=W===""?[]:W.split(",").map(rr=>{const rn=ge.Buffer.from(a.decode(rr));if(rn.length!==32)throw new Error("Invalid proof hash length");return rn}),q=new s.web3.PublicKey(T),I=new s.web3.PublicKey(B),$=yield w.getAccountInfo(I);if($===null)throw new Error("Could not fetch distributor token account");const G=o.AccountLayout.decode($.data),ke=new s.web3.PublicKey(G.mint),ae=new s.web3.PublicKey(b),ve=yield(0,c.getAssociatedTokenAddress)(ae,ke),Dt=yield w.getParsedTokenAccountsByOwner(ae,{mint:ke}),nn=new s.BN(R),me=new s.BN(_),[Be,Ut]=yield(0,r.getClaimStatusKey)(nn,q,P),Yt=new s.AnchorProvider(w,null,null),$t=new s.Program(l.gumDropIdl,P,Yt),ft=[];return Dt.value.length===0&&ft.push(o.Token.createAssociatedTokenAccountInstruction(o.ASSOCIATED_TOKEN_PROGRAM_ID,o.TOKEN_PROGRAM_ID,ke,ve,ae,E)),ft.push($t.instruction.claim(Ut,nn,me,E,V,{accounts:{distributor:q,claimStatus:Be,from:I,to:ve,temporal:E,payer:E,tokenProgram:o.TOKEN_PROGRAM_ID,systemProgram:s.web3.SystemProgram.programId}})),ft});r.claimTokenInstructions=S})(ew);var ce={},rl={};Object.defineProperty(rl,"__esModule",{value:!0});rl.baseIdl=void 0;rl.baseIdl={version:"0.0.0",name:"score",instructions:[{name:"processInitialize",accounts:[{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"scoreVarsAccount",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"treasuryTokenAccount",isMut:!0,isSigner:!1},{name:"treasuryAuthorityAccount",isMut:!1,isSigner:!1},{name:"atlasMint",isMut:!1,isSigner:!1},{name:"fuelMint",isMut:!1,isSigner:!1},{name:"foodMint",isMut:!1,isSigner:!1},{name:"armsMint",isMut:!1,isSigner:!1},{name:"toolkitMint",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"treasuryBump",type:"u8"},{name:"treasuryAuthBump",type:"u8"}]},{name:"processRegisterShip",accounts:[{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!0,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"scorevarsShipBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"rewardRatePerSecond",type:"u64"},{name:"fuelMaxReserve",type:"u32"},{name:"foodMaxReserve",type:"u32"},{name:"armsMaxReserve",type:"u32"},{name:"toolkitMaxReserve",type:"u32"},{name:"millisecondsToBurnOneFuel",type:"u32"},{name:"millisecondsToBurnOneFood",type:"u32"},{name:"millisecondsToBurnOneArms",type:"u32"},{name:"millisecondsToBurnOneToolkit",type:"u32"}]},{name:"processDeregisterShip",accounts:[{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!0,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"}]},{name:"processUpdateRewardRate",accounts:[{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!0,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"newRewardRatePerSecond",type:"u64"}]},{name:"processInitialDeposit",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"playerFactionAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"shipTokenAccountSource",isMut:!0,isSigner:!1},{name:"shipTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"shipQuantity",type:"u64"}]},{name:"processPartialDeposit",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"shipTokenAccountSource",isMut:!0,isSigner:!1},{name:"shipTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"shipQuantity",type:"u64"}]},{name:"processRefuel",accounts:[{name:"tokenOwnerAccount",isMut:!1,isSigner:!0},{name:"playerAccount",isMut:!1,isSigner:!1},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"fuelMint",isMut:!1,isSigner:!1},{name:"fuelTokenAccountSource",isMut:!0,isSigner:!1},{name:"fuelTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"fuelQuantity",type:"u64"}]},{name:"processRefeed",accounts:[{name:"tokenOwnerAccount",isMut:!1,isSigner:!0},{name:"playerAccount",isMut:!1,isSigner:!1},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"foodMint",isMut:!1,isSigner:!1},{name:"foodTokenAccountSource",isMut:!0,isSigner:!1},{name:"foodTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"foodQuantity",type:"u64"}]},{name:"processRearm",accounts:[{name:"tokenOwnerAccount",isMut:!1,isSigner:!0},{name:"playerAccount",isMut:!1,isSigner:!1},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"armsMint",isMut:!1,isSigner:!1},{name:"armsTokenAccountSource",isMut:!0,isSigner:!1},{name:"armsTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"armsQuantity",type:"u64"}]},{name:"processRepair",accounts:[{name:"tokenOwnerAccount",isMut:!1,isSigner:!0},{name:"playerAccount",isMut:!1,isSigner:!1},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"toolkitMint",isMut:!0,isSigner:!1},{name:"toolkitTokenAccountSource",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"toolkitQuantity",type:"u64"}]},{name:"processSettle",accounts:[{name:"playerAccount",isMut:!1,isSigner:!1},{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"}]},{name:"processHarvest",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"playerAtlasTokenAccount",isMut:!0,isSigner:!1},{name:"treasuryTokenAccount",isMut:!0,isSigner:!1},{name:"treasuryAuthorityAccount",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"treasuryBump",type:"u8"},{name:"treasuryAuthBump",type:"u8"}]},{name:"processWithdrawFuel",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"fuelTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"fuelTokenAccountReturn",isMut:!0,isSigner:!1},{name:"fuelMint",isMut:!0,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"}]},{name:"processWithdrawFood",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"foodTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"foodTokenAccountReturn",isMut:!0,isSigner:!1},{name:"foodMint",isMut:!0,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"}]},{name:"processWithdrawArms",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"armsTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"armsTokenAccountReturn",isMut:!0,isSigner:!1},{name:"armsMint",isMut:!0,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"}]},{name:"processWithdrawShips",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"playerAtlasTokenAccount",isMut:!0,isSigner:!1},{name:"shipTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"shipTokenAccountReturn",isMut:!0,isSigner:!1},{name:"toolkitTokenAccountSource",isMut:!0,isSigner:!1},{name:"treasuryTokenAccount",isMut:!0,isSigner:!1},{name:"treasuryAuthorityAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"toolkitMint",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"treasuryAuthBump",type:"u8"},{name:"treasuryBump",type:"u8"}]},{name:"processCloseAccounts",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"shipTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"fuelTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"foodTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"armsTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"fuelMint",isMut:!1,isSigner:!1},{name:"foodMint",isMut:!1,isSigner:!1},{name:"armsMint",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"shipBump",type:"u8"},{name:"fuelBump",type:"u8"},{name:"foodBump",type:"u8"},{name:"armsBump",type:"u8"},{name:"escrowAuthBump",type:"u8"}]}],accounts:[{name:"ScoreVars",type:{kind:"struct",fields:[{name:"updateAuthorityMaster",type:"publicKey"},{name:"fuelMint",type:"publicKey"},{name:"foodMint",type:"publicKey"},{name:"armsMint",type:"publicKey"},{name:"toolkitMint",type:"publicKey"}]}},{name:"ScoreVarsShip",type:{kind:"struct",fields:[{name:"shipMint",type:"publicKey"},{name:"rewardRatePerSecond",type:"u64"},{name:"fuelMaxReserve",type:"u32"},{name:"foodMaxReserve",type:"u32"},{name:"armsMaxReserve",type:"u32"},{name:"toolkitMaxReserve",type:"u32"},{name:"millisecondsToBurnOneFuel",type:"u32"},{name:"millisecondsToBurnOneFood",type:"u32"},{name:"millisecondsToBurnOneArms",type:"u32"},{name:"millisecondsToBurnOneToolkit",type:"u32"}]}},{name:"ShipStaking",type:{kind:"struct",fields:[{name:"owner",type:"publicKey"},{name:"factionId",type:"u8"},{name:"shipMint",type:"publicKey"},{name:"shipQuantityInEscrow",type:"u64"},{name:"fuelQuantityInEscrow",type:"u64"},{name:"foodQuantityInEscrow",type:"u64"},{name:"armsQuantityInEscrow",type:"u64"},{name:"fuelCurrentCapacity",type:"u64"},{name:"foodCurrentCapacity",type:"u64"},{name:"armsCurrentCapacity",type:"u64"},{name:"healthCurrentCapacity",type:"u64"},{name:"stakedAtTimestamp",type:"i64"},{name:"fueledAtTimestamp",type:"i64"},{name:"fedAtTimestamp",type:"i64"},{name:"armedAtTimestamp",type:"i64"},{name:"repairedAtTimestamp",type:"i64"},{name:"currentCapacityTimestamp",type:"i64"},{name:"totalTimeStaked",type:"u64"},{name:"stakedTimePaid",type:"u64"},{name:"pendingRewards",type:"u64"},{name:"totalRewardsPaid",type:"u64"}]}}],types:[{name:"Resource",type:{kind:"enum",variants:[{name:"Arms"},{name:"Fuel"},{name:"Food"},{name:"Toolkits"}]}}],errors:[{code:300,name:"ScorevarsNotInitialized",msg:"Scorevars auth is not initialized"},{code:301,name:"ScorevarsAuthInvalid",msg:"Scorevars auth invalid"},{code:302,name:"FactionTypeError",msg:"Faction ID must be 0, 1, or 2."},{code:303,name:"InvalidShipError",msg:"Invalid Ship Mint"},{code:304,name:"InvalidResourceError",msg:"Invalid Resource Mint"},{code:305,name:"ZeroResourceError",msg:"Resource Quantity must be >0."},{code:306,name:"ZeroShipError",msg:"Ship Quantity must be >0."},{code:307,name:"NumericalOverflowError",msg:"Numerical overflow error"},{code:308,name:"ResourceAmountTooSmall",msg:"Resource Amount Too Small, would add 0 seconds to capacity"},{code:309,name:"InvalidScoreVarsAccount",msg:"Invalid ScoreVars account for ship Staking Account given"},{code:310,name:"InvalidResourceWithdraw",msg:"Invalid Resource Withdraw, nothing to withdraw"},{code:311,name:"InvalidShipStakingOwner",msg:"Invalid Ship Staking Owner"},{code:312,name:"InvalidShipWithdraw",msg:"Invalid Ship Withdraw"},{code:313,name:"NotEnoughToolkits",msg:"Not enough toolkits for Ship Withdraw"},{code:314,name:"EscrowAccountNotZero",msg:"Escrow account must be 0 to close accounts"},{code:315,name:"IncorrectTokenAccountOwner",msg:"Token account does not have correct owner!"},{code:316,name:"UninitializedTokenAccount",msg:"Token or Mint Account is not initialized!"},{code:317,name:"IncorrectTokenAccountMint",msg:"Token or Mint Account mint is not correct!"}],metadata:{}};var il={};Object.defineProperty(il,"__esModule",{value:!0});il.scoreLogBaseIdl=void 0;il.scoreLogBaseIdl={version:"0.0.0",name:"score_logs",instructions:[],events:[{name:"ProcessInitialDepositMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"factionId",type:"u8",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"stakedAtTimestamp",type:"i64",index:!1}]},{name:"ProcessPartialDepositMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"previousShipQuantity",type:"u64",index:!1},{name:"addedShipQuantity",type:"u64",index:!1},{name:"newShipQuantity",type:"u64",index:!1},{name:"partialDepositTimestamp",type:"i64",index:!1}]},{name:"ProcessRearmMemo",fields:[{name:"tokenOwnerAccount",type:"publicKey",index:!1},{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"armsQuantityToDeposit",type:"u64",index:!1},{name:"armedAtTimestamp",type:"i64",index:!1}]},{name:"ProcessRefeedMemo",fields:[{name:"tokenOwnerAccount",type:"publicKey",index:!1},{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"foodQuantityToDeposit",type:"u64",index:!1},{name:"fedAtTimestamp",type:"i64",index:!1}]},{name:"ProcessRefuelMemo",fields:[{name:"tokenOwnerAccount",type:"publicKey",index:!1},{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"fuelQuantityToDeposit",type:"u64",index:!1},{name:"fueledAtTimestamp",type:"i64",index:!1}]},{name:"ProcessRepairMemo",fields:[{name:"tokenOwnerAccount",type:"publicKey",index:!1},{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"toolkitQuantityToDeposit",type:"u64",index:!1},{name:"repairedAtTimestamp",type:"i64",index:!1}]},{name:"ProcessHarvestMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"stakedTimePaid",type:"u64",index:!1},{name:"rewardPayout",type:"u64",index:!1},{name:"totalRewardsPaid",type:"u64",index:!1},{name:"harvestTimestamp",type:"i64",index:!1}]},{name:"ProcessSettleMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"stakedTimePaid",type:"u64",index:!1},{name:"totalRewardsPaid",type:"u64",index:!1},{name:"settleTimestamp",type:"i64",index:!1}]},{name:"ProcessArmsWithdrawMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"armsQuantityWithdrawn",type:"u64",index:!1},{name:"armsWithdrawTimestamp",type:"i64",index:!1}]},{name:"ProcessFoodWithdrawMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"foodQuantityWithdrawn",type:"u64",index:!1},{name:"foodWithdrawTimestamp",type:"i64",index:!1}]},{name:"ProcessFuelWithdrawMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"fuelQuantityWithdrawn",type:"u64",index:!1},{name:"fuelWithdrawTimestamp",type:"i64",index:!1}]},{name:"ProcessWithdrawShipsMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"stakedTimePaid",type:"u64",index:!1},{name:"totalRewardsPaid",type:"u64",index:!1},{name:"shipsWithdrawTimestamp",type:"i64",index:!1}]},{name:"ProcessCloseAccountMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"accountClosedTimestamp",type:"i64",index:!1}]}]};var Ge=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(ce,"__esModule",{value:!0});ce.closeAccountsInstruction=ce.createWithdrawShipsInstruction=ce.createWithdrawArmsInstruction=ce.createWithdrawFoodInstruction=ce.createWithdrawFuelInstruction=ce.createHarvestInstruction=ce.createSettleInstruction=ce.createRepairInstruction=ce.createRefuelInstruction=ce.createRefeedInstruction=ce.createRearmInstruction=ce.createPartialDepositInstruction=ce.createInitialDepositInstruction=ce.createUpdateRewardRateInstruction=ce.createDeregisterShipInstruction=ce.createRegisterShipInstruction=ce.createScoreVarsInitializeInstruction=ce.getAllFleetsForUserPublicKey=ce.getAllFleets=ce.getAllRegisteredShips=ce.getScoreTreasuryAuthAccount=ce.getScoreTreasuryTokenAccount=ce.getScoreVarsShipInfo=ce.decodeEvent=ce.getShipStakingAccountInfo=ce.getScoreVarsInfo=ce.getShipStakingAccount=ce.getScoreEscrowAuthAccount=ce.getScoreEscrowAccount=ce.getScoreVarsShipAccount=ce.getScoreVarsAccount=ce.getScoreIDL=void 0;const Q=et,Mn=da,tw=Lr,$O=sn,zO=rl,WO=il,Ii=Fn;function dt(r){const e=zO.baseIdl;return e.metadata.address=r.toBase58(),e}ce.getScoreIDL=dt;function en(r){return Ge(this,void 0,void 0,function*(){return Q.web3.PublicKey.findProgramAddress([ge.Buffer.from("SCOREVARS")],r)})}ce.getScoreVarsAccount=en;function Ht(r,e){return Ge(this,void 0,void 0,function*(){return Q.web3.PublicKey.findProgramAddress([ge.Buffer.from("SCOREVARS_SHIP"),e.toBuffer()],r)})}ce.getScoreVarsShipAccount=Ht;function bn(r,e,t,n){return Ge(this,void 0,void 0,function*(){const i=[ge.Buffer.from("SCORE_ESCROW"),n.toBuffer(),e.toBuffer()];return t!==null&&i.push(t.toBuffer()),Q.web3.PublicKey.findProgramAddress(i,r)})}ce.getScoreEscrowAccount=bn;function nr(r,e,t){return Ge(this,void 0,void 0,function*(){return Q.web3.PublicKey.findProgramAddress([ge.Buffer.from("SCORE_ESCROW_AUTHORITY"),t.toBuffer(),e.toBuffer()],r)})}ce.getScoreEscrowAuthAccount=nr;function tn(r,e,t){return Ge(this,void 0,void 0,function*(){return Q.web3.PublicKey.findProgramAddress([ge.Buffer.from("SCORE_INFO"),t.toBuffer(),e.toBuffer()],r)})}ce.getShipStakingAccount=tn;function VO(r,e){return Ge(this,void 0,void 0,function*(){const t=new Q.AnchorProvider(r,null,null),n=dt(e),i=new Q.Program(n,e,t),[s]=yield en(e);return yield i.account.scoreVars.fetch(s)})}ce.getScoreVarsInfo=VO;function UO(r,e,t,n){return Ge(this,void 0,void 0,function*(){const i=new Q.AnchorProvider(r,null,null),s=dt(e),o=new Q.Program(s,e,i),[a]=yield tn(e,t,n);return yield o.account.shipStaking.fetch(a)})}ce.getShipStakingAccountInfo=UO;function FO(r,e,t){return Ge(this,void 0,void 0,function*(){const n=new Q.AnchorProvider(r,null,null);return new Q.Program(WO.scoreLogBaseIdl,e,n).coder.events.decode(t)})}ce.decodeEvent=FO;function jO(r,e,t){return Ge(this,void 0,void 0,function*(){const n=new Q.AnchorProvider(r,null,null),i=dt(e),s=new Q.Program(i,e,n),[o]=yield Ht(e,t);return yield s.account.scoreVarsShip.fetch(o)})}ce.getScoreVarsShipInfo=jO;function sl(r){return Ge(this,void 0,void 0,function*(){return Q.web3.PublicKey.findProgramAddress([ge.Buffer.from("SCORE_TREASURY")],r)})}ce.getScoreTreasuryTokenAccount=sl;function ol(r){return Ge(this,void 0,void 0,function*(){return Q.web3.PublicKey.findProgramAddress([ge.Buffer.from("SCORE_TREASURY_AUTHORITY")],r)})}ce.getScoreTreasuryAuthAccount=ol;function qO(r,e){return Ge(this,void 0,void 0,function*(){const t=dt(e),n=new Q.AnchorProvider(r,null,null),s=yield new Q.Program(t,e,n).account.scoreVarsShip.all(),o=[];for(const a of s)o.push(a.account);return o})}ce.getAllRegisteredShips=qO;function GO(r,e){return Ge(this,void 0,void 0,function*(){const t=dt(e),n=new Q.AnchorProvider(r,null,null),s=yield new Q.Program(t,e,n).account.shipStaking.all(),o=[];for(const a of s)o.push(a.account);return o})}ce.getAllFleets=GO;function HO(r,e,t){return Ge(this,void 0,void 0,function*(){const n=dt(t),i=new Q.AnchorProvider(r,null,null),s=new Q.Program(n,t,i),o=yield s.account.scoreVarsShip.all(),a=[];for(const u of o){const[f]=yield tn(t,u.account.shipMint,e);a.push(f)}return(yield s.account.shipStaking.fetchMultiple(a)).filter(u=>u!==null).map(u=>u)})}ce.getAllFleetsForUserPublicKey=HO;function YO(r,e,t,n,i,s,o,a){return Ge(this,void 0,void 0,function*(){const c=dt(a),l=new Q.AnchorProvider(r,null,null),u=new Q.Program(c,a,l),[f,m]=yield sl(a),[y,S]=yield ol(a),[p,w]=yield en(a);return yield u.instruction.processInitialize(w,m,S,{accounts:{updateAuthorityAccount:e,scoreVarsAccount:p,tokenProgram:Mn.TOKEN_PROGRAM_ID,systemProgram:tw.SystemProgram.programId,rent:Q.web3.SYSVAR_RENT_PUBKEY,treasuryTokenAccount:f,treasuryAuthorityAccount:y,atlasMint:t,fuelMint:n,foodMint:i,armsMint:s,toolkitMint:o},signers:[]})})}ce.createScoreVarsInitializeInstruction=YO;function JO(r,e,t,n,i,s,o,a,c,l,u,f,m){return Ge(this,void 0,void 0,function*(){const y=dt(m),S=new Q.AnchorProvider(r,null,null),p=new Q.Program(y,m,S),[w,v]=yield Ht(m,t),[E,P]=yield en(m);return yield p.instruction.processRegisterShip(P,v,new Q.BN(f),n,i,s,o,a,c,l,u,{accounts:{updateAuthorityAccount:e,scoreVarsAccount:E,scoreVarsShipAccount:w,shipMint:t,systemProgram:tw.SystemProgram.programId},signers:[]})})}ce.createRegisterShipInstruction=JO;function QO(r,e,t,n){return Ge(this,void 0,void 0,function*(){const i=dt(n),s=new Q.AnchorProvider(r,null,null),o=new Q.Program(i,n,s),[a,c]=yield Ht(n,t),[l,u]=yield en(n);return yield o.instruction.processDeregisterShip(u,c,{accounts:{updateAuthorityAccount:e,scoreVarsAccount:l,scoreVarsShipAccount:a,shipMint:t},signers:[]})})}ce.createDeregisterShipInstruction=QO;function XO(r,e,t,n,i){return Ge(this,void 0,void 0,function*(){const s=dt(i),o=new Q.AnchorProvider(r,null,null),a=new Q.Program(s,i,o),[c,l]=yield Ht(i,t),[u,f]=yield en(i);return yield a.instruction.processUpdateRewardRate(f,l,new Q.BN(n),{accounts:{updateAuthorityAccount:e,scoreVarsAccount:u,scoreVarsShipAccount:c,shipMint:t},signers:[]})})}ce.createUpdateRewardRateInstruction=XO;function ZO(r,e,t,n,i,s,o=new Q.web3.PublicKey("FACTNmq2FhA2QNTnGM2aWJH3i7zT3cND5CgvjYTjyVYe")){return Ge(this,void 0,void 0,function*(){const[a,c]=yield nr(s,n,e),[l,u]=yield bn(s,n,null,e),[f,m]=yield tn(s,n,e),[y,S]=yield Ht(s,n),[p]=yield(0,$O.getPlayerFactionPDA)(e,o),w=dt(s),v=new Q.AnchorProvider(r,null,null);return yield new Q.Program(w,s,v).instruction.processInitialDeposit(m,S,c,u,new Q.BN(t),{accounts:{playerAccount:e,shipStakingAccount:f,scoreVarsShipAccount:y,playerFactionAccount:p,escrowAuthority:a,systemProgram:Q.web3.SystemProgram.programId,tokenProgram:Mn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,rent:Q.web3.SYSVAR_RENT_PUBKEY,shipMint:n,shipTokenAccountSource:i,shipTokenAccountEscrow:l}})})}ce.createInitialDepositInstruction=ZO;function eB(r,e,t,n,i,s){return Ge(this,void 0,void 0,function*(){const[o,a]=yield nr(s,n,e),[c,l]=yield bn(s,n,null,e),[u,f]=yield tn(s,n,e),[m,y]=yield Ht(s,n),S=dt(s),p=new Q.AnchorProvider(r,null,null);return yield new Q.Program(S,s,p).instruction.processPartialDeposit(f,y,a,l,new Q.BN(t),{accounts:{playerAccount:e,shipStakingAccount:u,scoreVarsShipAccount:m,escrowAuthority:o,systemProgram:Q.web3.SystemProgram.programId,tokenProgram:Mn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n,shipTokenAccountSource:i,shipTokenAccountEscrow:c}})})}ce.createPartialDepositInstruction=eB;function tB(r,e,t,n,i,s,o,a){return Ge(this,void 0,void 0,function*(){const[c,l]=yield nr(a,i,t),[u,f]=yield bn(a,i,s,t),[m,y]=yield tn(a,i,t),[S,p]=yield Ht(a,i),[w,v]=yield en(a),E=dt(a),P=new Q.AnchorProvider(r,null,null);return yield new Q.Program(E,a,P).instruction.processRearm(y,v,p,l,f,new Q.BN(n),{accounts:{tokenOwnerAccount:e,playerAccount:t,shipStakingAccount:m,scoreVarsAccount:w,scoreVarsShipAccount:S,escrowAuthority:c,systemProgram:Q.web3.SystemProgram.programId,tokenProgram:Mn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,rent:Q.web3.SYSVAR_RENT_PUBKEY,shipMint:i,armsMint:s,armsTokenAccountSource:o,armsTokenAccountEscrow:u}})})}ce.createRearmInstruction=tB;function nB(r,e,t,n,i,s,o,a){return Ge(this,void 0,void 0,function*(){const[c,l]=yield nr(a,i,t),[u,f]=yield bn(a,i,s,t),[m,y]=yield tn(a,i,t),[S,p]=yield Ht(a,i),[w,v]=yield en(a),E=dt(a),P=new Q.AnchorProvider(r,null,null);return yield new Q.Program(E,a,P).instruction.processRefeed(y,v,p,l,f,new Q.BN(n),{accounts:{tokenOwnerAccount:e,playerAccount:t,shipStakingAccount:m,scoreVarsAccount:w,scoreVarsShipAccount:S,escrowAuthority:c,systemProgram:Q.web3.SystemProgram.programId,tokenProgram:Mn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,rent:Q.web3.SYSVAR_RENT_PUBKEY,shipMint:i,foodMint:s,foodTokenAccountSource:o,foodTokenAccountEscrow:u}})})}ce.createRefeedInstruction=nB;function rB(r,e,t,n,i,s,o,a){return Ge(this,void 0,void 0,function*(){const[c,l]=yield nr(a,i,t),[u,f]=yield bn(a,i,s,t),[m,y]=yield tn(a,i,t),[S,p]=yield Ht(a,i),[w,v]=yield en(a),E=dt(a),P=new Q.AnchorProvider(r,null,null);return yield new Q.Program(E,a,P).instruction.processRefuel(y,v,p,l,f,new Q.BN(n),{accounts:{tokenOwnerAccount:e,playerAccount:t,shipStakingAccount:m,scoreVarsAccount:w,scoreVarsShipAccount:S,escrowAuthority:c,systemProgram:Q.web3.SystemProgram.programId,tokenProgram:Mn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,rent:Q.web3.SYSVAR_RENT_PUBKEY,shipMint:i,fuelMint:s,fuelTokenAccountSource:o,fuelTokenAccountEscrow:u}})})}ce.createRefuelInstruction=rB;function iB(r,e,t,n,i,s,o,a){return Ge(this,void 0,void 0,function*(){const[c,l]=yield tn(a,i,t),[u,f]=yield Ht(a,i),[m,y]=yield en(a),S=dt(a),p=new Q.AnchorProvider(r,null,null);return yield new Q.Program(S,a,p).instruction.processRepair(l,y,f,new Q.BN(n),{accounts:{tokenOwnerAccount:e,playerAccount:t,shipStakingAccount:c,scoreVarsAccount:m,scoreVarsShipAccount:u,systemProgram:Q.web3.SystemProgram.programId,tokenProgram:Mn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,rent:Q.web3.SYSVAR_RENT_PUBKEY,shipMint:i,toolkitMint:s,toolkitTokenAccountSource:o}})})}ce.createRepairInstruction=iB;function sB(r,e,t,n,i){return Ge(this,void 0,void 0,function*(){const[s,o]=yield tn(i,n,e),[a,c]=yield Ht(i,n),[l,u]=yield en(i),f=dt(i),m=new Q.AnchorProvider(r,null,null);return yield new Q.Program(f,i,m).instruction.processSettle(o,u,c,{accounts:{playerAccount:e,updateAuthorityAccount:t,shipStakingAccount:s,scoreVarsShipAccount:a,scoreVarsAccount:l,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}})})}ce.createSettleInstruction=sB;function oB(r,e,t,n,i){return Ge(this,void 0,void 0,function*(){const[s,o]=yield tn(i,n,e),[a,c]=yield Ht(i,n),[l,u]=yield sl(i),[f,m]=yield ol(i),y=dt(i),S=new Q.AnchorProvider(r,null,null),p=new Q.Program(y,i,S),w={signers:[],instructions:[]};let v;const E=yield(0,Ii.getTokenAccount)(r,e,t),P=E.tokenAccount;"createInstruction"in E&&w.instructions.push(...E.createInstruction),P instanceof Q.web3.Keypair?(v=P.publicKey,w.signers.push(P)):v=P;const K=yield p.instruction.processHarvest(o,c,u,m,{accounts:{playerAccount:e,shipStakingAccount:s,scoreVarsShipAccount:a,playerAtlasTokenAccount:v,treasuryTokenAccount:l,treasuryAuthorityAccount:f,tokenProgram:Mn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}});return w.instructions.push(K),w})}ce.createHarvestInstruction=oB;function aB(r,e,t,n,i){return Ge(this,void 0,void 0,function*(){const[s,o]=yield nr(i,n,e),[a,c]=yield bn(i,n,t,e),[l,u]=yield tn(i,n,e),[f,m]=yield Ht(i,n),[y,S]=yield en(i),p=dt(i),w=new Q.AnchorProvider(r,null,null),v=new Q.Program(p,i,w),E={signers:[],instructions:[]};let P;const K=yield(0,Ii.getTokenAccount)(r,e,t),T=K.tokenAccount;"createInstruction"in K&&E.instructions.push(...K.createInstruction),T instanceof Q.web3.Keypair?(P=T.publicKey,E.signers.push(T)):P=T;const b=yield v.instruction.processWithdrawFuel(u,S,m,o,c,{accounts:{playerAccount:e,shipStakingAccount:l,scoreVarsAccount:y,scoreVarsShipAccount:f,fuelTokenAccountEscrow:a,fuelTokenAccountReturn:P,fuelMint:t,escrowAuthority:s,tokenProgram:Mn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}});return E.instructions.push(b),E})}ce.createWithdrawFuelInstruction=aB;function cB(r,e,t,n,i){return Ge(this,void 0,void 0,function*(){const[s,o]=yield nr(i,n,e),[a,c]=yield bn(i,n,t,e),[l,u]=yield tn(i,n,e),[f,m]=yield Ht(i,n),[y,S]=yield en(i),p=dt(i),w=new Q.AnchorProvider(r,null,null),v=new Q.Program(p,i,w),E={signers:[],instructions:[]};let P;const K=yield(0,Ii.getTokenAccount)(r,e,t),T=K.tokenAccount;"createInstruction"in K&&E.instructions.push(...K.createInstruction),T instanceof Q.web3.Keypair?(P=T.publicKey,E.signers.push(T)):P=T;const b=yield v.instruction.processWithdrawFood(u,S,m,o,c,{accounts:{playerAccount:e,shipStakingAccount:l,scoreVarsAccount:y,scoreVarsShipAccount:f,foodTokenAccountEscrow:a,foodTokenAccountReturn:P,foodMint:t,escrowAuthority:s,tokenProgram:Mn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}});return E.instructions.push(b),E})}ce.createWithdrawFoodInstruction=cB;function uB(r,e,t,n,i){return Ge(this,void 0,void 0,function*(){const[s,o]=yield nr(i,n,e),[a,c]=yield bn(i,n,t,e),[l,u]=yield tn(i,n,e),[f,m]=yield Ht(i,n),[y,S]=yield en(i),p=dt(i),w=new Q.AnchorProvider(r,null,null),v=new Q.Program(p,i,w),E={signers:[],instructions:[]};let P;const K=yield(0,Ii.getTokenAccount)(r,e,t),T=K.tokenAccount;"createInstruction"in K&&E.instructions.push(...K.createInstruction),T instanceof Q.web3.Keypair?(P=T.publicKey,E.signers.push(T)):P=T;const b=yield v.instruction.processWithdrawArms(u,S,m,o,c,{accounts:{playerAccount:e,shipStakingAccount:l,scoreVarsAccount:y,scoreVarsShipAccount:f,armsTokenAccountEscrow:a,armsTokenAccountReturn:P,armsMint:t,escrowAuthority:s,tokenProgram:Mn.TOKEN_PROGRAM_ID,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}});return E.instructions.push(b),E})}ce.createWithdrawArmsInstruction=uB;function lB(r,e,t,n,i,s){return Ge(this,void 0,void 0,function*(){const[o,a]=yield nr(s,t,e),[c,l]=yield bn(s,t,null,e),[u,f]=yield tn(s,t,e),[m,y]=yield Ht(s,t),[S,p]=yield en(s),[w,v]=yield sl(s),[E,P]=yield ol(s),K={signers:[],instructions:[]},T=dt(s),b=new Q.AnchorProvider(r,null,null),_=new Q.Program(T,s,b);let R;const W=yield(0,Ii.getTokenAccount)(r,e,n),B=W.tokenAccount;"createInstruction"in W&&K.instructions.push(...W.createInstruction),B instanceof Q.web3.Keypair?(R=B.publicKey,K.signers.push(B)):R=B;let V;const q=yield(0,Ii.getTokenAccount)(r,e,t),I=q.tokenAccount;"createInstruction"in q&&K.instructions.push(...q.createInstruction),I instanceof Q.web3.Keypair?(V=I.publicKey,K.signers.push(I)):V=I;let $;const G=yield(0,Ii.getTokenAccount)(r,e,i),ke=G.tokenAccount;"createInstruction"in G&&K.instructions.push(...G.createInstruction),ke instanceof Q.web3.Keypair?($=ke.publicKey,K.signers.push(ke)):$=ke;const ae=yield _.instruction.processWithdrawShips(f,p,y,a,l,P,v,{accounts:{playerAccount:e,shipStakingAccount:u,scoreVarsAccount:S,scoreVarsShipAccount:m,playerAtlasTokenAccount:R,shipTokenAccountEscrow:c,shipTokenAccountReturn:V,toolkitTokenAccountSource:$,treasuryTokenAccount:w,treasuryAuthorityAccount:E,escrowAuthority:o,tokenProgram:Mn.TOKEN_PROGRAM_ID,systemProgram:Q.web3.SystemProgram.programId,clock:Q.web3.SYSVAR_CLOCK_PUBKEY,shipMint:t,toolkitMint:i}});return K.instructions.push(ae),K})}ce.createWithdrawShipsInstruction=lB;function dB(r,e,t,n,i,s,o){return Ge(this,void 0,void 0,function*(){const[a,c]=yield nr(o,t,e),[l,u]=yield bn(o,t,null,e),[f,m]=yield bn(o,t,n,e),[y,S]=yield bn(o,t,i,e),[p,w]=yield bn(o,t,s,e),[v,E]=yield en(o),[P,K]=yield tn(o,t,e),T=dt(o),b=new Q.AnchorProvider(r,null,null);return yield new Q.Program(T,o,b).instruction.processCloseAccounts(K,E,u,m,S,w,c,{accounts:{playerAccount:e,shipStakingAccount:P,scoreVarsAccount:v,shipTokenAccountEscrow:l,fuelTokenAccountEscrow:f,foodTokenAccountEscrow:y,armsTokenAccountEscrow:p,escrowAuthority:a,tokenProgram:Mn.TOKEN_PROGRAM_ID,systemProgram:Q.web3.SystemProgram.programId,shipMint:t,fuelMint:n,foodMint:i,armsMint:s,clock:Q.web3.SYSVAR_CLOCK_PUBKEY}})})}ce.closeAccountsInstruction=dB;var nw={};Object.defineProperty(nw,"__esModule",{value:!0});var It={},hi=z&&z.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(f){o(f)}}function c(u){try{l(n.throw(u))}catch(f){o(f)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})},fB=z&&z.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(It,"__esModule",{value:!0});It.sendTokens=It.confirmTokenBalance=It.createMint=It.mintTokens=It.createAssociatedTokenAccountInstruction=It.createRequestUnitsInstruction=It.Numberu32=It.createATokenAccount=It.getAtaForMint=void 0;const Un=et,Tn=da,hB=Fn,Kp=uc.exports,Np=fB(Up.exports);function rw(r,e){return hi(this,void 0,void 0,function*(){return Un.web3.PublicKey.findProgramAddress([e.toBuffer(),Tn.TOKEN_PROGRAM_ID.toBuffer(),r.toBuffer()],Tn.ASSOCIATED_TOKEN_PROGRAM_ID)})}It.getAtaForMint=rw;function pB(r,e,t,n){return hi(this,void 0,void 0,function*(){t=t||r.wallet.publicKey,n=n||r.wallet.publicKey;const[i]=yield rw(e,n),s=new Un.web3.Transaction,o=yield sw(i,t,n,e);return s.add(o),yield r.sendAndConfirm(s),i})}It.createATokenAccount=pB;class iw extends Np.default{toBuffer(){const e=super.toArray().reverse(),t=ge.Buffer.from(e);if(t.length===4)return t;const n=ge.Buffer.alloc(4);return t.copy(n),n}static fromBuffer(e){return new Np.default([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}It.Numberu32=iw;function yB(r){return hi(this,void 0,void 0,function*(){const e=new iw(1e6),t=ge.Buffer.from([0]),n=e.toBuffer();return new Un.web3.TransactionInstruction({keys:[{pubkey:r,isSigner:!0,isWritable:!0}],programId:new Un.web3.PublicKey("ComputeBudget111111111111111111111111111111"),data:ge.Buffer.concat([t,n])})})}It.createRequestUnitsInstruction=yB;function sw(r,e,t,n){return hi(this,void 0,void 0,function*(){const i=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:Un.web3.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:Tn.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:Un.web3.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return new Un.web3.TransactionInstruction({keys:i,programId:Tn.ASSOCIATED_TOKEN_PROGRAM_ID,data:ge.Buffer.from([])})})}It.createAssociatedTokenAccountInstruction=sw;function gB(r,e,t,n,i){return hi(this,void 0,void 0,function*(){const s=new Un.web3.Transaction;return i=i||r.wallet.publicKey,s.add(Tn.Token.createMintToInstruction(Tn.TOKEN_PROGRAM_ID,e,t,i,[],n)),yield r.sendAndConfirm(s)})}It.mintTokens=gB;function mB(r,e,t,n){return hi(this,void 0,void 0,function*(){const i=Un.web3.Keypair.generate(),s=new Un.web3.Transaction,o=yield r.connection.getMinimumBalanceForRentExemption(Tn.MintLayout.span);t=t||r.wallet.publicKey,n=n||r.wallet.publicKey;const a=Un.web3.SystemProgram.createAccount({fromPubkey:r.wallet.publicKey,newAccountPubkey:i.publicKey,lamports:o,space:Tn.MintLayout.span,programId:Tn.TOKEN_PROGRAM_ID});s.add(a);const c=Tn.Token.createInitMintInstruction(Tn.TOKEN_PROGRAM_ID,i.publicKey,e,t,n);return s.add(c),yield r.sendAndConfirm(s,[i]),i.publicKey})}It.createMint=mB;function bB(r,e,t,n){return hi(this,void 0,void 0,function*(){const i=yield r.connection.getAccountInfo(e,"recent");if(n===!0&&(0,Kp.strict)(i===null),i!==null){const s=(0,hB.byteArrayToLong)(i.data.slice(64,72));(0,Kp.strict)(s==t,`On-chain Token amount of ${s} does not match expected amount ${t}`)}else console.log("Token account %s does not exist",e.toString())})}It.confirmTokenBalance=bB;function wB(r,e,t,n){return hi(this,void 0,void 0,function*(){const i=new Un.web3.Transaction;return i.add(Tn.Token.createTransferInstruction(Tn.TOKEN_PROGRAM_ID,e,t,r.wallet.publicKey,[],n)),yield r.sendAndConfirm(i)})}It.sendTokens=wB;(function(r){var e=z&&z.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=z&&z.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(jc,r),t(Zb,r),t(ew,r),t(Of,r),t(ce,r),t(nw,r),t(It,r),t(xi,r),t(Fn,r)})(sn);const Ga=new un("ATLASXmbPQxBUYbxPsV97usA3fPQYEqzQBUHgiFCUsXx"),Dp=new un("poLisWXnNRwC6oBu1vHiuKQzFjGL4XDSu4g9qjz9qVk"),kB=new un("ATLkZsBofSKG845dNFpNoUyMciGpeH29BCbMqYFUoxzU"),Vr=new un("ATLocKpzDbTokxgvnLew3d7drZkEzLzDpzwgrgWKDbmc");class SB{multisigPDA;vaultPDA;registeredStakeAtlas;stakingAccountAtlas;async init(e){this.multisigPDA=e,this._setVaultPDA(),await this._setRegisteredStakeAtlas(),await this._setStakingAccountAtlas()}_setVaultPDA(){const[e]=Ul({multisigPda:new un(this.multisigPDA),index:0});this.vaultPDA=e}async _setRegisteredStakeAtlas(){const[e]=await sn.getRegisteredStake(Vr,kB,Ga,Dp);this.registeredStakeAtlas=e}async _setStakingAccountAtlas(){const[e]=await sn.getStakingAccount(Vr,this.vaultPDA,this.registeredStakeAtlas);this.stakingAccountAtlas=e}async buildCreateStatingAccount(){return await sn.createStakingAccountInstruction({connection:on().connection,user:this.vaultPDA,registeredStake:this.registeredStakeAtlas,programId:Vr})}async buildStakeTokens(e){const[t]=un.findProgramAddressSync([this.vaultPDA.toBuffer(),mw.toBuffer(),Ga.toBuffer()],Ow.ASSOCIATED_PROGRAM_ID);return await sn.stakeTokensInstruction({connection:on().connection,user:this.vaultPDA,stakeMint:Ga,tokenSource:t,stakingAccount:this.stakingAccountAtlas,stakeQuantity:new Qn(parseFloat(e.toString())*Math.pow(10,vB)),registeredStake:this.registeredStakeAtlas,programId:Vr})}async buildHarvestRewards(){return await sn.harvestRewardsInstruction({connection:on().connection,user:this.vaultPDA,rewardMint:Dp,registeredStake:this.registeredStakeAtlas,stakingAccount:this.stakingAccountAtlas,programId:Vr})}async buildWithdrawTokens(){return await sn.withdrawTokensInstruction({connection:on().connection,user:this.vaultPDA,authority:this.vaultPDA,stakeMint:Ga,registeredStake:this.registeredStakeAtlas,stakingAccount:this.stakingAccountAtlas,programId:Vr})}async buildUnstakeTokens(){return await sn.unstakeTokensInstruction({connection:on().connection,user:this.vaultPDA,registeredStake:this.registeredStakeAtlas,stakingAccount:this.stakingAccountAtlas,programId:Vr})}async buildCancelUnstake(){return await sn.cancelUnstakeInstruction({connection:on().connection,user:this.vaultPDA,registeredStake:this.registeredStakeAtlas,programId:Vr})}}const os="[ATLAS-LOCKER] ",vB=8,Lo=new un("ATLASXmbPQxBUYbxPsV97usA3fPQYEqzQBUHgiFCUsXx"),Lc=new un("poLisWXnNRwC6oBu1vHiuKQzFjGL4XDSu4g9qjz9qVk"),Ha=new un("ATLocKpzDbTokxgvnLew3d7drZkEzLzDpzwgrgWKDbmc"),$p=new un("ATLkZsBofSKG845dNFpNoUyMciGpeH29BCbMqYFUoxzU"),qe=bw("globalStarAtlasLockerStore",{state:()=>({multisigPDA:ww("multisigPDA",""),vaultPDA:{},multisigInfo:{},registeredStakeAtlas:{},registeredStakePolis:{},stakingAccountAtlas:{},stakingAccountAtlasInfo:{},atlas_balance_wallet:"0",polis_balance_wallet:"0",atlas_balance_squads:"0",polis_balance_squads:"0",atlas_balance_locker:"0",polis_balance_locker:"0",SAFactory_LockerAtlas:new SB}),getters:{getMultisigPDA(r){return new un(r.multisigPDA)},getVaultPDA(){try{const[r]=Ul({multisigPda:new un(this.multisigPDA),index:0});return r}catch{return""}},getNewTransactionIndex(r){const e=Number(r.multisigInfo.transactionIndex);return BigInt(e+1)}},actions:{async setAccounts(){qe().atlas_balance_wallet="0",qe().polis_balance_wallet="0",qe().atlas_balance_squads="0",qe().polis_balance_squads="0",qe().atlas_balance_locker="0",qe().polis_balance_locker="0",qe().stakingAccountAtlasInfo=void 0;const[r]=Ul({multisigPda:new un(this.multisigPDA),index:0});this.vaultPDA=r,this.multisigInfo=await kw.fromAccountAddress(on().connection,new un(this.multisigPDA));const[e]=await sn.getRegisteredStake(Ha,$p,Lo,Lc);this.registeredStakeAtlas=e;const[t]=await sn.getRegisteredStake(Ha,$p,Lo,Lc);this.registeredStakePolis=t;try{const[n]=await sn.getStakingAccount(Ha,this.vaultPDA,this.registeredStakeAtlas);this.stakingAccountAtlas=n}catch{}try{this.stakingAccountAtlasInfo=await sn.getStakingAccountInfo(on().connection,this.stakingAccountAtlas,Ha)}catch{}await _B()},async build_CreateStatingAccount(){await this.SAFactory_LockerAtlas.init(this.multisigPDA),await as(os+"CreateStatingAccount: "+Rw,[(await this.SAFactory_LockerAtlas.buildCreateStatingAccount()).instructions[0]])},async build_StakeTokens(r){await this.SAFactory_LockerAtlas.init(this.multisigPDA),await as(os+"StakeTokens: "+r,[(await this.SAFactory_LockerAtlas.buildStakeTokens(r)).instructions[0]])},async build_harvestRewards(){await this.SAFactory_LockerAtlas.init(this.multisigPDA),await as(os+"HarvestRewards",[(await this.SAFactory_LockerAtlas.buildHarvestRewards()).instructions[0]])},async build_withdrawTokens(){await this.SAFactory_LockerAtlas.init(this.multisigPDA),await as(os+"WithdrawTokens",[(await this.SAFactory_LockerAtlas.buildWithdrawTokens()).instructions[0]])},async build_unstakeTokens(){await this.SAFactory_LockerAtlas.init(this.multisigPDA),await as(os+"UnstakeTokens",[(await this.SAFactory_LockerAtlas.buildUnstakeTokens()).instructions[0]])},async build_cancelUnstake(){await this.SAFactory_LockerAtlas.init(this.multisigPDA),await as(os+"CancelUnstake",[(await this.SAFactory_LockerAtlas.buildCancelUnstake()).instructions[0]])}}});async function as(r,e){const{sendTransaction:t,publicKey:n}=Ko(),i=new Sw({payerKey:qe().vaultPDA,recentBlockhash:(await on().connection.getLatestBlockhash()).blockhash,instructions:e}),s=Pw({multisigPda:new un(qe().multisigPDA),transactionIndex:qe().getNewTransactionIndex,creator:n.value,vaultIndex:0,ephemeralSigners:0,transactionMessage:i,memo:r});console.log("build: "+r);const o=await t(new vw().add(s),on().connection);await Tw(o)}async function _B(){const{publicKey:r}=Ko();if(!r.value)return;const e=await po(Lo,r.value),t=await po(Lc,r.value),n=await po(Lo,qe().vaultPDA,!0),i=await po(Lc,qe().vaultPDA,!0),s=await po(Lo,qe().stakingAccountAtlas,!0);try{qe().atlas_balance_wallet=(await on().connection.getTokenAccountBalance(e)).value.uiAmountString??"0"}catch{qe().atlas_balance_wallet="-"}try{qe().polis_balance_wallet=(await on().connection.getTokenAccountBalance(t)).value.uiAmountString??"0"}catch{qe().polis_balance_wallet="-"}try{qe().atlas_balance_squads=(await on().connection.getTokenAccountBalance(n)).value.uiAmountString??"0"}catch{qe().atlas_balance_squads="-"}try{qe().polis_balance_squads=(await on().connection.getTokenAccountBalance(i)).value.uiAmountString??"0"}catch{qe().polis_balance_squads="-"}try{qe().atlas_balance_locker=(await on().connection.getTokenAccountBalance(s)).value.uiAmountString??""}catch{qe().atlas_balance_locker="-"}}const AB={class:"row"},IB=Fe("div",{class:"col-3"},"Wallet",-1),EB={class:"col"},PB={class:"row q-gutter-x-xs no-wrap justify-end"},RB=Fe("div",null,"Atlas",-1),TB={class:"col"},OB={class:"row q-gutter-x-xs no-wrap justify-end"},BB=Fe("div",null,"Polis",-1),xB={class:"row"},CB=Fe("div",{class:"col-3"},"Squads",-1),MB={class:"col"},LB={class:"row q-gutter-x-xs no-wrap justify-end"},KB=Fe("div",null,"Atlas",-1),NB={class:"col"},DB={class:"row q-gutter-x-xs no-wrap justify-end"},$B=Fe("div",null,"Polis",-1),zB={class:"row"},WB=Fe("div",{class:"col-3"},"Locker",-1),VB={class:"col"},UB={class:"row q-gutter-x-xs no-wrap justify-end"},FB=Fe("div",null,"Atlas",-1),jB={class:"col"},qB={class:"row q-gutter-x-xs no-wrap justify-end"},GB=Fe("div",null,"Polis",-1),HB=qp({__name:"TokenLockerBalances",setup(r){return _w(async()=>{Ko().publicKey.value&&await qe().setAccounts()}),Aw(()=>Ko().publicKey.value,async()=>{await qe().setAccounts()}),(e,t)=>(Ya(),Gp(yw,{class:""},{default:lc(()=>[yi(pw,null,{default:lc(()=>[Fe("div",AB,[IB,Fe("div",EB,[Fe("div",PB,[Fe("div",null,es(Ur(qe)().atlas_balance_wallet),1),RB])]),Fe("div",TB,[Fe("div",OB,[Fe("div",null,es(Ur(qe)().polis_balance_wallet),1),BB])])]),Fe("div",xB,[CB,Fe("div",MB,[Fe("div",LB,[Fe("div",null,es(Ur(qe)().atlas_balance_squads),1),KB])]),Fe("div",NB,[Fe("div",DB,[Fe("div",null,es(Ur(qe)().polis_balance_squads),1),$B])])]),Fe("div",zB,[WB,Fe("div",VB,[Fe("div",UB,[Fe("div",null,es(Ur(qe)().atlas_balance_locker),1),FB])]),Fe("div",jB,[Fe("div",qB,[Fe("div",null,es(Ur(qe)().polis_balance_locker),1),GB])])])]),_:1})]),_:1}))}}),YB={key:0,class:"col absolute-center"},JB={key:1},QB=Fe("div",{class:"col"},null,-1),gx=qp({__name:"StarAtlasLocker",setup(r){const e=Iw("setup");return(t,n)=>(Ya(),Gp(hw,{class:"bg-black"},{default:lc(()=>{var i,s;return[(s=(i=Ur(Ko)().publicKey)==null?void 0:i.value)!=null&&s.toString()?(Ya(),Zf("div",JB,[yi(fw,{modelValue:e.value,"onUpdate:modelValue":n[0]||(n[0]=o=>e.value=o),align:"left",class:""},{default:lc(()=>[yi(ul,{name:"setup",label:"Setup"}),yi(ul,{name:"atlas",label:"Atlas"}),yi(ul,{name:"polis",label:"Polis"}),QB,yi(HB,{class:"q-pr-md col"})]),_:1},8,["modelValue"])])):(Ya(),Zf("div",YB,[yi(Ur(Ew),{dark:""})]))]}),_:1}))}});export{gx as default};
