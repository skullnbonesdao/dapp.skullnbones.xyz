import{cM as $e,dl as q,P as L,au as W,cj as I,J as w,b1 as g,ak as C,as as e,bV as _e,ck as M,da as B,ai as V,V as m,bx as i,al as t,a1 as $,aj as P,cm as le,d0 as F,di as K,b7 as Ue,a6 as ve,bs as oe,db as O,aX as fe,e9 as ke,ah as ge,b9 as We,cn as Z,d9 as X,dB as Ae,de as Ce,ea as Pe}from"./index.c1e6dd45.js";import{Q as x}from"./QCardSection.4604289c.js";import{Q}from"./QSeparator.bcba54b5.js";import{a as j,Q as ce}from"./QTabs.38558e1f.js";import{Q as T}from"./QCard.07b511f3.js";import{a as z,Q as ue}from"./QTabPanels.36bfeea6.js";import{Q as qe}from"./QPage.41361042.js";import{Q as de}from"./QSlideTransition.03bd933f.js";import{Q as A}from"./QInput.a123e318.js";import{g as U,h as E}from"./handleTransaction.8f06e6b1.js";import{Q as re}from"./QSelect.39309580.js";import{d as ne,c as ee,e as be,I as ye,b as Te,a as Ie}from"./calcAmountToTransfer.11af9616.js";import{Q as Qe}from"./QList.998043ad.js";import{Q as G}from"./QToggle.b603e8d4.js";import{a as se,b as te,c as Ke,d as H,_ as ae,f as D,s as Me}from"./FormatNumber.04d35ccf.js";import{_ as Be,c as Ee}from"./TokenSelectDropdown.507ab822.js";import{Q as Le}from"./QImg.272d8676.js";import{Q as we}from"./QCardActions.3770d75a.js";import{U as Re}from"./constants.e2ffd8e4.js";import"./rtl.bd4d99d9.js";import"./touch.3df10340.js";import"./QMenu.4856bfd3.js";import"./use-key-composition.f32c78a7.js";import"./use-checkbox.fb89c4b5.js";import"./SquadsStore.9d229b7a.js";import"./pda.04e29d14.js";import"./cusper.5b2a9684.js";import"./token.dc3d83ab.js";const r=$e("wrapperStore",{state:()=>({wrapperSelected:{},groupSelected:{},wrapper:[],groups:[]}),getters:{},actions:{async updateStore(){if(q()){const{pg_wrapper:h}=q();this.groups=await h.value.account.group.all(),this.wrapper=await h.value.account.wrapper.all(),this.groupSelected||(this.groupSelected=this.groups[0]),console.log("[Updated] WrapperStore")}}}}),Ne=new L("subA4tNLV18htV8xACaZyMMKkAm1AQS4EhiPYPV4zbH"),Ge={class:"row"},Oe=W({__name:"WrapperCreateGroup",setup(h){const c=I(),u=w("");async function s(){try{const l=new B,a=q().pg_wrapper.value;if(u.value==""){c.notify({message:"Invalid group name",color:"info",position:"bottom-right"});return}l.add(await a.methods.initializeGroup(u.value).accountsPartial({signer:U(),fee:Ne}).instruction()),await E(l,"[Raffle] create new group"),await r().updateStore()}catch(l){c.notify({message:l.message,type:"negative"})}}return(l,a)=>(g(),C("div",Ge,[e(A,{square:"",filled:"",class:"col",modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=n=>u.value=n),label:"New group name",type:"text"},null,8,["modelValue"]),e(M,{square:"",onClick:a[1]||(a[1]=_e(n=>s(),["prevent"])),color:"primary",label:"Create"})]))}}),ie=W({__name:"WrapperGroupSelect",setup(h){return(c,u)=>(g(),V(re,{label:"Select a group",square:"",filled:"",modelValue:m(r)().groupSelected,"onUpdate:modelValue":u[0]||(u[0]=s=>m(r)().groupSelected=s),options:m(r)().groups,"option-label":s=>{var l;return(l=s==null?void 0:s.account)==null?void 0:l.name}},null,8,["modelValue","options","option-label"]))}}),je=W({__name:"WrapperCloseGroup",props:{disabled:{default:!0}},setup(h){const c=I();async function u(){try{const s=new B,l=q().pg_wrapper.value;s.add(await l.methods.closeGroup().accountsPartial({group:r().groupSelected.publicKey,signer:U()}).instruction()),await E(s,"Close Group"),await r().updateStore()}catch(s){c.notify({message:s.message,type:"negative"})}}return(s,l)=>(g(),V(M,{disable:h.disabled,square:"",color:"primary",label:"Close",onClick:l[0]||(l[0]=_e(a=>u(),["prevent"]))},null,8,["disable"]))}}),ze=t("div",{class:"text-h5"},"Group",-1),De=t("div",{class:"text-caption text-grey"}," The group will be used to filter and create the wrappers - one time creation fee of 0.5 SOL ",-1),Xe=t("div",{class:"text-caption text-accent"}," Make sure u use a list where you are the owner! ",-1),Fe={key:0,class:"text-caption row"},Ze=t("div",{style:{width:"50px"}},"ID",-1),He={class:"col text-right"},Je={key:1,class:"text-caption row"},Ye=t("div",{style:{width:"50px"}},"Owner",-1),et={class:"col text-accent text-right"},tt={class:"row"},at={key:0,class:"text-caption row"},lt=t("div",{style:{width:"50px"}},"ID:",-1),ot={class:"col text-accent text-right"},nt={key:1,class:"text-caption row"},st=t("div",{style:{width:"50px"}},"Owner:",-1),rt={class:"col text-accent text-right"},it=t("div",{class:"text-h6 text-red-6 col"}," I know what im doing i want to close the group ",-1),ct=W({__name:"WrapperGroupView",setup(h){const c=w("select"),u=w(!1);return(s,l)=>(g(),V(T,{flat:"",bordered:""},{default:i(()=>[e(x,null,{default:i(()=>[ze,De,Xe]),_:1}),e(Q),e(ce,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=a=>c.value=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:i(()=>[e(j,{name:"select",label:"Select"}),e(j,{name:"create",label:"Create"}),e(j,{name:"close",label:"Close"})]),_:1},8,["modelValue"]),e(Q),e(ue,{modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=a=>c.value=a),animated:""},{default:i(()=>[e(z,{name:"create"},{default:i(()=>[e(Oe)]),_:1}),e(z,{name:"select"},{default:i(()=>[e(ie,{class:""}),e(x,null,{default:i(()=>{var a,n,o,d,p;return[(a=m(r)().groupSelected)!=null&&a.account?(g(),C("div",Fe,[Ze,t("div",He,$((n=m(r)().groupSelected)==null?void 0:n.publicKey),1)])):P("",!0),(o=m(r)().groupSelected)!=null&&o.account?(g(),C("div",Je,[Ye,t("div",et,$((p=(d=m(r)().groupSelected)==null?void 0:d.account)==null?void 0:p.owner),1)])):P("",!0)]}),_:1})]),_:1}),e(z,{name:"close"},{default:i(()=>[t("div",tt,[e(ie,{class:"col"}),e(je,{disabled:!u.value},null,8,["disabled"])]),e(x,null,{default:i(()=>{var a,n,o,d,p;return[(a=m(r)().groupSelected)!=null&&a.account?(g(),C("div",at,[lt,t("div",ot,$((n=m(r)().groupSelected)==null?void 0:n.publicKey),1)])):P("",!0),(o=m(r)().groupSelected)!=null&&o.account?(g(),C("div",nt,[st,t("div",rt,$((p=(d=m(r)().groupSelected)==null?void 0:d.account)==null?void 0:p.owner),1)])):P("",!0)]}),_:1}),e(x,{class:"row items-center"},{default:i(()=>[e(de,{color:"red",modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=a=>u.value=a)},null,8,["modelValue"]),it]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),ut=t("div",{class:"text-h6"},"Wrapped Token",-1),dt={class:"row q-gutter-x-md items-center"},pt=t("div",{class:"text-h6"},"Ratio",-1),mt={class:"row q-gutter-x-md items-center"},wt={class:"row items-center"},_t=t("div",{class:"text-h6"},"Add Medata",-1),vt={key:0,class:"row items-center q-gutter-x-sm"},ft=W({__name:"WrapperCreate",setup(h){const c=I(),u=w(),s=w(9),l=w(1),a=w(1),n=w(!0),o=w(""),d=w(""),p=w("");async function b(){var k;try{const _=new B,S=q().pg_wrapper.value,R=new F(window.crypto.getRandomValues(new Uint8Array(8))),J={ratio:[new F(l.value),new F(a.value)],onlyCreatorCanWrap:!1,onlyCreatorCanUnwrap:!1,wrappedDecimals:s.value,seed:R},N=new L(u.value.mint.toString());if(_.add(await S.methods.initialize(J).accountsPartial({signer:U(),group:new L(((k=r().groupSelected)==null?void 0:k.publicKey.toString())??""),mintUnwrapped:N,tokenProgram:K}).instruction()),_.add(await S.methods.createVault().accountsPartial({signer:U(),wrapper:se(N,U()),vaultUnwrappedAta:te(se(N,U()),N),mintUnwrapped:N,tokenProgram:K}).instruction()),n.value){const Y={name:o.value,symbol:d.value,uri:p.value},v=se(N,U()),f=Ke(v,R),y=H(f);_.add(await S.methods.metadataCreate(Y).accountsPartial({signer:U(),wrapper:v,mintWrapped:f,mintUnwrapped:N,metadata:y,tokenProgram:K}).instruction())}await E(_,`[Wrapper] create + vault ${n.value?"+ metadata":""}`),await r().updateStore()}catch(_){console.error(_),c.notify({message:_.message,type:"negative",position:"bottom-right"})}}return(k,_)=>(g(),V(T,{flat:""},{default:i(()=>[e(x,{class:""},{default:i(()=>[e(Be,{label:"Unwrapped Token","textbox-label":"Token to wrap",onToken_account_selected:_[0]||(_[0]=S=>u.value=S)})]),_:1}),e(x,null,{default:i(()=>[ut,t("div",dt,[e(A,{square:"",filled:"",class:"col",modelValue:s.value,"onUpdate:modelValue":_[1]||(_[1]=S=>s.value=S),label:"Decimals",type:"number"},null,8,["modelValue"])])]),_:1}),e(x,null,{default:i(()=>[pt,t("div",mt,[e(A,{square:"",filled:"",class:"col",modelValue:l.value,"onUpdate:modelValue":_[2]||(_[2]=S=>l.value=S),label:"Unwrapped",type:"number"},null,8,["modelValue"]),e(le,{name:"swap_horiz",size:"xl  "}),e(A,{square:"",filled:"",class:"col",modelValue:a.value,"onUpdate:modelValue":_[3]||(_[3]=S=>a.value=S),label:"Wrapped",type:"number"},null,8,["modelValue"])])]),_:1}),e(x,null,{default:i(()=>[t("div",wt,[_t,e(G,{modelValue:n.value,"onUpdate:modelValue":_[4]||(_[4]=S=>n.value=S),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),n.value?(g(),C("div",vt,[e(A,{square:"",filled:"",class:"col",modelValue:o.value,"onUpdate:modelValue":_[5]||(_[5]=S=>o.value=S),label:"Name",type:"text"},null,8,["modelValue"]),e(A,{square:"",filled:"",class:"col",modelValue:d.value,"onUpdate:modelValue":_[6]||(_[6]=S=>d.value=S),label:"Symbol",type:"text"},null,8,["modelValue"]),e(A,{square:"",filled:"",class:"col",modelValue:p.value,"onUpdate:modelValue":_[7]||(_[7]=S=>p.value=S),label:"Image-URI",type:"text"},null,8,["modelValue"])])):P("",!0)]),_:1}),e(x,{class:"row justify-end"},{default:i(()=>[e(M,{square:"",color:"primary",label:"Create new wrapper",onClick:_[8]||(_[8]=S=>b())})]),_:1})]),_:1}))}}),gt={class:"row items-center"},bt=t("div",{class:"col text-subtitle1 text-weight-thin"},"Publickey",-1),yt={class:"text-subtitle2"},ht={class:"col text-subtitle1 text-weight-thin"},xt={key:0,class:"text-subtitle2"},St={key:1,class:"text-subtitle2"},Vt=W({__name:"WrapperInfo",setup(h){return(c,u)=>{var s;return(s=m(r)().wrapperSelected)!=null&&s.account?(g(),V(T,{key:0,flat:""},{default:i(()=>[e(Q),e(x,null,{default:i(()=>{var l;return[t("div",gt,[bt,t("div",yt,$(m(r)().wrapperSelected.publicKey),1)]),(g(!0),C(ve,null,Ue(Object.keys((l=m(r)().wrapperSelected)==null?void 0:l.account),a=>(g(),C("div",{key:a,class:"row items-center"},[t("div",ht,$(a.toUpperCase()),1),a=="ratio"?(g(),C("div",xt,$(m(r)().wrapperSelected.account[a][0])+" : "+$(m(r)().wrapperSelected.account[a][1]),1)):(g(),C("div",St,$(m(r)().wrapperSelected.account[a]),1))]))),128))]}),_:1})]),_:1})):P("",!0)}}}),$t=W({__name:"WrapperClose",props:{disabled:{default:!0}},setup(h){const c=I();async function u(){var s,l;try{const a=new B,n=q().pg_wrapper.value;a.add(await n.methods.close().accountsPartial({wrapper:(s=r().wrapperSelected)==null?void 0:s.publicKey,signer:U(),mintUnwrapped:(l=r().wrapperSelected)==null?void 0:l.account.mintUnwrapped,tokenProgram:K}).instruction()),await E(a,"[Wrapper] Close"),await r().updateStore()}catch(a){console.error(a),c.notify({message:a.message,type:"negative"})}}return(s,l)=>(g(),V(M,{disable:h.disabled,square:"",color:"primary",label:"Close WrapperInterface",onClick:l[0]||(l[0]=a=>u())},null,8,["disable"]))}}),Ut={class:"row items-center"},kt=t("div",{class:"col text-subtitle1"},"Allow wrap",-1),Wt={class:"row items-center"},At=t("div",{class:"col text-subtitle1"},"Allow unwrap",-1),Ct={class:"row items-center"},Pt=t("div",{class:"col text-subtitle1"},"Only admin can Wrap",-1),qt={class:"row items-center"},Tt=t("div",{class:"col text-subtitle1"},"Only admin can unwrap",-1),It={class:"row items-center"},Qt=t("div",{class:"col text-subtitle1"},"Use whitelist",-1),Kt={class:"row items-center"},Mt=t("div",{class:"col text-subtitle1"},"Use Limit",-1),Bt={class:"row items-center"},Et=t("div",{class:"col text-subtitle1"},"Change Admin",-1),Lt={class:"row items-center"},Rt=t("div",{class:"col text-subtitle1"},"Change Ratio",-1),Nt={key:0,style:{width:"500px"},class:"row items-center"},Gt=W({__name:"WrapperSettings",setup(h){var Y;const c=I();(Y=r().wrapperSelected)==null||Y.account;const u=w(),s=w(),l=w(),a=w(),n=w(),o=w(),d=w(),p=w(),b=w(!1),k=w(),_=w(!1),S=w(),R=w();J(),oe(()=>{var v,f;return(f=(v=r())==null?void 0:v.wrapperSelected)==null?void 0:f.account},()=>{J()});function J(){var f,y;if(!((f=r().wrapperSelected)!=null&&f.account))return;const v=(y=r().wrapperSelected)==null?void 0:y.account;u.value=v.allowWrap,s.value=v==null?void 0:v.allowUnwrap,l.value=v==null?void 0:v.onlyAdminCanWrap,a.value=v==null?void 0:v.onlyAdminCanUnwrap,n.value=v==null?void 0:v.useWhitelist,o.value=v==null?void 0:v.whitelist,d.value=v==null?void 0:v.useLimit,p.value=(v==null?void 0:v.limitAmountUnwrapped)??0,k.value=v==null?void 0:v.admin,S.value=v==null?void 0:v.ratio[0],R.value=v==null?void 0:v.ratio[1]}async function N(){var v,f;try{const y=new B,xe=q().pg_wrapper.value,Se={allowWrap:u.value,allowUnwrap:s.value,onlyAdminCanWrap:l.value,onlyAdminCanUnwrap:a.value,useWhitelist:n.value,useLimit:d.value,amountAbleToWrap:d.value?ne(p.value,O().tokenList.find(Ve=>{var pe,me;return Ve.address==((me=(pe=r().wrapperSelected)==null?void 0:pe.account)==null?void 0:me.mintUnwrapped.toString())}).decimals):null,admin:b.value?new L(k.value):null,ratio:_.value?[new F(S.value),new F(R.value)]:null};y.add(await xe.methods.edit(Se).accountsPartial({wrapper:(v=r().wrapperSelected)==null?void 0:v.publicKey,signer:U(),mintUnwrapped:(f=r().wrapperSelected)==null?void 0:f.account.mintUnwrapped,whitelist:n.value?new L(o.value):null,tokenProgram:K}).instruction()),await E(y),await r().updateStore()}catch(y){console.error(y),c.notify({message:y.message,type:"negative"})}}return(v,f)=>(g(),V(T,{flat:""},{default:i(()=>[e(x,{class:"q-gutter-y-sm"},{default:i(()=>[t("div",Ut,[kt,e(G,{modelValue:u.value,"onUpdate:modelValue":f[0]||(f[0]=y=>u.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",Wt,[At,e(G,{modelValue:s.value,"onUpdate:modelValue":f[1]||(f[1]=y=>s.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",Ct,[Pt,e(G,{modelValue:l.value,"onUpdate:modelValue":f[2]||(f[2]=y=>l.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",qt,[Tt,e(G,{modelValue:a.value,"onUpdate:modelValue":f[3]||(f[3]=y=>a.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",It,[Qt,n.value?(g(),V(A,{key:0,dense:"",filled:"",square:"",style:{width:"500px"},modelValue:o.value,"onUpdate:modelValue":f[4]||(f[4]=y=>o.value=y),type:"text",label:"Whitelist"},null,8,["modelValue"])):P("",!0),e(G,{modelValue:n.value,"onUpdate:modelValue":f[5]||(f[5]=y=>n.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",Kt,[Mt,d.value?(g(),V(A,{key:0,dense:"",filled:"",square:"",style:{width:"500px"},modelValue:p.value,"onUpdate:modelValue":f[6]||(f[6]=y=>p.value=y),type:"number",label:"Amount wrappable"},null,8,["modelValue"])):P("",!0),e(G,{modelValue:d.value,"onUpdate:modelValue":f[7]||(f[7]=y=>d.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",null,[t("div",Bt,[Et,b.value?(g(),V(A,{key:0,style:{width:"500px"},dense:"",filled:"",square:"",label:"Admin",modelValue:k.value,"onUpdate:modelValue":f[8]||(f[8]=y=>k.value=y)},null,8,["modelValue"])):P("",!0),e(G,{modelValue:b.value,"onUpdate:modelValue":f[9]||(f[9]=y=>b.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])])]),t("div",null,[t("div",Lt,[Rt,_.value?(g(),C("div",Nt,[e(A,{class:"col",dense:"",filled:"",square:"",label:"Unwrapped",modelValue:S.value,"onUpdate:modelValue":f[10]||(f[10]=y=>S.value=y),type:"number"},null,8,["modelValue"]),e(le,{size:"md",name:"swap_horiz"}),e(A,{class:"col",dense:"",filled:"",square:"",label:"Wrapped",modelValue:R.value,"onUpdate:modelValue":f[11]||(f[11]=y=>R.value=y),type:"number"},null,8,["modelValue"])])):P("",!0),e(G,{modelValue:_.value,"onUpdate:modelValue":f[12]||(f[12]=y=>_.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])])])]),_:1}),e(x,{class:"row justify-end"},{default:i(()=>[e(M,{square:"",class:"",color:"primary",label:"Update settings",onClick:f[13]||(f[13]=y=>N())})]),_:1})]),_:1}))}}),Ot=W({__name:"WrapperCreateVault",setup(h){const c=I(),u=w(!1);async function s(l){try{const a=new B,n=q().pg_wrapper.value;a.add(await n.methods.createVault().accountsPartial({wrapper:new L(r().wrapperSelected.publicKey.toString()),signer:U(),mintUnwrapped:new L(r().wrapperSelected.account.mintUnwrapped.toString()),tokenProgram:K}).instruction()),await E(a,"[Wrapper] create vault")}catch(a){console.error(a),c.notify({message:a.message,type:"negative"})}}return(l,a)=>{var n;return!u.value&&((n=m(r)().wrapperSelected)==null?void 0:n.publicKey)?(g(),V(M,{key:0,square:"",color:"primary",label:"Create Vault",onClick:a[0]||(a[0]=o=>s())})):P("",!0)}}}),jt={class:"row"},zt=t("div",{class:"col"},"Vault Balance",-1),Dt={class:"row"},Xt=t("div",{class:"col"},"Circ. Supply",-1),he=W({__name:"WrapperVaultDonut",props:["wrapper"],setup(h){const c=h,u=w(0),s=w(0),l=w(0);async function a(){u.value=await n()??0,s.value=await o()??0,l.value=u.value*c.wrapper.account.ratio[1]/u.value*c.wrapper.account.ratio[1]*100}async function n(){return(await Z().connection.getTokenSupply(new L(c.wrapper.account.mintWrapped))).value.uiAmount}async function o(){let b=te(c.wrapper.publicKey,c.wrapper.account.mintUnwrapped);return(await Z().connection.getTokenAccountBalance(b)).value.uiAmount}fe(async()=>{await a()}),ke(()=>c.wrapper,async()=>await a());const d=ge(()=>[l.value]),p=w({dataLabels:{enabled:!1},legend:{labels:{colors:"white"},show:!1,position:"left"},theme:{palette:"palette3"},labels:["Redeemable"]});return(b,k)=>{const _=We("apexchart");return g(),C(ve,null,[t("div",jt,[zt,e(ae,{class:"",number:s.value,decimals:4,"pad-start":10},null,8,["number"])]),t("div",Dt,[Xt,e(ae,{number:u.value,decimals:4,"pad-start":10},null,8,["number"])]),e(_,{height:"300px",type:"radialBar",options:p.value,series:d.value},null,8,["options","series"])],64)}}}),Ft={class:"text-subtitle2 row items-center"},Zt=t("div",{class:"text-accent"}," I want to transfer tokens out of the vault to a new address ",-1),Ht={class:"col"},Jt={class:"row"},Yt=W({__name:"WrapperTransferVaultOut",setup(h){const c=I(),u=w(1),s=w("C6LnFVyc5Qj2LAPdkX5CyyEEga9ePPB6ZRuzGhirZnqX"),l=w(!1);async function a(){try{if(q()){const n=new B,o=q().pg_wrapper.value;n.add(await o.methods.transferVault(ne(u.value,X().getAccountByMintPublicKey(r().wrapperSelected.account.mintUnwrapped).decimals)).accountsPartial({signer:U(),wrapper:r().wrapperSelected.publicKey,mintUnwrapped:r().wrapperSelected.account.mintUnwrapped,ataUnwrappedSigner:D(new L(s.value).toString(),r().wrapperSelected.account.mintUnwrapped.toString()),tokenProgram:K}).instruction()),await E(n,`[Wrapper] transfer to ${s.value}`),await r().updateStore()}}catch(n){console.error(n),c.notify({message:n.message,type:"negative"})}}return(n,o)=>(g(),V(T,{flat:""},{default:i(()=>[t("div",Ft,[e(de,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=d=>l.value=d)},null,8,["modelValue"]),Zt]),t("div",Ht,[t("div",Jt,[e(A,{class:"col",disable:!l.value,square:"",filled:"",modelValue:s.value,"onUpdate:modelValue":o[1]||(o[1]=d=>s.value=d),type:"text",label:"recipient"},null,8,["disable","modelValue"]),e(Q,{vertical:""}),e(A,{disable:!l.value,square:"",filled:"",modelValue:u.value,"onUpdate:modelValue":o[2]||(o[2]=d=>u.value=d),type:"number",label:"Amount to transfer"},null,8,["disable","modelValue"]),e(M,{disable:!u.value||!s.value||!l.value,color:"primary",label:"Send",square:"",onClick:o[3]||(o[3]=d=>a())},null,8,["disable"])])])]),_:1}))}}),ea={class:"row items-center"},ta=t("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),aa={class:"text-subtitle2"},la={class:"row items-center"},oa=t("div",{class:"col text-subtitle1 text-weight-thin"},"Mint",-1),na={class:"text-subtitle2"},sa={class:"row items-center"},ra=t("div",{class:"col text-subtitle1 text-weight-thin"},"Unwrapped",-1),ia={class:"text-subtitle2"},ca={class:"row items-center"},ua=t("div",{class:"col text-subtitle1 text-weight-thin"},"Balance",-1),da={class:"text-subtitle2"},pa=W({__name:"WrapperVault",setup(h){I();const c=w(null),u=w(!1);s(),oe(()=>{var l,a;return(a=(l=r())==null?void 0:l.wrapperSelected)==null?void 0:a.account},async()=>{await s()});async function s(){var l;c.value=(l=(await Z().connection.getParsedAccountInfo(te(r().wrapperSelected.publicKey,r().wrapperSelected.account.mintUnwrapped))).value)==null?void 0:l.data,c.value&&(u.value=!0)}return(l,a)=>(g(),V(T,{flat:""},{default:i(()=>[e(Q),e(x,{class:"col"},{default:i(()=>{var n,o;return[t("div",ea,[ta,t("div",aa,$(m(te)(m(r)().wrapperSelected.publicKey,m(r)().wrapperSelected.account.mintUnwrapped)),1)]),t("div",la,[oa,t("div",na,$((n=m(r)().wrapperSelected.account)==null?void 0:n.mintUnwrapped),1)]),t("div",sa,[ra,t("div",ia,$(m(O)().getTokenByMintPublicKey(m(r)().wrapperSelected.account.mintUnwrapped).name),1)]),t("div",ca,[ua,t("div",da,$((o=c.value)==null?void 0:o.parsed.info.tokenAmount.uiAmount),1)])]}),_:1}),e(x,null,{default:i(()=>[e(he,{wrapper:m(r)().wrapperSelected},null,8,["wrapper"])]),_:1}),e(x,{class:"q-gutter-y-md"},{default:i(()=>[u.value?P("",!0):(g(),V(Ot,{key:0,class:"full-width"})),e(Yt)]),_:1})]),_:1}))}}),ma=W({__name:"WrapperMetadataUpdate",props:["name","symbol","uri"],setup(h){const c=h,u=I();async function s(l){var a,n;try{const o=new B,d=q().pg_wrapper.value,p={name:c.name,symbol:c.symbol,uri:c.uri};o.add(await d.methods.metadataUpdate(p).accountsPartial({wrapper:(a=r().wrapperSelected)==null?void 0:a.publicKey,signer:U(),metadata:H(r().wrapperSelected.account.mintWrapped),mintUnwrapped:(n=r().wrapperSelected)==null?void 0:n.account.mintUnwrapped,tokenProgram:K}).instruction()),await E(o,"[Wrapper] metadata update"),await r().updateStore()}catch(o){console.error(o),u.notify({message:o.message,type:"negative"})}}return(l,a)=>(g(),V(M,{square:"",color:"primary",label:"Apply Metadata",onClick:a[0]||(a[0]=n=>s())}))}}),wa=W({__name:"WrapperMetadataCreate",props:["name","symbol","uri"],setup(h){const c=h,u=I();async function s(l){var a,n;try{const o=new B,d=q().pg_wrapper.value,p={name:c.name,symbol:c.symbol,uri:c.uri};o.add(await d.methods.metadataCreate(p).accountsPartial({wrapper:(a=r().wrapperSelected)==null?void 0:a.publicKey,signer:U(),metadata:H(r().wrapperSelected.account.mintWrapped),mintUnwrapped:(n=r().wrapperSelected)==null?void 0:n.account.mintUnwrapped,tokenProgram:K}).instruction()),await E(o,"[Wrapper] metadata create"),await r().updateStore()}catch(o){console.error(o),u.notify({message:o.message,type:"negative"})}}return(l,a)=>(g(),V(M,{square:"",color:"primary",label:"Create Metadata",onClick:a[0]||(a[0]=n=>s())}))}}),_a={class:"row items-center"},va=t("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),fa={class:"text-subtitle2"},ga={class:"row"},ba=W({__name:"WrapperMetadata",setup(h){I();const c=w(""),u=w(""),s=w(""),l=w(),a=w(),n=w(!1);o(),oe(()=>{var d,p;return(p=(d=r())==null?void 0:d.wrapperSelected)==null?void 0:p.account},async()=>{await o()});async function o(){l.value=await Z().connection.getAccountInfo(H(r().wrapperSelected.account.mintWrapped)),a.value=Me.deserializeMetadata(l.value),c.value=a.value.name,u.value=a.value.symbol,s.value=a.value.uri,l.value&&(n.value=!0)}return(d,p)=>(g(),V(T,{flat:""},{default:i(()=>[e(x,null,{default:i(()=>[t("div",_a,[va,t("div",fa,$(m(H)(m(r)().wrapperSelected.publicKey)),1)])]),_:1}),n.value?(g(),V(x,{key:0,class:"col"},{default:i(()=>[t("div",ga,[e(A,{square:"",label:"Name",filled:"",modelValue:c.value,"onUpdate:modelValue":p[0]||(p[0]=b=>c.value=b)},null,8,["modelValue"]),e(Q,{vertical:""}),e(A,{square:"",label:"Symbol",filled:"",modelValue:u.value,"onUpdate:modelValue":p[1]||(p[1]=b=>u.value=b)},null,8,["modelValue"]),e(Q,{vertical:""}),e(A,{square:"",label:"Image URI",class:"col",filled:"",modelValue:s.value,"onUpdate:modelValue":p[2]||(p[2]=b=>s.value=b)},null,8,["modelValue"]),e(ma,{name:c.value,symbol:u.value,uri:s.value},null,8,["name","symbol","uri"])])]),_:1})):(g(),V(x,{key:1,class:"row justify-end"},{default:i(()=>[e(wa,{name:c.value,symbol:u.value,uri:s.value},null,8,["name","symbol","uri"])]),_:1}))]),_:1}))}}),ya=t("div",{class:"text-h5"},"WrapperInterface Factory",-1),ha=t("div",{class:"text-caption text-grey"}," Small plates, salads & sandwiches in an intimate setting. ",-1),xa={class:"row q-gutter-x-md"},Sa={class:"text-caption text-grey text-right"},Va={class:"row"},$a=t("div",{class:"text-h6 text-red-6 col"}," I know what im doing i want to close a wrapper ",-1),Ua=W({__name:"WrapperManage",setup(h){const c=w("select"),u=w(!1);return(s,l)=>(g(),V(T,{flat:"",bordered:""},{default:i(()=>[e(x,null,{default:i(()=>[ya,ha]),_:1}),e(Q),e(ce,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=a=>c.value=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:i(()=>[e(j,{name:"create",label:"Create"}),e(j,{name:"select",label:"Edit"}),e(j,{name:"close",label:"Close"})]),_:1},8,["modelValue"]),e(Q),e(ue,{modelValue:c.value,"onUpdate:modelValue":l[4]||(l[4]=a=>c.value=a),animated:""},{default:i(()=>[e(z,{name:"create"},{default:i(()=>[e(ft)]),_:1}),e(z,{name:"select"},{default:i(()=>[e(T,{flat:""},{default:i(()=>{var a;return[e(x,null,{default:i(()=>[t("div",xa,[e(re,{label:"Select a wrapper",class:"col",filled:"",modelValue:m(r)().wrapperSelected,"onUpdate:modelValue":l[1]||(l[1]=n=>m(r)().wrapperSelected=n),options:m(r)().wrapper,"option-label":n=>{var o,d;return"[Wrapped] "+(((o=m(O)().tokenList.find(p=>{var b,k;return p.address==((k=(b=n.account)==null?void 0:b.mintUnwrapped)==null?void 0:k.toString())}))==null?void 0:o.name)??((d=n.account)==null?void 0:d.mintUnwrapped.toString())??"")}},null,8,["modelValue","options","option-label"])]),t("div",Sa," Total Found: "+$(m(r)().wrapper.length),1)]),_:1}),(a=m(r)().wrapperSelected)!=null&&a.account?(g(),V(x,{key:0,class:"row full-width"},{default:i(()=>[e(Qe,{bordered:"",class:"rounded-borders full-width"},{default:i(()=>[e(ee,{"expand-separator":"",class:"text-h5",icon:"info",label:"Info"},{default:i(()=>[e(Vt)]),_:1}),e(ee,{"expand-separator":"",class:"text-h5",icon:"settings",label:"Settings"},{default:i(()=>[e(Gt)]),_:1}),e(ee,{"expand-separator":"",class:"text-h5",icon:"note_add",label:"Metadata"},{default:i(()=>[e(ba)]),_:1}),e(ee,{"default-opened":"","expand-separator":"",class:"text-h5",icon:"inventory_2",label:"Vault"},{default:i(()=>[e(pa)]),_:1})]),_:1})]),_:1})):P("",!0)]}),_:1})]),_:1}),e(z,{name:"close"},{default:i(()=>[e(T,{flat:""},{default:i(()=>{var a;return[e(x,null,{default:i(()=>[t("div",Va,[e(re,{label:"Select a wrapper",class:"col",filled:"",modelValue:m(r)().wrapperSelected,"onUpdate:modelValue":l[2]||(l[2]=n=>m(r)().wrapperSelected=n),options:m(r)().wrapper,"option-label":n=>{var o,d;return"[Wrapped] "+(((o=m(O)().tokenList.find(p=>{var b,k;return p.address==((k=(b=n.account)==null?void 0:b.mintUnwrapped)==null?void 0:k.toString())}))==null?void 0:o.name)??((d=n.account)==null?void 0:d.mintUnwrapped.toString())??"")}},null,8,["modelValue","options","option-label"]),e($t,{disabled:!u.value},null,8,["disabled"])])]),_:1}),(a=m(r)().wrapperSelected)!=null&&a.account?(g(),V(x,{key:0,class:"row justify-between"})):P("",!0)]}),_:1}),e(x,{class:"row items-center"},{default:i(()=>[e(de,{color:"red",modelValue:u.value,"onUpdate:modelValue":l[3]||(l[3]=a=>u.value=a)},null,8,["modelValue"]),$a]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),ka=W({__name:"WrapperWrap",props:["wrapper"],setup(h){const c=I(),u=w(1),s=h;async function l(){var a,n;try{const o=new B,d=q().pg_wrapper.value,p=s.wrapper,b=ne(u.value,((a=O().getTokenByMintPublicKey(p==null?void 0:p.account.mintUnwrapped))==null?void 0:a.decimals)??((n=X().getAccountByMintPublicKey(p==null?void 0:p.account.mintUnwrapped))==null?void 0:n.decimals)??0);await Z().connection.getAccountInfo(D(U().toString(),s.wrapper.account.mintWrapped.toString()))||o.add(Ee(U(),D(U().toString(),s.wrapper.account.mintWrapped.toString()),U(),s.wrapper.account.mintWrapped,K,Ae)),console.log(`amount_to_transfer=${b}`);let _=s.wrapper.account.useWhitelist?s.wrapper.account.whitelist:null,S=s.wrapper.account.useWhitelist?be(_):null;console.log(_),o.add(await d.methods.wrap(b).accountsPartial({signer:U(),wrapper:p.publicKey,mintUnwrapped:p.account.mintUnwrapped,signerUnwrapped:D(U().toString(),p.account.mintUnwrapped.toString()),signerWrapped:D(U().toString(),s.wrapper.account.mintWrapped.toString()),tokenProgram:K,whitelist:_,whitelistEntry:S,whitelistProgram:ye}).instruction()),await E(o,"[Wrapper] wrap tokens"),await r().updateStore()}catch(o){console.error(o),c.notify({message:o.message,type:"negative"})}}return(a,n)=>(g(),C("div",null,[e(A,{disable:!h.wrapper.account.allowWrap,filled:"",type:"number",modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=o=>u.value=o)},null,8,["disable","modelValue"]),e(M,{disable:!h.wrapper.account.allowWrap,class:"full-width",color:"primary",label:"Wrap",onClick:n[1]||(n[1]=o=>l())},null,8,["disable"])]))}}),Wa=W({__name:"WrapperUnwrap",props:["wrapper"],setup(h){const c=I(),u=w(1),s=h;async function l(a){var n,o;try{const d=new B,p=q().pg_wrapper.value,b=s.wrapper,k=ne(u.value,(n=X().getAccountByMintPublicKey(b==null?void 0:b.account.mintUnwrapped))==null?void 0:n.decimals);let _=s.wrapper.account.useWhitelist?s.wrapper.account.whitelist:null,S=s.wrapper.account.useWhitelist?be(_):null;d.add(await p.methods.unwrap(k).accountsPartial({signer:U(),wrapper:b.publicKey,mintUnwrapped:b.account.mintUnwrapped,signerUnwrapped:new L(((o=X().accounts.find(R=>R.mint.toString()==b.account.mintUnwrapped.toString()))==null?void 0:o.pubkey)??""),signerWrapped:D(Ce().publicKey.value.toString(),s.wrapper.account.mintWrapped.toString()),tokenProgram:K,whitelist:_,whitelistEntry:S,whitelistProgram:ye}).instruction()),await E(d,"[Wrapper] unwrap tokens"),await r().updateStore()}catch(d){console.error(d),c.notify({message:d.message,type:"negative"})}}return(a,n)=>(g(),C("div",null,[e(A,{disable:!h.wrapper.account.allowUnwrap,filled:"",type:"number",modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=o=>u.value=o)},null,8,["disable","modelValue"]),e(M,{disable:!h.wrapper.account.allowUnwrap,class:"full-width",color:"primary",label:"Unwrap",onClick:n[1]||(n[1]=o=>l())},null,8,["disable"])]))}});const Aa={class:"q-pa-md"},Ca={class:"q-pa-xs col-xs-12 col-sm-6 col-md-3"},Pa={class:"row items-center"},qa=t("div",{class:"col text-subtitle1 text-weight-thin"},"Group",-1),Ta={class:"text-subtitle2"},Ia={class:"row items-center"},Qa=t("div",{class:"col text-subtitle1 text-weight-thin"},"Pair",-1),Ka={class:"text-subtitle2 row q-gutter-x-xs"},Ma=t("div",null,"/",-1),Ba={class:"row items-center"},Ea=t("div",{class:"col text-subtitle1 text-weight-thin"},"Wrappable",-1),La={class:"text-subtitle2"},Ra={class:"row items-center"},Na=t("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),Ga={class:"text-subtitle2"},Oa={class:"col text-center"},ja={class:"col text-center"},za=t("div",{class:"text-center text-subtitle2"},"Status",-1),Da=t("div",null,null,-1),Xa={class:"row q-mb-md q-px-md"},Fa={class:"col-3 q-gutter-x-xs"},Za=t("div",{class:"col text-center"},"Wallet Balance",-1),Ha={class:"col-3 text-right q-gutter-x-xs"},Ja={class:"row q-gutter-x-md"},Ya=W({__name:"WrapperTable",setup(h){const c=I();function u(){return c.screen.lt.sm?3:c.screen.lt.md?6:9}const s=w(""),l=w({page:1,rowsPerPage:u()});return oe(()=>c.screen.name,()=>{l.value.rowsPerPage=u()}),ge(()=>c.screen.gt.xs?c.screen.gt.sm?[3,6,9]:[3,6]:[3]),(a,n)=>(g(),C("div",Aa,[e(Ie,{grid:"",rows:m(r)().wrapper,"row-key":"name",filter:s.value,"hide-header":"",pagination:l.value,"onUpdate:pagination":n[0]||(n[0]=o=>l.value=o),"rows-per-page-options":[0]},{item:i(o=>[t("div",Ca,[e(T,{flat:"",bordered:""},{default:i(()=>[e(x,{class:"text-center"},{default:i(()=>{var d;return[e(Le,{height:"200px",src:((d=m(O)().tokenList.find(p=>{var b;return p.address==((b=o.row.account)==null?void 0:b.mintUnwrapped.toString())}))==null?void 0:d.logoURI)??m(Re)},null,8,["src"])]}),_:2},1024),e(x,null,{default:i(()=>{var d,p,b,k;return[t("div",Pa,[qa,t("div",Ta,$(m(r)().groups.find(_=>_.publicKey.toString()==o.row.account.group.toString()).account.name),1)]),t("div",Ia,[Qa,t("div",Ka,[t("div",null,$(m(O)().tokenList.find(_=>_.address==o.row.account.mintUnwrapped.toString()).symbol),1),Ma,t("div",null," W"+$(m(O)().tokenList.find(_=>_.address==o.row.account.mintUnwrapped.toString()).symbol),1)])]),t("div",Ba,[Ea,t("div",La,$((d=o.row)!=null&&d.account.useLimit?(p=o.row)==null?void 0:p.account.limitAmountUnwrapped:"\u221E"),1)]),t("div",Ra,[Na,t("div",Ga,$(m(Te)((k=(b=o.row)==null?void 0:b.publicKey)==null?void 0:k.toString())),1)])]}),_:2},1024),e(Q),e(we,{class:"row text-h4"},{default:i(()=>[t("div",Oa,$(o.row.account.ratio[0]),1),e(le,{size:"md",name:"swap_horiz"}),t("div",ja,$(o.row.account.ratio[1]),1)]),_:2},1024),e(we,{class:"row"},{default:i(()=>[e(T,{class:"col q-mx-sm",flat:"",bordered:""},{default:i(()=>[e(x,null,{default:i(()=>[za]),_:1}),e(Q),Da,e(x,null,{default:i(()=>[e(he,{mintWrapped:o.row.account.mintWrapped.toString(),mintUnwrapped:o.row.account.mintUnwrapped.toString(),wrapper:o.row},null,8,["mintWrapped","mintUnwrapped","wrapper"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(x,{class:"col"},{default:i(()=>{var d,p;return[t("div",Xa,[t("div",Fa,[e(ae,{class:"",number:(d=m(X)().getAccountByMintPublicKey(o.row.account.mintUnwrapped))==null?void 0:d.uiAmount,decimals:4,"pad-start":10},null,8,["number"])]),Za,t("div",Ha,[e(ae,{class:"",number:(p=m(X)().getAccountByMintPublicKey(o.row.account.mintWrapped))==null?void 0:p.uiAmount,decimals:4,"pad-start":10},null,8,["number"])])]),t("div",Ja,[e(ka,{class:"col",wrapper:o.row},null,8,["wrapper"]),e(Wa,{class:"col",wrapper:o.row},null,8,["wrapper"])])]}),_:2},1024)]),_:2},1024)])]),_:1},8,["rows","filter","pagination"])]))}}),el=t("div",{class:"col text-h6"},"WrapperInterface",-1),tl={class:"row"},Cl=W({__name:"WrapperPage",setup(h){const c=w("wrapping");return r(),fe(async()=>{q()||Pe(),await r().updateStore()}),(u,s)=>(g(),V(qe,{class:"bg-black"},{default:i(()=>[e(T,null,{default:i(()=>[e(x,{class:"row items-center q-gutter-x-md"},{default:i(()=>[e(le,{name:"inventory_2",size:"md"}),el]),_:1}),e(Q),e(ce,{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=l=>c.value=l),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:i(()=>[e(j,{name:"wrapping",label:"Wrap / Unwrap"}),e(j,{name:"manage",label:"Manage"})]),_:1},8,["modelValue"]),e(Q),e(ue,{modelValue:c.value,"onUpdate:modelValue":s[2]||(s[2]=l=>c.value=l),animated:""},{default:i(()=>[e(z,{name:"wrapping"},{default:i(()=>[t("div",tl,[e(ie,{class:"col"}),e(M,{square:"",color:"primary",label:"reload",onClick:s[1]||(s[1]=()=>{m(r)().updateStore()})})]),e(T,{flat:""},{default:i(()=>[e(x,null,{default:i(()=>[e(Ya)]),_:1})]),_:1})]),_:1}),e(z,{name:"manage",class:"row q-gutter-x-md"},{default:i(()=>{var l;return[e(ct,{class:"col-3"}),(l=m(r)().groupSelected)!=null&&l.account?(g(),V(Ua,{key:0,class:"col"})):P("",!0)]}),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{Cl as default};
