import{Q as W}from"./QSpace.444a5bde.js";import{Q as T}from"./QBadge.3a569f33.js";import{Q as B,a as E}from"./QCard.95b61a76.js";import{Q as G}from"./QSeparator.4c0f518e.js";import{Q as g}from"./QInput.87d32499.js";import{I as X,C as P}from"./ClosePopup.55945c0f.js";import{b$ as Y,L as w,aj as N,aH as S,aE as Z,cC as ee,aS as le,cO as ae,cm as C,aw as A,b3 as V,am as q,au as n,bz as d,at as x,an as f,bB as I,Y as K,a8 as M,aZ as te,ei as oe,u as ne,ak as h,al as $,b9 as J,bX as H,a3 as _,bW as Q}from"./index.8621ca6e.js";import{Q as ue}from"./QPage.ba7b88a7.js";import{u as b}from"./globalJsonBin.65be70e3.js";import{Q as se,c as re}from"./QSelect.dace3a3e.js";import{Q as ie}from"./QCardActions.7878ff06.js";function D(e,r=new WeakMap){if(Object(e)!==e)return e;if(r.has(e))return r.get(e);const a=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e instanceof Set?new Set:e instanceof Map?new Map:typeof e.constructor!="function"?Object.create(null):e.prototype!==void 0&&typeof e.prototype.constructor=="function"?e:new e.constructor;if(typeof e.constructor=="function"&&typeof e.valueOf=="function"){const i=e.valueOf();if(Object(i)!==i){const c=new e.constructor(i);return r.set(e,c),c}}return r.set(e,a),e instanceof Set?e.forEach(i=>{a.add(D(i,r))}):e instanceof Map&&e.forEach((i,c)=>{a.set(c,D(i,r))}),Object.assign(a,...Object.keys(e).map(i=>({[i]:D(e[i],r)})))}var U=Y({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(e,{slots:r,emit:a}){const{proxy:i}=Z(),{$q:c}=i,l=w(null),o=w(""),s=w("");let v=!1;const y=N(()=>ee({initialValue:o.value,validate:e.validate,set:u,cancel:t,updatePosition:m},"value",()=>s.value,p=>{s.value=p}));function u(){e.validate(s.value)!==!1&&(k()===!0&&(a("save",s.value,o.value),a("update:modelValue",s.value)),O())}function t(){k()===!0&&a("cancel",s.value,o.value),O()}function m(){le(()=>{l.value.updatePosition()})}function k(){return ae(s.value,o.value)===!1}function O(){v=!0,l.value.hide()}function R(){v=!1,o.value=D(e.modelValue),s.value=D(e.modelValue),a("beforeShow")}function L(){a("show")}function j(){v===!1&&k()===!0&&(e.autoSave===!0&&e.validate(s.value)===!0?(a("save",s.value,o.value),a("update:modelValue",s.value)):a("cancel",s.value,o.value)),a("beforeHide")}function z(){a("hide")}function F(){const p=r.default!==void 0?[].concat(r.default(y.value)):[];return e.title&&p.unshift(S("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},e.title)),e.buttons===!0&&p.push(S("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[S(C,{flat:!0,color:e.color,label:e.labelCancel||c.lang.label.cancel,onClick:t}),S(C,{flat:!0,color:e.color,label:e.labelSet||c.lang.label.set,onClick:u})])),p}return Object.assign(i,{set:u,cancel:t,show(p){l.value!==null&&l.value.show(p)},hide(p){l.value!==null&&l.value.hide(p)},updatePosition:m}),()=>{if(e.disable!==!0)return S(X,{ref:l,class:"q-popup-edit",cover:e.cover,onBeforeShow:R,onShow:L,onBeforeHide:j,onHide:z,onEscapeKey:t},F)}}});const de={class:"row"},ce=A({__name:"CreateNewJobDialog",props:["jobTypes"],setup(e){const r=w(!1),a=w({jobType:0}),i=N(()=>!(a.value.name&&a.value.description));return(c,l)=>(V(),q(M,null,[n(C,{round:"",color:"primary",icon:"add",onClick:l[0]||(l[0]=o=>r.value=!0)}),n(re,{modelValue:r.value,"onUpdate:modelValue":l[7]||(l[7]=o=>r.value=o),class:"justify-center","backdrop-filter":"brightness(60%)"},{default:d(()=>[n(B,null,{default:d(()=>[n(E,{class:"row items-center q-pb-none text-h6"},{default:d(()=>[x(" Create new Job ")]),_:1}),n(E,null,{default:d(()=>[n(se,{modelValue:a.value.jobType,"onUpdate:modelValue":l[1]||(l[1]=o=>a.value.jobType=o),options:e.jobTypes,"option-value":"id","option-label":"name","option-disable":"inactive",label:"JobType","emit-value":"","map-options":""},null,8,["modelValue","options"]),n(g,{modelValue:a.value.name,"onUpdate:modelValue":l[2]||(l[2]=o=>a.value.name=o),label:"Label"},null,8,["modelValue"]),n(g,{modelValue:a.value.description,"onUpdate:modelValue":l[3]||(l[3]=o=>a.value.description=o),label:"Description"},null,8,["modelValue"]),f("div",de,[n(g,{modelValue:a.value.assigned,"onUpdate:modelValue":l[4]||(l[4]=o=>a.value.assigned=o),label:"Assigned"},null,8,["modelValue"]),n(g,{modelValue:a.value.reward,"onUpdate:modelValue":l[5]||(l[5]=o=>a.value.reward=o),label:"Reward"},null,8,["modelValue"])])]),_:1}),n(ie,{align:"right"},{default:d(()=>[I(n(C,{label:"Close",color:"primary"},null,512),[[P]]),I(n(C,{disable:i.value,label:"Add",color:"primary",onClick:l[6]||(l[6]=o=>K(b)().add(a.value))},null,8,["disable"]),[[P]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),me={class:"row q-pb-sm"},fe={class:"row q-gutter-x-sm"},pe=["onDrop"],ve={class:"row items-center q-gutter-x-sm"},Ve={class:"col text-h5"},be={class:"text-subtitle1 text-weight-light"},ge={class:"row q-mb-md"},we={class:"text-h6 col"},ye={class:"row q-gutter-x-sm"},_e={class:"col text-subtitle1 text-weight-light"},Ee=A({__name:"JobsPage",setup(e){te(async()=>{let l=await b().read();console.log(l)});const r=w([{id:0,name:"Todo",description:"This hasn't been completed",color:"green"},{id:1,name:"In Progress",description:"This is actively worked on",color:"yellow-7"},{id:2,name:"Done",description:"This has been completed",color:"purple"}]);oe(()=>b().data.record,()=>{b().update()});const a=w(ne().is_admin||!1);function i(l,o){l.dataTransfer.dropEffect="move",l.dataTransfer.effectAllowed="move",l.dataTransfer.setData("itemID",o.timestamp)}function c(l,o){const s=l.dataTransfer.getData("itemID"),v=b().data.record.findIndex(y=>y.timestamp==s);b().data.record[v].jobType=o}return(l,o)=>(V(),h(ue,{class:"col q-pa-sm"},{default:d(()=>[f("div",me,[n(W),a.value?(V(),h(ce,{key:0,"job-types":r.value},null,8,["job-types"])):$("",!0)]),f("div",fe,[(V(!0),q(M,null,J(r.value,s=>{var v,y;return V(),q("div",{class:"col",key:s,onDrop:u=>c(u,s.id),onDragover:o[0]||(o[0]=H(()=>{},["prevent"])),onDragenter:o[1]||(o[1]=H(()=>{},["prevent"]))},[n(B,{flat:"",square:"",class:"q-pa-sm"},{default:d(()=>[f("div",ve,[f("div",Ve,_(s.name),1),n(T,{rounded:"",color:s.color,"text-color":"black"},null,8,["color"])]),f("div",be,_(s.description),1)]),_:2},1024),n(G),(V(!0),q(M,null,J((y=(v=K(b)().data)==null?void 0:v.record)==null?void 0:y.filter(u=>u.jobType==s.id),u=>(V(),h(B,{flat:"",square:"",class:"q-pa-sm q-mt-sm",key:u.timestamp},{default:d(()=>[n(E,{draggable:"true",onDragstart:t=>i(t,u)},{default:d(()=>[f("div",ge,[f("div",we,[x(_(u.name)+" ",1),n(U,{modelValue:u.name,"onUpdate:modelValue":t=>u.name=t,"auto-save":""},{default:d(t=>[n(g,{modelValue:t.value,"onUpdate:modelValue":m=>t.value=m,dense:"",autofocus:"",counter:"",onKeyup:Q(t.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),a.value?(V(),h(C,{key:0,icon:"delete",flat:"",dense:"",size:"xs",onClick:t=>K(b)().remove(u)},null,8,["onClick"])):$("",!0)]),f("div",ye,[f("div",_e,[x(_(u.description)+" ",1),n(U,{modelValue:u.description,"onUpdate:modelValue":t=>u.description=t,"auto-save":""},{default:d(t=>[n(g,{modelValue:t.value,"onUpdate:modelValue":m=>t.value=m,dense:"",autofocus:"",counter:"",onKeyup:Q(t.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),n(T,null,{default:d(()=>[x(_(u.assigned??"-none-")+" ",1),n(U,{modelValue:u.assigned,"onUpdate:modelValue":t=>u.assigned=t,"auto-save":""},{default:d(t=>[n(g,{modelValue:t.value,"onUpdate:modelValue":m=>t.value=m,dense:"",autofocus:"",counter:"",onKeyup:Q(t.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),n(T,{class:"justify-center",color:"grey"},{default:d(()=>[x(_(u.reward??"-none-")+" ",1),n(U,{modelValue:u.reward,"onUpdate:modelValue":t=>u.reward=t,"auto-save":""},{default:d(t=>[n(g,{modelValue:t.value,"onUpdate:modelValue":m=>t.value=m,dense:"",autofocus:"",counter:"",onKeyup:Q(t.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)])]),_:2},1032,["onDragstart"])]),_:2},1024))),128))],40,pe)}),128))])]),_:1}))}});export{Ee as default};
