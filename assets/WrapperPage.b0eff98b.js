import{cM as Se,dj as M,P as C,au as k,cj as I,J as m,b1 as b,ak as P,as as e,bV as ve,ck as N,d9 as L,ai as V,V as p,bx as u,al as a,a1 as U,aj as q,dq as z,cm as le,d0 as X,dg as K,b7 as Ve,a6 as $e,bs as oe,da as j,aX as fe,ah as ge,b9 as Ue,cn as F,cN as Y,d$ as ke,eh as We}from"./index.6f9d9acd.js";import{Q as W,a as x}from"./QInput.abc32109.js";import{Q}from"./QSeparator.ab152b39.js";import{a as G,Q as ue}from"./QTabs.ba34480c.js";import{Q as T}from"./QCard.b5501b3e.js";import{a as O,Q as ce}from"./QTabPanels.e18d8400.js";import{Q as Ae}from"./QPage.d103ff3e.js";import{Q as de}from"./QSlideTransition.36c117b1.js";import{g as A,h as E}from"./handleTransaction.3419851b.js";import{Q as ee}from"./QSelect.97511172.js";import{c as ne,Q as J}from"./calcAmountToTransfer.6d92e7de.js";import{Q as Ce}from"./QList.46182c39.js";import{Q as B}from"./QToggle.1482ddae.js";import{a as se,b as te,c as qe,d as Z,f as ae,s as Pe}from"./WrapperInterface.cb9ee978.js";import{Q as Te}from"./QImg.2eb9ede0.js";import{Q as _e}from"./QCardActions.5560e239.js";import{f as Ie,a as Qe}from"./format_address.4ec39e31.js";import{U as Ke}from"./constants.e2ffd8e4.js";import{c as Me}from"./associatedTokenAccount.79e4fec0.js";import"./rtl.4943127c.js";import"./touch.3df10340.js";import"./use-checkbox.c2b6bf32.js";import"./SquadsStore.ae1778f5.js";import"./pda.d9ef2a70.js";import"./cusper.f5593d2f.js";import"./assert.fbaabdee.js";import"./vaultTransactionCreate.7cb20940.js";import"./token.0cd8ec4a.js";let Ne;const pe=()=>Ne,r=Se("wrapperStore",{state:()=>({wrapperSelected:{},groupSelected:{},wrapper:[],groups:[]}),getters:{},actions:{async updateStore(){if(M()){const{pg_wrapper:h}=M();this.groups=await h.value.account.group.all(),this.wrapper=await h.value.account.wrapper.all(),this.groupSelected||(this.groupSelected=this.groups[0]),console.log("[Updated] WrapperStore")}}}}),Le=new C("subA4tNLV18htV8xACaZyMMKkAm1AQS4EhiPYPV4zbH"),Ee={class:"row"},Re=k({__name:"WrapperCreateGroup",setup(h){const c=I(),i=m("");async function s(){try{const l=new L,t=M().pg_wrapper.value;if(i.value==""){c.notify({message:"Invalid group name",color:"info",position:"bottom-right"});return}l.add(await t.methods.initializeGroup(i.value).accountsPartial({signer:A(),fee:Le}).instruction()),await E(l,"[Raffle] create new group"),await r().updateStore()}catch(l){c.notify({message:l.message,type:"negative"})}}return(l,t)=>(b(),P("div",Ee,[e(W,{square:"",filled:"",class:"col",modelValue:i.value,"onUpdate:modelValue":t[0]||(t[0]=n=>i.value=n),label:"New group name",type:"text"},null,8,["modelValue"]),e(N,{square:"",onClick:t[1]||(t[1]=ve(n=>s(),["prevent"])),color:"primary",label:"Create"})]))}}),ie=k({__name:"WrapperGroupSelect",setup(h){return(c,i)=>(b(),V(ee,{label:"Select a group",square:"",filled:"",modelValue:p(r)().groupSelected,"onUpdate:modelValue":i[0]||(i[0]=s=>p(r)().groupSelected=s),options:p(r)().groups,"option-label":s=>{var l;return(l=s==null?void 0:s.account)==null?void 0:l.name}},null,8,["modelValue","options","option-label"]))}}),Be=k({__name:"WrapperCloseGroup",props:{disabled:{default:!0}},setup(h){const c=I();async function i(){try{const s=new L,l=M().pg_wrapper.value;s.add(await l.methods.closeGroup().accountsPartial({group:r().groupSelected.publicKey,signer:A()}).instruction()),await E(s,"Close Group"),await r().updateStore()}catch(s){c.notify({message:s.message,type:"negative"})}}return(s,l)=>(b(),V(N,{disable:h.disabled,square:"",color:"primary",label:"Close",onClick:l[0]||(l[0]=ve(t=>i(),["prevent"]))},null,8,["disable"]))}}),Ge=a("div",{class:"text-h5"},"Group",-1),Oe=a("div",{class:"text-caption text-grey"}," The group will be used to filter and create the wrappers - one time creation fee of 0.5 SOL ",-1),je=a("div",{class:"text-caption text-accent"}," Make sure u use a list where you are the owner! ",-1),ze={key:0,class:"text-caption row"},De=a("div",{style:{width:"50px"}},"ID",-1),Xe={class:"col text-right"},Fe={key:1,class:"text-caption row"},Ze=a("div",{style:{width:"50px"}},"Owner",-1),He={class:"col text-accent text-right"},Je={class:"row"},Ye={key:0,class:"text-caption row"},et=a("div",{style:{width:"50px"}},"ID:",-1),tt={class:"col text-accent text-right"},at={key:1,class:"text-caption row"},lt=a("div",{style:{width:"50px"}},"Owner:",-1),ot={class:"col text-accent text-right"},nt=a("div",{class:"text-h6 text-red-6 col"}," I know what im doing i want to close the group ",-1),rt=k({__name:"WrapperGroupView",setup(h){const c=m("select"),i=m(!1);return(s,l)=>(b(),V(T,{flat:"",bordered:""},{default:u(()=>[e(x,null,{default:u(()=>[Ge,Oe,je]),_:1}),e(Q),e(ue,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=t=>c.value=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:u(()=>[e(G,{name:"select",label:"Select"}),e(G,{name:"create",label:"Create"}),e(G,{name:"close",label:"Close"})]),_:1},8,["modelValue"]),e(Q),e(ce,{modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=t=>c.value=t),animated:""},{default:u(()=>[e(O,{name:"create"},{default:u(()=>[e(Re)]),_:1}),e(O,{name:"select"},{default:u(()=>[e(ie,{class:""}),e(x,null,{default:u(()=>{var t,n,o,d,w;return[(t=p(r)().groupSelected)!=null&&t.account?(b(),P("div",ze,[De,a("div",Xe,U((n=p(r)().groupSelected)==null?void 0:n.publicKey),1)])):q("",!0),(o=p(r)().groupSelected)!=null&&o.account?(b(),P("div",Fe,[Ze,a("div",He,U((w=(d=p(r)().groupSelected)==null?void 0:d.account)==null?void 0:w.owner),1)])):q("",!0)]}),_:1})]),_:1}),e(O,{name:"close"},{default:u(()=>[a("div",Je,[e(ie,{class:"col"}),e(Be,{disabled:!i.value},null,8,["disabled"])]),e(x,null,{default:u(()=>{var t,n,o,d,w;return[(t=p(r)().groupSelected)!=null&&t.account?(b(),P("div",Ye,[et,a("div",tt,U((n=p(r)().groupSelected)==null?void 0:n.publicKey),1)])):q("",!0),(o=p(r)().groupSelected)!=null&&o.account?(b(),P("div",at,[lt,a("div",ot,U((w=(d=p(r)().groupSelected)==null?void 0:d.account)==null?void 0:w.owner),1)])):q("",!0)]}),_:1}),e(x,{class:"row items-center"},{default:u(()=>[e(de,{color:"red",modelValue:i.value,"onUpdate:modelValue":l[1]||(l[1]=t=>i.value=t)},null,8,["modelValue"]),nt]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),st=a("div",{class:"text-h6"},"Unwrapped Token",-1),it={class:"row q-gutter-x-md items-center"},ut=a("div",{class:"text-h6"},"Wrapped Token",-1),ct={class:"row q-gutter-x-md items-center"},dt=a("div",{class:"text-h6"},"Ratio",-1),pt={class:"row q-gutter-x-md items-center"},mt={class:"row items-center"},wt=a("div",{class:"text-h6"},"Add Medata",-1),_t={key:0,class:"row items-center q-gutter-x-sm"},vt=k({__name:"WrapperCreate",setup(h){const c=I(),i=m(),s=m(9),l=m(1),t=m(1),n=m(!0),o=m(""),d=m(""),w=m("");async function f(){var $;try{const v=new L,S=M().pg_wrapper.value,R=new X(window.crypto.getRandomValues(new Uint8Array(8))),H={ratio:[new X(l.value),new X(t.value)],onlyCreatorCanUnwrap:!1,wrappedDecimals:s.value,seed:R};if(v.add(await S.methods.initialize(H).accountsPartial({signer:A(),group:new C((($=r().groupSelected)==null?void 0:$.publicKey.toString())??""),mintUnwrapped:new C(i.value.mint.toString()),tokenProgram:K}).instruction()),v.add(await S.methods.createVault().accountsPartial({signer:A(),wrapper:se(new C(i.value.mint.toString()),A()),vaultUnwrappedAta:te(se(new C(i.value.mint.toString()),A()),new C(i.value.mint.toString())),mintUnwrapped:new C(i.value.mint.toString()),tokenProgram:K}).instruction()),n.value){const re={name:o.value,symbol:d.value,uri:w.value},D=se(new C(i.value.mint.toString()),A()),_=qe(D,R),g=Z(_);v.add(await S.methods.metadataCreate(re).accountsPartial({signer:A(),wrapper:D,mintWrapped:_,mintUnwrapped:new C(i.value.mint.toString()),metadata:g,tokenProgram:K}).instruction())}await E(v,`[Wrapper] create + vault ${n.value?"+ metadata":""}`),await r().updateStore()}catch(v){console.error(v),c.notify({message:v.message,type:"negative",position:"bottom-right"})}}return($,v)=>(b(),V(T,{flat:""},{default:u(()=>[e(x,{class:""},{default:u(()=>[st,a("div",it,[e(ee,{filled:"",square:"",class:"col",options:p(z)().getAccountsBalanceNotZero,"option-label":S=>{var R;return((R=S.info)==null?void 0:R.name)??S.mint},modelValue:i.value,"onUpdate:modelValue":v[0]||(v[0]=S=>i.value=S),label:"Token to Wrap",type:"number"},null,8,["options","option-label","modelValue"])])]),_:1}),e(x,null,{default:u(()=>[ut,a("div",ct,[e(W,{square:"",filled:"",class:"col",modelValue:s.value,"onUpdate:modelValue":v[1]||(v[1]=S=>s.value=S),label:"Decimals",type:"number"},null,8,["modelValue"])])]),_:1}),e(x,null,{default:u(()=>[dt,a("div",pt,[e(W,{square:"",filled:"",class:"col",modelValue:l.value,"onUpdate:modelValue":v[2]||(v[2]=S=>l.value=S),label:"Unwrapped",type:"number"},null,8,["modelValue"]),e(le,{name:"swap_horiz",size:"xl  "}),e(W,{square:"",filled:"",class:"col",modelValue:t.value,"onUpdate:modelValue":v[3]||(v[3]=S=>t.value=S),label:"Wrapped",type:"number"},null,8,["modelValue"])])]),_:1}),e(x,null,{default:u(()=>[a("div",mt,[wt,e(B,{modelValue:n.value,"onUpdate:modelValue":v[4]||(v[4]=S=>n.value=S),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),n.value?(b(),P("div",_t,[e(W,{square:"",filled:"",class:"col",modelValue:o.value,"onUpdate:modelValue":v[5]||(v[5]=S=>o.value=S),label:"Name",type:"text"},null,8,["modelValue"]),e(W,{square:"",filled:"",class:"col",modelValue:d.value,"onUpdate:modelValue":v[6]||(v[6]=S=>d.value=S),label:"Symbol",type:"text"},null,8,["modelValue"]),e(W,{square:"",filled:"",class:"col",modelValue:w.value,"onUpdate:modelValue":v[7]||(v[7]=S=>w.value=S),label:"Image-URI",type:"text"},null,8,["modelValue"])])):q("",!0)]),_:1}),e(x,{class:"row justify-end"},{default:u(()=>[e(N,{square:"",color:"primary",label:"Create new wrapper",onClick:v[8]||(v[8]=S=>f())})]),_:1})]),_:1}))}}),ft={class:"row items-center"},gt=a("div",{class:"col text-subtitle1 text-weight-thin"},"Publickey",-1),bt={class:"text-subtitle2"},yt={class:"col text-subtitle1 text-weight-thin"},ht={key:0,class:"text-subtitle2"},xt={key:1,class:"text-subtitle2"},St=k({__name:"WrapperInfo",setup(h){return(c,i)=>{var s;return(s=p(r)().wrapperSelected)!=null&&s.account?(b(),V(T,{key:0,flat:""},{default:u(()=>[e(Q),e(x,null,{default:u(()=>{var l;return[a("div",ft,[gt,a("div",bt,U(p(r)().wrapperSelected.publicKey),1)]),(b(!0),P($e,null,Ve(Object.keys((l=p(r)().wrapperSelected)==null?void 0:l.account),t=>(b(),P("div",{key:t,class:"row items-center"},[a("div",yt,U(t.toUpperCase()),1),t=="ratio"?(b(),P("div",ht,U(p(r)().wrapperSelected.account[t][0])+" : "+U(p(r)().wrapperSelected.account[t][1]),1)):(b(),P("div",xt,U(p(r)().wrapperSelected.account[t]),1))]))),128))]}),_:1})]),_:1})):q("",!0)}}}),Vt=k({__name:"WrapperClose",props:{disabled:{default:!0}},setup(h){const c=I();async function i(){var s,l;try{const t=new L,n=M().pg_wrapper.value;t.add(await n.methods.close().accountsPartial({wrapper:(s=r().wrapperSelected)==null?void 0:s.publicKey,signer:A(),mintUnwrapped:(l=r().wrapperSelected)==null?void 0:l.account.mintUnwrapped,tokenProgram:K}).instruction()),await E(t,"[Wrapper] Close"),await r().updateStore()}catch(t){console.error(t),c.notify({message:t.message,type:"negative"})}}return(s,l)=>(b(),V(N,{disable:h.disabled,square:"",color:"primary",label:"Close WrapperInterface",onClick:l[0]||(l[0]=t=>i())},null,8,["disable"]))}}),$t={class:"row items-center"},Ut=a("div",{class:"col text-subtitle1"},"Allow wrap",-1),kt={class:"row items-center"},Wt=a("div",{class:"col text-subtitle1"},"Allow unwrap",-1),At={class:"row items-center"},Ct=a("div",{class:"col text-subtitle1"},"Only admin can Wrap",-1),qt={class:"row items-center"},Pt=a("div",{class:"col text-subtitle1"},"Only admin can unwrap",-1),Tt={class:"row items-center"},It=a("div",{class:"col text-subtitle1"},"Use whitelist",-1),Qt={class:"row items-center"},Kt=a("div",{class:"col text-subtitle1"},"Use Limit",-1),Mt={class:"row items-center"},Nt=a("div",{class:"col text-subtitle1"},"Change Admin",-1),Lt={class:"row items-center"},Et=a("div",{class:"col text-subtitle1"},"Change Ratio",-1),Rt={key:0,style:{width:"500px"},class:"row items-center"},Bt=k({__name:"WrapperSettings",setup(h){var D;const c=I();(D=r().wrapperSelected)==null||D.account;const i=m(),s=m(),l=m(),t=m(),n=m(),o=m(),d=m(),w=m(),f=m(!1),$=m(),v=m(!1),S=m(),R=m();H(),oe(()=>{var _,g;return(g=(_=r())==null?void 0:_.wrapperSelected)==null?void 0:g.account},()=>{H()});function H(){var g,y;if(!((g=r().wrapperSelected)!=null&&g.account))return;const _=(y=r().wrapperSelected)==null?void 0:y.account;i.value=_.allowWrap,s.value=_==null?void 0:_.allowUnwrap,l.value=_==null?void 0:_.onlyAdminCanWrap,t.value=_==null?void 0:_.onlyAdminCanUnwrap,n.value=_==null?void 0:_.useWhitelist,o.value=_==null?void 0:_.whitelist,d.value=_==null?void 0:_.useLimit,w.value=(_==null?void 0:_.limitAmountUnwrapped)??0,$.value=_==null?void 0:_.admin,S.value=_==null?void 0:_.ratio[0],R.value=_==null?void 0:_.ratio[1]}async function re(){var _,g;try{const y=new L,ye=M().pg_wrapper.value,he={allowWrap:i.value,allowUnwrap:s.value,onlyAdminCanWrap:l.value,onlyAdminCanUnwrap:t.value,useWhitelist:n.value,whitelistAddress:n.value?new C(o.value):null,useLimit:d.value,amountAbleToWrap:d.value?ne(w.value,j().tokenList.find(xe=>{var me,we;return xe.address==((we=(me=r().wrapperSelected)==null?void 0:me.account)==null?void 0:we.mintUnwrapped.toString())}).decimals):null,admin:f.value?new C($.value):null,ratio:v.value?[new X(S.value),new X(R.value)]:null};y.add(await ye.methods.edit(he).accountsPartial({wrapper:(_=r().wrapperSelected)==null?void 0:_.publicKey,signer:A(),mintUnwrapped:(g=r().wrapperSelected)==null?void 0:g.account.mintUnwrapped,whitelist:null,tokenProgram:K}).instruction()),await E(y),await r().updateStore()}catch(y){console.error(y),c.notify({message:y.message,type:"negative"})}}return(_,g)=>(b(),V(T,{flat:""},{default:u(()=>[e(x,{class:"q-gutter-y-sm"},{default:u(()=>[a("div",$t,[Ut,e(B,{modelValue:i.value,"onUpdate:modelValue":g[0]||(g[0]=y=>i.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",kt,[Wt,e(B,{modelValue:s.value,"onUpdate:modelValue":g[1]||(g[1]=y=>s.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",At,[Ct,e(B,{modelValue:l.value,"onUpdate:modelValue":g[2]||(g[2]=y=>l.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",qt,[Pt,e(B,{modelValue:t.value,"onUpdate:modelValue":g[3]||(g[3]=y=>t.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",Tt,[It,n.value?(b(),V(W,{key:0,dense:"",filled:"",square:"",style:{width:"500px"},modelValue:o.value,"onUpdate:modelValue":g[4]||(g[4]=y=>o.value=y),type:"text",label:"Whitelist"},null,8,["modelValue"])):q("",!0),e(B,{modelValue:n.value,"onUpdate:modelValue":g[5]||(g[5]=y=>n.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",Qt,[Kt,d.value?(b(),V(W,{key:0,dense:"",filled:"",square:"",style:{width:"500px"},modelValue:w.value,"onUpdate:modelValue":g[6]||(g[6]=y=>w.value=y),type:"number",label:"Amount wrappable"},null,8,["modelValue"])):q("",!0),e(B,{modelValue:d.value,"onUpdate:modelValue":g[7]||(g[7]=y=>d.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",null,[a("div",Mt,[Nt,f.value?(b(),V(W,{key:0,style:{width:"500px"},dense:"",filled:"",square:"",label:"Admin",modelValue:$.value,"onUpdate:modelValue":g[8]||(g[8]=y=>$.value=y)},null,8,["modelValue"])):q("",!0),e(B,{modelValue:f.value,"onUpdate:modelValue":g[9]||(g[9]=y=>f.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])])]),a("div",null,[a("div",Lt,[Et,v.value?(b(),P("div",Rt,[e(W,{class:"col",dense:"",filled:"",square:"",label:"Unwrapped",modelValue:S.value,"onUpdate:modelValue":g[10]||(g[10]=y=>S.value=y),type:"number"},null,8,["modelValue"]),e(le,{size:"md",name:"swap_horiz"}),e(W,{class:"col",dense:"",filled:"",square:"",label:"Wrapped",modelValue:R.value,"onUpdate:modelValue":g[11]||(g[11]=y=>R.value=y),type:"number"},null,8,["modelValue"])])):q("",!0),e(B,{modelValue:v.value,"onUpdate:modelValue":g[12]||(g[12]=y=>v.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])])])]),_:1}),e(x,{class:"row justify-end"},{default:u(()=>[e(N,{square:"",class:"",color:"primary",label:"Update settings",onClick:g[13]||(g[13]=y=>re())})]),_:1})]),_:1}))}}),Gt=k({__name:"WrapperCreateVault",setup(h){const c=I(),i=m(!1);async function s(l){try{const t=new L,n=pe().pg_wrapper.value;t.add(await n.methods.createVault().accountsPartial({wrapper:new C(r().wrapperSelected.publicKey.toString()),signer:A(),mintUnwrapped:new C(r().wrapperSelected.account.mintUnwrapped.toString()),tokenProgram:K}).instruction()),await E(t,"[Wrapper] create vault")}catch(t){console.error(t),c.notify({message:t.message,type:"negative"})}}return(l,t)=>{var n;return!i.value&&((n=p(r)().wrapperSelected)==null?void 0:n.publicKey)?(b(),V(N,{key:0,square:"",color:"primary",label:"Create Vault",onClick:t[0]||(t[0]=o=>s())})):q("",!0)}}}),be=k({__name:"WrapperVaultDonut",props:["wrapper"],setup(h){const c=h,i=m(0),s=m(0);async function l(){i.value=await t()*c.wrapper.account.ratio[0],s.value=await n()*c.wrapper.account.ratio[1]}async function t(){return(await F().connection.getTokenSupply(new C(c.wrapper.account.mintWrapped))).value.uiAmount}async function n(){let w=te(c.wrapper.publicKey,c.wrapper.account.mintUnwrapped);return(await F().connection.getTokenAccountBalance(w)).value.uiAmount}fe(async()=>{await l()});const o=ge(()=>[s.value,i.value]),d=m({dataLabels:{enabled:!1},legend:{labels:{colors:"white"},show:!0,position:"bottom"},theme:{palette:"palette3"},labels:["Vault","Circ. Supply"]});return(w,f)=>{const $=Ue("apexchart");return b(),V($,{height:"200px",type:"donut",options:d.value,series:o.value},null,8,["options","series"])}}}),Ot={class:"text-subtitle2 row items-center"},jt=a("div",{class:"text-accent"}," I want to transfer tokens out of the vault to a new address ",-1),zt={class:"col"},Dt={class:"row"},Xt=k({__name:"WrapperTransferVaultOut",setup(h){const c=I(),i=m(1),s=m("C6LnFVyc5Qj2LAPdkX5CyyEEga9ePPB6ZRuzGhirZnqX"),l=m(!1);async function t(){try{if(M()){const n=new L,o=M().pg_wrapper.value;n.add(await o.methods.transferVault(ne(i.value,z().getAccountByMintPublicKey(r().wrapperSelected.account.mintUnwrapped).decimals)).accountsPartial({signer:A(),wrapper:r().wrapperSelected.publicKey,mintUnwrapped:r().wrapperSelected.account.mintUnwrapped,ataUnwrappedSigner:ae(new C(s.value).toString(),r().wrapperSelected.account.mintUnwrapped.toString()),tokenProgram:K}).instruction()),await E(n,`[Wrapper] transfer to ${s.value}`),await r().updateStore()}}catch(n){console.error(n),c.notify({message:n.message,type:"negative"})}}return(n,o)=>(b(),V(T,{flat:""},{default:u(()=>[a("div",Ot,[e(de,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=d=>l.value=d)},null,8,["modelValue"]),jt]),a("div",zt,[a("div",Dt,[e(W,{class:"col",disable:!l.value,square:"",filled:"",modelValue:s.value,"onUpdate:modelValue":o[1]||(o[1]=d=>s.value=d),type:"text",label:"recipient"},null,8,["disable","modelValue"]),e(Q,{vertical:""}),e(W,{disable:!l.value,square:"",filled:"",modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=d=>i.value=d),type:"number",label:"Amount to transfer"},null,8,["disable","modelValue"]),e(N,{disable:!i.value||!s.value||!l.value,color:"primary",label:"Send",square:"",onClick:o[3]||(o[3]=d=>t())},null,8,["disable"])])])]),_:1}))}}),Ft={class:"row items-center"},Zt=a("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),Ht={class:"text-subtitle2"},Jt={class:"row items-center"},Yt=a("div",{class:"col text-subtitle1 text-weight-thin"},"Mint",-1),ea={class:"text-subtitle2"},ta={class:"row items-center"},aa=a("div",{class:"col text-subtitle1 text-weight-thin"},"Unwrapped",-1),la={class:"text-subtitle2"},oa={class:"row items-center"},na=a("div",{class:"col text-subtitle1 text-weight-thin"},"Balance",-1),ra={class:"text-subtitle2"},sa=k({__name:"WrapperVault",setup(h){I();const c=m(null),i=m(!1);s(),oe(()=>{var l,t;return(t=(l=r())==null?void 0:l.wrapperSelected)==null?void 0:t.account},async()=>{await s()});async function s(){var l;c.value=(l=(await F().connection.getParsedAccountInfo(te(r().wrapperSelected.publicKey,r().wrapperSelected.account.mintUnwrapped))).value)==null?void 0:l.data,c.value&&(i.value=!0)}return(l,t)=>(b(),V(T,{flat:""},{default:u(()=>[e(Q),e(x,{class:"col"},{default:u(()=>{var n,o;return[a("div",Ft,[Zt,a("div",Ht,U(p(te)(p(r)().wrapperSelected.publicKey,p(r)().wrapperSelected.account.mintUnwrapped)),1)]),a("div",Jt,[Yt,a("div",ea,U((n=p(r)().wrapperSelected.account)==null?void 0:n.mintUnwrapped),1)]),a("div",ta,[aa,a("div",la,U(p(j)().getTokenByMintPublicKey(p(r)().wrapperSelected.account.mintUnwrapped).name),1)]),a("div",oa,[na,a("div",ra,U((o=c.value)==null?void 0:o.parsed.info.tokenAmount.uiAmount),1)])]}),_:1}),e(x,null,{default:u(()=>[e(be,{wrapper:p(r)().wrapperSelected},null,8,["wrapper"])]),_:1}),e(x,{class:"q-gutter-y-md"},{default:u(()=>[i.value?q("",!0):(b(),V(Gt,{key:0,class:"full-width"})),e(Xt)]),_:1})]),_:1}))}}),ia=k({__name:"WrapperMetadataUpdate",props:["name","symbol","uri"],setup(h){const c=h,i=I();async function s(l){var t,n;try{const o=new L,d=pe().pg_wrapper.value,w={name:c.name,symbol:c.symbol,uri:c.uri};o.add(await d.methods.metadataUpdate(w).accountsPartial({wrapper:(t=r().wrapperSelected)==null?void 0:t.publicKey,signer:A(),metadata:Z(r().wrapperSelected.account.mintWrapped),mintUnwrapped:(n=r().wrapperSelected)==null?void 0:n.account.mintUnwrapped,tokenProgram:K}).instruction()),await E(o,"[Wrapper] metadata update"),await r().updateStore()}catch(o){console.error(o),i.notify({message:o.message,type:"negative"})}}return(l,t)=>(b(),V(N,{square:"",color:"primary",label:"Apply Metadata",onClick:t[0]||(t[0]=n=>s())}))}}),ua=k({__name:"WrapperMetadataCreate",props:["name","symbol","uri"],setup(h){const c=h,i=I();async function s(l){var t,n;try{const o=new L,d=pe().pg_wrapper.value,w={name:c.name,symbol:c.symbol,uri:c.uri};o.add(await d.methods.metadataCreate(w).accountsPartial({wrapper:(t=r().wrapperSelected)==null?void 0:t.publicKey,signer:A(),metadata:Z(r().wrapperSelected.account.mintWrapped),mintUnwrapped:(n=r().wrapperSelected)==null?void 0:n.account.mintUnwrapped,tokenProgram:K}).instruction()),await E(o,"[Wrapper] metadata create"),await r().updateStore()}catch(o){console.error(o),i.notify({message:o.message,type:"negative"})}}return(l,t)=>(b(),V(N,{square:"",color:"primary",label:"Create Metadata",onClick:t[0]||(t[0]=n=>s())}))}}),ca={class:"row items-center"},da=a("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),pa={class:"text-subtitle2"},ma={class:"row"},wa=k({__name:"WrapperMetadata",setup(h){I();const c=m(""),i=m(""),s=m(""),l=m(),t=m(),n=m(!1);o(),oe(()=>{var d,w;return(w=(d=r())==null?void 0:d.wrapperSelected)==null?void 0:w.account},async()=>{await o()});async function o(){l.value=await F().connection.getAccountInfo(Z(r().wrapperSelected.account.mintWrapped)),t.value=Pe.deserializeMetadata(l.value),c.value=t.value.name,i.value=t.value.symbol,s.value=t.value.uri,l.value&&(n.value=!0)}return(d,w)=>(b(),V(T,{flat:""},{default:u(()=>[e(x,null,{default:u(()=>[a("div",ca,[da,a("div",pa,U(p(Z)(p(r)().wrapperSelected.publicKey)),1)])]),_:1}),n.value?(b(),V(x,{key:0,class:"col"},{default:u(()=>[a("div",ma,[e(W,{square:"",label:"Name",filled:"",modelValue:c.value,"onUpdate:modelValue":w[0]||(w[0]=f=>c.value=f)},null,8,["modelValue"]),e(Q,{vertical:""}),e(W,{square:"",label:"Symbol",filled:"",modelValue:i.value,"onUpdate:modelValue":w[1]||(w[1]=f=>i.value=f)},null,8,["modelValue"]),e(Q,{vertical:""}),e(W,{square:"",label:"Image URI",class:"col",filled:"",modelValue:s.value,"onUpdate:modelValue":w[2]||(w[2]=f=>s.value=f)},null,8,["modelValue"]),e(ia,{name:c.value,symbol:i.value,uri:s.value},null,8,["name","symbol","uri"])])]),_:1})):(b(),V(x,{key:1,class:"row justify-end"},{default:u(()=>[e(ua,{name:c.value,symbol:i.value,uri:s.value},null,8,["name","symbol","uri"])]),_:1}))]),_:1}))}}),_a=a("div",{class:"text-h5"},"WrapperInterface Factory",-1),va=a("div",{class:"text-caption text-grey"}," Small plates, salads & sandwiches in an intimate setting. ",-1),fa={class:"row q-gutter-x-md"},ga={class:"text-caption text-grey text-right"},ba={class:"row"},ya=a("div",{class:"text-h6 text-red-6 col"}," I know what im doing i want to close a wrapper ",-1),ha=k({__name:"WrapperManage",setup(h){const c=m("select"),i=m(!1);return(s,l)=>(b(),V(T,{flat:"",bordered:""},{default:u(()=>[e(x,null,{default:u(()=>[_a,va]),_:1}),e(Q),e(ue,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=t=>c.value=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:u(()=>[e(G,{name:"create",label:"Create"}),e(G,{name:"select",label:"Edit"}),e(G,{name:"close",label:"Close"})]),_:1},8,["modelValue"]),e(Q),e(ce,{modelValue:c.value,"onUpdate:modelValue":l[4]||(l[4]=t=>c.value=t),animated:""},{default:u(()=>[e(O,{name:"create"},{default:u(()=>[e(vt)]),_:1}),e(O,{name:"select"},{default:u(()=>[e(T,{flat:""},{default:u(()=>{var t;return[e(x,null,{default:u(()=>[a("div",fa,[e(ee,{label:"Select a wrapper",class:"col",filled:"",modelValue:p(r)().wrapperSelected,"onUpdate:modelValue":l[1]||(l[1]=n=>p(r)().wrapperSelected=n),options:p(r)().wrapper,"option-label":n=>{var o,d;return"[Wrapped] "+(((o=p(j)().tokenList.find(w=>{var f,$;return w.address==(($=(f=n.account)==null?void 0:f.mintUnwrapped)==null?void 0:$.toString())}))==null?void 0:o.name)??((d=n.account)==null?void 0:d.mintUnwrapped.toString())??"")}},null,8,["modelValue","options","option-label"])]),a("div",ga," Total Found: "+U(p(r)().wrapper.length),1)]),_:1}),(t=p(r)().wrapperSelected)!=null&&t.account?(b(),V(x,{key:0,class:"row full-width"},{default:u(()=>[e(Ce,{bordered:"",class:"rounded-borders full-width"},{default:u(()=>[e(J,{"expand-separator":"",class:"text-h5",icon:"info",label:"Info"},{default:u(()=>[e(St)]),_:1}),e(J,{"expand-separator":"",class:"text-h5",icon:"settings",label:"Settings"},{default:u(()=>[e(Bt)]),_:1}),e(J,{"expand-separator":"",class:"text-h5",icon:"note_add",label:"Metadata"},{default:u(()=>[e(wa)]),_:1}),e(J,{"default-opened":"","expand-separator":"",class:"text-h5",icon:"inventory_2",label:"Vault"},{default:u(()=>[e(sa)]),_:1})]),_:1})]),_:1})):q("",!0)]}),_:1})]),_:1}),e(O,{name:"close"},{default:u(()=>[e(T,{flat:""},{default:u(()=>{var t;return[e(x,null,{default:u(()=>[a("div",ba,[e(ee,{label:"Select a wrapper",class:"col",filled:"",modelValue:p(r)().wrapperSelected,"onUpdate:modelValue":l[2]||(l[2]=n=>p(r)().wrapperSelected=n),options:p(r)().wrapper,"option-label":n=>{var o,d;return"[Wrapped] "+(((o=p(j)().tokenList.find(w=>{var f,$;return w.address==(($=(f=n.account)==null?void 0:f.mintUnwrapped)==null?void 0:$.toString())}))==null?void 0:o.name)??((d=n.account)==null?void 0:d.mintUnwrapped.toString())??"")}},null,8,["modelValue","options","option-label"]),e(Vt,{disabled:!i.value},null,8,["disabled"])])]),_:1}),(t=p(r)().wrapperSelected)!=null&&t.account?(b(),V(x,{key:0,class:"row justify-between"})):q("",!0)]}),_:1}),e(x,{class:"row items-center"},{default:u(()=>[e(de,{color:"red",modelValue:i.value,"onUpdate:modelValue":l[3]||(l[3]=t=>i.value=t)},null,8,["modelValue"]),ya]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),xa=k({__name:"WrapperWrap",props:["wrapper"],setup(h){const c=I(),i=m(1),s=h;async function l(t){var n,o;try{const d=new L,w=M().pg_wrapper.value,f=s.wrapper,$=ne(i.value,(n=z().getAccountByMintPublicKey(f==null?void 0:f.account.mintUnwrapped))==null?void 0:n.decimals);await F().connection.getAccountInfo(ae(Y().publicKey.value.toString(),s.wrapper.account.mintWrapped.toString()))||d.add(Me(A(),ae(A().toString(),s.wrapper.account.mintWrapped.toString()),A(),s.wrapper.account.mintWrapped,K,ke)),d.add(await w.methods.wrap($).accountsPartial({signer:Y().publicKey.value,wrapper:f.publicKey,mintUnwrapped:f.account.mintUnwrapped,signerUnwrapped:new C(((o=z().accounts.find(S=>S.mint.toString()==f.account.mintUnwrapped.toString()))==null?void 0:o.pubkey)??""),signerWrapped:getATA(Y().publicKey.value.toString(),s.wrapper.account.mintWrapped.toString()),tokenProgram:K,whitelist:null,whitelistEntry:null}).instruction()),await E(d,"[Wrapper] wrap tokens"),await r().updateStore()}catch(d){console.error(d),c.notify({message:d.message,type:"negative"})}}return(t,n)=>(b(),P("div",null,[e(W,{disable:!h.wrapper.account.allowWrap,filled:"",modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=o=>i.value=o)},null,8,["disable","modelValue"]),e(N,{disable:!h.wrapper.account.allowWrap,class:"full-width",color:"primary",label:"Wrap",onClick:n[1]||(n[1]=o=>l())},null,8,["disable"])]))}}),Sa=k({__name:"WrapperUnwrap",props:["wrapper"],setup(h){const c=I(),i=m(1),s=h;async function l(t){var n,o;try{const d=new L,w=M().pg_wrapper.value,f=s.wrapper,$=ne(i.value,(n=z().getAccountByMintPublicKey(f==null?void 0:f.account.mintWrapped))==null?void 0:n.decimals);d.add(await w.methods.unwrap($).accountsPartial({signer:A(),wrapper:f.publicKey,mintUnwrapped:f.account.mintUnwrapped,signerUnwrapped:new C(((o=z().accounts.find(v=>v.mint.toString()==f.account.mintUnwrapped.toString()))==null?void 0:o.pubkey)??""),signerWrapped:ae(Y().publicKey.value.toString(),s.wrapper.account.mintWrapped.toString()),tokenProgram:K,whitelist:null,whitelistEntry:null}).instruction()),await E(d,"[Wrapper] unwrap tokens"),await r().updateStore()}catch(d){console.error(d),c.notify({message:d.message,type:"negative"})}}return(t,n)=>(b(),P("div",null,[e(W,{disable:!h.wrapper.account.allowUnwrap,filled:"",modelValue:i.value,"onUpdate:modelValue":n[0]||(n[0]=o=>i.value=o)},null,8,["disable","modelValue"]),e(N,{disable:!h.wrapper.account.allowUnwrap,class:"full-width",color:"primary",label:"Unwrap",onClick:n[1]||(n[1]=o=>l())},null,8,["disable"])]))}});const Va={class:"q-pa-md"},$a={class:"q-pa-xs col-xs-12 col-sm-6 col-md-3"},Ua={class:"row items-center"},ka=a("div",{class:"col text-subtitle1 text-weight-thin"},"Group",-1),Wa={class:"text-subtitle2"},Aa={class:"row items-center"},Ca=a("div",{class:"col text-subtitle1 text-weight-thin"},"Pair",-1),qa={class:"text-subtitle2 row q-gutter-x-xs"},Pa=a("div",null,"/",-1),Ta={class:"row items-center"},Ia=a("div",{class:"col text-subtitle1 text-weight-thin"},"Wrappable",-1),Qa={class:"text-subtitle2"},Ka={class:"row items-center"},Ma=a("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),Na={class:"text-subtitle2"},La={class:"col text-center"},Ea={class:"col text-center"},Ra=a("div",{class:"text-center text-subtitle2"},"Status",-1),Ba=a("div",null,null,-1),Ga=k({__name:"WrapperTable",setup(h){const c=I();function i(){return c.screen.lt.sm?3:c.screen.lt.md?6:9}const s=m(""),l=m({page:1,rowsPerPage:i()});return oe(()=>c.screen.name,()=>{l.value.rowsPerPage=i()}),ge(()=>c.screen.gt.xs?c.screen.gt.sm?[3,6,9]:[3,6]:[3]),(t,n)=>(b(),P("div",Va,[e(Qe,{grid:"",rows:p(r)().wrapper,"row-key":"name",filter:s.value,"hide-header":"",pagination:l.value,"onUpdate:pagination":n[0]||(n[0]=o=>l.value=o),"rows-per-page-options":[0]},{item:u(o=>[a("div",$a,[e(T,{flat:"",bordered:""},{default:u(()=>[e(x,{class:"text-center"},{default:u(()=>{var d;return[e(Te,{height:"200px",src:((d=p(j)().tokenList.find(w=>{var f;return w.address==((f=o.row.account)==null?void 0:f.mintUnwrapped.toString())}))==null?void 0:d.logoURI)??p(Ke)},null,8,["src"])]}),_:2},1024),e(x,null,{default:u(()=>{var d,w,f,$;return[a("div",Ua,[ka,a("div",Wa,U(p(r)().groups.find(v=>v.publicKey.toString()==o.row.account.group.toString()).account.name),1)]),a("div",Aa,[Ca,a("div",qa,[a("div",null,U(p(j)().tokenList.find(v=>v.address==o.row.account.mintUnwrapped.toString()).symbol),1),Pa,a("div",null," W"+U(p(j)().tokenList.find(v=>v.address==o.row.account.mintUnwrapped.toString()).symbol),1)])]),a("div",Ta,[Ia,a("div",Qa,U((d=o.row)!=null&&d.account.useLimit?(w=o.row)==null?void 0:w.account.limitAmountUnwrapped:"\u221E"),1)]),a("div",Ka,[Ma,a("div",Na,U(p(Ie)(($=(f=o.row)==null?void 0:f.publicKey)==null?void 0:$.toString())),1)])]}),_:2},1024),e(Q),e(_e,{class:"row text-h4"},{default:u(()=>[a("div",La,U(o.row.account.ratio[0]),1),e(le,{size:"md",name:"swap_horiz"}),a("div",Ea,U(o.row.account.ratio[1]),1)]),_:2},1024),e(_e,{class:"row"},{default:u(()=>[e(T,{class:"col q-mx-sm",flat:"",bordered:""},{default:u(()=>[e(x,null,{default:u(()=>[Ra]),_:1}),e(Q),Ba,e(x,null,{default:u(()=>[e(be,{mintWrapped:o.row.account.mintWrapped.toString(),mintUnwrapped:o.row.account.mintUnwrapped.toString(),wrapper:o.row},null,8,["mintWrapped","mintUnwrapped","wrapper"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(x,{class:"row q-gutter-x-md"},{default:u(()=>[e(xa,{class:"col",wrapper:o.row},null,8,["wrapper"]),e(Sa,{class:"col",wrapper:o.row},null,8,["wrapper"])]),_:2},1024)]),_:2},1024)])]),_:1},8,["rows","filter","pagination"])]))}}),Oa=a("div",{class:"col text-h6"},"WrapperInterface",-1),ja={class:"row"},yl=k({__name:"WrapperPage",setup(h){const c=m("wrapping");return r(),fe(async()=>{M()||We(),await r().updateStore()}),(i,s)=>(b(),V(Ae,{class:"bg-black"},{default:u(()=>[e(T,null,{default:u(()=>[e(x,{class:"row items-center q-gutter-x-md"},{default:u(()=>[e(le,{name:"inventory_2",size:"md"}),Oa]),_:1}),e(Q),e(ue,{modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=l=>c.value=l),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:u(()=>[e(G,{name:"wrapping",label:"Wrap / Unwrap"}),e(G,{name:"manage",label:"Manage"})]),_:1},8,["modelValue"]),e(Q),e(ce,{modelValue:c.value,"onUpdate:modelValue":s[2]||(s[2]=l=>c.value=l),animated:""},{default:u(()=>[e(O,{name:"wrapping"},{default:u(()=>[a("div",ja,[e(ie,{class:"col"}),e(N,{square:"",color:"primary",label:"reload",onClick:s[1]||(s[1]=()=>{p(r)().updateStore()})})]),e(T,{flat:""},{default:u(()=>[e(x,null,{default:u(()=>[e(Ga)]),_:1})]),_:1})]),_:1}),e(O,{name:"manage",class:"row q-gutter-x-md"},{default:u(()=>{var l;return[e(rt,{class:"col-3"}),(l=p(r)().groupSelected)!=null&&l.account?(b(),V(ha,{key:0,class:"col"})):q("",!0)]}),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{yl as default};
