import{Q as A,a as g,b as q}from"./QInput.b9226990.js";import{Q as b,a as L}from"./QTabPanels.7f4d1e45.js";import{Q as U}from"./QPage.99780c74.js";import{au as f,J as d,b1 as m,ak as v,as as t,bx as a,ar as y,ck as $,P as _,cJ as V,cK as E,cL as N,cM as x,cN as h,aX as Q,a6 as W,b7 as B,bz as P,ai as k,a1 as S,ah as R,aj as J}from"./index.6b7e27b5.js";import{h as C}from"./QSlideTransition.0a0f55a8.js";import{l as K,n as I,o as T,m as M,C as D}from"./ClosePopup.819c404e.js";import{Q as F}from"./QBtnDropdown.7ae2a78b.js";import{Q as j}from"./QTree.784653c4.js";import"./touch.3df10340.js";const z={class:"row q-gutter-x-md"},X=f({__name:"CreateWhitelist",setup(w){const o=d("My new whitelist");async function u(){const{pg_whitelist:r}=h();let[l,c]=_.findProgramAddressSync([V().publicKey.value.toBytes(),E(o.value)],r.value.programId);try{const n=await r.value.methods.initialize(o.value).accounts({whitelist:l,systemProgram:N.programId}).rpc();console.log(n),await C(n)}catch(n){x.create({color:"red",message:`${n}`,timeout:5e3})}}return(r,l)=>(m(),v("div",z,[t(A,{class:"col",modelValue:o.value,"onUpdate:modelValue":l[0]||(l[0]=c=>o.value=c)},null,8,["modelValue"]),t($,{color:"primary",onClick:l[1]||(l[1]=c=>u())},{default:a(()=>[y("Create")]),_:1})]))}}),H={class:"row q-gutter-x-md"},Y=f({__name:"AddAddressToWhitelist",setup(w){const{pg_whitelist:o}=h(),u=d(""),r=d(),l=d();Q(async()=>{r.value=await o.value.account.whitelist.all()});async function c(){const n=new _(l.value.publicKey),[s,i]=_.findProgramAddressSync([new _(u.value).toBytes(),n.toBytes()],o.value.programId);try{const e=new _(u.value),p=await o.value.methods.addToWhitelist(e).accounts({entry:s,whitelist:n,authority:V().publicKey.value,systemProgram:N.programId}).rpc();console.log(p),await C(p)}catch(e){x.create({color:"red",message:`${e}`,timeout:5e3})}}return(n,s)=>{var i;return m(),v("div",H,[t(F,{color:"primary",label:((i=l.value)==null?void 0:i.account.name)??"please select a whitelist"},{default:a(()=>[t(K,null,{default:a(()=>[(m(!0),v(W,null,B(r.value,e=>P((m(),k(M,{clickable:"",key:e,onClick:p=>l.value=e},{default:a(()=>[t(I,null,{default:a(()=>[t(T,null,{default:a(()=>[y(S(e==null?void 0:e.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[D]])),128))]),_:1})]),_:1},8,["label"]),t(A,{class:"col",outlined:"",modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=e=>u.value=e),label:"Address to be added"},null,8,["modelValue"]),t($,{color:"primary",onClick:s[1]||(s[1]=e=>c())},{default:a(()=>[y("Add")]),_:1})])}}}),G={class:"row q-gutter-x-md"},O=f({__name:"ViewWhitelist",setup(w){const{pg_whitelist:o}=h(),u=d(),r=d();Q(async()=>{u.value=await o.value.account.whitelist.all(),r.value=await o.value.account.whitelistEntry.all()});const l=R(()=>{var c;return(c=u==null?void 0:u.value)==null?void 0:c.map(n=>{var s,i;return{label:`${n.account.name} | ${n.publicKey.toString()}`,children:(i=(s=r.value)==null?void 0:s.filter(e=>e.account.parent.toString()===n.publicKey.toString()))==null?void 0:i.flatMap(e=>({label:`Member: ${e.account.whitelisted.toString()}  |  Account: ${e.publicKey.toString()} `}))}})});return(c,n)=>(m(),v("div",G,[l.value?(m(),k(j,{key:0,nodes:l.value,"node-key":"label","selected-color":"primary","default-expand-all":""},null,8,["nodes"])):J("",!0)]))}}),Z={class:"row q-gutter-x-md"},ee=f({__name:"RemoveAddressFromWhitelist",setup(w){const{pg_whitelist:o}=h(),u=d(""),r=d(),l=d();Q(async()=>{r.value=await o.value.account.whitelist.all()});async function c(){const n=new _(l.value.publicKey),[s,i]=_.findProgramAddressSync([new _(u.value).toBytes(),n.toBytes()],o.value.programId);try{console.log(o.value.methods);const e=new _(u.value),p=await o.value.methods.removeFromWhitelist(e).accounts({entry:s,whitelist:n,authority:V().publicKey.value}).rpc();console.log(p),await C(p)}catch(e){x.create({color:"red",message:`${e}`,timeout:5e3})}}return(n,s)=>{var i;return m(),v("div",Z,[t(F,{color:"primary",label:((i=l.value)==null?void 0:i.account.name)??"please select a whitelist"},{default:a(()=>[t(K,null,{default:a(()=>[(m(!0),v(W,null,B(r.value,e=>P((m(),k(M,{clickable:"",key:e,onClick:p=>l.value=e},{default:a(()=>[t(I,null,{default:a(()=>[t(T,null,{default:a(()=>[y(S(e==null?void 0:e.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[D]])),128))]),_:1})]),_:1},8,["label"]),t(A,{class:"col",outlined:"",modelValue:u.value,"onUpdate:modelValue":s[0]||(s[0]=e=>u.value=e),label:"Address to be removed"},null,8,["modelValue"]),t($,{color:"primary",onClick:s[1]||(s[1]=e=>c())},{default:a(()=>[y("Remove")]),_:1})])}}}),te={class:"row q-gutter-x-md"},ae=f({__name:"DeleteWhitelist",setup(w){const{pg_whitelist:o}=h(),u=d("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),r=d(),l=d();Q(async()=>{r.value=await o.value.account.whitelist.all()});async function c(){const n=new _(l.value.publicKey);_.findProgramAddressSync([new _(u.value).toBytes(),n.toBytes()],o.value.programId);try{const s=await o.value.methods.deleteWhitelist(l.value.account.name).accounts({whitelist:n,authority:V().publicKey.value}).rpc();console.log(s),await C(s)}catch(s){x.create({color:"red",message:`${s}`,timeout:5e3})}}return(n,s)=>{var i;return m(),v("div",te,[t(F,{color:"primary",label:((i=l.value)==null?void 0:i.account.name)??"please select a whitelist"},{default:a(()=>[t(K,null,{default:a(()=>[(m(!0),v(W,null,B(r.value,e=>P((m(),k(M,{clickable:"",key:e,onClick:p=>l.value=e},{default:a(()=>[t(I,null,{default:a(()=>[t(T,null,{default:a(()=>[y(S(e==null?void 0:e.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[D]])),128))]),_:1})]),_:1},8,["label"]),t($,{color:"primary",onClick:s[0]||(s[0]=e=>c())},{default:a(()=>[y("Delete")]),_:1})])}}}),me=f({__name:"WhitelistPage",setup(w){const o=d("view");return(u,r)=>(m(),k(U,{class:"col text-center"},{default:a(()=>[t(q,{"no-caps":"","outside-arrows":"","mobile-arrows":"",modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=l=>o.value=l),class:"shadow-2",align:"justify"},{default:a(()=>[t(g,{name:"create",label:"Create Whitelist"}),t(g,{name:"add",label:"Add Address to Whitelist"}),t(g,{name:"remove",label:"Remove address from Whitelist"}),t(g,{name:"delete",label:"Delete Whitelist"}),t(g,{name:"view",label:"View "})]),_:1},8,["modelValue"]),t(L,{dark:"",modelValue:o.value,"onUpdate:modelValue":r[1]||(r[1]=l=>o.value=l),animated:""},{default:a(()=>[t(b,{name:"create"},{default:a(()=>[t(X)]),_:1}),t(b,{name:"add"},{default:a(()=>[t(Y)]),_:1}),t(b,{name:"remove"},{default:a(()=>[t(ee)]),_:1}),t(b,{name:"delete"},{default:a(()=>[t(ae)]),_:1}),t(b,{name:"view"},{default:a(()=>[t(O)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{me as default};
