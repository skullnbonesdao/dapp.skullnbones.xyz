import{a as Pc,Q as cg}from"./QTabs.e6899f43.js";import{Q as ug}from"./QPage.9cc5931e.js";import{Q as lg}from"./QCardSection.a02b1009.js";import{Q as dg}from"./QCard.9fb7f304.js";import{dG as D,dN as ge,dO as nu,cQ as Lu,d1 as hf,P as we,dd as Nu,el as fg,dP as pf,em as yf,cZ as ae,dm as Qn,eb as gf,ec as jo,ed as hg,en as pg,bW as $s,bX as T,d7 as yg,dH as ke,c$ as z,dA as F,dB as We,d0 as ie,dI as Fe,dJ as tn,dD as et,eo as Ws,d8 as ve,ep as qo,eq as kn,dK as mf,dL as bf,dM as vf,d9 as wf,da as Du,er as Fl,es as gg,et as mg,eu as bg,ej as vg,d2 as ru,co as Ct,c_ as wg,dl as _g,ev as Ag,ew as Sg,cV as Ts,cW as kg,au as _f,aX as Ig,bs as Eg,b1 as Co,ai as Af,bx as Go,as as Tr,al as Oe,a1 as oi,V as or,J as Og,ak as Ul,cm as Pg}from"./index.2ded45df.js";import{v as Tg}from"./vaultTransactionCreate.45dcd679.js";import{a as fe,l as _t,b as Sf}from"./lodash.fc11a868.js";import{s as Hr}from"./sha256.ff677635.js";import{_ as us,a as Bg}from"./Amount.e0f8cb64.js";import{h as Rg}from"./handle_confirmation.3de002b1.js";import{t as xg}from"./token.32d49c32.js";import{g as ls}from"./extensionType.90c71764.js";import"./uid.42677368.js";import"./rtl.6d464cd5.js";import"./errors.825970a3.js";import"./web3.5bfe9fa1.js";import"./bigint.56df958f.js";var Mt={},ma={},kf={},If={};Object.defineProperty(If,"__esModule",{value:!0});var ba={},Gt={},Dr={},Mg=Object.freeze({__proto__:null,encode:function(r){return r.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),"0x")},decode:function(r){r.indexOf("0x")===0&&(r=r.substr(2)),r.length%2==1&&(r="0"+r);let e=r.match(/.{2}/g);return e===null?D.Buffer.from([]):D.Buffer.from(e.map(t=>parseInt(t,16)))}});function Ef(r){return new TextDecoder("utf-8").decode(r)}function Of(r){return new TextEncoder().encode(r)}var Cg=Object.freeze({__proto__:null,decode:Ef,encode:Of});function Pf(r){return ge.encode(r)}var Kg=Object.freeze({__proto__:null,encode:Pf,decode:function(r){return ge.decode(r)}});function Tf(r){return D.Buffer.from(pf(r))}var Lg=Object.freeze({__proto__:null,encode:function(r){return nu(r)},decode:Tf}),Ng=Object.freeze({__proto__:null,hex:Mg,utf8:Cg,bs58:Kg,base64:Lg});function Vu(r){const e=new Map;return r.errors&&r.errors.forEach(t=>{var n;let i=(n=t.msg)!==null&&n!==void 0?n:t.name;e.set(t.code,i)}),e}function Bf(r,...e){if(r.args.length!=e.length)throw new Error("Invalid argument length");const t={};let n=0;return r.args.forEach(i=>{t[i.name]=e[n],n+=1}),t}function va(r,e={}){r.forEach(t=>{if("accounts"in t)va(t.accounts,e[t.name]);else if(e[t.name]===void 0)throw new Error(`Invalid arguments: ${t.name} not provided.`)})}function mn(r){return r instanceof we?r:new we(r)}class Dg extends TypeError{constructor(e,t){let n;const{message:i,...s}=e,{path:o}=e;super(o.length===0?i:"At path: "+o.join(".")+" -- "+i),Object.assign(this,s),this.name=this.constructor.name,this.failures=()=>{var a;return(a=n)!=null?a:n=[e,...t()]}}}function Si(r){return typeof r=="object"&&r!=null}function gr(r){return typeof r=="string"?JSON.stringify(r):""+r}function Vg(r,e,t,n){if(r===!0)return;r===!1?r={}:typeof r=="string"&&(r={message:r});const{path:i,branch:s}=e,{type:o}=t,{refinement:a,message:c="Expected a value of type `"+o+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+gr(n)+"`"}=r;return{value:n,type:o,refinement:a,key:i[i.length-1],path:i,branch:s,...r,message:c}}function*$l(r,e,t,n){var i;Si(i=r)&&typeof i[Symbol.iterator]=="function"||(r=[r]);for(const s of r){const o=Vg(s,e,t,n);o&&(yield o)}}function*zu(r,e,t={}){const{path:n=[],branch:i=[r],coerce:s=!1,mask:o=!1}=t,a={path:n,branch:i};if(s&&(r=e.coercer(r,a),o&&e.type!=="type"&&Si(e.schema)&&Si(r)&&!Array.isArray(r)))for(const l in r)e.schema[l]===void 0&&delete r[l];let c=!0;for(const l of e.validator(r,a))c=!1,yield[l,void 0];for(let[l,u,h]of e.entries(r,a)){const b=zu(u,h,{path:l===void 0?n:[...n,l],branch:l===void 0?i:[...i,u],coerce:s,mask:o});for(const w of b)w[0]?(c=!1,yield[w[0],void 0]):s&&(u=w[1],l===void 0?r=u:r instanceof Map?r.set(l,u):r instanceof Set?r.add(u):Si(r)&&(r[l]=u))}if(c)for(const l of e.refiner(r,a))c=!1,yield[l,void 0];c&&(yield[void 0,r])}class wr{constructor(e){const{type:t,schema:n,validator:i,refiner:s,coercer:o=c=>c,entries:a=function*(){}}=e;this.type=t,this.schema=n,this.entries=a,this.coercer=o,this.validator=i?(c,l)=>$l(i(c,l),l,this,c):()=>[],this.refiner=s?(c,l)=>$l(s(c,l),l,this,c):()=>[]}assert(e){return function(t,n){const i=vs(t,n);if(i[0])throw i[0]}(e,this)}create(e){return Fu(e,this)}is(e){return Rf(e,this)}mask(e){return function(t,n){const i=vs(t,n,{coerce:!0,mask:!0});if(i[0])throw i[0];return i[1]}(e,this)}validate(e,t={}){return vs(e,this,t)}}function Fu(r,e){const t=vs(r,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function Rf(r,e){return!vs(r,e)[0]}function vs(r,e,t={}){const n=zu(r,e,t),i=function(s){const{done:o,value:a}=s.next();return o?void 0:a}(n);return i[0]?[new Dg(i[0],function*(){for(const s of n)s[0]&&(yield s[0])}),void 0]:[void 0,i[1]]}function js(r,e){return new wr({type:r,schema:null,validator:e})}function Tc(r){return new wr({type:"array",schema:r,*entries(e){if(r&&Array.isArray(e))for(const[t,n]of e.entries())yield[t,n,r]},coercer:e=>Array.isArray(e)?e.slice():e,validator:e=>Array.isArray(e)||"Expected an array value, but received: "+gr(e)})}function Wl(r){const e=gr(r),t=typeof r;return new wr({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?r:null,validator:n=>n===r||"Expected the literal `"+e+"`, but received: "+gr(n)})}function po(r){return new wr({...r,validator:(e,t)=>e===null||r.validator(e,t),refiner:(e,t)=>e===null||r.refiner(e,t)})}function yo(){return js("number",r=>typeof r=="number"&&!isNaN(r)||"Expected a number, but received: "+gr(r))}function Ko(r){return new wr({...r,validator:(e,t)=>e===void 0||r.validator(e,t),refiner:(e,t)=>e===void 0||r.refiner(e,t)})}function Rr(){return js("string",r=>typeof r=="string"||"Expected a string, but received: "+gr(r))}function ar(r){const e=Object.keys(r);return new wr({type:"type",schema:r,*entries(t){if(Si(t))for(const n of e)yield[n,t[n],r[n]]},validator:t=>Si(t)||"Expected an object, but received: "+gr(t)})}function xf(r){const e=r.map(t=>t.type).join(" | ");return new wr({type:"union",schema:null,validator(t,n){const i=[];for(const s of r){const[...o]=zu(t,s,n),[a]=o;if(!a[0])return[];for(const[c]of o)c&&i.push(c)}return["Expected the value to satisfy a union of `"+e+"`, but received: "+gr(t),...i]}})}function Mf(){return js("unknown",()=>!0)}async function Cf(r,e,t){if(e.length<=99)return await jl(r,e,t);{const n=function(i,s){return Array.apply(0,new Array(Math.ceil(i.length/s))).map((o,a)=>i.slice(a*s,(a+1)*s))}(e,99);return(await Promise.all(n.map(i=>jl(r,i,t)))).flat()}}async function jl(r,e,t){const n=t??r.commitment;return(await r.getMultipleAccountsInfo(e,n)).map((i,s)=>i===null?null:{publicKey:e[s],account:i})}async function Kf(r,e,t,n,i){t&&t.length>0&&e.sign(...t);const s=e._compile(),o=s.serialize(),a=e._serialize(o).toString("base64"),c={encoding:"base64",commitment:n??r.commitment};if(i){const h=(Array.isArray(i)?i:s.nonProgramIds()).map(b=>b.toBase58());c.accounts={encoding:"base64",addresses:h}}t&&(c.sigVerify=!0);const l=[a,c],u=Fu(await r._rpcRequest("simulateTransaction",l),Ug);if("error"in u){let h;if("data"in u.error&&(h=u.error.data.logs,h&&Array.isArray(h))){const b=`
    `,w=b+h.join(b);console.error(u.error.message,w)}throw new yf("failed to simulate transaction: "+u.error.message,h)}return u.result}function zg(r){return function(e,t,n){return new wr({...e,coercer:(i,s)=>Rf(i,t)?e.coercer(n(i,s),s):e.coercer(i,s)})}(Lf(r),Fg,e=>"error"in e?e:{...e,result:Fu(e.result,r)})}const Fg=Lf(Mf());function Lf(r){return xf([ar({jsonrpc:Wl("2.0"),id:Rr(),result:r}),ar({jsonrpc:Wl("2.0"),id:Rr(),error:ar({code:Mf(),message:Rr(),data:Ko(js("any",()=>!0))})})])}const Ug=(ql=ar({err:po(xf([ar({}),Rr()])),logs:po(Tc(Rr())),accounts:Ko(po(Tc(po(ar({executable:js("boolean",r=>typeof r=="boolean"),owner:Rr(),lamports:yo(),data:Tc(Rr()),rentEpoch:Ko(yo())}))))),unitsConsumed:Ko(yo())}),zg(ar({context:ar({slot:yo()}),value:ql})));var ql,$g=Object.freeze({__proto__:null,invoke:async function(r,e,t,n){r=mn(r),n||(n=Bi());const i=new Lu;if(i.add(new hf({programId:r,keys:e??[],data:t})),n.sendAndConfirm===void 0)throw new Error("This function requires 'Provider.sendAndConfirm' to be implemented.");return await n.sendAndConfirm(i,[])},getMultipleAccounts:Cf,simulateTransaction:Kf});class Nf{constructor(e,t,n){this.connection=e,this.wallet=t,this.opts=n}static defaultOptions(){return{preflightCommitment:"processed",commitment:"processed"}}static local(e,t){throw new Error("Provider local is not available on browser.")}static env(){throw new Error("Provider env is not available on browser.")}async sendAndConfirm(e,t,n){var i;n===void 0&&(n=this.opts),e.feePayer=this.wallet.publicKey,e.recentBlockhash=(await this.connection.getRecentBlockhash(n.preflightCommitment)).blockhash,e=await this.wallet.signTransaction(e),(t??[]).forEach(o=>{e.partialSign(o)});const s=e.serialize();try{return await Gl(this.connection,s,n)}catch(o){if(o instanceof Df){const a=await this.connection.getTransaction(Pf(e.signature),{commitment:"confirmed"});if(a){const c=(i=a.meta)===null||i===void 0?void 0:i.logMessages;throw c?new yf(o.message,c):o}throw o}throw o}}async sendAll(e,t){t===void 0&&(t=this.opts);const n=await this.connection.getRecentBlockhash(t.preflightCommitment);let i=e.map(a=>{var c;let l=a.tx,u=(c=a.signers)!==null&&c!==void 0?c:[];return l.feePayer=this.wallet.publicKey,l.recentBlockhash=n.blockhash,u.forEach(h=>{l.partialSign(h)}),l});const s=await this.wallet.signAllTransactions(i),o=[];for(let a=0;a<i.length;a+=1){const c=s[a].serialize();o.push(await Gl(this.connection,c,t))}return o}async simulate(e,t,n,i){e.feePayer=this.wallet.publicKey,e.recentBlockhash=(await this.connection.getLatestBlockhash(n??this.connection.commitment)).blockhash,e=await this.wallet.signTransaction(e);const s=await Kf(this.connection,e,t,n,i);if(s.value.err)throw new Wg(s.value);return s.value}}class Wg extends Error{constructor(e,t){super(t),this.simulationResponse=e}}async function Gl(r,e,t){const n=t&&{skipPreflight:t.skipPreflight,preflightCommitment:t.preflightCommitment||t.commitment},i=await r.sendRawTransaction(e,n),s=(await r.confirmTransaction(i,t&&t.commitment)).value;if(s.err)throw new Df(`Raw transaction ${i} failed (${JSON.stringify(s)})`);return i}class Df extends Error{constructor(e){super(e)}}function jg(r){iu=r}function Bi(){return iu===null?Nf.local():iu}let iu=null;const qg=new Set(["anchor-deprecated-state","debug-logs"]),Vf=new Map;function wa(r){return Vf.get(r)!==void 0}var Gg=Object.freeze({__proto__:null,set:function(r){if(!qg.has(r))throw new Error("Invalid feature");Vf.set(r,!0)},isSet:wa});class Bs extends Error{constructor(e){super(e),this.name="IdlError"}}class Hi{constructor(e){this.stack=e}static parse(e){var t;const n=/^Program (\w*) invoke/,i=/^Program \w* success/,s=[];for(let o=0;o<e.length;o++){if(i.exec(e[o])){s.pop();continue}const a=(t=n.exec(e[o]))===null||t===void 0?void 0:t[1];a&&s.push(new we(a))}return new Hi(s)}}class ki extends Error{constructor(e,t,n,i,s,o){super(n.join(`
`).replace("Program log: ","")),this.errorLogs=n,this.logs=i,this.error={errorCode:e,errorMessage:t,comparedValues:o,origin:s},this._programErrorStack=Hi.parse(i)}static parse(e){if(!e)return null;const t=e.findIndex(l=>l.startsWith("Program log: AnchorError"));if(t===-1)return null;const n=e[t],i=[n];let s;if(t+1<e.length){if(e[t+1]==="Program log: Left:"){const l=/^Program log: (.*)$/,u=l.exec(e[t+2])[1],h=l.exec(e[t+4])[1];s=[new we(u),new we(h)],i.push(...e.slice(t+1,t+5))}else if(e[t+1].startsWith("Program log: Left:")){const l=/^Program log: (Left|Right): (.*)$/,u=l.exec(e[t+1])[2],h=l.exec(e[t+2])[2];i.push(...e.slice(t+1,t+3)),s=[u,h]}}const o=/^Program log: AnchorError occurred\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n),a=/^Program log: AnchorError thrown in (.*):(\d*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n),c=/^Program log: AnchorError caused by account: (.*)\. Error Code: (.*)\. Error Number: (\d*)\. Error Message: (.*)\./.exec(n);if(o){const[l,u,h]=o.slice(1,4),b={code:l,number:parseInt(u)};return new ki(b,h,i,e,void 0,s)}if(a){const[l,u,h,b,w]=a.slice(1,6),k={code:h,number:parseInt(b)},g={file:l,line:parseInt(u)};return new ki(k,w,i,e,g,s)}if(c){const[l,u,h,b]=c.slice(1,5),w=l,k={code:u,number:parseInt(h)};return new ki(k,b,i,e,w,s)}return null}get program(){return this._programErrorStack.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){return this._programErrorStack.stack}toString(){return this.message}}class Rs extends Error{constructor(e,t,n){super(),this.code=e,this.msg=t,this.logs=n,n&&(this._programErrorStack=Hi.parse(n))}static parse(e,t){const n=e.toString();let i,s;if(n.includes("custom program error:")){let a=n.split("custom program error: ");if(a.length!==2)return null;i=a[1]}else{const a=n.match(/"Custom":([0-9]+)}/g);if(!a||a.length>1)return null;i=a[0].match(/([0-9]+)/g)[0]}try{s=parseInt(i)}catch{return null}let o=t.get(s);return o!==void 0?new Rs(s,o,e.logs):(o=zf.get(s),o!==void 0?new Rs(s,o,e.logs):null)}get program(){var e;return(e=this._programErrorStack)===null||e===void 0?void 0:e.stack[this._programErrorStack.stack.length-1]}get programErrorStack(){var e;return(e=this._programErrorStack)===null||e===void 0?void 0:e.stack}toString(){return this.msg}}function Uu(r,e){wa("debug-logs")&&console.log("Translating error:",r);const t=ki.parse(r.logs);if(t)return t;const n=Rs.parse(r,e);if(n)return n;if(r.logs){const i={get:function(s,o){return o==="programErrorStack"?s.programErrorStack.stack:o==="program"?s.programErrorStack.stack[r.programErrorStack.stack.length-1]:Reflect.get(...arguments)}};return r.programErrorStack=Hi.parse(r.logs),new Proxy(r,i)}return r}const se={InstructionMissing:100,InstructionFallbackNotFound:101,InstructionDidNotDeserialize:102,InstructionDidNotSerialize:103,IdlInstructionStub:1e3,IdlInstructionInvalidProgram:1001,ConstraintMut:2e3,ConstraintHasOne:2001,ConstraintSigner:2002,ConstraintRaw:2003,ConstraintOwner:2004,ConstraintRentExempt:2005,ConstraintSeeds:2006,ConstraintExecutable:2007,ConstraintState:2008,ConstraintAssociated:2009,ConstraintAssociatedInit:2010,ConstraintClose:2011,ConstraintAddress:2012,ConstraintZero:2013,ConstraintTokenMint:2014,ConstraintTokenOwner:2015,ConstraintMintMintAuthority:2016,ConstraintMintFreezeAuthority:2017,ConstraintMintDecimals:2018,ConstraintSpace:2019,RequireViolated:2500,RequireEqViolated:2501,RequireKeysEqViolated:2502,RequireNeqViolated:2503,RequireKeysNeqViolated:2504,RequireGtViolated:2505,RequireGteViolated:2506,AccountDiscriminatorAlreadySet:3e3,AccountDiscriminatorNotFound:3001,AccountDiscriminatorMismatch:3002,AccountDidNotDeserialize:3003,AccountDidNotSerialize:3004,AccountNotEnoughKeys:3005,AccountNotMutable:3006,AccountOwnedByWrongProgram:3007,InvalidProgramId:3008,InvalidProgramExecutable:3009,AccountNotSigner:3010,AccountNotSystemOwned:3011,AccountNotInitialized:3012,AccountNotProgramData:3013,AccountNotAssociatedTokenAccount:3014,AccountSysvarMismatch:3015,StateInvalidAddress:4e3,DeclaredProgramIdMismatch:4100,Deprecated:5e3},zf=new Map([[se.InstructionMissing,"8 byte instruction identifier not provided"],[se.InstructionFallbackNotFound,"Fallback functions are not supported"],[se.InstructionDidNotDeserialize,"The program could not deserialize the given instruction"],[se.InstructionDidNotSerialize,"The program could not serialize the given instruction"],[se.IdlInstructionStub,"The program was compiled without idl instructions"],[se.IdlInstructionInvalidProgram,"The transaction was given an invalid program for the IDL instruction"],[se.ConstraintMut,"A mut constraint was violated"],[se.ConstraintHasOne,"A has_one constraint was violated"],[se.ConstraintSigner,"A signer constraint was violated"],[se.ConstraintRaw,"A raw constraint was violated"],[se.ConstraintOwner,"An owner constraint was violated"],[se.ConstraintRentExempt,"A rent exemption constraint was violated"],[se.ConstraintSeeds,"A seeds constraint was violated"],[se.ConstraintExecutable,"An executable constraint was violated"],[se.ConstraintState,"A state constraint was violated"],[se.ConstraintAssociated,"An associated constraint was violated"],[se.ConstraintAssociatedInit,"An associated init constraint was violated"],[se.ConstraintClose,"A close constraint was violated"],[se.ConstraintAddress,"An address constraint was violated"],[se.ConstraintZero,"Expected zero account discriminant"],[se.ConstraintTokenMint,"A token mint constraint was violated"],[se.ConstraintTokenOwner,"A token owner constraint was violated"],[se.ConstraintMintMintAuthority,"A mint mint authority constraint was violated"],[se.ConstraintMintFreezeAuthority,"A mint freeze authority constraint was violated"],[se.ConstraintMintDecimals,"A mint decimals constraint was violated"],[se.ConstraintSpace,"A space constraint was violated"],[se.RequireViolated,"A require expression was violated"],[se.RequireEqViolated,"A require_eq expression was violated"],[se.RequireKeysEqViolated,"A require_keys_eq expression was violated"],[se.RequireNeqViolated,"A require_neq expression was violated"],[se.RequireKeysNeqViolated,"A require_keys_neq expression was violated"],[se.RequireGtViolated,"A require_gt expression was violated"],[se.RequireGteViolated,"A require_gte expression was violated"],[se.AccountDiscriminatorAlreadySet,"The account discriminator was already set on this account"],[se.AccountDiscriminatorNotFound,"No 8 byte discriminator was found on the account"],[se.AccountDiscriminatorMismatch,"8 byte discriminator did not match what was expected"],[se.AccountDidNotDeserialize,"Failed to deserialize the account"],[se.AccountDidNotSerialize,"Failed to serialize the account"],[se.AccountNotEnoughKeys,"Not enough account keys given to the instruction"],[se.AccountNotMutable,"The given account is not mutable"],[se.AccountOwnedByWrongProgram,"The given account is owned by a different program than expected"],[se.InvalidProgramId,"Program ID was not as expected"],[se.InvalidProgramExecutable,"Program account is not executable"],[se.AccountNotSigner,"The given account did not sign"],[se.AccountNotSystemOwned,"The given account is not owned by the system program"],[se.AccountNotInitialized,"The program expected this account to be already initialized"],[se.AccountNotProgramData,"The given account is not a program data account"],[se.AccountNotAssociatedTokenAccount,"The given account is not the associated token account"],[se.AccountSysvarMismatch,"The given public key does not match the required sysvar"],[se.StateInvalidAddress,"The given state account does not have the correct address"],[se.DeclaredProgramIdMismatch,"The declared program id does not match the actual program id"],[se.Deprecated,"The API being used is deprecated and should no longer be used"]]);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Ho=function(){return Ho=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i]);return r},Ho.apply(this,arguments)};function Hg(r){return r.toLowerCase()}var Yg=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],Qg=/[^A-Z0-9]+/gi;function Hl(r,e,t){return e instanceof RegExp?r.replace(e,t):e.reduce(function(n,i){return n.replace(i,t)},r)}function Jg(r,e){return e===void 0&&(e={}),function(t,n){n===void 0&&(n={});for(var i=n.splitRegexp,s=i===void 0?Yg:i,o=n.stripRegexp,a=o===void 0?Qg:o,c=n.transform,l=c===void 0?Hg:c,u=n.delimiter,h=u===void 0?" ":u,b=Hl(Hl(t,s,"$1\0$2"),a,"\0"),w=0,k=b.length;b.charAt(w)==="\0";)w++;for(;b.charAt(k-1)==="\0";)k--;return b.slice(w,k).split("\0").map(l).join(h)}(r,Ho({delimiter:"."},e))}class Xt{static fieldLayout(e,t){const n=e.name!==void 0?_t(e.name):void 0;switch(e.type){case"bool":return fe.bool(n);case"u8":return fe.u8(n);case"i8":return fe.i8(n);case"u16":return fe.u16(n);case"i16":return fe.i16(n);case"u32":return fe.u32(n);case"i32":return fe.i32(n);case"f32":return fe.f32(n);case"u64":return fe.u64(n);case"i64":return fe.i64(n);case"f64":return fe.f64(n);case"u128":return fe.u128(n);case"i128":return fe.i128(n);case"bytes":return fe.vecU8(n);case"string":return fe.str(n);case"publicKey":return fe.publicKey(n);default:if("vec"in e.type)return fe.vec(Xt.fieldLayout({name:void 0,type:e.type.vec},t),n);if("option"in e.type)return fe.option(Xt.fieldLayout({name:void 0,type:e.type.option},t),n);if("defined"in e.type){const i=e.type.defined;if(t===void 0)throw new Bs("User defined types not provided");const s=t.filter(o=>o.name===i);if(s.length!==1)throw new Bs(`Type not found: ${JSON.stringify(e)}`);return Xt.typeDefLayout(s[0],t,n)}if("array"in e.type){let i=e.type.array[0],s=e.type.array[1],o=Xt.fieldLayout({name:void 0,type:i},t);return fe.array(o,s,n)}throw new Error(`Not yet implemented: ${e}`)}}static typeDefLayout(e,t=[],n){if(e.type.kind==="struct"){const i=e.type.fields.map(s=>Xt.fieldLayout(s,t));return fe.struct(i,n)}if(e.type.kind==="enum"){let i=e.type.variants.map(s=>{const o=_t(s.name);if(s.fields===void 0)return fe.struct([],o);const a=s.fields.map(c=>{if(!c.hasOwnProperty("name"))throw new Error("Tuple enum variants not yet implemented.");return Xt.fieldLayout(c,t)});return fe.struct(a,o)});return n!==void 0?fe.rustEnum(i).replicate(n):fe.rustEnum(i,n)}throw new Error(`Unknown type kint: ${e}`)}}class _a{constructor(e){this.idl=e,this.ixLayout=_a.parseIxLayout(e);const t=new Map;e.instructions.forEach(n=>{const i=Bc("global",n.name);t.set(ge.encode(i),{layout:this.ixLayout.get(n.name),name:n.name})}),e.state&&e.state.methods.map(n=>{const i=Bc("state",n.name);t.set(ge.encode(i),{layout:this.ixLayout.get(n.name),name:n.name})}),this.sighashLayouts=t}encode(e,t){return this._encode("global",e,t)}encodeState(e,t){return this._encode("state",e,t)}_encode(e,t,n){const i=D.Buffer.alloc(1e3),s=_t(t),o=this.ixLayout.get(s);if(!o)throw new Error(`Unknown method: ${s}`);const a=o.encode(n,i),c=i.slice(0,a);return D.Buffer.concat([Bc(e,t),c])}static parseIxLayout(e){const t=(e.state?e.state.methods:[]).map(n=>{let i=n.args.map(o=>{var a,c;return Xt.fieldLayout(o,Array.from([...(a=e.accounts)!==null&&a!==void 0?a:[],...(c=e.types)!==null&&c!==void 0?c:[]]))});const s=_t(n.name);return[s,fe.struct(i,s)]}).concat(e.instructions.map(n=>{let i=n.args.map(o=>{var a,c;return Xt.fieldLayout(o,Array.from([...(a=e.accounts)!==null&&a!==void 0?a:[],...(c=e.types)!==null&&c!==void 0?c:[]]))});const s=_t(n.name);return[s,fe.struct(i,s)]}));return new Map(t)}decode(e,t="hex"){typeof e=="string"&&(e=t==="hex"?D.Buffer.from(e,"hex"):ge.decode(e));let n=ge.encode(e.slice(0,8)),i=e.slice(8);const s=this.sighashLayouts.get(n);return s?{data:s.layout.decode(i),name:s.name}:null}format(e,t){return jn.format(e,t,this.idl)}}class jn{static format(e,t,n){const i=n.instructions.filter(a=>e.name===a.name)[0];if(i===void 0)return console.error("Invalid instruction given"),null;const s=i.args.map(a=>({name:a.name,type:jn.formatIdlType(a.type),data:jn.formatIdlData(a,e.data[a.name],n.types)})),o=jn.flattenIdlAccounts(i.accounts);return{args:s,accounts:t.map((a,c)=>c<o.length?{name:o[c].name,...a}:{name:void 0,...a})}}static formatIdlType(e){if(typeof e=="string")return e;if("vec"in e)return`Vec<${this.formatIdlType(e.vec)}>`;if("option"in e)return`Option<${this.formatIdlType(e.option)}>`;if("defined"in e)return e.defined;if("array"in e)return`Array<${e.array[0]}; ${e.array[1]}>`;throw new Error(`Unknown IDL type: ${e}`)}static formatIdlData(e,t,n){if(typeof e.type=="string")return t.toString();if(e.type.hasOwnProperty("vec"))return"["+t.map(i=>this.formatIdlData({name:"",type:e.type.vec},i)).join(", ")+"]";if(e.type.hasOwnProperty("option"))return t===null?"null":this.formatIdlData({name:"",type:e.type.option},t,n);if(e.type.hasOwnProperty("defined")){if(n===void 0)throw new Error("User defined types not provided");const i=n.filter(s=>s.name===e.type.defined);if(i.length!==1)throw new Error(`Type not found: ${e.type.defined}`);return jn.formatIdlDataDefined(i[0],t,n)}return"unknown"}static formatIdlDataDefined(e,t,n){if(e.type.kind==="struct"){const i=e.type;return"{ "+Object.keys(t).map(s=>{const o=i.fields.filter(a=>a.name===s)[0];if(o===void 0)throw new Error("Unable to find type");return s+": "+jn.formatIdlData(o,t[s],n)}).join(", ")+" }"}if(e.type.variants.length===0)return"{}";if(e.type.variants[0].name){const i=e.type.variants,s=Object.keys(t)[0],o=t[s],a=Object.keys(o).map(l=>{var u;const h=o[l],b=(u=i[s])===null||u===void 0?void 0:u.filter(w=>w.name===l)[0];if(b===void 0)throw new Error("Unable to find variant");return l+": "+jn.formatIdlData(b,h,n)}).join(", "),c=_t(s,{pascalCase:!0});return a.length===0?c:`${c} { ${a} }`}return"Tuple formatting not yet implemented"}static flattenIdlAccounts(e,t){return e.map(n=>{const i=function(s){const o=s.replace(/([A-Z])/g," $1");return o.charAt(0).toUpperCase()+o.slice(1)}(n.name);if(n.hasOwnProperty("accounts")){const s=t?`${t} > ${i}`:i;return jn.flattenIdlAccounts(n.accounts,s)}return{...n,name:t?`${t} > ${i}`:i}}).flat()}}function Bc(r,e){var t;let n=`${r}:${t===void 0&&(t={}),Jg(e,Ho({delimiter:"_"},t))}`;return D.Buffer.from(Hr.exports.sha256.digest(n)).slice(0,8)}function $u(r,e){if(e.type.kind==="enum"){let t=e.type.variants.map(n=>n.fields===void 0?0:n.fields.map(i=>{if(typeof i!="object"||!("name"in i))throw new Error("Tuple enum variants not yet implemented.");return ws(r,i.type)}).reduce((i,s)=>i+s));return Math.max(...t)+1}return e.type.fields===void 0?0:e.type.fields.map(t=>ws(r,t.type)).reduce((t,n)=>t+n,0)}function ws(r,e){var t,n;switch(e){case"bool":case"u8":case"i8":case"bytes":case"string":return 1;case"i16":case"u16":return 2;case"u32":case"i32":case"f32":return 4;case"u64":case"i64":case"f64":return 8;case"u128":case"i128":return 16;case"publicKey":return 32;default:if("vec"in e)return 1;if("option"in e)return 1+ws(r,e.option);if("coption"in e)return 4+ws(r,e.coption);if("defined"in e){const i=(n=(t=r.types)===null||t===void 0?void 0:t.filter(s=>s.name===e.defined))!==null&&n!==void 0?n:[];if(i.length!==1)throw new Bs(`Type not found: ${JSON.stringify(e)}`);return $u(r,i[0])}if("array"in e){let i=e.array[0],s=e.array[1];return ws(r,i)*s}throw new Error(`Invalid type ${JSON.stringify(e)}`)}}const Xg=8;class Ii{constructor(e){if(e.accounts===void 0)return void(this.accountLayouts=new Map);const t=e.accounts.map(n=>[n.name,Xt.typeDefLayout(n,e.types)]);this.accountLayouts=new Map(t),this.idl=e}async encode(e,t){const n=D.Buffer.alloc(1e3),i=this.accountLayouts.get(e);if(!i)throw new Error(`Unknown account: ${e}`);const s=i.encode(t,n);let o=n.slice(0,s),a=Ii.accountDiscriminator(e);return D.Buffer.concat([a,o])}decode(e,t){if(Ii.accountDiscriminator(e).compare(t.slice(0,8)))throw new Error("Invalid account discriminator");return this.decodeUnchecked(e,t)}decodeUnchecked(e,t){const n=t.slice(8),i=this.accountLayouts.get(e);if(!i)throw new Error(`Unknown account: ${e}`);return i.decode(n)}memcmp(e,t){const n=Ii.accountDiscriminator(e);return{offset:0,bytes:ge.encode(t?D.Buffer.concat([n,t]):n)}}size(e){var t;return 8+((t=$u(this.idl,e))!==null&&t!==void 0?t:0)}static accountDiscriminator(e){return D.Buffer.from(Hr.exports.sha256.digest(`account:${_t(e,{pascalCase:!0})}`)).slice(0,8)}}class Ff{constructor(e){if(e.events===void 0)return void(this.layouts=new Map);const t=e.events.map(n=>{let i={name:n.name,type:{kind:"struct",fields:n.fields.map(s=>({name:s.name,type:s.type}))}};return[n.name,Xt.typeDefLayout(i,e.types)]});this.layouts=new Map(t),this.discriminators=new Map(e.events===void 0?[]:e.events.map(n=>[nu(Uf(n.name)),n.name]))}decode(e){let t;try{t=D.Buffer.from(pf(e))}catch{return null}const n=nu(t.slice(0,8)),i=this.discriminators.get(n);if(i===void 0)return null;const s=this.layouts.get(i);if(!s)throw new Error(`Unknown event: ${i}`);return{data:s.decode(t.slice(8)),name:i}}}function Uf(r){return D.Buffer.from(Hr.exports.sha256.digest(`event:${r}`)).slice(0,8)}class $f{constructor(e){if(e.state===void 0)throw new Error("Idl state not defined.");this.layout=Xt.typeDefLayout(e.state.struct,e.types)}async encode(e,t){const n=D.Buffer.alloc(1e3),i=this.layout.encode(t,n),s=await Wu(e),o=n.slice(0,i);return D.Buffer.concat([s,o])}decode(e){const t=e.slice(8);return this.layout.decode(t)}}async function Wu(r){let e=wa("anchor-deprecated-state")?"account":"state";return D.Buffer.from(Hr.exports.sha256.digest(`${e}:${r}`)).slice(0,8)}class Aa{constructor(e){this.instruction=new _a(e),this.accounts=new Ii(e),this.events=new Ff(e),e.state&&(this.state=new $f(e))}}var Zg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ae.global<"u"?ae.global:typeof self<"u"?self:{};function em(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}class nn{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}decode(e,t){throw new Error("Layout is abstract")}encode(e,t,n){throw new Error("Layout is abstract")}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}var Wf=nn;class xr extends nn{isCount(){throw new Error("ExternalLayout is abstract")}}class tm extends xr{constructor(e,t,n){if(!(e instanceof nn))throw new TypeError("layout must be a Layout");if(t===void 0)t=0;else if(!Number.isInteger(t))throw new TypeError("offset must be integer or undefined");super(e.span,n||e.property),this.layout=e,this.offset=t}isCount(){return this.layout instanceof Sa||this.layout instanceof jf}decode(e,t){return t===void 0&&(t=0),this.layout.decode(e,t+this.offset)}encode(e,t,n){return n===void 0&&(n=0),this.layout.encode(e,t,n+this.offset)}}class Sa extends nn{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntLE(t,this.span)}encode(e,t,n){return n===void 0&&(n=0),t.writeUIntLE(e,n,this.span),this.span}}class jf extends nn{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntBE(t,this.span)}encode(e,t,n){return n===void 0&&(n=0),t.writeUIntBE(e,n,this.span),this.span}}const Rc=Math.pow(2,32);class nm extends nn{constructor(e){super(8,e)}decode(e,t){t===void 0&&(t=0);const n=e.readUInt32LE(t);return function(i,s){return i*Rc+s}(e.readUInt32LE(t+4),n)}encode(e,t,n){n===void 0&&(n=0);const i=function(s){const o=Math.floor(s/Rc);return{hi32:o,lo32:s-o*Rc}}(e);return t.writeUInt32LE(i.lo32,n),t.writeUInt32LE(i.hi32,n+4),8}}class rm extends nn{constructor(e,t,n){if(!Array.isArray(e)||!e.reduce((s,o)=>s&&o instanceof nn,!0))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&n===void 0&&(n=t,t=void 0);for(const s of e)if(0>s.span&&s.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let i=-1;try{i=e.reduce((s,o)=>s+o.getSpan(),0)}catch{}super(i,t),this.fields=e,this.decodePrefixes=!!n}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let n=0;try{n=this.fields.reduce((i,s)=>{const o=s.getSpan(e,t);return t+=o,i+o},0)}catch{throw new RangeError("indeterminate span")}return n}decode(e,t){t===void 0&&(t=0);const n=this.makeDestinationObject();for(const i of this.fields)if(i.property!==void 0&&(n[i.property]=i.decode(e,t)),t+=i.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return n}encode(e,t,n){n===void 0&&(n=0);const i=n;let s=0,o=0;for(const a of this.fields){let c=a.span;if(o=0<c?c:0,a.property!==void 0){const l=e[a.property];l!==void 0&&(o=a.encode(l,t,n),0>c&&(c=a.getSpan(t,n)))}s=n,n+=c}return s+o-i}fromArray(e){const t=this.makeDestinationObject();for(const n of this.fields)n.property!==void 0&&0<e.length&&(t[n.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const n of this.fields){if(n.property===e)return t;0>n.span?t=-1:0<=t&&(t+=n.span)}}}class qf{constructor(e){this.property=e}decode(){throw new Error("UnionDiscriminator is abstract")}encode(){throw new Error("UnionDiscriminator is abstract")}}class Yl extends qf{constructor(e,t){if(!(e instanceof xr&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(t||e.property||"variant"),this.layout=e}decode(e,t){return this.layout.decode(e,t)}encode(e,t,n){return this.layout.encode(e,t,n)}}class Gf extends nn{constructor(e,t,n){const i=e instanceof Sa||e instanceof jf;if(i)e=new Yl(new tm(e));else if(e instanceof xr&&e.isCount())e=new Yl(e);else if(!(e instanceof qf))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(t===void 0&&(t=null),!(t===null||t instanceof nn))throw new TypeError("defaultLayout must be null or a Layout");if(t!==null){if(0>t.span)throw new Error("defaultLayout must have constant span");t.property===void 0&&(t=t.replicate("content"))}let s=-1;t&&(s=t.span,0<=s&&i&&(s+=e.layout.span)),super(s,n),this.discriminator=e,this.usesPrefixDiscriminator=i,this.defaultLayout=t,this.registry={};let o=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(a){return o(a)},this.configGetSourceVariant=function(a){o=a.bind(this)}}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);const n=this.getVariant(e,t);if(!n)throw new Error("unable to determine span for unrecognized variant");return n.getSpan(e,t)}defaultGetSourceVariant(e){if(e.hasOwnProperty(this.discriminator.property)){if(this.defaultLayout&&e.hasOwnProperty(this.defaultLayout.property))return;const t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||e.hasOwnProperty(t.property)))return t}else for(const t in this.registry){const n=this.registry[t];if(e.hasOwnProperty(n.property))return n}throw new Error("unable to infer src variant")}decode(e,t){let n;t===void 0&&(t=0);const i=this.discriminator,s=i.decode(e,t);let o=this.registry[s];if(o===void 0){let a=0;o=this.defaultLayout,this.usesPrefixDiscriminator&&(a=i.layout.span),n=this.makeDestinationObject(),n[i.property]=s,n[o.property]=this.defaultLayout.decode(e,t+a)}else n=o.decode(e,t);return n}encode(e,t,n){n===void 0&&(n=0);const i=this.getSourceVariant(e);if(i===void 0){const s=this.discriminator,o=this.defaultLayout;let a=0;return this.usesPrefixDiscriminator&&(a=s.layout.span),s.encode(e[s.property],t,n),a+o.encode(e[o.property],t,n+a)}return i.encode(e,t,n)}addVariant(e,t,n){const i=new im(this,e,t,n);return this.registry[e]=i,i}getVariant(e,t){let n=e;return ae.Buffer.isBuffer(e)&&(t===void 0&&(t=0),n=this.discriminator.decode(e,t)),this.registry[n]}}class im extends nn{constructor(e,t,n,i){if(!(e instanceof Gf))throw new TypeError("union must be a Union");if(!Number.isInteger(t)||0>t)throw new TypeError("variant must be a (non-negative) integer");if(typeof n=="string"&&i===void 0&&(i=n,n=null),n){if(!(n instanceof nn))throw new TypeError("layout must be a Layout");if(e.defaultLayout!==null&&0<=n.span&&n.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof i!="string")throw new TypeError("variant must have a String property")}let s=e.span;0>e.span&&(s=n?n.span:0,0<=s&&e.usesPrefixDiscriminator&&(s+=e.discriminator.layout.span)),super(s,i),this.union=e,this.variant=t,this.layout=n||null}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let n=0;return this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),n+this.layout.getSpan(e,t+n)}decode(e,t){const n=this.makeDestinationObject();if(t===void 0&&(t=0),this!==this.union.getVariant(e,t))throw new Error("variant mismatch");let i=0;return this.union.usesPrefixDiscriminator&&(i=this.union.discriminator.layout.span),this.layout?n[this.property]=this.layout.decode(e,t+i):this.property?n[this.property]=!0:this.union.usesPrefixDiscriminator&&(n[this.union.discriminator.property]=this.variant),n}encode(e,t,n){n===void 0&&(n=0);let i=0;if(this.union.usesPrefixDiscriminator&&(i=this.union.discriminator.layout.span),this.layout&&!e.hasOwnProperty(this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,n);let s=i;if(this.layout&&(this.layout.encode(e[this.property],t,n+i),s+=this.layout.getSpan(t,n+i),0<=this.union.span&&s>this.union.span))throw new Error("encoded variant overruns containing union");return s}fromArray(e){if(this.layout)return this.layout.fromArray(e)}}class sm extends nn{constructor(e,t){if(!(e instanceof xr&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;e instanceof xr||(n=e),super(n,t),this.length=e}getSpan(e,t){let n=this.span;return 0>n&&(n=this.length.decode(e,t)),n}decode(e,t){t===void 0&&(t=0);let n=this.span;return 0>n&&(n=this.length.decode(e,t)),e.slice(t,t+n)}encode(e,t,n){let i=this.length;if(this.length instanceof xr&&(i=e.length),!ae.Buffer.isBuffer(e)||i!==e.length)throw new TypeError((s="Blob.encode",((o=this).property?s+"["+o.property+"]":s)+" requires (length "+i+") Buffer as src"));var s,o;if(n+i>t.length)throw new RangeError("encoding overruns Buffer");return t.write(e.toString("hex"),n,i,"hex"),this.length instanceof xr&&this.length.encode(i,t,n),i}}var Et=r=>new Sa(1,r),rr=r=>new nm(r),He=(r,e,t)=>new rm(r,e,t),ka=(r,e)=>new sm(r,e);class om{constructor(e){}encode(e,t){switch(_t(e)){case"initializeMint":return function({decimals:n,mintAuthority:i,freezeAuthority:s}){return nt({initializeMint:{decimals:n,mintAuthority:i.toBuffer(),freezeAuthorityOption:!!s,freezeAuthority:(s||we.default).toBuffer()}})}(t);case"initializeAccount":return nt({initializeAccount:{}});case"initializeMultisig":return function({m:n}){return nt({initializeMultisig:{m:n}})}(t);case"transfer":return function({amount:n}){return nt({transfer:{amount:n}})}(t);case"approve":return function({amount:n}){return nt({approve:{amount:n}})}(t);case"revoke":return nt({revoke:{}});case"setAuthority":return function({authorityType:n,newAuthority:i}){return nt({setAuthority:{authorityType:n,newAuthority:i}})}(t);case"mintTo":return function({amount:n}){return nt({mintTo:{amount:n}})}(t);case"burn":return function({amount:n}){return nt({burn:{amount:n}})}(t);case"closeAccount":return nt({closeAccount:{}});case"freezeAccount":return nt({freezeAccount:{}});case"thawAccount":return nt({thawAccount:{}});case"transferChecked":return function({amount:n,decimals:i}){return nt({transferChecked:{amount:n,decimals:i}})}(t);case"approvedChecked":return function({amount:n,decimals:i}){return nt({approveChecked:{amount:n,decimals:i}})}(t);case"mintToChecked":return function({amount:n,decimals:i}){return nt({mintToChecked:{amount:n,decimals:i}})}(t);case"burnChecked":return function({amount:n,decimals:i}){return nt({burnChecked:{amount:n,decimals:i}})}(t);case"intializeAccount2":return function({authority:n}){return nt({initilaizeAccount2:{authority:n}})}(t);case"syncNative":return nt({syncNative:{}});case"initializeAccount3":return function({authority:n}){return nt({initializeAccount3:{authority:n}})}(t);case"initializeMultisig2":return function({m:n}){return nt({initializeMultisig2:{m:n}})}(t);case"initializeMint2":return function({decimals:n,mintAuthority:i,freezeAuthority:s}){return nt({encodeInitializeMint2:{decimals:n,mintAuthority:i,freezeAuthority:s}})}(t);default:throw new Error(`Invalid instruction: ${e}`)}}encodeState(e,t){throw new Error("SPL token does not have state")}}const Ye=(Ql=Et("instruction"),new Gf(Ql,am,cm));var Ql,am,cm;function ai(r){return ka(32,r)}function nt(r){let e=ae.Buffer.alloc(um),t=Ye.encode(r,e);return e.slice(0,t)}Ye.addVariant(0,He([Et("decimals"),ka(32,"mintAuthority"),Et("freezeAuthorityOption"),ai("freezeAuthority")]),"initializeMint"),Ye.addVariant(1,He([]),"initializeAccount"),Ye.addVariant(2,He([Et("m")]),"initializeMultisig"),Ye.addVariant(3,He([rr("amount")]),"transfer"),Ye.addVariant(4,He([rr("amount")]),"approve"),Ye.addVariant(5,He([]),"revoke"),Ye.addVariant(6,He([Et("authorityType"),Et("newAuthorityOption"),ai("newAuthority")]),"setAuthority"),Ye.addVariant(7,He([rr("amount")]),"mintTo"),Ye.addVariant(8,He([rr("amount")]),"burn"),Ye.addVariant(9,He([]),"closeAccount"),Ye.addVariant(10,He([]),"freezeAccount"),Ye.addVariant(11,He([]),"thawAccount"),Ye.addVariant(12,He([rr("amount"),Et("decimals")]),"transferChecked"),Ye.addVariant(13,He([rr("amount"),Et("decimals")]),"approvedChecked"),Ye.addVariant(14,He([rr("amount"),Et("decimals")]),"mintToChecked"),Ye.addVariant(15,He([rr("amount"),Et("decimals")]),"burnedChecked"),Ye.addVariant(16,He([ai("authority")]),"InitializeAccount2"),Ye.addVariant(17,He([]),"syncNative"),Ye.addVariant(18,He([ai("authority")]),"initializeAccount3"),Ye.addVariant(19,He([Et("m")]),"initializeMultisig2"),Ye.addVariant(20,He([Et("decimals"),ai("mintAuthority"),Et("freezeAuthorityOption"),ai("freezeAuthority")]),"initializeMint2");const um=Math.max(...Object.values(Ye.registry).map(r=>r.span));class lm{constructor(e){}encode(e,t){throw new Error("SPL token does not have state")}decode(e){throw new Error("SPL token does not have state")}}function Lo(r){return new ju(ka(8),e=>qu.fromBuffer(e),e=>e.toBuffer(),r)}function gi(r){return new ju(ka(32),e=>new we(e),e=>e.toBuffer(),r)}function _s(r,e){return new dm(r,e)}class ju extends Wf{constructor(e,t,n,i){super(e.span,i),this.layout=e,this.decoder=t,this.encoder=n}decode(e,t){return this.decoder(this.layout.decode(e,t))}encode(e,t,n){return this.layout.encode(this.encoder(e),t,n)}getSpan(e,t){return this.layout.getSpan(e,t)}}class dm extends Wf{constructor(e,t){super(-1,t),this.layout=e,this.discriminator=(n=>new Sa(4,n))()}encode(e,t,n=0){return e==null?this.layout.span+this.discriminator.encode(0,t,n):(this.discriminator.encode(1,t,n),this.layout.encode(e,t,n+4)+4)}decode(e,t=0){const n=this.discriminator.decode(e,t);if(n===0)return null;if(n===1)return this.layout.decode(e,t+4);throw new Error("Invalid coption "+this.layout.property)}getSpan(e,t=0){return this.layout.getSpan(e,t+4)+4}}function fm(r){if(r===0)return!1;if(r===1)return!0;throw new Error("Invalid bool: "+r)}function hm(r){return r?1:0}class qu extends Qn{toBuffer(){const e=super.toArray().reverse(),t=ae.Buffer.from(e);if(t.length===8)return t;if(t.length>=8)throw new Error("u64 too large");const n=ae.Buffer.alloc(8);return t.copy(n),n}static fromBuffer(e){if(e.length!==8)throw new Error(`Invalid buffer length: ${e.length}`);return new qu([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}class pm{constructor(e){this.idl=e}async encode(e,t){switch(e){case"token":{const n=ae.Buffer.alloc(165),i=Xl.encode(t,n);return n.slice(0,i)}case"mint":{const n=ae.Buffer.alloc(82),i=Jl.encode(t,n);return n.slice(0,i)}default:throw new Error(`Invalid account name: ${e}`)}}decode(e,t){return this.decodeUnchecked(e,t)}decodeUnchecked(e,t){switch(e){case"token":return function(n){return Xl.decode(n)}(t);case"mint":return function(n){return Jl.decode(n)}(t);default:throw new Error(`Invalid account name: ${e}`)}}memcmp(e,t){switch(e){case"token":return{dataSize:165};case"mint":return{dataSize:82};default:throw new Error(`Invalid account name: ${e}`)}}size(e){var t;return(t=$u(this.idl,e))!==null&&t!==void 0?t:0}}const Jl=He([_s(gi(),"mintAuthority"),Lo("supply"),Et("decimals"),function(r){return new ju(Et(),fm,hm,r)}("isInitialized"),_s(gi(),"freezeAuthority")]),Xl=He([gi("mint"),gi("authority"),Lo("amount"),_s(gi(),"delegate"),Et("state"),_s(Lo(),"isNative"),Lo("delegatedAmount"),_s(gi(),"closeAuthority")]);class ym{constructor(e){}decode(e){throw new Error("SPL token program does not have events")}}class Hf{constructor(e){this.instruction=new om(e),this.accounts=new pm(e),this.events=new ym(e),this.state=new lm(e)}}var gm=Object.freeze({__proto__:null,hash:function(r){return Hr.exports.sha256(r)}});function Yf(r,e,t){const n=D.Buffer.concat([r.toBuffer(),D.Buffer.from(e),t.toBuffer()]),i=Hr.exports.sha256.digest(n);return new we(D.Buffer.from(i))}function Qf(r,e){let t=D.Buffer.alloc(0);r.forEach(function(s){if(s.length>32)throw new TypeError("Max seed length exceeded");t=D.Buffer.concat([t,mm(s)])}),t=D.Buffer.concat([t,e.toBuffer(),D.Buffer.from("ProgramDerivedAddress")]);let n=Hr.exports.sha256(new Uint8Array(t)),i=new Qn(n,16).toArray(void 0,32);if(we.isOnCurve(new Uint8Array(i)))throw new Error("Invalid seeds, address must fall off the curve");return new we(i)}function Gu(r,e){let t,n=255;for(;n!=0;){try{t=Qf(r.concat(D.Buffer.from([n])),e)}catch(i){if(i instanceof TypeError)throw i;n--;continue}return[t,n]}throw new Error("Unable to find a viable program address nonce")}const mm=r=>r instanceof D.Buffer?r:r instanceof Uint8Array?D.Buffer.from(r.buffer,r.byteOffset,r.byteLength):D.Buffer.from(r);async function Jf(r,...e){let t=[D.Buffer.from([97,110,99,104,111,114])];e.forEach(i=>{t.push(i instanceof D.Buffer?i:mn(i).toBuffer())});const[n]=await we.findProgramAddress(t,mn(r));return n}var bm=Object.freeze({__proto__:null,createWithSeedSync:Yf,createProgramAddressSync:Qf,findProgramAddressSync:Gu,associated:Jf});const su=new we("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),ou=new we("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");var vm=Object.freeze({__proto__:null,TOKEN_PROGRAM_ID:su,ASSOCIATED_PROGRAM_ID:ou,associatedAddress:async function({mint:r,owner:e}){return(await we.findProgramAddress([e.toBuffer(),su.toBuffer(),r.toBuffer()],ou))[0]}}),au={exports:{}};(function(r,e){var t=typeof self<"u"?self:Zg,n=function(){function s(){this.fetch=!1,this.DOMException=t.DOMException}return s.prototype=t,new s}();(function(s){(function(o){var a="URLSearchParams"in s,c="Symbol"in s&&"iterator"in Symbol,l="FileReader"in s&&"Blob"in s&&function(){try{return new Blob,!0}catch{return!1}}(),u="FormData"in s,h="ArrayBuffer"in s;if(h)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],w=ArrayBuffer.isView||function(S){return S&&b.indexOf(Object.prototype.toString.call(S))>-1};function k(S){if(typeof S!="string"&&(S=String(S)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(S))throw new TypeError("Invalid character in header field name");return S.toLowerCase()}function g(S){return typeof S!="string"&&(S=String(S)),S}function _(S){var K={next:function(){var U=S.shift();return{done:U===void 0,value:U}}};return c&&(K[Symbol.iterator]=function(){return K}),K}function I(S){this.map={},S instanceof I?S.forEach(function(K,U){this.append(U,K)},this):Array.isArray(S)?S.forEach(function(K){this.append(K[0],K[1])},this):S&&Object.getOwnPropertyNames(S).forEach(function(K){this.append(K,S[K])},this)}function L(S){if(S.bodyUsed)return Promise.reject(new TypeError("Already read"));S.bodyUsed=!0}function G(S){return new Promise(function(K,U){S.onload=function(){K(S.result)},S.onerror=function(){U(S.error)}})}function $(S){var K=new FileReader,U=G(K);return K.readAsArrayBuffer(S),U}function Q(S){if(S.slice)return S.slice(0);var K=new Uint8Array(S.byteLength);return K.set(new Uint8Array(S)),K.buffer}function v(){return this.bodyUsed=!1,this._initBody=function(S){var K;this._bodyInit=S,S?typeof S=="string"?this._bodyText=S:l&&Blob.prototype.isPrototypeOf(S)?this._bodyBlob=S:u&&FormData.prototype.isPrototypeOf(S)?this._bodyFormData=S:a&&URLSearchParams.prototype.isPrototypeOf(S)?this._bodyText=S.toString():h&&l&&(K=S)&&DataView.prototype.isPrototypeOf(K)?(this._bodyArrayBuffer=Q(S.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):h&&(ArrayBuffer.prototype.isPrototypeOf(S)||w(S))?this._bodyArrayBuffer=Q(S):this._bodyText=S=Object.prototype.toString.call(S):this._bodyText="",this.headers.get("content-type")||(typeof S=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):a&&URLSearchParams.prototype.isPrototypeOf(S)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},l&&(this.blob=function(){var S=L(this);if(S)return S;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?L(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then($)}),this.text=function(){var S=L(this);if(S)return S;if(this._bodyBlob)return function(K){var U=new FileReader,ue=G(U);return U.readAsText(K),ue}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(K){for(var U=new Uint8Array(K),ue=new Array(U.length),X=0;X<U.length;X++)ue[X]=String.fromCharCode(U[X]);return ue.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},u&&(this.formData=function(){return this.text().then(N)}),this.json=function(){return this.text().then(JSON.parse)},this}I.prototype.append=function(S,K){S=k(S),K=g(K);var U=this.map[S];this.map[S]=U?U+", "+K:K},I.prototype.delete=function(S){delete this.map[k(S)]},I.prototype.get=function(S){return S=k(S),this.has(S)?this.map[S]:null},I.prototype.has=function(S){return this.map.hasOwnProperty(k(S))},I.prototype.set=function(S,K){this.map[k(S)]=g(K)},I.prototype.forEach=function(S,K){for(var U in this.map)this.map.hasOwnProperty(U)&&S.call(K,this.map[U],U,this)},I.prototype.keys=function(){var S=[];return this.forEach(function(K,U){S.push(U)}),_(S)},I.prototype.values=function(){var S=[];return this.forEach(function(K){S.push(K)}),_(S)},I.prototype.entries=function(){var S=[];return this.forEach(function(K,U){S.push([U,K])}),_(S)},c&&(I.prototype[Symbol.iterator]=I.prototype.entries);var O=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function R(S,K){var U,ue,X=(K=K||{}).body;if(S instanceof R){if(S.bodyUsed)throw new TypeError("Already read");this.url=S.url,this.credentials=S.credentials,K.headers||(this.headers=new I(S.headers)),this.method=S.method,this.mode=S.mode,this.signal=S.signal,X||S._bodyInit==null||(X=S._bodyInit,S.bodyUsed=!0)}else this.url=String(S);if(this.credentials=K.credentials||this.credentials||"same-origin",!K.headers&&this.headers||(this.headers=new I(K.headers)),this.method=(U=K.method||this.method||"GET",ue=U.toUpperCase(),O.indexOf(ue)>-1?ue:U),this.mode=K.mode||this.mode||null,this.signal=K.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&X)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(X)}function N(S){var K=new FormData;return S.trim().split("&").forEach(function(U){if(U){var ue=U.split("="),X=ue.shift().replace(/\+/g," "),le=ue.join("=").replace(/\+/g," ");K.append(decodeURIComponent(X),decodeURIComponent(le))}}),K}function M(S,K){K||(K={}),this.type="default",this.status=K.status===void 0?200:K.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in K?K.statusText:"OK",this.headers=new I(K.headers),this.url=K.url||"",this._initBody(S)}R.prototype.clone=function(){return new R(this,{body:this._bodyInit})},v.call(R.prototype),v.call(M.prototype),M.prototype.clone=function(){return new M(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new I(this.headers),url:this.url})},M.error=function(){var S=new M(null,{status:0,statusText:""});return S.type="error",S};var J=[301,302,303,307,308];M.redirect=function(S,K){if(J.indexOf(K)===-1)throw new RangeError("Invalid status code");return new M(null,{status:K,headers:{location:S}})},o.DOMException=s.DOMException;try{new o.DOMException}catch{o.DOMException=function(K,U){this.message=K,this.name=U;var ue=Error(K);this.stack=ue.stack},o.DOMException.prototype=Object.create(Error.prototype),o.DOMException.prototype.constructor=o.DOMException}function re(S,K){return new Promise(function(U,ue){var X=new R(S,K);if(X.signal&&X.signal.aborted)return ue(new o.DOMException("Aborted","AbortError"));var le=new XMLHttpRequest;function yt(){le.abort()}le.onload=function(){var Rt,oe,me={status:le.status,statusText:le.statusText,headers:(Rt=le.getAllResponseHeaders()||"",oe=new I,Rt.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(kt){var gt=kt.split(":"),Ge=gt.shift().trim();if(Ge){var En=gt.join(":").trim();oe.append(Ge,En)}}),oe)};me.url="responseURL"in le?le.responseURL:me.headers.get("X-Request-URL");var vt="response"in le?le.response:le.responseText;U(new M(vt,me))},le.onerror=function(){ue(new TypeError("Network request failed"))},le.ontimeout=function(){ue(new TypeError("Network request failed"))},le.onabort=function(){ue(new o.DOMException("Aborted","AbortError"))},le.open(X.method,X.url,!0),X.credentials==="include"?le.withCredentials=!0:X.credentials==="omit"&&(le.withCredentials=!1),"responseType"in le&&l&&(le.responseType="blob"),X.headers.forEach(function(Rt,oe){le.setRequestHeader(oe,Rt)}),X.signal&&(X.signal.addEventListener("abort",yt),le.onreadystatechange=function(){le.readyState===4&&X.signal.removeEventListener("abort",yt)}),le.send(X._bodyInit===void 0?null:X._bodyInit)})}re.polyfill=!0,s.fetch||(s.fetch=re,s.Headers=I,s.Request=R,s.Response=M),o.Headers=I,o.Request=R,o.Response=M,o.fetch=re,Object.defineProperty(o,"__esModule",{value:!0})})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var i=n;(e=i.fetch).default=i.fetch,e.fetch=i.fetch,e.Headers=i.Headers,e.Request=i.Request,e.Response=i.Response,r.exports=e})(au,au.exports);var wm=em(au.exports);async function Zl(r,e){const t=await r.getAccountInfo(e);if(t===null)throw new Error("program account not found");const{program:n}=cu(t.data),i=await r.getAccountInfo(n.programdataAddress);if(i===null)throw new Error("program data account not found");const{programData:s}=cu(i.data);return s}const _m=fe.rustEnum([fe.struct([],"uninitialized"),fe.struct([fe.option(fe.publicKey(),"authorityAddress")],"buffer"),fe.struct([fe.publicKey("programdataAddress")],"program"),fe.struct([fe.u64("slot"),fe.option(fe.publicKey(),"upgradeAuthorityAddress")],"programData")],void 0,fe.u32());function cu(r){return _m.decode(r)}var Am=Object.freeze({__proto__:null,verifiedBuild:async function(r,e,t=5){const n=`https://anchor.projectserum.com/api/v0/program/${e.toString()}/latest?limit=${t}`,[i,s]=await Promise.all([Zl(r,e),wm(n)]),o=(await s.json()).filter(c=>!c.aborted&&c.state==="Built"&&c.verified==="Verified");if(o.length===0)return null;const a=o[0];return i.slot.toNumber()!==a.verified_slot?null:a},fetchData:Zl,decodeUpgradeableLoaderState:cu}),Sm=Object.freeze({__proto__:null,sha256:gm,rpc:$g,publicKey:bm,bytes:Ng,token:vm,features:Gg,registry:Am});const km=fe.struct([fe.publicKey("authority"),fe.vecU8("data")]);function qs(r,e){var t,n;let i={};const s=r.args?r.args.length:0;if(e.length>s){if(e.length!==s+1)throw new Error(`provided too many arguments ${e} to instruction ${r==null?void 0:r.name} expecting: ${(n=(t=r.args)===null||t===void 0?void 0:t.map(o=>o.name))!==null&&n!==void 0?n:[]}`);i=e.pop()}return[e,i]}class Ri{static build(e,t,n){if(e.name==="_inner")throw new Bs("the _inner name is reserved");const i=(...s)=>{const[o,a]=qs(e,[...s]);va(e.accounts,a.accounts);const c=i.accounts(a.accounts);return a.remainingAccounts!==void 0&&c.push(...a.remainingAccounts),wa("debug-logs")&&console.log("Outgoing account metas:",c),new hf({keys:c,programId:n,data:t(e.name,Bf(e,...o))})};return i.accounts=s=>Ri.accountsArray(s,e.accounts,e.name),i}static accountsArray(e,t,n){return e?t.map(i=>{if(("accounts"in i?i.accounts:void 0)!==void 0){const s=e[i.name];return Ri.accountsArray(s,i.accounts,n).flat()}{const s=i;let o;try{o=mn(e[i.name])}catch{throw new Error(`Wrong input type for account "${i.name}" in the instruction accounts object${n!==void 0?' for instruction "'+n+'"':""}. Expected PublicKey or string.`)}return{pubkey:o,isWritable:s.isMut,isSigner:s.isSigner}}}).flat():[]}}class Xf{static build(e,t,n,i){return async(...s)=>{var o;const a=t(...s),[,c]=qs(e,[...s]);if(i.sendAndConfirm===void 0)throw new Error("This function requires 'Provider.sendAndConfirm' to be implemented.");try{return await i.sendAndConfirm(a,(o=c.signers)!==null&&o!==void 0?o:[],c.options)}catch(l){throw Uu(l,n)}}}}class Zf{static build(e,t){return(...n)=>{var i,s,o;const[,a]=qs(e,[...n]),c=new Lu;if(a.preInstructions&&a.instructions)throw new Error("instructions is deprecated, use preInstructions");return(i=a.preInstructions)===null||i===void 0||i.forEach(l=>c.add(l)),(s=a.instructions)===null||s===void 0||s.forEach(l=>c.add(l)),c.add(t(...n)),(o=a.postInstructions)===null||o===void 0||o.forEach(l=>c.add(l)),c}}}class eh{constructor(e,t,n=Bi(),i=new Aa(e)){this.provider=n,this.coder=i,this._idl=e,this._programId=t,this._address=xc(t),this._sub=null;const[s,o,a]=(()=>{var c;let l={},u={},h={};return(c=e.state)===null||c===void 0||c.methods.forEach(b=>{const w=Ri.build(b,(I,L)=>i.instruction.encodeState(I,L),t);w.accounts=I=>function(G,$,Q,v){if(Q.name==="new"){const[O]=Gu([],G);if($.wallet===void 0)throw new Error("This function requires the Provider interface implementor to have a 'wallet' field.");return[{pubkey:$.wallet.publicKey,isWritable:!1,isSigner:!0},{pubkey:xc(G),isWritable:!0,isSigner:!1},{pubkey:O,isWritable:!1,isSigner:!1},{pubkey:Nu.programId,isWritable:!1,isSigner:!1},{pubkey:G,isWritable:!1,isSigner:!1}]}return va(Q.accounts,v),[{pubkey:xc(G),isWritable:!0,isSigner:!1}]}(t,n,b,I).concat(Ri.accountsArray(I,b.accounts,b.name));const k=Zf.build(b,w),g=Xf.build(b,k,Vu(e),n),_=_t(b.name);l[_]=w,u[_]=k,h[_]=g}),[l,u,h]})();this.instruction=s,this.transaction=o,this.rpc=a}get programId(){return this._programId}async fetch(){const e=this.address(),t=await this.provider.connection.getAccountInfo(e);if(t===null)throw new Error(`Account does not exist ${e.toString()}`);const n=this._idl.state;if(!n)throw new Error("State is not specified in IDL.");if((await Wu(n.struct.name)).compare(t.data.slice(0,8)))throw new Error("Invalid account discriminator");return this.coder.state.decode(t.data)}address(){return this._address}subscribe(e){if(this._sub!==null)return this._sub.ee;const t=new gf,n=this.provider.connection.onAccountChange(this.address(),i=>{const s=this.coder.state.decode(i.data);t.emit("change",s)},e);return this._sub={ee:t,listener:n},t}unsubscribe(){this._sub!==null&&this.provider.connection.removeAccountChangeListener(this._sub.listener).then(async()=>{this._sub=null}).catch(console.error)}}function xc(r){let[e]=Gu([],r);return Yf(e,"unversioned",r)}class th{constructor(e,t,n,i,s){this._idlAccount=t,this._programId=n,this._provider=i??Bi(),this._coder=s??new Aa(e),this._size=this._coder.accounts.size(t)}get size(){return this._size}get programId(){return this._programId}get provider(){return this._provider}get coder(){return this._coder}async fetchNullable(e,t){const n=await this.getAccountInfo(e,t);return n===null?null:this._coder.accounts.decode(this._idlAccount.name,n.data)}async fetch(e,t){const n=await this.fetchNullable(e,t);if(n===null)throw new Error(`Account does not exist ${e.toString()}`);return n}async fetchMultiple(e,t){return(await Cf(this._provider.connection,e.map(n=>mn(n)),t)).map(n=>n==null?null:this._coder.accounts.decode(this._idlAccount.name,n==null?void 0:n.account.data))}async all(e){return(await this._provider.connection.getProgramAccounts(this._programId,{commitment:this._provider.connection.commitment,filters:[{memcmp:this.coder.accounts.memcmp(this._idlAccount.name,e instanceof ae.Buffer?e:void 0)},...Array.isArray(e)?e:[]]})).map(({pubkey:t,account:n})=>({publicKey:t,account:this._coder.accounts.decode(this._idlAccount.name,n.data)}))}subscribe(e,t){const n=ds.get(e.toString());if(n)return n.ee;const i=new gf;e=mn(e);const s=this._provider.connection.onAccountChange(e,o=>{const a=this._coder.accounts.decode(this._idlAccount.name,o.data);i.emit("change",a)},t);return ds.set(e.toString(),{ee:i,listener:s}),i}async unsubscribe(e){let t=ds.get(e.toString());t?ds&&await this._provider.connection.removeAccountChangeListener(t.listener).then(()=>{ds.delete(e.toString())}).catch(console.error):console.warn("Address is not subscribed")}async createInstruction(e,t){const n=this.size;if(this._provider.wallet===void 0)throw new Error("This function requires the Provider interface implementor to have a 'wallet' field.");return Nu.createAccount({fromPubkey:this._provider.wallet.publicKey,newAccountPubkey:e.publicKey,space:t??n,lamports:await this._provider.connection.getMinimumBalanceForRentExemption(t??n),programId:this._programId})}async associated(...e){const t=await this.associatedAddress(...e);return await this.fetch(t)}async associatedAddress(...e){return await Jf(this._programId,...e)}async getAccountInfo(e,t){return await this._provider.connection.getAccountInfo(mn(e),t)}}const ds=new Map,Im=13,Em=14;class nh{constructor(e,t,n){this._programId=e,this._provider=t,this._eventParser=new Hu(e,n),this._eventCallbacks=new Map,this._eventListeners=new Map,this._listenerIdCount=0}addEventListener(e,t){var n;let i=this._listenerIdCount;return this._listenerIdCount+=1,e in this._eventCallbacks||this._eventListeners.set(e,[]),this._eventListeners.set(e,((n=this._eventListeners.get(e))!==null&&n!==void 0?n:[]).concat(i)),this._eventCallbacks.set(i,[e,t]),this._onLogsSubscriptionId!==void 0||(this._onLogsSubscriptionId=this._provider.connection.onLogs(this._programId,(s,o)=>{s.err||this._eventParser.parseLogs(s.logs,a=>{const c=this._eventListeners.get(a.name);c&&c.forEach(l=>{const u=this._eventCallbacks.get(l);if(u){const[,h]=u;h(a.data,o.slot)}})})})),i}async removeEventListener(e){const t=this._eventCallbacks.get(e);if(!t)throw new Error(`Event listener ${e} doesn't exist!`);const[n]=t;let i=this._eventListeners.get(n);if(!i)throw new Error(`Event listeners don't exist for ${n}!`);this._eventCallbacks.delete(e),i=i.filter(s=>s!==e),i.length===0&&this._eventListeners.delete(n),this._eventCallbacks.size==0&&(jo.exports.ok(this._eventListeners.size===0),this._onLogsSubscriptionId!==void 0&&(await this._provider.connection.removeOnLogsListener(this._onLogsSubscriptionId),this._onLogsSubscriptionId=void 0))}}class Hu{constructor(e,t){this.coder=t,this.programId=e}parseLogs(e,t){const n=new Pm(e),i=new Om;let s=n.next();for(;s!==null;){let[o,a,c]=this.handleLog(i,s);o&&t(o),a&&i.push(a),c&&i.pop(),s=n.next()}}handleLog(e,t){return e.stack.length>0&&e.program()===this.programId.toString()?this.handleProgramLog(t):[null,...this.handleSystemLog(t)]}handleProgramLog(e){if(e.startsWith("Program log: ")||e.startsWith("Program data: ")){const t=e.startsWith("Program log: ")?e.slice(Im):e.slice(Em);return[this.coder.events.decode(t),null,!1]}return[null,...this.handleSystemLog(e)]}handleSystemLog(e){const t=e.split(":")[0];return t.match(/^Program (.*) success/g)!==null?[null,!0]:t.startsWith(`Program ${this.programId.toString()} invoke`)?[this.programId.toString(),!1]:t.includes("invoke")?["cpi",!1]:[null,!1]}}class Om{constructor(){this.stack=[]}program(){return jo.exports.ok(this.stack.length>0),this.stack[this.stack.length-1]}push(e){this.stack.push(e)}pop(){jo.exports.ok(this.stack.length>0),this.stack.pop()}}class Pm{constructor(e){this.logs=e}next(){if(this.logs.length===0)return null;let e=this.logs[0];return this.logs=this.logs.slice(1),e}}const Tm=new we("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");function rh(){return new Hf(ih)}const ih={version:"0.1.0",name:"spl_token",instructions:[{name:"initializeMint",accounts:[{name:"mint",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"decimals",type:"u8"},{name:"mintAuthority",type:"publicKey"},{name:"freezeAuthority",type:{coption:"publicKey"}}]},{name:"initializeAccount",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[]},{name:"initializeMultisig",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"m",type:"u8"}]},{name:"transfer",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"destination",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"}]},{name:"approve",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"delegate",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"}]},{name:"revoke",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[]},{name:"setAuthority",accounts:[{name:"mint",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"authorityType",type:"u8"},{name:"newAuthority",type:{coption:"publicKey"}}]},{name:"mintTo",accounts:[{name:"mint",isMut:!0,isSigner:!1},{name:"to",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"}]},{name:"burn",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"mint",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"}]},{name:"closeAccount",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"destination",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!1}],args:[]},{name:"freezeAccount",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[]},{name:"thawAccount",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[]},{name:"transferChecked",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"destination",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"},{name:"decimals",type:"u8"}]},{name:"approveChecked",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"delegate",isMut:!1,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"},{name:"decimals",type:"u8"}]},{name:"mintToChecked",accounts:[{name:"mint",isMut:!0,isSigner:!1},{name:"to",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"},{name:"decimals",type:"u8"}]},{name:"burnChecked",accounts:[{name:"source",isMut:!0,isSigner:!1},{name:"mint",isMut:!0,isSigner:!1},{name:"authority",isMut:!1,isSigner:!0}],args:[{name:"amount",type:"u64"},{name:"decimals",type:"u8"}]},{name:"initializeAccount2",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1}],args:[{name:"authority",type:"publicKey"}]},{name:"syncNative",accounts:[{name:"account",isMut:!0,isSigner:!1}],args:[]},{name:"initializeAccount3",accounts:[{name:"account",isMut:!0,isSigner:!1},{name:"mint",isMut:!1,isSigner:!1}],args:[{name:"authority",type:"publicKey"}]},{name:"initializeMultisig2",accounts:[{name:"account",isMut:!0,isSigner:!1}],args:[{name:"m",type:"u8"}]},{name:"initializeMint2",accounts:[{name:"mint",isMut:!0,isSigner:!1}],args:[{name:"decimals",type:"u8"},{name:"mintAuthority",type:"publicKey"},{name:"freezeAuthority",type:{coption:"publicKey"}}]}],accounts:[{name:"mint",type:{kind:"struct",fields:[{name:"mintAuthority",type:{coption:"publicKey"}},{name:"supply",type:"u64"},{name:"decimals",type:"u8"},{name:"isInitialized",type:"bool"},{name:"freezeAuthority",type:{coption:"publicKey"}}]}},{name:"token",type:{kind:"struct",fields:[{name:"mint",type:"publicKey"},{name:"authority",type:"publicKey"},{name:"amount",type:"u64"},{name:"delegate",type:{coption:"publicKey"}},{name:"state",type:"u8"},{name:"isNative",type:{coption:"u64"}},{name:"delegatedAmount",type:"u64"},{name:"closeAuthority",type:{coption:"publicKey"}}]}}]};class xs{constructor(e,t,n,i,s,o){this._args=e,this._accounts=t,this._provider=n,this._programId=i,this._idlIx=s,this._accountStore=new Bm(n,o)}async resolve(){for(let e=0;e<this._idlIx.accounts.length;e+=1){const t=this._idlIx.accounts[e],n=_t(t.name);if(t.pda&&t.pda.seeds.length>0&&!this._accounts[n])await this.autoPopulatePda(t);else if(!t.isSigner||this._accounts[n])Reflect.has(xs.CONST_ACCOUNTS,n)&&!this._accounts[n]&&(this._accounts[n]=xs.CONST_ACCOUNTS[n]);else{if(this._provider.wallet===void 0)throw new Error("This function requires the Provider interface implementor to have a 'wallet' field.");this._accounts[n]=this._provider.wallet.publicKey}}}async autoPopulatePda(e){if(!e.pda||!e.pda.seeds)throw new Error("Must have seeds");const t=await Promise.all(e.pda.seeds.map(s=>this.toBuffer(s))),n=await this.parseProgramId(e),[i]=await we.findProgramAddress(t,n);this._accounts[_t(e.name)]=i}async parseProgramId(e){var t;if(!(!((t=e.pda)===null||t===void 0)&&t.programId))return this._programId;switch(e.pda.programId.kind){case"const":return new we(this.toBufferConst(e.pda.programId.value));case"arg":return this.argValue(e.pda.programId);case"account":return await this.accountValue(e.pda.programId);default:throw new Error(`Unexpected program seed kind: ${e.pda.programId.kind}`)}}async toBuffer(e){switch(e.kind){case"const":return this.toBufferConst(e);case"arg":return await this.toBufferArg(e);case"account":return await this.toBufferAccount(e);default:throw new Error(`Unexpected seed kind: ${e.kind}`)}}toBufferConst(e){return this.toBufferValue(e.type,e.value)}async toBufferArg(e){const t=this.argValue(e);return this.toBufferValue(e.type,t)}argValue(e){const t=_t(e.path.split(".")[0]),n=this._idlIx.args.findIndex(i=>i.name===t);if(n===-1)throw new Error(`Unable to find argument for seed: ${t}`);return this._args[n]}async toBufferAccount(e){const t=await this.accountValue(e);return this.toBufferValue(e.type,t)}async accountValue(e){const t=e.path.split("."),n=t[0],i=this._accounts[_t(n)];if(t.length===1)return i;const s=await this._accountStore.fetchAccount(e.account,i);return this.parseAccountValue(s,t.slice(1))}parseAccountValue(e,t){let n;for(;t.length>0;)n=e[_t(t[0])],t=t.slice(1);return n}toBufferValue(e,t){switch(e){case"u8":return ae.Buffer.from([t]);case"u16":let n=ae.Buffer.alloc(2);return n.writeUInt16LE(t),n;case"u32":let i=ae.Buffer.alloc(4);return i.writeUInt32LE(t),i;case"u64":let s=ae.Buffer.alloc(8);return s.writeBigUInt64LE(BigInt(t)),s;case"string":return ae.Buffer.from(Of(t));case"publicKey":return t.toBuffer();default:if(e.array)return ae.Buffer.from(t);throw new Error(`Unexpected seed type: ${e}`)}}}xs.CONST_ACCOUNTS={systemProgram:Nu.programId,tokenProgram:su,associatedTokenProgram:ou,rent:fg};class Bm{constructor(e,t){this._provider=e,this._accounts=t,this._cache=new Map}async fetchAccount(e,t){const n=t.toString();if(!this._cache.has(n))if(e==="TokenAccount"){const i=await this._provider.connection.getAccountInfo(t);if(i===null)throw new Error(`invalid account info for ${n}`);const s=rh().accounts.decode("token",i.data);this._cache.set(n,s)}else{const i=this._accounts[_t(e)].fetch(t);this._cache.set(n,i)}return this._cache.get(n)}}class sh{static build(e,t,n,i,s,o,a,c,l){return(...u)=>new Rm(u,i,s,o,a,c,e,t,n,l)}}class Rm{constructor(e,t,n,i,s,o,a,c,l,u){this._args=e,this._ixFn=t,this._txFn=n,this._rpcFn=i,this._simulateFn=s,this._viewFn=o,this._accounts={},this._remainingAccounts=[],this._signers=[],this._preInstructions=[],this._postInstructions=[],this._accountsResolver=new xs(e,this._accounts,a,c,l,u)}async pubkeys(){return await this._accountsResolver.resolve(),this._accounts}accounts(e){return Object.assign(this._accounts,e),this}signers(e){return this._signers=this._signers.concat(e),this}remainingAccounts(e){return this._remainingAccounts=this._remainingAccounts.concat(e),this}preInstructions(e){return this._preInstructions=this._preInstructions.concat(e),this}postInstructions(e){return this._postInstructions=this._postInstructions.concat(e),this}async rpc(e){return await this._accountsResolver.resolve(),this._rpcFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async view(e){if(await this._accountsResolver.resolve(),!this._viewFn)throw new Error("Method does not support views");return this._viewFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async simulate(e){return await this._accountsResolver.resolve(),this._simulateFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions,options:e})}async instruction(){return await this._accountsResolver.resolve(),this._ixFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions})}async transaction(){return await this._accountsResolver.resolve(),this._txFn(...this._args,{accounts:this._accounts,signers:this._signers,remainingAccounts:this._remainingAccounts,preInstructions:this._preInstructions,postInstructions:this._postInstructions})}}class Ms{constructor(e,t,n,i){t=mn(t),n||(n=Bi()),this._idl=e,this._provider=n,this._programId=t,this._coder=i??new Aa(e),this._events=new nh(this._programId,n,this._coder);const[s,o,a,c,l,u,h,b]=class{static build(w,k,g,_){const I={},L={},G={},$={},Q={},v={},O=Vu(w),R=w.accounts?class{static build(M,J,re,S){var K;const U={};return(K=M.accounts)===null||K===void 0||K.forEach(ue=>{const X=_t(ue.name);U[X]=new th(M,ue,re,S,J)}),U}}.build(w,k,g,_):{},N=class{static build(M,J,re,S){if(M.state!==void 0)return new eh(M,re,S,J)}}.build(w,k,g,_);return w.instructions.forEach(M=>{const J=Ri.build(M,(le,yt)=>k.instruction.encode(le,yt),g),re=Zf.build(M,J),S=Xf.build(M,re,O,_),K=class{static build(le,yt,Rt,oe,me,vt,kt){return async(...gt)=>{var Ge;const En=yt(...gt),[,xt]=qs(le,[...gt]);let On;if(oe.simulate===void 0)throw new Error("This function requires 'Provider.simulate' to be implemented.");try{On=await oe.simulate(En,xt.signers,(Ge=xt.options)===null||Ge===void 0?void 0:Ge.commitment)}catch(tr){throw Uu(tr,Rt)}if(On===void 0)throw new Error("Unable to simulate transaction");const er=On.logs;if(!er)throw new Error("Simulated logs not found");const Pr=[];return kt.events&&new Hu(vt,me).parseLogs(er,tr=>{Pr.push(tr)}),{events:Pr,raw:er}}}}.build(M,re,O,_,k,g,w),U=class{static build(le,yt,Rt,oe){const me=yt.accounts.find(kt=>kt.isMut),vt=!!yt.returns;if(!me&&vt)return async(...kt)=>{var gt,Ge;let En=await Rt(...kt);const xt=`Program return: ${le} `;let On=En.raw.find(tr=>tr.startsWith(xt));if(!On)throw new Error("View expected return log");let er=Tf(On.slice(xt.length)),Pr=yt.returns;if(!Pr)throw new Error("View expected return type");return Xt.fieldLayout({type:Pr},Array.from([...(gt=oe.accounts)!==null&&gt!==void 0?gt:[],...(Ge=oe.types)!==null&&Ge!==void 0?Ge:[]])).decode(er)}}}.build(g,M,K,w),ue=sh.build(_,g,M,J,re,S,K,U,R),X=_t(M.name);L[X]=J,G[X]=re,I[X]=S,$[X]=K,Q[X]=ue,U&&(v[X]=U)}),[I,L,G,R,$,Q,N,v]}}.build(e,this._coder,t,n);this.rpc=s,this.instruction=o,this.transaction=a,this.account=c,this.simulate=l,this.methods=u,this.state=h,this.views=b}get programId(){return this._programId}get idl(){return this._idl}get coder(){return this._coder}get provider(){return this._provider}static async at(e,t){const n=mn(e),i=await Ms.fetchIdl(n,t);if(!i)throw new Error(`IDL not found for program: ${e.toString()}`);return new Ms(i,n,t)}static async fetchIdl(e,t){t=t??Bi();const n=mn(e),i=await async function(l){const u=(await we.findProgramAddress([],l))[0];return await we.createWithSeed(u,"anchor:idl",l)}(n),s=await t.connection.getAccountInfo(i);if(!s)return null;let o=(a=s.data.slice(8),km.decode(a));var a;const c=hg(o.data);return JSON.parse(Ef(c))}addEventListener(e,t){return this._events.addEventListener(e,t)}async removeEventListener(e){return await this._events.removeEventListener(e)}}class xm{static token(e){return function(t){return new Ms(ih,Tm,t,rh())}(e)}}var Mm=Object.freeze(Object.defineProperty({__proto__:null,web3:pg,ACCOUNT_DISCRIMINATOR_SIZE:Xg,AccountClient:th,AnchorError:ki,AnchorProvider:Nf,BorshAccountsCoder:Ii,BorshCoder:Aa,BorshEventCoder:Ff,BorshInstructionCoder:_a,BorshStateCoder:$f,EventManager:nh,EventParser:Hu,IdlError:Bs,LangErrorCode:se,LangErrorMessage:zf,MethodsBuilderFactory:sh,Program:Ms,ProgramError:Rs,ProgramErrorStack:Hi,Spl:xm,SplTokenCoder:Hf,StateClient:eh,eventDiscriminator:Uf,getProvider:Bi,parseIdlErrors:Vu,setProvider:jg,splitArgsAndCtx:qs,stateDiscriminator:Wu,toInstruction:Bf,translateAddress:mn,translateError:Uu,utils:Sm,validateAccounts:va,BN:Qn},Symbol.toStringTag,{value:"Module"})),Ke=$s(Mm),Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});Gs.stakingIdl=void 0;Gs.stakingIdl={version:"0.1.0",name:"atlas_staking",instructions:[{name:"cancelUnstake",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",path:"user"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}}],args:[]},{name:"createStakingAccount",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",path:"user"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"harvest",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"rewardMint",isMut:!1,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",account:"StakingAccount",path:"staking_account.owner"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"userRewardAccount",isMut:!0,isSigner:!1},{name:"rewardAta",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"initializeStaking",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"stakingVarsAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-vars"}]}},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"registerStake",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"stakingVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-vars"}]}},{name:"stakeMint",isMut:!1,isSigner:!1},{name:"rewardMint",isMut:!1,isSigner:!1},{name:"registeredStake",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",path:"authority"},{kind:"account",type:"publicKey",account:"Mint",path:"stake_mint"},{kind:"account",type:"publicKey",account:"Mint",path:"reward_mint"}]}},{name:"rewardAta",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"rewardMultiplier",type:"u64"},{name:"cooldownPeriod",type:"u64"}]},{name:"settle",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",path:"authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",account:"StakingAccount",path:"staking_account.owner"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}}],args:[{name:"updatedStakingPeriod",type:"u16"}]},{name:"stakeTokens",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"stakeMint",isMut:!1,isSigner:!1},{name:"tokenSource",isMut:!0,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",path:"user"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"tokenEscrow",isMut:!0,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"stakeAmount",type:"u64"}]},{name:"unstakeTokens",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"rewardMint",isMut:!1,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",account:"StakingAccount",path:"staking_account.owner"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"userRewardAccount",isMut:!0,isSigner:!1},{name:"rewardAta",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"associatedTokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"updateCooldownPeriod",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",path:"authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}}],args:[{name:"cooldownPeriod",type:"u64"}]},{name:"updateRewardMultiplier",accounts:[{name:"authority",isMut:!0,isSigner:!0},{name:"registeredStake",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",path:"authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}}],args:[{name:"rewardMultiplier",type:"u64"},{name:"newStakingPeriod",type:"u16"}]},{name:"withdrawTokens",accounts:[{name:"user",isMut:!0,isSigner:!0},{name:"stakeMint",isMut:!1,isSigner:!1},{name:"tokenSource",isMut:!0,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-stake"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.authority"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.stake_mint"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake.reward_mint"}]}},{name:"stakingAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"staking-account"},{kind:"account",type:"publicKey",account:"StakingAccount",path:"staking_account.owner"},{kind:"account",type:"publicKey",account:"RegisteredStake",path:"registered_stake"}]}},{name:"tokenEscrow",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[]}],accounts:[{name:"RegisteredStake",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"stakeMint",type:"publicKey"},{name:"rewardMint",type:"publicKey"},{name:"currentPeriod",type:"u16"},{name:"rewardMultiplier",type:"u64"},{name:"cooldownPeriod",type:"u64"},{name:"bump",type:"u8"}]}},{name:"StakingAccount",type:{kind:"struct",fields:[{name:"owner",type:"publicKey"},{name:"registeredStake",type:"publicKey"},{name:"stakeMint",type:"publicKey"},{name:"totalStake",type:"u64"},{name:"activeStake",type:"u64"},{name:"pendingRewards",type:"u64"},{name:"paidRewards",type:"u64"},{name:"currentPeriod",type:"u16"},{name:"stakedAtTs",type:"i64"},{name:"lastPendingRewardCalcTs",type:"i64"},{name:"lastHarvestTs",type:"i64"},{name:"unstakedTs",type:"i64"},{name:"bump",type:"u8"}]}},{name:"StakingVars",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"bump",type:"u8"}]}}],errors:[{code:6e3,name:"InvalidMint",msg:"Invalid Token Mint"},{code:6001,name:"InvalidOwner",msg:"Account now owned by user"},{code:6002,name:"InsufficientFunds",msg:"Insufficient token balance"},{code:6003,name:"InvalidAuthority",msg:"Invalid authority for this account"},{code:6004,name:"InvalidDepositQty",msg:"Invalid deposit quantity"},{code:6005,name:"NumericalOverflowError",msg:"Numerical overflow error"},{code:6006,name:"StakeOnCooldown",msg:"Cannot stake while account is on cooldown"},{code:6007,name:"InvalidEscrowAuth",msg:"Invalid escrow authority"},{code:6008,name:"WithdrawOnCooldown",msg:"Cannot withdraw before cooldown period has elapsed"},{code:6009,name:"InvalidPeriod",msg:"Staking account must be in the same period as the Registered Stake"},{code:6010,name:"NotOnCooldown",msg:"Staking account is not on cooldown"}],metadata:{}};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.getStakingProgram=Dr.getStakingIdl=void 0;const ed=Ke,Cm=Gs;function oh(r){const e=Cm.stakingIdl;return e.metadata.address=r.toBase58(),e}Dr.getStakingIdl=oh;function Km({connection:r,programId:e}){const t=oh(e),n=new ed.AnchorProvider(r,null,null);return new ed.Program(t,e,n)}Dr.getStakingProgram=Km;(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Dr,r)})(Gt);var Lm=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(ba,"__esModule",{value:!0});ba.cancelUnstakeInstruction=void 0;const Nm=Gt;function Dm({connection:r,user:e,registeredStake:t,programId:n}){return Lm(this,void 0,void 0,function*(){const i=(0,Nm.getStakingProgram)({connection:r,programId:n}),s={instructions:[],signers:[]},o=yield i.methods.cancelUnstake().accounts({user:e,registeredStake:t}).instruction();return s.instructions.push(o),s})}ba.cancelUnstakeInstruction=Dm;var Ia={},Vm=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Ia,"__esModule",{value:!0});Ia.createStakingAccountInstruction=void 0;const zm=Gt;function Fm({connection:r,user:e,registeredStake:t,programId:n}){return Vm(this,void 0,void 0,function*(){const i=(0,zm.getStakingProgram)({connection:r,programId:n}),s={instructions:[],signers:[]},o=yield i.methods.createStakingAccount().accounts({user:e,registeredStake:t}).instruction();return s.instructions.push(o),s})}Ia.createStakingAccountInstruction=Fm;var Ea={},Yr={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.associatedAddress=r.ASSOCIATED_PROGRAM_ID=r.TOKEN_PROGRAM_ID=void 0;const e=yg;r.TOKEN_PROGRAM_ID=new e.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),r.ASSOCIATED_PROGRAM_ID=new e.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");async function t({mint:n,owner:i}){return(await e.PublicKey.findProgramAddress([i.toBuffer(),r.TOKEN_PROGRAM_ID.toBuffer(),n.toBuffer()],r.ASSOCIATED_PROGRAM_ID))[0]}r.associatedAddress=t})(Yr);var yn={},ut={};class Um extends TypeError{constructor(e,t){let n;const{message:i,...s}=e,{path:o}=e,a=o.length===0?i:"At path: "+o.join(".")+" -- "+i;super(a),Object.assign(this,s),this.name=this.constructor.name,this.failures=()=>{var c;return(c=n)!=null?c:n=[e,...t()]}}}function $m(r){return lr(r)&&typeof r[Symbol.iterator]=="function"}function lr(r){return typeof r=="object"&&r!=null}function An(r){return typeof r=="string"?JSON.stringify(r):""+r}function Wm(r){const{done:e,value:t}=r.next();return e?void 0:t}function jm(r,e,t,n){if(r===!0)return;r===!1?r={}:typeof r=="string"&&(r={message:r});const{path:i,branch:s}=e,{type:o}=t,{refinement:a,message:c="Expected a value of type `"+o+"`"+(a?" with refinement `"+a+"`":"")+", but received: `"+An(n)+"`"}=r;return{value:n,type:o,refinement:a,key:i[i.length-1],path:i,branch:s,...r,message:c}}function*td(r,e,t,n){$m(r)||(r=[r]);for(const i of r){const s=jm(i,e,t,n);s&&(yield s)}}function*Yu(r,e,t={}){const{path:n=[],branch:i=[r],coerce:s=!1,mask:o=!1}=t,a={path:n,branch:i};if(s&&(r=e.coercer(r,a),o&&e.type!=="type"&&lr(e.schema)&&lr(r)&&!Array.isArray(r)))for(const l in r)e.schema[l]===void 0&&delete r[l];let c=!0;for(const l of e.validator(r,a))c=!1,yield[l,void 0];for(let[l,u,h]of e.entries(r,a)){const b=Yu(u,h,{path:l===void 0?n:[...n,l],branch:l===void 0?i:[...i,u],coerce:s,mask:o});for(const w of b)w[0]?(c=!1,yield[w[0],void 0]):s&&(u=w[1],l===void 0?r=u:r instanceof Map?r.set(l,u):r instanceof Set?r.add(u):lr(r)&&(r[l]=u))}if(c)for(const l of e.refiner(r,a))c=!1,yield[l,void 0];c&&(yield[void 0,r])}class zn{constructor(e){const{type:t,schema:n,validator:i,refiner:s,coercer:o=c=>c,entries:a=function*(){}}=e;this.type=t,this.schema=n,this.entries=a,this.coercer=o,i?this.validator=(c,l)=>{const u=i(c,l);return td(u,l,this,c)}:this.validator=()=>[],s?this.refiner=(c,l)=>{const u=s(c,l);return td(u,l,this,c)}:this.refiner=()=>[]}assert(e){return ah(e,this)}create(e){return H(e,this)}is(e){return ch(e,this)}mask(e){return qm(e,this)}validate(e,t={}){return Hs(e,this,t)}}function ah(r,e){const t=Hs(r,e);if(t[0])throw t[0]}function H(r,e){const t=Hs(r,e,{coerce:!0});if(t[0])throw t[0];return t[1]}function qm(r,e){const t=Hs(r,e,{coerce:!0,mask:!0});if(t[0])throw t[0];return t[1]}function ch(r,e){return!Hs(r,e)[0]}function Hs(r,e,t={}){const n=Yu(r,e,t),i=Wm(n);if(i[0])return[new Um(i[0],function*(){for(const o of n)o[0]&&(yield o[0])}),void 0];{const s=i[1];return[void 0,s]}}function Qr(r,e){return new zn({type:r,schema:null,validator:e})}function uh(){return Qr("any",()=>!0)}function C(r){return new zn({type:"array",schema:r,*entries(e){if(r&&Array.isArray(e))for(const[t,n]of e.entries())yield[t,n,r]},coercer(e){return Array.isArray(e)?e.slice():e},validator(e){return Array.isArray(e)||"Expected an array value, but received: "+An(e)}})}function ot(){return Qr("boolean",r=>typeof r=="boolean")}function Yi(r){return Qr("instance",e=>e instanceof r||"Expected a `"+r.name+"` instance, but received: "+An(e))}function ce(r){const e=An(r),t=typeof r;return new zn({type:"literal",schema:t==="string"||t==="number"||t==="boolean"?r:null,validator(n){return n===r||"Expected the literal `"+e+"`, but received: "+An(n)}})}function Gm(){return Qr("never",()=>!1)}function x(r){return new zn({...r,validator:(e,t)=>e===null||r.validator(e,t),refiner:(e,t)=>e===null||r.refiner(e,t)})}function y(){return Qr("number",r=>typeof r=="number"&&!isNaN(r)||"Expected a number, but received: "+An(r))}function j(r){return new zn({...r,validator:(e,t)=>e===void 0||r.validator(e,t),refiner:(e,t)=>e===void 0||r.refiner(e,t)})}function Oa(r,e){return new zn({type:"record",schema:null,*entries(t){if(lr(t))for(const n in t){const i=t[n];yield[n,n,r],yield[n,i,e]}},validator(t){return lr(t)||"Expected an object, but received: "+An(t)}})}function P(){return Qr("string",r=>typeof r=="string"||"Expected a string, but received: "+An(r))}function Qi(r){const e=Gm();return new zn({type:"tuple",schema:null,*entries(t){if(Array.isArray(t)){const n=Math.max(r.length,t.length);for(let i=0;i<n;i++)yield[i,t[i],r[i]||e]}},validator(t){return Array.isArray(t)||"Expected an array, but received: "+An(t)}})}function A(r){const e=Object.keys(r);return new zn({type:"type",schema:r,*entries(t){if(lr(t))for(const n of e)yield[n,t[n],r[n]]},validator(t){return lr(t)||"Expected an object, but received: "+An(t)}})}function Ce(r){const e=r.map(t=>t.type).join(" | ");return new zn({type:"union",schema:null,validator(t,n){const i=[];for(const s of r){const[...o]=Yu(t,s,n),[a]=o;if(a[0])for(const[c]of o)c&&i.push(c);else return[]}return["Expected the value to satisfy a union of `"+e+"`, but received: "+An(t),...i]}})}function Fn(){return Qr("unknown",()=>!0)}function Un(r,e,t){return new zn({...r,coercer:(n,i)=>ch(n,e)?r.coercer(t(n,i),i):r.coercer(n,i)})}const Hm=kn.utils.randomPrivateKey,nd=()=>{const r=kn.utils.randomPrivateKey(),e=Yo(r),t=new Uint8Array(64);return t.set(r),t.set(e,32),{publicKey:e,secretKey:t}},Yo=kn.getPublicKey;function rd(r){try{return kn.ExtendedPoint.fromHex(r),!0}catch{return!1}}const Qu=(r,e)=>kn.sign(r,e.slice(0,32)),Ym=kn.verify,pe=r=>D.Buffer.isBuffer(r)?r:r instanceof Uint8Array?D.Buffer.from(r.buffer,r.byteOffset,r.byteLength):D.Buffer.from(r);class Ju{constructor(e){Object.assign(this,e)}encode(){return D.Buffer.from(mf(As,this))}static decode(e){return bf(As,this,e)}static decodeUnchecked(e){return vf(As,this,e)}}class Qm extends Ju{constructor(e){if(super(e),this.enum="",Object.keys(e).length!==1)throw new Error("Enum can only take single value");Object.keys(e).map(t=>{this.enum=t})}}const As=new Map;var lh;let dh;const fh=32,en=32;function Jm(r){return r._bn!==void 0}let id=1;dh=Symbol.toStringTag;class Y extends Ju{constructor(e){if(super({}),this._bn=void 0,Jm(e))this._bn=e._bn;else{if(typeof e=="string"){const t=ge.decode(e);if(t.length!=en)throw new Error("Invalid public key input");this._bn=new Qn(t)}else this._bn=new Qn(e);if(this._bn.byteLength()>en)throw new Error("Invalid public key input")}}static unique(){const e=new Y(id);return id+=1,new Y(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return ge.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(D.Buffer);if(e.length===en)return e;const t=D.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[dh](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,n){const i=D.Buffer.concat([e.toBuffer(),D.Buffer.from(t),n.toBuffer()]),s=qo(i);return new Y(s)}static createProgramAddressSync(e,t){let n=D.Buffer.alloc(0);e.forEach(function(s){if(s.length>fh)throw new TypeError("Max seed length exceeded");n=D.Buffer.concat([n,pe(s)])}),n=D.Buffer.concat([n,t.toBuffer(),D.Buffer.from("ProgramDerivedAddress")]);const i=qo(n);if(rd(i))throw new Error("Invalid seeds, address must fall off the curve");return new Y(i)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let n=255,i;for(;n!=0;){try{const s=e.concat(D.Buffer.from([n]));i=this.createProgramAddressSync(s,t)}catch(s){if(s instanceof TypeError)throw s;n--;continue}return[i,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new Y(e);return rd(t.toBytes())}}lh=Y;Y.default=new lh("11111111111111111111111111111111");As.set(Y,{kind:"struct",fields:[["_bn","u256"]]});class Xm{constructor(e){if(this._publicKey=void 0,this._secretKey=void 0,e){const t=pe(e);if(e.length!==64)throw new Error("bad secret key size");this._publicKey=t.slice(32,64),this._secretKey=t.slice(0,32)}else this._secretKey=pe(Hm()),this._publicKey=pe(Yo(this._secretKey))}get publicKey(){return new Y(this._publicKey)}get secretKey(){return D.Buffer.concat([this._secretKey,this._publicKey],64)}}const Zm=new Y("BPFLoader1111111111111111111111111111111111"),dr=1280-40-8,Pa=127,xi=64;class Xu extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Xu.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class Zu extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Zu.prototype,"name",{value:"TransactionExpiredTimeoutError"});class mi extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(mi.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class Cs{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const n=new Map;this.keySegments().flat().forEach((s,o)=>{n.set(s.toBase58(),o)});const i=s=>{const o=n.get(s.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(s=>({programIdIndex:i(s.programId),accountKeyIndexes:s.keys.map(o=>i(o.pubkey)),data:s.data}))}}const be=(r="publicKey")=>ve(32,r),eb=(r="signature")=>ve(64,r),Mr=(r="string")=>{const e=z([F("length"),F("lengthPadding"),ve(tn(F(),-8),"chars")],r),t=e.decode.bind(e),n=e.encode.bind(e),i=e;return i.decode=(s,o)=>t(s,o).chars.toString(),i.encode=(s,o,a)=>{const c={chars:D.Buffer.from(s,"utf8")};return n(c,o,a)},i.alloc=s=>F().span+F().span+D.Buffer.from(s,"utf8").length,i},tb=(r="authorized")=>z([be("staker"),be("withdrawer")],r),nb=(r="lockup")=>z([We("unixTimestamp"),We("epoch"),be("custodian")],r),rb=(r="voteInit")=>z([be("nodePubkey"),be("authorizedVoter"),be("authorizedWithdrawer"),ie("commission")],r),ib=(r="voteAuthorizeWithSeedArgs")=>z([F("voteAuthorizationType"),be("currentAuthorityDerivedKeyOwnerPubkey"),Mr("currentAuthorityDerivedKeySeed"),be("newAuthorized")],r);function hh(r,e){const t=i=>{if(i.span>=0)return i.span;if(typeof i.alloc=="function")return i.alloc(e[i.property]);if("count"in i&&"elementLayout"in i){const s=e[i.property];if(Array.isArray(s))return s.length*t(i.elementLayout)}else if("fields"in i)return hh({layout:i},e[i.property]);return 0};let n=0;return r.layout.fields.forEach(i=>{n+=t(i)}),n}function zt(r){let e=0,t=0;for(;;){let n=r.shift();if(e|=(n&127)<<t*7,t+=1,(n&128)===0)break}return e}function Jt(r,e){let t=e;for(;;){let n=t&127;if(t>>=7,t==0){r.push(n);break}else n|=128,r.push(n)}}function Ie(r,e){if(!r)throw new Error(e||"Assertion failed")}class Ta{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const n=new Map,i=o=>{const a=o.toBase58();let c=n.get(a);return c===void 0&&(c={isSigner:!1,isWritable:!1,isInvoked:!1},n.set(a,c)),c},s=i(t);s.isSigner=!0,s.isWritable=!0;for(const o of e){i(o.programId).isInvoked=!0;for(const a of o.keys){const c=i(a.pubkey);c.isSigner||=a.isSigner,c.isWritable||=a.isWritable}}return new Ta(t,n)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];Ie(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,c])=>c.isSigner&&c.isWritable),n=e.filter(([,c])=>c.isSigner&&!c.isWritable),i=e.filter(([,c])=>!c.isSigner&&c.isWritable),s=e.filter(([,c])=>!c.isSigner&&!c.isWritable),o={numRequiredSignatures:t.length+n.length,numReadonlySignedAccounts:n.length,numReadonlyUnsignedAccounts:s.length};{Ie(t.length>0,"Expected at least one writable signer key");const[c]=t[0];Ie(c===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...t.map(([c])=>new Y(c)),...n.map(([c])=>new Y(c)),...i.map(([c])=>new Y(c)),...s.map(([c])=>new Y(c))];return[o,a]}extractTableLookup(e){const[t,n]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[i,s]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&i.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:i},{writable:n,readonly:s}]}drainKeysFoundInLookupTable(e,t){const n=new Array,i=new Array;for(const[s,o]of this.keyMetaMap.entries())if(t(o)){const a=new Y(s),c=e.findIndex(l=>l.equals(a));c>=0&&(Ie(c<256,"Max lookup table index exceeded"),n.push(c),i.push(a),this.keyMetaMap.delete(s))}return[n,i]}}class Sn{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new Y(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:ge.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new Cs(this.staticAccountKeys)}static compile(e){const t=Ta.compile(e.instructions,e.payerKey),[n,i]=t.getMessageComponents(),o=new Cs(i).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:ge.encode(a.data)}));return new Sn({header:n,accountKeys:i,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const n=e-t,s=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return n<s}else{const n=t-this.header.numReadonlySignedAccounts;return e<n}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];Jt(t,e);const n=this.instructions.map(h=>{const{accounts:b,programIdIndex:w}=h,k=Array.from(ge.decode(h.data));let g=[];Jt(g,b.length);let _=[];return Jt(_,k.length),{programIdIndex:w,keyIndicesCount:D.Buffer.from(g),keyIndices:b,dataLength:D.Buffer.from(_),data:k}});let i=[];Jt(i,n.length);let s=D.Buffer.alloc(dr);D.Buffer.from(i).copy(s);let o=i.length;n.forEach(h=>{o+=z([ie("programIdIndex"),ve(h.keyIndicesCount.length,"keyIndicesCount"),Fe(ie("keyIndex"),h.keyIndices.length,"keyIndices"),ve(h.dataLength.length,"dataLength"),Fe(ie("userdatum"),h.data.length,"data")]).encode(h,s,o)}),s=s.slice(0,o);const a=z([ve(1,"numRequiredSignatures"),ve(1,"numReadonlySignedAccounts"),ve(1,"numReadonlyUnsignedAccounts"),ve(t.length,"keyCount"),Fe(be("key"),e,"keys"),be("recentBlockhash")]),c={numRequiredSignatures:D.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:D.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:D.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:D.Buffer.from(t),keys:this.accountKeys.map(h=>pe(h.toBytes())),recentBlockhash:ge.decode(this.recentBlockhash)};let l=D.Buffer.alloc(2048);const u=a.encode(c,l);return s.copy(l,u),l.slice(0,u+s.length)}static from(e){let t=[...e];const n=t.shift();if(n!==(n&Pa))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const i=t.shift(),s=t.shift(),o=zt(t);let a=[];for(let b=0;b<o;b++){const w=t.slice(0,en);t=t.slice(en),a.push(new Y(D.Buffer.from(w)))}const c=t.slice(0,en);t=t.slice(en);const l=zt(t);let u=[];for(let b=0;b<l;b++){const w=t.shift(),k=zt(t),g=t.slice(0,k);t=t.slice(k);const _=zt(t),I=t.slice(0,_),L=ge.encode(D.Buffer.from(I));t=t.slice(_),u.push({programIdIndex:w,accounts:g,data:L})}const h={header:{numRequiredSignatures:n,numReadonlySignedAccounts:i,numReadonlyUnsignedAccounts:s},recentBlockhash:ge.encode(D.Buffer.from(c)),accountKeys:a,instructions:u};return new Sn(h)}}class Vr{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new Cs(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,n=this.staticAccountKeys.length;if(e>=n){const i=e-n,s=this.addressTableLookups.reduce((o,a)=>o+a.writableIndexes.length,0);return i<s}else if(e>=this.header.numRequiredSignatures){const i=e-t,o=n-t-this.header.numReadonlyUnsignedAccounts;return i<o}else{const i=t-this.header.numReadonlySignedAccounts;return e<i}}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const n of this.addressTableLookups){const i=e.find(s=>s.key.equals(n.accountKey));if(!i)throw new Error(`Failed to find address lookup table account for table key ${n.accountKey.toBase58()}`);for(const s of n.writableIndexes)if(s<i.state.addresses.length)t.writable.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${n.accountKey.toBase58()}`);for(const s of n.readonlyIndexes)if(s<i.state.addresses.length)t.readonly.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${n.accountKey.toBase58()}`)}return t}static compile(e){const t=Ta.compile(e.instructions,e.payerKey),n=new Array,i={writable:new Array,readonly:new Array},s=e.addressLookupTableAccounts||[];for(const u of s){const h=t.extractTableLookup(u);if(h!==void 0){const[b,{writable:w,readonly:k}]=h;n.push(b),i.writable.push(...w),i.readonly.push(...k)}}const[o,a]=t.getMessageComponents(),l=new Cs(a,i).compileInstructions(e.instructions);return new Vr({header:o,staticAccountKeys:a,recentBlockhash:e.recentBlockhash,compiledInstructions:l,addressTableLookups:n})}serialize(){const e=Array();Jt(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),n=Array();Jt(n,this.compiledInstructions.length);const i=this.serializeAddressTableLookups(),s=Array();Jt(s,this.addressTableLookups.length);const o=z([ie("prefix"),z([ie("numRequiredSignatures"),ie("numReadonlySignedAccounts"),ie("numReadonlyUnsignedAccounts")],"header"),ve(e.length,"staticAccountKeysLength"),Fe(be(),this.staticAccountKeys.length,"staticAccountKeys"),be("recentBlockhash"),ve(n.length,"instructionsLength"),ve(t.length,"serializedInstructions"),ve(s.length,"addressTableLookupsLength"),ve(i.length,"serializedAddressTableLookups")]),a=new Uint8Array(dr),c=1<<7,l=o.encode({prefix:c,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(u=>u.toBytes()),recentBlockhash:ge.decode(this.recentBlockhash),instructionsLength:new Uint8Array(n),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(s),serializedAddressTableLookups:i},a);return a.slice(0,l)}serializeInstructions(){let e=0;const t=new Uint8Array(dr);for(const n of this.compiledInstructions){const i=Array();Jt(i,n.accountKeyIndexes.length);const s=Array();Jt(s,n.data.length),e+=z([ie("programIdIndex"),ve(i.length,"encodedAccountKeyIndexesLength"),Fe(ie(),n.accountKeyIndexes.length,"accountKeyIndexes"),ve(s.length,"encodedDataLength"),ve(n.data.length,"data")]).encode({programIdIndex:n.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(i),accountKeyIndexes:n.accountKeyIndexes,encodedDataLength:new Uint8Array(s),data:n.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(dr);for(const n of this.addressTableLookups){const i=Array();Jt(i,n.writableIndexes.length);const s=Array();Jt(s,n.readonlyIndexes.length),e+=z([be("accountKey"),ve(i.length,"encodedWritableIndexesLength"),Fe(ie(),n.writableIndexes.length,"writableIndexes"),ve(s.length,"encodedReadonlyIndexesLength"),Fe(ie(),n.readonlyIndexes.length,"readonlyIndexes")]).encode({accountKey:n.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(i),writableIndexes:n.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(s),readonlyIndexes:n.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const n=t.shift(),i=n&Pa;Ie(n!==i,"Expected versioned message but received legacy message");const s=i;Ie(s===0,`Expected versioned message with version 0 but found version ${s}`);const o={numRequiredSignatures:t.shift(),numReadonlySignedAccounts:t.shift(),numReadonlyUnsignedAccounts:t.shift()},a=[],c=zt(t);for(let k=0;k<c;k++)a.push(new Y(t.splice(0,en)));const l=ge.encode(t.splice(0,en)),u=zt(t),h=[];for(let k=0;k<u;k++){const g=t.shift(),_=zt(t),I=t.splice(0,_),L=zt(t),G=new Uint8Array(t.splice(0,L));h.push({programIdIndex:g,accountKeyIndexes:I,data:G})}const b=zt(t),w=[];for(let k=0;k<b;k++){const g=new Y(t.splice(0,en)),_=zt(t),I=t.splice(0,_),L=zt(t),G=t.splice(0,L);w.push({accountKey:g,writableIndexes:I,readonlyIndexes:G})}return new Vr({header:o,staticAccountKeys:a,recentBlockhash:l,compiledInstructions:h,addressTableLookups:w})}}const el={deserializeMessageVersion(r){const e=r[0],t=e&Pa;return t===e?"legacy":t},deserialize:r=>{const e=el.deserializeMessageVersion(r);if(e==="legacy")return Sn.from(r);if(e===0)return Vr.deserialize(r);throw new Error(`Transaction message version ${e} deserialization is not supported`)}};let Wn=function(r){return r[r.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",r[r.PROCESSED=1]="PROCESSED",r[r.TIMED_OUT=2]="TIMED_OUT",r[r.NONCE_INVALID=3]="NONCE_INVALID",r}({});const sb=D.Buffer.alloc(xi).fill(0);class De{constructor(e){this.keys=void 0,this.programId=void 0,this.data=D.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:n})=>({pubkey:e.toJSON(),isSigner:t,isWritable:n})),programId:this.programId.toJSON(),data:[...this.data]}}}class xe{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:n}=e;this.minNonceContextSlot=t,this.nonceInfo=n}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:n}=e;this.recentBlockhash=t,this.lastValidBlockHeight=n}else{const{recentBlockhash:t,nonceInfo:n}=e;n&&(this.nonceInfo=n),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new De(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let n;if(this.feePayer)n=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)n=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let g=0;g<t.length;g++)if(t[g].programId===void 0)throw new Error(`Transaction instruction index ${g} has undefined program id`);const i=[],s=[];t.forEach(g=>{g.keys.forEach(I=>{s.push({...I})});const _=g.programId.toString();i.includes(_)||i.push(_)}),i.forEach(g=>{s.push({pubkey:new Y(g),isSigner:!1,isWritable:!1})});const o=[];s.forEach(g=>{const _=g.pubkey.toString(),I=o.findIndex(L=>L.pubkey.toString()===_);I>-1?(o[I].isWritable=o[I].isWritable||g.isWritable,o[I].isSigner=o[I].isSigner||g.isSigner):o.push(g)}),o.sort(function(g,_){if(g.isSigner!==_.isSigner)return g.isSigner?-1:1;if(g.isWritable!==_.isWritable)return g.isWritable?-1:1;const I={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return g.pubkey.toBase58().localeCompare(_.pubkey.toBase58(),"en",I)});const a=o.findIndex(g=>g.pubkey.equals(n));if(a>-1){const[g]=o.splice(a,1);g.isSigner=!0,g.isWritable=!0,o.unshift(g)}else o.unshift({pubkey:n,isSigner:!0,isWritable:!0});for(const g of this.signatures){const _=o.findIndex(I=>I.pubkey.equals(g.publicKey));if(_>-1)o[_].isSigner||(o[_].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${g.publicKey.toString()}`)}let c=0,l=0,u=0;const h=[],b=[];o.forEach(({pubkey:g,isSigner:_,isWritable:I})=>{_?(h.push(g.toString()),c+=1,I||(l+=1)):(b.push(g.toString()),I||(u+=1))});const w=h.concat(b),k=t.map(g=>{const{data:_,programId:I}=g;return{programIdIndex:w.indexOf(I.toString()),accounts:g.keys.map(L=>w.indexOf(L.pubkey.toString())),data:ge.encode(_)}});return k.forEach(g=>{Ie(g.programIdIndex>=0),g.accounts.forEach(_=>Ie(_>=0))}),new Sn({header:{numRequiredSignatures:c,numReadonlySignedAccounts:l,numReadonlyUnsignedAccounts:u},accountKeys:w,recentBlockhash:e,instructions:k})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((i,s)=>t[s].equals(i.publicKey))||(this.signatures=t.map(n=>({signature:null,publicKey:n}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(n=>{const i=n.toString();return t.has(i)?!1:(t.add(i),!0)}).map(n=>({signature:null,publicKey:n}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}this.signatures=n.map(s=>({signature:null,publicKey:s.publicKey}));const i=this._compile();this._partialSign(i,...n)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}const i=this._compile();this._partialSign(i,...n)}_partialSign(e,...t){const n=e.serialize();t.forEach(i=>{const s=Qu(n,i.secretKey);this._addSignature(i.publicKey,pe(s))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){Ie(t.length===64);const n=this.signatures.findIndex(i=>e.equals(i.publicKey));if(n<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[n].signature=D.Buffer.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:n,publicKey:i}of this.signatures)if(n===null){if(t)return!1}else if(!Ym(n,e,i.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:n}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),i=this.serializeMessage();if(n&&!this._verifySignatures(i,t))throw new Error("Signature verification failed");return this._serialize(i)}_serialize(e){const{signatures:t}=this,n=[];Jt(n,t.length);const i=n.length+t.length*64+e.length,s=D.Buffer.alloc(i);return Ie(t.length<256),D.Buffer.from(n).copy(s,0),t.forEach(({signature:o},a)=>{o!==null&&(Ie(o.length===64,"signature has invalid length"),D.Buffer.from(o).copy(s,n.length+a*64))}),e.copy(s,n.length+t.length*64),Ie(s.length<=dr,`Transaction too large: ${s.length} > ${dr}`),s}get keys(){return Ie(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return Ie(this.instructions.length===1),this.instructions[0].programId}get data(){return Ie(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const n=zt(t);let i=[];for(let s=0;s<n;s++){const o=t.slice(0,xi);t=t.slice(xi),i.push(ge.encode(D.Buffer.from(o)))}return xe.populate(Sn.from(t),i)}static populate(e,t=[]){const n=new xe;return n.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(n.feePayer=e.accountKeys[0]),t.forEach((i,s)=>{const o={signature:i==ge.encode(sb)?null:ge.decode(i),publicKey:e.accountKeys[s]};n.signatures.push(o)}),e.instructions.forEach(i=>{const s=i.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:n.signatures.some(c=>c.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});n.instructions.push(new De({keys:s,programId:e.accountKeys[i.programIdIndex],data:ge.decode(i.data)}))}),n._message=e,n._json=n.toJSON(),n}}class tl{constructor(e){this.payerKey=void 0,this.instructions=void 0,this.recentBlockhash=void 0,this.payerKey=e.payerKey,this.instructions=e.instructions,this.recentBlockhash=e.recentBlockhash}static decompile(e,t){const{header:n,compiledInstructions:i,recentBlockhash:s}=e,{numRequiredSignatures:o,numReadonlySignedAccounts:a,numReadonlyUnsignedAccounts:c}=n,l=o-a;Ie(l>0,"Message header is invalid");const u=e.staticAccountKeys.length-o-c;Ie(u>=0,"Message header is invalid");const h=e.getAccountKeys(t),b=h.get(0);if(b===void 0)throw new Error("Failed to decompile message because no account keys were found");const w=[];for(const k of i){const g=[];for(const I of k.accountKeyIndexes){const L=h.get(I);if(L===void 0)throw new Error(`Failed to find key for account key index ${I}`);const G=I<o;let $;G?$=I<l:I<h.staticAccountKeys.length?$=I-o<u:$=I-h.staticAccountKeys.length<h.accountKeysFromLookups.writable.length,g.push({pubkey:L,isSigner:I<n.numRequiredSignatures,isWritable:$})}const _=h.get(k.programIdIndex);if(_===void 0)throw new Error(`Failed to find program id for program id index ${k.programIdIndex}`);w.push(new De({programId:_,data:pe(k.data),keys:g}))}return new tl({payerKey:b,instructions:w,recentBlockhash:s})}compileToLegacyMessage(){return Sn.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions})}compileToV0Message(e){return Vr.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions,addressLookupTableAccounts:e})}}class nl{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,t!==void 0)Ie(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{const n=[];for(let i=0;i<e.header.numRequiredSignatures;i++)n.push(new Uint8Array(xi));this.signatures=n}this.message=e}serialize(){const e=this.message.serialize(),t=Array();Jt(t,this.signatures.length);const n=z([ve(t.length,"encodedSignaturesLength"),Fe(eb(),this.signatures.length,"signatures"),ve(e.length,"serializedMessage")]),i=new Uint8Array(2048),s=n.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},i);return i.slice(0,s)}static deserialize(e){let t=[...e];const n=[],i=zt(t);for(let o=0;o<i;o++)n.push(new Uint8Array(t.splice(0,xi)));const s=el.deserialize(new Uint8Array(t));return new nl(s,n)}sign(e){const t=this.message.serialize(),n=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const i of e){const s=n.findIndex(o=>o.equals(i.publicKey));Ie(s>=0,`Cannot sign with non signer key ${i.publicKey.toBase58()}`),this.signatures[s]=Qu(t,i.secretKey)}}addSignature(e,t){Ie(t.byteLength===64,"Signature must be 64 bytes long");const i=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(s=>s.equals(e));Ie(i>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[i]=t}}const ob=160,ab=64,cb=ob/ab,ph=1e3/cb,Rn=new Y("SysvarC1ock11111111111111111111111111111111"),ub=new Y("SysvarEpochSchedu1e111111111111111111111111"),lb=new Y("Sysvar1nstructions1111111111111111111111111"),No=new Y("SysvarRecentB1ockHashes11111111111111111111"),Mi=new Y("SysvarRent111111111111111111111111111111111"),db=new Y("SysvarRewards111111111111111111111111111111"),fb=new Y("SysvarS1otHashes111111111111111111111111111"),hb=new Y("SysvarS1otHistory11111111111111111111111111"),Do=new Y("SysvarStakeHistory1111111111111111111111111");async function uu(r,e,t,n){const i=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot},s=await r.sendTransaction(e,t,i);let o;if(e.recentBlockhash!=null&&e.lastValidBlockHeight!=null)o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,signature:s,blockhash:e.recentBlockhash,lastValidBlockHeight:e.lastValidBlockHeight},n&&n.commitment)).value;else if(e.minNonceContextSlot!=null&&e.nonceInfo!=null){const{nonceInstruction:a}=e.nonceInfo,c=a.keys[0].pubkey;o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,minContextSlot:e.minNonceContextSlot,nonceAccountPubkey:c,nonceValue:e.nonceInfo.nonce,signature:s},n&&n.commitment)).value}else(n==null?void 0:n.abortSignal)!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),o=(await r.confirmTransaction(s,n&&n.commitment)).value;if(o.err)throw new Error(`Transaction ${s} failed (${JSON.stringify(o)})`);return s}function Br(r){return new Promise(e=>setTimeout(e,r))}function _e(r,e){const t=r.layout.span>=0?r.layout.span:hh(r,e),n=D.Buffer.alloc(t),i=Object.assign({instruction:r.index},e);return r.layout.encode(i,n),n}function Re(r,e){let t;try{t=r.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.instruction!==r.index)throw new Error(`invalid instruction; instruction index mismatch ${t.instruction} != ${r.index}`);return t}const yh=ke("lamportsPerSignature"),gh=z([F("version"),F("state"),be("authorizedPubkey"),be("nonce"),z([yh],"feeCalculator")]),lu=gh.span;class Ba{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=gh.decode(pe(e),0);return new Ba({authorizedPubkey:new Y(t.authorizedPubkey),nonce:new Y(t.nonce).toString(),feeCalculator:t.feeCalculator})}}const pb=r=>{const e=r.decode.bind(r),t=r.encode.bind(r);return{decode:e,encode:t}},yb=r=>e=>{const t=ve(r,e),{encode:n,decode:i}=pb(t),s=t;return s.decode=(o,a)=>{const c=i(o,a);return wf(D.Buffer.from(c))},s.encode=(o,a,c)=>{const l=Du(o,r);return n(l,a,c)},s},Ci=yb(8);class gb{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=F("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Ve))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a SystemInstruction");return i}static decodeCreateAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t,space:n,programId:i}=Re(Ve.Create,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,lamports:t,space:n,programId:new Y(i)}}static decodeTransfer(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t}=Re(Ve.Transfer,e.data);return{fromPubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,lamports:t}}static decodeTransferWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t,seed:n,programId:i}=Re(Ve.TransferWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,basePubkey:e.keys[1].pubkey,toPubkey:e.keys[2].pubkey,lamports:t,seed:n,programId:new Y(i)}}static decodeAllocate(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{space:t}=Re(Ve.Allocate,e.data);return{accountPubkey:e.keys[0].pubkey,space:t}}static decodeAllocateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:n,space:i,programId:s}=Re(Ve.AllocateWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new Y(t),seed:n,space:i,programId:new Y(s)}}static decodeAssign(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{programId:t}=Re(Ve.Assign,e.data);return{accountPubkey:e.keys[0].pubkey,programId:new Y(t)}}static decodeAssignWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:n,programId:i}=Re(Ve.AssignWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new Y(t),seed:n,programId:new Y(i)}}static decodeCreateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{base:t,seed:n,lamports:i,space:s,programId:o}=Re(Ve.CreateWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,basePubkey:new Y(t),seed:n,lamports:i,space:s,programId:new Y(o)}}static decodeNonceInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{authorized:t}=Re(Ve.InitializeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:new Y(t)}}static decodeNonceAdvance(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Re(Ve.AdvanceNonceAccount,e.data),{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static decodeNonceWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Re(Ve.WithdrawNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t}}static decodeNonceAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t}=Re(Ve.AuthorizeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[1].pubkey,newAuthorizedPubkey:new Y(t)}}static checkProgramId(e){if(!e.equals(At.programId))throw new Error("invalid instruction; programId is not SystemProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const Ve=Object.freeze({Create:{index:0,layout:z([F("instruction"),We("lamports"),We("space"),be("programId")])},Assign:{index:1,layout:z([F("instruction"),be("programId")])},Transfer:{index:2,layout:z([F("instruction"),Ci("lamports")])},CreateWithSeed:{index:3,layout:z([F("instruction"),be("base"),Mr("seed"),We("lamports"),We("space"),be("programId")])},AdvanceNonceAccount:{index:4,layout:z([F("instruction")])},WithdrawNonceAccount:{index:5,layout:z([F("instruction"),We("lamports")])},InitializeNonceAccount:{index:6,layout:z([F("instruction"),be("authorized")])},AuthorizeNonceAccount:{index:7,layout:z([F("instruction"),be("authorized")])},Allocate:{index:8,layout:z([F("instruction"),We("space")])},AllocateWithSeed:{index:9,layout:z([F("instruction"),be("base"),Mr("seed"),We("space"),be("programId")])},AssignWithSeed:{index:10,layout:z([F("instruction"),be("base"),Mr("seed"),be("programId")])},TransferWithSeed:{index:11,layout:z([F("instruction"),Ci("lamports"),Mr("seed"),be("programId")])},UpgradeNonceAccount:{index:12,layout:z([F("instruction")])}});class At{constructor(){}static createAccount(e){const t=Ve.Create,n=_e(t,{lamports:e.lamports,space:e.space,programId:pe(e.programId.toBuffer())});return new De({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:n})}static transfer(e){let t,n;if("basePubkey"in e){const i=Ve.TransferWithSeed;t=_e(i,{lamports:BigInt(e.lamports),seed:e.seed,programId:pe(e.programId.toBuffer())}),n=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}else{const i=Ve.Transfer;t=_e(i,{lamports:BigInt(e.lamports)}),n=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}return new De({keys:n,programId:this.programId,data:t})}static assign(e){let t,n;if("basePubkey"in e){const i=Ve.AssignWithSeed;t=_e(i,{base:pe(e.basePubkey.toBuffer()),seed:e.seed,programId:pe(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=Ve.Assign;t=_e(i,{programId:pe(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new De({keys:n,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=Ve.CreateWithSeed,n=_e(t,{base:pe(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:pe(e.programId.toBuffer())});let i=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey!=e.fromPubkey&&i.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new De({keys:i,programId:this.programId,data:n})}static createNonceAccount(e){const t=new xe;"basePubkey"in e&&"seed"in e?t.add(At.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:lu,programId:this.programId})):t.add(At.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:lu,programId:this.programId}));const n={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(n)),t}static nonceInitialize(e){const t=Ve.InitializeNonceAccount,n=_e(t,{authorized:pe(e.authorizedPubkey.toBuffer())}),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:No,isSigner:!1,isWritable:!1},{pubkey:Mi,isSigner:!1,isWritable:!1}],programId:this.programId,data:n};return new De(i)}static nonceAdvance(e){const t=Ve.AdvanceNonceAccount,n=_e(t),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:No,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n};return new De(i)}static nonceWithdraw(e){const t=Ve.WithdrawNonceAccount,n=_e(t,{lamports:e.lamports});return new De({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:No,isSigner:!1,isWritable:!1},{pubkey:Mi,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static nonceAuthorize(e){const t=Ve.AuthorizeNonceAccount,n=_e(t,{authorized:pe(e.newAuthorizedPubkey.toBuffer())});return new De({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static allocate(e){let t,n;if("basePubkey"in e){const i=Ve.AllocateWithSeed;t=_e(i,{base:pe(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:pe(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=Ve.Allocate;t=_e(i,{space:e.space}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new De({keys:n,programId:this.programId,data:t})}}At.programId=new Y("11111111111111111111111111111111");const mb=dr-300;class zr{constructor(){}static getMinNumSignatures(e){return 2*(Math.ceil(e/zr.chunkSize)+1+1)}static async load(e,t,n,i,s){{const h=await e.getMinimumBalanceForRentExemption(s.length),b=await e.getAccountInfo(n.publicKey,"confirmed");let w=null;if(b!==null){if(b.executable)return console.error("Program load failed, account is already executable"),!1;b.data.length!==s.length&&(w=w||new xe,w.add(At.allocate({accountPubkey:n.publicKey,space:s.length}))),b.owner.equals(i)||(w=w||new xe,w.add(At.assign({accountPubkey:n.publicKey,programId:i}))),b.lamports<h&&(w=w||new xe,w.add(At.transfer({fromPubkey:t.publicKey,toPubkey:n.publicKey,lamports:h-b.lamports})))}else w=new xe().add(At.createAccount({fromPubkey:t.publicKey,newAccountPubkey:n.publicKey,lamports:h>0?h:1,space:s.length,programId:i}));w!==null&&await uu(e,w,[t,n],{commitment:"confirmed"})}const o=z([F("instruction"),F("offset"),F("bytesLength"),F("bytesLengthPadding"),Fe(ie("byte"),tn(F(),-8),"bytes")]),a=zr.chunkSize;let c=0,l=s,u=[];for(;l.length>0;){const h=l.slice(0,a),b=D.Buffer.alloc(a+16);o.encode({instruction:0,offset:c,bytes:h,bytesLength:0,bytesLengthPadding:0},b);const w=new xe().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0}],programId:i,data:b});u.push(uu(e,w,[t,n],{commitment:"confirmed"})),e._rpcEndpoint.includes("solana.com")&&await Br(1e3/4),c+=a,l=l.slice(a)}await Promise.all(u);{const h=z([F("instruction")]),b=D.Buffer.alloc(h.span);h.encode({instruction:1},b);const w=new xe().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0},{pubkey:Mi,isSigner:!1,isWritable:!1}],programId:i,data:b}),k="processed",g=await e.sendTransaction(w,[t,n],{preflightCommitment:k}),{context:_,value:I}=await e.confirmTransaction({signature:g,lastValidBlockHeight:w.lastValidBlockHeight,blockhash:w.recentBlockhash},k);if(I.err)throw new Error(`Transaction ${g} failed (${JSON.stringify(I)})`);for(;;){try{if(await e.getSlot({commitment:k})>_.slot)break}catch{}await new Promise(L=>setTimeout(L,Math.round(ph/2)))}}return!0}}zr.chunkSize=mb;const bb=new Y("BPFLoader2111111111111111111111111111111111");class vb{static getMinNumSignatures(e){return zr.getMinNumSignatures(e)}static load(e,t,n,i,s){return zr.load(e,t,n,s,i)}}function wb(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var _b=Object.prototype.toString,Ab=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};function ys(r,e){var t,n,i,s,o,a,c;if(r===!0)return"true";if(r===!1)return"false";switch(typeof r){case"object":if(r===null)return null;if(r.toJSON&&typeof r.toJSON=="function")return ys(r.toJSON(),e);if(c=_b.call(r),c==="[object Array]"){for(i="[",n=r.length-1,t=0;t<n;t++)i+=ys(r[t],!0)+",";return n>-1&&(i+=ys(r[t],!0)),i+"]"}else if(c==="[object Object]"){for(s=Ab(r).sort(),n=s.length,i="",t=0;t<n;)o=s[t],a=ys(r[o],!1),a!==void 0&&(i&&(i+=","),i+=JSON.stringify(o)+":"+a),t++;return"{"+i+"}"}else return JSON.stringify(r);case"function":case"undefined":return e?null:void 0;case"string":return JSON.stringify(r);default:return isFinite(r)?r:null}}var Sb=function(r){var e=ys(r,!1);if(e!==void 0)return""+e},sd=wb(Sb);const fs=32;function Mc(r){let e=0;for(;r>1;)r/=2,e++;return e}function kb(r){return r===0?1:(r--,r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16,r|=r>>32,r+1)}class mh{constructor(e,t,n,i,s){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=n,this.firstNormalEpoch=i,this.firstNormalSlot=s}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const t=Mc(kb(e+fs+1))-Mc(fs)-1,n=this.getSlotsInEpoch(t),i=e-(n-fs);return[t,i]}else{const t=e-this.firstNormalSlot,n=Math.floor(t/this.slotsPerEpoch),i=this.firstNormalEpoch+n,s=t%this.slotsPerEpoch;return[i,s]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*fs:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+Mc(fs)):this.slotsPerEpoch}}class du extends Error{constructor(e,t){super(e),this.logs=void 0,this.logs=t}}const Ib={JSON_RPC_SERVER_ERROR_BLOCK_CLEANED_UP:-32001,JSON_RPC_SERVER_ERROR_SEND_TRANSACTION_PREFLIGHT_FAILURE:-32002,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_VERIFICATION_FAILURE:-32003,JSON_RPC_SERVER_ERROR_BLOCK_NOT_AVAILABLE:-32004,JSON_RPC_SERVER_ERROR_NODE_UNHEALTHY:-32005,JSON_RPC_SERVER_ERROR_TRANSACTION_PRECOMPILE_VERIFICATION_FAILURE:-32006,JSON_RPC_SERVER_ERROR_SLOT_SKIPPED:-32007,JSON_RPC_SERVER_ERROR_NO_SNAPSHOT:-32008,JSON_RPC_SERVER_ERROR_LONG_TERM_STORAGE_SLOT_SKIPPED:-32009,JSON_RPC_SERVER_ERROR_KEY_EXCLUDED_FROM_SECONDARY_INDEX:-32010,JSON_RPC_SERVER_ERROR_TRANSACTION_HISTORY_NOT_AVAILABLE:-32011,JSON_RPC_SCAN_ERROR:-32012,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_LEN_MISMATCH:-32013,JSON_RPC_SERVER_ERROR_BLOCK_STATUS_NOT_AVAILABLE_YET:-32014,JSON_RPC_SERVER_ERROR_UNSUPPORTED_TRANSACTION_VERSION:-32015,JSON_RPC_SERVER_ERROR_MIN_CONTEXT_SLOT_NOT_REACHED:-32016};class te extends Error{constructor({code:e,message:t,data:n},i){super(i!=null?`${i}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=n,this.name="SolanaJSONRPCError"}}var Eb=globalThis.fetch;class Ob extends gg{constructor(e,t,n){const i=s=>{const o=bg(s,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in o?this.underlyingSocket=o.socket:this.underlyingSocket=o,o};super(i,e,t,n),this.underlyingSocket=void 0}call(...e){var n;const t=(n=this.underlyingSocket)==null?void 0:n.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){var n;const t=(n=this.underlyingSocket)==null?void 0:n.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}function Pb(r,e){let t;try{t=r.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.typeIndex!==r.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${r.index}`);return t}const od=56;class fu{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=Pb(Tb,e),n=e.length-od;Ie(n>=0,"lookup table is invalid"),Ie(n%32===0,"lookup table is invalid");const i=n/32,{addresses:s}=z([Fe(be(),i,"addresses")]).decode(e.slice(od));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new Y(t.authority[0]):void 0,addresses:s.map(o=>new Y(o))}}}const Tb={index:1,layout:z([F("typeIndex"),Ci("deactivationSlot"),ke("lastExtendedSlot"),ie("lastExtendedStartIndex"),ie(),Fe(be(),tn(ie(),-1),"authority")])},Bb=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function Rb(r){const e=r.match(Bb);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${r}\``);const[t,n,i,s]=e,o=r.startsWith("https:")?"wss:":"ws:",a=i==null?null:parseInt(i.slice(1),10),c=a==null?"":`:${a+1}`;return`${o}//${n}${c}${s}`}const at=Un(Yi(Y),P(),r=>new Y(r)),bh=Qi([P(),ce("base64")]),rl=Un(Yi(D.Buffer),bh,r=>D.Buffer.from(r[0],"base64")),vh=30*1e3;function xb(r){if(/^https?:/.test(r)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return r}function $e(r){let e,t;if(typeof r=="string")e=r;else if(r){const{commitment:n,...i}=r;e=n,t=i}return{commitment:e,config:t}}function wh(r){return Ce([A({jsonrpc:ce("2.0"),id:P(),result:r}),A({jsonrpc:ce("2.0"),id:P(),error:A({code:Fn(),message:P(),data:j(uh())})})])}const Mb=wh(Fn());function he(r){return Un(wh(r),Mb,e=>"error"in e?e:{...e,result:H(e.result,r)})}function Ze(r){return he(A({context:A({slot:y()}),value:r}))}function Ra(r){return A({context:A({slot:y()}),value:r})}function Cc(r,e){return r===0?new Vr({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new Y(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:ge.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new Sn(e)}const Cb=A({foundation:y(),foundationTerm:y(),initial:y(),taper:y(),terminal:y()}),Kb=he(C(x(A({epoch:y(),effectiveSlot:y(),amount:y(),postBalance:y(),commission:j(x(y()))})))),Lb=C(A({slot:y(),prioritizationFee:y()})),Nb=A({total:y(),validator:y(),foundation:y(),epoch:y()}),Db=A({epoch:y(),slotIndex:y(),slotsInEpoch:y(),absoluteSlot:y(),blockHeight:j(y()),transactionCount:j(y())}),Vb=A({slotsPerEpoch:y(),leaderScheduleSlotOffset:y(),warmup:ot(),firstNormalEpoch:y(),firstNormalSlot:y()}),zb=Oa(P(),C(y())),Jr=x(Ce([A({}),P()])),Fb=A({err:Jr}),Ub=ce("receivedSignature"),$b=A({"solana-core":P(),"feature-set":j(y())}),ad=Ze(A({err:x(Ce([A({}),P()])),logs:x(C(P())),accounts:j(x(C(x(A({executable:ot(),owner:P(),lamports:y(),data:C(P()),rentEpoch:j(y())}))))),unitsConsumed:j(y()),returnData:j(x(A({programId:P(),data:Qi([P(),ce("base64")])})))})),Wb=Ze(A({byIdentity:Oa(P(),C(y())),range:A({firstSlot:y(),lastSlot:y()})}));function jb(r,e,t,n,i,s){const o=t||Eb;let a;s!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let c;return n&&(c=async(u,h)=>{const b=await new Promise((w,k)=>{try{n(u,h,(g,_)=>w([g,_]))}catch(g){k(g)}});return await o(...b)}),new mg(async(u,h)=>{const b={method:"POST",body:u,agent:a,headers:Object.assign({"Content-Type":"application/json"},e||{},qv)};try{let w=5,k,g=500;for(;c?k=await c(r,b):k=await o(r,b),!(k.status!==429||i===!0||(w-=1,w===0));)console.log(`Server responded with ${k.status} ${k.statusText}.  Retrying after ${g}ms delay...`),await Br(g),g*=2;const _=await k.text();k.ok?h(null,_):h(new Error(`${k.status} ${k.statusText}: ${_}`))}catch(w){w instanceof Error&&h(w)}},{})}function qb(r){return(e,t)=>new Promise((n,i)=>{r.request(e,t,(s,o)=>{if(s){i(s);return}n(o)})})}function Gb(r){return e=>new Promise((t,n)=>{e.length===0&&t([]);const i=e.map(s=>r.request(s.methodName,s.args));r.request(i,(s,o)=>{if(s){n(s);return}t(o)})})}const Hb=he(Cb),Yb=he(Nb),Qb=he(Lb),Jb=he(Db),Xb=he(Vb),Zb=he(zb),ev=he(y()),tv=Ze(A({total:y(),circulating:y(),nonCirculating:y(),nonCirculatingAccounts:C(at)})),hu=A({amount:P(),uiAmount:x(y()),decimals:y(),uiAmountString:j(P())}),nv=Ze(C(A({address:at,amount:P(),uiAmount:x(y()),decimals:y(),uiAmountString:j(P())}))),rv=Ze(C(A({pubkey:at,account:A({executable:ot(),owner:at,lamports:y(),data:rl,rentEpoch:y()})}))),pu=A({program:P(),parsed:Fn(),space:y()}),iv=Ze(C(A({pubkey:at,account:A({executable:ot(),owner:at,lamports:y(),data:pu,rentEpoch:y()})}))),sv=Ze(C(A({lamports:y(),address:at}))),Ks=A({executable:ot(),owner:at,lamports:y(),data:rl,rentEpoch:y()}),ov=A({pubkey:at,account:Ks}),av=Un(Ce([Yi(D.Buffer),pu]),Ce([bh,pu]),r=>Array.isArray(r)?H(r,rl):r),yu=A({executable:ot(),owner:at,lamports:y(),data:av,rentEpoch:y()}),cv=A({pubkey:at,account:yu}),uv=A({state:Ce([ce("active"),ce("inactive"),ce("activating"),ce("deactivating")]),active:y(),inactive:y()}),lv=he(C(A({signature:P(),slot:y(),err:Jr,memo:x(P()),blockTime:j(x(y()))}))),dv=he(C(A({signature:P(),slot:y(),err:Jr,memo:x(P()),blockTime:j(x(y()))}))),fv=A({subscription:y(),result:Ra(Ks)}),hv=A({pubkey:at,account:Ks}),pv=A({subscription:y(),result:Ra(hv)}),yv=A({parent:y(),slot:y(),root:y()}),gv=A({subscription:y(),result:yv}),mv=Ce([A({type:Ce([ce("firstShredReceived"),ce("completed"),ce("optimisticConfirmation"),ce("root")]),slot:y(),timestamp:y()}),A({type:ce("createdBank"),parent:y(),slot:y(),timestamp:y()}),A({type:ce("frozen"),slot:y(),timestamp:y(),stats:A({numTransactionEntries:y(),numSuccessfulTransactions:y(),numFailedTransactions:y(),maxTransactionsPerEntry:y()})}),A({type:ce("dead"),slot:y(),timestamp:y(),err:P()})]),bv=A({subscription:y(),result:mv}),vv=A({subscription:y(),result:Ra(Ce([Fb,Ub]))}),wv=A({subscription:y(),result:y()}),_v=A({pubkey:P(),gossip:x(P()),tpu:x(P()),rpc:x(P()),version:x(P())}),cd=A({votePubkey:P(),nodePubkey:P(),activatedStake:y(),epochVoteAccount:ot(),epochCredits:C(Qi([y(),y(),y()])),commission:y(),lastVote:y(),rootSlot:x(y())}),Av=he(A({current:C(cd),delinquent:C(cd)})),Sv=Ce([ce("processed"),ce("confirmed"),ce("finalized")]),kv=A({slot:y(),confirmations:x(y()),err:Jr,confirmationStatus:j(Sv)}),Iv=Ze(C(x(kv))),Ev=he(y()),_h=A({accountKey:at,writableIndexes:C(y()),readonlyIndexes:C(y())}),il=A({signatures:C(P()),message:A({accountKeys:C(P()),header:A({numRequiredSignatures:y(),numReadonlySignedAccounts:y(),numReadonlyUnsignedAccounts:y()}),instructions:C(A({accounts:C(y()),data:P(),programIdIndex:y()})),recentBlockhash:P(),addressTableLookups:j(C(_h))})}),Ah=A({pubkey:at,signer:ot(),writable:ot(),source:j(Ce([ce("transaction"),ce("lookupTable")]))}),Sh=A({accountKeys:C(Ah),signatures:C(P())}),kh=A({parsed:Fn(),program:P(),programId:at}),Ih=A({accounts:C(at),data:P(),programId:at}),Ov=Ce([Ih,kh]),Pv=Ce([A({parsed:Fn(),program:P(),programId:P()}),A({accounts:C(P()),data:P(),programId:P()})]),Eh=Un(Ov,Pv,r=>"accounts"in r?H(r,Ih):H(r,kh)),Oh=A({signatures:C(P()),message:A({accountKeys:C(Ah),instructions:C(Eh),recentBlockhash:P(),addressTableLookups:j(x(C(_h)))})}),Qo=A({accountIndex:y(),mint:P(),owner:j(P()),uiTokenAmount:hu}),Ph=A({writable:C(at),readonly:C(at)}),xa=A({err:Jr,fee:y(),innerInstructions:j(x(C(A({index:y(),instructions:C(A({accounts:C(y()),data:P(),programIdIndex:y()}))})))),preBalances:C(y()),postBalances:C(y()),logMessages:j(x(C(P()))),preTokenBalances:j(x(C(Qo))),postTokenBalances:j(x(C(Qo))),loadedAddresses:j(Ph),computeUnitsConsumed:j(y())}),sl=A({err:Jr,fee:y(),innerInstructions:j(x(C(A({index:y(),instructions:C(Eh)})))),preBalances:C(y()),postBalances:C(y()),logMessages:j(x(C(P()))),preTokenBalances:j(x(C(Qo))),postTokenBalances:j(x(C(Qo))),loadedAddresses:j(Ph),computeUnitsConsumed:j(y())}),Ji=Ce([ce(0),ce("legacy")]),Xr=A({pubkey:P(),lamports:y(),postBalance:x(y()),rewardType:x(P()),commission:j(x(y()))}),Tv=he(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),transactions:C(A({transaction:il,meta:x(xa),version:j(Ji)})),rewards:j(C(Xr)),blockTime:x(y()),blockHeight:x(y())}))),Bv=he(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),rewards:j(C(Xr)),blockTime:x(y()),blockHeight:x(y())}))),Rv=he(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),transactions:C(A({transaction:Sh,meta:x(xa),version:j(Ji)})),rewards:j(C(Xr)),blockTime:x(y()),blockHeight:x(y())}))),xv=he(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),transactions:C(A({transaction:Oh,meta:x(sl),version:j(Ji)})),rewards:j(C(Xr)),blockTime:x(y()),blockHeight:x(y())}))),Mv=he(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),transactions:C(A({transaction:Sh,meta:x(sl),version:j(Ji)})),rewards:j(C(Xr)),blockTime:x(y()),blockHeight:x(y())}))),Cv=he(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),rewards:j(C(Xr)),blockTime:x(y()),blockHeight:x(y())}))),Kv=he(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),transactions:C(A({transaction:il,meta:x(xa)})),rewards:j(C(Xr)),blockTime:x(y())}))),ud=he(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),signatures:C(P()),blockTime:x(y())}))),Kc=he(x(A({slot:y(),meta:x(xa),blockTime:j(x(y())),transaction:il,version:j(Ji)}))),go=he(x(A({slot:y(),transaction:Oh,meta:x(sl),blockTime:j(x(y())),version:j(Ji)}))),Lv=Ze(A({blockhash:P(),feeCalculator:A({lamportsPerSignature:y()})})),Nv=Ze(A({blockhash:P(),lastValidBlockHeight:y()})),Dv=Ze(ot()),Vv=A({slot:y(),numTransactions:y(),numSlots:y(),samplePeriodSecs:y()}),zv=he(C(Vv)),Fv=Ze(x(A({feeCalculator:A({lamportsPerSignature:y()})}))),Uv=he(P()),$v=he(P()),Wv=A({err:Jr,logs:C(P()),signature:P()}),jv=A({result:Ra(Wv),subscription:y()}),qv={"solana-client":"js/0.0.0-development"};class Gv{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const l={};return async u=>{const{commitment:h,config:b}=$e(u),w=this._buildArgs([],h,void 0,b),k=sd(w);return l[k]=l[k]??(async()=>{try{const g=await this._rpcRequest("getBlockHeight",w),_=H(g,he(y()));if("error"in _)throw new te(_.error,"failed to get block height information");return _.result}finally{delete l[k]}})(),await l[k]}})();let n,i,s,o,a,c;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,n=t.wsEndpoint,i=t.httpHeaders,s=t.fetch,o=t.fetchMiddleware,a=t.disableRetryOnRateLimit,c=t.httpAgent),this._rpcEndpoint=xb(e),this._rpcWsEndpoint=n||Rb(e),this._rpcClient=jb(e,i,s,o,a,c),this._rpcRequest=qb(this._rpcClient),this._rpcBatchRequest=Gb(this._rpcClient),this._rpcWebSocket=new Ob(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:n,config:i}=$e(t),s=this._buildArgs([e.toBase58()],n,void 0,i),o=await this._rpcRequest("getBalance",s),a=H(o,Ze(y()));if("error"in a)throw new te(a.error,`failed to get balance for ${e.toBase58()}`);return a.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+n)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),n=H(t,he(x(y())));if("error"in n)throw new te(n.error,`failed to get block time for slot ${e}`);return n.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=H(e,he(y()));if("error"in t)throw new te(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=H(e,ev);if("error"in t)throw new te(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};const n=await this._rpcRequest("getSupply",[t]),i=H(n,tv);if("error"in i)throw new te(i.error,"failed to get supply");return i.result}async getTokenSupply(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenSupply",n),s=H(i,Ze(hu));if("error"in s)throw new te(s.error,"failed to get token supply");return s.result}async getTokenAccountBalance(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenAccountBalance",n),s=H(i,Ze(hu));if("error"in s)throw new te(s.error,"failed to get token account balance");return s.result}async getTokenAccountsByOwner(e,t,n){const{commitment:i,config:s}=$e(n);let o=[e.toBase58()];"mint"in t?o.push({mint:t.mint.toBase58()}):o.push({programId:t.programId.toBase58()});const a=this._buildArgs(o,i,"base64",s),c=await this._rpcRequest("getTokenAccountsByOwner",a),l=H(c,rv);if("error"in l)throw new te(l.error,`failed to get token accounts owned by account ${e.toBase58()}`);return l.result}async getParsedTokenAccountsByOwner(e,t,n){let i=[e.toBase58()];"mint"in t?i.push({mint:t.mint.toBase58()}):i.push({programId:t.programId.toBase58()});const s=this._buildArgs(i,n,"jsonParsed"),o=await this._rpcRequest("getTokenAccountsByOwner",s),a=H(o,iv);if("error"in a)throw new te(a.error,`failed to get token accounts owned by account ${e.toBase58()}`);return a.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},n=t.filter||t.commitment?[t]:[],i=await this._rpcRequest("getLargestAccounts",n),s=H(i,sv);if("error"in s)throw new te(s.error,"failed to get largest accounts");return s.result}async getTokenLargestAccounts(e,t){const n=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenLargestAccounts",n),s=H(i,nv);if("error"in s)throw new te(s.error,"failed to get token largest accounts");return s.result}async getAccountInfoAndContext(e,t){const{commitment:n,config:i}=$e(t),s=this._buildArgs([e.toBase58()],n,"base64",i),o=await this._rpcRequest("getAccountInfo",s),a=H(o,Ze(x(Ks)));if("error"in a)throw new te(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getParsedAccountInfo(e,t){const{commitment:n,config:i}=$e(t),s=this._buildArgs([e.toBase58()],n,"jsonParsed",i),o=await this._rpcRequest("getAccountInfo",s),a=H(o,Ze(x(yu)));if("error"in a)throw new te(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(n){throw new Error("failed to get info about account "+e.toBase58()+": "+n)}}async getMultipleParsedAccounts(e,t){const{commitment:n,config:i}=$e(t),s=e.map(l=>l.toBase58()),o=this._buildArgs([s],n,"jsonParsed",i),a=await this._rpcRequest("getMultipleAccounts",o),c=H(a,Ze(C(x(yu))));if("error"in c)throw new te(c.error,`failed to get info for accounts ${s}`);return c.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:n,config:i}=$e(t),s=e.map(l=>l.toBase58()),o=this._buildArgs([s],n,"base64",i),a=await this._rpcRequest("getMultipleAccounts",o),c=H(a,Ze(C(x(Ks))));if("error"in c)throw new te(c.error,`failed to get info for accounts ${s}`);return c.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,n){const{commitment:i,config:s}=$e(t),o=this._buildArgs([e.toBase58()],i,void 0,{...s,epoch:n??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getStakeActivation",o),c=H(a,he(uv));if("error"in c)throw new te(c.error,`failed to get Stake Activation ${e.toBase58()}`);return c.result}async getProgramAccounts(e,t){const{commitment:n,config:i}=$e(t),{encoding:s,...o}=i||{},a=this._buildArgs([e.toBase58()],n,s||"base64",o),c=await this._rpcRequest("getProgramAccounts",a),l=C(ov),u=o.withContext===!0?H(c,Ze(l)):H(c,he(l));if("error"in u)throw new te(u.error,`failed to get accounts owned by program ${e.toBase58()}`);return u.result}async getParsedProgramAccounts(e,t){const{commitment:n,config:i}=$e(t),s=this._buildArgs([e.toBase58()],n,"jsonParsed",i),o=await this._rpcRequest("getProgramAccounts",s),a=H(o,he(C(cv)));if("error"in a)throw new te(a.error,`failed to get accounts owned by program ${e.toBase58()}`);return a.result}async confirmTransaction(e,t){var s;let n;if(typeof e=="string")n=e;else{const o=e;if((s=o.abortSignal)!=null&&s.aborted)return Promise.reject(o.abortSignal.reason);n=o.signature}let i;try{i=ge.decode(n)}catch{throw new Error("signature must be base58 encoded: "+n)}return Ie(i.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:n}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,n)=>{e!=null&&(e.aborted?n(e.reason):e.addEventListener("abort",()=>{n(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let n,i,s=!1;const o=new Promise((c,l)=>{try{n=this.onSignature(t,(h,b)=>{n=void 0;const w={context:b,value:h};c({__type:Wn.PROCESSED,response:w})},e);const u=new Promise(h=>{n==null?h():i=this._onSubscriptionStateChange(n,b=>{b==="subscribed"&&h()})});(async()=>{if(await u,s)return;const h=await this.getSignatureStatus(t);if(s||h==null)return;const{context:b,value:w}=h;if(w!=null)if(w!=null&&w.err)l(w.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(w.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(w.confirmationStatus==="processed"||w.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}s=!0,c({__type:Wn.PROCESSED,response:{context:b,value:w}})}})()}catch(u){l(u)}});return{abortConfirmation:()=>{i&&(i(),i=void 0),n!=null&&(this.removeSignatureListener(n),n=void 0)},confirmationPromise:o}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:n,signature:i}}){let s=!1;const o=new Promise(h=>{const b=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let w=await b();if(!s){for(;w<=n;)if(await Br(1e3),s||(w=await b(),s))return;h({__type:Wn.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:a,confirmationPromise:c}=this.getTransactionConfirmationPromise({commitment:e,signature:i}),l=this.getCancellationPromise(t);let u;try{const h=await Promise.race([l,c,o]);if(h.__type===Wn.PROCESSED)u=h.response;else throw new Xu(i)}finally{s=!0,a()}return u}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:n,nonceAccountPubkey:i,nonceValue:s,signature:o}}){let a=!1;const c=new Promise(w=>{let k=s,g=null;const _=async()=>{try{const{context:I,value:L}=await this.getNonceAndContext(i,{commitment:e,minContextSlot:n});return g=I.slot,L==null?void 0:L.nonce}catch{return k}};(async()=>{if(k=await _(),!a)for(;;){if(s!==k){w({__type:Wn.NONCE_INVALID,slotInWhichNonceDidAdvance:g});return}if(await Br(2e3),a||(k=await _(),a))return}})()}),{abortConfirmation:l,confirmationPromise:u}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),h=this.getCancellationPromise(t);let b;try{const w=await Promise.race([h,u,c]);if(w.__type===Wn.PROCESSED)b=w.response;else{let k;for(;;){const g=await this.getSignatureStatus(o);if(g==null)break;if(g.context.slot<(w.slotInWhichNonceDidAdvance??n)){await Br(400);continue}k=g;break}if(k!=null&&k.value){const g=e||"finalized",{confirmationStatus:_}=k.value;switch(g){case"processed":case"recent":if(_!=="processed"&&_!=="confirmed"&&_!=="finalized")throw new mi(o);break;case"confirmed":case"single":case"singleGossip":if(_!=="confirmed"&&_!=="finalized")throw new mi(o);break;case"finalized":case"max":case"root":if(_!=="finalized")throw new mi(o);break;default:(I=>{})(g)}b={context:k.context,value:{err:k.value.err}}}else throw new mi(o)}}finally{a=!0,l()}return b}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let n;const i=new Promise(c=>{let l=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{l=this._confirmTransactionInitialTimeout||3e4;break}}n=setTimeout(()=>c({__type:Wn.TIMED_OUT,timeoutMs:l}),l)}),{abortConfirmation:s,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let a;try{const c=await Promise.race([o,i]);if(c.__type===Wn.PROCESSED)a=c.response;else throw new Zu(t,c.timeoutMs/1e3)}finally{clearTimeout(n),s()}return a}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=H(e,he(C(_v)));if("error"in t)throw new te(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getVoteAccounts",t),i=H(n,Av);if("error"in i)throw new te(i.error,"failed to get vote accounts");return i.result}async getSlot(e){const{commitment:t,config:n}=$e(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getSlot",i),o=H(s,he(y()));if("error"in o)throw new te(o.error,"failed to get slot");return o.result}async getSlotLeader(e){const{commitment:t,config:n}=$e(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getSlotLeader",i),o=H(s,he(P()));if("error"in o)throw new te(o.error,"failed to get slot leader");return o.result}async getSlotLeaders(e,t){const n=[e,t],i=await this._rpcRequest("getSlotLeaders",n),s=H(i,he(C(at)));if("error"in s)throw new te(s.error,"failed to get slot leaders");return s.result}async getSignatureStatus(e,t){const{context:n,value:i}=await this.getSignatureStatuses([e],t);Ie(i.length===1);const s=i[0];return{context:n,value:s}}async getSignatureStatuses(e,t){const n=[e];t&&n.push(t);const i=await this._rpcRequest("getSignatureStatuses",n),s=H(i,Iv);if("error"in s)throw new te(s.error,"failed to get signature status");return s.result}async getTransactionCount(e){const{commitment:t,config:n}=$e(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getTransactionCount",i),o=H(s,he(y()));if("error"in o)throw new te(o.error,"failed to get transaction count");return o.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getInflationGovernor",t),i=H(n,Hb);if("error"in i)throw new te(i.error,"failed to get inflation");return i.result}async getInflationReward(e,t,n){const{commitment:i,config:s}=$e(n),o=this._buildArgs([e.map(l=>l.toBase58())],i,void 0,{...s,epoch:t??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getInflationReward",o),c=H(a,Kb);if("error"in c)throw new te(c.error,"failed to get inflation reward");return c.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=H(e,Yb);if("error"in t)throw new te(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:n}=$e(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getEpochInfo",i),o=H(s,Jb);if("error"in o)throw new te(o.error,"failed to get epoch info");return o.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=H(e,Xb);if("error"in t)throw new te(t.error,"failed to get epoch schedule");const n=t.result;return new mh(n.slotsPerEpoch,n.leaderScheduleSlotOffset,n.warmup,n.firstNormalEpoch,n.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=H(e,Zb);if("error"in t)throw new te(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const n=this._buildArgs([e],t),i=await this._rpcRequest("getMinimumBalanceForRentExemption",n),s=H(i,Ev);return"error"in s?(console.warn("Unable to fetch minimum balance for rent exemption"),0):s.result}async getRecentBlockhashAndContext(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getRecentBlockhash",t),i=H(n,Lv);if("error"in i)throw new te(i.error,"failed to get recent blockhash");return i.result}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),n=H(t,zv);if("error"in n)throw new te(n.error,"failed to get recent performance samples");return n.result}async getFeeCalculatorForBlockhash(e,t){const n=this._buildArgs([e],t),i=await this._rpcRequest("getFeeCalculatorForBlockhash",n),s=H(i,Fv);if("error"in s)throw new te(s.error,"failed to get fee calculator");const{context:o,value:a}=s.result;return{context:o,value:a!==null?a.feeCalculator:null}}async getFeeForMessage(e,t){const n=pe(e.serialize()).toString("base64"),i=this._buildArgs([n],t),s=await this._rpcRequest("getFeeForMessage",i),o=H(s,Ze(x(y())));if("error"in o)throw new te(o.error,"failed to get fee for message");if(o.result===null)throw new Error("invalid blockhash");return o.result}async getRecentPrioritizationFees(e){var o;const t=(o=e==null?void 0:e.lockedWritableAccounts)==null?void 0:o.map(a=>a.toBase58()),n=t!=null&&t.length?[t]:[],i=await this._rpcRequest("getRecentPrioritizationFees",n),s=H(i,Qb);if("error"in s)throw new te(s.error,"failed to get recent prioritization fees");return s.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:n}=$e(e),i=this._buildArgs([],t,void 0,n),s=await this._rpcRequest("getLatestBlockhash",i),o=H(s,Nv);if("error"in o)throw new te(o.error,"failed to get latest blockhash");return o.result}async isBlockhashValid(e,t){const{commitment:n,config:i}=$e(t),s=this._buildArgs([e],n,void 0,i),o=await this._rpcRequest("isBlockhashValid",s),a=H(o,Dv);if("error"in a)throw new te(a.error,"failed to determine if the blockhash `"+e+"`is valid");return a.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=H(e,he($b));if("error"in t)throw new te(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=H(e,he(P()));if("error"in t)throw new te(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:n,config:i}=$e(t),s=this._buildArgsAtLeastConfirmed([e],n,void 0,i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=H(o,Rv);if("error"in a)throw a.error;return a.result}case"none":{const a=H(o,Bv);if("error"in a)throw a.error;return a.result}default:{const a=H(o,Tv);if("error"in a)throw a.error;const{result:c}=a;return c?{...c,transactions:c.transactions.map(({transaction:l,meta:u,version:h})=>({meta:u,transaction:{...l,message:Cc(h,l.message)},version:h}))}:null}}}catch(a){throw new te(a,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:n,config:i}=$e(t),s=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=H(o,Mv);if("error"in a)throw a.error;return a.result}case"none":{const a=H(o,Cv);if("error"in a)throw a.error;return a.result}default:{const a=H(o,xv);if("error"in a)throw a.error;return a.result}}}catch(a){throw new te(a,"failed to get block")}}async getBlockProduction(e){let t,n;if(typeof e=="string")n=e;else if(e){const{commitment:a,...c}=e;n=a,t=c}const i=this._buildArgs([],n,"base64",t),s=await this._rpcRequest("getBlockProduction",i),o=H(s,Wb);if("error"in o)throw new te(o.error,"failed to get block production information");return o.result}async getTransaction(e,t){const{commitment:n,config:i}=$e(t),s=this._buildArgsAtLeastConfirmed([e],n,void 0,i),o=await this._rpcRequest("getTransaction",s),a=H(o,Kc);if("error"in a)throw new te(a.error,"failed to get transaction");const c=a.result;return c&&{...c,transaction:{...c.transaction,message:Cc(c.version,c.transaction.message)}}}async getParsedTransaction(e,t){const{commitment:n,config:i}=$e(t),s=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",i),o=await this._rpcRequest("getTransaction",s),a=H(o,go);if("error"in a)throw new te(a.error,"failed to get transaction");return a.result}async getParsedTransactions(e,t){const{commitment:n,config:i}=$e(t),s=e.map(c=>{const l=this._buildArgsAtLeastConfirmed([c],n,"jsonParsed",i);return{methodName:"getTransaction",args:l}});return(await this._rpcBatchRequest(s)).map(c=>{const l=H(c,go);if("error"in l)throw new te(l.error,"failed to get transactions");return l.result})}async getTransactions(e,t){const{commitment:n,config:i}=$e(t),s=e.map(c=>{const l=this._buildArgsAtLeastConfirmed([c],n,void 0,i);return{methodName:"getTransaction",args:l}});return(await this._rpcBatchRequest(s)).map(c=>{const l=H(c,Kc);if("error"in l)throw new te(l.error,"failed to get transactions");const u=l.result;return u&&{...u,transaction:{...u.transaction,message:Cc(u.version,u.transaction.message)}}})}async getConfirmedBlock(e,t){const n=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getConfirmedBlock",n),s=H(i,Kv);if("error"in s)throw new te(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");const a={...o,transactions:o.transactions.map(({transaction:c,meta:l})=>{const u=new Sn(c.message);return{meta:l,transaction:{...c,message:u}}})};return{...a,transactions:a.transactions.map(({transaction:c,meta:l})=>({meta:l,transaction:xe.populate(c.message,c.signatures)}))}}async getBlocks(e,t,n){const i=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],n),s=await this._rpcRequest("getBlocks",i),o=H(s,he(C(y())));if("error"in o)throw new te(o.error,"failed to get blocks");return o.result}async getBlockSignatures(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getBlock",n),s=H(i,ud);if("error"in s)throw new te(s.error,"failed to get block");const o=s.result;if(!o)throw new Error("Block "+e+" not found");return o}async getConfirmedBlockSignatures(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getConfirmedBlock",n),s=H(i,ud);if("error"in s)throw new te(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");return o}async getConfirmedTransaction(e,t){const n=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getConfirmedTransaction",n),s=H(i,Kc);if("error"in s)throw new te(s.error,"failed to get transaction");const o=s.result;if(!o)return o;const a=new Sn(o.transaction.message),c=o.transaction.signatures;return{...o,transaction:xe.populate(a,c)}}async getParsedConfirmedTransaction(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),i=await this._rpcRequest("getConfirmedTransaction",n),s=H(i,go);if("error"in s)throw new te(s.error,"failed to get confirmed transaction");return s.result}async getParsedConfirmedTransactions(e,t){const n=e.map(o=>{const a=this._buildArgsAtLeastConfirmed([o],t,"jsonParsed");return{methodName:"getConfirmedTransaction",args:a}});return(await this._rpcBatchRequest(n)).map(o=>{const a=H(o,go);if("error"in a)throw new te(a.error,"failed to get confirmed transactions");return a.result})}async getConfirmedSignaturesForAddress(e,t,n){let i={},s=await this.getFirstAvailableBlock();for(;!("until"in i)&&(t--,!(t<=0||t<s));)try{const c=await this.getConfirmedBlockSignatures(t,"finalized");c.signatures.length>0&&(i.until=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}let o=await this.getSlot("finalized");for(;!("before"in i)&&(n++,!(n>o));)try{const c=await this.getConfirmedBlockSignatures(n);c.signatures.length>0&&(i.before=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}return(await this.getConfirmedSignaturesForAddress2(e,i)).map(c=>c.signature)}async getConfirmedSignaturesForAddress2(e,t,n){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),s=await this._rpcRequest("getConfirmedSignaturesForAddress2",i),o=H(s,lv);if("error"in o)throw new te(o.error,"failed to get confirmed signatures for address");return o.result}async getSignaturesForAddress(e,t,n){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),s=await this._rpcRequest("getSignaturesForAddress",i),o=H(s,dv);if("error"in o)throw new te(o.error,"failed to get signatures for address");return o.result}async getAddressLookupTable(e,t){const{context:n,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=new fu({key:e,state:fu.deserialize(i.data)})),{context:n,value:s}}async getNonceAndContext(e,t){const{context:n,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=Ba.fromAccountData(i.data)),{context:n,value:s}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+n)})}async requestAirdrop(e,t){const n=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),i=H(n,Uv);if("error"in i)throw new te(i.error,`airdrop to ${e.toBase58()} failed`);return i.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await Br(100);const n=Date.now()-this._blockhashInfo.lastFetch>=vh;if(this._blockhashInfo.latestBlockhash!==null&&!n)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,n=t?t.blockhash:null;for(let i=0;i<50;i++){const s=await this.getLatestBlockhash("finalized");if(n!==s.blockhash)return this._blockhashInfo={latestBlockhash:s,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},s;await Br(ph/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:n}=$e(e),i=this._buildArgs([],t,"base64",n),s=await this._rpcRequest("getStakeMinimumDelegation",i),o=H(s,Ze(y()));if("error"in o)throw new te(o.error,"failed to get stake minimum delegation");return o.result}async simulateTransaction(e,t,n){if("message"in e){const g=e.serialize(),_=D.Buffer.from(g).toString("base64");if(Array.isArray(t)||n!==void 0)throw new Error("Invalid arguments");const I=t||{};I.encoding="base64","commitment"in I||(I.commitment=this.commitment);const L=[_,I],G=await this._rpcRequest("simulateTransaction",L),$=H(G,ad);if("error"in $)throw new Error("failed to simulate transaction: "+$.error.message);return $.result}let i;if(e instanceof xe){let k=e;i=new xe,i.feePayer=k.feePayer,i.instructions=e.instructions,i.nonceInfo=k.nonceInfo,i.signatures=k.signatures}else i=xe.populate(e),i._message=i._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");const s=t;if(i.nonceInfo&&s)i.sign(...s);else{let k=this._disableBlockhashCaching;for(;;){const g=await this._blockhashWithExpiryBlockHeight(k);if(i.lastValidBlockHeight=g.lastValidBlockHeight,i.recentBlockhash=g.blockhash,!s)break;if(i.sign(...s),!i.signature)throw new Error("!signature");const _=i.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(_)&&!this._blockhashInfo.transactionSignatures.includes(_)){this._blockhashInfo.simulatedSignatures.push(_);break}else k=!0}}const o=i._compile(),a=o.serialize(),l=i._serialize(a).toString("base64"),u={encoding:"base64",commitment:this.commitment};if(n){const k=(Array.isArray(n)?n:o.nonProgramIds()).map(g=>g.toBase58());u.accounts={encoding:"base64",addresses:k}}s&&(u.sigVerify=!0);const h=[l,u],b=await this._rpcRequest("simulateTransaction",h),w=H(b,ad);if("error"in w){let k;if("data"in w.error&&(k=w.error.data.logs,k&&Array.isArray(k))){const g=`
    `,_=g+k.join(g);console.error(w.error.message,_)}throw new du("failed to simulate transaction: "+w.error.message,k)}return w.result}async sendTransaction(e,t,n){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const o=e.serialize();return await this.sendRawTransaction(o,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");const i=t;if(e.nonceInfo)e.sign(...i);else{let o=this._disableBlockhashCaching;for(;;){const a=await this._blockhashWithExpiryBlockHeight(o);if(e.lastValidBlockHeight=a.lastValidBlockHeight,e.recentBlockhash=a.blockhash,e.sign(...i),!e.signature)throw new Error("!signature");const c=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(c))o=!0;else{this._blockhashInfo.transactionSignatures.push(c);break}}}const s=e.serialize();return await this.sendRawTransaction(s,n)}async sendRawTransaction(e,t){const n=pe(e).toString("base64");return await this.sendEncodedTransaction(n,t)}async sendEncodedTransaction(e,t){const n={encoding:"base64"},i=t&&t.skipPreflight,s=t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(n.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(n.minContextSlot=t.minContextSlot),i&&(n.skipPreflight=i),s&&(n.preflightCommitment=s);const o=[e,n],a=await this._rpcRequest("sendTransaction",o),c=H(a,$v);if("error"in c){let l;throw"data"in c.error&&(l=c.error.data.logs),new du("failed to send transaction: "+c.error.message,l)}return c.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,n])=>{this._setSubscription(t,{...n,state:"pending"})})}_setSubscription(e,t){var i;const n=(i=this._subscriptionsByHash[e])==null?void 0:i.state;if(this._subscriptionsByHash[e]=t,n!==t.state){const s=this._subscriptionStateChangeCallbacksByHash[e];s&&s.forEach(o=>{try{o(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){const n=this._subscriptionHashByClientSubscriptionId[e];if(n==null)return()=>{};const i=this._subscriptionStateChangeCallbacksByHash[n]||=new Set;return i.add(t),()=>{i.delete(t),i.size===0&&delete this._subscriptionStateChangeCallbacksByHash[n]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(n){n instanceof Error&&console.log(`Error when closing socket connection: ${n.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async n=>{const i=this._subscriptionsByHash[n];if(i!==void 0)switch(i.state){case"pending":case"unsubscribed":if(i.callbacks.size===0){delete this._subscriptionsByHash[n],i.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[i.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:s,method:o}=i;try{this._setSubscription(n,{...i,state:"subscribing"});const a=await this._rpcWebSocket.call(o,s);this._setSubscription(n,{...i,serverSubscriptionId:a,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[a]=i.callbacks,await this._updateSubscriptions()}catch(a){if(a instanceof Error&&console.error(`${o} error for argument`,s,a.message),!t())return;this._setSubscription(n,{...i,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":i.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:s,unsubscribeMethod:o}=i;if(this._subscriptionsAutoDisposedByRpc.has(s))this._subscriptionsAutoDisposedByRpc.delete(s);else{this._setSubscription(n,{...i,state:"unsubscribing"}),this._setSubscription(n,{...i,state:"unsubscribing"});try{await this._rpcWebSocket.call(o,[s])}catch(a){if(a instanceof Error&&console.error(`${o} error:`,a.message),!t())return;this._setSubscription(n,{...i,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(n,{...i,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){const n=this._subscriptionCallbacksByServerSubscriptionId[e];n!==void 0&&n.forEach(i=>{try{i(...t)}catch(s){console.error(s)}})}_wsOnAccountNotification(e){const{result:t,subscription:n}=H(e,fv);this._handleServerNotification(n,[t.value,t.context])}_makeSubscription(e,t){const n=this._nextClientSubscriptionId++,i=sd([e.method,t],!0),s=this._subscriptionsByHash[i];return s===void 0?this._subscriptionsByHash[i]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:s.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[n]=i,this._subscriptionDisposeFunctionsByClientSubscriptionId[n]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[n],delete this._subscriptionHashByClientSubscriptionId[n];const o=this._subscriptionsByHash[i];Ie(o!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${n}`),o.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),n}onAccountChange(e,t,n){const i=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64");return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},i)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:n}=H(e,pv);this._handleServerNotification(n,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,n,i){const s=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64",i?{filters:i}:void 0);return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},s)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,n){const i=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],n||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},i)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:n}=H(e,jv);this._handleServerNotification(n,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:n}=H(e,gv);this._handleServerNotification(n,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:n}=H(e,bv);this._handleServerNotification(n,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const n=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];n?await n():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,n,i){const s=t||this._commitment;if(s||n||i){let o={};n&&(o.encoding=n),s&&(o.commitment=s),i&&(o=Object.assign(o,i)),e.push(o)}return e}_buildArgsAtLeastConfirmed(e,t,n,i){const s=t||this._commitment;if(s&&!["confirmed","finalized"].includes(s))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,n,i)}_wsOnSignatureNotification(e){const{result:t,subscription:n}=H(e,vv);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(n),this._handleServerNotification(n,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,n){const i=this._buildArgs([e],n||this._commitment||"finalized"),s=this._makeSubscription({callback:(o,a)=>{if(o.type==="status"){t(o.result,a);try{this.removeSignatureListener(s)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},i);return s}onSignatureWithOptions(e,t,n){const{commitment:i,...s}={...n,commitment:n&&n.commitment||this._commitment||"finalized"},o=this._buildArgs([e],i,void 0,s),a=this._makeSubscription({callback:(c,l)=>{t(c,l);try{this.removeSignatureListener(a)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return a}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:n}=H(e,wv);this._handleServerNotification(n,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class Ei{constructor(e){this._keypair=void 0,this._keypair=e??nd()}static generate(){return new Ei(nd())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const n=e.slice(32,64);if(!t||!t.skipValidation){const i=e.slice(0,32),s=Yo(i);for(let o=0;o<32;o++)if(n[o]!==s[o])throw new Error("provided secretKey is invalid")}return new Ei({publicKey:n,secretKey:e})}static fromSeed(e){const t=Yo(e),n=new Uint8Array(64);return n.set(e),n.set(t,32),new Ei({publicKey:t,secretKey:n})}get publicKey(){return new Y(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}const qn=Object.freeze({CreateLookupTable:{index:0,layout:z([F("instruction"),Ci("recentSlot"),ie("bumpSeed")])},FreezeLookupTable:{index:1,layout:z([F("instruction")])},ExtendLookupTable:{index:2,layout:z([F("instruction"),Ci(),Fe(be(),tn(F(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:z([F("instruction")])},CloseLookupTable:{index:4,layout:z([F("instruction")])}});class Hv{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=F("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(qn))if(o.index==n){i=s;break}if(!i)throw new Error("Invalid Instruction. Should be a LookupTable Instruction");return i}static decodeCreateLookupTable(e){this.checkProgramId(e.programId),this.checkKeysLength(e.keys,4);const{recentSlot:t}=Re(qn.CreateLookupTable,e.data);return{authority:e.keys[1].pubkey,payer:e.keys[2].pubkey,recentSlot:Number(t)}}static decodeExtendLookupTable(e){if(this.checkProgramId(e.programId),e.keys.length<2)throw new Error(`invalid instruction; found ${e.keys.length} keys, expected at least 2`);const{addresses:t}=Re(qn.ExtendLookupTable,e.data);return{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,payer:e.keys.length>2?e.keys[2].pubkey:void 0,addresses:t.map(n=>new Y(n))}}static decodeCloseLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,3),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,recipient:e.keys[2].pubkey}}static decodeFreezeLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static decodeDeactivateLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(ol.programId))throw new Error("invalid instruction; programId is not AddressLookupTable Program")}static checkKeysLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}class ol{constructor(){}static createLookupTable(e){const[t,n]=Y.findProgramAddressSync([e.authority.toBuffer(),Du(BigInt(e.recentSlot),8)],this.programId),i=qn.CreateLookupTable,s=_e(i,{recentSlot:BigInt(e.recentSlot),bumpSeed:n}),o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:At.programId,isSigner:!1,isWritable:!1}];return[new De({programId:this.programId,keys:o,data:s}),t]}static freezeLookupTable(e){const t=qn.FreezeLookupTable,n=_e(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new De({programId:this.programId,keys:i,data:n})}static extendLookupTable(e){const t=qn.ExtendLookupTable,n=_e(t,{addresses:e.addresses.map(s=>s.toBytes())}),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return e.payer&&i.push({pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:At.programId,isSigner:!1,isWritable:!1}),new De({programId:this.programId,keys:i,data:n})}static deactivateLookupTable(e){const t=qn.DeactivateLookupTable,n=_e(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new De({programId:this.programId,keys:i,data:n})}static closeLookupTable(e){const t=qn.CloseLookupTable,n=_e(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.recipient,isSigner:!1,isWritable:!0}];return new De({programId:this.programId,keys:i,data:n})}}ol.programId=new Y("AddressLookupTab1e1111111111111111111111111");class Yv{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=ie("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Mn))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a ComputeBudgetInstruction");return i}static decodeRequestUnits(e){this.checkProgramId(e.programId);const{units:t,additionalFee:n}=Re(Mn.RequestUnits,e.data);return{units:t,additionalFee:n}}static decodeRequestHeapFrame(e){this.checkProgramId(e.programId);const{bytes:t}=Re(Mn.RequestHeapFrame,e.data);return{bytes:t}}static decodeSetComputeUnitLimit(e){this.checkProgramId(e.programId);const{units:t}=Re(Mn.SetComputeUnitLimit,e.data);return{units:t}}static decodeSetComputeUnitPrice(e){this.checkProgramId(e.programId);const{microLamports:t}=Re(Mn.SetComputeUnitPrice,e.data);return{microLamports:t}}static checkProgramId(e){if(!e.equals(al.programId))throw new Error("invalid instruction; programId is not ComputeBudgetProgram")}}const Mn=Object.freeze({RequestUnits:{index:0,layout:z([ie("instruction"),F("units"),F("additionalFee")])},RequestHeapFrame:{index:1,layout:z([ie("instruction"),F("bytes")])},SetComputeUnitLimit:{index:2,layout:z([ie("instruction"),F("units")])},SetComputeUnitPrice:{index:3,layout:z([ie("instruction"),Ci("microLamports")])}});class al{constructor(){}static requestUnits(e){const t=Mn.RequestUnits,n=_e(t,e);return new De({keys:[],programId:this.programId,data:n})}static requestHeapFrame(e){const t=Mn.RequestHeapFrame,n=_e(t,e);return new De({keys:[],programId:this.programId,data:n})}static setComputeUnitLimit(e){const t=Mn.SetComputeUnitLimit,n=_e(t,e);return new De({keys:[],programId:this.programId,data:n})}static setComputeUnitPrice(e){const t=Mn.SetComputeUnitPrice,n=_e(t,{microLamports:BigInt(e.microLamports)});return new De({keys:[],programId:this.programId,data:n})}}al.programId=new Y("ComputeBudget111111111111111111111111111111");const ld=64,dd=32,fd=64,hd=z([ie("numSignatures"),ie("padding"),et("signatureOffset"),et("signatureInstructionIndex"),et("publicKeyOffset"),et("publicKeyInstructionIndex"),et("messageDataOffset"),et("messageDataSize"),et("messageInstructionIndex")]);class Ma{constructor(){}static createInstructionWithPublicKey(e){const{publicKey:t,message:n,signature:i,instructionIndex:s}=e;Ie(t.length===dd,`Public Key must be ${dd} bytes but received ${t.length} bytes`),Ie(i.length===fd,`Signature must be ${fd} bytes but received ${i.length} bytes`);const o=hd.span,a=o+t.length,c=a+i.length,l=1,u=D.Buffer.alloc(c+n.length),h=s??65535;return hd.encode({numSignatures:l,padding:0,signatureOffset:a,signatureInstructionIndex:h,publicKeyOffset:o,publicKeyInstructionIndex:h,messageDataOffset:c,messageDataSize:n.length,messageInstructionIndex:h},u),u.fill(t,o),u.fill(i,a),u.fill(n,c),new De({keys:[],programId:Ma.programId,data:u})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:n,instructionIndex:i}=e;Ie(t.length===ld,`Private key must be ${ld} bytes but received ${t.length} bytes`);try{const s=Ei.fromSecretKey(t),o=s.publicKey.toBytes(),a=Qu(n,s.secretKey);return this.createInstructionWithPublicKey({publicKey:o,message:n,signature:a,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}Ma.programId=new Y("Ed25519SigVerify111111111111111111111111111");const Qv=(r,e)=>{const t=Ws.sign(r,e);return[t.toCompactRawBytes(),t.recovery]};Ws.utils.isValidPrivateKey;const Jv=Ws.getPublicKey,pd=32,Lc=20,yd=64,Xv=11,Nc=z([ie("numSignatures"),et("signatureOffset"),ie("signatureInstructionIndex"),et("ethAddressOffset"),ie("ethAddressInstructionIndex"),et("messageDataOffset"),et("messageDataSize"),ie("messageInstructionIndex"),ve(20,"ethAddress"),ve(64,"signature"),ie("recoveryId")]);class Oi{constructor(){}static publicKeyToEthAddress(e){Ie(e.length===yd,`Public key must be ${yd} bytes but received ${e.length} bytes`);try{return D.Buffer.from(Fl(pe(e))).slice(-Lc)}catch(t){throw new Error(`Error constructing Ethereum address: ${t}`)}}static createInstructionWithPublicKey(e){const{publicKey:t,message:n,signature:i,recoveryId:s,instructionIndex:o}=e;return Oi.createInstructionWithEthAddress({ethAddress:Oi.publicKeyToEthAddress(t),message:n,signature:i,recoveryId:s,instructionIndex:o})}static createInstructionWithEthAddress(e){const{ethAddress:t,message:n,signature:i,recoveryId:s,instructionIndex:o=0}=e;let a;typeof t=="string"?t.startsWith("0x")?a=D.Buffer.from(t.substr(2),"hex"):a=D.Buffer.from(t,"hex"):a=t,Ie(a.length===Lc,`Address must be ${Lc} bytes but received ${a.length} bytes`);const c=1+Xv,l=c,u=c+a.length,h=u+i.length+1,b=1,w=D.Buffer.alloc(Nc.span+n.length);return Nc.encode({numSignatures:b,signatureOffset:u,signatureInstructionIndex:o,ethAddressOffset:l,ethAddressInstructionIndex:o,messageDataOffset:h,messageDataSize:n.length,messageInstructionIndex:o,signature:pe(i),ethAddress:pe(a),recoveryId:s},w),w.fill(pe(n),Nc.span),new De({keys:[],programId:Oi.programId,data:w})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:n,instructionIndex:i}=e;Ie(t.length===pd,`Private key must be ${pd} bytes but received ${t.length} bytes`);try{const s=pe(t),o=Jv(s,!1).slice(1),a=D.Buffer.from(Fl(pe(n))),[c,l]=Qv(a,s);return this.createInstructionWithPublicKey({publicKey:o,message:n,signature:c,recoveryId:l,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}Oi.programId=new Y("KeccakSecp256k11111111111111111111111111111");var Th;const Bh=new Y("StakeConfig11111111111111111111111111111111");class Rh{constructor(e,t){this.staker=void 0,this.withdrawer=void 0,this.staker=e,this.withdrawer=t}}class Ys{constructor(e,t,n){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=n}}Th=Ys;Ys.default=new Th(0,0,Y.default);class Zv{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=F("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(mt))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a StakeInstruction");return i}static decodeInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t,lockup:n}=Re(mt.Initialize,e.data);return{stakePubkey:e.keys[0].pubkey,authorized:new Rh(new Y(t.staker),new Y(t.withdrawer)),lockup:new Ys(n.unixTimestamp,n.epoch,new Y(n.custodian))}}static decodeDelegate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,6),Re(mt.Delegate,e.data),{stakePubkey:e.keys[0].pubkey,votePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[5].pubkey}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,stakeAuthorizationType:n}=Re(mt.Authorize,e.data),i={stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new Y(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(i.custodianPubkey=e.keys[3].pubkey),i}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{newAuthorized:t,stakeAuthorizationType:n,authoritySeed:i,authorityOwner:s}=Re(mt.AuthorizeWithSeed,e.data),o={stakePubkey:e.keys[0].pubkey,authorityBase:e.keys[1].pubkey,authoritySeed:i,authorityOwner:new Y(s),newAuthorizedPubkey:new Y(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(o.custodianPubkey=e.keys[3].pubkey),o}static decodeSplit(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Re(mt.Split,e.data);return{stakePubkey:e.keys[0].pubkey,splitStakePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[2].pubkey,lamports:t}}static decodeMerge(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Re(mt.Merge,e.data),{stakePubkey:e.keys[0].pubkey,sourceStakePubKey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Re(mt.Withdraw,e.data),n={stakePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t};return e.keys.length>5&&(n.custodianPubkey=e.keys[5].pubkey),n}static decodeDeactivate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Re(mt.Deactivate,e.data),{stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static checkProgramId(e){if(!e.equals(Ca.programId))throw new Error("invalid instruction; programId is not StakeProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const mt=Object.freeze({Initialize:{index:0,layout:z([F("instruction"),tb(),nb()])},Authorize:{index:1,layout:z([F("instruction"),be("newAuthorized"),F("stakeAuthorizationType")])},Delegate:{index:2,layout:z([F("instruction")])},Split:{index:3,layout:z([F("instruction"),We("lamports")])},Withdraw:{index:4,layout:z([F("instruction"),We("lamports")])},Deactivate:{index:5,layout:z([F("instruction")])},Merge:{index:7,layout:z([F("instruction")])},AuthorizeWithSeed:{index:8,layout:z([F("instruction"),be("newAuthorized"),F("stakeAuthorizationType"),Mr("authoritySeed"),be("authorityOwner")])}}),ew=Object.freeze({Staker:{index:0},Withdrawer:{index:1}});class Ca{constructor(){}static initialize(e){const{stakePubkey:t,authorized:n,lockup:i}=e,s=i||Ys.default,o=mt.Initialize,a=_e(o,{authorized:{staker:pe(n.staker.toBuffer()),withdrawer:pe(n.withdrawer.toBuffer())},lockup:{unixTimestamp:s.unixTimestamp,epoch:s.epoch,custodian:pe(s.custodian.toBuffer())}}),c={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Mi,isSigner:!1,isWritable:!1}],programId:this.programId,data:a};return new De(c)}static createAccountWithSeed(e){const t=new xe;t.add(At.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:n,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:n,authorized:i,lockup:s}))}static createAccount(e){const t=new xe;t.add(At.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:n,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:n,authorized:i,lockup:s}))}static delegate(e){const{stakePubkey:t,authorizedPubkey:n,votePubkey:i}=e,s=mt.Delegate,o=_e(s);return new xe().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:Rn,isSigner:!1,isWritable:!1},{pubkey:Do,isSigner:!1,isWritable:!1},{pubkey:Bh,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static authorize(e){const{stakePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:i,stakeAuthorizationType:s,custodianPubkey:o}=e,a=mt.Authorize,c=_e(a,{newAuthorized:pe(i.toBuffer()),stakeAuthorizationType:s.index}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Rn,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return o&&l.push({pubkey:o,isSigner:!1,isWritable:!1}),new xe().add({keys:l,programId:this.programId,data:c})}static authorizeWithSeed(e){const{stakePubkey:t,authorityBase:n,authoritySeed:i,authorityOwner:s,newAuthorizedPubkey:o,stakeAuthorizationType:a,custodianPubkey:c}=e,l=mt.AuthorizeWithSeed,u=_e(l,{newAuthorized:pe(o.toBuffer()),stakeAuthorizationType:a.index,authoritySeed:i,authorityOwner:pe(s.toBuffer())}),h=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:Rn,isSigner:!1,isWritable:!1}];return c&&h.push({pubkey:c,isSigner:!1,isWritable:!1}),new xe().add({keys:h,programId:this.programId,data:u})}static splitInstruction(e){const{stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,lamports:s}=e,o=mt.Split,a=_e(o,{lamports:s});return new De({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:a})}static split(e){const t=new xe;return t.add(At.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:0,space:this.space,programId:this.programId})),t.add(this.splitInstruction(e))}static splitWithSeed(e){const{stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,basePubkey:s,seed:o,lamports:a}=e,c=new xe;return c.add(At.allocate({accountPubkey:i,basePubkey:s,seed:o,space:this.space,programId:this.programId})),c.add(this.splitInstruction({stakePubkey:t,authorizedPubkey:n,splitStakePubkey:i,lamports:a}))}static merge(e){const{stakePubkey:t,sourceStakePubKey:n,authorizedPubkey:i}=e,s=mt.Merge,o=_e(s);return new xe().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:Rn,isSigner:!1,isWritable:!1},{pubkey:Do,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static withdraw(e){const{stakePubkey:t,authorizedPubkey:n,toPubkey:i,lamports:s,custodianPubkey:o}=e,a=mt.Withdraw,c=_e(a,{lamports:s}),l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:Rn,isSigner:!1,isWritable:!1},{pubkey:Do,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return o&&l.push({pubkey:o,isSigner:!1,isWritable:!1}),new xe().add({keys:l,programId:this.programId,data:c})}static deactivate(e){const{stakePubkey:t,authorizedPubkey:n}=e,i=mt.Deactivate,s=_e(i);return new xe().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Rn,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:s})}}Ca.programId=new Y("Stake11111111111111111111111111111111111111");Ca.space=200;class xh{constructor(e,t,n,i){this.nodePubkey=void 0,this.authorizedVoter=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.nodePubkey=e,this.authorizedVoter=t,this.authorizedWithdrawer=n,this.commission=i}}class tw{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=F("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Gn))if(o.index==n){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a VoteInstruction");return i}static decodeInitializeAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,4);const{voteInit:t}=Re(Gn.InitializeAccount,e.data);return{votePubkey:e.keys[0].pubkey,nodePubkey:e.keys[3].pubkey,voteInit:new xh(new Y(t.nodePubkey),new Y(t.authorizedVoter),new Y(t.authorizedWithdrawer),t.commission)}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,voteAuthorizationType:n}=Re(Gn.Authorize,e.data);return{votePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new Y(t),voteAuthorizationType:{index:n}}}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:t,currentAuthorityDerivedKeySeed:n,newAuthorized:i,voteAuthorizationType:s}}=Re(Gn.AuthorizeWithSeed,e.data);return{currentAuthorityDerivedKeyBasePubkey:e.keys[2].pubkey,currentAuthorityDerivedKeyOwnerPubkey:new Y(t),currentAuthorityDerivedKeySeed:n,newAuthorizedPubkey:new Y(i),voteAuthorizationType:{index:s},votePubkey:e.keys[0].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Re(Gn.Withdraw,e.data);return{votePubkey:e.keys[0].pubkey,authorizedWithdrawerPubkey:e.keys[2].pubkey,lamports:t,toPubkey:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(Xi.programId))throw new Error("invalid instruction; programId is not VoteProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const Gn=Object.freeze({InitializeAccount:{index:0,layout:z([F("instruction"),rb()])},Authorize:{index:1,layout:z([F("instruction"),be("newAuthorized"),F("voteAuthorizationType")])},Withdraw:{index:3,layout:z([F("instruction"),We("lamports")])},AuthorizeWithSeed:{index:10,layout:z([F("instruction"),ib()])}}),nw=Object.freeze({Voter:{index:0},Withdrawer:{index:1}});class Xi{constructor(){}static initializeAccount(e){const{votePubkey:t,nodePubkey:n,voteInit:i}=e,s=Gn.InitializeAccount,o=_e(s,{voteInit:{nodePubkey:pe(i.nodePubkey.toBuffer()),authorizedVoter:pe(i.authorizedVoter.toBuffer()),authorizedWithdrawer:pe(i.authorizedWithdrawer.toBuffer()),commission:i.commission}}),a={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Mi,isSigner:!1,isWritable:!1},{pubkey:Rn,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:o};return new De(a)}static createAccount(e){const t=new xe;return t.add(At.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}static authorize(e){const{votePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:i,voteAuthorizationType:s}=e,o=Gn.Authorize,a=_e(o,{newAuthorized:pe(i.toBuffer()),voteAuthorizationType:s.index}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Rn,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return new xe().add({keys:c,programId:this.programId,data:a})}static authorizeWithSeed(e){const{currentAuthorityDerivedKeyBasePubkey:t,currentAuthorityDerivedKeyOwnerPubkey:n,currentAuthorityDerivedKeySeed:i,newAuthorizedPubkey:s,voteAuthorizationType:o,votePubkey:a}=e,c=Gn.AuthorizeWithSeed,l=_e(c,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:pe(n.toBuffer()),currentAuthorityDerivedKeySeed:i,newAuthorized:pe(s.toBuffer()),voteAuthorizationType:o.index}}),u=[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:Rn,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return new xe().add({keys:u,programId:this.programId,data:l})}static withdraw(e){const{votePubkey:t,authorizedWithdrawerPubkey:n,lamports:i,toPubkey:s}=e,o=Gn.Withdraw,a=_e(o,{lamports:i}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return new xe().add({keys:c,programId:this.programId,data:a})}static safeWithdraw(e,t,n){if(e.lamports>t-n)throw new Error("Withdraw will leave vote account with insuffcient funds.");return Xi.withdraw(e)}}Xi.programId=new Y("Vote111111111111111111111111111111111111111");Xi.space=3731;const Mh=new Y("Va1idator1nfo111111111111111111111111111111"),rw=A({name:P(),website:j(P()),details:j(P()),keybaseUsername:j(P())});class cl{constructor(e,t){this.key=void 0,this.info=void 0,this.key=e,this.info=t}static fromConfigData(e){let t=[...e];if(zt(t)!==2)return null;const i=[];for(let s=0;s<2;s++){const o=new Y(t.slice(0,en));t=t.slice(en);const a=t.slice(0,1)[0]===1;t=t.slice(1),i.push({publicKey:o,isSigner:a})}if(i[0].publicKey.equals(Mh)&&i[1].isSigner){const s=Mr().decode(D.Buffer.from(t)),o=JSON.parse(s);return ah(o,rw),new cl(i[1].publicKey,o)}return null}}const iw=new Y("Vote111111111111111111111111111111111111111"),sw=z([be("nodePubkey"),be("authorizedWithdrawer"),ie("commission"),ke(),Fe(z([ke("slot"),F("confirmationCount")]),tn(F(),-8),"votes"),ie("rootSlotValid"),ke("rootSlot"),ke(),Fe(z([ke("epoch"),be("authorizedVoter")]),tn(F(),-8),"authorizedVoters"),z([Fe(z([be("authorizedPubkey"),ke("epochOfLastAuthorizedSwitch"),ke("targetEpoch")]),32,"buf"),ke("idx"),ie("isEmpty")],"priorVoters"),ke(),Fe(z([ke("epoch"),ke("credits"),ke("prevCredits")]),tn(F(),-8),"epochCredits"),z([ke("slot"),ke("timestamp")],"lastTimestamp")]);class ul{constructor(e){this.nodePubkey=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.rootSlot=void 0,this.votes=void 0,this.authorizedVoters=void 0,this.priorVoters=void 0,this.epochCredits=void 0,this.lastTimestamp=void 0,this.nodePubkey=e.nodePubkey,this.authorizedWithdrawer=e.authorizedWithdrawer,this.commission=e.commission,this.rootSlot=e.rootSlot,this.votes=e.votes,this.authorizedVoters=e.authorizedVoters,this.priorVoters=e.priorVoters,this.epochCredits=e.epochCredits,this.lastTimestamp=e.lastTimestamp}static fromAccountData(e){const n=sw.decode(pe(e),4);let i=n.rootSlot;return n.rootSlotValid||(i=null),new ul({nodePubkey:new Y(n.nodePubkey),authorizedWithdrawer:new Y(n.authorizedWithdrawer),commission:n.commission,votes:n.votes,rootSlot:i,authorizedVoters:n.authorizedVoters.map(ow),priorVoters:aw(n.priorVoters),epochCredits:n.epochCredits,lastTimestamp:n.lastTimestamp})}}function ow({authorizedVoter:r,epoch:e}){return{epoch:e,authorizedVoter:new Y(r)}}function gd({authorizedPubkey:r,epochOfLastAuthorizedSwitch:e,targetEpoch:t}){return{authorizedPubkey:new Y(r),epochOfLastAuthorizedSwitch:e,targetEpoch:t}}function aw({buf:r,idx:e,isEmpty:t}){return t?[]:[...r.slice(e+1).map(gd),...r.slice(0,e).map(gd)]}const md={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function cw(r,e){const t=e===!1?"http":"https";if(!r)return md[t].devnet;const n=md[t][r];if(!n)throw new Error(`Unknown ${t} cluster: ${r}`);return n}async function uw(r,e,t,n){let i,s;t&&Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")||t&&Object.prototype.hasOwnProperty.call(t,"nonceValue")?(i=t,s=n):s=t;const o=s&&{skipPreflight:s.skipPreflight,preflightCommitment:s.preflightCommitment||s.commitment,minContextSlot:s.minContextSlot},a=await r.sendRawTransaction(e,o),c=s&&s.commitment,u=(await(i?r.confirmTransaction(i,c):r.confirmTransaction(a,c))).value;if(u.err)throw new Error(`Raw transaction ${a} failed (${JSON.stringify(u)})`);return a}const lw=1e9;var dw=Object.freeze(Object.defineProperty({__proto__:null,Account:Xm,AddressLookupTableAccount:fu,AddressLookupTableInstruction:Hv,AddressLookupTableProgram:ol,Authorized:Rh,BLOCKHASH_CACHE_TIMEOUT_MS:vh,BPF_LOADER_DEPRECATED_PROGRAM_ID:Zm,BPF_LOADER_PROGRAM_ID:bb,BpfLoader:vb,COMPUTE_BUDGET_INSTRUCTION_LAYOUTS:Mn,ComputeBudgetInstruction:Yv,ComputeBudgetProgram:al,Connection:Gv,Ed25519Program:Ma,Enum:Qm,EpochSchedule:mh,FeeCalculatorLayout:yh,Keypair:Ei,LAMPORTS_PER_SOL:lw,LOOKUP_TABLE_INSTRUCTION_LAYOUTS:qn,Loader:zr,Lockup:Ys,MAX_SEED_LENGTH:fh,Message:Sn,MessageAccountKeys:Cs,MessageV0:Vr,NONCE_ACCOUNT_LENGTH:lu,NonceAccount:Ba,PACKET_DATA_SIZE:dr,PUBLIC_KEY_LENGTH:en,PublicKey:Y,SIGNATURE_LENGTH_IN_BYTES:xi,SOLANA_SCHEMA:As,STAKE_CONFIG_ID:Bh,STAKE_INSTRUCTION_LAYOUTS:mt,SYSTEM_INSTRUCTION_LAYOUTS:Ve,SYSVAR_CLOCK_PUBKEY:Rn,SYSVAR_EPOCH_SCHEDULE_PUBKEY:ub,SYSVAR_INSTRUCTIONS_PUBKEY:lb,SYSVAR_RECENT_BLOCKHASHES_PUBKEY:No,SYSVAR_RENT_PUBKEY:Mi,SYSVAR_REWARDS_PUBKEY:db,SYSVAR_SLOT_HASHES_PUBKEY:fb,SYSVAR_SLOT_HISTORY_PUBKEY:hb,SYSVAR_STAKE_HISTORY_PUBKEY:Do,Secp256k1Program:Oi,SendTransactionError:du,SolanaJSONRPCError:te,SolanaJSONRPCErrorCode:Ib,StakeAuthorizationLayout:ew,StakeInstruction:Zv,StakeProgram:Ca,Struct:Ju,SystemInstruction:gb,SystemProgram:At,Transaction:xe,TransactionExpiredBlockheightExceededError:Xu,TransactionExpiredNonceInvalidError:mi,TransactionExpiredTimeoutError:Zu,TransactionInstruction:De,TransactionMessage:tl,TransactionStatus:Wn,VALIDATOR_INFO_KEY:Mh,VERSION_PREFIX_MASK:Pa,VOTE_PROGRAM_ID:iw,ValidatorInfo:cl,VersionedMessage:el,VersionedTransaction:nl,VoteAccount:ul,VoteAuthorizationLayout:nw,VoteInit:xh,VoteInstruction:tw,VoteProgram:Xi,clusterApiUrl:cw,sendAndConfirmRawTransaction:uw,sendAndConfirmTransaction:uu},Symbol.toStringTag,{value:"Module"})),Xn=$s(dw);const bd=()=>{const r=kn.utils.randomPrivateKey(),e=gu(r),t=new Uint8Array(64);return t.set(r),t.set(e,32),{publicKey:e,secretKey:t}},gu=kn.getPublicKey;function vd(r){try{return kn.ExtendedPoint.fromHex(r),!0}catch{return!1}}const fw=(r,e)=>kn.sign(r,e.slice(0,32)),hw=kn.verify,Vt=r=>D.Buffer.isBuffer(r)?r:r instanceof Uint8Array?D.Buffer.from(r.buffer,r.byteOffset,r.byteLength):D.Buffer.from(r);class pw{constructor(e){Object.assign(this,e)}encode(){return D.Buffer.from(mf(Vo,this))}static decode(e){return bf(Vo,this,e)}static decodeUnchecked(e){return vf(Vo,this,e)}}const Vo=new Map;var Ch;let Kh;const yw=32,Cr=32;function gw(r){return r._bn!==void 0}let wd=1;Kh=Symbol.toStringTag;class ee extends pw{constructor(e){if(super({}),this._bn=void 0,gw(e))this._bn=e._bn;else{if(typeof e=="string"){const t=ge.decode(e);if(t.length!=Cr)throw new Error("Invalid public key input");this._bn=new Qn(t)}else this._bn=new Qn(e);if(this._bn.byteLength()>Cr)throw new Error("Invalid public key input")}}static unique(){const e=new ee(wd);return wd+=1,new ee(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return ge.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(D.Buffer);if(e.length===Cr)return e;const t=D.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[Kh](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,n){const i=D.Buffer.concat([e.toBuffer(),D.Buffer.from(t),n.toBuffer()]),s=qo(i);return new ee(s)}static createProgramAddressSync(e,t){let n=D.Buffer.alloc(0);e.forEach(function(s){if(s.length>yw)throw new TypeError("Max seed length exceeded");n=D.Buffer.concat([n,Vt(s)])}),n=D.Buffer.concat([n,t.toBuffer(),D.Buffer.from("ProgramDerivedAddress")]);const i=qo(n);if(vd(i))throw new Error("Invalid seeds, address must fall off the curve");return new ee(i)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let n=255,i;for(;n!=0;){try{const s=e.concat(D.Buffer.from([n]));i=this.createProgramAddressSync(s,t)}catch(s){if(s instanceof TypeError)throw s;n--;continue}return[i,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new ee(e);return vd(t.toBytes())}}Ch=ee;ee.default=new Ch("11111111111111111111111111111111");Vo.set(ee,{kind:"struct",fields:[["_bn","u256"]]});new ee("BPFLoader1111111111111111111111111111111111");const mu=1280-40-8,mw=127,bu=64;class _d{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const n=new Map;this.keySegments().flat().forEach((s,o)=>{n.set(s.toBase58(),o)});const i=s=>{const o=n.get(s.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(s=>({programIdIndex:i(s.programId),accountKeyIndexes:s.keys.map(o=>i(o.pubkey)),data:s.data}))}}const Ae=(r="publicKey")=>ve(32,r),bi=(r="string")=>{const e=z([F("length"),F("lengthPadding"),ve(tn(F(),-8),"chars")],r),t=e.decode.bind(e),n=e.encode.bind(e),i=e;return i.decode=(s,o)=>t(s,o).chars.toString(),i.encode=(s,o,a)=>{const c={chars:D.Buffer.from(s,"utf8")};return n(c,o,a)},i.alloc=s=>F().span+F().span+D.Buffer.from(s,"utf8").length,i},bw=(r="authorized")=>z([Ae("staker"),Ae("withdrawer")],r),vw=(r="lockup")=>z([We("unixTimestamp"),We("epoch"),Ae("custodian")],r),ww=(r="voteInit")=>z([Ae("nodePubkey"),Ae("authorizedVoter"),Ae("authorizedWithdrawer"),ie("commission")],r),_w=(r="voteAuthorizeWithSeedArgs")=>z([F("voteAuthorizationType"),Ae("currentAuthorityDerivedKeyOwnerPubkey"),bi("currentAuthorityDerivedKeySeed"),Ae("newAuthorized")],r);function Lh(r,e){const t=i=>{if(i.span>=0)return i.span;if(typeof i.alloc=="function")return i.alloc(e[i.property]);if("count"in i&&"elementLayout"in i){const s=e[i.property];if(Array.isArray(s))return s.length*t(i.elementLayout)}else if("fields"in i)return Lh({layout:i},e[i.property]);return 0};let n=0;return r.layout.fields.forEach(i=>{n+=t(i)}),n}function gs(r){let e=0,t=0;for(;;){let n=r.shift();if(e|=(n&127)<<t*7,t+=1,(n&128)===0)break}return e}function ms(r,e){let t=e;for(;;){let n=t&127;if(t>>=7,t==0){r.push(n);break}else n|=128,r.push(n)}}function Qt(r,e){if(!r)throw new Error(e||"Assertion failed")}class ll{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const n=new Map,i=o=>{const a=o.toBase58();let c=n.get(a);return c===void 0&&(c={isSigner:!1,isWritable:!1,isInvoked:!1},n.set(a,c)),c},s=i(t);s.isSigner=!0,s.isWritable=!0;for(const o of e){i(o.programId).isInvoked=!0;for(const a of o.keys){const c=i(a.pubkey);c.isSigner||=a.isSigner,c.isWritable||=a.isWritable}}return new ll(t,n)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];Qt(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,c])=>c.isSigner&&c.isWritable),n=e.filter(([,c])=>c.isSigner&&!c.isWritable),i=e.filter(([,c])=>!c.isSigner&&c.isWritable),s=e.filter(([,c])=>!c.isSigner&&!c.isWritable),o={numRequiredSignatures:t.length+n.length,numReadonlySignedAccounts:n.length,numReadonlyUnsignedAccounts:s.length};{Qt(t.length>0,"Expected at least one writable signer key");const[c]=t[0];Qt(c===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...t.map(([c])=>new ee(c)),...n.map(([c])=>new ee(c)),...i.map(([c])=>new ee(c)),...s.map(([c])=>new ee(c))];return[o,a]}extractTableLookup(e){const[t,n]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[i,s]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&i.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:i},{writable:n,readonly:s}]}drainKeysFoundInLookupTable(e,t){const n=new Array,i=new Array;for(const[s,o]of this.keyMetaMap.entries())if(t(o)){const a=new ee(s),c=e.findIndex(l=>l.equals(a));c>=0&&(Qt(c<256,"Max lookup table index exceeded"),n.push(c),i.push(a),this.keyMetaMap.delete(s))}return[n,i]}}class Ls{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new ee(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:ge.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new _d(this.staticAccountKeys)}static compile(e){const t=ll.compile(e.instructions,e.payerKey),[n,i]=t.getMessageComponents(),o=new _d(i).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:ge.encode(a.data)}));return new Ls({header:n,accountKeys:i,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const n=e-t,s=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return n<s}else{const n=t-this.header.numReadonlySignedAccounts;return e<n}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];ms(t,e);const n=this.instructions.map(h=>{const{accounts:b,programIdIndex:w}=h,k=Array.from(ge.decode(h.data));let g=[];ms(g,b.length);let _=[];return ms(_,k.length),{programIdIndex:w,keyIndicesCount:D.Buffer.from(g),keyIndices:b,dataLength:D.Buffer.from(_),data:k}});let i=[];ms(i,n.length);let s=D.Buffer.alloc(mu);D.Buffer.from(i).copy(s);let o=i.length;n.forEach(h=>{o+=z([ie("programIdIndex"),ve(h.keyIndicesCount.length,"keyIndicesCount"),Fe(ie("keyIndex"),h.keyIndices.length,"keyIndices"),ve(h.dataLength.length,"dataLength"),Fe(ie("userdatum"),h.data.length,"data")]).encode(h,s,o)}),s=s.slice(0,o);const a=z([ve(1,"numRequiredSignatures"),ve(1,"numReadonlySignedAccounts"),ve(1,"numReadonlyUnsignedAccounts"),ve(t.length,"keyCount"),Fe(Ae("key"),e,"keys"),Ae("recentBlockhash")]),c={numRequiredSignatures:D.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:D.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:D.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:D.Buffer.from(t),keys:this.accountKeys.map(h=>Vt(h.toBytes())),recentBlockhash:ge.decode(this.recentBlockhash)};let l=D.Buffer.alloc(2048);const u=a.encode(c,l);return s.copy(l,u),l.slice(0,u+s.length)}static from(e){let t=[...e];const n=t.shift();if(n!==(n&mw))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const i=t.shift(),s=t.shift(),o=gs(t);let a=[];for(let b=0;b<o;b++){const w=t.slice(0,Cr);t=t.slice(Cr),a.push(new ee(D.Buffer.from(w)))}const c=t.slice(0,Cr);t=t.slice(Cr);const l=gs(t);let u=[];for(let b=0;b<l;b++){const w=t.shift(),k=gs(t),g=t.slice(0,k);t=t.slice(k);const _=gs(t),I=t.slice(0,_),L=ge.encode(D.Buffer.from(I));t=t.slice(_),u.push({programIdIndex:w,accounts:g,data:L})}const h={header:{numRequiredSignatures:n,numReadonlySignedAccounts:i,numReadonlyUnsignedAccounts:s},recentBlockhash:ge.encode(D.Buffer.from(c)),accountKeys:a,instructions:u};return new Ls(h)}}const Aw=D.Buffer.alloc(bu).fill(0);class Me{constructor(e){this.keys=void 0,this.programId=void 0,this.data=D.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:n})=>({pubkey:e.toJSON(),isSigner:t,isWritable:n})),programId:this.programId.toJSON(),data:[...this.data]}}}class Qe{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:n}=e;this.minNonceContextSlot=t,this.nonceInfo=n}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:n}=e;this.recentBlockhash=t,this.lastValidBlockHeight=n}else{const{recentBlockhash:t,nonceInfo:n}=e;n&&(this.nonceInfo=n),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new Me(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let n;if(this.feePayer)n=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)n=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let g=0;g<t.length;g++)if(t[g].programId===void 0)throw new Error(`Transaction instruction index ${g} has undefined program id`);const i=[],s=[];t.forEach(g=>{g.keys.forEach(I=>{s.push({...I})});const _=g.programId.toString();i.includes(_)||i.push(_)}),i.forEach(g=>{s.push({pubkey:new ee(g),isSigner:!1,isWritable:!1})});const o=[];s.forEach(g=>{const _=g.pubkey.toString(),I=o.findIndex(L=>L.pubkey.toString()===_);I>-1?(o[I].isWritable=o[I].isWritable||g.isWritable,o[I].isSigner=o[I].isSigner||g.isSigner):o.push(g)}),o.sort(function(g,_){if(g.isSigner!==_.isSigner)return g.isSigner?-1:1;if(g.isWritable!==_.isWritable)return g.isWritable?-1:1;const I={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return g.pubkey.toBase58().localeCompare(_.pubkey.toBase58(),"en",I)});const a=o.findIndex(g=>g.pubkey.equals(n));if(a>-1){const[g]=o.splice(a,1);g.isSigner=!0,g.isWritable=!0,o.unshift(g)}else o.unshift({pubkey:n,isSigner:!0,isWritable:!0});for(const g of this.signatures){const _=o.findIndex(I=>I.pubkey.equals(g.publicKey));if(_>-1)o[_].isSigner||(o[_].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${g.publicKey.toString()}`)}let c=0,l=0,u=0;const h=[],b=[];o.forEach(({pubkey:g,isSigner:_,isWritable:I})=>{_?(h.push(g.toString()),c+=1,I||(l+=1)):(b.push(g.toString()),I||(u+=1))});const w=h.concat(b),k=t.map(g=>{const{data:_,programId:I}=g;return{programIdIndex:w.indexOf(I.toString()),accounts:g.keys.map(L=>w.indexOf(L.pubkey.toString())),data:ge.encode(_)}});return k.forEach(g=>{Qt(g.programIdIndex>=0),g.accounts.forEach(_=>Qt(_>=0))}),new Ls({header:{numRequiredSignatures:c,numReadonlySignedAccounts:l,numReadonlyUnsignedAccounts:u},accountKeys:w,recentBlockhash:e,instructions:k})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((i,s)=>t[s].equals(i.publicKey))||(this.signatures=t.map(n=>({signature:null,publicKey:n}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(n=>{const i=n.toString();return t.has(i)?!1:(t.add(i),!0)}).map(n=>({signature:null,publicKey:n}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}this.signatures=n.map(s=>({signature:null,publicKey:s.publicKey}));const i=this._compile();this._partialSign(i,...n)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),n.push(s))}const i=this._compile();this._partialSign(i,...n)}_partialSign(e,...t){const n=e.serialize();t.forEach(i=>{const s=fw(n,i.secretKey);this._addSignature(i.publicKey,Vt(s))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){Qt(t.length===64);const n=this.signatures.findIndex(i=>e.equals(i.publicKey));if(n<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[n].signature=D.Buffer.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:n,publicKey:i}of this.signatures)if(n===null){if(t)return!1}else if(!hw(n,e,i.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:n}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),i=this.serializeMessage();if(n&&!this._verifySignatures(i,t))throw new Error("Signature verification failed");return this._serialize(i)}_serialize(e){const{signatures:t}=this,n=[];ms(n,t.length);const i=n.length+t.length*64+e.length,s=D.Buffer.alloc(i);return Qt(t.length<256),D.Buffer.from(n).copy(s,0),t.forEach(({signature:o},a)=>{o!==null&&(Qt(o.length===64,"signature has invalid length"),D.Buffer.from(o).copy(s,n.length+a*64))}),e.copy(s,n.length+t.length*64),Qt(s.length<=mu,`Transaction too large: ${s.length} > ${mu}`),s}get keys(){return Qt(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return Qt(this.instructions.length===1),this.instructions[0].programId}get data(){return Qt(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const n=gs(t);let i=[];for(let s=0;s<n;s++){const o=t.slice(0,bu);t=t.slice(bu),i.push(ge.encode(D.Buffer.from(o)))}return Qe.populate(Ls.from(t),i)}static populate(e,t=[]){const n=new Qe;return n.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(n.feePayer=e.accountKeys[0]),t.forEach((i,s)=>{const o={signature:i==ge.encode(Aw)?null:ge.decode(i),publicKey:e.accountKeys[s]};n.signatures.push(o)}),e.instructions.forEach(i=>{const s=i.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:n.signatures.some(c=>c.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});n.instructions.push(new Me({keys:s,programId:e.accountKeys[i.programIdIndex],data:ge.decode(i.data)}))}),n._message=e,n._json=n.toJSON(),n}}new ee("SysvarC1ock11111111111111111111111111111111");new ee("SysvarEpochSchedu1e111111111111111111111111");new ee("Sysvar1nstructions1111111111111111111111111");const Dc=new ee("SysvarRecentB1ockHashes11111111111111111111"),vi=new ee("SysvarRent111111111111111111111111111111111");new ee("SysvarRewards111111111111111111111111111111");new ee("SysvarS1otHashes111111111111111111111111111");new ee("SysvarS1otHistory11111111111111111111111111");new ee("SysvarStakeHistory1111111111111111111111111");async function Sw(r,e,t,n){const i=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot},s=await r.sendTransaction(e,t,i);let o;if(e.recentBlockhash!=null&&e.lastValidBlockHeight!=null)o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,signature:s,blockhash:e.recentBlockhash,lastValidBlockHeight:e.lastValidBlockHeight},n&&n.commitment)).value;else if(e.minNonceContextSlot!=null&&e.nonceInfo!=null){const{nonceInstruction:a}=e.nonceInfo,c=a.keys[0].pubkey;o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,minContextSlot:e.minNonceContextSlot,nonceAccountPubkey:c,nonceValue:e.nonceInfo.nonce,signature:s},n&&n.commitment)).value}else(n==null?void 0:n.abortSignal)!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),o=(await r.confirmTransaction(s,n&&n.commitment)).value;if(o.err)throw new Error(`Transaction ${s} failed (${JSON.stringify(o)})`);return s}function on(r,e){const t=r.layout.span>=0?r.layout.span:Lh(r,e),n=D.Buffer.alloc(t),i=Object.assign({instruction:r.index},e);return r.layout.encode(i,n),n}const kw=ke("lamportsPerSignature"),Iw=z([F("version"),F("state"),Ae("authorizedPubkey"),Ae("nonce"),z([kw],"feeCalculator")]),Ad=Iw.span,Ew=r=>{const e=r.decode.bind(r),t=r.encode.bind(r);return{decode:e,encode:t}},Ow=r=>e=>{const t=ve(r,e),{encode:n,decode:i}=Ew(t),s=t;return s.decode=(o,a)=>{const c=i(o,a);return wf(D.Buffer.from(c))},s.encode=(o,a,c)=>{const l=Du(o,r);return n(l,a,c)},s},Ki=Ow(8),an=Object.freeze({Create:{index:0,layout:z([F("instruction"),We("lamports"),We("space"),Ae("programId")])},Assign:{index:1,layout:z([F("instruction"),Ae("programId")])},Transfer:{index:2,layout:z([F("instruction"),Ki("lamports")])},CreateWithSeed:{index:3,layout:z([F("instruction"),Ae("base"),bi("seed"),We("lamports"),We("space"),Ae("programId")])},AdvanceNonceAccount:{index:4,layout:z([F("instruction")])},WithdrawNonceAccount:{index:5,layout:z([F("instruction"),We("lamports")])},InitializeNonceAccount:{index:6,layout:z([F("instruction"),Ae("authorized")])},AuthorizeNonceAccount:{index:7,layout:z([F("instruction"),Ae("authorized")])},Allocate:{index:8,layout:z([F("instruction"),We("space")])},AllocateWithSeed:{index:9,layout:z([F("instruction"),Ae("base"),bi("seed"),We("space"),Ae("programId")])},AssignWithSeed:{index:10,layout:z([F("instruction"),Ae("base"),bi("seed"),Ae("programId")])},TransferWithSeed:{index:11,layout:z([F("instruction"),Ki("lamports"),bi("seed"),Ae("programId")])},UpgradeNonceAccount:{index:12,layout:z([F("instruction")])}});class xn{constructor(){}static createAccount(e){const t=an.Create,n=on(t,{lamports:e.lamports,space:e.space,programId:Vt(e.programId.toBuffer())});return new Me({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:n})}static transfer(e){let t,n;if("basePubkey"in e){const i=an.TransferWithSeed;t=on(i,{lamports:BigInt(e.lamports),seed:e.seed,programId:Vt(e.programId.toBuffer())}),n=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}else{const i=an.Transfer;t=on(i,{lamports:BigInt(e.lamports)}),n=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}return new Me({keys:n,programId:this.programId,data:t})}static assign(e){let t,n;if("basePubkey"in e){const i=an.AssignWithSeed;t=on(i,{base:Vt(e.basePubkey.toBuffer()),seed:e.seed,programId:Vt(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=an.Assign;t=on(i,{programId:Vt(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new Me({keys:n,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=an.CreateWithSeed,n=on(t,{base:Vt(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:Vt(e.programId.toBuffer())});let i=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey!=e.fromPubkey&&i.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new Me({keys:i,programId:this.programId,data:n})}static createNonceAccount(e){const t=new Qe;"basePubkey"in e&&"seed"in e?t.add(xn.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:Ad,programId:this.programId})):t.add(xn.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:Ad,programId:this.programId}));const n={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(n)),t}static nonceInitialize(e){const t=an.InitializeNonceAccount,n=on(t,{authorized:Vt(e.authorizedPubkey.toBuffer())}),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Dc,isSigner:!1,isWritable:!1},{pubkey:vi,isSigner:!1,isWritable:!1}],programId:this.programId,data:n};return new Me(i)}static nonceAdvance(e){const t=an.AdvanceNonceAccount,n=on(t),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Dc,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n};return new Me(i)}static nonceWithdraw(e){const t=an.WithdrawNonceAccount,n=on(t,{lamports:e.lamports});return new Me({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:Dc,isSigner:!1,isWritable:!1},{pubkey:vi,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static nonceAuthorize(e){const t=an.AuthorizeNonceAccount,n=on(t,{authorized:Vt(e.newAuthorizedPubkey.toBuffer())});return new Me({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static allocate(e){let t,n;if("basePubkey"in e){const i=an.AllocateWithSeed;t=on(i,{base:Vt(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:Vt(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=an.Allocate;t=on(i,{space:e.space}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new Me({keys:n,programId:this.programId,data:t})}}xn.programId=new ee("11111111111111111111111111111111");new ee("BPFLoader2111111111111111111111111111111111");z([F("typeIndex"),Ki("deactivationSlot"),ke("lastExtendedSlot"),ie("lastExtendedStartIndex"),ie(),Fe(Ae(),tn(ie(),-1),"authority")]);const dt=Un(Yi(ee),P(),r=>new ee(r)),Nh=Qi([P(),ce("base64")]),dl=Un(Yi(D.Buffer),Nh,r=>D.Buffer.from(r[0],"base64"));function Dh(r){return Ce([A({jsonrpc:ce("2.0"),id:P(),result:r}),A({jsonrpc:ce("2.0"),id:P(),error:A({code:Fn(),message:P(),data:j(uh())})})])}const Pw=Dh(Fn());function ze(r){return Un(Dh(r),Pw,e=>"error"in e?e:{...e,result:H(e.result,r)})}function gn(r){return ze(A({context:A({slot:y()}),value:r}))}function Ka(r){return A({context:A({slot:y()}),value:r})}const Tw=A({foundation:y(),foundationTerm:y(),initial:y(),taper:y(),terminal:y()});ze(C(x(A({epoch:y(),effectiveSlot:y(),amount:y(),postBalance:y(),commission:j(x(y()))}))));const Bw=C(A({slot:y(),prioritizationFee:y()})),Rw=A({total:y(),validator:y(),foundation:y(),epoch:y()}),xw=A({epoch:y(),slotIndex:y(),slotsInEpoch:y(),absoluteSlot:y(),blockHeight:j(y()),transactionCount:j(y())}),Mw=A({slotsPerEpoch:y(),leaderScheduleSlotOffset:y(),warmup:ot(),firstNormalEpoch:y(),firstNormalSlot:y()}),Cw=Oa(P(),C(y())),Zr=x(Ce([A({}),P()])),Kw=A({err:Zr}),Lw=ce("receivedSignature");A({"solana-core":P(),"feature-set":j(y())});gn(A({err:x(Ce([A({}),P()])),logs:x(C(P())),accounts:j(x(C(x(A({executable:ot(),owner:P(),lamports:y(),data:C(P()),rentEpoch:j(y())}))))),unitsConsumed:j(y()),returnData:j(x(A({programId:P(),data:Qi([P(),ce("base64")])})))}));gn(A({byIdentity:Oa(P(),C(y())),range:A({firstSlot:y(),lastSlot:y()})}));ze(Tw);ze(Rw);ze(Bw);ze(xw);ze(Mw);ze(Cw);ze(y());gn(A({total:y(),circulating:y(),nonCirculating:y(),nonCirculatingAccounts:C(dt)}));const Nw=A({amount:P(),uiAmount:x(y()),decimals:y(),uiAmountString:j(P())});gn(C(A({address:dt,amount:P(),uiAmount:x(y()),decimals:y(),uiAmountString:j(P())})));gn(C(A({pubkey:dt,account:A({executable:ot(),owner:dt,lamports:y(),data:dl,rentEpoch:y()})})));const vu=A({program:P(),parsed:Fn(),space:y()});gn(C(A({pubkey:dt,account:A({executable:ot(),owner:dt,lamports:y(),data:vu,rentEpoch:y()})})));gn(C(A({lamports:y(),address:dt})));const fl=A({executable:ot(),owner:dt,lamports:y(),data:dl,rentEpoch:y()});A({pubkey:dt,account:fl});const Dw=Un(Ce([Yi(D.Buffer),vu]),Ce([Nh,vu]),r=>Array.isArray(r)?H(r,dl):r),Vw=A({executable:ot(),owner:dt,lamports:y(),data:Dw,rentEpoch:y()});A({pubkey:dt,account:Vw});A({state:Ce([ce("active"),ce("inactive"),ce("activating"),ce("deactivating")]),active:y(),inactive:y()});ze(C(A({signature:P(),slot:y(),err:Zr,memo:x(P()),blockTime:j(x(y()))})));ze(C(A({signature:P(),slot:y(),err:Zr,memo:x(P()),blockTime:j(x(y()))})));A({subscription:y(),result:Ka(fl)});const zw=A({pubkey:dt,account:fl});A({subscription:y(),result:Ka(zw)});const Fw=A({parent:y(),slot:y(),root:y()});A({subscription:y(),result:Fw});const Uw=Ce([A({type:Ce([ce("firstShredReceived"),ce("completed"),ce("optimisticConfirmation"),ce("root")]),slot:y(),timestamp:y()}),A({type:ce("createdBank"),parent:y(),slot:y(),timestamp:y()}),A({type:ce("frozen"),slot:y(),timestamp:y(),stats:A({numTransactionEntries:y(),numSuccessfulTransactions:y(),numFailedTransactions:y(),maxTransactionsPerEntry:y()})}),A({type:ce("dead"),slot:y(),timestamp:y(),err:P()})]);A({subscription:y(),result:Uw});A({subscription:y(),result:Ka(Ce([Kw,Lw]))});A({subscription:y(),result:y()});A({pubkey:P(),gossip:x(P()),tpu:x(P()),rpc:x(P()),version:x(P())});const Sd=A({votePubkey:P(),nodePubkey:P(),activatedStake:y(),epochVoteAccount:ot(),epochCredits:C(Qi([y(),y(),y()])),commission:y(),lastVote:y(),rootSlot:x(y())});ze(A({current:C(Sd),delinquent:C(Sd)}));const $w=Ce([ce("processed"),ce("confirmed"),ce("finalized")]),Ww=A({slot:y(),confirmations:x(y()),err:Zr,confirmationStatus:j($w)});gn(C(x(Ww)));ze(y());const Vh=A({accountKey:dt,writableIndexes:C(y()),readonlyIndexes:C(y())}),hl=A({signatures:C(P()),message:A({accountKeys:C(P()),header:A({numRequiredSignatures:y(),numReadonlySignedAccounts:y(),numReadonlyUnsignedAccounts:y()}),instructions:C(A({accounts:C(y()),data:P(),programIdIndex:y()})),recentBlockhash:P(),addressTableLookups:j(C(Vh))})}),zh=A({pubkey:dt,signer:ot(),writable:ot(),source:j(Ce([ce("transaction"),ce("lookupTable")]))}),Fh=A({accountKeys:C(zh),signatures:C(P())}),Uh=A({parsed:Fn(),program:P(),programId:dt}),$h=A({accounts:C(dt),data:P(),programId:dt}),jw=Ce([$h,Uh]),qw=Ce([A({parsed:Fn(),program:P(),programId:P()}),A({accounts:C(P()),data:P(),programId:P()})]),Wh=Un(jw,qw,r=>"accounts"in r?H(r,$h):H(r,Uh)),jh=A({signatures:C(P()),message:A({accountKeys:C(zh),instructions:C(Wh),recentBlockhash:P(),addressTableLookups:j(x(C(Vh)))})}),Jo=A({accountIndex:y(),mint:P(),owner:j(P()),uiTokenAmount:Nw}),qh=A({writable:C(dt),readonly:C(dt)}),La=A({err:Zr,fee:y(),innerInstructions:j(x(C(A({index:y(),instructions:C(A({accounts:C(y()),data:P(),programIdIndex:y()}))})))),preBalances:C(y()),postBalances:C(y()),logMessages:j(x(C(P()))),preTokenBalances:j(x(C(Jo))),postTokenBalances:j(x(C(Jo))),loadedAddresses:j(qh),computeUnitsConsumed:j(y())}),pl=A({err:Zr,fee:y(),innerInstructions:j(x(C(A({index:y(),instructions:C(Wh)})))),preBalances:C(y()),postBalances:C(y()),logMessages:j(x(C(P()))),preTokenBalances:j(x(C(Jo))),postTokenBalances:j(x(C(Jo))),loadedAddresses:j(qh),computeUnitsConsumed:j(y())}),Zi=Ce([ce(0),ce("legacy")]),ei=A({pubkey:P(),lamports:y(),postBalance:x(y()),rewardType:x(P()),commission:j(x(y()))});ze(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),transactions:C(A({transaction:hl,meta:x(La),version:j(Zi)})),rewards:j(C(ei)),blockTime:x(y()),blockHeight:x(y())})));ze(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),rewards:j(C(ei)),blockTime:x(y()),blockHeight:x(y())})));ze(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),transactions:C(A({transaction:Fh,meta:x(La),version:j(Zi)})),rewards:j(C(ei)),blockTime:x(y()),blockHeight:x(y())})));ze(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),transactions:C(A({transaction:jh,meta:x(pl),version:j(Zi)})),rewards:j(C(ei)),blockTime:x(y()),blockHeight:x(y())})));ze(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),transactions:C(A({transaction:Fh,meta:x(pl),version:j(Zi)})),rewards:j(C(ei)),blockTime:x(y()),blockHeight:x(y())})));ze(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),rewards:j(C(ei)),blockTime:x(y()),blockHeight:x(y())})));ze(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),transactions:C(A({transaction:hl,meta:x(La)})),rewards:j(C(ei)),blockTime:x(y())})));ze(x(A({blockhash:P(),previousBlockhash:P(),parentSlot:y(),signatures:C(P()),blockTime:x(y())})));ze(x(A({slot:y(),meta:La,blockTime:j(x(y())),transaction:hl,version:j(Zi)})));ze(x(A({slot:y(),transaction:jh,meta:x(pl),blockTime:j(x(y())),version:j(Zi)})));gn(A({blockhash:P(),feeCalculator:A({lamportsPerSignature:y()})}));gn(A({blockhash:P(),lastValidBlockHeight:y()}));gn(ot());const Gw=A({slot:y(),numTransactions:y(),numSlots:y(),samplePeriodSecs:y()});ze(C(Gw));gn(x(A({feeCalculator:A({lamportsPerSignature:y()})})));ze(P());ze(P());const Hw=A({err:Zr,logs:C(P()),signature:P()});A({result:Ka(Hw),subscription:y()});class cr{constructor(e){this._keypair=void 0,this._keypair=e??bd()}static generate(){return new cr(bd())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const n=e.slice(32,64);if(!t||!t.skipValidation){const i=e.slice(0,32),s=gu(i);for(let o=0;o<32;o++)if(n[o]!==s[o])throw new Error("provided secretKey is invalid")}return new cr({publicKey:n,secretKey:e})}static fromSeed(e){const t=gu(e),n=new Uint8Array(64);return n.set(e),n.set(t,32),new cr({publicKey:t,secretKey:n})}get publicKey(){return new ee(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}Object.freeze({CreateLookupTable:{index:0,layout:z([F("instruction"),Ki("recentSlot"),ie("bumpSeed")])},FreezeLookupTable:{index:1,layout:z([F("instruction")])},ExtendLookupTable:{index:2,layout:z([F("instruction"),Ki(),Fe(Ae(),tn(F(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:z([F("instruction")])},CloseLookupTable:{index:4,layout:z([F("instruction")])}});new ee("AddressLookupTab1e1111111111111111111111111");Object.freeze({RequestUnits:{index:0,layout:z([ie("instruction"),F("units"),F("additionalFee")])},RequestHeapFrame:{index:1,layout:z([ie("instruction"),F("bytes")])},SetComputeUnitLimit:{index:2,layout:z([ie("instruction"),F("units")])},SetComputeUnitPrice:{index:3,layout:z([ie("instruction"),Ki("microLamports")])}});new ee("ComputeBudget111111111111111111111111111111");z([ie("numSignatures"),ie("padding"),et("signatureOffset"),et("signatureInstructionIndex"),et("publicKeyOffset"),et("publicKeyInstructionIndex"),et("messageDataOffset"),et("messageDataSize"),et("messageInstructionIndex")]);new ee("Ed25519SigVerify111111111111111111111111111");Ws.utils.isValidPrivateKey;Ws.getPublicKey;z([ie("numSignatures"),et("signatureOffset"),ie("signatureInstructionIndex"),et("ethAddressOffset"),ie("ethAddressInstructionIndex"),et("messageDataOffset"),et("messageDataSize"),ie("messageInstructionIndex"),ve(20,"ethAddress"),ve(64,"signature"),ie("recoveryId")]);new ee("KeccakSecp256k11111111111111111111111111111");var Gh;new ee("StakeConfig11111111111111111111111111111111");class Hh{constructor(e,t,n){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=n}}Gh=Hh;Hh.default=new Gh(0,0,ee.default);Object.freeze({Initialize:{index:0,layout:z([F("instruction"),bw(),vw()])},Authorize:{index:1,layout:z([F("instruction"),Ae("newAuthorized"),F("stakeAuthorizationType")])},Delegate:{index:2,layout:z([F("instruction")])},Split:{index:3,layout:z([F("instruction"),We("lamports")])},Withdraw:{index:4,layout:z([F("instruction"),We("lamports")])},Deactivate:{index:5,layout:z([F("instruction")])},Merge:{index:7,layout:z([F("instruction")])},AuthorizeWithSeed:{index:8,layout:z([F("instruction"),Ae("newAuthorized"),F("stakeAuthorizationType"),bi("authoritySeed"),Ae("authorityOwner")])}});Object.freeze({Staker:{index:0},Withdrawer:{index:1}});new ee("Stake11111111111111111111111111111111111111");Object.freeze({InitializeAccount:{index:0,layout:z([F("instruction"),ww()])},Authorize:{index:1,layout:z([F("instruction"),Ae("newAuthorized"),F("voteAuthorizationType")])},Withdraw:{index:3,layout:z([F("instruction"),We("lamports")])},AuthorizeWithSeed:{index:10,layout:z([F("instruction"),_w()])}});Object.freeze({Voter:{index:0},Withdrawer:{index:1}});new ee("Vote111111111111111111111111111111111111111");new ee("Va1idator1nfo111111111111111111111111111111");A({name:P(),website:j(P()),details:j(P()),keybaseUsername:j(P())});new ee("Vote111111111111111111111111111111111111111");z([Ae("nodePubkey"),Ae("authorizedWithdrawer"),ie("commission"),ke(),Fe(z([ke("slot"),F("confirmationCount")]),tn(F(),-8),"votes"),ie("rootSlotValid"),ke("rootSlot"),ke(),Fe(z([ke("epoch"),Ae("authorizedVoter")]),tn(F(),-8),"authorizedVoters"),z([Fe(z([Ae("authorizedPubkey"),ke("epochOfLastAuthorizedSwitch"),ke("targetEpoch")]),32,"buf"),ke("idx"),ie("isEmpty")],"priorVoters"),ke(),Fe(z([ke("epoch"),ke("credits"),ke("prevCredits")]),tn(F(),-8),"epochCredits"),z([ke("slot"),ke("timestamp")],"lastTimestamp")]);var Pe={},Na={};Na.byteLength=Jw;Na.toByteArray=Zw;Na.fromByteArray=n_;var Cn=[],cn=[],Yw=typeof Uint8Array<"u"?Uint8Array:Array,Vc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var ci=0,Qw=Vc.length;ci<Qw;++ci)Cn[ci]=Vc[ci],cn[Vc.charCodeAt(ci)]=ci;cn["-".charCodeAt(0)]=62;cn["_".charCodeAt(0)]=63;function Yh(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function Jw(r){var e=Yh(r),t=e[0],n=e[1];return(t+n)*3/4-n}function Xw(r,e,t){return(e+t)*3/4-t}function Zw(r){var e,t=Yh(r),n=t[0],i=t[1],s=new Yw(Xw(r,n,i)),o=0,a=i>0?n-4:n,c;for(c=0;c<a;c+=4)e=cn[r.charCodeAt(c)]<<18|cn[r.charCodeAt(c+1)]<<12|cn[r.charCodeAt(c+2)]<<6|cn[r.charCodeAt(c+3)],s[o++]=e>>16&255,s[o++]=e>>8&255,s[o++]=e&255;return i===2&&(e=cn[r.charCodeAt(c)]<<2|cn[r.charCodeAt(c+1)]>>4,s[o++]=e&255),i===1&&(e=cn[r.charCodeAt(c)]<<10|cn[r.charCodeAt(c+1)]<<4|cn[r.charCodeAt(c+2)]>>2,s[o++]=e>>8&255,s[o++]=e&255),s}function e_(r){return Cn[r>>18&63]+Cn[r>>12&63]+Cn[r>>6&63]+Cn[r&63]}function t_(r,e,t){for(var n,i=[],s=e;s<t;s+=3)n=(r[s]<<16&16711680)+(r[s+1]<<8&65280)+(r[s+2]&255),i.push(e_(n));return i.join("")}function n_(r){for(var e,t=r.length,n=t%3,i=[],s=16383,o=0,a=t-n;o<a;o+=s)i.push(t_(r,o,o+s>a?a:o+s));return n===1?(e=r[t-1],i.push(Cn[e>>2]+Cn[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push(Cn[e>>10]+Cn[e>>4&63]+Cn[e<<2&63]+"=")),i.join("")}var yl={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */yl.read=function(r,e,t,n,i){var s,o,a=i*8-n-1,c=(1<<a)-1,l=c>>1,u=-7,h=t?i-1:0,b=t?-1:1,w=r[e+h];for(h+=b,s=w&(1<<-u)-1,w>>=-u,u+=a;u>0;s=s*256+r[e+h],h+=b,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=n;u>0;o=o*256+r[e+h],h+=b,u-=8);if(s===0)s=1-l;else{if(s===c)return o?NaN:(w?-1:1)*(1/0);o=o+Math.pow(2,n),s=s-l}return(w?-1:1)*o*Math.pow(2,s-n)};yl.write=function(r,e,t,n,i,s){var o,a,c,l=s*8-i-1,u=(1<<l)-1,h=u>>1,b=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=n?0:s-1,k=n?1:-1,g=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),o+h>=1?e+=b/c:e+=b*Math.pow(2,1-h),e*c>=2&&(o++,c/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(e*c-1)*Math.pow(2,i),o=o+h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;r[t+w]=a&255,w+=k,a/=256,i-=8);for(o=o<<i|a,l+=i;l>0;r[t+w]=o&255,w+=k,o/=256,l-=8);r[t+w-k]|=g*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(r){const e=Na,t=yl,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;r.Buffer=a,r.SlowBuffer=L,r.INSPECT_MAX_BYTES=50;const i=2147483647;r.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const p=new Uint8Array(1),d={foo:function(){return 42}};return Object.setPrototypeOf(d,Uint8Array.prototype),Object.setPrototypeOf(p,d),p.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(!!a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(!!a.isBuffer(this))return this.byteOffset}});function o(p){if(p>i)throw new RangeError('The value "'+p+'" is invalid for option "size"');const d=new Uint8Array(p);return Object.setPrototypeOf(d,a.prototype),d}function a(p,d,f){if(typeof p=="number"){if(typeof d=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return h(p)}return c(p,d,f)}a.poolSize=8192;function c(p,d,f){if(typeof p=="string")return b(p,d);if(ArrayBuffer.isView(p))return k(p);if(p==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p);if(Pn(p,ArrayBuffer)||p&&Pn(p.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Pn(p,SharedArrayBuffer)||p&&Pn(p.buffer,SharedArrayBuffer)))return g(p,d,f);if(typeof p=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const m=p.valueOf&&p.valueOf();if(m!=null&&m!==p)return a.from(m,d,f);const E=_(p);if(E)return E;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof p[Symbol.toPrimitive]=="function")return a.from(p[Symbol.toPrimitive]("string"),d,f);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof p)}a.from=function(p,d,f){return c(p,d,f)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(p){if(typeof p!="number")throw new TypeError('"size" argument must be of type number');if(p<0)throw new RangeError('The value "'+p+'" is invalid for option "size"')}function u(p,d,f){return l(p),p<=0?o(p):d!==void 0?typeof f=="string"?o(p).fill(d,f):o(p).fill(d):o(p)}a.alloc=function(p,d,f){return u(p,d,f)};function h(p){return l(p),o(p<0?0:I(p)|0)}a.allocUnsafe=function(p){return h(p)},a.allocUnsafeSlow=function(p){return h(p)};function b(p,d){if((typeof d!="string"||d==="")&&(d="utf8"),!a.isEncoding(d))throw new TypeError("Unknown encoding: "+d);const f=G(p,d)|0;let m=o(f);const E=m.write(p,d);return E!==f&&(m=m.slice(0,E)),m}function w(p){const d=p.length<0?0:I(p.length)|0,f=o(d);for(let m=0;m<d;m+=1)f[m]=p[m]&255;return f}function k(p){if(Pn(p,Uint8Array)){const d=new Uint8Array(p);return g(d.buffer,d.byteOffset,d.byteLength)}return w(p)}function g(p,d,f){if(d<0||p.byteLength<d)throw new RangeError('"offset" is outside of buffer bounds');if(p.byteLength<d+(f||0))throw new RangeError('"length" is outside of buffer bounds');let m;return d===void 0&&f===void 0?m=new Uint8Array(p):f===void 0?m=new Uint8Array(p,d):m=new Uint8Array(p,d,f),Object.setPrototypeOf(m,a.prototype),m}function _(p){if(a.isBuffer(p)){const d=I(p.length)|0,f=o(d);return f.length===0||p.copy(f,0,0,d),f}if(p.length!==void 0)return typeof p.length!="number"||Oc(p.length)?o(0):w(p);if(p.type==="Buffer"&&Array.isArray(p.data))return w(p.data)}function I(p){if(p>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return p|0}function L(p){return+p!=p&&(p=0),a.alloc(+p)}a.isBuffer=function(d){return d!=null&&d._isBuffer===!0&&d!==a.prototype},a.compare=function(d,f){if(Pn(d,Uint8Array)&&(d=a.from(d,d.offset,d.byteLength)),Pn(f,Uint8Array)&&(f=a.from(f,f.offset,f.byteLength)),!a.isBuffer(d)||!a.isBuffer(f))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(d===f)return 0;let m=d.length,E=f.length;for(let B=0,V=Math.min(m,E);B<V;++B)if(d[B]!==f[B]){m=d[B],E=f[B];break}return m<E?-1:E<m?1:0},a.isEncoding=function(d){switch(String(d).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(d,f){if(!Array.isArray(d))throw new TypeError('"list" argument must be an Array of Buffers');if(d.length===0)return a.alloc(0);let m;if(f===void 0)for(f=0,m=0;m<d.length;++m)f+=d[m].length;const E=a.allocUnsafe(f);let B=0;for(m=0;m<d.length;++m){let V=d[m];if(Pn(V,Uint8Array))B+V.length>E.length?(a.isBuffer(V)||(V=a.from(V)),V.copy(E,B)):Uint8Array.prototype.set.call(E,V,B);else if(a.isBuffer(V))V.copy(E,B);else throw new TypeError('"list" argument must be an Array of Buffers');B+=V.length}return E};function G(p,d){if(a.isBuffer(p))return p.length;if(ArrayBuffer.isView(p)||Pn(p,ArrayBuffer))return p.byteLength;if(typeof p!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof p);const f=p.length,m=arguments.length>2&&arguments[2]===!0;if(!m&&f===0)return 0;let E=!1;for(;;)switch(d){case"ascii":case"latin1":case"binary":return f;case"utf8":case"utf-8":return Ec(p).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f*2;case"hex":return f>>>1;case"base64":return zl(p).length;default:if(E)return m?-1:Ec(p).length;d=(""+d).toLowerCase(),E=!0}}a.byteLength=G;function $(p,d,f){let m=!1;if((d===void 0||d<0)&&(d=0),d>this.length||((f===void 0||f>this.length)&&(f=this.length),f<=0)||(f>>>=0,d>>>=0,f<=d))return"";for(p||(p="utf8");;)switch(p){case"hex":return yt(this,d,f);case"utf8":case"utf-8":return K(this,d,f);case"ascii":return X(this,d,f);case"latin1":case"binary":return le(this,d,f);case"base64":return S(this,d,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Rt(this,d,f);default:if(m)throw new TypeError("Unknown encoding: "+p);p=(p+"").toLowerCase(),m=!0}}a.prototype._isBuffer=!0;function Q(p,d,f){const m=p[d];p[d]=p[f],p[f]=m}a.prototype.swap16=function(){const d=this.length;if(d%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let f=0;f<d;f+=2)Q(this,f,f+1);return this},a.prototype.swap32=function(){const d=this.length;if(d%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let f=0;f<d;f+=4)Q(this,f,f+3),Q(this,f+1,f+2);return this},a.prototype.swap64=function(){const d=this.length;if(d%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let f=0;f<d;f+=8)Q(this,f,f+7),Q(this,f+1,f+6),Q(this,f+2,f+5),Q(this,f+3,f+4);return this},a.prototype.toString=function(){const d=this.length;return d===0?"":arguments.length===0?K(this,0,d):$.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(d){if(!a.isBuffer(d))throw new TypeError("Argument must be a Buffer");return this===d?!0:a.compare(this,d)===0},a.prototype.inspect=function(){let d="";const f=r.INSPECT_MAX_BYTES;return d=this.toString("hex",0,f).replace(/(.{2})/g,"$1 ").trim(),this.length>f&&(d+=" ... "),"<Buffer "+d+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(d,f,m,E,B){if(Pn(d,Uint8Array)&&(d=a.from(d,d.offset,d.byteLength)),!a.isBuffer(d))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof d);if(f===void 0&&(f=0),m===void 0&&(m=d?d.length:0),E===void 0&&(E=0),B===void 0&&(B=this.length),f<0||m>d.length||E<0||B>this.length)throw new RangeError("out of range index");if(E>=B&&f>=m)return 0;if(E>=B)return-1;if(f>=m)return 1;if(f>>>=0,m>>>=0,E>>>=0,B>>>=0,this===d)return 0;let V=B-E,ye=m-f;const Je=Math.min(V,ye),Ue=this.slice(E,B),Xe=d.slice(f,m);for(let Le=0;Le<Je;++Le)if(Ue[Le]!==Xe[Le]){V=Ue[Le],ye=Xe[Le];break}return V<ye?-1:ye<V?1:0};function v(p,d,f,m,E){if(p.length===0)return-1;if(typeof f=="string"?(m=f,f=0):f>2147483647?f=2147483647:f<-2147483648&&(f=-2147483648),f=+f,Oc(f)&&(f=E?0:p.length-1),f<0&&(f=p.length+f),f>=p.length){if(E)return-1;f=p.length-1}else if(f<0)if(E)f=0;else return-1;if(typeof d=="string"&&(d=a.from(d,m)),a.isBuffer(d))return d.length===0?-1:O(p,d,f,m,E);if(typeof d=="number")return d=d&255,typeof Uint8Array.prototype.indexOf=="function"?E?Uint8Array.prototype.indexOf.call(p,d,f):Uint8Array.prototype.lastIndexOf.call(p,d,f):O(p,[d],f,m,E);throw new TypeError("val must be string, number or Buffer")}function O(p,d,f,m,E){let B=1,V=p.length,ye=d.length;if(m!==void 0&&(m=String(m).toLowerCase(),m==="ucs2"||m==="ucs-2"||m==="utf16le"||m==="utf-16le")){if(p.length<2||d.length<2)return-1;B=2,V/=2,ye/=2,f/=2}function Je(Xe,Le){return B===1?Xe[Le]:Xe.readUInt16BE(Le*B)}let Ue;if(E){let Xe=-1;for(Ue=f;Ue<V;Ue++)if(Je(p,Ue)===Je(d,Xe===-1?0:Ue-Xe)){if(Xe===-1&&(Xe=Ue),Ue-Xe+1===ye)return Xe*B}else Xe!==-1&&(Ue-=Ue-Xe),Xe=-1}else for(f+ye>V&&(f=V-ye),Ue=f;Ue>=0;Ue--){let Xe=!0;for(let Le=0;Le<ye;Le++)if(Je(p,Ue+Le)!==Je(d,Le)){Xe=!1;break}if(Xe)return Ue}return-1}a.prototype.includes=function(d,f,m){return this.indexOf(d,f,m)!==-1},a.prototype.indexOf=function(d,f,m){return v(this,d,f,m,!0)},a.prototype.lastIndexOf=function(d,f,m){return v(this,d,f,m,!1)};function R(p,d,f,m){f=Number(f)||0;const E=p.length-f;m?(m=Number(m),m>E&&(m=E)):m=E;const B=d.length;m>B/2&&(m=B/2);let V;for(V=0;V<m;++V){const ye=parseInt(d.substr(V*2,2),16);if(Oc(ye))return V;p[f+V]=ye}return V}function N(p,d,f,m){return ho(Ec(d,p.length-f),p,f,m)}function M(p,d,f,m){return ho(ig(d),p,f,m)}function J(p,d,f,m){return ho(zl(d),p,f,m)}function re(p,d,f,m){return ho(sg(d,p.length-f),p,f,m)}a.prototype.write=function(d,f,m,E){if(f===void 0)E="utf8",m=this.length,f=0;else if(m===void 0&&typeof f=="string")E=f,m=this.length,f=0;else if(isFinite(f))f=f>>>0,isFinite(m)?(m=m>>>0,E===void 0&&(E="utf8")):(E=m,m=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const B=this.length-f;if((m===void 0||m>B)&&(m=B),d.length>0&&(m<0||f<0)||f>this.length)throw new RangeError("Attempt to write outside buffer bounds");E||(E="utf8");let V=!1;for(;;)switch(E){case"hex":return R(this,d,f,m);case"utf8":case"utf-8":return N(this,d,f,m);case"ascii":case"latin1":case"binary":return M(this,d,f,m);case"base64":return J(this,d,f,m);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,d,f,m);default:if(V)throw new TypeError("Unknown encoding: "+E);E=(""+E).toLowerCase(),V=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function S(p,d,f){return d===0&&f===p.length?e.fromByteArray(p):e.fromByteArray(p.slice(d,f))}function K(p,d,f){f=Math.min(p.length,f);const m=[];let E=d;for(;E<f;){const B=p[E];let V=null,ye=B>239?4:B>223?3:B>191?2:1;if(E+ye<=f){let Je,Ue,Xe,Le;switch(ye){case 1:B<128&&(V=B);break;case 2:Je=p[E+1],(Je&192)===128&&(Le=(B&31)<<6|Je&63,Le>127&&(V=Le));break;case 3:Je=p[E+1],Ue=p[E+2],(Je&192)===128&&(Ue&192)===128&&(Le=(B&15)<<12|(Je&63)<<6|Ue&63,Le>2047&&(Le<55296||Le>57343)&&(V=Le));break;case 4:Je=p[E+1],Ue=p[E+2],Xe=p[E+3],(Je&192)===128&&(Ue&192)===128&&(Xe&192)===128&&(Le=(B&15)<<18|(Je&63)<<12|(Ue&63)<<6|Xe&63,Le>65535&&Le<1114112&&(V=Le))}}V===null?(V=65533,ye=1):V>65535&&(V-=65536,m.push(V>>>10&1023|55296),V=56320|V&1023),m.push(V),E+=ye}return ue(m)}const U=4096;function ue(p){const d=p.length;if(d<=U)return String.fromCharCode.apply(String,p);let f="",m=0;for(;m<d;)f+=String.fromCharCode.apply(String,p.slice(m,m+=U));return f}function X(p,d,f){let m="";f=Math.min(p.length,f);for(let E=d;E<f;++E)m+=String.fromCharCode(p[E]&127);return m}function le(p,d,f){let m="";f=Math.min(p.length,f);for(let E=d;E<f;++E)m+=String.fromCharCode(p[E]);return m}function yt(p,d,f){const m=p.length;(!d||d<0)&&(d=0),(!f||f<0||f>m)&&(f=m);let E="";for(let B=d;B<f;++B)E+=og[p[B]];return E}function Rt(p,d,f){const m=p.slice(d,f);let E="";for(let B=0;B<m.length-1;B+=2)E+=String.fromCharCode(m[B]+m[B+1]*256);return E}a.prototype.slice=function(d,f){const m=this.length;d=~~d,f=f===void 0?m:~~f,d<0?(d+=m,d<0&&(d=0)):d>m&&(d=m),f<0?(f+=m,f<0&&(f=0)):f>m&&(f=m),f<d&&(f=d);const E=this.subarray(d,f);return Object.setPrototypeOf(E,a.prototype),E};function oe(p,d,f){if(p%1!==0||p<0)throw new RangeError("offset is not uint");if(p+d>f)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(d,f,m){d=d>>>0,f=f>>>0,m||oe(d,f,this.length);let E=this[d],B=1,V=0;for(;++V<f&&(B*=256);)E+=this[d+V]*B;return E},a.prototype.readUintBE=a.prototype.readUIntBE=function(d,f,m){d=d>>>0,f=f>>>0,m||oe(d,f,this.length);let E=this[d+--f],B=1;for(;f>0&&(B*=256);)E+=this[d+--f]*B;return E},a.prototype.readUint8=a.prototype.readUInt8=function(d,f){return d=d>>>0,f||oe(d,1,this.length),this[d]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(d,f){return d=d>>>0,f||oe(d,2,this.length),this[d]|this[d+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(d,f){return d=d>>>0,f||oe(d,2,this.length),this[d]<<8|this[d+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(d,f){return d=d>>>0,f||oe(d,4,this.length),(this[d]|this[d+1]<<8|this[d+2]<<16)+this[d+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(d,f){return d=d>>>0,f||oe(d,4,this.length),this[d]*16777216+(this[d+1]<<16|this[d+2]<<8|this[d+3])},a.prototype.readBigUInt64LE=nr(function(d){d=d>>>0,si(d,"offset");const f=this[d],m=this[d+7];(f===void 0||m===void 0)&&cs(d,this.length-8);const E=f+this[++d]*2**8+this[++d]*2**16+this[++d]*2**24,B=this[++d]+this[++d]*2**8+this[++d]*2**16+m*2**24;return BigInt(E)+(BigInt(B)<<BigInt(32))}),a.prototype.readBigUInt64BE=nr(function(d){d=d>>>0,si(d,"offset");const f=this[d],m=this[d+7];(f===void 0||m===void 0)&&cs(d,this.length-8);const E=f*2**24+this[++d]*2**16+this[++d]*2**8+this[++d],B=this[++d]*2**24+this[++d]*2**16+this[++d]*2**8+m;return(BigInt(E)<<BigInt(32))+BigInt(B)}),a.prototype.readIntLE=function(d,f,m){d=d>>>0,f=f>>>0,m||oe(d,f,this.length);let E=this[d],B=1,V=0;for(;++V<f&&(B*=256);)E+=this[d+V]*B;return B*=128,E>=B&&(E-=Math.pow(2,8*f)),E},a.prototype.readIntBE=function(d,f,m){d=d>>>0,f=f>>>0,m||oe(d,f,this.length);let E=f,B=1,V=this[d+--E];for(;E>0&&(B*=256);)V+=this[d+--E]*B;return B*=128,V>=B&&(V-=Math.pow(2,8*f)),V},a.prototype.readInt8=function(d,f){return d=d>>>0,f||oe(d,1,this.length),this[d]&128?(255-this[d]+1)*-1:this[d]},a.prototype.readInt16LE=function(d,f){d=d>>>0,f||oe(d,2,this.length);const m=this[d]|this[d+1]<<8;return m&32768?m|4294901760:m},a.prototype.readInt16BE=function(d,f){d=d>>>0,f||oe(d,2,this.length);const m=this[d+1]|this[d]<<8;return m&32768?m|4294901760:m},a.prototype.readInt32LE=function(d,f){return d=d>>>0,f||oe(d,4,this.length),this[d]|this[d+1]<<8|this[d+2]<<16|this[d+3]<<24},a.prototype.readInt32BE=function(d,f){return d=d>>>0,f||oe(d,4,this.length),this[d]<<24|this[d+1]<<16|this[d+2]<<8|this[d+3]},a.prototype.readBigInt64LE=nr(function(d){d=d>>>0,si(d,"offset");const f=this[d],m=this[d+7];(f===void 0||m===void 0)&&cs(d,this.length-8);const E=this[d+4]+this[d+5]*2**8+this[d+6]*2**16+(m<<24);return(BigInt(E)<<BigInt(32))+BigInt(f+this[++d]*2**8+this[++d]*2**16+this[++d]*2**24)}),a.prototype.readBigInt64BE=nr(function(d){d=d>>>0,si(d,"offset");const f=this[d],m=this[d+7];(f===void 0||m===void 0)&&cs(d,this.length-8);const E=(f<<24)+this[++d]*2**16+this[++d]*2**8+this[++d];return(BigInt(E)<<BigInt(32))+BigInt(this[++d]*2**24+this[++d]*2**16+this[++d]*2**8+m)}),a.prototype.readFloatLE=function(d,f){return d=d>>>0,f||oe(d,4,this.length),t.read(this,d,!0,23,4)},a.prototype.readFloatBE=function(d,f){return d=d>>>0,f||oe(d,4,this.length),t.read(this,d,!1,23,4)},a.prototype.readDoubleLE=function(d,f){return d=d>>>0,f||oe(d,8,this.length),t.read(this,d,!0,52,8)},a.prototype.readDoubleBE=function(d,f){return d=d>>>0,f||oe(d,8,this.length),t.read(this,d,!1,52,8)};function me(p,d,f,m,E,B){if(!a.isBuffer(p))throw new TypeError('"buffer" argument must be a Buffer instance');if(d>E||d<B)throw new RangeError('"value" argument is out of bounds');if(f+m>p.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(d,f,m,E){if(d=+d,f=f>>>0,m=m>>>0,!E){const ye=Math.pow(2,8*m)-1;me(this,d,f,m,ye,0)}let B=1,V=0;for(this[f]=d&255;++V<m&&(B*=256);)this[f+V]=d/B&255;return f+m},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(d,f,m,E){if(d=+d,f=f>>>0,m=m>>>0,!E){const ye=Math.pow(2,8*m)-1;me(this,d,f,m,ye,0)}let B=m-1,V=1;for(this[f+B]=d&255;--B>=0&&(V*=256);)this[f+B]=d/V&255;return f+m},a.prototype.writeUint8=a.prototype.writeUInt8=function(d,f,m){return d=+d,f=f>>>0,m||me(this,d,f,1,255,0),this[f]=d&255,f+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(d,f,m){return d=+d,f=f>>>0,m||me(this,d,f,2,65535,0),this[f]=d&255,this[f+1]=d>>>8,f+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(d,f,m){return d=+d,f=f>>>0,m||me(this,d,f,2,65535,0),this[f]=d>>>8,this[f+1]=d&255,f+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(d,f,m){return d=+d,f=f>>>0,m||me(this,d,f,4,4294967295,0),this[f+3]=d>>>24,this[f+2]=d>>>16,this[f+1]=d>>>8,this[f]=d&255,f+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(d,f,m){return d=+d,f=f>>>0,m||me(this,d,f,4,4294967295,0),this[f]=d>>>24,this[f+1]=d>>>16,this[f+2]=d>>>8,this[f+3]=d&255,f+4};function vt(p,d,f,m,E){tr(d,m,E,p,f,7);let B=Number(d&BigInt(4294967295));p[f++]=B,B=B>>8,p[f++]=B,B=B>>8,p[f++]=B,B=B>>8,p[f++]=B;let V=Number(d>>BigInt(32)&BigInt(4294967295));return p[f++]=V,V=V>>8,p[f++]=V,V=V>>8,p[f++]=V,V=V>>8,p[f++]=V,f}function kt(p,d,f,m,E){tr(d,m,E,p,f,7);let B=Number(d&BigInt(4294967295));p[f+7]=B,B=B>>8,p[f+6]=B,B=B>>8,p[f+5]=B,B=B>>8,p[f+4]=B;let V=Number(d>>BigInt(32)&BigInt(4294967295));return p[f+3]=V,V=V>>8,p[f+2]=V,V=V>>8,p[f+1]=V,V=V>>8,p[f]=V,f+8}a.prototype.writeBigUInt64LE=nr(function(d,f=0){return vt(this,d,f,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=nr(function(d,f=0){return kt(this,d,f,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(d,f,m,E){if(d=+d,f=f>>>0,!E){const Je=Math.pow(2,8*m-1);me(this,d,f,m,Je-1,-Je)}let B=0,V=1,ye=0;for(this[f]=d&255;++B<m&&(V*=256);)d<0&&ye===0&&this[f+B-1]!==0&&(ye=1),this[f+B]=(d/V>>0)-ye&255;return f+m},a.prototype.writeIntBE=function(d,f,m,E){if(d=+d,f=f>>>0,!E){const Je=Math.pow(2,8*m-1);me(this,d,f,m,Je-1,-Je)}let B=m-1,V=1,ye=0;for(this[f+B]=d&255;--B>=0&&(V*=256);)d<0&&ye===0&&this[f+B+1]!==0&&(ye=1),this[f+B]=(d/V>>0)-ye&255;return f+m},a.prototype.writeInt8=function(d,f,m){return d=+d,f=f>>>0,m||me(this,d,f,1,127,-128),d<0&&(d=255+d+1),this[f]=d&255,f+1},a.prototype.writeInt16LE=function(d,f,m){return d=+d,f=f>>>0,m||me(this,d,f,2,32767,-32768),this[f]=d&255,this[f+1]=d>>>8,f+2},a.prototype.writeInt16BE=function(d,f,m){return d=+d,f=f>>>0,m||me(this,d,f,2,32767,-32768),this[f]=d>>>8,this[f+1]=d&255,f+2},a.prototype.writeInt32LE=function(d,f,m){return d=+d,f=f>>>0,m||me(this,d,f,4,2147483647,-2147483648),this[f]=d&255,this[f+1]=d>>>8,this[f+2]=d>>>16,this[f+3]=d>>>24,f+4},a.prototype.writeInt32BE=function(d,f,m){return d=+d,f=f>>>0,m||me(this,d,f,4,2147483647,-2147483648),d<0&&(d=4294967295+d+1),this[f]=d>>>24,this[f+1]=d>>>16,this[f+2]=d>>>8,this[f+3]=d&255,f+4},a.prototype.writeBigInt64LE=nr(function(d,f=0){return vt(this,d,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=nr(function(d,f=0){return kt(this,d,f,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function gt(p,d,f,m,E,B){if(f+m>p.length)throw new RangeError("Index out of range");if(f<0)throw new RangeError("Index out of range")}function Ge(p,d,f,m,E){return d=+d,f=f>>>0,E||gt(p,d,f,4),t.write(p,d,f,m,23,4),f+4}a.prototype.writeFloatLE=function(d,f,m){return Ge(this,d,f,!0,m)},a.prototype.writeFloatBE=function(d,f,m){return Ge(this,d,f,!1,m)};function En(p,d,f,m,E){return d=+d,f=f>>>0,E||gt(p,d,f,8),t.write(p,d,f,m,52,8),f+8}a.prototype.writeDoubleLE=function(d,f,m){return En(this,d,f,!0,m)},a.prototype.writeDoubleBE=function(d,f,m){return En(this,d,f,!1,m)},a.prototype.copy=function(d,f,m,E){if(!a.isBuffer(d))throw new TypeError("argument should be a Buffer");if(m||(m=0),!E&&E!==0&&(E=this.length),f>=d.length&&(f=d.length),f||(f=0),E>0&&E<m&&(E=m),E===m||d.length===0||this.length===0)return 0;if(f<0)throw new RangeError("targetStart out of bounds");if(m<0||m>=this.length)throw new RangeError("Index out of range");if(E<0)throw new RangeError("sourceEnd out of bounds");E>this.length&&(E=this.length),d.length-f<E-m&&(E=d.length-f+m);const B=E-m;return this===d&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(f,m,E):Uint8Array.prototype.set.call(d,this.subarray(m,E),f),B},a.prototype.fill=function(d,f,m,E){if(typeof d=="string"){if(typeof f=="string"?(E=f,f=0,m=this.length):typeof m=="string"&&(E=m,m=this.length),E!==void 0&&typeof E!="string")throw new TypeError("encoding must be a string");if(typeof E=="string"&&!a.isEncoding(E))throw new TypeError("Unknown encoding: "+E);if(d.length===1){const V=d.charCodeAt(0);(E==="utf8"&&V<128||E==="latin1")&&(d=V)}}else typeof d=="number"?d=d&255:typeof d=="boolean"&&(d=Number(d));if(f<0||this.length<f||this.length<m)throw new RangeError("Out of range index");if(m<=f)return this;f=f>>>0,m=m===void 0?this.length:m>>>0,d||(d=0);let B;if(typeof d=="number")for(B=f;B<m;++B)this[B]=d;else{const V=a.isBuffer(d)?d:a.from(d,E),ye=V.length;if(ye===0)throw new TypeError('The value "'+d+'" is invalid for argument "value"');for(B=0;B<m-f;++B)this[B+f]=V[B%ye]}return this};const xt={};function On(p,d,f){xt[p]=class extends f{constructor(){super(),Object.defineProperty(this,"message",{value:d.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${p}]`,this.stack,delete this.name}get code(){return p}set code(E){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:E,writable:!0})}toString(){return`${this.name} [${p}]: ${this.message}`}}}On("ERR_BUFFER_OUT_OF_BOUNDS",function(p){return p?`${p} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),On("ERR_INVALID_ARG_TYPE",function(p,d){return`The "${p}" argument must be of type number. Received type ${typeof d}`},TypeError),On("ERR_OUT_OF_RANGE",function(p,d,f){let m=`The value of "${p}" is out of range.`,E=f;return Number.isInteger(f)&&Math.abs(f)>2**32?E=er(String(f)):typeof f=="bigint"&&(E=String(f),(f>BigInt(2)**BigInt(32)||f<-(BigInt(2)**BigInt(32)))&&(E=er(E)),E+="n"),m+=` It must be ${d}. Received ${E}`,m},RangeError);function er(p){let d="",f=p.length;const m=p[0]==="-"?1:0;for(;f>=m+4;f-=3)d=`_${p.slice(f-3,f)}${d}`;return`${p.slice(0,f)}${d}`}function Pr(p,d,f){si(d,"offset"),(p[d]===void 0||p[d+f]===void 0)&&cs(d,p.length-(f+1))}function tr(p,d,f,m,E,B){if(p>f||p<d){const V=typeof d=="bigint"?"n":"";let ye;throw B>3?d===0||d===BigInt(0)?ye=`>= 0${V} and < 2${V} ** ${(B+1)*8}${V}`:ye=`>= -(2${V} ** ${(B+1)*8-1}${V}) and < 2 ** ${(B+1)*8-1}${V}`:ye=`>= ${d}${V} and <= ${f}${V}`,new xt.ERR_OUT_OF_RANGE("value",ye,p)}Pr(m,E,B)}function si(p,d){if(typeof p!="number")throw new xt.ERR_INVALID_ARG_TYPE(d,"number",p)}function cs(p,d,f){throw Math.floor(p)!==p?(si(p,f),new xt.ERR_OUT_OF_RANGE(f||"offset","an integer",p)):d<0?new xt.ERR_BUFFER_OUT_OF_BOUNDS:new xt.ERR_OUT_OF_RANGE(f||"offset",`>= ${f?1:0} and <= ${d}`,p)}const ng=/[^+/0-9A-Za-z-_]/g;function rg(p){if(p=p.split("=")[0],p=p.trim().replace(ng,""),p.length<2)return"";for(;p.length%4!==0;)p=p+"=";return p}function Ec(p,d){d=d||1/0;let f;const m=p.length;let E=null;const B=[];for(let V=0;V<m;++V){if(f=p.charCodeAt(V),f>55295&&f<57344){if(!E){if(f>56319){(d-=3)>-1&&B.push(239,191,189);continue}else if(V+1===m){(d-=3)>-1&&B.push(239,191,189);continue}E=f;continue}if(f<56320){(d-=3)>-1&&B.push(239,191,189),E=f;continue}f=(E-55296<<10|f-56320)+65536}else E&&(d-=3)>-1&&B.push(239,191,189);if(E=null,f<128){if((d-=1)<0)break;B.push(f)}else if(f<2048){if((d-=2)<0)break;B.push(f>>6|192,f&63|128)}else if(f<65536){if((d-=3)<0)break;B.push(f>>12|224,f>>6&63|128,f&63|128)}else if(f<1114112){if((d-=4)<0)break;B.push(f>>18|240,f>>12&63|128,f>>6&63|128,f&63|128)}else throw new Error("Invalid code point")}return B}function ig(p){const d=[];for(let f=0;f<p.length;++f)d.push(p.charCodeAt(f)&255);return d}function sg(p,d){let f,m,E;const B=[];for(let V=0;V<p.length&&!((d-=2)<0);++V)f=p.charCodeAt(V),m=f>>8,E=f%256,B.push(E),B.push(m);return B}function zl(p){return e.toByteArray(rg(p))}function ho(p,d,f,m){let E;for(E=0;E<m&&!(E+f>=d.length||E>=p.length);++E)d[E+f]=p[E];return E}function Pn(p,d){return p instanceof d||p!=null&&p.constructor!=null&&p.constructor.name!=null&&p.constructor.name===d.name}function Oc(p){return p!==p}const og=function(){const p="0123456789abcdef",d=new Array(256);for(let f=0;f<16;++f){const m=f*16;for(let E=0;E<16;++E)d[m+E]=p[f]+p[E]}return d}();function nr(p){return typeof BigInt>"u"?ag:p}function ag(){throw new Error("BigInt not supported")}})(Pe);var r_=typeof ae.global<"u"?ae.global:typeof self<"u"?self:typeof window<"u"?window:{},wu;typeof Object.create=="function"?wu=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:wu=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e};var i_=wu;function Lr(r,e){var t={seen:[],stylize:o_};return arguments.length>=3&&(t.depth=arguments[2]),arguments.length>=4&&(t.colors=arguments[3]),Qh(e)?t.showHidden=e:e&&h_(t,e),wi(t.showHidden)&&(t.showHidden=!1),wi(t.depth)&&(t.depth=2),wi(t.colors)&&(t.colors=!1),wi(t.customInspect)&&(t.customInspect=!0),t.colors&&(t.stylize=s_),Xo(t,r,t.depth)}Lr.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Lr.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function s_(r,e){var t=Lr.styles[e];return t?"\x1B["+Lr.colors[t][0]+"m"+r+"\x1B["+Lr.colors[t][1]+"m":r}function o_(r,e){return r}function a_(r){var e={};return r.forEach(function(t,n){e[t]=!0}),e}function Xo(r,e,t){if(r.customInspect&&e&&ks(e.inspect)&&e.inspect!==Lr&&!(e.constructor&&e.constructor.prototype===e)){var n=e.inspect(t,r);return Xh(n)||(n=Xo(r,n,t)),n}var i=c_(r,e);if(i)return i;var s=Object.keys(e),o=a_(s);if(r.showHidden&&(s=Object.getOwnPropertyNames(e)),zo(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return zc(e);if(s.length===0){if(ks(e)){var a=e.name?": "+e.name:"";return r.stylize("[Function"+a+"]","special")}if(Ss(e))return r.stylize(RegExp.prototype.toString.call(e),"regexp");if(Zo(e))return r.stylize(Date.prototype.toString.call(e),"date");if(zo(e))return zc(e)}var c="",l=!1,u=["{","}"];if(d_(e)&&(l=!0,u=["[","]"]),ks(e)){var h=e.name?": "+e.name:"";c=" [Function"+h+"]"}if(Ss(e)&&(c=" "+RegExp.prototype.toString.call(e)),Zo(e)&&(c=" "+Date.prototype.toUTCString.call(e)),zo(e)&&(c=" "+zc(e)),s.length===0&&(!l||e.length==0))return u[0]+c+u[1];if(t<0)return Ss(e)?r.stylize(RegExp.prototype.toString.call(e),"regexp"):r.stylize("[Object]","special");r.seen.push(e);var b;return l?b=u_(r,e,t,o,s):b=s.map(function(w){return _u(r,e,t,o,w,l)}),r.seen.pop(),l_(b,c,u)}function c_(r,e){if(wi(e))return r.stylize("undefined","undefined");if(Xh(e)){var t="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return r.stylize(t,"string")}if(f_(e))return r.stylize(""+e,"number");if(Qh(e))return r.stylize(""+e,"boolean");if(Jh(e))return r.stylize("null","null")}function zc(r){return"["+Error.prototype.toString.call(r)+"]"}function u_(r,e,t,n,i){for(var s=[],o=0,a=e.length;o<a;++o)Zh(e,String(o))?s.push(_u(r,e,t,n,String(o),!0)):s.push("");return i.forEach(function(c){c.match(/^\d+$/)||s.push(_u(r,e,t,n,c,!0))}),s}function _u(r,e,t,n,i,s){var o,a,c;if(c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},c.get?c.set?a=r.stylize("[Getter/Setter]","special"):a=r.stylize("[Getter]","special"):c.set&&(a=r.stylize("[Setter]","special")),Zh(n,i)||(o="["+i+"]"),a||(r.seen.indexOf(c.value)<0?(Jh(t)?a=Xo(r,c.value,null):a=Xo(r,c.value,t-1),a.indexOf(`
`)>-1&&(s?a=a.split(`
`).map(function(l){return"  "+l}).join(`
`).substr(2):a=`
`+a.split(`
`).map(function(l){return"   "+l}).join(`
`))):a=r.stylize("[Circular]","special")),wi(o)){if(s&&i.match(/^\d+$/))return a;o=JSON.stringify(""+i),o.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=r.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=r.stylize(o,"string"))}return o+": "+a}function l_(r,e,t){var n=r.reduce(function(i,s){return s.indexOf(`
`)>=0,i+s.replace(/\u001b\[\d\d?m/g,"").length+1},0);return n>60?t[0]+(e===""?"":e+`
 `)+" "+r.join(`,
  `)+" "+t[1]:t[0]+e+" "+r.join(", ")+" "+t[1]}function d_(r){return Array.isArray(r)}function Qh(r){return typeof r=="boolean"}function Jh(r){return r===null}function f_(r){return typeof r=="number"}function Xh(r){return typeof r=="string"}function wi(r){return r===void 0}function Ss(r){return Da(r)&&gl(r)==="[object RegExp]"}function Da(r){return typeof r=="object"&&r!==null}function Zo(r){return Da(r)&&gl(r)==="[object Date]"}function zo(r){return Da(r)&&(gl(r)==="[object Error]"||r instanceof Error)}function ks(r){return typeof r=="function"}function kd(r){return r===null||typeof r=="boolean"||typeof r=="number"||typeof r=="string"||typeof r=="symbol"||typeof r>"u"}function gl(r){return Object.prototype.toString.call(r)}function h_(r,e){if(!e||!Da(e))return r;for(var t=Object.keys(e),n=t.length;n--;)r[t[n]]=e[t[n]];return r}function Zh(r,e){return Object.prototype.hasOwnProperty.call(r,e)}function Id(r,e){if(r===e)return 0;for(var t=r.length,n=e.length,i=0,s=Math.min(t,n);i<s;++i)if(r[i]!==e[i]){t=r[i],n=e[i];break}return t<n?-1:n<t?1:0}var p_=Object.prototype.hasOwnProperty,Ed=Object.keys||function(r){var e=[];for(var t in r)p_.call(r,t)&&e.push(t);return e},Od=Array.prototype.slice,Fc;function ep(){return typeof Fc<"u"?Fc:Fc=function(){return function(){}.name==="foo"}()}function Pd(r){return Object.prototype.toString.call(r)}function Td(r){return Pe.isBuffer(r)||typeof r_.ArrayBuffer!="function"?!1:typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(r):r?!!(r instanceof DataView||r.buffer&&r.buffer instanceof ArrayBuffer):!1}function Pt(r,e){r||jt(r,!0,e,"==",bl)}var y_=/\s*function\s+([^\(\s]*)\s*/;function tp(r){if(!!ks(r)){if(ep())return r.name;var e=r.toString(),t=e.match(y_);return t&&t[1]}}Pt.AssertionError=ml;function ml(r){this.name="AssertionError",this.actual=r.actual,this.expected=r.expected,this.operator=r.operator,r.message?(this.message=r.message,this.generatedMessage=!1):(this.message=g_(this),this.generatedMessage=!0);var e=r.stackStartFunction||jt;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var t=new Error;if(t.stack){var n=t.stack,i=tp(e),s=n.indexOf(`
`+i);if(s>=0){var o=n.indexOf(`
`,s+1);n=n.substring(o+1)}this.stack=n}}}i_(ml,Error);function Bd(r,e){return typeof r=="string"?r.length<e?r:r.slice(0,e):r}function Rd(r){if(ep()||!ks(r))return Lr(r);var e=tp(r),t=e?": "+e:"";return"[Function"+t+"]"}function g_(r){return Bd(Rd(r.actual),128)+" "+r.operator+" "+Bd(Rd(r.expected),128)}function jt(r,e,t,n,i){throw new ml({message:t,actual:r,expected:e,operator:n,stackStartFunction:i})}Pt.fail=jt;function bl(r,e){r||jt(r,!0,e,"==",bl)}Pt.ok=bl;Pt.equal=np;function np(r,e,t){r!=e&&jt(r,e,t,"==",np)}Pt.notEqual=rp;function rp(r,e,t){r==e&&jt(r,e,t,"!=",rp)}Pt.deepEqual=ip;function ip(r,e,t){Li(r,e,!1)||jt(r,e,t,"deepEqual",ip)}Pt.deepStrictEqual=sp;function sp(r,e,t){Li(r,e,!0)||jt(r,e,t,"deepStrictEqual",sp)}function Li(r,e,t,n){if(r===e)return!0;if(Pe.isBuffer(r)&&Pe.isBuffer(e))return Id(r,e)===0;if(Zo(r)&&Zo(e))return r.getTime()===e.getTime();if(Ss(r)&&Ss(e))return r.source===e.source&&r.global===e.global&&r.multiline===e.multiline&&r.lastIndex===e.lastIndex&&r.ignoreCase===e.ignoreCase;if((r===null||typeof r!="object")&&(e===null||typeof e!="object"))return t?r===e:r==e;if(Td(r)&&Td(e)&&Pd(r)===Pd(e)&&!(r instanceof Float32Array||r instanceof Float64Array))return Id(new Uint8Array(r.buffer),new Uint8Array(e.buffer))===0;if(Pe.isBuffer(r)!==Pe.isBuffer(e))return!1;n=n||{actual:[],expected:[]};var i=n.actual.indexOf(r);return i!==-1&&i===n.expected.indexOf(e)?!0:(n.actual.push(r),n.expected.push(e),m_(r,e,t,n))}function xd(r){return Object.prototype.toString.call(r)=="[object Arguments]"}function m_(r,e,t,n){if(r==null||e===null||e===void 0)return!1;if(kd(r)||kd(e))return r===e;if(t&&Object.getPrototypeOf(r)!==Object.getPrototypeOf(e))return!1;var i=xd(r),s=xd(e);if(i&&!s||!i&&s)return!1;if(i)return r=Od.call(r),e=Od.call(e),Li(r,e,t);var o=Ed(r),a=Ed(e),c,l;if(o.length!==a.length)return!1;for(o.sort(),a.sort(),l=o.length-1;l>=0;l--)if(o[l]!==a[l])return!1;for(l=o.length-1;l>=0;l--)if(c=o[l],!Li(r[c],e[c],t,n))return!1;return!0}Pt.notDeepEqual=op;function op(r,e,t){Li(r,e,!1)&&jt(r,e,t,"notDeepEqual",op)}Pt.notDeepStrictEqual=ap;function ap(r,e,t){Li(r,e,!0)&&jt(r,e,t,"notDeepStrictEqual",ap)}Pt.strictEqual=cp;function cp(r,e,t){r!==e&&jt(r,e,t,"===",cp)}Pt.notStrictEqual=up;function up(r,e,t){r===e&&jt(r,e,t,"!==",up)}function Md(r,e){if(!r||!e)return!1;if(Object.prototype.toString.call(e)=="[object RegExp]")return e.test(r);try{if(r instanceof e)return!0}catch{}return Error.isPrototypeOf(e)?!1:e.call({},r)===!0}function b_(r){var e;try{r()}catch(t){e=t}return e}function lp(r,e,t,n){var i;if(typeof e!="function")throw new TypeError('"block" argument must be a function');typeof t=="string"&&(n=t,t=null),i=b_(e),n=(t&&t.name?" ("+t.name+").":".")+(n?" "+n:"."),r&&!i&&jt(i,t,"Missing expected exception"+n);var s=typeof n=="string",o=!r&&zo(i),a=!r&&i&&!t;if((o&&s&&Md(i,t)||a)&&jt(i,t,"Got unwanted exception"+n),r&&i&&t&&!Md(i,t)||!r&&i)throw i}Pt.throws=v_;function v_(r,e,t){lp(!0,r,e,t)}Pt.doesNotThrow=w_;function w_(r,e,t){lp(!1,r,e,t)}Pt.ifError=__;function __(r){if(r)throw r}class Ns{constructor(e,t){if(!Number.isInteger(e))throw new TypeError("span must be an integer");this.span=e,this.property=t}makeDestinationObject(){return{}}decode(e,t){throw new Error("Layout is abstract")}encode(e,t,n){throw new Error("Layout is abstract")}getSpan(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(e){const t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}fromArray(e){}}function A_(r,e){return e.property?r+"["+e.property+"]":r}class mo extends Ns{isCount(){throw new Error("ExternalLayout is abstract")}}class dp extends Ns{constructor(e,t){if(super(e,t),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(e,t){return t===void 0&&(t=0),e.readUIntLE(t,this.span)}encode(e,t,n){return n===void 0&&(n=0),t.writeUIntLE(e,n,this.span),this.span}}class S_ extends Ns{constructor(e,t,n){if(!(Array.isArray(e)&&e.reduce((s,o)=>s&&o instanceof Ns,!0)))throw new TypeError("fields must be array of Layout instances");typeof t=="boolean"&&n===void 0&&(n=t,t=void 0);for(const s of e)if(0>s.span&&s.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let i=-1;try{i=e.reduce((s,o)=>s+o.getSpan(),0)}catch{}super(i,t),this.fields=e,this.decodePrefixes=!!n}getSpan(e,t){if(0<=this.span)return this.span;t===void 0&&(t=0);let n=0;try{n=this.fields.reduce((i,s)=>{const o=s.getSpan(e,t);return t+=o,i+o},0)}catch{throw new RangeError("indeterminate span")}return n}decode(e,t){t===void 0&&(t=0);const n=this.makeDestinationObject();for(const i of this.fields)if(i.property!==void 0&&(n[i.property]=i.decode(e,t)),t+=i.getSpan(e,t),this.decodePrefixes&&e.length===t)break;return n}encode(e,t,n){n===void 0&&(n=0);const i=n;let s=0,o=0;for(const a of this.fields){let c=a.span;if(o=0<c?c:0,a.property!==void 0){const l=e[a.property];l!==void 0&&(o=a.encode(l,t,n),0>c&&(c=a.getSpan(t,n)))}s=n,n+=c}return s+o-i}fromArray(e){const t=this.makeDestinationObject();for(const n of this.fields)n.property!==void 0&&0<e.length&&(t[n.property]=e.shift());return t}layoutFor(e){if(typeof e!="string")throw new TypeError("property must be string");for(const t of this.fields)if(t.property===e)return t}offsetOf(e){if(typeof e!="string")throw new TypeError("property must be string");let t=0;for(const n of this.fields){if(n.property===e)return t;0>n.span?t=-1:0<=t&&(t+=n.span)}}}class k_ extends Ns{constructor(e,t){if(!(e instanceof mo&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;e instanceof mo||(n=e),super(n,t),this.length=e}getSpan(e,t){let n=this.span;return 0>n&&(n=this.length.decode(e,t)),n}decode(e,t){t===void 0&&(t=0);let n=this.span;return 0>n&&(n=this.length.decode(e,t)),e.slice(t,t+n)}encode(e,t,n){let i=this.length;if(this.length instanceof mo&&(i=e.length),!(Pe.Buffer.isBuffer(e)&&i===e.length))throw new TypeError(A_("Blob.encode",this)+" requires (length "+i+") Buffer as src");if(n+i>t.length)throw new RangeError("encoding overruns Buffer");return t.write(e.toString("hex"),n,i,"hex"),this.length instanceof mo&&this.length.encode(i,t,n),i}}var Se=r=>new dp(1,r),Is=r=>new dp(4,r),rt=(r,e,t)=>new S_(r,e,t),fp=(r,e)=>new k_(r,e);const it=(r="publicKey")=>fp(32,r),un=(r="uint64")=>fp(8,r);function ct(r,e,t,...n){return Sw(e,t,n,{skipPreflight:!1})}const I_=new ee("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),hp=new ee("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"),Cd="Failed to find account",Kd="Invalid account owner";function Uc(r){return Pe.Buffer.from(r.toBuffer())}class It extends Qn{toBuffer(){const e=super.toArray().reverse(),t=Pe.Buffer.from(e);if(t.length===8)return t;Pt(t.length<8,"u64 too large");const n=Pe.Buffer.alloc(8);return t.copy(n),n}static fromBuffer(e){return Pt(e.length===8,`Invalid buffer length: ${e.length}`),new It([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}function Yt(r){return"publicKey"in r}const E_={MintTokens:0,FreezeAccount:1,AccountOwner:2,CloseAccount:3},pp=new ee("So11111111111111111111111111111111111111112"),bs=rt([Is("mintAuthorityOption"),it("mintAuthority"),un("supply"),Se("decimals"),Se("isInitialized"),Is("freezeAuthorityOption"),it("freezeAuthority")]),pi=rt([it("mint"),it("owner"),un("amount"),Is("delegateOption"),it("delegate"),Se("state"),Is("isNativeOption"),un("isNative"),un("delegatedAmount"),Is("closeAuthorityOption"),it("closeAuthority")]),bo=rt([Se("m"),Se("n"),Se("is_initialized"),it("signer1"),it("signer2"),it("signer3"),it("signer4"),it("signer5"),it("signer6"),it("signer7"),it("signer8"),it("signer9"),it("signer10"),it("signer11")]);class Ne{constructor(e,t,n,i){us(this,"connection",void 0),us(this,"publicKey",void 0),us(this,"programId",void 0),us(this,"associatedProgramId",void 0),us(this,"payer",void 0),Object.assign(this,{connection:e,publicKey:t,programId:n,payer:i,associatedProgramId:hp})}static async getMinBalanceRentForExemptMint(e){return await e.getMinimumBalanceForRentExemption(bs.span)}static async getMinBalanceRentForExemptAccount(e){return await e.getMinimumBalanceForRentExemption(pi.span)}static async getMinBalanceRentForExemptMultisig(e){return await e.getMinimumBalanceForRentExemption(bo.span)}static async createMint(e,t,n,i,s,o){const a=cr.generate(),c=new Ne(e,a.publicKey,o,t),l=await Ne.getMinBalanceRentForExemptMint(e),u=new Qe;return u.add(xn.createAccount({fromPubkey:t.publicKey,newAccountPubkey:a.publicKey,lamports:l,space:bs.span,programId:o})),u.add(Ne.createInitMintInstruction(o,a.publicKey,s,n,i)),await ct("createAccount and InitializeMint",e,u,t,a),c}async createAccount(e){const t=await Ne.getMinBalanceRentForExemptAccount(this.connection),n=cr.generate(),i=new Qe;i.add(xn.createAccount({fromPubkey:this.payer.publicKey,newAccountPubkey:n.publicKey,lamports:t,space:pi.span,programId:this.programId}));const s=this.publicKey;return i.add(Ne.createInitAccountInstruction(this.programId,s,n.publicKey,e)),await ct("createAccount and InitializeAccount",this.connection,i,this.payer,n),n.publicKey}async createAssociatedTokenAccount(e){const t=await Ne.getAssociatedTokenAddress(this.associatedProgramId,this.programId,this.publicKey,e);return this.createAssociatedTokenAccountInternal(e,t)}async createAssociatedTokenAccountInternal(e,t){return await ct("CreateAssociatedTokenAccount",this.connection,new Qe().add(Ne.createAssociatedTokenAccountInstruction(this.associatedProgramId,this.programId,this.publicKey,t,e,this.payer.publicKey)),this.payer),t}async getOrCreateAssociatedAccountInfo(e){const t=await Ne.getAssociatedTokenAddress(this.associatedProgramId,this.programId,this.publicKey,e);try{return await this.getAccountInfo(t)}catch(n){if(n.message===Cd||n.message===Kd){try{await this.createAssociatedTokenAccountInternal(e,t)}catch{}return await this.getAccountInfo(t)}else throw n}}static async createWrappedNativeAccount(e,t,n,i,s){const o=await Ne.getMinBalanceRentForExemptAccount(e),a=cr.generate(),c=new Qe;return c.add(xn.createAccount({fromPubkey:i.publicKey,newAccountPubkey:a.publicKey,lamports:o,space:pi.span,programId:t})),c.add(xn.transfer({fromPubkey:i.publicKey,toPubkey:a.publicKey,lamports:s})),c.add(Ne.createInitAccountInstruction(t,pp,a.publicKey,n)),await ct("createAccount, transfer, and initializeAccount",e,c,i,a),a.publicKey}async createMultisig(e,t){const n=cr.generate(),i=await Ne.getMinBalanceRentForExemptMultisig(this.connection),s=new Qe;s.add(xn.createAccount({fromPubkey:this.payer.publicKey,newAccountPubkey:n.publicKey,lamports:i,space:bo.span,programId:this.programId}));let o=[{pubkey:n.publicKey,isSigner:!1,isWritable:!0},{pubkey:vi,isSigner:!1,isWritable:!1}];t.forEach(l=>o.push({pubkey:l,isSigner:!1,isWritable:!1}));const a=rt([Se("instruction"),Se("m")]),c=Pe.Buffer.alloc(a.span);return a.encode({instruction:2,m:e},c),s.add({keys:o,programId:this.programId,data:c}),await ct("createAccount and InitializeMultisig",this.connection,s,this.payer,n),n.publicKey}async getMintInfo(){const e=await this.connection.getAccountInfo(this.publicKey);if(e===null)throw new Error("Failed to find mint account");if(!e.owner.equals(this.programId))throw new Error(`Invalid mint owner: ${JSON.stringify(e.owner)}`);if(e.data.length!=bs.span)throw new Error("Invalid mint size");const t=Pe.Buffer.from(e.data),n=bs.decode(t);return n.mintAuthorityOption===0?n.mintAuthority=null:n.mintAuthority=new ee(n.mintAuthority),n.supply=It.fromBuffer(n.supply),n.isInitialized=n.isInitialized!=0,n.freezeAuthorityOption===0?n.freezeAuthority=null:n.freezeAuthority=new ee(n.freezeAuthority),n}async getAccountInfo(e,t){const n=await this.connection.getAccountInfo(e,t);if(n===null)throw new Error(Cd);if(!n.owner.equals(this.programId))throw new Error(Kd);if(n.data.length!=pi.span)throw new Error("Invalid account size");const i=Pe.Buffer.from(n.data),s=pi.decode(i);if(s.address=e,s.mint=new ee(s.mint),s.owner=new ee(s.owner),s.amount=It.fromBuffer(s.amount),s.delegateOption===0?(s.delegate=null,s.delegatedAmount=new It):(s.delegate=new ee(s.delegate),s.delegatedAmount=It.fromBuffer(s.delegatedAmount)),s.isInitialized=s.state!==0,s.isFrozen=s.state===2,s.isNativeOption===1?(s.rentExemptReserve=It.fromBuffer(s.isNative),s.isNative=!0):(s.rentExemptReserve=null,s.isNative=!1),s.closeAuthorityOption===0?s.closeAuthority=null:s.closeAuthority=new ee(s.closeAuthority),!s.mint.equals(this.publicKey))throw new Error(`Invalid account mint: ${JSON.stringify(s.mint)} !== ${JSON.stringify(this.publicKey)}`);return s}async getMultisigInfo(e){const t=await this.connection.getAccountInfo(e);if(t===null)throw new Error("Failed to find multisig");if(!t.owner.equals(this.programId))throw new Error("Invalid multisig owner");if(t.data.length!=bo.span)throw new Error("Invalid multisig size");const n=Pe.Buffer.from(t.data),i=bo.decode(n);return i.signer1=new ee(i.signer1),i.signer2=new ee(i.signer2),i.signer3=new ee(i.signer3),i.signer4=new ee(i.signer4),i.signer5=new ee(i.signer5),i.signer6=new ee(i.signer6),i.signer7=new ee(i.signer7),i.signer8=new ee(i.signer8),i.signer9=new ee(i.signer9),i.signer10=new ee(i.signer10),i.signer11=new ee(i.signer11),i}async transfer(e,t,n,i,s){let o,a;return Yt(n)?(o=n.publicKey,a=[n]):(o=n,a=i),await ct("Transfer",this.connection,new Qe().add(Ne.createTransferInstruction(this.programId,e,t,o,i,s)),this.payer,...a)}async approve(e,t,n,i,s){let o,a;Yt(n)?(o=n.publicKey,a=[n]):(o=n,a=i),await ct("Approve",this.connection,new Qe().add(Ne.createApproveInstruction(this.programId,e,t,o,i,s)),this.payer,...a)}async revoke(e,t,n){let i,s;Yt(t)?(i=t.publicKey,s=[t]):(i=t,s=n),await ct("Revoke",this.connection,new Qe().add(Ne.createRevokeInstruction(this.programId,e,i,n)),this.payer,...s)}async setAuthority(e,t,n,i,s){let o,a;Yt(i)?(o=i.publicKey,a=[i]):(o=i,a=s),await ct("SetAuthority",this.connection,new Qe().add(Ne.createSetAuthorityInstruction(this.programId,e,t,n,o,s)),this.payer,...a)}async mintTo(e,t,n,i){let s,o;Yt(t)?(s=t.publicKey,o=[t]):(s=t,o=n),await ct("MintTo",this.connection,new Qe().add(Ne.createMintToInstruction(this.programId,this.publicKey,e,s,n,i)),this.payer,...o)}async burn(e,t,n,i){let s,o;Yt(t)?(s=t.publicKey,o=[t]):(s=t,o=n),await ct("Burn",this.connection,new Qe().add(Ne.createBurnInstruction(this.programId,this.publicKey,e,s,n,i)),this.payer,...o)}async closeAccount(e,t,n,i){let s,o;Yt(n)?(s=n.publicKey,o=[n]):(s=n,o=i),await ct("CloseAccount",this.connection,new Qe().add(Ne.createCloseAccountInstruction(this.programId,e,t,s,i)),this.payer,...o)}async freezeAccount(e,t,n){let i,s;Yt(t)?(i=t.publicKey,s=[t]):(i=t,s=n),await ct("FreezeAccount",this.connection,new Qe().add(Ne.createFreezeAccountInstruction(this.programId,e,this.publicKey,i,n)),this.payer,...s)}async thawAccount(e,t,n){let i,s;Yt(t)?(i=t.publicKey,s=[t]):(i=t,s=n),await ct("ThawAccount",this.connection,new Qe().add(Ne.createThawAccountInstruction(this.programId,e,this.publicKey,i,n)),this.payer,...s)}async transferChecked(e,t,n,i,s,o){let a,c;return Yt(n)?(a=n.publicKey,c=[n]):(a=n,c=i),await ct("TransferChecked",this.connection,new Qe().add(Ne.createTransferCheckedInstruction(this.programId,e,this.publicKey,t,a,i,s,o)),this.payer,...c)}async approveChecked(e,t,n,i,s,o){let a,c;Yt(n)?(a=n.publicKey,c=[n]):(a=n,c=i),await ct("ApproveChecked",this.connection,new Qe().add(Ne.createApproveCheckedInstruction(this.programId,e,this.publicKey,t,a,i,s,o)),this.payer,...c)}async mintToChecked(e,t,n,i,s){let o,a;Yt(t)?(o=t.publicKey,a=[t]):(o=t,a=n),await ct("MintToChecked",this.connection,new Qe().add(Ne.createMintToCheckedInstruction(this.programId,this.publicKey,e,o,n,i,s)),this.payer,...a)}async burnChecked(e,t,n,i,s){let o,a;Yt(t)?(o=t.publicKey,a=[t]):(o=t,a=n),await ct("BurnChecked",this.connection,new Qe().add(Ne.createBurnCheckedInstruction(this.programId,this.publicKey,e,o,n,i,s)),this.payer,...a)}async syncNative(e){await ct("SyncNative",this.connection,new Qe().add(Ne.createSyncNativeInstruction(this.programId,e)),this.payer)}static createInitMintInstruction(e,t,n,i,s){let o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:vi,isSigner:!1,isWritable:!1}];const a=rt([Se("instruction"),Se("decimals"),it("mintAuthority"),Se("option"),it("freezeAuthority")]);let c=Pe.Buffer.alloc(1024);{const l=a.encode({instruction:0,decimals:n,mintAuthority:Uc(i),option:s===null?0:1,freezeAuthority:Uc(s||new ee(0))},c);c=c.slice(0,l)}return new Me({keys:o,programId:e,data:c})}static createInitAccountInstruction(e,t,n,i){const s=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:vi,isSigner:!1,isWritable:!1}],o=rt([Se("instruction")]),a=Pe.Buffer.alloc(o.span);return o.encode({instruction:1},a),new Me({keys:s,programId:e,data:a})}static createTransferInstruction(e,t,n,i,s,o){const a=rt([Se("instruction"),un("amount")]),c=Pe.Buffer.alloc(a.span);a.encode({instruction:3,amount:new It(o).toBuffer()},c);let l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0}];return s.length===0?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new Me({keys:l,programId:e,data:c})}static createApproveInstruction(e,t,n,i,s,o){const a=rt([Se("instruction"),un("amount")]),c=Pe.Buffer.alloc(a.span);a.encode({instruction:4,amount:new It(o).toBuffer()},c);let l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1}];return s.length===0?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new Me({keys:l,programId:e,data:c})}static createRevokeInstruction(e,t,n,i){const s=rt([Se("instruction")]),o=Pe.Buffer.alloc(s.span);s.encode({instruction:5},o);let a=[{pubkey:t,isSigner:!1,isWritable:!0}];return i.length===0?a.push({pubkey:n,isSigner:!0,isWritable:!1}):(a.push({pubkey:n,isSigner:!1,isWritable:!1}),i.forEach(c=>a.push({pubkey:c.publicKey,isSigner:!0,isWritable:!1}))),new Me({keys:a,programId:e,data:o})}static createSetAuthorityInstruction(e,t,n,i,s,o){const a=rt([Se("instruction"),Se("authorityType"),Se("option"),it("newAuthority")]);let c=Pe.Buffer.alloc(1024);{const u=a.encode({instruction:6,authorityType:E_[i],option:n===null?0:1,newAuthority:Uc(n||new ee(0))},c);c=c.slice(0,u)}let l=[{pubkey:t,isSigner:!1,isWritable:!0}];return o.length===0?l.push({pubkey:s,isSigner:!0,isWritable:!1}):(l.push({pubkey:s,isSigner:!1,isWritable:!1}),o.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new Me({keys:l,programId:e,data:c})}static createMintToInstruction(e,t,n,i,s,o){const a=rt([Se("instruction"),un("amount")]),c=Pe.Buffer.alloc(a.span);a.encode({instruction:7,amount:new It(o).toBuffer()},c);let l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0}];return s.length===0?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new Me({keys:l,programId:e,data:c})}static createBurnInstruction(e,t,n,i,s,o){const a=rt([Se("instruction"),un("amount")]),c=Pe.Buffer.alloc(a.span);a.encode({instruction:8,amount:new It(o).toBuffer()},c);let l=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}];return s.length===0?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(u=>l.push({pubkey:u.publicKey,isSigner:!0,isWritable:!1}))),new Me({keys:l,programId:e,data:c})}static createCloseAccountInstruction(e,t,n,i,s){const o=rt([Se("instruction")]),a=Pe.Buffer.alloc(o.span);o.encode({instruction:9},a);let c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0}];return s.length===0?c.push({pubkey:i,isSigner:!0,isWritable:!1}):(c.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(l=>c.push({pubkey:l.publicKey,isSigner:!0,isWritable:!1}))),new Me({keys:c,programId:e,data:a})}static createFreezeAccountInstruction(e,t,n,i,s){const o=rt([Se("instruction")]),a=Pe.Buffer.alloc(o.span);o.encode({instruction:10},a);let c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1}];return s.length===0?c.push({pubkey:i,isSigner:!0,isWritable:!1}):(c.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(l=>c.push({pubkey:l.publicKey,isSigner:!0,isWritable:!1}))),new Me({keys:c,programId:e,data:a})}static createThawAccountInstruction(e,t,n,i,s){const o=rt([Se("instruction")]),a=Pe.Buffer.alloc(o.span);o.encode({instruction:11},a);let c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1}];return s.length===0?c.push({pubkey:i,isSigner:!0,isWritable:!1}):(c.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(l=>c.push({pubkey:l.publicKey,isSigner:!0,isWritable:!1}))),new Me({keys:c,programId:e,data:a})}static createTransferCheckedInstruction(e,t,n,i,s,o,a,c){const l=rt([Se("instruction"),un("amount"),Se("decimals")]),u=Pe.Buffer.alloc(l.span);l.encode({instruction:12,amount:new It(a).toBuffer(),decimals:c},u);let h=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0}];return o.length===0?h.push({pubkey:s,isSigner:!0,isWritable:!1}):(h.push({pubkey:s,isSigner:!1,isWritable:!1}),o.forEach(b=>h.push({pubkey:b.publicKey,isSigner:!0,isWritable:!1}))),new Me({keys:h,programId:e,data:u})}static createApproveCheckedInstruction(e,t,n,i,s,o,a,c){const l=rt([Se("instruction"),un("amount"),Se("decimals")]),u=Pe.Buffer.alloc(l.span);l.encode({instruction:13,amount:new It(a).toBuffer(),decimals:c},u);let h=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1}];return o.length===0?h.push({pubkey:s,isSigner:!0,isWritable:!1}):(h.push({pubkey:s,isSigner:!1,isWritable:!1}),o.forEach(b=>h.push({pubkey:b.publicKey,isSigner:!0,isWritable:!1}))),new Me({keys:h,programId:e,data:u})}static createMintToCheckedInstruction(e,t,n,i,s,o,a){const c=rt([Se("instruction"),un("amount"),Se("decimals")]),l=Pe.Buffer.alloc(c.span);c.encode({instruction:14,amount:new It(o).toBuffer(),decimals:a},l);let u=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0}];return s.length===0?u.push({pubkey:i,isSigner:!0,isWritable:!1}):(u.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(h=>u.push({pubkey:h.publicKey,isSigner:!0,isWritable:!1}))),new Me({keys:u,programId:e,data:l})}static createBurnCheckedInstruction(e,t,n,i,s,o,a){const c=rt([Se("instruction"),un("amount"),Se("decimals")]),l=Pe.Buffer.alloc(c.span);c.encode({instruction:15,amount:new It(o).toBuffer(),decimals:a},l);let u=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}];return s.length===0?u.push({pubkey:i,isSigner:!0,isWritable:!1}):(u.push({pubkey:i,isSigner:!1,isWritable:!1}),s.forEach(h=>u.push({pubkey:h.publicKey,isSigner:!0,isWritable:!1}))),new Me({keys:u,programId:e,data:l})}static createSyncNativeInstruction(e,t){const n=rt([Se("instruction")]),i=Pe.Buffer.alloc(n.span);n.encode({instruction:17},i);let s=[{pubkey:t,isSigner:!1,isWritable:!0}];return new Me({keys:s,programId:e,data:i})}static async getAssociatedTokenAddress(e,t,n,i,s=!1){if(!s&&!ee.isOnCurve(i.toBuffer()))throw new Error(`Owner cannot sign: ${i.toString()}`);return(await ee.findProgramAddress([i.toBuffer(),t.toBuffer(),n.toBuffer()],e))[0]}static createAssociatedTokenAccountInstruction(e,t,n,i,s,o){const a=Pe.Buffer.alloc(0);let c=[{pubkey:o,isSigner:!0,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:xn.programId,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:vi,isSigner:!1,isWritable:!1}];return new Me({keys:c,programId:e,data:a})}}var O_=Object.freeze(Object.defineProperty({__proto__:null,ASSOCIATED_TOKEN_PROGRAM_ID:hp,AccountLayout:pi,MintLayout:bs,NATIVE_MINT:pp,TOKEN_PROGRAM_ID:I_,Token:Ne,u64:It},Symbol.toStringTag,{value:"Module"})),Qs=$s(O_),Va=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(ut,"__esModule",{value:!0});ut.getAccountInfo=ut.getTokenAccount=ut.getAssociatedTokenAddress=ut.convertFactionStringToNum=ut.longToByteArray=ut.byteArrayToLong=ut.stringToByteArray=ut.byteArrayToString=void 0;const vo=Mt,wo=Ke,Fo=Xn,Bn=Qs;function P_(r){return String.fromCharCode(...r)}ut.byteArrayToString=P_;function T_(r,e){if(r.length>e)return null;let t=[];for(let n=0;n<e;n+=1){let i=32;n<r.length&&(i=r.charCodeAt(n)),t=t.concat([i])}return t}ut.stringToByteArray=T_;function B_(r){let e=0;for(let t=r.length-1;t>=0;t-=1)e=e*256+r[t];return e}ut.byteArrayToLong=B_;function R_(r){const e=[0,0,0,0,0,0,0,0];for(let t=0;t<e.length;t+=1){const n=r&255;e[t]=n,r=(r-n)/256}return e}ut.longToByteArray=R_;function x_(r){return Va(this,void 0,void 0,function*(){switch(r.toLowerCase()){case"mud":return vo.FactionType.MUD;case"oni":return vo.FactionType.ONI;case"ustur":return vo.FactionType.Ustur;default:return vo.FactionType.Unenlisted}})}ut.convertFactionStringToNum=x_;function yp(r,e){return Va(this,void 0,void 0,function*(){const[t]=yield Fo.PublicKey.findProgramAddress([r.toBuffer(),Bn.TOKEN_PROGRAM_ID.toBuffer(),e.toBuffer()],Bn.ASSOCIATED_TOKEN_PROGRAM_ID);return t})}ut.getAssociatedTokenAddress=yp;function M_(r,e,t,n=e,i){return Va(this,void 0,void 0,function*(){const{value:s}=yield r.getParsedTokenAccountsByOwner(e,{mint:t});let o=null;if(i===void 0){let a=null;for(const c of s)if(c.account.data.parsed.type==="account"){const l=c.account.data.parsed,u=new wo.BN(l.info.tokenAmount.amount);(a===null||u.gt(a))&&(o=c.pubkey,a=u)}}else{let a=null;for(const c of s)if(c.account.data.parsed.type==="account"){const l=c.account.data.parsed,u=new wo.BN(l.info.tokenAmount.amount);u.gt(new wo.BN(i))&&(a===null||u.lt(a))&&(o=c.pubkey,a=u)}}if(o===null){const a=yield yp(e,t),{value:c}=yield r.getParsedAccountInfo(a,"confirmed");if(c===null||c.owner.equals(Fo.SystemProgram.programId))return{tokenAccount:a,createInstruction:[Bn.Token.createAssociatedTokenAccountInstruction(Bn.ASSOCIATED_TOKEN_PROGRAM_ID,Bn.TOKEN_PROGRAM_ID,t,a,e,n)]};if("program"in c.data&&c.data.parsed.type==="account"&&new Fo.PublicKey(c.data.parsed.info.owner).equals(e))return{tokenAccount:a};{const l=wo.web3.Keypair.generate();return{tokenAccount:l,createInstruction:[Fo.SystemProgram.createAccount({fromPubkey:n,newAccountPubkey:l.publicKey,lamports:yield Bn.Token.getMinBalanceRentForExemptAccount(r),space:Bn.AccountLayout.span,programId:Bn.TOKEN_PROGRAM_ID}),Bn.Token.createInitAccountInstruction(Bn.TOKEN_PROGRAM_ID,t,l.publicKey,e)]}}}else return{tokenAccount:o}})}ut.getTokenAccount=M_;function C_(r,e){return Va(this,void 0,void 0,function*(){const{value:t}=yield r.getParsedAccountInfo(e);return t.data})}ut.getAccountInfo=C_;var za={},K_=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(za,"__esModule",{value:!0});za.sendAndConfirmTransaction=void 0;const L_=Xn;function N_(r,e,...t){return K_(this,void 0,void 0,function*(){let n="";try{n=yield(0,L_.sendAndConfirmTransaction)(r,e,t,{skipPreflight:!0,commitment:"singleGossip",preflightCommitment:null})}catch(i){console.log(i)}return n})}za.sendAndConfirmTransaction=N_;var Fr={},vl={},wl={},gp={};Object.defineProperty(gp,"__esModule",{value:!0});var Fa={},_r={},Ot={},bn={},Js={};Object.defineProperty(Js,"__esModule",{value:!0});Js.baseIdl=void 0;Js.baseIdl={version:"0.1.0",name:"marketplace",instructions:[{name:"addRoyaltyTier",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"RegisteredCurrency",path:"registered_currency.token_mint"}]}}],args:[{name:"stakeAmount",type:"u64"},{name:"discount",type:"u64"}]},{name:"deleteRoyaltyTier",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"RegisteredCurrency",path:"registered_currency.token_mint"}]}}],args:[{name:"stakeAmount",type:"u64"}]},{name:"deregisterCurrency",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"initializeMarketplace",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"registerCurrency",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"saCurrencyVault",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"royalty",type:"u64"}]},{name:"updateCurrencyVault",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"saCurrencyVault",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]},{name:"updateCurrencyRoyalty",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"royalty",type:"u64"}]},{name:"updateRoyaltyTier",accounts:[{name:"updateAuthorityAccount",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"registeredCurrency",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"RegisteredCurrency",path:"registered_currency.token_mint"}]}}],args:[{name:"stakeAmount",type:"u64"},{name:"discount",type:"u64"}]},{name:"addFeeExemption",accounts:[{name:"updateAuthorityMaster",isMut:!1,isSigner:!0},{name:"funder",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1},{name:"feeExemptTarget",isMut:!1,isSigner:!1},{name:"feeExemptAccount",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"discount",type:"u64"}]},{name:"removeFeeExemption",accounts:[{name:"updateAuthorityMaster",isMut:!1,isSigner:!0},{name:"funder",isMut:!0,isSigner:!1},{name:"marketVarsAccount",isMut:!1,isSigner:!1},{name:"feeExemptAccount",isMut:!0,isSigner:!1}],args:[]},{name:"processInitializeBuy",accounts:[{name:"orderInitializer",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"depositMint",isMut:!1,isSigner:!1},{name:"receiveMint",isMut:!1,isSigner:!1},{name:"orderVaultAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-account"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"orderVaultAuthority",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-auth"},{kind:"account",type:"publicKey",path:"order_initializer"}]}},{name:"initializerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"initializerReceiveTokenAccount",isMut:!0,isSigner:!1},{name:"orderAccount",isMut:!0,isSigner:!1},{name:"registeredCurrency",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"openOrdersCounter",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"open-orders-counter"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"price",type:"u64"},{name:"originationQty",type:"u64"}]},{name:"processInitializeSell",accounts:[{name:"orderInitializer",isMut:!0,isSigner:!0},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"depositMint",isMut:!1,isSigner:!1},{name:"receiveMint",isMut:!1,isSigner:!1},{name:"orderVaultAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-account"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"orderVaultAuthority",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-auth"},{kind:"account",type:"publicKey",path:"order_initializer"}]}},{name:"initializerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"initializerReceiveTokenAccount",isMut:!1,isSigner:!1},{name:"orderAccount",isMut:!0,isSigner:!1},{name:"registeredCurrency",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"receive_mint"}]}},{name:"openOrdersCounter",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"open-orders-counter"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"price",type:"u64"},{name:"originationQty",type:"u64"}]},{name:"processExchange",accounts:[{name:"orderTaker",isMut:!0,isSigner:!0},{name:"orderTakerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"orderTakerReceiveTokenAccount",isMut:!0,isSigner:!1},{name:"currencyMint",isMut:!1,isSigner:!1},{name:"assetMint",isMut:!1,isSigner:!1},{name:"orderInitializer",isMut:!0,isSigner:!1},{name:"initializerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"initializerReceiveTokenAccount",isMut:!0,isSigner:!1},{name:"orderVaultAccount",isMut:!0,isSigner:!1},{name:"orderVaultAuthority",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-auth"},{kind:"account",type:"publicKey",account:"OrderAccount",path:"order_account.order_initializer_pubkey"}]}},{name:"orderAccount",isMut:!0,isSigner:!1},{name:"saVault",isMut:!0,isSigner:!1},{name:"registeredCurrency",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"registered-currency"},{kind:"account",type:"publicKey",account:"Mint",path:"currency_mint"}]}},{name:"openOrdersCounter",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"atlasStaking",isMut:!1,isSigner:!1},{name:"registeredStake",isMut:!1,isSigner:!1},{name:"stakingAccount",isMut:!1,isSigner:!1},{name:"feeReduction",isMut:!1,isSigner:!1}],args:[{name:"purchaseQuantity",type:"u64"},{name:"expectedPrice",type:"u64"},{name:"seller",type:"publicKey"}]},{name:"processCancel",accounts:[{name:"signer",isMut:!0,isSigner:!0},{name:"orderInitializer",isMut:!0,isSigner:!1},{name:"marketVarsAccount",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"market-vars"}]}},{name:"depositMint",isMut:!1,isSigner:!1},{name:"initializerDepositTokenAccount",isMut:!0,isSigner:!1},{name:"orderVaultAccount",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-account"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"orderVaultAuthority",isMut:!1,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"order-vault-auth"},{kind:"account",type:"publicKey",path:"order_initializer"}]}},{name:"orderAccount",isMut:!0,isSigner:!1},{name:"openOrdersCounter",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"open-orders-counter"},{kind:"account",type:"publicKey",path:"order_initializer"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[]},{name:"initializeOpenOrdersCounter",accounts:[{name:"payer",isMut:!0,isSigner:!0},{name:"user",isMut:!1,isSigner:!1},{name:"openOrdersCounter",isMut:!0,isSigner:!1,pda:{seeds:[{kind:"const",type:"string",value:"open-orders-counter"},{kind:"account",type:"publicKey",path:"user"},{kind:"account",type:"publicKey",account:"Mint",path:"deposit_mint"}]}},{name:"depositMint",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[]}],accounts:[{name:"FeeReduction",type:{kind:"struct",fields:[{name:"account",type:"publicKey"},{name:"bump",type:"u8"},{name:"discount",type:"u64"}]}},{name:"MarketVars",type:{kind:"struct",fields:[{name:"updateAuthorityMaster",type:"publicKey"},{name:"bump",type:"u8"}]}},{name:"OpenOrdersCounter",type:{kind:"struct",fields:[{name:"openOrderCount",type:"u64"},{name:"bump",type:"u8"}]}},{name:"OrderAccount",type:{kind:"struct",fields:[{name:"orderInitializerPubkey",type:"publicKey"},{name:"currencyMint",type:"publicKey"},{name:"assetMint",type:"publicKey"},{name:"initializerCurrencyTokenAccount",type:"publicKey"},{name:"initializerAssetTokenAccount",type:"publicKey"},{name:"orderSide",type:{defined:"OrderSide"}},{name:"price",type:"u64"},{name:"orderOriginationQty",type:"u64"},{name:"orderRemainingQty",type:"u64"},{name:"createdAtTimestamp",type:"i64"}]}},{name:"RegisteredCurrency",type:{kind:"struct",fields:[{name:"tokenMint",type:"publicKey"},{name:"saCurrencyVault",type:"publicKey"},{name:"royalty",type:"u64"},{name:"bump",type:"u8"},{name:"royaltyTiers",type:{vec:{defined:"RoyaltyTier"}}}]}}],types:[{name:"RoyaltyTier",type:{kind:"struct",fields:[{name:"stakeAmount",type:"u64"},{name:"discount",type:"u64"}]}},{name:"OrderSide",type:{kind:"enum",variants:[{name:"Buy"},{name:"Sell"}]}},{name:"TokenType",type:{kind:"enum",variants:[{name:"Asset"},{name:"Currency"}]}}],errors:[{code:6e3,name:"InvalidDestinationAccount",msg:"Invalid Destination Token Account"},{code:6001,name:"InvalidInstruction",msg:"Invalid instruction."},{code:6002,name:"InvalidMint",msg:"Invalid SPL Token mint"},{code:6003,name:"InvalidOfferAccountOwner",msg:"Invalid Offer Account Owner"},{code:6004,name:"InvalidTokenAccount",msg:"Invalid SPL Token account"},{code:6005,name:"NumericalOverflowError",msg:"Numerical overflow error"},{code:6006,name:"InvalidUpdateAuthorityAccount",msg:"Invalid Update Authority account"},{code:6007,name:"InvalidOrderVaultAuthorityAccount",msg:"Invalid Order Vault Authority account"},{code:6008,name:"UninitializedTokenAccount",msg:"Uninitialized Token Account"},{code:6009,name:"InsufficientBalance",msg:"Insufficient Balance"},{code:6010,name:"InvalidOrderDuration",msg:"Invalid Order Duration"},{code:6011,name:"InvalidOriginationQty",msg:"Origination quantity must be greater than 0"},{code:6012,name:"InsufficientOrderQty",msg:"Insufficient Order Quantity Remaining"},{code:6013,name:"InvalidRoyalty",msg:"Invalid Royalty Value"},{code:6014,name:"InvalidCounter",msg:"Invalid Open Order Counter"},{code:6015,name:"MintDecimalError",msg:"Mint must be zero decimal"},{code:6016,name:"InvalidOrderAccountError",msg:"Order Account does not match provided account"},{code:6017,name:"InvalidRoyaltyTier",msg:"No royalty tier exists with provided stake amount"},{code:6018,name:"RoyaltyTierLength",msg:"Royalty Tier vector cannot hold any additional tiers"},{code:6019,name:"InvalidOrderPrice",msg:"Order price did not match expected price"},{code:6020,name:"DuplicateRoyaltyTier",msg:"Royalty tier already exists"},{code:6021,name:"InvalidSeller",msg:"Order seller did not match expected seller"}],metadata:{}};var Ua={};Object.defineProperty(Ua,"__esModule",{value:!0});Ua.baseIdl=void 0;Ua.baseIdl={version:"0.1.0",name:"gm_logs",instructions:[],events:[{name:"RegisterCurrencyMemo",fields:[{name:"updateAuthorityAccount",type:"publicKey",index:!1},{name:"registeredCurrency",type:"publicKey",index:!1},{name:"currencyMint",type:"publicKey",index:!1},{name:"saCurrencyVault",type:"publicKey",index:!1},{name:"royalty",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"InitializeMemo",fields:[{name:"orderInitializerPubkey",type:"publicKey",index:!1},{name:"currencyMint",type:"publicKey",index:!1},{name:"assetMint",type:"publicKey",index:!1},{name:"initializerCurrencyTokenAccount",type:"publicKey",index:!1},{name:"initializerAssetTokenAccount",type:"publicKey",index:!1},{name:"orderSide",type:"u8",index:!1},{name:"price",type:"u64",index:!1},{name:"orderOriginationQty",type:"u64",index:!1},{name:"orderRemainingQty",type:"u64",index:!1},{name:"createdAtTimestamp",type:"i64",index:!1},{name:"orderId",type:"publicKey",index:!1}]},{name:"ExchangeMemo",fields:[{name:"orderInitializerPubkey",type:"publicKey",index:!1},{name:"currencyMint",type:"publicKey",index:!1},{name:"assetMint",type:"publicKey",index:!1},{name:"initializerCurrencyTokenAccount",type:"publicKey",index:!1},{name:"initializerAssetTokenAccount",type:"publicKey",index:!1},{name:"orderSide",type:"u8",index:!1},{name:"price",type:"u64",index:!1},{name:"orderOriginationQty",type:"u64",index:!1},{name:"orderRemainingQty",type:"u64",index:!1},{name:"createdAtTimestamp",type:"i64",index:!1},{name:"orderId",type:"publicKey",index:!1}]},{name:"CancelOrderMemo",fields:[{name:"orderInitializerPubkey",type:"publicKey",index:!1},{name:"currencyMint",type:"publicKey",index:!1},{name:"assetMint",type:"publicKey",index:!1},{name:"initializerCurrencyTokenAccount",type:"publicKey",index:!1},{name:"initializerAssetTokenAccount",type:"publicKey",index:!1},{name:"orderSide",type:"u8",index:!1},{name:"price",type:"u64",index:!1},{name:"orderOriginationQty",type:"u64",index:!1},{name:"orderRemainingQty",type:"u64",index:!1},{name:"createdAtTimestamp",type:"i64",index:!1},{name:"orderId",type:"publicKey",index:!1}]},{name:"StakeMemo",fields:[{name:"user",type:"publicKey",index:!1},{name:"registeredStake",type:"publicKey",index:!1},{name:"stakingAccount",type:"publicKey",index:!1},{name:"stakeAmount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"TransferMemo",fields:[{name:"user",type:"publicKey",index:!1},{name:"registeredStake",type:"publicKey",index:!1},{name:"stakingAccount",type:"publicKey",index:!1},{name:"transferAmount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"WithdrawMemo",fields:[{name:"user",type:"publicKey",index:!1},{name:"registeredStake",type:"publicKey",index:!1},{name:"stakingAccount",type:"publicKey",index:!1},{name:"withdrawAmount",type:"u64",index:!1},{name:"timestamp",type:"i64",index:!1}]},{name:"SettleMemo",fields:[{name:"user",type:"publicKey",index:!1},{name:"registeredStake",type:"publicKey",index:!1},{name:"stakingAccount",type:"publicKey",index:!1},{name:"timestamp",type:"i64",index:!1}]}],metadata:{}};var D_=T&&T.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),V_=T&&T.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),z_=T&&T.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&D_(e,r,t);return V_(e,r),e};Object.defineProperty(bn,"__esModule",{value:!0});bn.getMarketplaceProgram=bn.getGmLogsIDL=bn.getGmIDL=void 0;const Ld=Ke,F_=Js,U_=z_(Ua);function mp(r){const e=F_.baseIdl;return e.metadata.address=r.toBase58(),e}bn.getGmIDL=mp;function $_(r){const e=U_.baseIdl;return e.metadata.address=r.toBase58(),e}bn.getGmLogsIDL=$_;function W_({connection:r,programId:e}){const t=mp(e),n=new Ld.AnchorProvider(r,null,null);return new Ld.Program(t,e,n)}bn.getMarketplaceProgram=W_;var ti=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Ot,"__esModule",{value:!0});Ot.getSingleOrder=Ot.getOpenOrdersForPlayerAndAsset=Ot.getOpenOrdersForPlayerAndCurrency=Ot.getOpenOrdersForAsset=Ot.getOpenOrdersForCurrency=Ot.getOpenOrdersForPlayer=Ot.getAllOpenOrders=void 0;const qt=Ke,ni=bn;function j_(r,e){return ti(this,void 0,void 0,function*(){const t=new qt.AnchorProvider(r,null,null),n=(0,ni.getGmIDL)(e),i=new qt.Program(n,e,t),s=[{dataSize:201}];return yield i.account.orderAccount.all(s)})}Ot.getAllOpenOrders=j_;function q_(r,e,t){return ti(this,void 0,void 0,function*(){const n=new qt.AnchorProvider(r,null,null),i=(0,ni.getGmIDL)(t),s=new qt.Program(i,t,n),o=[{dataSize:201},{memcmp:{offset:8,bytes:e.toBase58()}}];return yield s.account.orderAccount.all(o)})}Ot.getOpenOrdersForPlayer=q_;function G_(r,e,t){return ti(this,void 0,void 0,function*(){const n=new qt.AnchorProvider(r,null,null),i=(0,ni.getGmIDL)(t),s=new qt.Program(i,t,n),o=[{dataSize:201},{memcmp:{offset:40,bytes:e.toBase58()}}];return yield s.account.orderAccount.all(o)})}Ot.getOpenOrdersForCurrency=G_;function H_(r,e,t){return ti(this,void 0,void 0,function*(){const n=new qt.AnchorProvider(r,null,null),i=(0,ni.getGmIDL)(t),s=new qt.Program(i,t,n),o=[{dataSize:201},{memcmp:{offset:72,bytes:e.toBase58()}}];return yield s.account.orderAccount.all(o)})}Ot.getOpenOrdersForAsset=H_;function Y_(r,e,t,n){return ti(this,void 0,void 0,function*(){const i=new qt.AnchorProvider(r,null,null),s=(0,ni.getGmIDL)(n),o=new qt.Program(s,n,i),a=[{dataSize:201},{memcmp:{offset:40,bytes:t.toBase58()}},{memcmp:{offset:8,bytes:e.toBase58()}}];return yield o.account.orderAccount.all(a)})}Ot.getOpenOrdersForPlayerAndCurrency=Y_;function Q_(r,e,t,n){return ti(this,void 0,void 0,function*(){const i=new qt.AnchorProvider(r,null,null),s=(0,ni.getGmIDL)(n),o=new qt.Program(s,n,i),a=[{dataSize:201},{memcmp:{offset:72,bytes:t.toBase58()}},{memcmp:{offset:8,bytes:e.toBase58()}}];return yield o.account.orderAccount.all(a)})}Ot.getOpenOrdersForPlayerAndAsset=Q_;function J_(r,e,t){return ti(this,void 0,void 0,function*(){const n=new qt.AnchorProvider(r,null,null),i=(0,ni.getGmIDL)(t);return yield new qt.Program(i,t,n).account.orderAccount.fetch(e)})}Ot.getSingleOrder=J_;var lt={},Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});Kt.FEE_EXEMPT_SEED=Kt.OPEN_ORDERS_COUNTER=Kt.REGISTERED_CURRENCY_SEED=Kt.ORDER_VAULT_AUTH_SEED=Kt.ORDER_VAULT_SEED=Kt.MARKET_VARS_SEED=void 0;Kt.MARKET_VARS_SEED=ae.Buffer.from("market-vars");Kt.ORDER_VAULT_SEED=ae.Buffer.from("order-vault-account");Kt.ORDER_VAULT_AUTH_SEED=ae.Buffer.from("order-vault-auth");Kt.REGISTERED_CURRENCY_SEED=ae.Buffer.from("registered-currency");Kt.OPEN_ORDERS_COUNTER=ae.Buffer.from("open-orders-counter");Kt.FEE_EXEMPT_SEED=ae.Buffer.from("fee_exempt");var X_=T&&T.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Z_=T&&T.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),eA=T&&T.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.prototype.hasOwnProperty.call(r,t)&&X_(e,r,t);return Z_(e,r),e},Ar=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(lt,"__esModule",{value:!0});lt.getAllFeeExemptAccounts=lt.getFeeExemptAccount=lt.getOpenOrdersCounter=lt.getAllRegisteredCurrencies=lt.getRegisteredCurrencyAccount=lt.getOrderVaultAuth=lt.getOrderVault=lt.getMarketVarsAccount=void 0;const ea=Ke,es=Xn,ts=eA(Kt),bp=bn;function tA(r){return Ar(this,void 0,void 0,function*(){return es.PublicKey.findProgramAddress([ts.MARKET_VARS_SEED],r)})}lt.getMarketVarsAccount=tA;function nA(r,e,t){return Ar(this,void 0,void 0,function*(){return es.PublicKey.findProgramAddress([ts.ORDER_VAULT_SEED,r.toBuffer(),e.toBuffer()],t)})}lt.getOrderVault=nA;function rA(r,e){return Ar(this,void 0,void 0,function*(){return es.PublicKey.findProgramAddress([ts.ORDER_VAULT_AUTH_SEED,r.toBuffer()],e)})}lt.getOrderVaultAuth=rA;function iA(r,e){return Ar(this,void 0,void 0,function*(){return es.PublicKey.findProgramAddress([ts.REGISTERED_CURRENCY_SEED,e.toBuffer()],r)})}lt.getRegisteredCurrencyAccount=iA;function sA(r,e){return Ar(this,void 0,void 0,function*(){const t=new ea.AnchorProvider(r,null,null),n=(0,bp.getGmIDL)(e),i=new ea.Program(n,e,t),s=[{dataSize:1686}],o=yield i.account.registeredCurrency.all(s),a=[];for(const c of o){const l={mint:c.account.tokenMint,royalty:c.account.royalty,saVault:c.account.saCurrencyVault};a.push(l)}return a})}lt.getAllRegisteredCurrencies=sA;function oA(r,e,t){return Ar(this,void 0,void 0,function*(){return es.PublicKey.findProgramAddress([ts.OPEN_ORDERS_COUNTER,r.toBuffer(),e.toBuffer()],t)})}lt.getOpenOrdersCounter=oA;function aA(r,e){return Ar(this,void 0,void 0,function*(){return es.PublicKey.findProgramAddress([ts.FEE_EXEMPT_SEED,r.toBuffer()],e)})}lt.getFeeExemptAccount=aA;function cA(r,e){return Ar(this,void 0,void 0,function*(){const t=new ea.AnchorProvider(r,null,null),n=(0,bp.getGmIDL)(e);return yield new ea.Program(n,e,t).account.feeReduction.all()})}lt.getAllFeeExemptAccounts=cA;var Ft={},ns=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Ft,"__esModule",{value:!0});Ft.getRoyaltyReductionForStakingAccount=Ft.getRoyaltyReductionForUserAndMint=Ft.getRegisteredCurrencyInfoFromPubkey=Ft.getRegisteredCurrencyAccountInfo=Ft.getFeeExemptAccountInfo=Ft.getMarketVarsAccountInfo=void 0;const ta=Ke,_l=lt,$a=bn,Au=ma;function uA(r,e){return ns(this,void 0,void 0,function*(){const t=(0,$a.getMarketplaceProgram)({connection:r,programId:e}),[n]=yield(0,_l.getMarketVarsAccount)(e);return yield t.account.marketVars.fetch(n)})}Ft.getMarketVarsAccountInfo=uA;function lA(r,e,t){return ns(this,void 0,void 0,function*(){const n=(0,$a.getMarketplaceProgram)({connection:r,programId:t}),[i]=yield(0,_l.getFeeExemptAccount)(e,t);return yield n.account.feeExempt.fetch(i)})}Ft.getFeeExemptAccountInfo=lA;function dA(r,e,t){return ns(this,void 0,void 0,function*(){const n=(0,$a.getMarketplaceProgram)({connection:r,programId:e}),[i]=yield(0,_l.getRegisteredCurrencyAccount)(e,t);return yield n.account.registeredCurrency.fetch(i)})}Ft.getRegisteredCurrencyAccountInfo=dA;function Al(r,e,t){return ns(this,void 0,void 0,function*(){return yield(0,$a.getMarketplaceProgram)({connection:r,programId:e}).account.registeredCurrency.fetch(t)})}Ft.getRegisteredCurrencyInfoFromPubkey=Al;function fA(r,e,t,n,i,s){return ns(this,void 0,void 0,function*(){let o=0;const a=yield Al(r,e,i),[c]=yield(0,Au.getStakingAccount)(t,n,s),l=yield(0,Au.getStakingAccountInfo)(r,c,t);if(l.unstakedTs.eq(new ta.BN(0))){const u=a.royaltyTiers;let h=new ta.BN(0);for(const b of u)l.totalStake.gte(b.stakeAmount)&&(h=b.discount);o=h.toNumber()/1e4}return o})}Ft.getRoyaltyReductionForUserAndMint=fA;function hA(r,e,t,n,i){return ns(this,void 0,void 0,function*(){let s=0;const o=yield Al(r,e,i),a=yield(0,Au.getStakingAccountInfo)(r,n,t);if(a.unstakedTs.eq(new ta.BN(0))){const c=o.royaltyTiers;let l=new ta.BN(0);for(const u of c)a.totalStake.gte(u.stakeAmount)&&(l=u.discount);s=l.toNumber()/1e4}return s})}Ft.getRoyaltyReductionForStakingAccount=hA;(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Ot,r),t(lt,r),t(Ft,r),t(Kt,r)})(_r);var Xs={},Ht={},fr={},pA=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(fr,"__esModule",{value:!0});fr.convertDecimalPriceToBn=fr.initializeAtaForMint=fr.getOrderSide=void 0;const yA=Ke,gA=Yr,$c=Qs,mA=r=>JSON.stringify(r.orderSide)===JSON.stringify({buy:{}})?"BuySide":"SellSide";fr.getOrderSide=mA;function bA({mint:r,owner:e,connection:t}){return pA(this,void 0,void 0,function*(){const n=[],i=yield(0,gA.associatedAddress)({mint:r,owner:e});return(yield t.getAccountInfo(i))===null&&n.push($c.Token.createAssociatedTokenAccountInstruction($c.ASSOCIATED_TOKEN_PROGRAM_ID,$c.TOKEN_PROGRAM_ID,r,i,e,e)),{account:i,instructions:n}})}fr.initializeAtaForMint=bA;const vA=(r,e)=>new yA.BN(r*Math.pow(10,e));fr.convertDecimalPriceToBn=vA;(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(bn,r),t(fr,r)})(Ht);var wA=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Xs,"__esModule",{value:!0});Xs.createOrderCounterInstruction=void 0;const _A=Ht;function AA({connection:r,payer:e,initializerMainAccount:t,depositMint:n,programId:i}){return wA(this,void 0,void 0,function*(){return yield(0,_A.getMarketplaceProgram)({connection:r,programId:i}).methods.initializeOpenOrdersCounter().accounts({payer:e,user:t,depositMint:n}).instruction()})}Xs.createOrderCounterInstruction=AA;var SA=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Fa,"__esModule",{value:!0});Fa.createCancelOrderInstruction=void 0;const kA=Ke,IA=_r,EA=Xs,Nd=Ht,OA=yn;function PA({connection:r,orderInitializer:e,orderAccount:t,programId:n,payer:i=e}){return SA(this,void 0,void 0,function*(){const s=(0,Nd.getMarketplaceProgram)({connection:r,programId:n}),o={signers:[],instructions:[]},a=yield s.account.orderAccount.fetch(t),l=(0,Nd.getOrderSide)(a)==="SellSide"?a.assetMint:a.currencyMint;let u=null,h=null;const b=yield(0,OA.getTokenAccount)(r,e,l);u=b.tokenAccount,"createInstruction"in b&&o.instructions.push(...b.createInstruction),u instanceof kA.web3.Keypair?(h=u.publicKey,o.signers.push(u)):h=u;const[w]=yield(0,IA.getOpenOrdersCounter)(e,l,n);if((yield r.getAccountInfo(w))===null){const _=yield(0,EA.createOrderCounterInstruction)({connection:r,payer:i,initializerMainAccount:e,depositMint:l,programId:n});o.instructions.push(_)}const g=yield s.methods.processCancel().accounts({signer:i,depositMint:l,orderInitializer:e,initializerDepositTokenAccount:h,orderAccount:t}).instruction();return o.instructions.push(g),o})}Fa.createCancelOrderInstruction=PA;var Ni={},vp=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Ni,"__esModule",{value:!0});Ni.createInitializeSellOrderInstruction=Ni.createInitializeBuyOrderInstruction=void 0;const Pi=Ke,wp=Ht,_p=yn,Ap=_r,Sp=Xs,kp=yn;function TA({connection:r,initializerMainAccount:e,initializerDepositTokenAccount:t,price:n,originationQty:i,depositMint:s,receiveMint:o,programId:a}){return vp(this,void 0,void 0,function*(){const c=(0,wp.getMarketplaceProgram)({connection:r,programId:a}),l={signers:[],instructions:[]};let u=null,h=null;const b=yield(0,_p.getTokenAccount)(r,e,o);u=b.tokenAccount,"createInstruction"in b&&l.instructions.push(...b.createInstruction),u instanceof Pi.web3.Keypair?(h=u.publicKey,l.signers.push(u)):h=u;const[w]=yield(0,Ap.getOpenOrdersCounter)(e,s,a);if((yield r.getAccountInfo(w))===null){const L=yield(0,Sp.createOrderCounterInstruction)({connection:r,payer:e,initializerMainAccount:e,depositMint:s,programId:a});l.instructions.push(L)}const g=Pi.web3.Keypair.generate();l.signers.push(g);const _=yield(0,kp.createAccountInstruction)(r,e,g,a);l.instructions.push(_);const I=yield c.methods.processInitializeBuy(n,new Pi.BN(i)).accounts({orderInitializer:e,initializerDepositTokenAccount:t,initializerReceiveTokenAccount:h,orderAccount:g.publicKey,depositMint:s,receiveMint:o}).signers([g]).instruction();return l.instructions.push(I),{orderAccount:g.publicKey,ixSet:l}})}Ni.createInitializeBuyOrderInstruction=TA;function BA({connection:r,initializerMainAccount:e,initializerDepositTokenAccount:t,price:n,originationQty:i,depositMint:s,receiveMint:o,programId:a}){return vp(this,void 0,void 0,function*(){const c=(0,wp.getMarketplaceProgram)({connection:r,programId:a}),l={signers:[],instructions:[]};let u=null,h=null;const b=yield(0,_p.getTokenAccount)(r,e,o);u=b.tokenAccount,"createInstruction"in b&&l.instructions.push(...b.createInstruction),u instanceof Pi.web3.Keypair?(h=u.publicKey,l.signers.push(u)):h=u;const[w]=yield(0,Ap.getOpenOrdersCounter)(e,s,a);if((yield r.getAccountInfo(w))===null){const L=yield(0,Sp.createOrderCounterInstruction)({connection:r,payer:e,initializerMainAccount:e,depositMint:s,programId:a});l.instructions.push(L)}const g=Pi.web3.Keypair.generate();l.signers.push(g);const _=yield(0,kp.createAccountInstruction)(r,e,g,a);l.instructions.push(_);const I=yield c.methods.processInitializeSell(n,new Pi.BN(i)).accounts({orderInitializer:e,initializerDepositTokenAccount:t,initializerReceiveTokenAccount:h,orderAccount:g.publicKey,depositMint:s,receiveMint:o}).signers([g]).instruction();return l.instructions.push(I),{orderAccount:g.publicKey,ixSet:l}})}Ni.createInitializeSellOrderInstruction=BA;var Wa={},RA=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Wa,"__esModule",{value:!0});Wa.createDeregisterCurrencyInstruction=void 0;const xA=Ht;function MA({connection:r,updateAuthorityAccount:e,currencyMint:t,programId:n}){return RA(this,void 0,void 0,function*(){const s=[yield(0,xA.getMarketplaceProgram)({connection:r,programId:n}).methods.deregisterCurrency().accounts({updateAuthorityAccount:e,currencyMint:t}).instruction()];return{accounts:[],instructions:s}})}Wa.createDeregisterCurrencyInstruction=MA;var ja={},qa={},Ga={},Ip={exports:{}};(function(r){(function(e){var t,n=20,i=1,s=1e6,o=1e6,a=-7,c=21,l=!1,u="[big.js] ",h=u+"Invalid ",b=h+"decimal places",w=h+"rounding mode",k=u+"Division by zero",g={},_=void 0,I=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function L(){function v(O){var R=this;if(!(R instanceof v))return O===_?L():new v(O);if(O instanceof v)R.s=O.s,R.e=O.e,R.c=O.c.slice();else{if(typeof O!="string"){if(v.strict===!0&&typeof O!="bigint")throw TypeError(h+"value");O=O===0&&1/O<0?"-0":String(O)}G(R,O)}R.constructor=v}return v.prototype=g,v.DP=n,v.RM=i,v.NE=a,v.PE=c,v.strict=l,v.roundDown=0,v.roundHalfUp=1,v.roundHalfEven=2,v.roundUp=3,v}function G(v,O){var R,N,M;if(!I.test(O))throw Error(h+"number");for(v.s=O.charAt(0)=="-"?(O=O.slice(1),-1):1,(R=O.indexOf("."))>-1&&(O=O.replace(".","")),(N=O.search(/e/i))>0?(R<0&&(R=N),R+=+O.slice(N+1),O=O.substring(0,N)):R<0&&(R=O.length),M=O.length,N=0;N<M&&O.charAt(N)=="0";)++N;if(N==M)v.c=[v.e=0];else{for(;M>0&&O.charAt(--M)=="0";);for(v.e=R-N-1,v.c=[],R=0;N<=M;)v.c[R++]=+O.charAt(N++)}return v}function $(v,O,R,N){var M=v.c;if(R===_&&(R=v.constructor.RM),R!==0&&R!==1&&R!==2&&R!==3)throw Error(w);if(O<1)N=R===3&&(N||!!M[0])||O===0&&(R===1&&M[0]>=5||R===2&&(M[0]>5||M[0]===5&&(N||M[1]!==_))),M.length=1,N?(v.e=v.e-O+1,M[0]=1):M[0]=v.e=0;else if(O<M.length){if(N=R===1&&M[O]>=5||R===2&&(M[O]>5||M[O]===5&&(N||M[O+1]!==_||M[O-1]&1))||R===3&&(N||!!M[0]),M.length=O,N){for(;++M[--O]>9;)if(M[O]=0,O===0){++v.e,M.unshift(1);break}}for(O=M.length;!M[--O];)M.pop()}return v}function Q(v,O,R){var N=v.e,M=v.c.join(""),J=M.length;if(O)M=M.charAt(0)+(J>1?"."+M.slice(1):"")+(N<0?"e":"e+")+N;else if(N<0){for(;++N;)M="0"+M;M="0."+M}else if(N>0)if(++N>J)for(N-=J;N--;)M+="0";else N<J&&(M=M.slice(0,N)+"."+M.slice(N));else J>1&&(M=M.charAt(0)+"."+M.slice(1));return v.s<0&&R?"-"+M:M}g.abs=function(){var v=new this.constructor(this);return v.s=1,v},g.cmp=function(v){var O,R=this,N=R.c,M=(v=new R.constructor(v)).c,J=R.s,re=v.s,S=R.e,K=v.e;if(!N[0]||!M[0])return N[0]?J:M[0]?-re:0;if(J!=re)return J;if(O=J<0,S!=K)return S>K^O?1:-1;for(re=(S=N.length)<(K=M.length)?S:K,J=-1;++J<re;)if(N[J]!=M[J])return N[J]>M[J]^O?1:-1;return S==K?0:S>K^O?1:-1},g.div=function(v){var O=this,R=O.constructor,N=O.c,M=(v=new R(v)).c,J=O.s==v.s?1:-1,re=R.DP;if(re!==~~re||re<0||re>s)throw Error(b);if(!M[0])throw Error(k);if(!N[0])return v.s=J,v.c=[v.e=0],v;var S,K,U,ue,X,le=M.slice(),yt=S=M.length,Rt=N.length,oe=N.slice(0,S),me=oe.length,vt=v,kt=vt.c=[],gt=0,Ge=re+(vt.e=O.e-v.e)+1;for(vt.s=J,J=Ge<0?0:Ge,le.unshift(0);me++<S;)oe.push(0);do{for(U=0;U<10;U++){if(S!=(me=oe.length))ue=S>me?1:-1;else for(X=-1,ue=0;++X<S;)if(M[X]!=oe[X]){ue=M[X]>oe[X]?1:-1;break}if(ue<0){for(K=me==S?M:le;me;){if(oe[--me]<K[me]){for(X=me;X&&!oe[--X];)oe[X]=9;--oe[X],oe[me]+=10}oe[me]-=K[me]}for(;!oe[0];)oe.shift()}else break}kt[gt++]=ue?U:++U,oe[0]&&ue?oe[me]=N[yt]||0:oe=[N[yt]]}while((yt++<Rt||oe[0]!==_)&&J--);return!kt[0]&&gt!=1&&(kt.shift(),vt.e--,Ge--),gt>Ge&&$(vt,Ge,R.RM,oe[0]!==_),vt},g.eq=function(v){return this.cmp(v)===0},g.gt=function(v){return this.cmp(v)>0},g.gte=function(v){return this.cmp(v)>-1},g.lt=function(v){return this.cmp(v)<0},g.lte=function(v){return this.cmp(v)<1},g.minus=g.sub=function(v){var O,R,N,M,J=this,re=J.constructor,S=J.s,K=(v=new re(v)).s;if(S!=K)return v.s=-K,J.plus(v);var U=J.c.slice(),ue=J.e,X=v.c,le=v.e;if(!U[0]||!X[0])return X[0]?v.s=-K:U[0]?v=new re(J):v.s=1,v;if(S=ue-le){for((M=S<0)?(S=-S,N=U):(le=ue,N=X),N.reverse(),K=S;K--;)N.push(0);N.reverse()}else for(R=((M=U.length<X.length)?U:X).length,S=K=0;K<R;K++)if(U[K]!=X[K]){M=U[K]<X[K];break}if(M&&(N=U,U=X,X=N,v.s=-v.s),(K=(R=X.length)-(O=U.length))>0)for(;K--;)U[O++]=0;for(K=O;R>S;){if(U[--R]<X[R]){for(O=R;O&&!U[--O];)U[O]=9;--U[O],U[R]+=10}U[R]-=X[R]}for(;U[--K]===0;)U.pop();for(;U[0]===0;)U.shift(),--le;return U[0]||(v.s=1,U=[le=0]),v.c=U,v.e=le,v},g.mod=function(v){var O,R=this,N=R.constructor,M=R.s,J=(v=new N(v)).s;if(!v.c[0])throw Error(k);return R.s=v.s=1,O=v.cmp(R)==1,R.s=M,v.s=J,O?new N(R):(M=N.DP,J=N.RM,N.DP=N.RM=0,R=R.div(v),N.DP=M,N.RM=J,this.minus(R.times(v)))},g.neg=function(){var v=new this.constructor(this);return v.s=-v.s,v},g.plus=g.add=function(v){var O,R,N,M=this,J=M.constructor;if(v=new J(v),M.s!=v.s)return v.s=-v.s,M.minus(v);var re=M.e,S=M.c,K=v.e,U=v.c;if(!S[0]||!U[0])return U[0]||(S[0]?v=new J(M):v.s=M.s),v;if(S=S.slice(),O=re-K){for(O>0?(K=re,N=U):(O=-O,N=S),N.reverse();O--;)N.push(0);N.reverse()}for(S.length-U.length<0&&(N=U,U=S,S=N),O=U.length,R=0;O;S[O]%=10)R=(S[--O]=S[O]+U[O]+R)/10|0;for(R&&(S.unshift(R),++K),O=S.length;S[--O]===0;)S.pop();return v.c=S,v.e=K,v},g.pow=function(v){var O=this,R=new O.constructor("1"),N=R,M=v<0;if(v!==~~v||v<-o||v>o)throw Error(h+"exponent");for(M&&(v=-v);v&1&&(N=N.times(O)),v>>=1,!!v;)O=O.times(O);return M?R.div(N):N},g.prec=function(v,O){if(v!==~~v||v<1||v>s)throw Error(h+"precision");return $(new this.constructor(this),v,O)},g.round=function(v,O){if(v===_)v=0;else if(v!==~~v||v<-s||v>s)throw Error(b);return $(new this.constructor(this),v+this.e+1,O)},g.sqrt=function(){var v,O,R,N=this,M=N.constructor,J=N.s,re=N.e,S=new M("0.5");if(!N.c[0])return new M(N);if(J<0)throw Error(u+"No square root");J=Math.sqrt(N+""),J===0||J===1/0?(O=N.c.join(""),O.length+re&1||(O+="0"),J=Math.sqrt(O),re=((re+1)/2|0)-(re<0||re&1),v=new M((J==1/0?"5e":(J=J.toExponential()).slice(0,J.indexOf("e")+1))+re)):v=new M(J+""),re=v.e+(M.DP+=4);do R=v,v=S.times(R.plus(N.div(R)));while(R.c.slice(0,re).join("")!==v.c.slice(0,re).join(""));return $(v,(M.DP-=4)+v.e+1,M.RM)},g.times=g.mul=function(v){var O,R=this,N=R.constructor,M=R.c,J=(v=new N(v)).c,re=M.length,S=J.length,K=R.e,U=v.e;if(v.s=R.s==v.s?1:-1,!M[0]||!J[0])return v.c=[v.e=0],v;for(v.e=K+U,re<S&&(O=M,M=J,J=O,U=re,re=S,S=U),O=new Array(U=re+S);U--;)O[U]=0;for(K=S;K--;){for(S=0,U=re+K;U>K;)S=O[U]+J[K]*M[U-K-1]+S,O[U--]=S%10,S=S/10|0;O[U]=S}for(S?++v.e:O.shift(),K=O.length;!O[--K];)O.pop();return v.c=O,v},g.toExponential=function(v,O){var R=this,N=R.c[0];if(v!==_){if(v!==~~v||v<0||v>s)throw Error(b);for(R=$(new R.constructor(R),++v,O);R.c.length<v;)R.c.push(0)}return Q(R,!0,!!N)},g.toFixed=function(v,O){var R=this,N=R.c[0];if(v!==_){if(v!==~~v||v<0||v>s)throw Error(b);for(R=$(new R.constructor(R),v+R.e+1,O),v=v+R.e+1;R.c.length<v;)R.c.push(0)}return Q(R,!1,!!N)},g.toJSON=g.toString=function(){var v=this,O=v.constructor;return Q(v,v.e<=O.NE||v.e>=O.PE,!!v.c[0])},g.toNumber=function(){var v=Number(Q(this,!0,!0));if(this.constructor.strict===!0&&!this.eq(v.toString()))throw Error(u+"Imprecise conversion");return v},g.toPrecision=function(v,O){var R=this,N=R.constructor,M=R.c[0];if(v!==_){if(v!==~~v||v<1||v>s)throw Error(h+"precision");for(R=$(new N(R),v,O);R.c.length<v;)R.c.push(0)}return Q(R,v<=R.e||R.e<=N.NE||R.e>=N.PE,!!M)},g.valueOf=function(){var v=this,O=v.constructor;if(O.strict===!0)throw Error(u+"valueOf disallowed");return Q(v,v.e<=O.NE||v.e>=O.PE,!0)},t=L(),t.default=t.Big=t,r.exports?r.exports=t:e.Big=t})(T)})(Ip);function de(r){for(var e=arguments.length,t=new Array(e>1?e-1:0),n=1;n<e;n++)t[n-1]=arguments[n];throw new Error(typeof r=="number"?"[MobX] minified error nr: "+r+(t.length?" "+t.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+r)}var CA={};function Sl(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ae.global<"u"?ae.global:typeof self<"u"?self:CA}var Ep=Object.assign,na=Object.getOwnPropertyDescriptor,Ln=Object.defineProperty,Zs=Object.prototype,Su=[];Object.freeze(Su);var kl={};Object.freeze(kl);var KA=typeof Proxy<"u",LA=Object.toString();function Op(){KA||de("Proxy not available")}function Pp(r){var e=!1;return function(){if(!e)return e=!0,r.apply(this,arguments)}}var _i=function(){};function rn(r){return typeof r=="function"}function Ur(r){var e=typeof r;switch(e){case"string":case"symbol":case"number":return!0}return!1}function Ha(r){return r!==null&&typeof r=="object"}function Jn(r){if(!Ha(r))return!1;var e=Object.getPrototypeOf(r);if(e==null)return!0;var t=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return typeof t=="function"&&t.toString()===LA}function Tp(r){var e=r==null?void 0:r.constructor;return e?e.name==="GeneratorFunction"||e.displayName==="GeneratorFunction":!1}function eo(r,e,t){Ln(r,e,{enumerable:!1,writable:!0,configurable:!0,value:t})}function Bp(r,e,t){Ln(r,e,{enumerable:!1,writable:!1,configurable:!0,value:t})}function Sr(r,e){var t="isMobX"+r;return e.prototype[t]=!0,function(n){return Ha(n)&&n[t]===!0}}function rs(r){return r instanceof Map}function to(r){return r instanceof Set}var Rp=typeof Object.getOwnPropertySymbols<"u";function NA(r){var e=Object.keys(r);if(!Rp)return e;var t=Object.getOwnPropertySymbols(r);return t.length?[].concat(e,t.filter(function(n){return Zs.propertyIsEnumerable.call(r,n)})):e}var Di=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Rp?function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:Object.getOwnPropertyNames;function xp(r){return r===null?null:typeof r=="object"?""+r:r}function Hn(r,e){return Zs.hasOwnProperty.call(r,e)}var DA=Object.getOwnPropertyDescriptors||function(e){var t={};return Di(e).forEach(function(n){t[n]=na(e,n)}),t};function Dd(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,FA(n.key),n)}}function Il(r,e,t){return e&&Dd(r.prototype,e),t&&Dd(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}function mr(){return mr=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},mr.apply(this,arguments)}function Mp(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,ku(r,e)}function ku(r,e){return ku=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},ku(r,e)}function Wc(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function VA(r,e){if(!!r){if(typeof r=="string")return Vd(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Vd(r,e)}}function Vd(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function Ai(r,e){var t=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t)return(t=t.call(r)).next.bind(t);if(Array.isArray(r)||(t=VA(r))||e&&r&&typeof r.length=="number"){t&&(r=t);var n=0;return function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zA(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function FA(r){var e=zA(r,"string");return typeof e=="symbol"?e:String(e)}var Kn=Symbol("mobx-stored-annotations");function vn(r){function e(t,n){if(no(n))return r.decorate_20223_(t,n);is(t,n,r)}return Object.assign(e,r)}function is(r,e,t){Hn(r,Kn)||eo(r,Kn,mr({},r[Kn])),QA(t)||(r[Kn][e]=t)}function UA(r){return Hn(r,Kn)||eo(r,Kn,mr({},r[Kn])),r[Kn]}function no(r){return typeof r=="object"&&typeof r.kind=="string"}var ne=Symbol("mobx administration"),ro=function(){function r(t){t===void 0&&(t="Atom"),this.name_=void 0,this.isPendingUnobservation_=!1,this.isBeingObserved_=!1,this.observers_=new Set,this.batchId_=void 0,this.diffValue_=0,this.lastAccessedBy_=0,this.lowestObserverState_=Ee.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=t,this.batchId_=q.inBatch?q.batchId:NaN}var e=r.prototype;return e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.reportObserved=function(){return ey(this)},e.reportChanged=function(){(!q.inBatch||this.batchId_!==q.batchId)&&(q.stateVersion=q.stateVersion<Number.MAX_SAFE_INTEGER?q.stateVersion+1:Number.MIN_SAFE_INTEGER,this.batchId_=NaN),Ut(),ty(this),$t()},e.toString=function(){return this.name_},r}(),El=Sr("Atom",ro);function Ya(r,e,t){e===void 0&&(e=_i),t===void 0&&(t=_i);var n=new ro(r);return e!==_i&&ly(n,e),t!==_i&&oo(n,t),n}function $A(r,e){return r===e}function WA(r,e){return Cl(r,e)}function jA(r,e){return Cl(r,e,1)}function qA(r,e){return Object.is?Object.is(r,e):r===e?r!==0||1/r===1/e:r!==r&&e!==e}var $r={identity:$A,structural:WA,default:qA,shallow:jA};function Wr(r,e,t){return rc(r)?r:Array.isArray(r)?je.array(r,{name:t}):Jn(r)?je.object(r,void 0,{name:t}):rs(r)?je.map(r,{name:t}):to(r)?je.set(r,{name:t}):typeof r=="function"&&!kr(r)&&!Ui(r)?Tp(r)?Gr(r):Fi(t,r):r}function GA(r,e,t){if(r==null||ft(r)||bt(r)||pt(r)||Nt(r))return r;if(Array.isArray(r))return je.array(r,{name:t,deep:!1});if(Jn(r))return je.object(r,void 0,{name:t,deep:!1});if(rs(r))return je.map(r,{name:t,deep:!1});if(to(r))return je.set(r,{name:t,deep:!1})}function Qa(r){return r}function HA(r,e){return Cl(r,e)?e:r}var Cp="override",YA=vn({annotationType_:Cp,make_:JA,extend_:XA,decorate_20223_:ZA});function QA(r){return r.annotationType_===Cp}function JA(r,e){return 0}function XA(r,e,t,n){de("'"+this.annotationType_+"' can only be used with 'makeObservable'")}function ZA(r,e){console.warn("'"+this.annotationType_+"' cannot be used with decorators - this is a no-op")}function io(r,e){return{annotationType_:r,options_:e,make_:eS,extend_:tS,decorate_20223_:nS}}function eS(r,e,t,n){var i;if((i=this.options_)!=null&&i.bound)return this.extend_(r,e,t,!1)===null?0:1;if(n===r.target_)return this.extend_(r,e,t,!1)===null?0:2;if(kr(t.value))return 1;var s=Kp(r,this,e,t,!1);return Ln(n,e,s),2}function tS(r,e,t,n){var i=Kp(r,this,e,t);return r.defineProperty_(e,i,n)}function nS(r,e){var t=e.kind,n=e.name,i=e.addInitializer,s=this,o=function(l){var u,h,b,w;return br((u=(h=s.options_)==null?void 0:h.name)!=null?u:n.toString(),l,(b=(w=s.options_)==null?void 0:w.autoAction)!=null?b:!1)};if(t=="field"){i(function(){is(this,n,s)});return}if(t=="method"){var a;return kr(r)||(r=o(r)),(a=this.options_)!=null&&a.bound&&i(function(){var c=this,l=c[n].bind(c);l.isMobxAction=!0,c[n]=l}),r}de("Cannot apply '"+s.annotationType_+"' to '"+String(n)+"' (kind: "+t+"):"+(`
'`+s.annotationType_+"' can only be used on properties with a function value."))}function rS(r,e,t,n){e.annotationType_,n.value}function Kp(r,e,t,n,i){var s,o,a,c,l,u,h;i===void 0&&(i=q.safeDescriptors),rS(r,e,t,n);var b=n.value;if((s=e.options_)!=null&&s.bound){var w;b=b.bind((w=r.proxy_)!=null?w:r.target_)}return{value:br((o=(a=e.options_)==null?void 0:a.name)!=null?o:t.toString(),b,(c=(l=e.options_)==null?void 0:l.autoAction)!=null?c:!1,(u=e.options_)!=null&&u.bound?(h=r.proxy_)!=null?h:r.target_:void 0),configurable:i?r.isPlainObject_:!0,enumerable:!1,writable:!i}}function Lp(r,e){return{annotationType_:r,options_:e,make_:iS,extend_:sS,decorate_20223_:oS}}function iS(r,e,t,n){var i;if(n===r.target_)return this.extend_(r,e,t,!1)===null?0:2;if((i=this.options_)!=null&&i.bound&&(!Hn(r.target_,e)||!Ui(r.target_[e]))&&this.extend_(r,e,t,!1)===null)return 0;if(Ui(t.value))return 1;var s=Np(r,this,e,t,!1,!1);return Ln(n,e,s),2}function sS(r,e,t,n){var i,s=Np(r,this,e,t,(i=this.options_)==null?void 0:i.bound);return r.defineProperty_(e,s,n)}function oS(r,e){var t,n=e.name,i=e.addInitializer;return Ui(r)||(r=Gr(r)),(t=this.options_)!=null&&t.bound&&i(function(){var s=this,o=s[n].bind(s);o.isMobXFlow=!0,s[n]=o}),r}function aS(r,e,t,n){e.annotationType_,n.value}function Np(r,e,t,n,i,s){s===void 0&&(s=q.safeDescriptors),aS(r,e,t,n);var o=n.value;if(Ui(o)||(o=Gr(o)),i){var a;o=o.bind((a=r.proxy_)!=null?a:r.target_),o.isMobXFlow=!0}return{value:o,configurable:s?r.isPlainObject_:!0,enumerable:!1,writable:!s}}function Ol(r,e){return{annotationType_:r,options_:e,make_:cS,extend_:uS,decorate_20223_:lS}}function cS(r,e,t){return this.extend_(r,e,t,!1)===null?0:1}function uS(r,e,t,n){return dS(r,this,e,t),r.defineComputedProperty_(e,mr({},this.options_,{get:t.get,set:t.set}),n)}function lS(r,e){var t=this,n=e.name,i=e.addInitializer;return i(function(){var s=ii(this)[ne],o=mr({},t.options_,{get:r,context:this});o.name||(o.name="ObservableObject."+n.toString()),s.values_.set(n,new zi(o))}),function(){return this[ne].getObservablePropValue_(n)}}function dS(r,e,t,n){e.annotationType_,n.get}function Ja(r,e){return{annotationType_:r,options_:e,make_:fS,extend_:hS,decorate_20223_:pS}}function fS(r,e,t){return this.extend_(r,e,t,!1)===null?0:1}function hS(r,e,t,n){var i,s;return yS(r,this),r.defineObservableProperty_(e,t.value,(i=(s=this.options_)==null?void 0:s.enhancer)!=null?i:Wr,n)}function pS(r,e){var t=this,n=e.kind,i=e.name,s=new WeakSet;function o(a,c){var l,u,h=ii(a)[ne],b=new hr(c,(l=(u=t.options_)==null?void 0:u.enhancer)!=null?l:Wr,"ObservableObject."+i.toString(),!1);h.values_.set(i,b),s.add(a)}if(n=="accessor")return{get:function(){return s.has(this)||o(this,r.get.call(this)),this[ne].getObservablePropValue_(i)},set:function(c){return s.has(this)||o(this,c),this[ne].setObservablePropValue_(i,c)},init:function(c){return s.has(this)||o(this,c),c}}}function yS(r,e,t,n){e.annotationType_}var gS="true",mS=Dp();function Dp(r){return{annotationType_:gS,options_:r,make_:bS,extend_:vS,decorate_20223_:wS}}function bS(r,e,t,n){var i,s;if(t.get)return hn.make_(r,e,t,n);if(t.set){var o=br(e.toString(),t.set);return n===r.target_?r.defineProperty_(e,{configurable:q.safeDescriptors?r.isPlainObject_:!0,set:o})===null?0:2:(Ln(n,e,{configurable:!0,set:o}),2)}if(n!==r.target_&&typeof t.value=="function"){var a;if(Tp(t.value)){var c,l=(c=this.options_)!=null&&c.autoBind?Gr.bound:Gr;return l.make_(r,e,t,n)}var u=(a=this.options_)!=null&&a.autoBind?Fi.bound:Fi;return u.make_(r,e,t,n)}var h=((i=this.options_)==null?void 0:i.deep)===!1?je.ref:je;if(typeof t.value=="function"&&(s=this.options_)!=null&&s.autoBind){var b;t.value=t.value.bind((b=r.proxy_)!=null?b:r.target_)}return h.make_(r,e,t,n)}function vS(r,e,t,n){var i,s;if(t.get)return hn.extend_(r,e,t,n);if(t.set)return r.defineProperty_(e,{configurable:q.safeDescriptors?r.isPlainObject_:!0,set:br(e.toString(),t.set)},n);if(typeof t.value=="function"&&(i=this.options_)!=null&&i.autoBind){var o;t.value=t.value.bind((o=r.proxy_)!=null?o:r.target_)}var a=((s=this.options_)==null?void 0:s.deep)===!1?je.ref:je;return a.extend_(r,e,t,n)}function wS(r,e){de("'"+this.annotationType_+"' cannot be used as a decorator")}var _S="observable",AS="observable.ref",SS="observable.shallow",kS="observable.struct",Vp={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(Vp);function _o(r){return r||Vp}var Iu=Ja(_S),IS=Ja(AS,{enhancer:Qa}),ES=Ja(SS,{enhancer:GA}),OS=Ja(kS,{enhancer:HA}),zp=vn(Iu);function Ao(r){return r.deep===!0?Wr:r.deep===!1?Qa:TS(r.defaultDecorator)}function PS(r){var e;return r?(e=r.defaultDecorator)!=null?e:Dp(r):void 0}function TS(r){var e,t;return r&&(e=(t=r.options_)==null?void 0:t.enhancer)!=null?e:Wr}function Fp(r,e,t){if(no(e))return Iu.decorate_20223_(r,e);if(Ur(e)){is(r,e,Iu);return}return rc(r)?r:Jn(r)?je.object(r,e,t):Array.isArray(r)?je.array(r,e):rs(r)?je.map(r,e):to(r)?je.set(r,e):typeof r=="object"&&r!==null?r:je.box(r,e)}Ep(Fp,zp);var BS={box:function(e,t){var n=_o(t);return new hr(e,Ao(n),n.name,!0,n.equals)},array:function(e,t){var n=_o(t);return(q.useProxies===!1||n.proxy===!1?Fk:Rk)(e,Ao(n),n.name)},map:function(e,t){var n=_o(t);return new ic(e,Ao(n),n.name)},set:function(e,t){var n=_o(t);return new xl(e,Ao(n),n.name)},object:function(e,t,n){return Er(function(){return tc(q.useProxies===!1||(n==null?void 0:n.proxy)===!1?ii({},n):Ok({},n),e,t)})},ref:vn(IS),shallow:vn(ES),deep:zp,struct:vn(OS)},je=Ep(Fp,BS),Up="computed",RS="computed.struct",Eu=Ol(Up),xS=Ol(RS,{equals:$r.structural}),hn=function(e,t){if(no(t))return Eu.decorate_20223_(e,t);if(Ur(t))return is(e,t,Eu);if(Jn(e))return vn(Ol(Up,e));var n=Jn(t)?t:{};return n.get=e,n.name||(n.name=e.name||""),new zi(n)};Object.assign(hn,Eu);hn.struct=vn(xS);var zd,Fd,ra=0,MS=1,CS=(zd=(Fd=na(function(){},"name"))==null?void 0:Fd.configurable)!=null?zd:!1,Ud={value:"action",configurable:!0,writable:!1,enumerable:!1};function br(r,e,t,n){t===void 0&&(t=!1);function i(){return $p(r,t,e,n||this,arguments)}return i.isMobxAction=!0,CS&&(Ud.value=r,Ln(i,"name",Ud)),i}function $p(r,e,t,n,i){var s=Wp(r,e);try{return t.apply(n,i)}catch(o){throw s.error_=o,o}finally{jp(s)}}function Wp(r,e,t,n){var i=!1,s=0,o=q.trackingDerivation,a=!e||!o;Ut();var c=q.allowStateChanges;a&&(ri(),c=Xa(!0));var l=ec(!0),u={runAsAction_:a,prevDerivation_:o,prevAllowStateChanges_:c,prevAllowStateReads_:l,notifySpy_:i,startTime_:s,actionId_:MS++,parentActionId_:ra};return ra=u.actionId_,u}function jp(r){ra!==r.actionId_&&de(30),ra=r.parentActionId_,r.error_!==void 0&&(q.suppressReactionErrors=!0),Za(r.prevAllowStateChanges_),Ti(r.prevAllowStateReads_),$t(),r.runAsAction_&&Yn(r.prevDerivation_),q.suppressReactionErrors=!1}function Vi(r,e){var t=Xa(r);try{return e()}finally{Za(t)}}function Xa(r){var e=q.allowStateChanges;return q.allowStateChanges=r,e}function Za(r){q.allowStateChanges=r}var qp;qp=Symbol.toPrimitive;var hr=function(r){Mp(e,r);function e(n,i,s,o,a){var c;return s===void 0&&(s="ObservableValue"),a===void 0&&(a=$r.default),c=r.call(this,s)||this,c.enhancer=void 0,c.name_=void 0,c.equals=void 0,c.hasUnreportedChange_=!1,c.interceptors_=void 0,c.changeListeners_=void 0,c.value_=void 0,c.dehancer=void 0,c.enhancer=i,c.name_=s,c.equals=a,c.value_=i(n,void 0,s),c}var t=e.prototype;return t.dehanceValue=function(i){return this.dehancer!==void 0?this.dehancer(i):i},t.set=function(i){this.value_,i=this.prepareNewValue_(i),i!==q.UNCHANGED&&this.setNewValue_(i)},t.prepareNewValue_=function(i){if(dn(this)){var s=fn(this,{object:this,type:Nn,newValue:i});if(!s)return q.UNCHANGED;i=s.newValue}return i=this.enhancer(i,this.value_,this.name_),this.equals(this.value_,i)?q.UNCHANGED:i},t.setNewValue_=function(i){var s=this.value_;this.value_=i,this.reportChanged(),wn(this)&&_n(this,{type:Nn,object:this,newValue:i,oldValue:s})},t.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},t.intercept_=function(i){return ao(this,i)},t.observe_=function(i,s){return s&&i({observableKind:"value",debugObjectName:this.name_,object:this,type:Nn,newValue:this.value_,oldValue:void 0}),co(this,i)},t.raw=function(){return this.value_},t.toJSON=function(){return this.get()},t.toString=function(){return this.name_+"["+this.value_+"]"},t.valueOf=function(){return xp(this.get())},t[qp]=function(){return this.valueOf()},e}(ro),Pl=Sr("ObservableValue",hr),Gp;Gp=Symbol.toPrimitive;var zi=function(){function r(t){this.dependenciesState_=Ee.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.isBeingObserved_=!1,this.isPendingUnobservation_=!1,this.observers_=new Set,this.diffValue_=0,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=Ee.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new sa(null),this.name_=void 0,this.triggeredBy_=void 0,this.isComputing_=!1,this.isRunningSetter_=!1,this.derivation=void 0,this.setter_=void 0,this.isTracing_=ia.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,t.get||de(31),this.derivation=t.get,this.name_=t.name||"ComputedValue",t.set&&(this.setter_=br("ComputedValue-setter",t.set)),this.equals_=t.equals||(t.compareStructural||t.struct?$r.structural:$r.default),this.scope_=t.context,this.requiresReaction_=t.requiresReaction,this.keepAlive_=!!t.keepAlive}var e=r.prototype;return e.onBecomeStale_=function(){$S(this)},e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.get=function(){if(this.isComputing_&&de(32,this.name_,this.derivation),q.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)Ou(this)&&(this.warnAboutUntrackedRead_(),Ut(),this.value_=this.computeValue_(!1),$t());else if(ey(this),Ou(this)){var n=q.trackingContext;this.keepAlive_&&!n&&(q.trackingContext=this),this.trackAndCompute()&&US(this),q.trackingContext=n}var i=this.value_;if(Uo(i))throw i.cause;return i},e.set=function(n){if(this.setter_){this.isRunningSetter_&&de(33,this.name_),this.isRunningSetter_=!0;try{this.setter_.call(this.scope_,n)}finally{this.isRunningSetter_=!1}}else de(34,this.name_)},e.trackAndCompute=function(){var n=this.value_,i=this.dependenciesState_===Ee.NOT_TRACKING_,s=this.computeValue_(!0),o=i||Uo(n)||Uo(s)||!this.equals_(n,s);return o&&(this.value_=s),o},e.computeValue_=function(n){this.isComputing_=!0;var i=Xa(!1),s;if(n)s=Hp(this,this.derivation,this.scope_);else if(q.disableErrorBoundaries===!0)s=this.derivation.call(this.scope_);else try{s=this.derivation.call(this.scope_)}catch(o){s=new sa(o)}return Za(i),this.isComputing_=!1,s},e.suspend_=function(){this.keepAlive_||(Pu(this),this.value_=void 0)},e.observe_=function(n,i){var s=this,o=!0,a=void 0;return qr(function(){var c=s.get();if(!o||i){var l=ri();n({observableKind:"computed",debugObjectName:s.name_,type:Nn,object:s,newValue:c,oldValue:a}),Yn(l)}o=!1,a=c})},e.warnAboutUntrackedRead_=function(){},e.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},e.valueOf=function(){return xp(this.get())},e[Gp]=function(){return this.valueOf()},r}(),jr=Sr("ComputedValue",zi),Ee;(function(r){r[r.NOT_TRACKING_=-1]="NOT_TRACKING_",r[r.UP_TO_DATE_=0]="UP_TO_DATE_",r[r.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",r[r.STALE_=2]="STALE_"})(Ee||(Ee={}));var ia;(function(r){r[r.NONE=0]="NONE",r[r.LOG=1]="LOG",r[r.BREAK=2]="BREAK"})(ia||(ia={}));var sa=function(e){this.cause=void 0,this.cause=e};function Uo(r){return r instanceof sa}function Ou(r){switch(r.dependenciesState_){case Ee.UP_TO_DATE_:return!1;case Ee.NOT_TRACKING_:case Ee.STALE_:return!0;case Ee.POSSIBLY_STALE_:{for(var e=ec(!0),t=ri(),n=r.observing_,i=n.length,s=0;s<i;s++){var o=n[s];if(jr(o)){if(q.disableErrorBoundaries)o.get();else try{o.get()}catch{return Yn(t),Ti(e),!0}if(r.dependenciesState_===Ee.STALE_)return Yn(t),Ti(e),!0}}return Yp(r),Yn(t),Ti(e),!1}}}function so(){return q.trackingDerivation!==null}function Hp(r,e,t){var n=ec(!0);Yp(r),r.newObserving_=new Array(r.observing_.length+100),r.unboundDepsCount_=0,r.runId_=++q.runId;var i=q.trackingDerivation;q.trackingDerivation=r,q.inBatch++;var s;if(q.disableErrorBoundaries===!0)s=e.call(t);else try{s=e.call(t)}catch(o){s=new sa(o)}return q.inBatch--,q.trackingDerivation=i,KS(r),Ti(n),s}function KS(r){for(var e=r.observing_,t=r.observing_=r.newObserving_,n=Ee.UP_TO_DATE_,i=0,s=r.unboundDepsCount_,o=0;o<s;o++){var a=t[o];a.diffValue_===0&&(a.diffValue_=1,i!==o&&(t[i]=a),i++),a.dependenciesState_>n&&(n=a.dependenciesState_)}for(t.length=i,r.newObserving_=null,s=e.length;s--;){var c=e[s];c.diffValue_===0&&Xp(c,r),c.diffValue_=0}for(;i--;){var l=t[i];l.diffValue_===1&&(l.diffValue_=0,FS(l,r))}n!==Ee.UP_TO_DATE_&&(r.dependenciesState_=n,r.onBecomeStale_())}function Pu(r){var e=r.observing_;r.observing_=[];for(var t=e.length;t--;)Xp(e[t],r);r.dependenciesState_=Ee.NOT_TRACKING_}function Tl(r){var e=ri();try{return r()}finally{Yn(e)}}function ri(){var r=q.trackingDerivation;return q.trackingDerivation=null,r}function Yn(r){q.trackingDerivation=r}function ec(r){var e=q.allowStateReads;return q.allowStateReads=r,e}function Ti(r){q.allowStateReads=r}function Yp(r){if(r.dependenciesState_!==Ee.UP_TO_DATE_){r.dependenciesState_=Ee.UP_TO_DATE_;for(var e=r.observing_,t=e.length;t--;)e[t].lowestObserverState_=Ee.UP_TO_DATE_}}var LS=["mobxGuid","spyListeners","enforceActions","computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","allowStateReads","disableErrorBoundaries","runId","UNCHANGED","useProxies"],Es=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.batchId=Number.MIN_SAFE_INTEGER,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0,this.stateVersion=Number.MIN_SAFE_INTEGER},$o=!0,Qp=!1,q=function(){var r=Sl();return r.__mobxInstanceCount>0&&!r.__mobxGlobals&&($o=!1),r.__mobxGlobals&&r.__mobxGlobals.version!==new Es().version&&($o=!1),$o?r.__mobxGlobals?(r.__mobxInstanceCount+=1,r.__mobxGlobals.UNCHANGED||(r.__mobxGlobals.UNCHANGED={}),r.__mobxGlobals):(r.__mobxInstanceCount=1,r.__mobxGlobals=new Es):(setTimeout(function(){Qp||de(35)},1),new Es)}();function NS(){if((q.pendingReactions.length||q.inBatch||q.isRunningReactions)&&de(36),Qp=!0,$o){var r=Sl();--r.__mobxInstanceCount===0&&(r.__mobxGlobals=void 0),q=new Es}}function Jp(){return q}function DS(){var r=new Es;for(var e in r)LS.indexOf(e)===-1&&(q[e]=r[e]);q.allowStateChanges=!q.enforceActions}function VS(r){return r.observers_&&r.observers_.size>0}function zS(r){return r.observers_}function FS(r,e){r.observers_.add(e),r.lowestObserverState_>e.dependenciesState_&&(r.lowestObserverState_=e.dependenciesState_)}function Xp(r,e){r.observers_.delete(e),r.observers_.size===0&&Zp(r)}function Zp(r){r.isPendingUnobservation_===!1&&(r.isPendingUnobservation_=!0,q.pendingUnobservations.push(r))}function Ut(){q.inBatch===0&&(q.batchId=q.batchId<Number.MAX_SAFE_INTEGER?q.batchId+1:Number.MIN_SAFE_INTEGER),q.inBatch++}function $t(){if(--q.inBatch===0){ny();for(var r=q.pendingUnobservations,e=0;e<r.length;e++){var t=r[e];t.isPendingUnobservation_=!1,t.observers_.size===0&&(t.isBeingObserved_&&(t.isBeingObserved_=!1,t.onBUO()),t instanceof zi&&t.suspend_())}q.pendingUnobservations=[]}}function ey(r){var e=q.trackingDerivation;return e!==null?(e.runId_!==r.lastAccessedBy_&&(r.lastAccessedBy_=e.runId_,e.newObserving_[e.unboundDepsCount_++]=r,!r.isBeingObserved_&&q.trackingContext&&(r.isBeingObserved_=!0,r.onBO())),r.isBeingObserved_):(r.observers_.size===0&&q.inBatch>0&&Zp(r),!1)}function ty(r){r.lowestObserverState_!==Ee.STALE_&&(r.lowestObserverState_=Ee.STALE_,r.observers_.forEach(function(e){e.dependenciesState_===Ee.UP_TO_DATE_&&e.onBecomeStale_(),e.dependenciesState_=Ee.STALE_}))}function US(r){r.lowestObserverState_!==Ee.STALE_&&(r.lowestObserverState_=Ee.STALE_,r.observers_.forEach(function(e){e.dependenciesState_===Ee.POSSIBLY_STALE_?e.dependenciesState_=Ee.STALE_:e.dependenciesState_===Ee.UP_TO_DATE_&&(r.lowestObserverState_=Ee.UP_TO_DATE_)}))}function $S(r){r.lowestObserverState_===Ee.UP_TO_DATE_&&(r.lowestObserverState_=Ee.POSSIBLY_STALE_,r.observers_.forEach(function(e){e.dependenciesState_===Ee.UP_TO_DATE_&&(e.dependenciesState_=Ee.POSSIBLY_STALE_,e.onBecomeStale_())}))}var Ds=function(){function r(t,n,i,s){t===void 0&&(t="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=Ee.NOT_TRACKING_,this.diffValue_=0,this.runId_=0,this.unboundDepsCount_=0,this.isDisposed_=!1,this.isScheduled_=!1,this.isTrackPending_=!1,this.isRunning_=!1,this.isTracing_=ia.NONE,this.name_=t,this.onInvalidate_=n,this.errorHandler_=i,this.requiresObservable_=s}var e=r.prototype;return e.onBecomeStale_=function(){this.schedule_()},e.schedule_=function(){this.isScheduled_||(this.isScheduled_=!0,q.pendingReactions.push(this),ny())},e.isScheduled=function(){return this.isScheduled_},e.runReaction_=function(){if(!this.isDisposed_){Ut(),this.isScheduled_=!1;var n=q.trackingContext;if(q.trackingContext=this,Ou(this)){this.isTrackPending_=!0;try{this.onInvalidate_()}catch(i){this.reportExceptionInDerivation_(i)}}q.trackingContext=n,$t()}},e.track=function(n){if(!this.isDisposed_){Ut(),this.isRunning_=!0;var i=q.trackingContext;q.trackingContext=this;var s=Hp(this,n,void 0);q.trackingContext=i,this.isRunning_=!1,this.isTrackPending_=!1,this.isDisposed_&&Pu(this),Uo(s)&&this.reportExceptionInDerivation_(s.cause),$t()}},e.reportExceptionInDerivation_=function(n){var i=this;if(this.errorHandler_){this.errorHandler_(n,this);return}if(q.disableErrorBoundaries)throw n;var s="[mobx] uncaught error in '"+this+"'";q.suppressReactionErrors||console.error(s,n),q.globalReactionErrorHandlers.forEach(function(o){return o(n,i)})},e.dispose=function(){this.isDisposed_||(this.isDisposed_=!0,this.isRunning_||(Ut(),Pu(this),$t()))},e.getDisposer_=function(n){var i=this,s=function o(){i.dispose(),n==null||n.removeEventListener==null||n.removeEventListener("abort",o)};return n==null||n.addEventListener==null||n.addEventListener("abort",s),s[ne]=this,s},e.toString=function(){return"Reaction["+this.name_+"]"},e.trace=function(n){},r}();function WS(r){return q.globalReactionErrorHandlers.push(r),function(){var e=q.globalReactionErrorHandlers.indexOf(r);e>=0&&q.globalReactionErrorHandlers.splice(e,1)}}var jS=100,Tu=function(e){return e()};function ny(){q.inBatch>0||q.isRunningReactions||Tu(qS)}function qS(){q.isRunningReactions=!0;for(var r=q.pendingReactions,e=0;r.length>0;){++e===jS&&(console.error("[mobx] cycle in reaction: "+r[0]),r.splice(0));for(var t=r.splice(0),n=0,i=t.length;n<i;n++)t[n].runReaction_()}q.isRunningReactions=!1}var oa=Sr("Reaction",Ds);function GS(r){var e=Tu;Tu=function(n){return r(function(){return e(n)})}}function Os(){return!1}function ry(r){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var iy="action",HS="action.bound",sy="autoAction",YS="autoAction.bound",oy="<unnamed action>",Bu=io(iy),QS=io(HS,{bound:!0}),Ru=io(sy,{autoAction:!0}),JS=io(YS,{autoAction:!0,bound:!0});function ay(r){var e=function(n,i){if(rn(n))return br(n.name||oy,n,r);if(rn(i))return br(n,i,r);if(no(i))return(r?Ru:Bu).decorate_20223_(n,i);if(Ur(i))return is(n,i,r?Ru:Bu);if(Ur(n))return vn(io(r?sy:iy,{name:n,autoAction:r}))};return e}var tt=ay(!1);Object.assign(tt,Bu);var Fi=ay(!0);Object.assign(Fi,Ru);tt.bound=vn(QS);Fi.bound=vn(JS);function Vs(r){return $p(r.name||oy,!1,r,this,void 0)}function kr(r){return rn(r)&&r.isMobxAction===!0}function qr(r,e){var t,n,i,s,o;e===void 0&&(e=kl);var a=(t=(n=e)==null?void 0:n.name)!=null?t:"Autorun",c=!e.scheduler&&!e.delay,l;if(c)l=new Ds(a,function(){this.track(b)},e.onError,e.requiresObservable);else{var u=cy(e),h=!1;l=new Ds(a,function(){h||(h=!0,u(function(){h=!1,l.isDisposed_||l.track(b)}))},e.onError,e.requiresObservable)}function b(){r(l)}return(i=e)!=null&&(s=i.signal)!=null&&s.aborted||l.schedule_(),l.getDisposer_((o=e)==null?void 0:o.signal)}var XS=function(e){return e()};function cy(r){return r.scheduler?r.scheduler:r.delay?function(e){return setTimeout(e,r.delay)}:XS}function uy(r,e,t){var n,i,s,o;t===void 0&&(t=kl);var a=(n=t.name)!=null?n:"Reaction",c=tt(a,t.onError?ZS(t.onError,e):e),l=!t.scheduler&&!t.delay,u=cy(t),h=!0,b=!1,w,k,g=t.compareStructural?$r.structural:t.equals||$r.default,_=new Ds(a,function(){h||l?I():b||(b=!0,u(I))},t.onError,t.requiresObservable);function I(){if(b=!1,!_.isDisposed_){var L=!1;_.track(function(){var G=Vi(!1,function(){return r(_)});L=h||!g(w,G),k=w,w=G}),(h&&t.fireImmediately||!h&&L)&&c(w,k,_),h=!1}}return(i=t)!=null&&(s=i.signal)!=null&&s.aborted||_.schedule_(),_.getDisposer_((o=t)==null?void 0:o.signal)}function ZS(r,e){return function(){try{return e.apply(this,arguments)}catch(t){r.call(this,t)}}}var ek="onBO",tk="onBUO";function ly(r,e,t){return dy(ek,r,e,t)}function oo(r,e,t){return dy(tk,r,e,t)}function dy(r,e,t,n){var i=typeof n=="function"?Dn(e,t):Dn(e),s=rn(n)?n:t,o=r+"L";return i[o]?i[o].add(s):i[o]=new Set([s]),function(){var a=i[o];a&&(a.delete(s),a.size===0&&delete i[o])}}var nk="never",So="always",rk="observed";function ik(r){r.isolateGlobalState===!0&&NS();var e=r.useProxies,t=r.enforceActions;if(e!==void 0&&(q.useProxies=e===So?!0:e===nk?!1:typeof Proxy<"u"),e==="ifavailable"&&(q.verifyProxies=!0),t!==void 0){var n=t===So?So:t===rk;q.enforceActions=n,q.allowStateChanges=!(n===!0||n===So)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(i){i in r&&(q[i]=!!r[i])}),q.allowStateReads=!q.observableRequiresReaction,r.reactionScheduler&&GS(r.reactionScheduler)}function tc(r,e,t,n){var i=DA(e);return Er(function(){var s=ii(r,n)[ne];Di(i).forEach(function(o){s.extend_(o,i[o],t&&o in t?t[o]:!0)})}),r}function sk(r,e){return fy(Dn(r,e))}function fy(r){var e={name:r.name_};return r.observing_&&r.observing_.length>0&&(e.dependencies=ak(r.observing_).map(fy)),e}function ok(r,e){return hy(Dn(r,e))}function hy(r){var e={name:r.name_};return VS(r)&&(e.observers=Array.from(zS(r)).map(hy)),e}function ak(r){return Array.from(new Set(r))}var ck=0;function nc(){this.message="FLOW_CANCELLED"}nc.prototype=Object.create(Error.prototype);function uk(r){return r instanceof nc}var jc=Lp("flow"),lk=Lp("flow.bound",{bound:!0}),Gr=Object.assign(function(e,t){if(no(t))return jc.decorate_20223_(e,t);if(Ur(t))return is(e,t,jc);var n=e,i=n.name||"<unnamed flow>",s=function(){var a=this,c=arguments,l=++ck,u=tt(i+" - runid: "+l+" - init",n).apply(a,c),h,b=void 0,w=new Promise(function(k,g){var _=0;h=g;function I($){b=void 0;var Q;try{Q=tt(i+" - runid: "+l+" - yield "+_++,u.next).call(u,$)}catch(v){return g(v)}G(Q)}function L($){b=void 0;var Q;try{Q=tt(i+" - runid: "+l+" - yield "+_++,u.throw).call(u,$)}catch(v){return g(v)}G(Q)}function G($){if(rn($==null?void 0:$.then)){$.then(G,g);return}return $.done?k($.value):(b=Promise.resolve($.value),b.then(I,L))}I(void 0)});return w.cancel=tt(i+" - runid: "+l+" - cancel",function(){try{b&&$d(b);var k=u.return(void 0),g=Promise.resolve(k.value);g.then(_i,_i),$d(g),h(new nc)}catch(_){h(_)}}),w};return s.isMobXFlow=!0,s},jc);Gr.bound=vn(lk);function $d(r){rn(r.cancel)&&r.cancel()}function dk(r){return r}function Ui(r){return(r==null?void 0:r.isMobXFlow)===!0}function fk(r,e,t){var n;return pt(r)||bt(r)||Pl(r)?n=Vn(r):ft(r)&&(n=Vn(r,e)),n.dehancer=typeof e=="function"?e:t,function(){n.dehancer=void 0}}function hk(r,e,t){return rn(t)?yk(r,e,t):pk(r,e)}function pk(r,e){return Vn(r).intercept_(e)}function yk(r,e,t){return Vn(r,e).intercept_(t)}function py(r,e){if(e===void 0)return jr(r);if(ft(r)===!1||!r[ne].values_.has(e))return!1;var t=Dn(r,e);return jr(t)}function yy(r){return py(r)}function Wo(r,e){return py(r,e)}function gy(r,e){return r?e!==void 0?ft(r)?r[ne].values_.has(e):!1:ft(r)||!!r[ne]||El(r)||oa(r)||jr(r):!1}function rc(r){return gy(r)}function gk(r,e){return gy(r,e)}function $i(r){if(ft(r))return r[ne].keys_();if(pt(r)||Nt(r))return Array.from(r.keys());if(bt(r))return r.map(function(e,t){return t});de(5)}function my(r){if(ft(r))return $i(r).map(function(e){return r[e]});if(pt(r))return $i(r).map(function(e){return r.get(e)});if(Nt(r))return Array.from(r.values());if(bt(r))return r.slice();de(6)}function by(r){if(ft(r))return $i(r).map(function(e){return[e,r[e]]});if(pt(r))return $i(r).map(function(e){return[e,r.get(e)]});if(Nt(r))return Array.from(r.entries());if(bt(r))return r.map(function(e,t){return[t,e]});de(7)}function vy(r,e,t){if(arguments.length===2&&!Nt(r)){Ut();var n=e;try{for(var i in n)vy(r,i,n[i])}finally{$t()}return}ft(r)?r[ne].set_(e,t):pt(r)?r.set(e,t):Nt(r)?r.add(e):bt(r)?(typeof e!="number"&&(e=parseInt(e,10)),e<0&&de("Invalid index: '"+e+"'"),Ut(),e>=r.length&&(r.length=e+1),r[e]=t,$t()):de(8)}function mk(r,e){ft(r)?r[ne].delete_(e):pt(r)||Nt(r)?r.delete(e):bt(r)?(typeof e!="number"&&(e=parseInt(e,10)),r.splice(e,1)):de(9)}function wy(r,e){if(ft(r))return r[ne].has_(e);if(pt(r))return r.has(e);if(Nt(r))return r.has(e);if(bt(r))return e>=0&&e<r.length;de(10)}function bk(r,e){if(!!wy(r,e)){if(ft(r))return r[ne].get_(e);if(pt(r))return r.get(e);if(bt(r))return r[e];de(11)}}function vk(r,e,t){if(ft(r))return r[ne].defineProperty_(e,t);de(39)}function _y(r){if(ft(r))return r[ne].ownKeys_();de(38)}function Wi(r,e,t,n){return rn(t)?_k(r,e,t,n):wk(r,e,t)}function wk(r,e,t){return Vn(r).observe_(e,t)}function _k(r,e,t,n){return Vn(r,e).observe_(t,n)}function ko(r,e,t){return r.set(e,t),t}function yi(r,e){if(r==null||typeof r!="object"||r instanceof Date||!rc(r))return r;if(Pl(r)||jr(r))return yi(r.get(),e);if(e.has(r))return e.get(r);if(bt(r)){var t=ko(e,r,new Array(r.length));return r.forEach(function(o,a){t[a]=yi(o,e)}),t}if(Nt(r)){var n=ko(e,r,new Set);return r.forEach(function(o){n.add(yi(o,e))}),n}if(pt(r)){var i=ko(e,r,new Map);return r.forEach(function(o,a){i.set(a,yi(o,e))}),i}else{var s=ko(e,r,{});return _y(r).forEach(function(o){Zs.propertyIsEnumerable.call(r,o)&&(s[o]=yi(r[o],e))}),s}}function Ak(r,e){return yi(r,new Map)}function Sk(){}function ln(r,e){e===void 0&&(e=void 0),Ut();try{return r.apply(e)}finally{$t()}}function kk(r,e,t){return arguments.length===1||e&&typeof e=="object"?Ik(r,e):Ay(r,e,t||{})}function Ay(r,e,t){var n;if(typeof t.timeout=="number"){var i=new Error("WHEN_TIMEOUT");n=setTimeout(function(){if(!o[ne].isDisposed_)if(o(),t.onError)t.onError(i);else throw i},t.timeout)}t.name="When";var s=br("When-effect",e),o=qr(function(a){var c=Vi(!1,r);c&&(a.dispose(),n&&clearTimeout(n),s())},t);return o}function Ik(r,e){var t;if(e!=null&&(t=e.signal)!=null&&t.aborted)return Object.assign(Promise.reject(new Error("WHEN_ABORTED")),{cancel:function(){return null}});var n,i,s=new Promise(function(o,a){var c,l=Ay(r,o,mr({},e,{onError:a}));n=function(){l(),a(new Error("WHEN_CANCELLED"))},i=function(){l(),a(new Error("WHEN_ABORTED"))},e==null||(c=e.signal)==null||c.addEventListener==null||c.addEventListener("abort",i)}).finally(function(){var o;return e==null||(o=e.signal)==null||o.removeEventListener==null?void 0:o.removeEventListener("abort",i)});return s.cancel=n,s}function ui(r){return r[ne]}var Ek={has:function(e,t){return ui(e).has_(t)},get:function(e,t){return ui(e).get_(t)},set:function(e,t,n){var i;return Ur(t)?(i=ui(e).set_(t,n,!0))!=null?i:!0:!1},deleteProperty:function(e,t){var n;return Ur(t)?(n=ui(e).delete_(t,!0))!=null?n:!0:!1},defineProperty:function(e,t,n){var i;return(i=ui(e).defineProperty_(t,n))!=null?i:!0},ownKeys:function(e){return ui(e).ownKeys_()},preventExtensions:function(e){de(13)}};function Ok(r,e){var t,n;return Op(),r=ii(r,e),(n=(t=r[ne]).proxy_)!=null?n:t.proxy_=new Proxy(r,Ek)}function dn(r){return r.interceptors_!==void 0&&r.interceptors_.length>0}function ao(r,e){var t=r.interceptors_||(r.interceptors_=[]);return t.push(e),Pp(function(){var n=t.indexOf(e);n!==-1&&t.splice(n,1)})}function fn(r,e){var t=ri();try{for(var n=[].concat(r.interceptors_||[]),i=0,s=n.length;i<s&&(e=n[i](e),e&&!e.type&&de(14),!!e);i++);return e}finally{Yn(t)}}function wn(r){return r.changeListeners_!==void 0&&r.changeListeners_.length>0}function co(r,e){var t=r.changeListeners_||(r.changeListeners_=[]);return t.push(e),Pp(function(){var n=t.indexOf(e);n!==-1&&t.splice(n,1)})}function _n(r,e){var t=ri(),n=r.changeListeners_;if(!!n){n=n.slice();for(var i=0,s=n.length;i<s;i++)n[i](e);Yn(t)}}function Bl(r,e,t){return Er(function(){var n,i=ii(r,t)[ne];(n=e)!=null||(e=UA(r)),Di(e).forEach(function(s){return i.make_(s,e[s])})}),r}var qc=Symbol("mobx-keys");function Pk(r,e,t){return Jn(r)?tc(r,r,e,t):(Er(function(){var n=ii(r,t)[ne];if(!r[qc]){var i=Object.getPrototypeOf(r),s=new Set([].concat(Di(r),Di(i)));s.delete("constructor"),s.delete(ne),eo(i,qc,s)}r[qc].forEach(function(o){return n.make_(o,e&&o in e?e[o]:!0)})}),r)}var Wd="splice",Nn="update",Tk=1e4,Bk={get:function(e,t){var n=e[ne];return t===ne?n:t==="length"?n.getArrayLength_():typeof t=="string"&&!isNaN(t)?n.get_(parseInt(t)):Hn(aa,t)?aa[t]:e[t]},set:function(e,t,n){var i=e[ne];return t==="length"&&i.setArrayLength_(n),typeof t=="symbol"||isNaN(t)?e[t]=n:i.set_(parseInt(t),n),!0},preventExtensions:function(){de(15)}},Rl=function(){function r(t,n,i,s){t===void 0&&(t="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=i,this.legacyMode_=s,this.atom_=new ro(t),this.enhancer_=function(o,a){return n(o,a,"ObservableArray[..]")}}var e=r.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.dehanceValues_=function(n){return this.dehancer!==void 0&&n.length>0?n.map(this.dehancer):n},e.intercept_=function(n){return ao(this,n)},e.observe_=function(n,i){return i===void 0&&(i=!1),i&&n({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),co(this,n)},e.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},e.setArrayLength_=function(n){(typeof n!="number"||isNaN(n)||n<0)&&de("Out of range: "+n);var i=this.values_.length;if(n!==i)if(n>i){for(var s=new Array(n-i),o=0;o<n-i;o++)s[o]=void 0;this.spliceWithArray_(i,0,s)}else this.spliceWithArray_(n,i-n)},e.updateArrayLength_=function(n,i){n!==this.lastKnownLength_&&de(16),this.lastKnownLength_+=i,this.legacyMode_&&i>0&&Ry(n+i+1)},e.spliceWithArray_=function(n,i,s){var o=this;this.atom_;var a=this.values_.length;if(n===void 0?n=0:n>a?n=a:n<0&&(n=Math.max(0,a+n)),arguments.length===1?i=a-n:i==null?i=0:i=Math.max(0,Math.min(i,a-n)),s===void 0&&(s=Su),dn(this)){var c=fn(this,{object:this.proxy_,type:Wd,index:n,removedCount:i,added:s});if(!c)return Su;i=c.removedCount,s=c.added}if(s=s.length===0?s:s.map(function(h){return o.enhancer_(h,void 0)}),this.legacyMode_){var l=s.length-i;this.updateArrayLength_(a,l)}var u=this.spliceItemsIntoValues_(n,i,s);return(i!==0||s.length!==0)&&this.notifyArraySplice_(n,s,u),this.dehanceValues_(u)},e.spliceItemsIntoValues_=function(n,i,s){if(s.length<Tk){var o;return(o=this.values_).splice.apply(o,[n,i].concat(s))}else{var a=this.values_.slice(n,n+i),c=this.values_.slice(n+i);this.values_.length+=s.length-i;for(var l=0;l<s.length;l++)this.values_[n+l]=s[l];for(var u=0;u<c.length;u++)this.values_[n+s.length+u]=c[u];return a}},e.notifyArrayChildUpdate_=function(n,i,s){var o=!this.owned_&&Os(),a=wn(this),c=a||o?{observableKind:"array",object:this.proxy_,type:Nn,debugObjectName:this.atom_.name_,index:n,newValue:i,oldValue:s}:null;this.atom_.reportChanged(),a&&_n(this,c)},e.notifyArraySplice_=function(n,i,s){var o=!this.owned_&&Os(),a=wn(this),c=a||o?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:Wd,index:n,removed:s,added:i,removedCount:s.length,addedCount:i.length}:null;this.atom_.reportChanged(),a&&_n(this,c)},e.get_=function(n){if(this.legacyMode_&&n>=this.values_.length){console.warn("[mobx] Out of bounds read: "+n);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[n])},e.set_=function(n,i){var s=this.values_;if(this.legacyMode_&&n>s.length&&de(17,n,s.length),n<s.length){this.atom_;var o=s[n];if(dn(this)){var a=fn(this,{type:Nn,object:this.proxy_,index:n,newValue:i});if(!a)return;i=a.newValue}i=this.enhancer_(i,o);var c=i!==o;c&&(s[n]=i,this.notifyArrayChildUpdate_(n,i,o))}else{for(var l=new Array(n+1-s.length),u=0;u<l.length-1;u++)l[u]=void 0;l[l.length-1]=i,this.spliceWithArray_(s.length,0,l)}},r}();function Rk(r,e,t,n){return t===void 0&&(t="ObservableArray"),n===void 0&&(n=!1),Op(),Er(function(){var i=new Rl(t,e,n,!1);Bp(i.values_,ne,i);var s=new Proxy(i.values_,Bk);return i.proxy_=s,r&&r.length&&i.spliceWithArray_(0,0,r),s})}var aa={clear:function(){return this.splice(0)},replace:function(e){var t=this[ne];return t.spliceWithArray_(0,t.values_.length,e)},toJSON:function(){return this.slice()},splice:function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];var o=this[ne];switch(arguments.length){case 0:return[];case 1:return o.spliceWithArray_(e);case 2:return o.spliceWithArray_(e,t)}return o.spliceWithArray_(e,t,i)},spliceWithArray:function(e,t,n){return this[ne].spliceWithArray_(e,t,n)},push:function(){for(var e=this[ne],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.spliceWithArray_(e.values_.length,0,n),e.values_.length},pop:function(){return this.splice(Math.max(this[ne].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=this[ne],t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return e.spliceWithArray_(0,0,n),e.values_.length},reverse:function(){return q.trackingDerivation&&de(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){q.trackingDerivation&&de(37,"sort");var e=this.slice();return e.sort.apply(e,arguments),this.replace(e),this},remove:function(e){var t=this[ne],n=t.dehanceValues_(t.values_).indexOf(e);return n>-1?(this.splice(n,1),!0):!1}};ht("concat",Zn);ht("flat",Zn);ht("includes",Zn);ht("indexOf",Zn);ht("join",Zn);ht("lastIndexOf",Zn);ht("slice",Zn);ht("toString",Zn);ht("toLocaleString",Zn);ht("every",Ir);ht("filter",Ir);ht("find",Ir);ht("findIndex",Ir);ht("flatMap",Ir);ht("forEach",Ir);ht("map",Ir);ht("some",Ir);ht("reduce",Sy);ht("reduceRight",Sy);function ht(r,e){typeof Array.prototype[r]=="function"&&(aa[r]=e(r))}function Zn(r){return function(){var e=this[ne];e.atom_.reportObserved();var t=e.dehanceValues_(e.values_);return t[r].apply(t,arguments)}}function Ir(r){return function(e,t){var n=this,i=this[ne];i.atom_.reportObserved();var s=i.dehanceValues_(i.values_);return s[r](function(o,a){return e.call(t,o,a,n)})}}function Sy(r){return function(){var e=this,t=this[ne];t.atom_.reportObserved();var n=t.dehanceValues_(t.values_),i=arguments[0];return arguments[0]=function(s,o,a){return i(s,o,a,e)},n[r].apply(n,arguments)}}var xk=Sr("ObservableArrayAdministration",Rl);function bt(r){return Ha(r)&&xk(r[ne])}var ky,Iy,Mk={},ur="add",ca="delete";ky=Symbol.iterator;Iy=Symbol.toStringTag;var ic=function(){function r(t,n,i){var s=this;n===void 0&&(n=Wr),i===void 0&&(i="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[ne]=Mk,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=n,this.name_=i,rn(Map)||de(18),Er(function(){s.keysAtom_=Ya("ObservableMap.keys()"),s.data_=new Map,s.hasMap_=new Map,t&&s.merge(t)})}var e=r.prototype;return e.has_=function(n){return this.data_.has(n)},e.has=function(n){var i=this;if(!q.trackingDerivation)return this.has_(n);var s=this.hasMap_.get(n);if(!s){var o=s=new hr(this.has_(n),Qa,"ObservableMap.key?",!1);this.hasMap_.set(n,o),oo(o,function(){return i.hasMap_.delete(n)})}return s.get()},e.set=function(n,i){var s=this.has_(n);if(dn(this)){var o=fn(this,{type:s?Nn:ur,object:this,newValue:i,name:n});if(!o)return this;i=o.newValue}return s?this.updateValue_(n,i):this.addValue_(n,i),this},e.delete=function(n){var i=this;if(this.keysAtom_,dn(this)){var s=fn(this,{type:ca,object:this,name:n});if(!s)return!1}if(this.has_(n)){var o=Os(),a=wn(this),c=a||o?{observableKind:"map",debugObjectName:this.name_,type:ca,object:this,oldValue:this.data_.get(n).value_,name:n}:null;return ln(function(){var l;i.keysAtom_.reportChanged(),(l=i.hasMap_.get(n))==null||l.setNewValue_(!1);var u=i.data_.get(n);u.setNewValue_(void 0),i.data_.delete(n)}),a&&_n(this,c),!0}return!1},e.updateValue_=function(n,i){var s=this.data_.get(n);if(i=s.prepareNewValue_(i),i!==q.UNCHANGED){var o=Os(),a=wn(this),c=a||o?{observableKind:"map",debugObjectName:this.name_,type:Nn,object:this,oldValue:s.value_,name:n,newValue:i}:null;s.setNewValue_(i),a&&_n(this,c)}},e.addValue_=function(n,i){var s=this;this.keysAtom_,ln(function(){var l,u=new hr(i,s.enhancer_,"ObservableMap.key",!1);s.data_.set(n,u),i=u.value_,(l=s.hasMap_.get(n))==null||l.setNewValue_(!0),s.keysAtom_.reportChanged()});var o=Os(),a=wn(this),c=a||o?{observableKind:"map",debugObjectName:this.name_,type:ur,object:this,name:n,newValue:i}:null;a&&_n(this,c)},e.get=function(n){return this.has(n)?this.dehanceValue_(this.data_.get(n).get()):this.dehanceValue_(void 0)},e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},e.values=function(){var n=this,i=this.keys();return zs({next:function(){var o=i.next(),a=o.done,c=o.value;return{done:a,value:a?void 0:n.get(c)}}})},e.entries=function(){var n=this,i=this.keys();return zs({next:function(){var o=i.next(),a=o.done,c=o.value;return{done:a,value:a?void 0:[c,n.get(c)]}}})},e[ky]=function(){return this.entries()},e.forEach=function(n,i){for(var s=Ai(this),o;!(o=s()).done;){var a=o.value,c=a[0],l=a[1];n.call(i,l,c,this)}},e.merge=function(n){var i=this;return pt(n)&&(n=new Map(n)),ln(function(){Jn(n)?NA(n).forEach(function(s){return i.set(s,n[s])}):Array.isArray(n)?n.forEach(function(s){var o=s[0],a=s[1];return i.set(o,a)}):rs(n)?(n.constructor!==Map&&de(19,n),n.forEach(function(s,o){return i.set(o,s)})):n!=null&&de(20,n)}),this},e.clear=function(){var n=this;ln(function(){Tl(function(){for(var i=Ai(n.keys()),s;!(s=i()).done;){var o=s.value;n.delete(o)}})})},e.replace=function(n){var i=this;return ln(function(){for(var s=Ck(n),o=new Map,a=!1,c=Ai(i.data_.keys()),l;!(l=c()).done;){var u=l.value;if(!s.has(u)){var h=i.delete(u);if(h)a=!0;else{var b=i.data_.get(u);o.set(u,b)}}}for(var w=Ai(s.entries()),k;!(k=w()).done;){var g=k.value,_=g[0],I=g[1],L=i.data_.has(_);if(i.set(_,I),i.data_.has(_)){var G=i.data_.get(_);o.set(_,G),L||(a=!0)}}if(!a)if(i.data_.size!==o.size)i.keysAtom_.reportChanged();else for(var $=i.data_.keys(),Q=o.keys(),v=$.next(),O=Q.next();!v.done;){if(v.value!==O.value){i.keysAtom_.reportChanged();break}v=$.next(),O=Q.next()}i.data_=o}),this},e.toString=function(){return"[object ObservableMap]"},e.toJSON=function(){return Array.from(this)},e.observe_=function(n,i){return co(this,n)},e.intercept_=function(n){return ao(this,n)},Il(r,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Iy,get:function(){return"Map"}}]),r}(),pt=Sr("ObservableMap",ic);function Ck(r){if(rs(r)||pt(r))return r;if(Array.isArray(r))return new Map(r);if(Jn(r)){var e=new Map;for(var t in r)e.set(t,r[t]);return e}else return de(21,r)}var Ey,Oy,Kk={};Ey=Symbol.iterator;Oy=Symbol.toStringTag;var xl=function(){function r(t,n,i){var s=this;n===void 0&&(n=Wr),i===void 0&&(i="ObservableSet"),this.name_=void 0,this[ne]=Kk,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=i,rn(Set)||de(22),this.enhancer_=function(o,a){return n(o,a,i)},Er(function(){s.atom_=Ya(s.name_),t&&s.replace(t)})}var e=r.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.clear=function(){var n=this;ln(function(){Tl(function(){for(var i=Ai(n.data_.values()),s;!(s=i()).done;){var o=s.value;n.delete(o)}})})},e.forEach=function(n,i){for(var s=Ai(this),o;!(o=s()).done;){var a=o.value;n.call(i,a,a,this)}},e.add=function(n){var i=this;if(this.atom_,dn(this)){var s=fn(this,{type:ur,object:this,newValue:n});if(!s)return this}if(!this.has(n)){ln(function(){i.data_.add(i.enhancer_(n,void 0)),i.atom_.reportChanged()});var o=!1,a=wn(this),c=a||o?{observableKind:"set",debugObjectName:this.name_,type:ur,object:this,newValue:n}:null;a&&_n(this,c)}return this},e.delete=function(n){var i=this;if(dn(this)){var s=fn(this,{type:ca,object:this,oldValue:n});if(!s)return!1}if(this.has(n)){var o=!1,a=wn(this),c=a||o?{observableKind:"set",debugObjectName:this.name_,type:ca,object:this,oldValue:n}:null;return ln(function(){i.atom_.reportChanged(),i.data_.delete(n)}),a&&_n(this,c),!0}return!1},e.has=function(n){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(n))},e.entries=function(){var n=0,i=Array.from(this.keys()),s=Array.from(this.values());return zs({next:function(){var a=n;return n+=1,a<s.length?{value:[i[a],s[a]],done:!1}:{done:!0}}})},e.keys=function(){return this.values()},e.values=function(){this.atom_.reportObserved();var n=this,i=0,s=Array.from(this.data_.values());return zs({next:function(){return i<s.length?{value:n.dehanceValue_(s[i++]),done:!1}:{done:!0}}})},e.replace=function(n){var i=this;return Nt(n)&&(n=new Set(n)),ln(function(){Array.isArray(n)?(i.clear(),n.forEach(function(s){return i.add(s)})):to(n)?(i.clear(),n.forEach(function(s){return i.add(s)})):n!=null&&de("Cannot initialize set from "+n)}),this},e.observe_=function(n,i){return co(this,n)},e.intercept_=function(n){return ao(this,n)},e.toJSON=function(){return Array.from(this)},e.toString=function(){return"[object ObservableSet]"},e[Ey]=function(){return this.values()},Il(r,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Oy,get:function(){return"Set"}}]),r}(),Nt=Sr("ObservableSet",xl),jd=Object.create(null),qd="remove",Py=function(){function r(t,n,i,s){n===void 0&&(n=new Map),s===void 0&&(s=mS),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=t,this.values_=n,this.name_=i,this.defaultAnnotation_=s,this.keysAtom_=new ro("ObservableObject.keys"),this.isPlainObject_=Jn(this.target_)}var e=r.prototype;return e.getObservablePropValue_=function(n){return this.values_.get(n).get()},e.setObservablePropValue_=function(n,i){var s=this.values_.get(n);if(s instanceof zi)return s.set(i),!0;if(dn(this)){var o=fn(this,{type:Nn,object:this.proxy_||this.target_,name:n,newValue:i});if(!o)return null;i=o.newValue}if(i=s.prepareNewValue_(i),i!==q.UNCHANGED){var a=wn(this),c=!1,l=a||c?{type:Nn,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:s.value_,name:n,newValue:i}:null;s.setNewValue_(i),a&&_n(this,l)}return!0},e.get_=function(n){return q.trackingDerivation&&!Hn(this.target_,n)&&this.has_(n),this.target_[n]},e.set_=function(n,i,s){return s===void 0&&(s=!1),Hn(this.target_,n)?this.values_.has(n)?this.setObservablePropValue_(n,i):s?Reflect.set(this.target_,n,i):(this.target_[n]=i,!0):this.extend_(n,{value:i,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,s)},e.has_=function(n){if(!q.trackingDerivation)return n in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var i=this.pendingKeys_.get(n);return i||(i=new hr(n in this.target_,Qa,"ObservableObject.key?",!1),this.pendingKeys_.set(n,i)),i.get()},e.make_=function(n,i){if(i===!0&&(i=this.defaultAnnotation_),i!==!1){if(!(n in this.target_)){var s;if((s=this.target_[Kn])!=null&&s[n])return;de(1,i.annotationType_,this.name_+"."+n.toString())}for(var o=this.target_;o&&o!==Zs;){var a=na(o,n);if(a){var c=i.make_(this,n,a,o);if(c===0)return;if(c===1)break}o=Object.getPrototypeOf(o)}Hd(this,i,n)}},e.extend_=function(n,i,s,o){if(o===void 0&&(o=!1),s===!0&&(s=this.defaultAnnotation_),s===!1)return this.defineProperty_(n,i,o);var a=s.extend_(this,n,i,o);return a&&Hd(this,s,n),a},e.defineProperty_=function(n,i,s){s===void 0&&(s=!1),this.keysAtom_;try{Ut();var o=this.delete_(n);if(!o)return o;if(dn(this)){var a=fn(this,{object:this.proxy_||this.target_,name:n,type:ur,newValue:i.value});if(!a)return null;var c=a.newValue;i.value!==c&&(i=mr({},i,{value:c}))}if(s){if(!Reflect.defineProperty(this.target_,n,i))return!1}else Ln(this.target_,n,i);this.notifyPropertyAddition_(n,i.value)}finally{$t()}return!0},e.defineObservableProperty_=function(n,i,s,o){o===void 0&&(o=!1),this.keysAtom_;try{Ut();var a=this.delete_(n);if(!a)return a;if(dn(this)){var c=fn(this,{object:this.proxy_||this.target_,name:n,type:ur,newValue:i});if(!c)return null;i=c.newValue}var l=Gd(n),u={configurable:q.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:l.get,set:l.set};if(o){if(!Reflect.defineProperty(this.target_,n,u))return!1}else Ln(this.target_,n,u);var h=new hr(i,s,"ObservableObject.key",!1);this.values_.set(n,h),this.notifyPropertyAddition_(n,h.value_)}finally{$t()}return!0},e.defineComputedProperty_=function(n,i,s){s===void 0&&(s=!1),this.keysAtom_;try{Ut();var o=this.delete_(n);if(!o)return o;if(dn(this)){var a=fn(this,{object:this.proxy_||this.target_,name:n,type:ur,newValue:void 0});if(!a)return null}i.name||(i.name="ObservableObject.key"),i.context=this.proxy_||this.target_;var c=Gd(n),l={configurable:q.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:c.get,set:c.set};if(s){if(!Reflect.defineProperty(this.target_,n,l))return!1}else Ln(this.target_,n,l);this.values_.set(n,new zi(i)),this.notifyPropertyAddition_(n,void 0)}finally{$t()}return!0},e.delete_=function(n,i){if(i===void 0&&(i=!1),this.keysAtom_,!Hn(this.target_,n))return!0;if(dn(this)){var s=fn(this,{object:this.proxy_||this.target_,name:n,type:qd});if(!s)return null}try{var o,a;Ut();var c=wn(this),l=!1,u=this.values_.get(n),h=void 0;if(!u&&(c||l)){var b;h=(b=na(this.target_,n))==null?void 0:b.value}if(i){if(!Reflect.deleteProperty(this.target_,n))return!1}else delete this.target_[n];if(u&&(this.values_.delete(n),u instanceof hr&&(h=u.value_),ty(u)),this.keysAtom_.reportChanged(),(o=this.pendingKeys_)==null||(a=o.get(n))==null||a.set(n in this.target_),c||l){var w={type:qd,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:h,name:n};c&&_n(this,w)}}finally{$t()}return!0},e.observe_=function(n,i){return co(this,n)},e.intercept_=function(n){return ao(this,n)},e.notifyPropertyAddition_=function(n,i){var s,o,a=wn(this),c=!1;if(a||c){var l=a||c?{type:ur,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:n,newValue:i}:null;a&&_n(this,l)}(s=this.pendingKeys_)==null||(o=s.get(n))==null||o.set(!0),this.keysAtom_.reportChanged()},e.ownKeys_=function(){return this.keysAtom_.reportObserved(),Di(this.target_)},e.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},r}();function ii(r,e){var t;if(Hn(r,ne))return r;var n=(t=e==null?void 0:e.name)!=null?t:"ObservableObject",i=new Py(r,new Map,String(n),PS(e));return eo(r,ne,i),r}var Lk=Sr("ObservableObjectAdministration",Py);function Gd(r){return jd[r]||(jd[r]={get:function(){return this[ne].getObservablePropValue_(r)},set:function(t){return this[ne].setObservablePropValue_(r,t)}})}function ft(r){return Ha(r)?Lk(r[ne]):!1}function Hd(r,e,t){var n;(n=r.target_[Kn])==null||delete n[t]}var Nk=By(0),Dk=function(){var r=!1,e={};return Object.defineProperty(e,"0",{set:function(){r=!0}}),Object.create(e)[0]=1,r===!1}(),Gc=0,Ty=function(){};function Vk(r,e){Object.setPrototypeOf?Object.setPrototypeOf(r.prototype,e):r.prototype.__proto__!==void 0?r.prototype.__proto__=e:r.prototype=e}Vk(Ty,Array.prototype);var Ml=function(r,e,t){Mp(n,r);function n(s,o,a,c){var l;return a===void 0&&(a="ObservableArray"),c===void 0&&(c=!1),l=r.call(this)||this,Er(function(){var u=new Rl(a,o,c,!0);u.proxy_=Wc(l),Bp(Wc(l),ne,u),s&&s.length&&l.spliceWithArray(0,0,s),Dk&&Object.defineProperty(Wc(l),"0",Nk)}),l}var i=n.prototype;return i.concat=function(){this[ne].atom_.reportObserved();for(var o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return Array.prototype.concat.apply(this.slice(),a.map(function(l){return bt(l)?l.slice():l}))},i[t]=function(){var s=this,o=0;return zs({next:function(){return o<s.length?{value:s[o++],done:!1}:{done:!0,value:void 0}}})},Il(n,[{key:"length",get:function(){return this[ne].getArrayLength_()},set:function(o){this[ne].setArrayLength_(o)}},{key:e,get:function(){return"Array"}}]),n}(Ty,Symbol.toStringTag,Symbol.iterator);Object.entries(aa).forEach(function(r){var e=r[0],t=r[1];e!=="concat"&&eo(Ml.prototype,e,t)});function By(r){return{enumerable:!1,configurable:!0,get:function(){return this[ne].get_(r)},set:function(t){this[ne].set_(r,t)}}}function zk(r){Ln(Ml.prototype,""+r,By(r))}function Ry(r){if(r>Gc){for(var e=Gc;e<r+100;e++)zk(e);Gc=r}}Ry(1e3);function Fk(r,e,t){return new Ml(r,e,t)}function Dn(r,e){if(typeof r=="object"&&r!==null){if(bt(r))return e!==void 0&&de(23),r[ne].atom_;if(Nt(r))return r.atom_;if(pt(r)){if(e===void 0)return r.keysAtom_;var t=r.data_.get(e)||r.hasMap_.get(e);return t||de(25,e,ua(r)),t}if(ft(r)){if(!e)return de(26);var n=r[ne].values_.get(e);return n||de(27,e,ua(r)),n}if(El(r)||jr(r)||oa(r))return r}else if(rn(r)&&oa(r[ne]))return r[ne];de(28)}function Vn(r,e){if(r||de(29),e!==void 0)return Vn(Dn(r,e));if(El(r)||jr(r)||oa(r)||pt(r)||Nt(r))return r;if(r[ne])return r[ne];de(24,r)}function ua(r,e){var t;if(e!==void 0)t=Dn(r,e);else{if(kr(r))return r.name;ft(r)||pt(r)||Nt(r)?t=Vn(r):t=Dn(r)}return t.name_}function Er(r){var e=ri(),t=Xa(!0);Ut();try{return r()}finally{$t(),Za(t),Yn(e)}}var Yd=Zs.toString;function Cl(r,e,t){return t===void 0&&(t=-1),xu(r,e,t)}function xu(r,e,t,n,i){if(r===e)return r!==0||1/r===1/e;if(r==null||e==null)return!1;if(r!==r)return e!==e;var s=typeof r;if(s!=="function"&&s!=="object"&&typeof e!="object")return!1;var o=Yd.call(r);if(o!==Yd.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+r==""+e;case"[object Number]":return+r!=+r?+e!=+e:+r==0?1/+r===1/e:+r==+e;case"[object Date]":case"[object Boolean]":return+r==+e;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(r)===Symbol.valueOf.call(e);case"[object Map]":case"[object Set]":t>=0&&t++;break}r=Qd(r),e=Qd(e);var a=o==="[object Array]";if(!a){if(typeof r!="object"||typeof e!="object")return!1;var c=r.constructor,l=e.constructor;if(c!==l&&!(rn(c)&&c instanceof c&&rn(l)&&l instanceof l)&&"constructor"in r&&"constructor"in e)return!1}if(t===0)return!1;t<0&&(t=-1),n=n||[],i=i||[];for(var u=n.length;u--;)if(n[u]===r)return i[u]===e;if(n.push(r),i.push(e),a){if(u=r.length,u!==e.length)return!1;for(;u--;)if(!xu(r[u],e[u],t-1,n,i))return!1}else{var h=Object.keys(r),b;if(u=h.length,Object.keys(e).length!==u)return!1;for(;u--;)if(b=h[u],!(Hn(e,b)&&xu(r[b],e[b],t-1,n,i)))return!1}return n.pop(),i.pop(),!0}function Qd(r){return bt(r)?r.slice():rs(r)||pt(r)||to(r)||Nt(r)?Array.from(r.entries()):r}function zs(r){return r[Symbol.iterator]=Uk,r}function Uk(){return this}["Symbol","Map","Set"].forEach(function(r){var e=Sl();typeof e[r]>"u"&&de("MobX requires global '"+r+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:ry,extras:{getDebugName:ua},$mobx:ne});var $k=Object.freeze(Object.defineProperty({__proto__:null,$mobx:ne,FlowCancellationError:nc,ObservableMap:ic,ObservableSet:xl,Reaction:Ds,_allowStateChanges:Vi,_allowStateChangesInsideComputed:Vs,_allowStateReadsEnd:Ti,_allowStateReadsStart:ec,_autoAction:Fi,_endAction:jp,_getAdministration:Vn,_getGlobalState:Jp,_interceptReads:fk,_isComputingDerivation:so,_resetGlobalState:DS,_startAction:Wp,action:tt,autorun:qr,comparer:$r,computed:hn,configure:ik,createAtom:Ya,defineProperty:vk,entries:by,extendObservable:tc,flow:Gr,flowResult:dk,get:bk,getAtom:Dn,getDebugName:ua,getDependencyTree:sk,getObserverTree:ok,has:wy,intercept:hk,isAction:kr,isBoxedObservable:Pl,isComputed:yy,isComputedProp:Wo,isFlow:Ui,isFlowCancellationError:uk,isObservable:rc,isObservableArray:bt,isObservableMap:pt,isObservableObject:ft,isObservableProp:gk,isObservableSet:Nt,keys:$i,makeAutoObservable:Pk,makeObservable:Bl,observable:je,observe:Wi,onBecomeObserved:ly,onBecomeUnobserved:oo,onReactionError:WS,override:YA,ownKeys:_y,reaction:uy,remove:mk,runInAction:Vs,set:vy,spy:ry,toJS:Ak,trace:Sk,transaction:ln,untracked:Tl,values:my,when:kk},Symbol.toStringTag,{value:"Module"})),xy=$s($k);(function(r){var e=T&&T.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(r,"__esModule",{value:!0}),r.Order=r.OrderSide=void 0;const t=Ke,n=e(Ip.exports),i=xy;var s;(function(a){a.Buy="buy",a.Sell="sell"})(s=r.OrderSide||(r.OrderSide={}));class o{constructor(c){this.id="",this.orderType=s.Buy,this.orderMint="",this.currencyMint="",this.currencyDecimals=0,this.price=new t.BN(0),this.orderQtyRemaining=0,this.orderOriginationQty=0,this.owner="",this.ownerAssetTokenAccount="",this.ownerCurrencyTokenAccount="",this.createdAt=0,this.slotContext=0,c&&(this.id=c.id,this.orderType=c.orderType,this.orderMint=c.orderMint,this.currencyMint=c.currencyMint,this.currencyDecimals=c.currencyDecimals,this.price=c.price,this.orderQtyRemaining=c.orderQtyRemaining,this.orderOriginationQty=c.orderOriginationQty,this.owner=c.owner,this.ownerAssetTokenAccount=c.ownerAssetTokenAccount,this.ownerCurrencyTokenAccount=c.ownerCurrencyTokenAccount,this.createdAt=c.createdAt,this.slotContext=c.slotContext),(0,i.makeObservable)(this,{orderQtyRemaining:i.observable})}get decimalDivisor(){return new n.default(10).pow(this.currencyDecimals)}get bigNumberPrice(){return new n.default(this.price.toString())}get uiPrice(){return this.bigNumberPrice.div(this.decimalDivisor).toNumber()}priceForQuantity(c=1){return this.bigNumberPrice.mul(c).div(this.decimalDivisor).toNumber()}}r.Order=o})(Ga);(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Ga,r)})(qa);var Wk=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(ja,"__esModule",{value:!0});ja.createExchangeInstruction=void 0;const Io=Ke,Eo=Xn,jk=Ht,Jd=_r,qk=_r,Hc=yn,Yc=qa;function Gk({connection:r,orderAccount:e,purchaseQty:t,orderTaker:n,orderTakerDepositTokenAccount:i,programId:s,expectedPrice:o,orderType:a,assetMint:c,currencyMint:l,orderInitializer:u,saVault:h,stakingProgramId:b,registeredStake:w,stakingAccount:k,extraAccounts:g=[]}){return Wk(this,void 0,void 0,function*(){const _=(0,jk.getMarketplaceProgram)({connection:r,programId:s}),I={signers:[],instructions:[]},L=a===Yc.OrderSide.Sell?new Eo.PublicKey(c):new Eo.PublicKey(l),G=a===Yc.OrderSide.Sell?new Eo.PublicKey(l):new Eo.PublicKey(c);let $=null,Q=null,v=null,O=yield(0,Hc.getTokenAccount)(r,u,L,n);"createInstruction"in O?(I.instructions.push(...O.createInstruction),O.tokenAccount instanceof Io.web3.Keypair?($=O.tokenAccount.publicKey,I.signers.push(O.tokenAccount)):$=O.tokenAccount):$=O.tokenAccount,O=yield(0,Hc.getTokenAccount)(r,u,G,n),"createInstruction"in O?(I.instructions.push(...O.createInstruction),O.tokenAccount instanceof Io.web3.Keypair?(Q=O.tokenAccount.publicKey,I.signers.push(O.tokenAccount)):Q=O.tokenAccount):Q=O.tokenAccount;const[R]=yield(0,Jd.getOrderVault)(u,L,s),[N]=yield(0,qk.getOpenOrdersCounter)(u,L,s);O=yield(0,Hc.getTokenAccount)(r,n,L),"createInstruction"in O?(I.instructions.push(...O.createInstruction),O.tokenAccount instanceof Io.web3.Keypair?(v=O.tokenAccount.publicKey,I.signers.push(O.tokenAccount)):v=O.tokenAccount):v=O.tokenAccount;const M=a===Yc.OrderSide.Buy?n:u,[J]=yield(0,Jd.getFeeExemptAccount)(M,s),re=yield _.methods.processExchange(new Io.BN(t),o,M).accounts({orderTaker:n,orderTakerDepositTokenAccount:i,orderTakerReceiveTokenAccount:v,currencyMint:l,assetMint:c,orderInitializer:u,initializerDepositTokenAccount:$,initializerReceiveTokenAccount:Q,orderVaultAccount:R,orderAccount:e,openOrdersCounter:N,saVault:h,atlasStaking:b,registeredStake:w,stakingAccount:k,feeReduction:J}).remainingAccounts(g).instruction();return I.instructions.push(re),I})}ja.createExchangeInstruction=Gk;var sc={},Hk=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(sc,"__esModule",{value:!0});sc.createInitializeMarketInstruction=void 0;const Yk=Ht;function Qk({connection:r,updateAuthorityAccount:e,programId:t}){return Hk(this,void 0,void 0,function*(){const i=[yield(0,Yk.getMarketplaceProgram)({connection:r,programId:t}).methods.initializeMarketplace().accounts({updateAuthorityAccount:e}).instruction()];return{accounts:[],instructions:i}})}sc.createInitializeMarketInstruction=Qk;var oc={},Jk=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(oc,"__esModule",{value:!0});oc.createRegisterCurrencyInstruction=void 0;const Xk=Ke,Zk=Ht;function e0({connection:r,updateAuthorityAccount:e,royalty:t,saCurrencyVault:n,currencyMint:i,programId:s}){return Jk(this,void 0,void 0,function*(){const a=[yield(0,Zk.getMarketplaceProgram)({connection:r,programId:s}).methods.registerCurrency(new Xk.BN(t)).accounts({updateAuthorityAccount:e,saCurrencyVault:n,currencyMint:i}).instruction()];return{accounts:[],instructions:a}})}oc.createRegisterCurrencyInstruction=e0;var pr={},Kl=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(pr,"__esModule",{value:!0});pr.updateRoyaltyTier=pr.deleteRoyaltyTier=pr.addRoyaltyTier=void 0;const Fs=Ke,Ll=Ht;function t0({connection:r,updateAuthorityAccount:e,registeredCurrency:t,stakeAmount:n,discount:i,programId:s}){return Kl(this,void 0,void 0,function*(){const o=(0,Ll.getMarketplaceProgram)({connection:r,programId:s}),a={signers:[],instructions:[]},c=yield o.methods.addRoyaltyTier(new Fs.BN(n),new Fs.BN(i)).accounts({updateAuthorityAccount:e,registeredCurrency:t}).instruction();return a.instructions.push(c),a})}pr.addRoyaltyTier=t0;function n0({connection:r,updateAuthorityAccount:e,registeredCurrency:t,stakeAmount:n,programId:i}){return Kl(this,void 0,void 0,function*(){const s=(0,Ll.getMarketplaceProgram)({connection:r,programId:i}),o={signers:[],instructions:[]},a=yield s.methods.deleteRoyaltyTier(new Fs.BN(n)).accounts({updateAuthorityAccount:e,registeredCurrency:t}).instruction();return o.instructions.push(a),o})}pr.deleteRoyaltyTier=n0;function r0({connection:r,updateAuthorityAccount:e,registeredCurrency:t,stakeAmount:n,discount:i,programId:s}){return Kl(this,void 0,void 0,function*(){const o=(0,Ll.getMarketplaceProgram)({connection:r,programId:s}),a={signers:[],instructions:[]},c=yield o.methods.updateRoyaltyTier(new Fs.BN(n),new Fs.BN(i)).accounts({updateAuthorityAccount:e,registeredCurrency:t}).instruction();return a.instructions.push(c),a})}pr.updateRoyaltyTier=r0;var ji={},My=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(ji,"__esModule",{value:!0});ji.createUpdateRegisteredCurrencyVaultInstruction=ji.createUpdateRegisteredCurrencyRoyaltyInstruction=void 0;const i0=Ke,Cy=Ht;function s0({connection:r,updateAuthorityAccount:e,royalty:t,currencyMint:n,programId:i}){return My(this,void 0,void 0,function*(){return[yield(0,Cy.getMarketplaceProgram)({connection:r,programId:i}).methods.updateCurrencyRoyalty(new i0.BN(t)).accounts({updateAuthorityAccount:e,currencyMint:n}).instruction()]})}ji.createUpdateRegisteredCurrencyRoyaltyInstruction=s0;function o0({connection:r,updateAuthorityAccount:e,saCurrencyVault:t,currencyMint:n,programId:i}){return My(this,void 0,void 0,function*(){return[yield(0,Cy.getMarketplaceProgram)({connection:r,programId:i}).methods.updateCurrencyVault().accounts({updateAuthorityAccount:e,saCurrencyVault:t,currencyMint:n}).instruction()]})}ji.createUpdateRegisteredCurrencyVaultInstruction=o0;var qi={},Ky=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(qi,"__esModule",{value:!0});qi.createRemoveFeeExemptionInstruction=qi.createAddFeeExemptionInstruction=void 0;const a0=Ke,Ly=Ht,la=_r;function c0({connection:r,updateAuthorityAccount:e,funder:t,feeExemptTarget:n,programId:i}){return Ky(this,void 0,void 0,function*(){const s=(0,Ly.getMarketplaceProgram)({connection:r,programId:i}),o={signers:[],instructions:[]},a=1e6,[c]=yield(0,la.getFeeExemptAccount)(n,i),[l]=yield(0,la.getMarketVarsAccount)(i),u=[yield s.methods.addFeeExemption(new a0.BN(a)).accounts({updateAuthorityMaster:e,funder:t,feeExemptTarget:n,feeExemptAccount:c,marketVarsAccount:l}).instruction()];return o.instructions.push(...u),o})}qi.createAddFeeExemptionInstruction=c0;function u0({connection:r,updateAuthorityAccount:e,funder:t,feeExemptTarget:n,programId:i}){return Ky(this,void 0,void 0,function*(){const s=(0,Ly.getMarketplaceProgram)({connection:r,programId:i}),o={signers:[],instructions:[]},[a]=yield(0,la.getFeeExemptAccount)(n,i),[c]=yield(0,la.getMarketVarsAccount)(i),l=[yield s.methods.removeFeeExemption().accounts({updateAuthorityMaster:e,funder:t,feeExemptAccount:a,feeExemptTarget:n,marketVarsAccount:c}).instruction()];return o.instructions.push(...l),o})}qi.createRemoveFeeExemptionInstruction=u0;(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(gp,r),t(Fa,r),t(Ni,r),t(Wa,r),t(ja,r),t(sc,r),t(oc,r),t(pr,r),t(ji,r),t(qi,r)})(wl);var ss={},Ny={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.GmLogs=void 0,function(e){e.CancelOrderMemo="CancelOrderMemo",e.ExchangeMemo="ExchangeMemo",e.InitializeMemo="InitializeMemo",e.RegisterCurrencyMemo="RegisterCurrencyMemo"}(r.GmLogs||(r.GmLogs={}))})(Ny);var Dy={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.GmEventType=void 0,function(e){e[e.orderAdded=0]="orderAdded",e[e.orderRemoved=1]="orderRemoved",e[e.orderModified=2]="orderModified"}(r.GmEventType||(r.GmEventType={}))})(Dy);(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Js,r),t(Ny,r),t(Dy,r)})(ss);var Vy={},ac={},zy=function(){},l0=function(r){return r};function Fy(r){throw new Error("[mobx-utils] "+r)}function vr(r,e){e===void 0&&(e="Illegal state"),r||Fy(e)}function Uy(r,e,t){Object.defineProperty(r,e,{enumerable:!1,writable:!0,configurable:!0,value:t})}var $y=function(r){return r&&r!==Object.prototype&&Object.getOwnPropertyNames(r).concat($y(Object.getPrototypeOf(r))||[])},d0=function(r){var e=$y(r),t=e.filter(function(n,i){return e.indexOf(n)===i});return t},Mu=function(r){return d0(r).filter(function(e){return e!=="constructor"&&!~e.indexOf("__")})},da="pending",Us="fulfilled",cc="rejected";function f0(r){switch(this.state){case da:return r.pending&&r.pending(this.value);case cc:return r.rejected&&r.rejected(this.value);case Us:return r.fulfilled?r.fulfilled(this.value):this.value}}function Cu(r,e){if(vr(arguments.length<=2,"fromPromise expects up to two arguments"),vr(typeof r=="function"||typeof r=="object"&&r&&typeof r.then=="function","Please pass a promise or function to fromPromise"),r.isPromiseBasedObservable===!0)return r;typeof r=="function"&&(r=new Promise(r));var t=r;r.then(tt("observableFromPromise-resolve",function(i){t.value=i,t.state=Us}),tt("observableFromPromise-reject",function(i){t.value=i,t.state=cc})),t.isPromiseBasedObservable=!0,t.case=f0;var n=e&&(e.state===Us||e.state===da)?e.value:void 0;return tc(t,{value:n,state:da},{},{deep:!1}),t}(function(r){r.reject=tt("fromPromise.reject",function(t){var n=r(Promise.reject(t));return n.state=cc,n.value=t,n});function e(t){t===void 0&&(t=void 0);var n=r(Promise.resolve(t));return n.state=Us,n.value=t,n}r.resolve=tt("fromPromise.resolve",e)})(Cu||(Cu={}));function h0(r){return r&&r.isPromiseBasedObservable===!0}var Xd=function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n};function p0(r,e,t){if(Zd(r,e),Zd(r,t),e!==t){var n=r.slice(),i;return e<t?i=Xd(n.slice(0,e),n.slice(e+1,t+1),[n[e]],n.slice(t+1)):i=Xd(n.slice(0,t),[n[e]],n.slice(t,e),n.slice(e+1)),r.replace(i),r}}function Zd(r,e){if(e<0)throw new Error("[mobx.array] Index out of bounds: "+e+" is negative");var t=r.length;if(e>=t)throw new Error("[mobx.array] Index out of bounds: "+e+" is not smaller than "+t)}function y0(r,e){e===void 0&&(e=void 0);var t=!1,n=je.box(e,{deep:!1}),i=je.box(!1),s=function(){return t||(t=!0,Vi(!0,function(){i.set(!0)}),r(function(a){Vi(!0,function(){n.set(a),i.set(!1)})})),n.get()},o=tt("lazyObservable-reset",function(){return t=!1,n.set(e),n.get()});return{current:s,refresh:function(){return t?(t=!1,s()):n.get()},reset:function(){return o()},get pending(){return i.get()}}}function Nl(r,e,t){e===void 0&&(e=zy),t===void 0&&(t=void 0);var n=!1,i=!1,s=t,o=function(){n&&(n=!1,e())},a=Ya("ResourceBasedObservable",function(){vr(!n&&!i),n=!0,r(function(c){Vi(!0,function(){s=c,a.reportChanged()})})},o);return{current:function(){vr(!i,"subscribingObservable has already been disposed");var c=a.reportObserved();return!c&&!n&&console.warn("Called `get` of a subscribingObservable outside a reaction. Current value will be returned but no new subscription has started"),s},dispose:function(){i=!0,o()},isAlive:function(){return n}}}var Oo=function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s};function g0(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}function m0(r,e){var t;e===void 0&&(e=!1);var n=hn(r);return t={subscribe:function(i){return typeof i=="function"?{unsubscribe:Wi(n,function(s){var o=s.newValue;return i(o)},e)}:i&&typeof i=="object"&&i.next?{unsubscribe:Wi(n,function(s){var o=s.newValue;return i.next(o)},e)}:{unsubscribe:function(){}}}},t[g0()]=function(){return this},t}var b0=function(){function r(e,t){var n=this;Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"subscription",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Bl(this),Vs(function(){n.current=t,n.subscription=e.subscribe(n)})}return Object.defineProperty(r.prototype,"dispose",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.subscription&&this.subscription.unsubscribe()}}),Object.defineProperty(r.prototype,"next",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.current=e}}),Object.defineProperty(r.prototype,"complete",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.dispose()}}),Object.defineProperty(r.prototype,"error",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.current=e,this.dispose()}}),Oo([je.ref],r.prototype,"current",void 0),Oo([tt.bound],r.prototype,"next",null),Oo([tt.bound],r.prototype,"complete",null),Oo([tt.bound],r.prototype,"error",null),r}();function v0(r,e){return e===void 0&&(e=void 0),new b0(r,e)}var fa=function(){return fa=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},fa.apply(this,arguments)},hs=function(r,e,t,n){var i=arguments.length,s=i<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(r,e,t,n);else for(var a=r.length-1;a>=0;a--)(o=r[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},w0=["model","reset","submit","isDirty","isPropertyDirty","resetProperty"],Wy=function(){function r(e){var t=this;Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"localValues",{enumerable:!0,configurable:!0,writable:!0,value:je.map({})}),Object.defineProperty(this,"localComputedValues",{enumerable:!0,configurable:!0,writable:!0,value:je.map({})}),Object.defineProperty(this,"isPropertyDirty",{enumerable:!0,configurable:!0,writable:!0,value:function(i){return t.localValues.has(i)}}),Bl(this),vr(ft(e),"createViewModel expects an observable object");var n=Mu(this);Mu(e).forEach(function(i){var s;if(!n.includes(i)&&!(i===ne||i==="__mobxDidRunLazyInitializers")){if(vr(w0.indexOf(i)===-1,"The propertyname "+i+" is reserved and cannot be used with viewModels"),Wo(e,i)){var o=Vn(e,i),a=o.derivation.bind(t),c=(s=o.setter_)===null||s===void 0?void 0:s.bind(t);t.localComputedValues.set(i,hn(a,{set:c}))}var l=Object.getOwnPropertyDescriptor(e,i),u=l?{enumerable:l.enumerable}:{};Object.defineProperty(t,i,fa(fa({},u),{configurable:!0,get:function(){return Wo(e,i)?t.localComputedValues.get(i).get():t.isPropertyDirty(i)?t.localValues.get(i):t.model[i]},set:tt(function(h){Wo(e,i)?t.localComputedValues.get(i).set(h):h!==t.model[i]?t.localValues.set(i,h):t.localValues.delete(i)})}))}})}return Object.defineProperty(r.prototype,"isDirty",{get:function(){return this.localValues.size>0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"changedValues",{get:function(){return new Map(this.localValues)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"submit",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;$i(this.localValues).forEach(function(t){var n=e.localValues.get(t),i=e.model[t];bt(i)?i.replace(n):pt(i)?(i.clear(),i.merge(n)):yy(n)||(e.model[t]=n)}),this.localValues.clear()}}),Object.defineProperty(r.prototype,"reset",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.localValues.clear()}}),Object.defineProperty(r.prototype,"resetProperty",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.localValues.delete(e)}}),hs([hn],r.prototype,"isDirty",null),hs([hn],r.prototype,"changedValues",null),hs([tt.bound],r.prototype,"submit",null),hs([tt.bound],r.prototype,"reset",null),hs([tt.bound],r.prototype,"resetProperty",null),r}();function _0(r){return new Wy(r)}function A0(r,e){var t=Dn(r,e);if(!t)throw new Error("No computed provided, please provide an object created with `computed(() => expr)` or an object + property name");return Wi(t,function(){})}function S0(r,e,t){if(t===void 0&&(t=0),!bt(r))throw new Error("Expected observable array as first argument");kr(e)||(e=tt("queueProcessor",e));var n=function(){var i=r.slice(0);Vs(function(){return r.splice(0)}),i.forEach(e)};return t>0?qr(n,{delay:t}):qr(n)}function k0(r,e,t,n){if(t===void 0&&(t=0),n===void 0&&(n=0),!bt(r))throw new Error("Expected observable array as first argument");kr(e)||(e=tt("chunkProcessor",e));var i=function(){for(var s=function(){var o=n===0?r.length:Math.min(r.length,n),a=r.slice(0,o);Vs(function(){return r.splice(0,o)}),e(a)};r.length>0;)s()};return t>0?qr(i,{delay:t}):qr(i)}var Kr={};function I0(){for(var r=0,e=Object.getOwnPropertyNames(Kr);r<e.length;r++){var t=e[r];Kr[t].dispose(),delete Kr[t]}}function E0(r){return r===void 0&&(r=1e3),so()?(Kr[r]||(typeof r=="number"?Kr[r]=O0(r):Kr[r]=P0()),Kr[r].current()):Date.now()}function O0(r){var e;return Nl(function(t){t(Date.now()),e=setInterval(function(){return t(Date.now())},r)},function(){clearInterval(e)},Date.now())}function P0(){var r=Nl(function(e){e(Date.now());function t(){window.requestAnimationFrame(function(){e(Date.now()),r.isAlive()&&t()})}t()},function(){},Date.now());return r}function T0(r){return so()||console.warn("'expr' should only be used inside other reactive functions."),hn(r).get()}var ha=function(){return ha=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},ha.apply(this,arguments)},B0=0;function R0(r,e){vr(typeof r=="function"&&r.length<2,"createTransformer expects a function that accepts one argument");var t={},n=void 0,i=!1,s=void 0;typeof e=="object"?(n=e.onCleanup,i=e.keepAlive!==void 0?e.keepAlive:!1,s=e.debugNameGenerator):typeof e=="function"&&(n=e);function o(c,l){var u,h={};typeof e=="object"?(n=e.onCleanup,s=e.debugNameGenerator,h=e):typeof e=="function"?n=e:(n=void 0,s=void 0);var b=s?s(l):"Transformer-"+r.name+"-"+c,w=hn(function(){return u=r(l)},ha(ha({},h),{name:b}));if(!i)var k=oo(w,function(){delete t[c],k(),n&&n(u,l)});return w}var a=!1;return function(c){var l=x0(c),u=t[l];if(u)return u.get();if(!i&&!so()){a||(console.warn("invoking a transformer from outside a reactive context won't memorized and is cleaned up immediately, unless keepAlive is set"),a=!0);var h=r(c);return n&&n(h,c),h}return u=t[l]=o(l,c),u.get()}}function x0(r){var e=typeof r;if(e==="string")return"string:"+r;if(e==="number")return"number:"+r;if(r===null||e!=="object"&&e!=="function")throw new Error("[mobx-utils] transform expected an object, function, string or number, got: "+String(r));var t=r.$transformId;return t===void 0&&(t="memoizationId:"+ ++B0,Uy(r,"$transformId",t)),t}function Qc(r){if(!r)return"ROOT";for(var e=[];r.parent;)e.push(r.path),r=r.parent;return e.reverse().join("/")}function Jc(r){return ft(r)||bt(r)||pt(r)}function M0(r,e){var t=new WeakMap;function n(a){var c=t.get(a.object);i(a,c),e(a,Qc(c),r)}function i(a,c){switch(a.type){case"add":s(a.newValue,c,a.name);break;case"update":o(a.oldValue),s(a.newValue,c,a.name||""+a.index);break;case"remove":case"delete":o(a.oldValue);break;case"splice":a.removed.map(o),a.added.forEach(function(h,b){return s(h,c,""+(a.index+b))});for(var l=a.index+a.addedCount;l<a.object.length;l++)if(Jc(a.object[l])){var u=t.get(a.object[l]);u&&(u.path=""+l)}break}}function s(a,c,l){if(Jc(a)){var u=t.get(a);if(u){if(u.parent!==c||u.path!==l)throw new Error("The same observable object cannot appear twice in the same tree,"+(" trying to assign it to '"+Qc(c)+"/"+l+"',")+(" but it already exists at '"+Qc(u.parent)+"/"+u.path+"'"))}else{var h={parent:c,path:l,dispose:Wi(a,n)};t.set(a,h),by(a).forEach(function(b){var w=b[0],k=b[1];return s(k,h,w)})}}}function o(a){if(Jc(a)){var c=t.get(a);if(!c)return;t.delete(a),c.dispose(),my(a).forEach(o)}}return s(r,void 0,""),function(){o(r)}}var C0=function(){var r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=i[s])},r(e,t)};return function(e,t){r(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}}(),K0=function(r){C0(e,r);function e(t,n,i){var s=i===void 0?{}:i,o=s.name,a=o===void 0?"ogm"+(Math.random()*1e3|0):o,c=s.keyToName,l=c===void 0?function(b){return""+b}:c,u=r.call(this)||this;Object.defineProperty(u,"_base",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"_ogmInfoKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"_groupBy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"_keyToName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(u,"_disposeBaseObserver",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),u._keyToName=l,u._groupBy=n,u._ogmInfoKey=Symbol("ogmInfo"+a),u._base=t;for(var h=0;h<t.length;h++)u._addItem(t[h]);return u._disposeBaseObserver=Wi(u._base,function(b){if(b.type==="splice")ln(function(){for(var w=0,k=b.removed;w<k.length;w++){var g=k[w];u._removeItem(g)}for(var _=0,I=b.added;_<I.length;_++){var L=I[_];u._addItem(L)}});else if(b.type==="update")ln(function(){u._removeItem(b.oldValue),u._addItem(b.newValue)});else throw new Error("illegal state")}),u}return Object.defineProperty(e.prototype,"clear",{enumerable:!1,configurable:!0,writable:!0,value:function(){throw new Error("not supported")}}),Object.defineProperty(e.prototype,"delete",{enumerable:!1,configurable:!0,writable:!0,value:function(t){throw new Error("not supported")}}),Object.defineProperty(e.prototype,"set",{enumerable:!1,configurable:!0,writable:!0,value:function(t,n){throw new Error("not supported")}}),Object.defineProperty(e.prototype,"dispose",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._disposeBaseObserver();for(var t=0;t<this._base.length;t++){var n=this._base[t],i=n[this._ogmInfoKey];i.reaction(),delete n[this._ogmInfoKey]}}}),Object.defineProperty(e.prototype,"_getGroupArr",{enumerable:!1,configurable:!0,writable:!0,value:function(t){var n=r.prototype.get.call(this,t);return n===void 0&&(n=je([],{name:"GroupArray["+this._keyToName(t)+"]",deep:!1}),r.prototype.set.call(this,t,n)),n}}),Object.defineProperty(e.prototype,"_removeFromGroupArr",{enumerable:!1,configurable:!0,writable:!0,value:function(t,n){var i=r.prototype.get.call(this,t);i.length===1?r.prototype.delete.call(this,t):(n===i.length-1||(i[n]=i[i.length-1],i[n][this._ogmInfoKey].groupArrIndex=n),i.length--)}}),Object.defineProperty(e.prototype,"_addItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t){var n=this,i=this._groupBy(t),s=this._getGroupArr(i),o={groupByValue:i,groupArrIndex:s.length,reaction:uy(function(){return n._groupBy(t)},function(a,c){var l=t[n._ogmInfoKey];n._removeFromGroupArr(l.groupByValue,l.groupArrIndex);var u=n._getGroupArr(a),h=u.length;u.push(t),l.groupByValue=a,l.groupArrIndex=h})};Object.defineProperty(t,this._ogmInfoKey,{configurable:!0,enumerable:!1,value:o}),s.push(t)}}),Object.defineProperty(e.prototype,"_removeItem",{enumerable:!1,configurable:!0,writable:!0,value:function(t){var n=t[this._ogmInfoKey];this._removeFromGroupArr(n.groupByValue,n.groupArrIndex),n.reaction(),delete t[this._ogmInfoKey]}}),e}(ic),L0=function(){function r(e,t){Object.defineProperty(this,"base",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"args",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"root",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"closest",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"closestIdx",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"isDisposed",{enumerable:!0,configurable:!0,writable:!0,value:!1});for(var n=this.closest=this.root=e,i=0;i<this.args.length-1&&(n=n.get(t[i]),n);i++)this.closest=n;this.closestIdx=i}return Object.defineProperty(r.prototype,"exists",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.assertNotDisposed();var e=this.args.length;return this.closestIdx>=e-1&&this.closest.has(this.args[e-1])}}),Object.defineProperty(r.prototype,"get",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(this.assertNotDisposed(),!this.exists())throw new Error("Entry doesn't exist");return this.closest.get(this.args[this.args.length-1])}}),Object.defineProperty(r.prototype,"set",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.assertNotDisposed();for(var t=this.args.length,n=this.closest,i=this.closestIdx;i<t-1;i++){var s=new Map;n.set(this.args[i],s),n=s}this.closestIdx=t-1,this.closest=n,n.set(this.args[t-1],e)}}),Object.defineProperty(r.prototype,"delete",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(this.assertNotDisposed(),!this.exists())throw new Error("Entry doesn't exist");var e=this.args.length;this.closest.delete(this.args[e-1]);for(var t=this.root,n=[t],i=0;i<e-1;i++)t=t.get(this.args[i]),n.push(t);for(var i=n.length-1;i>0;i--)n[i].size===0&&n[i-1].delete(this.args[i-1]);this.isDisposed=!0}}),Object.defineProperty(r.prototype,"assertNotDisposed",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(this.isDisposed)throw new Error("Concurrent modification exception")}}),r}(),N0=function(){function r(){Object.defineProperty(this,"store",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"argsLength",{enumerable:!0,configurable:!0,writable:!0,value:-1}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}return Object.defineProperty(r.prototype,"entry",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(this.argsLength===-1)this.argsLength=e.length;else if(this.argsLength!==e.length)throw new Error("DeepMap should be used with functions with a consistent length, expected: "+this.argsLength+", got: "+e.length);return this.last&&(this.last.isDisposed=!0),this.last=new L0(this.store,e)}}),r}(),pa=function(){return pa=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},pa.apply(this,arguments)},D0=function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;for(var n=Array(r),i=0,e=0;e<t;e++)for(var s=arguments[e],o=0,a=s.length;o<a;o++,i++)n[i]=s[o];return n};function V0(r,e){if(e===void 0&&(e=!1),kr(r))throw new Error("computedFn shouldn't be used on actions");var t=!1,n=0,i=typeof e=="boolean"?{keepAlive:e}:e,s=new N0;return function(){for(var o=this,a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];var l=s.entry(a);if(l.exists())return l.get().get();if(!i.keepAlive&&!so())return!t&&Jp().computedRequiresReaction&&(console.warn("invoking a computedFn from outside an reactive context won't be memoized, unless keepAlive is set"),t=!0),r.apply(this,a);var u,h=hn(function(){return u=r.apply(o,a)},pa(pa({},i),{name:"computedFn("+(i.name||r.name)+"#"+ ++n+")"}));return l.set(h),i.keepAlive||oo(h,function(){s.entry(a).delete(),i.onCleanup&&i.onCleanup.apply(i,D0([u],a)),u=void 0}),h.get()}}var z0=Object.freeze(Object.defineProperty({__proto__:null,FULFILLED:Us,IDENTITY:l0,NOOP:zy,ObservableGroupMap:K0,PENDING:da,REJECTED:cc,ViewModel:Wy,addHiddenProp:Uy,chunkProcessor:k0,computedFn:V0,createTransformer:R0,createViewModel:_0,deepObserve:M0,expr:T0,fail:Fy,get fromPromise(){return Cu},fromResource:Nl,fromStream:v0,getAllMethodsAndProperties:Mu,invariant:vr,isPromiseBasedObservable:h0,keepAlive:A0,lazyObservable:y0,moveItem:p0,now:E0,queueProcessor:S0,resetNowInternalState:I0,toStream:m0},Symbol.toStringTag,{value:"Module"})),F0=$s(z0),uc={};Object.defineProperty(uc,"__esModule",{value:!0});uc.OrderCacheService=void 0;const ef=Sf.exports,Tn=xy,tf=Ga,Po=ss;class U0{constructor(){this.endTriggered=!1,this.observableData={buyOrdersCache:new Map,sellOrdersCache:new Map},this.orderChanges=(0,Tn.observable)([]),this.observableData=(0,Tn.makeAutoObservable)(this.observableData),(0,Tn.makeObservable)(this,{buyOrdersCache:Tn.computed,sellOrdersCache:Tn.computed,allOrdersCache:Tn.computed})}get buyOrdersCache(){return this.observableData.buyOrdersCache}get sellOrdersCache(){return this.observableData.sellOrdersCache}get allOrdersCache(){const e=new Map;return this.buyOrdersCache.forEach(t=>{t.forEach((n,i)=>{e.set(i,n)})}),this.sellOrdersCache.forEach(t=>{t.forEach((n,i)=>{e.set(i,n)})}),e}get mints(){return(0,ef.union)(Array.from(this.buyOrdersCache.keys()),Array.from(this.sellOrdersCache.keys()))}get orders(){return this.allOrdersCache}get buyOrders(){const e=new Map;return this.buyOrdersCache.forEach(t=>{t.forEach(n=>{e.set(n.id,n)})}),e}get sellOrders(){const e=new Map;return this.sellOrdersCache.forEach(t=>{t.forEach(n=>{e.set(n.id,n)})}),e}clearOrders(){const{allOrdersCache:e}=this;e.forEach(t=>{(0,Tn.runInAction)(()=>{this.orderChanges.push({eventType:Po.GmEventType.orderRemoved,order:t})})}),this.buyOrdersCache.clear(),this.sellOrdersCache.clear()}getAllOrdersCache(){return this.allOrdersCache}getOrderCacheByType(e){return e===tf.OrderSide.Buy?this.getBuyOrderCache():this.getSellOrderCache()}getBuyOrderCache(){return new Map(this.buyOrdersCache)}getSellOrderCache(){return new Map(this.sellOrdersCache)}getOrderById(e){return this.allOrdersCache.get(e)}addOrder(e){const t=this.getOrdersForType(e.orderType);t.get(e.orderMint)||t.set(e.orderMint,new Map);const n=t.get(e.orderMint),i=n.get(e.id);return i&&i.slotContext>e.slotContext?i:(n.set(e.id,e),(0,Tn.runInAction)(()=>{this.orderChanges.push({eventType:Po.GmEventType.orderAdded,order:e})}),e)}updateOrder(e){const n=this.getOrdersForType(e.orderType).get(e.orderMint),i=n.get(e.id);if(!!i){if(i.orderQtyRemaining!==e.orderQtyRemaining&&e.slotContext>i.slotContext){const s=(0,ef.clone)(i);s.orderQtyRemaining=e.orderQtyRemaining,n.set(e.id,s),(0,Tn.runInAction)(()=>{this.orderChanges.push({eventType:Po.GmEventType.orderModified,order:e})})}return e}}cancelOrder(e){return this.getOrdersForType(e.orderType).get(e.orderMint).delete(e.id)?((0,Tn.runInAction)(()=>{this.orderChanges.push({eventType:Po.GmEventType.orderRemoved,order:e})}),!0):!1}getOrdersForType(e){return e===tf.OrderSide.Buy?this.buyOrdersCache:this.sellOrdersCache}}uc.OrderCacheService=U0;var os={},lc={};Object.defineProperty(lc,"__esModule",{value:!0});lc.createTransactionFromInstructions=void 0;const $0=Xn,W0=r=>{const e=new $0.Transaction;return e.add(...r),e};lc.createTransactionFromInstructions=W0;var Gi={};Object.defineProperty(Gi,"__esModule",{value:!0});Gi.TEN_THOUSAND=Gi.ONE_MILLION=void 0;Gi.ONE_MILLION=1e6;Gi.TEN_THOUSAND=1e4;var Dt=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(os,"__esModule",{value:!0});os.GmClientService=void 0;const ir=Xn,To=wl,$n=_r,Xc=lc,nf=yn,li=Ga,rf=Gi,j0=Ht,q0=ma;class G0{constructor(){this.currencyInfo=[]}getRegisteredCurrencies(e,t,n=!1){var i;return Dt(this,void 0,void 0,function*(){if(((i=this.currencyInfo)===null||i===void 0?void 0:i.length)&&!n)return this.currencyInfo;const s=[],o=yield(0,$n.getAllRegisteredCurrencies)(e,t);for(const a of o){const{mint:c,royalty:l,saVault:u}=a,h=yield e.getTokenSupply(c,"recent"),{decimals:b}=h.value;s.push({decimals:b,mint:c.toString(),royaltyPercentageAsDecimal:l.toNumber()/rf.ONE_MILLION,saVault:u.toString()})}return this.currencyInfo=s,this.currencyInfo})}getAllOpenOrders(e,t){return Dt(this,void 0,void 0,function*(){const n=yield(0,$n.getAllOpenOrders)(e,t),i=yield e.getSlot();return this.accountItemsToOrders(e,t,n,i)})}getOpenOrdersForPlayer(e,t,n){return Dt(this,void 0,void 0,function*(){const i=yield(0,$n.getOpenOrdersForPlayer)(e,t,n),s=yield e.getSlot();return this.accountItemsToOrders(e,n,i,s)})}getOpenOrdersForCurrency(e,t,n){return Dt(this,void 0,void 0,function*(){const i=yield(0,$n.getOpenOrdersForCurrency)(e,t,n),s=yield e.getSlot();return this.accountItemsToOrders(e,n,i,s)})}getOpenOrdersForAsset(e,t,n){return Dt(this,void 0,void 0,function*(){const i=yield(0,$n.getOpenOrdersForAsset)(e,t,n),s=yield e.getSlot();return this.accountItemsToOrders(e,n,i,s)})}getOpenOrdersForPlayerAndCurrency(e,t,n,i){return Dt(this,void 0,void 0,function*(){const s=yield(0,$n.getOpenOrdersForPlayerAndCurrency)(e,t,n,i),o=yield e.getSlot();return this.accountItemsToOrders(e,i,s,o)})}getOpenOrdersForPlayerAndAsset(e,t,n,i){return Dt(this,void 0,void 0,function*(){const s=yield(0,$n.getOpenOrdersForPlayerAndAsset)(e,t,n,i),o=yield e.getSlot();return this.accountItemsToOrders(e,i,s,o)})}getOpenOrder(e,t,n){return Dt(this,void 0,void 0,function*(){const i=yield(0,$n.getSingleOrder)(e,t,n),s={publicKey:t,account:i},o=yield e.getSlot(),[a]=yield this.accountItemsToOrders(e,n,[s],o);return a})}getInitializeOrderTransaction(e,t,n,i,s,o,a,c){return Dt(this,void 0,void 0,function*(){let l=To.createInitializeSellOrderInstruction,u=n,h=i;c===li.OrderSide.Buy&&(l=To.createInitializeBuyOrderInstruction,u=i,h=n);const b=yield(0,nf.getAssociatedTokenAddress)(t,u),{ixSet:w}=yield l({connection:e,depositMint:u,initializerDepositTokenAccount:b,initializerMainAccount:t,originationQty:s,price:o,programId:a,receiveMint:h}),{signers:k,instructions:g}=w;return{transaction:(0,Xc.createTransactionFromInstructions)(g),signers:k}})}getBnPriceForCurrency(e,t,n,i){return Dt(this,void 0,void 0,function*(){const s=yield this.getRegisteredCurrencies(e,i),{decimals:o}=s.find(a=>a.mint.toString()===n.toString());return(0,j0.convertDecimalPriceToBn)(t,o)})}getCancelOrderTransaction(e,t,n,i){return Dt(this,void 0,void 0,function*(){const{instructions:s,signers:o}=yield(0,To.createCancelOrderInstruction)({connection:e,orderAccount:t,orderInitializer:n,programId:i});return{transaction:(0,Xc.createTransactionFromInstructions)(s),signers:o}})}getCreateExchangeTransaction(e,t,n,i,s,o=new ir.PublicKey("ATLocKpzDbTokxgvnLew3d7drZkEzLzDpzwgrgWKDbmc"),a=new ir.PublicKey("J5GhV1WKcEU98c1kZt36ixjaErrrPNWbZhg3JQDg114E")){return Dt(this,void 0,void 0,function*(){const c=new ir.PublicKey(t.id),l=new ir.PublicKey(t.orderMint),u=new ir.PublicKey(t.currencyMint),h=new ir.PublicKey(t.owner),b=t.orderType===li.OrderSide.Buy?n:new ir.PublicKey(t.owner),w=yield(0,nf.getAssociatedTokenAddress)(n,t.orderType===li.OrderSide.Buy?l:u),k=yield this.getRegisteredCurrencies(e,s),{saVault:g}=k.find($=>$.mint===t.currencyMint),[_]=yield(0,q0.getStakingAccount)(o,b,a),{instructions:I,signers:L}=yield(0,To.createExchangeInstruction)({connection:e,orderAccount:c,purchaseQty:i,orderTaker:n,orderTakerDepositTokenAccount:w,programId:s,expectedPrice:t.price,orderType:t.orderType,assetMint:l,currencyMint:u,orderInitializer:h,saVault:new ir.PublicKey(g),stakingProgramId:o,registeredStake:a,stakingAccount:_});return{transaction:(0,Xc.createTransactionFromInstructions)(I),signers:L}})}accountItemsToOrders(e,t,n,i){return Dt(this,void 0,void 0,function*(){if(!n.length)return[];const s=yield this.getRegisteredCurrencies(e,t);return n.map(o=>{const a=o.publicKey.toString(),c=Object.keys(o.account.orderSide)[0]==="buy"?li.OrderSide.Buy:li.OrderSide.Sell,l=o.account.assetMint.toString(),u=o.account.currencyMint.toString(),h=o.account.price,b=o.account.orderRemainingQty.toNumber(),w=o.account.orderOriginationQty.toNumber(),k=o.account.orderInitializerPubkey.toString(),g=o.account.initializerAssetTokenAccount.toString(),_=o.account.initializerCurrencyTokenAccount.toString(),I=o.account.createdAtTimestamp.toNumber(),{decimals:L}=s.find(G=>G.mint.toString()===u);return new li.Order({id:a,orderType:c,orderMint:l,currencyMint:u,currencyDecimals:L,price:h,orderQtyRemaining:b,orderOriginationQty:w,owner:k,ownerAssetTokenAccount:g,ownerCurrencyTokenAccount:_,createdAt:I,slotContext:i})})})}getAllFeeExemptions(e,t){return Dt(this,void 0,void 0,function*(){const n=[],i=yield(0,$n.getAllFeeExemptAccounts)(e,t);for(const s of i)n.push({publicKey:s.account.account.toString(),feeReductionPercentageAsDecimal:s.account.discount.toNumber()/rf.TEN_THOUSAND});return n})}}os.GmClientService=G0;var uo={},Bo=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(uo,"__esModule",{value:!0});uo.GmEventService=void 0;const ps=Ke,Zc=qa,eu=ss,H0=os,Y0=Ht,Ro=ss;class Q0{constructor(e,t,n){this.registeredCurrencyInfo={},this.eventListeners=[],this.queuedEvents=[],this.connection=e,this.programId=t,this.commitment=n||e.commitment,this.handleOrderCreated=this.handleOrderCreated.bind(this),this.handleOrderExchanged=this.handleOrderExchanged.bind(this),this.handleOrderCanceled=this.handleOrderCanceled.bind(this),this.setCurrencyInfo=this.setCurrencyInfo.bind(this),this.handleCurrencyRegistered=this.handleCurrencyRegistered.bind(this)}initialize(){return Bo(this,void 0,void 0,function*(){this.idl=(0,Y0.getGmLogsIDL)(this.programId),this.provider=new ps.AnchorProvider(this.connection,null,{commitment:this.commitment}),this.program=new ps.Program(this.idl,this.programId,this.provider,{instruction:new ps.BorshInstructionCoder(this.idl),accounts:new ps.BorshAccountsCoder(this.idl),state:null,events:new ps.BorshEventCoder(this.idl)}),yield this.setCurrencyInfo();const e=this.program.addEventListener(Ro.GmLogs.InitializeMemo,this.handleOrderCreated),t=this.program.addEventListener(Ro.GmLogs.ExchangeMemo,this.handleOrderExchanged),n=this.program.addEventListener(Ro.GmLogs.CancelOrderMemo,this.handleOrderCanceled),i=this.program.addEventListener(Ro.GmLogs.RegisterCurrencyMemo,this.handleCurrencyRegistered);this.eventListeners.push(e,t,n,i)})}end(){return Bo(this,void 0,void 0,function*(){for(const e of this.eventListeners)yield this.program.removeEventListener(e);this.eventListeners=[],this.onEvent=null})}setEventHandler(e){this.onEvent=e;for(const t of this.queuedEvents)this.onEvent(t.eventType,t.order,t.slotContext)}setCurrencyInfo(){return Bo(this,void 0,void 0,function*(){const t=yield new H0.GmClientService().getRegisteredCurrencies(this.connection,this.programId,!0);for(const n of t)this.registeredCurrencyInfo[n.mint]=n})}getParsedOrderFromEvent(e,t){const n=this.registeredCurrencyInfo[e.currencyMint.toString()];if(!n)return null;const{decimals:i}=n;return new Zc.Order({id:e.orderId.toString(),orderType:e.orderSide===0?Zc.OrderSide.Buy:Zc.OrderSide.Sell,orderMint:e.assetMint.toString(),currencyMint:e.currencyMint.toString(),currencyDecimals:i,price:e.price,orderQtyRemaining:e.orderRemainingQty.toNumber(),orderOriginationQty:e.orderOriginationQty.toNumber(),owner:e.orderInitializerPubkey.toString(),ownerAssetTokenAccount:e.initializerAssetTokenAccount.toString(),ownerCurrencyTokenAccount:e.initializerCurrencyTokenAccount.toString(),createdAt:e.createdAtTimestamp.toNumber(),slotContext:t})}handleOrderCreated(e,t){this.processEvent(eu.GmEventType.orderAdded,this.getParsedOrderFromEvent(e,t),t)}handleOrderExchanged(e,t){this.processEvent(eu.GmEventType.orderModified,this.getParsedOrderFromEvent(e,t),t)}handleOrderCanceled(e,t){this.processEvent(eu.GmEventType.orderRemoved,this.getParsedOrderFromEvent(e,t),t)}processEvent(e,t,n){if(!this.onEvent){this.queuedEvents.push({eventType:e,order:t,slotContext:n});return}this.onEvent(e,t,n)}handleCurrencyRegistered(){return Bo(this,void 0,void 0,function*(){yield this.setCurrencyInfo()})}}uo.GmEventService=Q0;var di=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(ac,"__esModule",{value:!0});ac.GmOrderbookService=void 0;const J0=F0,X0=Sf.exports,Z0=uc,tu=ss,sf=os,of=uo;class dc{constructor(e,t,n=60){this.gmClientService=new sf.GmClientService,this.eventCallBacks=[],this.changeObserverDisposer=null,this.lastEventTimestamp=this.getNow(),this.isReloading=!1,this.connection=e,this.marketplaceProgramId=t,this.healthcheckThreshold=n,this.orderCacheService=new Z0.OrderCacheService,this.gmClientService=new sf.GmClientService,this.gmEventService=new of.GmEventService(this.connection,this.marketplaceProgramId),this.handleMarketplaceEvent=this.handleMarketplaceEvent.bind(this)}initialize(){return di(this,void 0,void 0,function*(){return yield this.gmEventService.initialize(),this.changeObserverDisposer=(0,J0.queueProcessor)(this.orderCacheService.orderChanges,e=>{this.eventCallBacks.forEach(t=>t.onEvent(e))},250),this.gmEventService.setEventHandler(this.handleMarketplaceEvent),yield this.loadInitialOrders(),this.healthcheckTimer=setInterval(()=>{!this.getIsServiceHealthy()&&!this.isReloading&&this.resetOrdersData()},dc.HEALTH_CHECK_RATE),this.orderCacheService.mints.length})}end(){return di(this,void 0,void 0,function*(){return yield this.gmEventService.end(),this.eventCallBacks=[],this.changeObserverDisposer=null,!0})}getIsServiceHealthy(){return this.getNow()-this.lastEventTimestamp<=this.healthcheckThreshold}resetOrdersData(){return di(this,void 0,void 0,function*(){this.isReloading||(this.isReloading=!0,yield this.resetEventService(),yield this.refetchOrderData(),this.lastEventTimestamp=this.getNow(),this.isReloading=!1)})}resetEventService(){return di(this,void 0,void 0,function*(){yield this.gmEventService.end(),this.gmEventService=new of.GmEventService(this.connection,this.marketplaceProgramId),this.gmEventService.setEventHandler(this.handleMarketplaceEvent),yield this.gmEventService.initialize()})}refetchOrderData(){return di(this,void 0,void 0,function*(){const e=this.orderCacheService.getAllOrdersCache();try{const t=yield this.connection.getSlot("confirmed"),n=yield this.gmClientService.getAllOpenOrders(this.connection,this.marketplaceProgramId),i=new Map;for(const s of n){i.set(s.id,s);const o=e.get(s.id);o?o&&o.orderQtyRemaining!==s.orderQtyRemaining&&this.updateOrderInCache(s):this.addOrderToCache(s)}for(const s of Array.from(e.values()))s.slotContext<t&&!i.get(s.id)&&this.removeOrderFromCache(s)}catch(t){console.log("There was an error refreshing all marketplace data",t)}})}addOnEventHandler(e){this.eventCallBacks.push(e)}removeOnEventHandler(e){(0,X0.pull)(this.eventCallBacks,e)}loadInitialOrders(){return di(this,void 0,void 0,function*(){try{const e=yield this.gmClientService.getAllOpenOrders(this.connection,this.marketplaceProgramId);for(const t of e)this.addOrderToCache(t)}catch(e){console.log(e)}return this.orderCacheService.getAllOrdersCache().size})}addOrderToCache(e){return this.orderCacheService.addOrder(e)}removeOrderFromCache(e){return this.orderCacheService.cancelOrder(e)}updateOrderInCache(e){return this.orderCacheService.updateOrder(e)}getBuyOrders(){return this.orderCacheService.buyOrdersCache}getBuyOrdersForMint(e){return this.orderCacheService.buyOrdersCache.get(e)}getSellOrders(){return this.orderCacheService.sellOrdersCache}getSellOrdersForMint(e){return this.orderCacheService.sellOrdersCache.get(e)}getOrdersByType(e){return e==="buy"?this.getBuyOrders():this.getSellOrders()}getBuyOrdersByCurrencyAndItem(e,t){const n=this.getBuyOrdersForMint(t);if(!n)return[];const i=[...n.values()];return i.length?this.filterOrdersByCurrency(e,i):[]}getSellOrdersByCurrencyAndItem(e,t){const n=this.getSellOrdersForMint(t);if(!n)return[];const i=[...n.values()];return i.length?this.filterOrdersByCurrency(e,i):[]}filterOrdersByCurrency(e,t){return t.length?t.filter(n=>n.currencyMint===e):[]}getOrderById(e){return this.orderCacheService.getOrderById(e)}getAllOrdersByItemMint(e){const t=new Map,n=this.getSellOrdersForMint(e),i=this.getBuyOrdersForMint(e);if(n)for(const s of n.values())t.set(s.id,s);if(i)for(const s of i.values())t.set(s.id,s);return t}getAllMints(){return this.orderCacheService.mints}getAllOrdersForUserAddress(e){const t=this.orderCacheService.getAllOrdersCache();return Array.from(t.values()).filter(s=>s.owner===e)}handleOrderAddedEvent(e){this.addOrderToCache(e)}handleOrderModifiedEvent(e){if(e.orderQtyRemaining===0){this.removeOrderFromCache(e);return}this.updateOrderInCache(e)}handleOrderCanceledEvent(e){this.removeOrderFromCache(e)}handleMarketplaceEvent(e,t){if(!!t)switch(this.lastEventTimestamp=this.getNow(),e){case tu.GmEventType.orderAdded:this.handleOrderAddedEvent(t);break;case tu.GmEventType.orderModified:this.handleOrderModifiedEvent(t);break;case tu.GmEventType.orderRemoved:this.handleOrderCanceledEvent(t);break}}getNow(){return new Date().getTime()/1e3}}ac.GmOrderbookService=dc;dc.HEALTH_CHECK_RATE=5e3;(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(ac,r),t(os,r),t(uo,r)})(Vy);(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(wl,r),t(_r,r),t(ss,r),t(Ht,r),t(qa,r),t(Vy,r)})(vl);var jy=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Fr,"__esModule",{value:!0});Fr.createAccountTransaction=Fr.createAccountInstruction=void 0;const ya=Ke,Ku=Xn,qy=vl;function e1(r,e,t,n){return jy(this,void 0,void 0,function*(){const i=(0,qy.getGmIDL)(n),s=new ya.AnchorProvider(r,null,null),o=new ya.Program(i,n,s);return Ku.SystemProgram.createAccount({fromPubkey:e,newAccountPubkey:t.publicKey,space:o.account.orderAccount.size,lamports:yield r.getMinimumBalanceForRentExemption(o.account.orderAccount.size),programId:n})})}Fr.createAccountInstruction=e1;function t1(r,e,t,n){return jy(this,void 0,void 0,function*(){const i=(0,qy.getGmIDL)(n),s=new ya.AnchorProvider(r,null,null),o=new ya.Program(i,n,s),a=new Ku.Transaction({recentBlockhash:(yield r.getLatestBlockhash()).blockhash,feePayer:e});return a.add(Ku.SystemProgram.createAccount({fromPubkey:e,newAccountPubkey:t.publicKey,space:o.account.orderAccount.size,lamports:yield r.getMinimumBalanceForRentExemption(o.account.orderAccount.size),programId:n})),a})}Fr.createAccountTransaction=t1;(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(ut,r),t(za,r),t(Fr,r)})(yn);var n1=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Ea,"__esModule",{value:!0});Ea.harvestRewardsInstruction=void 0;const r1=Ke,i1=Yr,s1=yn,o1=Gt;function a1({connection:r,user:e,rewardMint:t,registeredStake:n,stakingAccount:i,programId:s}){return n1(this,void 0,void 0,function*(){const o=(0,o1.getStakingProgram)({connection:r,programId:s}),a={signers:[],instructions:[]};let c=null,l=null;const u=yield(0,s1.getTokenAccount)(r,e,t);c=u.tokenAccount,"createInstruction"in u&&a.instructions.push(...u.createInstruction),c instanceof r1.web3.Keypair?(l=c.publicKey,a.signers.push(c)):l=c;const h=yield(0,i1.associatedAddress)({owner:n,mint:t}),b=yield o.methods.harvest().accounts({user:e,rewardMint:t,registeredStake:n,stakingAccount:i,userRewardAccount:l,rewardAta:h}).instruction();return a.instructions.push(b),a})}Ea.harvestRewardsInstruction=a1;var fc={},c1=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(fc,"__esModule",{value:!0});fc.createInitializeStakingInstruction=void 0;const u1=Gt;function l1({connection:r,updateAuthorityAccount:e,programId:t}){return c1(this,void 0,void 0,function*(){const n=(0,u1.getStakingProgram)({connection:r,programId:t}),i={signers:[],instructions:[]},s=yield n.methods.initializeStaking().accounts({updateAuthorityAccount:e}).instruction();return i.instructions.push(s),i})}fc.createInitializeStakingInstruction=l1;var hc={},pc={},Lt={},wt={};Object.defineProperty(wt,"__esModule",{value:!0});wt.ESCROW_AUTH=wt.STAKING_VARS=wt.STAKING_ESCROW=wt.STAKING_ACCOUNT=wt.REWARD_AUTH=wt.REWARD_ACCOUNT=wt.REGISTERED_STAKE=void 0;wt.REGISTERED_STAKE=ae.Buffer.from("registered-stake");wt.REWARD_ACCOUNT=ae.Buffer.from("reward-account");wt.REWARD_AUTH=ae.Buffer.from("reward-vault-authority");wt.STAKING_ACCOUNT=ae.Buffer.from("staking-account");wt.STAKING_ESCROW=ae.Buffer.from("staking-escrow");wt.STAKING_VARS=ae.Buffer.from("staking-vars");wt.ESCROW_AUTH=ae.Buffer.from("escrow-auth");var as=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Lt,"__esModule",{value:!0});Lt.getRewardAuth=Lt.getTokenEscrow=Lt.getStakingVarsAccount=Lt.getStakingAccountsForRegisteredStake=Lt.getStakingAccount=Lt.getRegisteredStake=void 0;const af=Ke,lo=Xn,d1=Gt,fo=wt;function f1(r,e,t,n){return as(this,void 0,void 0,function*(){return lo.PublicKey.findProgramAddress([fo.REGISTERED_STAKE,e.toBuffer(),t.toBuffer(),n.toBuffer()],r)})}Lt.getRegisteredStake=f1;function h1(r,e,t){return as(this,void 0,void 0,function*(){return lo.PublicKey.findProgramAddress([fo.STAKING_ACCOUNT,e.toBuffer(),t.toBuffer()],r)})}Lt.getStakingAccount=h1;function p1(r,e,t){return as(this,void 0,void 0,function*(){const n=new af.AnchorProvider(r,null,null),i=(0,d1.getStakingIdl)(e),s=new af.Program(i,e,n),o=[{dataSize:171},{memcmp:{offset:40,bytes:t.toBase58()}}];return yield s.account.stakingAccount.all(o)})}Lt.getStakingAccountsForRegisteredStake=p1;function y1(r){return as(this,void 0,void 0,function*(){return lo.PublicKey.findProgramAddress([fo.STAKING_VARS],r)})}Lt.getStakingVarsAccount=y1;function g1(r,e,t){return as(this,void 0,void 0,function*(){return lo.PublicKey.findProgramAddress([fo.STAKING_ESCROW,e.toBuffer(),t.toBuffer()],r)})}Lt.getTokenEscrow=g1;function m1(r,e){return as(this,void 0,void 0,function*(){return lo.PublicKey.findProgramAddress([fo.REWARD_AUTH,e.toBuffer()],r)})}Lt.getRewardAuth=m1;var yr={},Dl=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(yr,"__esModule",{value:!0});yr.getStakingVarsAccountInfo=yr.getStakingAccountInfo=yr.getRegisteredStakeAccountInfo=void 0;const Vl=Dr,b1=Lt;function v1(r,e,t){return Dl(this,void 0,void 0,function*(){return yield(0,Vl.getStakingProgram)({connection:r,programId:t}).account.registeredStake.fetch(e)})}yr.getRegisteredStakeAccountInfo=v1;function w1(r,e,t){return Dl(this,void 0,void 0,function*(){return yield(0,Vl.getStakingProgram)({connection:r,programId:t}).account.stakingAccount.fetch(e)})}yr.getStakingAccountInfo=w1;function _1(r,e){return Dl(this,void 0,void 0,function*(){const t=(0,Vl.getStakingProgram)({connection:r,programId:e}),[n]=yield(0,b1.getStakingVarsAccount)(e);return yield t.account.stakingVars.fetch(n)})}yr.getStakingVarsAccountInfo=_1;(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Lt,r),t(yr,r),t(wt,r)})(pc);var A1=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(hc,"__esModule",{value:!0});hc.registerStakeInstruction=void 0;const cf=Ke,S1=Yr,k1=pc,I1=Gt;function E1({connection:r,authority:e,rewardMultiplier:t,stakeMint:n,rewardMint:i,cooldownPeriod:s,programId:o}){return A1(this,void 0,void 0,function*(){const a=(0,I1.getStakingProgram)({connection:r,programId:o}),c={instructions:[],signers:[]},[l]=yield(0,k1.getRegisteredStake)(o,e,n,i),u=yield(0,S1.associatedAddress)({owner:l,mint:i}),h=yield a.methods.registerStake(new cf.BN(t),new cf.BN(s)).accounts({authority:e,stakeMint:n,rewardMint:i,rewardAta:u}).instruction();return c.instructions.push(h),c})}hc.registerStakeInstruction=E1;var yc={},O1=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(yc,"__esModule",{value:!0});yc.createSettleStakingAccountInstruction=void 0;const P1=Gt;function T1({connection:r,authority:e,registeredStake:t,stakingAccount:n,updatedStakingPeriod:i,programId:s}){return O1(this,void 0,void 0,function*(){const o=(0,P1.getStakingProgram)({connection:r,programId:s}),a={instructions:[],signers:[]},c=yield o.methods.settle(i).accounts({authority:e,registeredStake:t,stakingAccount:n}).instruction();return a.instructions.push(c),a})}yc.createSettleStakingAccountInstruction=T1;var gc={},B1=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(gc,"__esModule",{value:!0});gc.stakeTokensInstruction=void 0;const R1=Yr,x1=Gt;function M1({connection:r,user:e,stakeMint:t,tokenSource:n,stakeQuantity:i,registeredStake:s,stakingAccount:o,programId:a}){return B1(this,void 0,void 0,function*(){const c=(0,x1.getStakingProgram)({connection:r,programId:a}),l=yield(0,R1.associatedAddress)({owner:o,mint:t}),u={instructions:[],signers:[]},h=yield c.methods.stakeTokens(i).accounts({user:e,stakeMint:t,tokenSource:n,registeredStake:s,tokenEscrow:l}).instruction();return u.instructions.push(h),u})}gc.stakeTokensInstruction=M1;var mc={},C1=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(mc,"__esModule",{value:!0});mc.unstakeTokensInstruction=void 0;const K1=Ke,L1=Yr,N1=yn,D1=pc,V1=Gt;function z1({connection:r,user:e,registeredStake:t,stakingAccount:n,programId:i}){return C1(this,void 0,void 0,function*(){const s=(0,V1.getStakingProgram)({connection:r,programId:i}),o={signers:[],instructions:[]},c=(yield(0,D1.getRegisteredStakeAccountInfo)(r,t,i)).rewardMint;let l=null,u=null;const h=yield(0,N1.getTokenAccount)(r,e,c);l=h.tokenAccount,"createInstruction"in h&&o.instructions.push(...h.createInstruction),l instanceof K1.web3.Keypair?(u=l.publicKey,o.signers.push(l)):u=l;const b=yield(0,L1.associatedAddress)({owner:t,mint:c}),w=yield s.methods.unstakeTokens().accounts({user:e,rewardMint:c,registeredStake:t,stakingAccount:n,userRewardAccount:u,rewardAta:b}).instruction();return o.instructions.push(w),o})}mc.unstakeTokensInstruction=z1;var bc={},F1=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(bc,"__esModule",{value:!0});bc.updateCooldownPeriodInstruction=void 0;const U1=Ke,$1=Gt;function W1({connection:r,authority:e,registeredStake:t,cooldownPeriod:n,programId:i}){return F1(this,void 0,void 0,function*(){const s=(0,$1.getStakingProgram)({connection:r,programId:i}),o={instructions:[],signers:[]},a=yield s.methods.updateCooldownPeriod(new U1.BN(n)).accounts({authority:e,registeredStake:t}).instruction();return o.instructions.push(a),o})}bc.updateCooldownPeriodInstruction=W1;var vc={},j1=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(vc,"__esModule",{value:!0});vc.updateRewardMultiplierInstruction=void 0;const q1=Ke,G1=Gt;function H1({connection:r,authority:e,rewardMultiplier:t,registeredStake:n,newStakingPeriod:i,programId:s}){return j1(this,void 0,void 0,function*(){const o=(0,G1.getStakingProgram)({connection:r,programId:s}),a={instructions:[],signers:[]},c=yield o.methods.updateRewardMultiplier(new q1.BN(t),i).accounts({authority:e,registeredStake:n}).instruction();return a.instructions.push(c),a})}vc.updateRewardMultiplierInstruction=H1;var wc={},Y1=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(wc,"__esModule",{value:!0});wc.withdrawTokensInstruction=void 0;const Q1=Ke,J1=Yr,X1=Gt,Z1=yn;function eI({connection:r,authority:e,user:t,stakeMint:n,registeredStake:i,stakingAccount:s,programId:o}){return Y1(this,void 0,void 0,function*(){const a=(0,X1.getStakingProgram)({connection:r,programId:o}),c=yield(0,J1.associatedAddress)({owner:s,mint:n}),l={signers:[],instructions:[]};let u=null,h=null;const b=yield(0,Z1.getTokenAccount)(r,t,n);u=b.tokenAccount,"createInstruction"in b&&l.instructions.push(...b.createInstruction),u instanceof Q1.web3.Keypair?(h=u.publicKey,l.signers.push(u)):h=u;const w=yield a.methods.withdrawTokens().accounts({user:t,authority:e,stakeMint:n,tokenSource:h,registeredStake:i,stakingAccount:s,tokenEscrow:c}).instruction();return l.instructions.push(w),l})}wc.withdrawTokensInstruction=eI;(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(If,r),t(ba,r),t(Ia,r),t(Ea,r),t(fc,r),t(hc,r),t(yc,r),t(gc,r),t(mc,r),t(bc,r),t(vc,r),t(wc,r)})(kf);var Gy={},Hy={};Object.defineProperty(Hy,"__esModule",{value:!0});(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(Gs,r),t(Hy,r)})(Gy);(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(kf,r),t(pc,r),t(Gy,r),t(Gt,r)})(ma);var Yy={};(function(r){var e=T&&T.__awaiter||function(h,b,w,k){function g(_){return _ instanceof w?_:new w(function(I){I(_)})}return new(w||(w=Promise))(function(_,I){function L(Q){try{$(k.next(Q))}catch(v){I(v)}}function G(Q){try{$(k.throw(Q))}catch(v){I(v)}}function $(Q){Q.done?_(Q.value):g(Q.value).then(L,G)}$((k=k.apply(h,b||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.getPlayersOfFaction=r.getAllPlayers=r.getPlayer=r.enlistToFaction=r.getPlayerFactionPDA=r.getIDL=r.FactionType=void 0;const t=Ke,n={version:"0.0.0",name:"enlist_to_faction",instructions:[{name:"processEnlistPlayer",accounts:[{name:"playerFactionAccount",isMut:!0,isSigner:!1},{name:"playerAccount",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"factionId",type:"u8"}]}],accounts:[{name:"PlayerFactionData",type:{kind:"struct",fields:[{name:"owner",type:"publicKey"},{name:"enlistedAtTimestamp",type:"i64"},{name:"factionId",type:"u8"},{name:"bump",type:"u8"},{name:"padding",type:{array:["u64",5]}}]}}],errors:[{code:300,name:"FactionTypeError",msg:"Faction ID must be 0, 1, or 2."}],metadata:{}},i="FACTION_ENLISTMENT";(function(h){h[h.Unenlisted=-1]="Unenlisted",h[h.MUD=0]="MUD",h[h.ONI=1]="ONI",h[h.Ustur=2]="Ustur"})(r.FactionType||(r.FactionType={}));function s(h){const b=n;return b.metadata.address=h.toBase58(),b}r.getIDL=s;function o(h,b){return e(this,void 0,void 0,function*(){return t.web3.PublicKey.findProgramAddress([ae.Buffer.from(i,"utf8"),h.toBuffer()],b)})}r.getPlayerFactionPDA=o;function a(h,b,w,k){return e(this,void 0,void 0,function*(){const[g,_]=yield o(w,k),I=s(k),L=new t.AnchorProvider(h,null,null);return yield new t.Program(I,k,L).instruction.processEnlistPlayer(_,b,{accounts:{playerFactionAccount:g,playerAccount:w,systemProgram:t.web3.SystemProgram.programId,clock:t.web3.SYSVAR_CLOCK_PUBKEY}})})}r.enlistToFaction=a;function c(h,b,w){return e(this,void 0,void 0,function*(){const k=new t.AnchorProvider(h,null,null),g=s(w),_=new t.Program(g,w,k),[I]=yield o(b,w);return yield _.account.playerFactionData.fetch(I)})}r.getPlayer=c;function l(h,b){return e(this,void 0,void 0,function*(){const w=new t.AnchorProvider(h,null,null),k=s(b);return(yield new t.Program(k,b,w).account.playerFactionData.all()).map(L=>L.account)})}r.getAllPlayers=l;function u(h,b,w){return e(this,void 0,void 0,function*(){const k=new t.AnchorProvider(h,null,null),g=s(w);return(yield new t.Program(g,w,k).account.playerFactionData.all()).map(G=>G.account).filter(G=>G.factionId==b)})}r.getPlayersOfFaction=u})(Yy);var Qy={},_c={};Object.defineProperty(_c,"__esModule",{value:!0});_c.gumDropIdl=void 0;_c.gumDropIdl={version:"0.0.0",name:"merkle_distributor",instructions:[{name:"newDistributor",accounts:[{name:"base",isMut:!1,isSigner:!0},{name:"distributor",isMut:!0,isSigner:!1},{name:"payer",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"root",type:{array:["u8",32]}},{name:"temporal",type:"publicKey"}]},{name:"closeDistributor",accounts:[{name:"base",isMut:!1,isSigner:!0},{name:"distributor",isMut:!0,isSigner:!1},{name:"distributorWallet",isMut:!0,isSigner:!1},{name:"receiver",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"walletBump",type:"u8"}]},{name:"claim",accounts:[{name:"distributor",isMut:!0,isSigner:!1},{name:"claimStatus",isMut:!0,isSigner:!1},{name:"from",isMut:!0,isSigner:!1},{name:"to",isMut:!0,isSigner:!1},{name:"temporal",isMut:!1,isSigner:!0},{name:"payer",isMut:!1,isSigner:!0},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"index",type:"u64"},{name:"amount",type:"u64"},{name:"claimantSecret",type:"publicKey"},{name:"proof",type:{vec:{array:["u8",32]}}}]},{name:"claimCandy",accounts:[{name:"distributor",isMut:!0,isSigner:!1},{name:"distributorWallet",isMut:!0,isSigner:!1},{name:"claimCount",isMut:!0,isSigner:!1},{name:"temporal",isMut:!1,isSigner:!0},{name:"payer",isMut:!1,isSigner:!0},{name:"candyMachineConfig",isMut:!1,isSigner:!1},{name:"candyMachine",isMut:!0,isSigner:!1},{name:"candyMachineWallet",isMut:!0,isSigner:!1},{name:"candyMachineMint",isMut:!0,isSigner:!1},{name:"candyMachineMetadata",isMut:!0,isSigner:!1},{name:"candyMachineMasterEdition",isMut:!0,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"tokenMetadataProgram",isMut:!1,isSigner:!1},{name:"candyMachineProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1}],args:[{name:"walletBump",type:"u8"},{name:"claimBump",type:"u8"},{name:"index",type:"u64"},{name:"amount",type:"u64"},{name:"claimantSecret",type:"publicKey"},{name:"proof",type:{vec:{array:["u8",32]}}}]}],accounts:[{name:"MerkleDistributor",type:{kind:"struct",fields:[{name:"base",type:"publicKey"},{name:"bump",type:"u8"},{name:"root",type:{array:["u8",32]}},{name:"temporal",type:"publicKey"}]}},{name:"ClaimStatus",type:{kind:"struct",fields:[{name:"isClaimed",type:"bool"},{name:"claimant",type:"publicKey"},{name:"claimedAt",type:"i64"},{name:"amount",type:"u64"}]}},{name:"ClaimCount",type:{kind:"struct",fields:[{name:"count",type:"u64"},{name:"claimant",type:"publicKey"}]}},{name:"CandyMachine",type:{kind:"struct",fields:[{name:"authority",type:"publicKey"},{name:"wallet",type:"publicKey"},{name:"tokenMint",type:{option:"publicKey"}},{name:"config",type:"publicKey"},{name:"data",type:{defined:"CandyMachineData"}},{name:"itemsRedeemed",type:"u64"},{name:"bump",type:"u8"}]}}],types:[{name:"CandyMachineData",type:{kind:"struct",fields:[{name:"uuid",type:"string"},{name:"price",type:"u64"},{name:"itemsAvailable",type:"u64"},{name:"goLiveDate",type:{option:"i64"}}]}}],events:[{name:"ClaimedEvent",fields:[{name:"index",type:"u64",index:!1},{name:"claimant",type:"publicKey",index:!1},{name:"amount",type:"u64",index:!1}]}],errors:[{code:300,name:"InvalidProof",msg:"Invalid Merkle proof."},{code:301,name:"DropAlreadyClaimed",msg:"Drop already claimed."},{code:302,name:"Unauthorized",msg:"Account is not authorized to execute this instruction"},{code:303,name:"OwnerMismatch",msg:"Token account owner did not match intended owner"},{code:304,name:"TemporalMismatch",msg:"Temporal signer did not match distributor"}]};(function(r){var e=T&&T.__createBinding||(Object.create?function(g,_,I,L){L===void 0&&(L=I);var G=Object.getOwnPropertyDescriptor(_,I);(!G||("get"in G?!_.__esModule:G.writable||G.configurable))&&(G={enumerable:!0,get:function(){return _[I]}}),Object.defineProperty(g,L,G)}:function(g,_,I,L){L===void 0&&(L=I),g[L]=_[I]}),t=T&&T.__setModuleDefault||(Object.create?function(g,_){Object.defineProperty(g,"default",{enumerable:!0,value:_})}:function(g,_){g.default=_}),n=T&&T.__importStar||function(g){if(g&&g.__esModule)return g;var _={};if(g!=null)for(var I in g)I!=="default"&&Object.prototype.hasOwnProperty.call(g,I)&&e(_,g,I);return t(_,g),_},i=T&&T.__awaiter||function(g,_,I,L){function G($){return $ instanceof I?$:new I(function(Q){Q($)})}return new(I||(I=Promise))(function($,Q){function v(N){try{R(L.next(N))}catch(M){Q(M)}}function O(N){try{R(L.throw(N))}catch(M){Q(M)}}function R(N){N.done?$(N.value):G(N.value).then(v,O)}R((L=L.apply(g,_||[])).next())})};Object.defineProperty(r,"__esModule",{value:!0}),r.claimTokenInstructions=r.getMultipleClaimStatusAccounts=r.getClaimStatusAccount=r.getClaimStatusKey=void 0;const s=Ke,o=Qs,a=n(ge),c=ut,l=_c,u=new s.web3.PublicKey("gdrpGjVffourzkdDRrQmySw4aTHr8a3xmQzzxSwFD1a"),h=(g,_,I=u)=>i(void 0,void 0,void 0,function*(){return yield s.web3.PublicKey.findProgramAddress([ae.Buffer.from("ClaimStatus"),g.toArrayLike(ae.Buffer,"le",8),_.toBuffer()],I)});r.getClaimStatusKey=h;const b=(g,_,I,L=u)=>i(void 0,void 0,void 0,function*(){const G=new s.AnchorProvider(g,null,null),$=new s.Program(l.gumDropIdl,L,G),Q=yield(0,r.getClaimStatusKey)(_,I,L);try{return yield $.account.claimStatus.fetch(Q[0])}catch{return null}});r.getClaimStatusAccount=b;const w=(g,_,I,L=u)=>i(void 0,void 0,void 0,function*(){const G=new s.AnchorProvider(g,null,null),$=new s.Program(l.gumDropIdl,L,G),Q=_.map(R=>(0,r.getClaimStatusKey)(R,I,L)),v=(yield Promise.all(Q)).map(R=>R[0]);return yield $.account.claimStatus.fetchMultiple(v)});r.getMultipleClaimStatusAccounts=w;const k=g=>i(void 0,void 0,void 0,function*(){const{connection:_,claimUrl:I,playerPublicKey:L,programId:G}=g,$=new URLSearchParams(I.split("?")[1]),Q=$.get("distributor"),v=$.get("handle"),O=$.get("amount"),R=$.get("index"),N=$.get("proof"),M=$.get("tokenAcc");if(!Q||!v||!O||!R||!N||!M)throw new Error("Invalid claim");const J=N===""?[]:N.split(",").map(En=>{const xt=ae.Buffer.from(a.decode(En));if(xt.length!==32)throw new Error("Invalid proof hash length");return xt}),re=new s.web3.PublicKey(Q),S=new s.web3.PublicKey(M),K=yield _.getAccountInfo(S);if(K===null)throw new Error("Could not fetch distributor token account");const U=o.AccountLayout.decode(K.data),ue=new s.web3.PublicKey(U.mint),X=new s.web3.PublicKey(v),le=yield(0,c.getAssociatedTokenAddress)(X,ue),yt=yield _.getParsedTokenAccountsByOwner(X,{mint:ue}),Rt=new s.BN(R),oe=new s.BN(O),[me,vt]=yield(0,r.getClaimStatusKey)(Rt,re,G),kt=new s.AnchorProvider(_,null,null),gt=new s.Program(l.gumDropIdl,G,kt),Ge=[];return yt.value.length===0&&Ge.push(o.Token.createAssociatedTokenAccountInstruction(o.ASSOCIATED_TOKEN_PROGRAM_ID,o.TOKEN_PROGRAM_ID,ue,le,X,L)),Ge.push(gt.instruction.claim(vt,Rt,oe,L,J,{accounts:{distributor:re,claimStatus:me,from:S,to:le,temporal:L,payer:L,tokenProgram:o.TOKEN_PROGRAM_ID,systemProgram:s.web3.SystemProgram.programId}})),Ge});r.claimTokenInstructions=k})(Qy);var Z={},Ac={};Object.defineProperty(Ac,"__esModule",{value:!0});Ac.baseIdl=void 0;Ac.baseIdl={version:"0.0.0",name:"score",instructions:[{name:"processInitialize",accounts:[{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"scoreVarsAccount",isMut:!0,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"treasuryTokenAccount",isMut:!0,isSigner:!1},{name:"treasuryAuthorityAccount",isMut:!1,isSigner:!1},{name:"atlasMint",isMut:!1,isSigner:!1},{name:"fuelMint",isMut:!1,isSigner:!1},{name:"foodMint",isMut:!1,isSigner:!1},{name:"armsMint",isMut:!1,isSigner:!1},{name:"toolkitMint",isMut:!1,isSigner:!1}],args:[{name:"bump",type:"u8"},{name:"treasuryBump",type:"u8"},{name:"treasuryAuthBump",type:"u8"}]},{name:"processRegisterShip",accounts:[{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!0,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1}],args:[{name:"scorevarsShipBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"rewardRatePerSecond",type:"u64"},{name:"fuelMaxReserve",type:"u32"},{name:"foodMaxReserve",type:"u32"},{name:"armsMaxReserve",type:"u32"},{name:"toolkitMaxReserve",type:"u32"},{name:"millisecondsToBurnOneFuel",type:"u32"},{name:"millisecondsToBurnOneFood",type:"u32"},{name:"millisecondsToBurnOneArms",type:"u32"},{name:"millisecondsToBurnOneToolkit",type:"u32"}]},{name:"processDeregisterShip",accounts:[{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!0,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"}]},{name:"processUpdateRewardRate",accounts:[{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!0,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"newRewardRatePerSecond",type:"u64"}]},{name:"processInitialDeposit",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"playerFactionAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"shipTokenAccountSource",isMut:!0,isSigner:!1},{name:"shipTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"shipQuantity",type:"u64"}]},{name:"processPartialDeposit",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"shipTokenAccountSource",isMut:!0,isSigner:!1},{name:"shipTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"shipQuantity",type:"u64"}]},{name:"processRefuel",accounts:[{name:"tokenOwnerAccount",isMut:!1,isSigner:!0},{name:"playerAccount",isMut:!1,isSigner:!1},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"fuelMint",isMut:!1,isSigner:!1},{name:"fuelTokenAccountSource",isMut:!0,isSigner:!1},{name:"fuelTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"fuelQuantity",type:"u64"}]},{name:"processRefeed",accounts:[{name:"tokenOwnerAccount",isMut:!1,isSigner:!0},{name:"playerAccount",isMut:!1,isSigner:!1},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"foodMint",isMut:!1,isSigner:!1},{name:"foodTokenAccountSource",isMut:!0,isSigner:!1},{name:"foodTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"foodQuantity",type:"u64"}]},{name:"processRearm",accounts:[{name:"tokenOwnerAccount",isMut:!1,isSigner:!0},{name:"playerAccount",isMut:!1,isSigner:!1},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"armsMint",isMut:!1,isSigner:!1},{name:"armsTokenAccountSource",isMut:!0,isSigner:!1},{name:"armsTokenAccountEscrow",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"armsQuantity",type:"u64"}]},{name:"processRepair",accounts:[{name:"tokenOwnerAccount",isMut:!1,isSigner:!0},{name:"playerAccount",isMut:!1,isSigner:!1},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"rent",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"toolkitMint",isMut:!0,isSigner:!1},{name:"toolkitTokenAccountSource",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"toolkitQuantity",type:"u64"}]},{name:"processSettle",accounts:[{name:"playerAccount",isMut:!1,isSigner:!1},{name:"updateAuthorityAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"}]},{name:"processHarvest",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"playerAtlasTokenAccount",isMut:!0,isSigner:!1},{name:"treasuryTokenAccount",isMut:!0,isSigner:!1},{name:"treasuryAuthorityAccount",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"treasuryBump",type:"u8"},{name:"treasuryAuthBump",type:"u8"}]},{name:"processWithdrawFuel",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"fuelTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"fuelTokenAccountReturn",isMut:!0,isSigner:!1},{name:"fuelMint",isMut:!0,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"}]},{name:"processWithdrawFood",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"foodTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"foodTokenAccountReturn",isMut:!0,isSigner:!1},{name:"foodMint",isMut:!0,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"}]},{name:"processWithdrawArms",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"armsTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"armsTokenAccountReturn",isMut:!0,isSigner:!1},{name:"armsMint",isMut:!0,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"}]},{name:"processWithdrawShips",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"scoreVarsShipAccount",isMut:!1,isSigner:!1},{name:"playerAtlasTokenAccount",isMut:!0,isSigner:!1},{name:"shipTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"shipTokenAccountReturn",isMut:!0,isSigner:!1},{name:"toolkitTokenAccountSource",isMut:!0,isSigner:!1},{name:"treasuryTokenAccount",isMut:!0,isSigner:!1},{name:"treasuryAuthorityAccount",isMut:!1,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"toolkitMint",isMut:!0,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"scorevarsShipBump",type:"u8"},{name:"escrowAuthBump",type:"u8"},{name:"escrowBump",type:"u8"},{name:"treasuryAuthBump",type:"u8"},{name:"treasuryBump",type:"u8"}]},{name:"processCloseAccounts",accounts:[{name:"playerAccount",isMut:!1,isSigner:!0},{name:"shipStakingAccount",isMut:!0,isSigner:!1},{name:"scoreVarsAccount",isMut:!1,isSigner:!1},{name:"shipTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"fuelTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"foodTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"armsTokenAccountEscrow",isMut:!0,isSigner:!1},{name:"escrowAuthority",isMut:!1,isSigner:!1},{name:"tokenProgram",isMut:!1,isSigner:!1},{name:"systemProgram",isMut:!1,isSigner:!1},{name:"shipMint",isMut:!1,isSigner:!1},{name:"fuelMint",isMut:!1,isSigner:!1},{name:"foodMint",isMut:!1,isSigner:!1},{name:"armsMint",isMut:!1,isSigner:!1},{name:"clock",isMut:!1,isSigner:!1}],args:[{name:"stakingBump",type:"u8"},{name:"scorevarsBump",type:"u8"},{name:"shipBump",type:"u8"},{name:"fuelBump",type:"u8"},{name:"foodBump",type:"u8"},{name:"armsBump",type:"u8"},{name:"escrowAuthBump",type:"u8"}]}],accounts:[{name:"ScoreVars",type:{kind:"struct",fields:[{name:"updateAuthorityMaster",type:"publicKey"},{name:"fuelMint",type:"publicKey"},{name:"foodMint",type:"publicKey"},{name:"armsMint",type:"publicKey"},{name:"toolkitMint",type:"publicKey"}]}},{name:"ScoreVarsShip",type:{kind:"struct",fields:[{name:"shipMint",type:"publicKey"},{name:"rewardRatePerSecond",type:"u64"},{name:"fuelMaxReserve",type:"u32"},{name:"foodMaxReserve",type:"u32"},{name:"armsMaxReserve",type:"u32"},{name:"toolkitMaxReserve",type:"u32"},{name:"millisecondsToBurnOneFuel",type:"u32"},{name:"millisecondsToBurnOneFood",type:"u32"},{name:"millisecondsToBurnOneArms",type:"u32"},{name:"millisecondsToBurnOneToolkit",type:"u32"}]}},{name:"ShipStaking",type:{kind:"struct",fields:[{name:"owner",type:"publicKey"},{name:"factionId",type:"u8"},{name:"shipMint",type:"publicKey"},{name:"shipQuantityInEscrow",type:"u64"},{name:"fuelQuantityInEscrow",type:"u64"},{name:"foodQuantityInEscrow",type:"u64"},{name:"armsQuantityInEscrow",type:"u64"},{name:"fuelCurrentCapacity",type:"u64"},{name:"foodCurrentCapacity",type:"u64"},{name:"armsCurrentCapacity",type:"u64"},{name:"healthCurrentCapacity",type:"u64"},{name:"stakedAtTimestamp",type:"i64"},{name:"fueledAtTimestamp",type:"i64"},{name:"fedAtTimestamp",type:"i64"},{name:"armedAtTimestamp",type:"i64"},{name:"repairedAtTimestamp",type:"i64"},{name:"currentCapacityTimestamp",type:"i64"},{name:"totalTimeStaked",type:"u64"},{name:"stakedTimePaid",type:"u64"},{name:"pendingRewards",type:"u64"},{name:"totalRewardsPaid",type:"u64"}]}}],types:[{name:"Resource",type:{kind:"enum",variants:[{name:"Arms"},{name:"Fuel"},{name:"Food"},{name:"Toolkits"}]}}],errors:[{code:300,name:"ScorevarsNotInitialized",msg:"Scorevars auth is not initialized"},{code:301,name:"ScorevarsAuthInvalid",msg:"Scorevars auth invalid"},{code:302,name:"FactionTypeError",msg:"Faction ID must be 0, 1, or 2."},{code:303,name:"InvalidShipError",msg:"Invalid Ship Mint"},{code:304,name:"InvalidResourceError",msg:"Invalid Resource Mint"},{code:305,name:"ZeroResourceError",msg:"Resource Quantity must be >0."},{code:306,name:"ZeroShipError",msg:"Ship Quantity must be >0."},{code:307,name:"NumericalOverflowError",msg:"Numerical overflow error"},{code:308,name:"ResourceAmountTooSmall",msg:"Resource Amount Too Small, would add 0 seconds to capacity"},{code:309,name:"InvalidScoreVarsAccount",msg:"Invalid ScoreVars account for ship Staking Account given"},{code:310,name:"InvalidResourceWithdraw",msg:"Invalid Resource Withdraw, nothing to withdraw"},{code:311,name:"InvalidShipStakingOwner",msg:"Invalid Ship Staking Owner"},{code:312,name:"InvalidShipWithdraw",msg:"Invalid Ship Withdraw"},{code:313,name:"NotEnoughToolkits",msg:"Not enough toolkits for Ship Withdraw"},{code:314,name:"EscrowAccountNotZero",msg:"Escrow account must be 0 to close accounts"},{code:315,name:"IncorrectTokenAccountOwner",msg:"Token account does not have correct owner!"},{code:316,name:"UninitializedTokenAccount",msg:"Token or Mint Account is not initialized!"},{code:317,name:"IncorrectTokenAccountMint",msg:"Token or Mint Account mint is not correct!"}],metadata:{}};var Sc={};Object.defineProperty(Sc,"__esModule",{value:!0});Sc.scoreLogBaseIdl=void 0;Sc.scoreLogBaseIdl={version:"0.0.0",name:"score_logs",instructions:[],events:[{name:"ProcessInitialDepositMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"factionId",type:"u8",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"stakedAtTimestamp",type:"i64",index:!1}]},{name:"ProcessPartialDepositMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"previousShipQuantity",type:"u64",index:!1},{name:"addedShipQuantity",type:"u64",index:!1},{name:"newShipQuantity",type:"u64",index:!1},{name:"partialDepositTimestamp",type:"i64",index:!1}]},{name:"ProcessRearmMemo",fields:[{name:"tokenOwnerAccount",type:"publicKey",index:!1},{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"armsQuantityToDeposit",type:"u64",index:!1},{name:"armedAtTimestamp",type:"i64",index:!1}]},{name:"ProcessRefeedMemo",fields:[{name:"tokenOwnerAccount",type:"publicKey",index:!1},{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"foodQuantityToDeposit",type:"u64",index:!1},{name:"fedAtTimestamp",type:"i64",index:!1}]},{name:"ProcessRefuelMemo",fields:[{name:"tokenOwnerAccount",type:"publicKey",index:!1},{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"fuelQuantityToDeposit",type:"u64",index:!1},{name:"fueledAtTimestamp",type:"i64",index:!1}]},{name:"ProcessRepairMemo",fields:[{name:"tokenOwnerAccount",type:"publicKey",index:!1},{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"toolkitQuantityToDeposit",type:"u64",index:!1},{name:"repairedAtTimestamp",type:"i64",index:!1}]},{name:"ProcessHarvestMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"stakedTimePaid",type:"u64",index:!1},{name:"rewardPayout",type:"u64",index:!1},{name:"totalRewardsPaid",type:"u64",index:!1},{name:"harvestTimestamp",type:"i64",index:!1}]},{name:"ProcessSettleMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"stakedTimePaid",type:"u64",index:!1},{name:"totalRewardsPaid",type:"u64",index:!1},{name:"settleTimestamp",type:"i64",index:!1}]},{name:"ProcessArmsWithdrawMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"armsQuantityWithdrawn",type:"u64",index:!1},{name:"armsWithdrawTimestamp",type:"i64",index:!1}]},{name:"ProcessFoodWithdrawMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"foodQuantityWithdrawn",type:"u64",index:!1},{name:"foodWithdrawTimestamp",type:"i64",index:!1}]},{name:"ProcessFuelWithdrawMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"fuelQuantityWithdrawn",type:"u64",index:!1},{name:"fuelWithdrawTimestamp",type:"i64",index:!1}]},{name:"ProcessWithdrawShipsMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"shipQuantity",type:"u64",index:!1},{name:"stakedTimePaid",type:"u64",index:!1},{name:"totalRewardsPaid",type:"u64",index:!1},{name:"shipsWithdrawTimestamp",type:"i64",index:!1}]},{name:"ProcessCloseAccountMemo",fields:[{name:"playerAccount",type:"publicKey",index:!1},{name:"shipMint",type:"publicKey",index:!1},{name:"accountClosedTimestamp",type:"i64",index:!1}]}]};var Be=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})};Object.defineProperty(Z,"__esModule",{value:!0});Z.closeAccountsInstruction=Z.createWithdrawShipsInstruction=Z.createWithdrawArmsInstruction=Z.createWithdrawFoodInstruction=Z.createWithdrawFuelInstruction=Z.createHarvestInstruction=Z.createSettleInstruction=Z.createRepairInstruction=Z.createRefuelInstruction=Z.createRefeedInstruction=Z.createRearmInstruction=Z.createPartialDepositInstruction=Z.createInitialDepositInstruction=Z.createUpdateRewardRateInstruction=Z.createDeregisterShipInstruction=Z.createRegisterShipInstruction=Z.createScoreVarsInitializeInstruction=Z.getAllFleetsForUserPublicKey=Z.getAllFleets=Z.getAllRegisteredShips=Z.getScoreTreasuryAuthAccount=Z.getScoreTreasuryTokenAccount=Z.getScoreVarsShipInfo=Z.decodeEvent=Z.getShipStakingAccountInfo=Z.getScoreVarsInfo=Z.getShipStakingAccount=Z.getScoreEscrowAuthAccount=Z.getScoreEscrowAccount=Z.getScoreVarsShipAccount=Z.getScoreVarsAccount=Z.getScoreIDL=void 0;const W=Ke,sn=Qs,Jy=Xn,tI=Mt,nI=Ac,rI=Sc,Nr=yn;function qe(r){const e=nI.baseIdl;return e.metadata.address=r.toBase58(),e}Z.getScoreIDL=qe;function Tt(r){return Be(this,void 0,void 0,function*(){return W.web3.PublicKey.findProgramAddress([ae.Buffer.from("SCOREVARS")],r)})}Z.getScoreVarsAccount=Tt;function St(r,e){return Be(this,void 0,void 0,function*(){return W.web3.PublicKey.findProgramAddress([ae.Buffer.from("SCOREVARS_SHIP"),e.toBuffer()],r)})}Z.getScoreVarsShipAccount=St;function Wt(r,e,t,n){return Be(this,void 0,void 0,function*(){const i=[ae.Buffer.from("SCORE_ESCROW"),n.toBuffer(),e.toBuffer()];return t!==null&&i.push(t.toBuffer()),W.web3.PublicKey.findProgramAddress(i,r)})}Z.getScoreEscrowAccount=Wt;function In(r,e,t){return Be(this,void 0,void 0,function*(){return W.web3.PublicKey.findProgramAddress([ae.Buffer.from("SCORE_ESCROW_AUTHORITY"),t.toBuffer(),e.toBuffer()],r)})}Z.getScoreEscrowAuthAccount=In;function Bt(r,e,t){return Be(this,void 0,void 0,function*(){return W.web3.PublicKey.findProgramAddress([ae.Buffer.from("SCORE_INFO"),t.toBuffer(),e.toBuffer()],r)})}Z.getShipStakingAccount=Bt;function iI(r,e){return Be(this,void 0,void 0,function*(){const t=new W.AnchorProvider(r,null,null),n=qe(e),i=new W.Program(n,e,t),[s]=yield Tt(e);return yield i.account.scoreVars.fetch(s)})}Z.getScoreVarsInfo=iI;function sI(r,e,t,n){return Be(this,void 0,void 0,function*(){const i=new W.AnchorProvider(r,null,null),s=qe(e),o=new W.Program(s,e,i),[a]=yield Bt(e,t,n);return yield o.account.shipStaking.fetch(a)})}Z.getShipStakingAccountInfo=sI;function oI(r,e,t){return Be(this,void 0,void 0,function*(){const n=new W.AnchorProvider(r,null,null);return new W.Program(rI.scoreLogBaseIdl,e,n).coder.events.decode(t)})}Z.decodeEvent=oI;function aI(r,e,t){return Be(this,void 0,void 0,function*(){const n=new W.AnchorProvider(r,null,null),i=qe(e),s=new W.Program(i,e,n),[o]=yield St(e,t);return yield s.account.scoreVarsShip.fetch(o)})}Z.getScoreVarsShipInfo=aI;function kc(r){return Be(this,void 0,void 0,function*(){return W.web3.PublicKey.findProgramAddress([ae.Buffer.from("SCORE_TREASURY")],r)})}Z.getScoreTreasuryTokenAccount=kc;function Ic(r){return Be(this,void 0,void 0,function*(){return W.web3.PublicKey.findProgramAddress([ae.Buffer.from("SCORE_TREASURY_AUTHORITY")],r)})}Z.getScoreTreasuryAuthAccount=Ic;function cI(r,e){return Be(this,void 0,void 0,function*(){const t=qe(e),n=new W.AnchorProvider(r,null,null),s=yield new W.Program(t,e,n).account.scoreVarsShip.all(),o=[];for(const a of s)o.push(a.account);return o})}Z.getAllRegisteredShips=cI;function uI(r,e){return Be(this,void 0,void 0,function*(){const t=qe(e),n=new W.AnchorProvider(r,null,null),s=yield new W.Program(t,e,n).account.shipStaking.all(),o=[];for(const a of s)o.push(a.account);return o})}Z.getAllFleets=uI;function lI(r,e,t){return Be(this,void 0,void 0,function*(){const n=qe(t),i=new W.AnchorProvider(r,null,null),s=new W.Program(n,t,i),o=yield s.account.scoreVarsShip.all(),a=[];for(const u of o){const[h]=yield Bt(t,u.account.shipMint,e);a.push(h)}return(yield s.account.shipStaking.fetchMultiple(a)).filter(u=>u!==null).map(u=>u)})}Z.getAllFleetsForUserPublicKey=lI;function dI(r,e,t,n,i,s,o,a){return Be(this,void 0,void 0,function*(){const c=qe(a),l=new W.AnchorProvider(r,null,null),u=new W.Program(c,a,l),[h,b]=yield kc(a),[w,k]=yield Ic(a),[g,_]=yield Tt(a);return yield u.instruction.processInitialize(_,b,k,{accounts:{updateAuthorityAccount:e,scoreVarsAccount:g,tokenProgram:sn.TOKEN_PROGRAM_ID,systemProgram:Jy.SystemProgram.programId,rent:W.web3.SYSVAR_RENT_PUBKEY,treasuryTokenAccount:h,treasuryAuthorityAccount:w,atlasMint:t,fuelMint:n,foodMint:i,armsMint:s,toolkitMint:o},signers:[]})})}Z.createScoreVarsInitializeInstruction=dI;function fI(r,e,t,n,i,s,o,a,c,l,u,h,b){return Be(this,void 0,void 0,function*(){const w=qe(b),k=new W.AnchorProvider(r,null,null),g=new W.Program(w,b,k),[_,I]=yield St(b,t),[L,G]=yield Tt(b);return yield g.instruction.processRegisterShip(G,I,new W.BN(h),n,i,s,o,a,c,l,u,{accounts:{updateAuthorityAccount:e,scoreVarsAccount:L,scoreVarsShipAccount:_,shipMint:t,systemProgram:Jy.SystemProgram.programId},signers:[]})})}Z.createRegisterShipInstruction=fI;function hI(r,e,t,n){return Be(this,void 0,void 0,function*(){const i=qe(n),s=new W.AnchorProvider(r,null,null),o=new W.Program(i,n,s),[a,c]=yield St(n,t),[l,u]=yield Tt(n);return yield o.instruction.processDeregisterShip(u,c,{accounts:{updateAuthorityAccount:e,scoreVarsAccount:l,scoreVarsShipAccount:a,shipMint:t},signers:[]})})}Z.createDeregisterShipInstruction=hI;function pI(r,e,t,n,i){return Be(this,void 0,void 0,function*(){const s=qe(i),o=new W.AnchorProvider(r,null,null),a=new W.Program(s,i,o),[c,l]=yield St(i,t),[u,h]=yield Tt(i);return yield a.instruction.processUpdateRewardRate(h,l,new W.BN(n),{accounts:{updateAuthorityAccount:e,scoreVarsAccount:u,scoreVarsShipAccount:c,shipMint:t},signers:[]})})}Z.createUpdateRewardRateInstruction=pI;function yI(r,e,t,n,i,s,o=new W.web3.PublicKey("FACTNmq2FhA2QNTnGM2aWJH3i7zT3cND5CgvjYTjyVYe")){return Be(this,void 0,void 0,function*(){const[a,c]=yield In(s,n,e),[l,u]=yield Wt(s,n,null,e),[h,b]=yield Bt(s,n,e),[w,k]=yield St(s,n),[g]=yield(0,tI.getPlayerFactionPDA)(e,o),_=qe(s),I=new W.AnchorProvider(r,null,null);return yield new W.Program(_,s,I).instruction.processInitialDeposit(b,k,c,u,new W.BN(t),{accounts:{playerAccount:e,shipStakingAccount:h,scoreVarsShipAccount:w,playerFactionAccount:g,escrowAuthority:a,systemProgram:W.web3.SystemProgram.programId,tokenProgram:sn.TOKEN_PROGRAM_ID,clock:W.web3.SYSVAR_CLOCK_PUBKEY,rent:W.web3.SYSVAR_RENT_PUBKEY,shipMint:n,shipTokenAccountSource:i,shipTokenAccountEscrow:l}})})}Z.createInitialDepositInstruction=yI;function gI(r,e,t,n,i,s){return Be(this,void 0,void 0,function*(){const[o,a]=yield In(s,n,e),[c,l]=yield Wt(s,n,null,e),[u,h]=yield Bt(s,n,e),[b,w]=yield St(s,n),k=qe(s),g=new W.AnchorProvider(r,null,null);return yield new W.Program(k,s,g).instruction.processPartialDeposit(h,w,a,l,new W.BN(t),{accounts:{playerAccount:e,shipStakingAccount:u,scoreVarsShipAccount:b,escrowAuthority:o,systemProgram:W.web3.SystemProgram.programId,tokenProgram:sn.TOKEN_PROGRAM_ID,clock:W.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n,shipTokenAccountSource:i,shipTokenAccountEscrow:c}})})}Z.createPartialDepositInstruction=gI;function mI(r,e,t,n,i,s,o,a){return Be(this,void 0,void 0,function*(){const[c,l]=yield In(a,i,t),[u,h]=yield Wt(a,i,s,t),[b,w]=yield Bt(a,i,t),[k,g]=yield St(a,i),[_,I]=yield Tt(a),L=qe(a),G=new W.AnchorProvider(r,null,null);return yield new W.Program(L,a,G).instruction.processRearm(w,I,g,l,h,new W.BN(n),{accounts:{tokenOwnerAccount:e,playerAccount:t,shipStakingAccount:b,scoreVarsAccount:_,scoreVarsShipAccount:k,escrowAuthority:c,systemProgram:W.web3.SystemProgram.programId,tokenProgram:sn.TOKEN_PROGRAM_ID,clock:W.web3.SYSVAR_CLOCK_PUBKEY,rent:W.web3.SYSVAR_RENT_PUBKEY,shipMint:i,armsMint:s,armsTokenAccountSource:o,armsTokenAccountEscrow:u}})})}Z.createRearmInstruction=mI;function bI(r,e,t,n,i,s,o,a){return Be(this,void 0,void 0,function*(){const[c,l]=yield In(a,i,t),[u,h]=yield Wt(a,i,s,t),[b,w]=yield Bt(a,i,t),[k,g]=yield St(a,i),[_,I]=yield Tt(a),L=qe(a),G=new W.AnchorProvider(r,null,null);return yield new W.Program(L,a,G).instruction.processRefeed(w,I,g,l,h,new W.BN(n),{accounts:{tokenOwnerAccount:e,playerAccount:t,shipStakingAccount:b,scoreVarsAccount:_,scoreVarsShipAccount:k,escrowAuthority:c,systemProgram:W.web3.SystemProgram.programId,tokenProgram:sn.TOKEN_PROGRAM_ID,clock:W.web3.SYSVAR_CLOCK_PUBKEY,rent:W.web3.SYSVAR_RENT_PUBKEY,shipMint:i,foodMint:s,foodTokenAccountSource:o,foodTokenAccountEscrow:u}})})}Z.createRefeedInstruction=bI;function vI(r,e,t,n,i,s,o,a){return Be(this,void 0,void 0,function*(){const[c,l]=yield In(a,i,t),[u,h]=yield Wt(a,i,s,t),[b,w]=yield Bt(a,i,t),[k,g]=yield St(a,i),[_,I]=yield Tt(a),L=qe(a),G=new W.AnchorProvider(r,null,null);return yield new W.Program(L,a,G).instruction.processRefuel(w,I,g,l,h,new W.BN(n),{accounts:{tokenOwnerAccount:e,playerAccount:t,shipStakingAccount:b,scoreVarsAccount:_,scoreVarsShipAccount:k,escrowAuthority:c,systemProgram:W.web3.SystemProgram.programId,tokenProgram:sn.TOKEN_PROGRAM_ID,clock:W.web3.SYSVAR_CLOCK_PUBKEY,rent:W.web3.SYSVAR_RENT_PUBKEY,shipMint:i,fuelMint:s,fuelTokenAccountSource:o,fuelTokenAccountEscrow:u}})})}Z.createRefuelInstruction=vI;function wI(r,e,t,n,i,s,o,a){return Be(this,void 0,void 0,function*(){const[c,l]=yield Bt(a,i,t),[u,h]=yield St(a,i),[b,w]=yield Tt(a),k=qe(a),g=new W.AnchorProvider(r,null,null);return yield new W.Program(k,a,g).instruction.processRepair(l,w,h,new W.BN(n),{accounts:{tokenOwnerAccount:e,playerAccount:t,shipStakingAccount:c,scoreVarsAccount:b,scoreVarsShipAccount:u,systemProgram:W.web3.SystemProgram.programId,tokenProgram:sn.TOKEN_PROGRAM_ID,clock:W.web3.SYSVAR_CLOCK_PUBKEY,rent:W.web3.SYSVAR_RENT_PUBKEY,shipMint:i,toolkitMint:s,toolkitTokenAccountSource:o}})})}Z.createRepairInstruction=wI;function _I(r,e,t,n,i){return Be(this,void 0,void 0,function*(){const[s,o]=yield Bt(i,n,e),[a,c]=yield St(i,n),[l,u]=yield Tt(i),h=qe(i),b=new W.AnchorProvider(r,null,null);return yield new W.Program(h,i,b).instruction.processSettle(o,u,c,{accounts:{playerAccount:e,updateAuthorityAccount:t,shipStakingAccount:s,scoreVarsShipAccount:a,scoreVarsAccount:l,clock:W.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}})})}Z.createSettleInstruction=_I;function AI(r,e,t,n,i){return Be(this,void 0,void 0,function*(){const[s,o]=yield Bt(i,n,e),[a,c]=yield St(i,n),[l,u]=yield kc(i),[h,b]=yield Ic(i),w=qe(i),k=new W.AnchorProvider(r,null,null),g=new W.Program(w,i,k),_={signers:[],instructions:[]};let I;const L=yield(0,Nr.getTokenAccount)(r,e,t),G=L.tokenAccount;"createInstruction"in L&&_.instructions.push(...L.createInstruction),G instanceof W.web3.Keypair?(I=G.publicKey,_.signers.push(G)):I=G;const $=yield g.instruction.processHarvest(o,c,u,b,{accounts:{playerAccount:e,shipStakingAccount:s,scoreVarsShipAccount:a,playerAtlasTokenAccount:I,treasuryTokenAccount:l,treasuryAuthorityAccount:h,tokenProgram:sn.TOKEN_PROGRAM_ID,clock:W.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}});return _.instructions.push($),_})}Z.createHarvestInstruction=AI;function SI(r,e,t,n,i){return Be(this,void 0,void 0,function*(){const[s,o]=yield In(i,n,e),[a,c]=yield Wt(i,n,t,e),[l,u]=yield Bt(i,n,e),[h,b]=yield St(i,n),[w,k]=yield Tt(i),g=qe(i),_=new W.AnchorProvider(r,null,null),I=new W.Program(g,i,_),L={signers:[],instructions:[]};let G;const $=yield(0,Nr.getTokenAccount)(r,e,t),Q=$.tokenAccount;"createInstruction"in $&&L.instructions.push(...$.createInstruction),Q instanceof W.web3.Keypair?(G=Q.publicKey,L.signers.push(Q)):G=Q;const v=yield I.instruction.processWithdrawFuel(u,k,b,o,c,{accounts:{playerAccount:e,shipStakingAccount:l,scoreVarsAccount:w,scoreVarsShipAccount:h,fuelTokenAccountEscrow:a,fuelTokenAccountReturn:G,fuelMint:t,escrowAuthority:s,tokenProgram:sn.TOKEN_PROGRAM_ID,clock:W.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}});return L.instructions.push(v),L})}Z.createWithdrawFuelInstruction=SI;function kI(r,e,t,n,i){return Be(this,void 0,void 0,function*(){const[s,o]=yield In(i,n,e),[a,c]=yield Wt(i,n,t,e),[l,u]=yield Bt(i,n,e),[h,b]=yield St(i,n),[w,k]=yield Tt(i),g=qe(i),_=new W.AnchorProvider(r,null,null),I=new W.Program(g,i,_),L={signers:[],instructions:[]};let G;const $=yield(0,Nr.getTokenAccount)(r,e,t),Q=$.tokenAccount;"createInstruction"in $&&L.instructions.push(...$.createInstruction),Q instanceof W.web3.Keypair?(G=Q.publicKey,L.signers.push(Q)):G=Q;const v=yield I.instruction.processWithdrawFood(u,k,b,o,c,{accounts:{playerAccount:e,shipStakingAccount:l,scoreVarsAccount:w,scoreVarsShipAccount:h,foodTokenAccountEscrow:a,foodTokenAccountReturn:G,foodMint:t,escrowAuthority:s,tokenProgram:sn.TOKEN_PROGRAM_ID,clock:W.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}});return L.instructions.push(v),L})}Z.createWithdrawFoodInstruction=kI;function II(r,e,t,n,i){return Be(this,void 0,void 0,function*(){const[s,o]=yield In(i,n,e),[a,c]=yield Wt(i,n,t,e),[l,u]=yield Bt(i,n,e),[h,b]=yield St(i,n),[w,k]=yield Tt(i),g=qe(i),_=new W.AnchorProvider(r,null,null),I=new W.Program(g,i,_),L={signers:[],instructions:[]};let G;const $=yield(0,Nr.getTokenAccount)(r,e,t),Q=$.tokenAccount;"createInstruction"in $&&L.instructions.push(...$.createInstruction),Q instanceof W.web3.Keypair?(G=Q.publicKey,L.signers.push(Q)):G=Q;const v=yield I.instruction.processWithdrawArms(u,k,b,o,c,{accounts:{playerAccount:e,shipStakingAccount:l,scoreVarsAccount:w,scoreVarsShipAccount:h,armsTokenAccountEscrow:a,armsTokenAccountReturn:G,armsMint:t,escrowAuthority:s,tokenProgram:sn.TOKEN_PROGRAM_ID,clock:W.web3.SYSVAR_CLOCK_PUBKEY,shipMint:n}});return L.instructions.push(v),L})}Z.createWithdrawArmsInstruction=II;function EI(r,e,t,n,i,s){return Be(this,void 0,void 0,function*(){const[o,a]=yield In(s,t,e),[c,l]=yield Wt(s,t,null,e),[u,h]=yield Bt(s,t,e),[b,w]=yield St(s,t),[k,g]=yield Tt(s),[_,I]=yield kc(s),[L,G]=yield Ic(s),$={signers:[],instructions:[]},Q=qe(s),v=new W.AnchorProvider(r,null,null),O=new W.Program(Q,s,v);let R;const N=yield(0,Nr.getTokenAccount)(r,e,n),M=N.tokenAccount;"createInstruction"in N&&$.instructions.push(...N.createInstruction),M instanceof W.web3.Keypair?(R=M.publicKey,$.signers.push(M)):R=M;let J;const re=yield(0,Nr.getTokenAccount)(r,e,t),S=re.tokenAccount;"createInstruction"in re&&$.instructions.push(...re.createInstruction),S instanceof W.web3.Keypair?(J=S.publicKey,$.signers.push(S)):J=S;let K;const U=yield(0,Nr.getTokenAccount)(r,e,i),ue=U.tokenAccount;"createInstruction"in U&&$.instructions.push(...U.createInstruction),ue instanceof W.web3.Keypair?(K=ue.publicKey,$.signers.push(ue)):K=ue;const X=yield O.instruction.processWithdrawShips(h,g,w,a,l,G,I,{accounts:{playerAccount:e,shipStakingAccount:u,scoreVarsAccount:k,scoreVarsShipAccount:b,playerAtlasTokenAccount:R,shipTokenAccountEscrow:c,shipTokenAccountReturn:J,toolkitTokenAccountSource:K,treasuryTokenAccount:_,treasuryAuthorityAccount:L,escrowAuthority:o,tokenProgram:sn.TOKEN_PROGRAM_ID,systemProgram:W.web3.SystemProgram.programId,clock:W.web3.SYSVAR_CLOCK_PUBKEY,shipMint:t,toolkitMint:i}});return $.instructions.push(X),$})}Z.createWithdrawShipsInstruction=EI;function OI(r,e,t,n,i,s,o){return Be(this,void 0,void 0,function*(){const[a,c]=yield In(o,t,e),[l,u]=yield Wt(o,t,null,e),[h,b]=yield Wt(o,t,n,e),[w,k]=yield Wt(o,t,i,e),[g,_]=yield Wt(o,t,s,e),[I,L]=yield Tt(o),[G,$]=yield Bt(o,t,e),Q=qe(o),v=new W.AnchorProvider(r,null,null);return yield new W.Program(Q,o,v).instruction.processCloseAccounts($,L,u,b,k,_,c,{accounts:{playerAccount:e,shipStakingAccount:G,scoreVarsAccount:I,shipTokenAccountEscrow:l,fuelTokenAccountEscrow:h,foodTokenAccountEscrow:w,armsTokenAccountEscrow:g,escrowAuthority:a,tokenProgram:sn.TOKEN_PROGRAM_ID,systemProgram:W.web3.SystemProgram.programId,shipMint:t,fuelMint:n,foodMint:i,armsMint:s,clock:W.web3.SYSVAR_CLOCK_PUBKEY}})})}Z.closeAccountsInstruction=OI;var Xy={};Object.defineProperty(Xy,"__esModule",{value:!0});var st={},Or=T&&T.__awaiter||function(r,e,t,n){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(u){try{l(n.next(u))}catch(h){o(h)}}function c(u){try{l(n.throw(u))}catch(h){o(h)}}function l(u){u.done?s(u.value):i(u.value).then(a,c)}l((n=n.apply(r,e||[])).next())})},PI=T&&T.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(st,"__esModule",{value:!0});st.sendTokens=st.confirmTokenBalance=st.createMint=st.mintTokens=st.createAssociatedTokenAccountInstruction=st.createRequestUnitsInstruction=st.Numberu32=st.createATokenAccount=st.getAtaForMint=void 0;const pn=Ke,Zt=Qs,TI=yn,uf=jo.exports,lf=PI(vg.exports);function Zy(r,e){return Or(this,void 0,void 0,function*(){return pn.web3.PublicKey.findProgramAddress([e.toBuffer(),Zt.TOKEN_PROGRAM_ID.toBuffer(),r.toBuffer()],Zt.ASSOCIATED_TOKEN_PROGRAM_ID)})}st.getAtaForMint=Zy;function BI(r,e,t,n){return Or(this,void 0,void 0,function*(){t=t||r.wallet.publicKey,n=n||r.wallet.publicKey;const[i]=yield Zy(e,n),s=new pn.web3.Transaction,o=yield tg(i,t,n,e);return s.add(o),yield r.sendAndConfirm(s),i})}st.createATokenAccount=BI;class eg extends lf.default{toBuffer(){const e=super.toArray().reverse(),t=ae.Buffer.from(e);if(t.length===4)return t;const n=ae.Buffer.alloc(4);return t.copy(n),n}static fromBuffer(e){return new lf.default([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}st.Numberu32=eg;function RI(r){return Or(this,void 0,void 0,function*(){const e=new eg(1e6),t=ae.Buffer.from([0]),n=e.toBuffer();return new pn.web3.TransactionInstruction({keys:[{pubkey:r,isSigner:!0,isWritable:!0}],programId:new pn.web3.PublicKey("ComputeBudget111111111111111111111111111111"),data:ae.Buffer.concat([t,n])})})}st.createRequestUnitsInstruction=RI;function tg(r,e,t,n){return Or(this,void 0,void 0,function*(){const i=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:pn.web3.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:Zt.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:pn.web3.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return new pn.web3.TransactionInstruction({keys:i,programId:Zt.ASSOCIATED_TOKEN_PROGRAM_ID,data:ae.Buffer.from([])})})}st.createAssociatedTokenAccountInstruction=tg;function xI(r,e,t,n,i){return Or(this,void 0,void 0,function*(){const s=new pn.web3.Transaction;return i=i||r.wallet.publicKey,s.add(Zt.Token.createMintToInstruction(Zt.TOKEN_PROGRAM_ID,e,t,i,[],n)),yield r.sendAndConfirm(s)})}st.mintTokens=xI;function MI(r,e,t,n){return Or(this,void 0,void 0,function*(){const i=pn.web3.Keypair.generate(),s=new pn.web3.Transaction,o=yield r.connection.getMinimumBalanceForRentExemption(Zt.MintLayout.span);t=t||r.wallet.publicKey,n=n||r.wallet.publicKey;const a=pn.web3.SystemProgram.createAccount({fromPubkey:r.wallet.publicKey,newAccountPubkey:i.publicKey,lamports:o,space:Zt.MintLayout.span,programId:Zt.TOKEN_PROGRAM_ID});s.add(a);const c=Zt.Token.createInitMintInstruction(Zt.TOKEN_PROGRAM_ID,i.publicKey,e,t,n);return s.add(c),yield r.sendAndConfirm(s,[i]),i.publicKey})}st.createMint=MI;function CI(r,e,t,n){return Or(this,void 0,void 0,function*(){const i=yield r.connection.getAccountInfo(e,"recent");if(n===!0&&(0,uf.strict)(i===null),i!==null){const s=(0,TI.byteArrayToLong)(i.data.slice(64,72));(0,uf.strict)(s==t,`On-chain Token amount of ${s} does not match expected amount ${t}`)}else console.log("Token account %s does not exist",e.toString())})}st.confirmTokenBalance=CI;function KI(r,e,t,n){return Or(this,void 0,void 0,function*(){const i=new pn.web3.Transaction;return i.add(Zt.Token.createTransferInstruction(Zt.TOKEN_PROGRAM_ID,e,t,r.wallet.publicKey,[],n)),yield r.sendAndConfirm(i)})}st.sendTokens=KI;(function(r){var e=T&&T.__createBinding||(Object.create?function(n,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(n,o,a)}:function(n,i,s,o){o===void 0&&(o=s),n[o]=i[s]}),t=T&&T.__exportStar||function(n,i){for(var s in n)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,n,s)};Object.defineProperty(r,"__esModule",{value:!0}),t(ma,r),t(Yy,r),t(Qy,r),t(vl,r),t(Z,r),t(Xy,r),t(st,r),t(Fr,r),t(yn,r)})(Mt);const xo=new we("ATLASXmbPQxBUYbxPsV97usA3fPQYEqzQBUHgiFCUsXx"),df=new we("poLisWXnNRwC6oBu1vHiuKQzFjGL4XDSu4g9qjz9qVk"),LI=new we("ATLkZsBofSKG845dNFpNoUyMciGpeH29BCbMqYFUoxzU"),sr=new we("ATLocKpzDbTokxgvnLew3d7drZkEzLzDpzwgrgWKDbmc");class NI{multisigPDA;vaultPDA;registeredStakeAtlas;stakingAccountAtlas;async init(e){this.multisigPDA=e,this._setVaultPDA(),await this._setRegisteredStakeAtlas(),await this._setStakingAccountAtlas()}_setVaultPDA(){const[e]=ru({multisigPda:new we(this.multisigPDA),index:0});this.vaultPDA=e}async _setRegisteredStakeAtlas(){const[e]=await Mt.getRegisteredStake(sr,LI,xo,df);this.registeredStakeAtlas=e}async _setStakingAccountAtlas(){const[e]=await Mt.getStakingAccount(sr,this.vaultPDA,this.registeredStakeAtlas);this.stakingAccountAtlas=e}async buildCreateStatingAccount(){return await Mt.createStakingAccountInstruction({connection:Ct().connection,user:this.vaultPDA,registeredStake:this.registeredStakeAtlas,programId:sr})}async buildStakeTokens(e){const[t]=we.findProgramAddressSync([this.vaultPDA.toBuffer(),wg.toBuffer(),xo.toBuffer()],xg.ASSOCIATED_PROGRAM_ID);return await Mt.stakeTokensInstruction({connection:Ct().connection,user:this.vaultPDA,stakeMint:xo,tokenSource:t,stakingAccount:this.stakingAccountAtlas,stakeQuantity:new Qn(parseFloat(e.toString())*Math.pow(10,DI)),registeredStake:this.registeredStakeAtlas,programId:sr})}async buildHarvestRewards(){return await Mt.harvestRewardsInstruction({connection:Ct().connection,user:this.vaultPDA,rewardMint:df,registeredStake:this.registeredStakeAtlas,stakingAccount:this.stakingAccountAtlas,programId:sr})}async buildWithdrawTokens(){return await Mt.withdrawTokensInstruction({connection:Ct().connection,user:this.vaultPDA,authority:this.vaultPDA,stakeMint:xo,registeredStake:this.registeredStakeAtlas,stakingAccount:this.stakingAccountAtlas,programId:sr})}async buildUnstakeTokens(){return await Mt.unstakeTokensInstruction({connection:Ct().connection,user:this.vaultPDA,registeredStake:this.registeredStakeAtlas,stakingAccount:this.stakingAccountAtlas,programId:sr})}async buildCancelUnstake(){return await Mt.cancelUnstakeInstruction({connection:Ct().connection,user:this.vaultPDA,registeredStake:this.registeredStakeAtlas,programId:sr})}}const fi="[ATLAS-LOCKER] ",DI=8,Ps=new we("ATLASXmbPQxBUYbxPsV97usA3fPQYEqzQBUHgiFCUsXx"),ga=new we("poLisWXnNRwC6oBu1vHiuKQzFjGL4XDSu4g9qjz9qVk"),Mo=new we("ATLocKpzDbTokxgvnLew3d7drZkEzLzDpzwgrgWKDbmc"),ff=new we("ATLkZsBofSKG845dNFpNoUyMciGpeH29BCbMqYFUoxzU"),Te=_g("globalStarAtlasLockerStore",{state:()=>({multisigPDA:Ag("multisigPDA",""),vaultPDA:{},multisigInfo:{},registeredStakeAtlas:{},registeredStakePolis:{},stakingAccountAtlas:{},stakingAccountAtlasInfo:{},atlas_balance_wallet:"0",polis_balance_wallet:"0",atlas_balance_squads:"0",polis_balance_squads:"0",atlas_balance_locker:"0",polis_balance_locker:"0",SAFactory_LockerAtlas:new NI}),getters:{getMultisigPDA(r){return new we(r.multisigPDA)},getVaultPDA(){try{const[r]=ru({multisigPda:new we(this.multisigPDA),index:0});return r}catch{return""}},getNewTransactionIndex(r){const e=Number(r.multisigInfo.transactionIndex);return BigInt(e+1)}},actions:{async setAccounts(){Te().atlas_balance_wallet="0",Te().polis_balance_wallet="0",Te().atlas_balance_squads="0",Te().polis_balance_squads="0",Te().atlas_balance_locker="0",Te().polis_balance_locker="0",Te().stakingAccountAtlasInfo=void 0;const[r]=ru({multisigPda:new we(this.multisigPDA),index:0});this.vaultPDA=r,this.multisigInfo=await Sg.fromAccountAddress(Ct().connection,new we(this.multisigPDA));const[e]=await Mt.getRegisteredStake(Mo,ff,Ps,ga);this.registeredStakeAtlas=e;const[t]=await Mt.getRegisteredStake(Mo,ff,Ps,ga);this.registeredStakePolis=t;try{const[n]=await Mt.getStakingAccount(Mo,this.vaultPDA,this.registeredStakeAtlas);this.stakingAccountAtlas=n}catch{}try{this.stakingAccountAtlasInfo=await Mt.getStakingAccountInfo(Ct().connection,this.stakingAccountAtlas,Mo)}catch{}await VI()},async build_CreateStatingAccount(){await this.SAFactory_LockerAtlas.init(this.multisigPDA),await hi(fi+"CreateStatingAccount: "+Bg,[(await this.SAFactory_LockerAtlas.buildCreateStatingAccount()).instructions[0]])},async build_StakeTokens(r){await this.SAFactory_LockerAtlas.init(this.multisigPDA),await hi(fi+"StakeTokens: "+r,[(await this.SAFactory_LockerAtlas.buildStakeTokens(r)).instructions[0]])},async build_harvestRewards(){await this.SAFactory_LockerAtlas.init(this.multisigPDA),await hi(fi+"HarvestRewards",[(await this.SAFactory_LockerAtlas.buildHarvestRewards()).instructions[0]])},async build_withdrawTokens(){await this.SAFactory_LockerAtlas.init(this.multisigPDA),await hi(fi+"WithdrawTokens",[(await this.SAFactory_LockerAtlas.buildWithdrawTokens()).instructions[0]])},async build_unstakeTokens(){await this.SAFactory_LockerAtlas.init(this.multisigPDA),await hi(fi+"UnstakeTokens",[(await this.SAFactory_LockerAtlas.buildUnstakeTokens()).instructions[0]])},async build_cancelUnstake(){await this.SAFactory_LockerAtlas.init(this.multisigPDA),await hi(fi+"CancelUnstake",[(await this.SAFactory_LockerAtlas.buildCancelUnstake()).instructions[0]])}}});async function hi(r,e){const{sendTransaction:t,publicKey:n}=Ts(),i=new kg({payerKey:Te().vaultPDA,recentBlockhash:(await Ct().connection.getLatestBlockhash()).blockhash,instructions:e}),s=Tg({multisigPda:new we(Te().multisigPDA),transactionIndex:Te().getNewTransactionIndex,creator:n.value,vaultIndex:0,ephemeralSigners:0,transactionMessage:i,memo:r});console.log("build: "+r);const o=await t(new Lu().add(s),Ct().connection);await Rg(o)}async function VI(){const{publicKey:r}=Ts();if(!r.value)return;const e=await ls(Ps,r.value),t=await ls(ga,r.value),n=await ls(Ps,Te().vaultPDA,!0),i=await ls(ga,Te().vaultPDA,!0),s=await ls(Ps,Te().stakingAccountAtlas,!0);try{Te().atlas_balance_wallet=(await Ct().connection.getTokenAccountBalance(e)).value.uiAmountString??"0"}catch{Te().atlas_balance_wallet="-"}try{Te().polis_balance_wallet=(await Ct().connection.getTokenAccountBalance(t)).value.uiAmountString??"0"}catch{Te().polis_balance_wallet="-"}try{Te().atlas_balance_squads=(await Ct().connection.getTokenAccountBalance(n)).value.uiAmountString??"0"}catch{Te().atlas_balance_squads="-"}try{Te().polis_balance_squads=(await Ct().connection.getTokenAccountBalance(i)).value.uiAmountString??"0"}catch{Te().polis_balance_squads="-"}try{Te().atlas_balance_locker=(await Ct().connection.getTokenAccountBalance(s)).value.uiAmountString??""}catch{Te().atlas_balance_locker="-"}}const zI={class:"row"},FI=Oe("div",{class:"col-3"},"Wallet",-1),UI={class:"col"},$I={class:"row q-gutter-x-xs no-wrap justify-end"},WI=Oe("div",null,"Atlas",-1),jI={class:"col"},qI={class:"row q-gutter-x-xs no-wrap justify-end"},GI=Oe("div",null,"Polis",-1),HI={class:"row"},YI=Oe("div",{class:"col-3"},"Squads",-1),QI={class:"col"},JI={class:"row q-gutter-x-xs no-wrap justify-end"},XI=Oe("div",null,"Atlas",-1),ZI={class:"col"},eE={class:"row q-gutter-x-xs no-wrap justify-end"},tE=Oe("div",null,"Polis",-1),nE={class:"row"},rE=Oe("div",{class:"col-3"},"Locker",-1),iE={class:"col"},sE={class:"row q-gutter-x-xs no-wrap justify-end"},oE=Oe("div",null,"Atlas",-1),aE={class:"col"},cE={class:"row q-gutter-x-xs no-wrap justify-end"},uE=Oe("div",null,"Polis",-1),lE=_f({__name:"TokenLockerBalances",setup(r){return Ig(async()=>{Ts().publicKey.value&&await Te().setAccounts()}),Eg(()=>Ts().publicKey.value,async()=>{await Te().setAccounts()}),(e,t)=>(Co(),Af(dg,{class:""},{default:Go(()=>[Tr(lg,null,{default:Go(()=>[Oe("div",zI,[FI,Oe("div",UI,[Oe("div",$I,[Oe("div",null,oi(or(Te)().atlas_balance_wallet),1),WI])]),Oe("div",jI,[Oe("div",qI,[Oe("div",null,oi(or(Te)().polis_balance_wallet),1),GI])])]),Oe("div",HI,[YI,Oe("div",QI,[Oe("div",JI,[Oe("div",null,oi(or(Te)().atlas_balance_squads),1),XI])]),Oe("div",ZI,[Oe("div",eE,[Oe("div",null,oi(or(Te)().polis_balance_squads),1),tE])])]),Oe("div",nE,[rE,Oe("div",iE,[Oe("div",sE,[Oe("div",null,oi(or(Te)().atlas_balance_locker),1),oE])]),Oe("div",aE,[Oe("div",cE,[Oe("div",null,oi(or(Te)().polis_balance_locker),1),uE])])])]),_:1})]),_:1}))}}),dE={key:0,class:"col absolute-center"},fE={key:1},hE=Oe("div",{class:"col"},null,-1),xE=_f({__name:"StarAtlasLocker",setup(r){const e=Og("setup");return(t,n)=>(Co(),Af(ug,{class:"bg-black"},{default:Go(()=>{var i,s;return[(s=(i=or(Ts)().publicKey)==null?void 0:i.value)!=null&&s.toString()?(Co(),Ul("div",fE,[Tr(cg,{modelValue:e.value,"onUpdate:modelValue":n[0]||(n[0]=o=>e.value=o),align:"left",class:""},{default:Go(()=>[Tr(Pc,{name:"setup",label:"Setup"}),Tr(Pc,{name:"atlas",label:"Atlas"}),Tr(Pc,{name:"polis",label:"Polis"}),hE,Tr(lE,{class:"q-pr-md col"})]),_:1},8,["modelValue"])])):(Co(),Ul("div",dE,[Tr(or(Pg),{dark:""})]))]}),_:1}))}});export{xE as default};
