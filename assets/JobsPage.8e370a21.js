import{Q as Y}from"./QSpace.278ed7ed.js";import{Q as B}from"./QBadge.f3fcc5f5.js";import{Q as K,a as E}from"./QCard.a53026b3.js";import{Q as ee}from"./QSeparator.9f81d464.js";import{Q as b}from"./QInput.22e9fcf8.js";import{I as le,C as P}from"./ClosePopup.e20b7235.js";import{bZ as te,J as y,ah as R,aF as D,aC as oe,cB as ae,aQ as ne,cN as ue,ck as h,dT as se,cp as F,au as X,b1 as g,ak as k,as as n,bx as d,ar as S,al as f,bz as O,V as M,a6 as $,aX as re,ei as ie,ai as x,aj as I,b7 as N,bV as j,a1 as _,bU as Q}from"./index.645fe979.js";import{Q as de}from"./QPage.a3c2b4d2.js";import{apiJsonBin as A}from"./axios.87b413d1.js";import{Q as ce,c as me}from"./QSelect.537f8571.js";import{Q as fe}from"./QCardActions.e21aeefc.js";function C(e,r=new WeakMap){if(Object(e)!==e)return e;if(r.has(e))return r.get(e);const t=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e instanceof Set?new Set:e instanceof Map?new Map:typeof e.constructor!="function"?Object.create(null):e.prototype!==void 0&&typeof e.prototype.constructor=="function"?e:new e.constructor;if(typeof e.constructor=="function"&&typeof e.valueOf=="function"){const i=e.valueOf();if(Object(i)!==i){const c=new e.constructor(i);return r.set(e,c),c}}return r.set(e,t),e instanceof Set?e.forEach(i=>{t.add(C(i,r))}):e instanceof Map&&e.forEach((i,c)=>{t.set(c,C(i,r))}),Object.assign(t,...Object.keys(e).map(i=>({[i]:C(e[i],r)})))}var U=te({name:"QPopupEdit",props:{modelValue:{required:!0},title:String,buttons:Boolean,labelSet:String,labelCancel:String,color:{type:String,default:"primary"},validate:{type:Function,default:()=>!0},autoSave:Boolean,cover:{type:Boolean,default:!0},disable:Boolean},emits:["update:modelValue","save","cancel","beforeShow","show","beforeHide","hide"],setup(e,{slots:r,emit:t}){const{proxy:i}=oe(),{$q:c}=i,l=y(null),a=y(""),s=y("");let V=!1;const w=R(()=>ae({initialValue:a.value,validate:e.validate,set:u,cancel:o,updatePosition:m},"value",()=>s.value,p=>{s.value=p}));function u(){e.validate(s.value)!==!1&&(q()===!0&&(t("save",s.value,a.value),t("update:modelValue",s.value)),J())}function o(){q()===!0&&t("cancel",s.value,a.value),J()}function m(){ne(()=>{l.value.updatePosition()})}function q(){return ue(s.value,a.value)===!1}function J(){V=!0,l.value.hide()}function z(){V=!1,a.value=C(e.modelValue),s.value=C(e.modelValue),t("beforeShow")}function G(){t("show")}function L(){V===!1&&q()===!0&&(e.autoSave===!0&&e.validate(s.value)===!0?(t("save",s.value,a.value),t("update:modelValue",s.value)):t("cancel",s.value,a.value)),t("beforeHide")}function Z(){t("hide")}function W(){const p=r.default!==void 0?[].concat(r.default(w.value)):[];return e.title&&p.unshift(D("div",{class:"q-dialog__title q-mt-sm q-mb-sm"},e.title)),e.buttons===!0&&p.push(D("div",{class:"q-popup-edit__buttons row justify-center no-wrap"},[D(h,{flat:!0,color:e.color,label:e.labelCancel||c.lang.label.cancel,onClick:o}),D(h,{flat:!0,color:e.color,label:e.labelSet||c.lang.label.set,onClick:u})])),p}return Object.assign(i,{set:u,cancel:o,show(p){l.value!==null&&l.value.show(p)},hide(p){l.value!==null&&l.value.hide(p)},updatePosition:m}),()=>{if(e.disable!==!0)return D(le,{ref:l,class:"q-popup-edit",cover:e.cover,onBeforeShow:z,onShow:G,onBeforeHide:L,onHide:Z,onEscapeKey:o},W)}}});const H="66b6b699e41b4d34e41e3c95",pe="$2a$10$pZ6Y26zPmmRlGZDWeqJFwuKB9DQq/sG6y3XJHupLKK.eTmS4lXls6",T={headers:{"X-Access-key":pe,"Content-Type":"application/json"}},v=se("jsonBin",{state:()=>({data:{}}),actions:{add(e){e.timestamp=Math.floor(Date.now()/1e3),v().data.record.push(e)},remove(e){this.data.record=this.data.record.filter(r=>r.timestamp!=e.timestamp)},read(){console.log(T),A.get(`/${H}/latest`,T).then(e=>{console.log(e),this.data=e.data}).catch(function(e){console.error(e)}),console.log("[jsonBin] get")},async update(){F().is_admin&&(A.put(`/${H}`,JSON.stringify(this.data.record),T).then(e=>console.log(e)).catch(function(e){console.error(e)}),console.log("[jsonBin] put"))}}}),ve={class:"row"},Ve=X({__name:"CreateNewJobDialog",props:["jobTypes"],setup(e){const r=y(!1),t=y({jobType:0}),i=R(()=>!(t.value.name&&t.value.description));return(c,l)=>(g(),k($,null,[n(h,{round:"",color:"primary",icon:"add",onClick:l[0]||(l[0]=a=>r.value=!0)}),n(me,{modelValue:r.value,"onUpdate:modelValue":l[7]||(l[7]=a=>r.value=a),class:"justify-center","backdrop-filter":"brightness(60%)"},{default:d(()=>[n(K,null,{default:d(()=>[n(E,{class:"row items-center q-pb-none text-h6"},{default:d(()=>[S(" Create new Job ")]),_:1}),n(E,null,{default:d(()=>[n(ce,{modelValue:t.value.jobType,"onUpdate:modelValue":l[1]||(l[1]=a=>t.value.jobType=a),options:e.jobTypes,"option-value":"id","option-label":"name","option-disable":"inactive",label:"JobType","emit-value":"","map-options":""},null,8,["modelValue","options"]),n(b,{modelValue:t.value.name,"onUpdate:modelValue":l[2]||(l[2]=a=>t.value.name=a),label:"Label"},null,8,["modelValue"]),n(b,{modelValue:t.value.description,"onUpdate:modelValue":l[3]||(l[3]=a=>t.value.description=a),label:"Description"},null,8,["modelValue"]),f("div",ve,[n(b,{modelValue:t.value.assigned,"onUpdate:modelValue":l[4]||(l[4]=a=>t.value.assigned=a),label:"Assigned"},null,8,["modelValue"]),n(b,{modelValue:t.value.reward,"onUpdate:modelValue":l[5]||(l[5]=a=>t.value.reward=a),label:"Reward"},null,8,["modelValue"])])]),_:1}),n(fe,{align:"right"},{default:d(()=>[O(n(h,{label:"Close",color:"primary"},null,512),[[P]]),O(n(h,{disable:i.value,label:"Add",color:"primary",onClick:l[6]||(l[6]=a=>M(v)().add(t.value))},null,8,["disable"]),[[P]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),ge={class:"row q-pb-sm"},be={class:"row q-gutter-x-sm"},ye=["onDrop"],we={class:"row items-center q-gutter-x-sm"},_e={class:"col text-h5"},he={class:"text-subtitle1 text-weight-light"},De={class:"row q-mb-md"},Se={class:"text-h6 col"},Ce={class:"row q-gutter-x-sm"},xe={class:"col text-subtitle1 text-weight-light"},Pe=X({__name:"JobsPage",setup(e){re(async()=>{let l=await v().read();console.log(l)});const r=y([{id:0,name:"Todo",description:"This hasn't been completed",color:"green"},{id:1,name:"In Progress",description:"This is actively worked on",color:"yellow-7"},{id:2,name:"Done",description:"This has been completed",color:"purple"}]);ie(()=>v().data.record,()=>{v().update()});const t=y(F().is_admin||!1);function i(l,a){l.dataTransfer.dropEffect="move",l.dataTransfer.effectAllowed="move",l.dataTransfer.setData("itemID",a.timestamp)}function c(l,a){const s=l.dataTransfer.getData("itemID"),V=v().data.record.findIndex(w=>w.timestamp==s);v().data.record[V].jobType=a}return(l,a)=>(g(),x(de,{class:"col q-pa-sm"},{default:d(()=>[f("div",ge,[n(Y),t.value?(g(),x(Ve,{key:0,"job-types":r.value},null,8,["job-types"])):I("",!0)]),f("div",be,[(g(!0),k($,null,N(r.value,s=>{var V,w;return g(),k("div",{class:"col",key:s,onDrop:u=>c(u,s.id),onDragover:a[0]||(a[0]=j(()=>{},["prevent"])),onDragenter:a[1]||(a[1]=j(()=>{},["prevent"]))},[n(K,{flat:"",square:"",class:"q-pa-sm"},{default:d(()=>[f("div",we,[f("div",_e,_(s.name),1),n(B,{rounded:"",color:s.color,"text-color":"black"},null,8,["color"])]),f("div",he,_(s.description),1)]),_:2},1024),n(ee),(g(!0),k($,null,N((w=(V=M(v)().data)==null?void 0:V.record)==null?void 0:w.filter(u=>u.jobType==s.id),u=>(g(),x(K,{flat:"",square:"",class:"q-pa-sm q-mt-sm",key:u.timestamp},{default:d(()=>[n(E,{draggable:"true",onDragstart:o=>i(o,u)},{default:d(()=>[f("div",De,[f("div",Se,[S(_(u.name)+" ",1),n(U,{modelValue:u.name,"onUpdate:modelValue":o=>u.name=o,"auto-save":""},{default:d(o=>[n(b,{modelValue:o.value,"onUpdate:modelValue":m=>o.value=m,dense:"",autofocus:"",counter:"",onKeyup:Q(o.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),t.value?(g(),x(h,{key:0,icon:"delete",flat:"",dense:"",size:"xs",onClick:o=>M(v)().remove(u)},null,8,["onClick"])):I("",!0)]),f("div",Ce,[f("div",xe,[S(_(u.description)+" ",1),n(U,{modelValue:u.description,"onUpdate:modelValue":o=>u.description=o,"auto-save":""},{default:d(o=>[n(b,{modelValue:o.value,"onUpdate:modelValue":m=>o.value=m,dense:"",autofocus:"",counter:"",onKeyup:Q(o.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),n(B,null,{default:d(()=>[S(_(u.assigned??"-none-")+" ",1),n(U,{modelValue:u.assigned,"onUpdate:modelValue":o=>u.assigned=o,"auto-save":""},{default:d(o=>[n(b,{modelValue:o.value,"onUpdate:modelValue":m=>o.value=m,dense:"",autofocus:"",counter:"",onKeyup:Q(o.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),n(B,{class:"justify-center",color:"grey"},{default:d(()=>[S(_(u.reward??"-none-")+" ",1),n(U,{modelValue:u.reward,"onUpdate:modelValue":o=>u.reward=o,"auto-save":""},{default:d(o=>[n(b,{modelValue:o.value,"onUpdate:modelValue":m=>o.value=m,dense:"",autofocus:"",counter:"",onKeyup:Q(o.set,["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeyup"])]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)])]),_:2},1032,["onDragstart"])]),_:2},1024))),128))],40,ye)}),128))])]),_:1}))}});export{Pe as default};
