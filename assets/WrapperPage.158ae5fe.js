import{dj as Ue,dc as T,P as N,au as W,ck as Q,J as w,b1 as g,ak as q,as as e,bV as ve,cl as M,cQ as B,cS as V,ai as $,V as m,bx as u,al as a,a1 as U,aj as P,cn as oe,dk as X,c_ as K,b7 as ke,a6 as fe,bs as Y,cR as O,aX as ge,eh as We,ah as be,b9 as Ae,co as F,cj as Ce,cP as H,du as qe,cV as Pe,ei as Te}from"./index.bc90c173.js";import{Q as x}from"./QCardSection.75e37070.js";import{Q as C}from"./QSeparator.22c57f7b.js";import{a as D,Q as ce}from"./QTabs.83095faa.js";import{Q as I}from"./QCard.d336c1cf.js";import{a as j,Q as ue}from"./QTabPanels.010fc376.js";import{Q as Ie}from"./QPage.b2165f64.js";import{Q as de}from"./QSlideTransition.3a42ceb3.js";import{Q as A}from"./QInput.5d8db303.js";import{h as R}from"./handleTransaction.3f260c58.js";import{Q as se}from"./QSelect.22397d4c.js";import{c as ne,b as te,d as ye,I as he,a as Qe}from"./calcAmountToTransfer.3dd46172.js";import{Q as Ke}from"./QList.e21f565c.js";import{Q as G}from"./QToggle.c0b42c63.js";import{a as re,b as ae,c as Me,d as J,_ as le,f as z,s as Be}from"./FormatNumber.1cff73d1.js";import{_ as Re,c as Ne}from"./TokenSelectDropdown.f65c8bf7.js";import{Q as Ee}from"./QImg.2462b92f.js";import{Q as we}from"./QCardActions.f7e7ad7f.js";import{U as Le}from"./constants.e2ffd8e4.js";import{f as _e}from"./format_address.d3022ffc.js";import"./rtl.2e405191.js";import"./touch.3df10340.js";import"./QMenu.37f3846a.js";import"./use-key-composition.574787ce.js";import"./use-checkbox.40a6acf5.js";import"./token.2bb03bc0.js";const n=Ue("wrapperStore",{state:()=>({wrapperSelected:{},groupSelected:{},wrapper:[],groups:[]}),getters:{getWrapperByGroup:h=>i=>h.wrapper.filter(c=>c.account.group.toString()==(i==null?void 0:i.publicKey.toString()))},actions:{async updateStore(){if(T()){const{pg_wrapper:h}=T();this.groups=await h.value.account.group.all(),this.wrapper=await h.value.account.wrapper.all(),this.groupSelected||(this.groupSelected=this.groups[0]),console.log("[Updated] WrapperStore")}}}}),Ge=new N("subA4tNLV18htV8xACaZyMMKkAm1AQS4EhiPYPV4zbH"),Oe={class:"row"},De=W({__name:"WrapperCreateGroup",setup(h){const i=Q(),c=w("");async function r(){try{const l=new B,t=T().pg_wrapper.value;if(c.value==""){i.notify({message:"Invalid group name",color:"info",position:"bottom-right"});return}l.add(await t.methods.initializeGroup(c.value).accountsPartial({signer:V(),fee:Ge}).instruction()),await R(l,"[Raffle] create new group"),await n().updateStore()}catch(l){i.notify({message:l.message,type:"negative"})}}return(l,t)=>(g(),q("div",Oe,[e(A,{square:"",filled:"",class:"col",modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=s=>c.value=s),label:"New group name",type:"text"},null,8,["modelValue"]),e(M,{square:"",onClick:t[1]||(t[1]=ve(s=>r(),["prevent"])),color:"primary",label:"Create"})]))}}),ie=W({__name:"WrapperGroupSelect",setup(h){return(i,c)=>(g(),$(se,{label:"Select a group",square:"",filled:"","onUpdate:modelValue":[c[0]||(c[0]=()=>m(n)().wrapperSelected=void 0),c[1]||(c[1]=r=>m(n)().groupSelected=r)],modelValue:m(n)().groupSelected,options:m(n)().groups,"option-label":r=>{var l;return(l=r==null?void 0:r.account)==null?void 0:l.name}},null,8,["modelValue","options","option-label"]))}}),je=W({__name:"WrapperCloseGroup",props:{disabled:{default:!0}},setup(h){const i=Q();async function c(){try{const r=new B,l=T().pg_wrapper.value;r.add(await l.methods.closeGroup().accountsPartial({group:n().groupSelected.publicKey,signer:V()}).instruction()),await R(r,"Close Group"),await n().updateStore()}catch(r){i.notify({message:r.message,type:"negative"})}}return(r,l)=>(g(),$(M,{disable:h.disabled,square:"",color:"primary",label:"Close",onClick:l[0]||(l[0]=ve(t=>c(),["prevent"]))},null,8,["disable"]))}}),ze=a("div",{class:"text-h5"},"Group",-1),Xe=a("div",{class:"text-caption text-grey"}," The group will be used to filter and create the wrappers - one time creation fee of 0.5 SOL ",-1),Fe=a("div",{class:"text-caption text-accent"}," Make sure u use a list where you are the owner! ",-1),He={key:0,class:"text-caption row"},Je=a("div",{style:{width:"50px"}},"ID",-1),Ye={class:"col text-right"},Ze={key:1,class:"text-caption row"},et=a("div",{style:{width:"50px"}},"Owner",-1),tt={class:"col text-accent text-right"},at={class:"row"},lt={key:0,class:"text-caption row"},ot=a("div",{style:{width:"50px"}},"ID:",-1),nt={class:"col text-accent text-right"},rt={key:1,class:"text-caption row"},st=a("div",{style:{width:"50px"}},"Owner:",-1),it={class:"col text-accent text-right"},ct=a("div",{class:"text-h6 text-red-6 col"}," I know what im doing i want to close the group ",-1),ut=W({__name:"WrapperGroupView",setup(h){const i=w("select"),c=w(!1);return(r,l)=>(g(),$(I,{flat:"",bordered:""},{default:u(()=>[e(x,null,{default:u(()=>[ze,Xe,Fe]),_:1}),e(C),e(ce,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=t=>i.value=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:u(()=>[e(D,{name:"select",label:"Select"}),e(D,{name:"create",label:"Create"}),e(D,{name:"close",label:"Close"})]),_:1},8,["modelValue"]),e(C),e(ue,{modelValue:i.value,"onUpdate:modelValue":l[2]||(l[2]=t=>i.value=t),animated:""},{default:u(()=>[e(j,{name:"create"},{default:u(()=>[e(De)]),_:1}),e(j,{name:"select"},{default:u(()=>[e(ie,{class:""}),e(x,null,{default:u(()=>{var t,s,o,d,p;return[(t=m(n)().groupSelected)!=null&&t.account?(g(),q("div",He,[Je,a("div",Ye,U((s=m(n)().groupSelected)==null?void 0:s.publicKey),1)])):P("",!0),(o=m(n)().groupSelected)!=null&&o.account?(g(),q("div",Ze,[et,a("div",tt,U((p=(d=m(n)().groupSelected)==null?void 0:d.account)==null?void 0:p.owner),1)])):P("",!0)]}),_:1})]),_:1}),e(j,{name:"close"},{default:u(()=>[a("div",at,[e(ie,{class:"col"}),e(je,{disabled:!c.value},null,8,["disabled"])]),e(x,null,{default:u(()=>{var t,s,o,d,p;return[(t=m(n)().groupSelected)!=null&&t.account?(g(),q("div",lt,[ot,a("div",nt,U((s=m(n)().groupSelected)==null?void 0:s.publicKey),1)])):P("",!0),(o=m(n)().groupSelected)!=null&&o.account?(g(),q("div",rt,[st,a("div",it,U((p=(d=m(n)().groupSelected)==null?void 0:d.account)==null?void 0:p.owner),1)])):P("",!0)]}),_:1}),e(x,{class:"row items-center"},{default:u(()=>[e(de,{color:"red",modelValue:c.value,"onUpdate:modelValue":l[1]||(l[1]=t=>c.value=t)},null,8,["modelValue"]),ct]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),dt=a("div",{class:"text-h6"},"Wrapped Token",-1),pt={class:"row q-gutter-x-md items-center"},mt=a("div",{class:"text-h6"},"Ratio",-1),wt={class:"row q-gutter-x-md items-center"},_t={class:"row items-center"},vt=a("div",{class:"text-h6"},"Add Medata",-1),ft={key:0,class:"row items-center q-gutter-x-sm"},gt=W({__name:"WrapperCreate",setup(h){const i=Q(),c=w(),r=w(9),l=w(1),t=w(1),s=w(!0),o=w(""),d=w(""),p=w("");async function b(){var k;try{const _=new B,S=T().pg_wrapper.value,E=new X(window.crypto.getRandomValues(new Uint8Array(8))),Z={ratio:[new X(l.value),new X(t.value)],onlyCreatorCanWrap:!1,onlyCreatorCanUnwrap:!1,wrappedDecimals:r.value,seed:E},L=new N(c.value.mint.toString());if(_.add(await S.methods.initialize(Z).accountsPartial({signer:V(),group:new N(((k=n().groupSelected)==null?void 0:k.publicKey.toString())??""),mintUnwrapped:L,tokenProgram:K}).instruction()),_.add(await S.methods.createVault().accountsPartial({signer:V(),wrapper:re(L,V()),vaultUnwrappedAta:ae(re(L,V()),L),mintUnwrapped:L,tokenProgram:K}).instruction()),s.value){const ee={name:o.value,symbol:d.value,uri:p.value},v=re(L,V()),f=Me(v,E),y=J(f);_.add(await S.methods.metadataCreate(ee).accountsPartial({signer:V(),wrapper:v,mintWrapped:f,mintUnwrapped:L,metadata:y,tokenProgram:K}).instruction())}await R(_,`[Wrapper] create + vault ${s.value?"+ metadata":""}`),await n().updateStore()}catch(_){console.error(_),i.notify({message:_.message,type:"negative",position:"bottom-right"})}}return(k,_)=>(g(),$(I,{flat:""},{default:u(()=>[e(x,{class:""},{default:u(()=>[e(Re,{label:"Unwrapped Token","textbox-label":"Token to wrap",onToken_account_selected:_[0]||(_[0]=S=>c.value=S)})]),_:1}),e(x,null,{default:u(()=>[dt,a("div",pt,[e(A,{square:"",filled:"",class:"col",modelValue:r.value,"onUpdate:modelValue":_[1]||(_[1]=S=>r.value=S),label:"Decimals",type:"number"},null,8,["modelValue"])])]),_:1}),e(x,null,{default:u(()=>[mt,a("div",wt,[e(A,{square:"",filled:"",class:"col",modelValue:l.value,"onUpdate:modelValue":_[2]||(_[2]=S=>l.value=S),label:"Unwrapped",type:"number"},null,8,["modelValue"]),e(oe,{name:"swap_horiz",size:"xl  "}),e(A,{square:"",filled:"",class:"col",modelValue:t.value,"onUpdate:modelValue":_[3]||(_[3]=S=>t.value=S),label:"Wrapped",type:"number"},null,8,["modelValue"])])]),_:1}),e(x,null,{default:u(()=>[a("div",_t,[vt,e(G,{modelValue:s.value,"onUpdate:modelValue":_[4]||(_[4]=S=>s.value=S),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),s.value?(g(),q("div",ft,[e(A,{square:"",filled:"",class:"col",modelValue:o.value,"onUpdate:modelValue":_[5]||(_[5]=S=>o.value=S),label:"Name",type:"text"},null,8,["modelValue"]),e(A,{square:"",filled:"",class:"col",modelValue:d.value,"onUpdate:modelValue":_[6]||(_[6]=S=>d.value=S),label:"Symbol",type:"text"},null,8,["modelValue"]),e(A,{square:"",filled:"",class:"col",modelValue:p.value,"onUpdate:modelValue":_[7]||(_[7]=S=>p.value=S),label:"Image-URI",type:"text"},null,8,["modelValue"])])):P("",!0)]),_:1}),e(x,{class:"row justify-end"},{default:u(()=>[e(M,{square:"",color:"primary",label:"Create new wrapper",onClick:_[8]||(_[8]=S=>b())})]),_:1})]),_:1}))}}),bt={class:"row items-center"},yt=a("div",{class:"col text-subtitle1 text-weight-thin"},"Publickey",-1),ht={class:"text-subtitle2"},xt={class:"col text-subtitle1 text-weight-thin"},St={key:0,class:"text-subtitle2"},Vt={key:1,class:"text-subtitle2"},$t=W({__name:"WrapperInfo",setup(h){return(i,c)=>{var r;return(r=m(n)().wrapperSelected)!=null&&r.account?(g(),$(I,{key:0,flat:""},{default:u(()=>[e(C),e(x,null,{default:u(()=>{var l;return[a("div",bt,[yt,a("div",ht,U(m(n)().wrapperSelected.publicKey),1)]),(g(!0),q(fe,null,ke(Object.keys((l=m(n)().wrapperSelected)==null?void 0:l.account),t=>(g(),q("div",{key:t,class:"row items-center"},[a("div",xt,U(t.toUpperCase()),1),t=="ratio"?(g(),q("div",St,U(m(n)().wrapperSelected.account[t][0])+" : "+U(m(n)().wrapperSelected.account[t][1]),1)):(g(),q("div",Vt,U(m(n)().wrapperSelected.account[t]),1))]))),128))]}),_:1})]),_:1})):P("",!0)}}}),Ut=W({__name:"WrapperClose",props:{disabled:{default:!0}},setup(h){const i=Q();async function c(){var r,l;try{const t=new B,s=T().pg_wrapper.value;t.add(await s.methods.close().accountsPartial({wrapper:(r=n().wrapperSelected)==null?void 0:r.publicKey,signer:V(),mintUnwrapped:(l=n().wrapperSelected)==null?void 0:l.account.mintUnwrapped,tokenProgram:K}).instruction()),await R(t,"[Wrapper] Close"),await n().updateStore()}catch(t){console.error(t),i.notify({message:t.message,type:"negative"})}}return(r,l)=>(g(),$(M,{disable:h.disabled,square:"",color:"primary",label:"Close WrapperInterface",onClick:l[0]||(l[0]=t=>c())},null,8,["disable"]))}}),kt={class:"row items-center"},Wt=a("div",{class:"col text-subtitle1"},"Allow wrap",-1),At={class:"row items-center"},Ct=a("div",{class:"col text-subtitle1"},"Allow unwrap",-1),qt={class:"row items-center"},Pt=a("div",{class:"col text-subtitle1"},"Only admin can Wrap",-1),Tt={class:"row items-center"},It=a("div",{class:"col text-subtitle1"},"Only admin can unwrap",-1),Qt={class:"row items-center"},Kt=a("div",{class:"col text-subtitle1"},"Use whitelist",-1),Mt={class:"row items-center"},Bt=a("div",{class:"col text-subtitle1"},"Use Limit",-1),Rt={class:"row items-center"},Nt=a("div",{class:"col text-subtitle1"},"Change Admin",-1),Et={class:"row items-center"},Lt=a("div",{class:"col text-subtitle1"},"Change Ratio",-1),Gt={key:0,style:{width:"500px"},class:"row items-center"},Ot=W({__name:"WrapperSettings",setup(h){var ee;const i=Q();(ee=n().wrapperSelected)==null||ee.account;const c=w(),r=w(),l=w(),t=w(),s=w(),o=w(),d=w(),p=w(),b=w(!1),k=w(),_=w(!1),S=w(),E=w();Z(),Y(()=>{var v,f;return(f=(v=n())==null?void 0:v.wrapperSelected)==null?void 0:f.account},()=>{Z()});function Z(){var f,y;if(!((f=n().wrapperSelected)!=null&&f.account))return;const v=(y=n().wrapperSelected)==null?void 0:y.account;c.value=v.allowWrap,r.value=v==null?void 0:v.allowUnwrap,l.value=v==null?void 0:v.onlyAdminCanWrap,t.value=v==null?void 0:v.onlyAdminCanUnwrap,s.value=v==null?void 0:v.useWhitelist,o.value=v==null?void 0:v.whitelist,d.value=v==null?void 0:v.useLimit,p.value=(v==null?void 0:v.limitAmountUnwrapped)??0,k.value=v==null?void 0:v.admin,S.value=v==null?void 0:v.ratio[0],E.value=v==null?void 0:v.ratio[1]}async function L(){var v,f;try{const y=new B,Se=T().pg_wrapper.value,Ve={allowWrap:c.value,allowUnwrap:r.value,onlyAdminCanWrap:l.value,onlyAdminCanUnwrap:t.value,useWhitelist:s.value,useLimit:d.value,amountAbleToWrap:d.value?ne(p.value,O().tokenList.find($e=>{var pe,me;return $e.address==((me=(pe=n().wrapperSelected)==null?void 0:pe.account)==null?void 0:me.mintUnwrapped.toString())}).decimals):null,admin:b.value?new N(k.value):null,ratio:_.value?[new X(S.value),new X(E.value)]:null};y.add(await Se.methods.edit(Ve).accountsPartial({wrapper:(v=n().wrapperSelected)==null?void 0:v.publicKey,signer:V(),mintUnwrapped:(f=n().wrapperSelected)==null?void 0:f.account.mintUnwrapped,whitelist:s.value?new N(o.value):null,tokenProgram:K}).instruction()),await R(y),await n().updateStore()}catch(y){console.error(y),i.notify({message:y.message,type:"negative"})}}return(v,f)=>(g(),$(I,{flat:""},{default:u(()=>[e(x,{class:"q-gutter-y-sm"},{default:u(()=>[a("div",kt,[Wt,e(G,{modelValue:c.value,"onUpdate:modelValue":f[0]||(f[0]=y=>c.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",At,[Ct,e(G,{modelValue:r.value,"onUpdate:modelValue":f[1]||(f[1]=y=>r.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",qt,[Pt,e(G,{modelValue:l.value,"onUpdate:modelValue":f[2]||(f[2]=y=>l.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",Tt,[It,e(G,{modelValue:t.value,"onUpdate:modelValue":f[3]||(f[3]=y=>t.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",Qt,[Kt,s.value?(g(),$(A,{key:0,dense:"",filled:"",square:"",style:{width:"500px"},modelValue:o.value,"onUpdate:modelValue":f[4]||(f[4]=y=>o.value=y),type:"text",label:"Whitelist"},null,8,["modelValue"])):P("",!0),e(G,{modelValue:s.value,"onUpdate:modelValue":f[5]||(f[5]=y=>s.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",Mt,[Bt,d.value?(g(),$(A,{key:0,dense:"",filled:"",square:"",style:{width:"500px"},modelValue:p.value,"onUpdate:modelValue":f[6]||(f[6]=y=>p.value=y),type:"number",label:"Amount wrappable"},null,8,["modelValue"])):P("",!0),e(G,{modelValue:d.value,"onUpdate:modelValue":f[7]||(f[7]=y=>d.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),a("div",null,[a("div",Rt,[Nt,b.value?(g(),$(A,{key:0,style:{width:"500px"},dense:"",filled:"",square:"",label:"Admin",modelValue:k.value,"onUpdate:modelValue":f[8]||(f[8]=y=>k.value=y)},null,8,["modelValue"])):P("",!0),e(G,{modelValue:b.value,"onUpdate:modelValue":f[9]||(f[9]=y=>b.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])])]),a("div",null,[a("div",Et,[Lt,_.value?(g(),q("div",Gt,[e(A,{class:"col",dense:"",filled:"",square:"",label:"Unwrapped",modelValue:S.value,"onUpdate:modelValue":f[10]||(f[10]=y=>S.value=y),type:"number"},null,8,["modelValue"]),e(oe,{size:"md",name:"swap_horiz"}),e(A,{class:"col",dense:"",filled:"",square:"",label:"Wrapped",modelValue:E.value,"onUpdate:modelValue":f[11]||(f[11]=y=>E.value=y),type:"number"},null,8,["modelValue"])])):P("",!0),e(G,{modelValue:_.value,"onUpdate:modelValue":f[12]||(f[12]=y=>_.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])])])]),_:1}),e(x,{class:"row justify-end"},{default:u(()=>[e(M,{square:"",class:"",color:"primary",label:"Update settings",onClick:f[13]||(f[13]=y=>L())})]),_:1})]),_:1}))}}),Dt=W({__name:"WrapperCreateVault",setup(h){const i=Q(),c=w(!1);async function r(l){try{const t=new B,s=T().pg_wrapper.value;t.add(await s.methods.createVault().accountsPartial({wrapper:new N(n().wrapperSelected.publicKey.toString()),signer:V(),mintUnwrapped:new N(n().wrapperSelected.account.mintUnwrapped.toString()),tokenProgram:K}).instruction()),await R(t,"[Wrapper] create vault")}catch(t){console.error(t),i.notify({message:t.message,type:"negative"})}}return(l,t)=>{var s;return!c.value&&((s=m(n)().wrapperSelected)==null?void 0:s.publicKey)?(g(),$(M,{key:0,square:"",color:"primary",label:"Create Vault",onClick:t[0]||(t[0]=o=>r())})):P("",!0)}}}),jt={class:"row"},zt=a("div",{class:"col"},"Vault Balance",-1),Xt={class:"row"},Ft=a("div",{class:"col"},"Circ. Supply",-1),xe=W({__name:"WrapperVaultDonut",props:["wrapper"],setup(h){const i=h,c=w(0),r=w(0),l=w(0);async function t(){c.value=await s()??0,r.value=await o()??0,l.value=c.value*i.wrapper.account.ratio[1]/c.value*i.wrapper.account.ratio[1]*100}async function s(){return(await F().connection.getTokenSupply(new N(i.wrapper.account.mintWrapped))).value.uiAmount}async function o(){let b=ae(i.wrapper.publicKey,i.wrapper.account.mintUnwrapped);return(await F().connection.getTokenAccountBalance(b)).value.uiAmount}ge(async()=>{await t()}),We(()=>i.wrapper,async()=>await t());const d=be(()=>[l.value]),p=w({dataLabels:{enabled:!1},legend:{labels:{colors:"white"},show:!1,position:"left"},theme:{palette:"palette4"},labels:["Redeemable"]});return(b,k)=>{const _=Ae("apexchart");return g(),q(fe,null,[a("div",jt,[zt,e(le,{class:"",number:r.value,decimals:4,"pad-start":10},null,8,["number"])]),a("div",Xt,[Ft,e(le,{number:c.value,decimals:4,"pad-start":10},null,8,["number"])]),e(_,{height:"200px",type:"radialBar",options:p.value,series:d.value},null,8,["options","series"])],64)}}}),Ht={class:"text-subtitle2 row items-center"},Jt=a("div",{class:"text-accent"}," I want to transfer tokens out of the vault to a new address ",-1),Yt={class:"col"},Zt={class:"row"},ea=W({__name:"WrapperTransferVaultOut",setup(h){const i=Q(),c=w(1),r=w(V().toString()),l=w(!1);Y(()=>Ce().useSquads,()=>{r.value=V().toString()});async function t(){var s,o;try{if(T()){const d=new B,p=T().pg_wrapper.value;d.add(await p.methods.transferVault(ne(c.value,n().wrapperSelected.account.wrappedDecimals)).accountsPartial({signer:V(),wrapper:(s=n().wrapperSelected)==null?void 0:s.publicKey,mintUnwrapped:(o=n().wrapperSelected)==null?void 0:o.account.mintUnwrapped,ataUnwrappedSigner:z(new N(r.value).toString(),n().wrapperSelected.account.mintUnwrapped.toString()),tokenProgram:K}).instruction()),await R(d,`[Wrapper] transfer to ${r.value}`),await n().updateStore()}}catch(d){console.error(d),i.notify({message:d.message,type:"negative"})}}return(s,o)=>(g(),$(I,{flat:""},{default:u(()=>[a("div",Ht,[e(de,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=d=>l.value=d)},null,8,["modelValue"]),Jt]),a("div",Yt,[a("div",Zt,[e(A,{class:"col",disable:!l.value,square:"",filled:"",modelValue:r.value,"onUpdate:modelValue":o[1]||(o[1]=d=>r.value=d),type:"text",label:"recipient"},null,8,["disable","modelValue"]),e(C,{vertical:""}),e(A,{disable:!l.value,square:"",filled:"",modelValue:c.value,"onUpdate:modelValue":o[2]||(o[2]=d=>c.value=d),type:"number",label:"Amount to transfer"},null,8,["disable","modelValue"]),e(M,{disable:!c.value||!r.value||!l.value,color:"primary",label:"Send",square:"",onClick:o[3]||(o[3]=d=>t())},null,8,["disable"])])])]),_:1}))}}),ta={class:"row items-center"},aa=a("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),la={class:"text-subtitle2"},oa={class:"row items-center"},na=a("div",{class:"col text-subtitle1 text-weight-thin"},"Mint",-1),ra={class:"text-subtitle2"},sa={class:"row items-center"},ia=a("div",{class:"col text-subtitle1 text-weight-thin"},"Unwrapped",-1),ca={class:"text-subtitle2"},ua={class:"row items-center"},da=a("div",{class:"col text-subtitle1 text-weight-thin"},"Balance",-1),pa={class:"text-subtitle2"},ma=W({__name:"WrapperVault",setup(h){Q();const i=w(null),c=w(!1);r(),Y(()=>{var l,t;return(t=(l=n())==null?void 0:l.wrapperSelected)==null?void 0:t.account},async()=>{await r()});async function r(){var l;!n().wrapperSelected||(i.value=(l=(await F().connection.getParsedAccountInfo(ae(n().wrapperSelected.publicKey,n().wrapperSelected.account.mintUnwrapped))).value)==null?void 0:l.data,i.value&&(c.value=!0))}return(l,t)=>(g(),$(I,{flat:""},{default:u(()=>[e(C),e(x,{class:"col"},{default:u(()=>{var s,o,d;return[a("div",ta,[aa,a("div",la,U(m(ae)(m(n)().wrapperSelected.publicKey,m(n)().wrapperSelected.account.mintUnwrapped)),1)]),a("div",oa,[na,a("div",ra,U((s=m(n)().wrapperSelected.account)==null?void 0:s.mintUnwrapped),1)]),a("div",sa,[ia,a("div",ca,U(m(O)().getTokenByMintPublicKey((o=m(n)().wrapperSelected)==null?void 0:o.account.mintUnwrapped).name),1)]),a("div",ua,[da,a("div",pa,U((d=i.value)==null?void 0:d.parsed.info.tokenAmount.uiAmount),1)])]}),_:1}),e(x,null,{default:u(()=>[e(xe,{wrapper:m(n)().wrapperSelected},null,8,["wrapper"])]),_:1}),e(x,{class:"q-gutter-y-md"},{default:u(()=>[c.value?P("",!0):(g(),$(Dt,{key:0,class:"full-width"})),e(ea)]),_:1})]),_:1}))}}),wa=W({__name:"WrapperMetadataUpdate",props:["name","symbol","uri"],setup(h){const i=h,c=Q();async function r(l){var t,s;try{const o=new B,d=T().pg_wrapper.value,p={name:i.name,symbol:i.symbol,uri:i.uri};o.add(await d.methods.metadataUpdate(p).accountsPartial({wrapper:(t=n().wrapperSelected)==null?void 0:t.publicKey,signer:V(),metadata:J(n().wrapperSelected.account.mintWrapped),mintUnwrapped:(s=n().wrapperSelected)==null?void 0:s.account.mintUnwrapped,tokenProgram:K}).instruction()),await R(o,"[Wrapper] metadata update"),await n().updateStore()}catch(o){console.error(o),c.notify({message:o.message,type:"negative"})}}return(l,t)=>(g(),$(M,{square:"",color:"primary",label:"Apply Metadata",onClick:t[0]||(t[0]=s=>r())}))}}),_a=W({__name:"WrapperMetadataCreate",props:["name","symbol","uri"],setup(h){const i=h,c=Q();async function r(l){var t,s;try{const o=new B,d=T().pg_wrapper.value,p={name:i.name,symbol:i.symbol,uri:i.uri};o.add(await d.methods.metadataCreate(p).accountsPartial({wrapper:(t=n().wrapperSelected)==null?void 0:t.publicKey,signer:V(),metadata:J(n().wrapperSelected.account.mintWrapped),mintUnwrapped:(s=n().wrapperSelected)==null?void 0:s.account.mintUnwrapped,tokenProgram:K}).instruction()),await R(o,"[Wrapper] metadata create"),await n().updateStore()}catch(o){console.error(o),c.notify({message:o.message,type:"negative"})}}return(l,t)=>(g(),$(M,{square:"",color:"primary",label:"Create Metadata",onClick:t[0]||(t[0]=s=>r())}))}}),va={class:"row items-center"},fa=a("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),ga={class:"text-subtitle2"},ba={class:"row"},ya=W({__name:"WrapperMetadata",setup(h){Q();const i=w(""),c=w(""),r=w(""),l=w(),t=w(),s=w(!1);o(),Y(()=>{var d,p;return(p=(d=n())==null?void 0:d.wrapperSelected)==null?void 0:p.account},async()=>{await o()});async function o(){!n().wrapperSelected||(l.value=await F().connection.getAccountInfo(J(n().wrapperSelected.account.mintWrapped)),t.value=Be.deserializeMetadata(l.value),i.value=t.value.name,c.value=t.value.symbol,r.value=t.value.uri,l.value&&(s.value=!0))}return(d,p)=>(g(),$(I,{flat:""},{default:u(()=>[e(x,null,{default:u(()=>[a("div",va,[fa,a("div",ga,U(m(J)(m(n)().wrapperSelected.publicKey)),1)])]),_:1}),s.value?(g(),$(x,{key:0,class:"col"},{default:u(()=>[a("div",ba,[e(A,{square:"",label:"Name",filled:"",modelValue:i.value,"onUpdate:modelValue":p[0]||(p[0]=b=>i.value=b)},null,8,["modelValue"]),e(C,{vertical:""}),e(A,{square:"",label:"Symbol",filled:"",modelValue:c.value,"onUpdate:modelValue":p[1]||(p[1]=b=>c.value=b)},null,8,["modelValue"]),e(C,{vertical:""}),e(A,{square:"",label:"Image URI",class:"col",filled:"",modelValue:r.value,"onUpdate:modelValue":p[2]||(p[2]=b=>r.value=b)},null,8,["modelValue"]),e(wa,{name:i.value,symbol:c.value,uri:r.value},null,8,["name","symbol","uri"])])]),_:1})):(g(),$(x,{key:1,class:"row justify-end"},{default:u(()=>[e(_a,{name:i.value,symbol:c.value,uri:r.value},null,8,["name","symbol","uri"])]),_:1}))]),_:1}))}}),ha=a("div",{class:"text-h5"},"WrapperInterface Factory",-1),xa=a("div",{class:"text-caption text-grey"}," Small plates, salads & sandwiches in an intimate setting. ",-1),Sa={class:"row q-gutter-x-md"},Va={class:"text-caption text-grey text-right"},$a={class:"row"},Ua=a("div",{class:"text-h6 text-red-6 col"}," I know what im doing i want to close a wrapper ",-1),ka=W({__name:"WrapperManage",setup(h){const i=w("select"),c=w(!1);return(r,l)=>(g(),$(I,{flat:"",bordered:""},{default:u(()=>[e(x,null,{default:u(()=>[ha,xa]),_:1}),e(C),e(ce,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=t=>i.value=t),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:u(()=>[e(D,{name:"create",label:"Create"}),e(D,{name:"select",label:"Edit"}),e(D,{name:"close",label:"Close"})]),_:1},8,["modelValue"]),e(C),e(ue,{modelValue:i.value,"onUpdate:modelValue":l[4]||(l[4]=t=>i.value=t),animated:""},{default:u(()=>[e(j,{name:"create"},{default:u(()=>[e(gt)]),_:1}),e(j,{name:"select"},{default:u(()=>[e(I,{flat:""},{default:u(()=>{var t;return[e(x,null,{default:u(()=>[a("div",Sa,[e(se,{label:"Select a wrapper",class:"col",filled:"",modelValue:m(n)().wrapperSelected,"onUpdate:modelValue":l[1]||(l[1]=s=>m(n)().wrapperSelected=s),options:m(n)().getWrapperByGroup(m(n)().groupSelected),"option-label":s=>{var o,d;return"[Wrapped] "+(((o=m(O)().tokenList.find(p=>{var b,k;return p.address==((k=(b=s.account)==null?void 0:b.mintUnwrapped)==null?void 0:k.toString())}))==null?void 0:o.name)??((d=s.account)==null?void 0:d.mintUnwrapped.toString())??"")}},null,8,["modelValue","options","option-label"])]),a("div",Va," Total Found: "+U(m(n)().wrapper.length),1)]),_:1}),(t=m(n)().wrapperSelected)!=null&&t.account?(g(),$(x,{key:0,class:"row full-width"},{default:u(()=>[e(Ke,{bordered:"",class:"rounded-borders full-width"},{default:u(()=>[e(te,{class:"text-h5",icon:"info",label:"Info"},{default:u(()=>[e($t)]),_:1}),e(C),e(te,{class:"text-h5",icon:"settings",label:"Settings"},{default:u(()=>[e(Ot)]),_:1}),e(C),e(te,{class:"text-h5",icon:"note_add",label:"Metadata"},{default:u(()=>[e(ya)]),_:1}),e(C),e(te,{class:"text-h5","default-opened":"",icon:"inventory_2",label:"Vault"},{default:u(()=>[e(ma)]),_:1})]),_:1})]),_:1})):P("",!0)]}),_:1})]),_:1}),e(j,{name:"close"},{default:u(()=>[e(I,{flat:""},{default:u(()=>{var t;return[e(x,null,{default:u(()=>[a("div",$a,[e(se,{label:"Select a wrapper",class:"col",filled:"",modelValue:m(n)().wrapperSelected,"onUpdate:modelValue":l[2]||(l[2]=s=>m(n)().wrapperSelected=s),options:m(n)().wrapper,"option-label":s=>{var o,d;return"[Wrapped] "+(((o=m(O)().tokenList.find(p=>{var b,k;return p.address==((k=(b=s.account)==null?void 0:b.mintUnwrapped)==null?void 0:k.toString())}))==null?void 0:o.name)??((d=s.account)==null?void 0:d.mintUnwrapped.toString())??"")}},null,8,["modelValue","options","option-label"]),e(Ut,{disabled:!c.value},null,8,["disabled"])])]),_:1}),(t=m(n)().wrapperSelected)!=null&&t.account?(g(),$(x,{key:0,class:"row justify-between"})):P("",!0)]}),_:1}),e(x,{class:"row items-center"},{default:u(()=>[e(de,{color:"red",modelValue:c.value,"onUpdate:modelValue":l[3]||(l[3]=t=>c.value=t)},null,8,["modelValue"]),Ua]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),Wa=W({__name:"WrapperWrap",props:["wrapper"],setup(h){const i=Q(),c=w(1),r=h;async function l(){var t,s;try{const o=new B,d=T().pg_wrapper.value,p=r.wrapper,b=ne(c.value,((t=O().getTokenByMintPublicKey(p==null?void 0:p.account.mintUnwrapped))==null?void 0:t.decimals)??((s=H().getAccountByMintPublicKey(p==null?void 0:p.account.mintUnwrapped))==null?void 0:s.decimals)??0);await F().connection.getAccountInfo(z(V().toString(),r.wrapper.account.mintWrapped.toString()))||o.add(Ne(V(),z(V().toString(),r.wrapper.account.mintWrapped.toString()),V(),r.wrapper.account.mintWrapped,K,qe)),console.log(`amount_to_transfer=${b}`);let _=r.wrapper.account.useWhitelist?r.wrapper.account.whitelist:null,S=r.wrapper.account.useWhitelist?ye(_):null;console.log(_),o.add(await d.methods.wrap(b).accountsPartial({signer:V(),wrapper:p.publicKey,mintUnwrapped:p.account.mintUnwrapped,signerUnwrapped:z(V().toString(),p.account.mintUnwrapped.toString()),signerWrapped:z(V().toString(),r.wrapper.account.mintWrapped.toString()),tokenProgram:K,whitelist:_,whitelistEntry:S,whitelistProgram:he}).instruction()),await R(o,"[Wrapper] wrap tokens"),await n().updateStore()}catch(o){console.error(o),i.notify({message:o.message,type:"negative"})}}return(t,s)=>(g(),q("div",null,[e(A,{disable:!h.wrapper.account.allowWrap,filled:"",type:"number",modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=o=>c.value=o)},null,8,["disable","modelValue"]),e(M,{disable:!h.wrapper.account.allowWrap,class:"full-width",color:"primary",label:"Wrap",onClick:s[1]||(s[1]=o=>l())},null,8,["disable"])]))}}),Aa=W({__name:"WrapperUnwrap",props:["wrapper"],setup(h){const i=Q(),c=w(1),r=h;async function l(t){var s,o;try{const d=new B,p=T().pg_wrapper.value,b=r.wrapper,k=ne(c.value,(s=H().getAccountByMintPublicKey(b==null?void 0:b.account.mintUnwrapped))==null?void 0:s.decimals);let _=r.wrapper.account.useWhitelist?r.wrapper.account.whitelist:null,S=r.wrapper.account.useWhitelist?ye(_):null;d.add(await p.methods.unwrap(k).accountsPartial({signer:V(),wrapper:b.publicKey,mintUnwrapped:b.account.mintUnwrapped,signerUnwrapped:new N(((o=H().accounts.find(E=>E.mint.toString()==b.account.mintUnwrapped.toString()))==null?void 0:o.pubkey)??""),signerWrapped:z(Pe().publicKey.value.toString(),r.wrapper.account.mintWrapped.toString()),tokenProgram:K,whitelist:_,whitelistEntry:S,whitelistProgram:he}).instruction()),await R(d,"[Wrapper] unwrap tokens"),await n().updateStore()}catch(d){console.error(d),i.notify({message:d.message,type:"negative"})}}return(t,s)=>(g(),q("div",null,[e(A,{disable:!h.wrapper.account.allowUnwrap,filled:"",type:"number",modelValue:c.value,"onUpdate:modelValue":s[0]||(s[0]=o=>c.value=o)},null,8,["disable","modelValue"]),e(M,{disable:!h.wrapper.account.allowUnwrap,class:"full-width",color:"primary",label:"Unwrap",onClick:s[1]||(s[1]=o=>l())},null,8,["disable"])]))}});const Ca={class:"q-pa-md"},qa={class:"q-pa-xs col-xs-12 col-sm-6 col-md-3"},Pa={class:"row items-center"},Ta=a("div",{class:"col text-subtitle1 text-weight-thin"},"Group",-1),Ia={class:"text-subtitle2"},Qa={class:"row items-center"},Ka=a("div",{class:"col text-subtitle1 text-weight-thin"},"Pair",-1),Ma={class:"text-subtitle2 row q-gutter-x-xs"},Ba=a("div",null,"/",-1),Ra={class:"row items-center"},Na=a("div",{class:"col text-subtitle1 text-weight-thin"},"Wrappable",-1),Ea={class:"text-subtitle2"},La={class:"row items-center"},Ga=a("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),Oa={class:"text-subtitle2"},Da={class:"col text-center"},ja={class:"col text-center"},za=a("div",{class:"text-center text-subtitle2"},"Status",-1),Xa=a("div",null,null,-1),Fa={class:"row q-mb-md q-px-md"},Ha=a("div",{class:"col text-center"},"Wallet Balance",-1),Ja={class:"row q-gutter-x-md"},Ya=W({__name:"WrapperTable",setup(h){const i=Q();function c(){return i.screen.lt.sm?3:i.screen.lt.md?6:9}const r=w(""),l=w({page:1,rowsPerPage:c()});return Y(()=>i.screen.name,()=>{l.value.rowsPerPage=c()}),_e(V().toString()),be(()=>i.screen.gt.xs?i.screen.gt.sm?[3,6,9]:[3,6]:[3]),(t,s)=>(g(),q("div",Ca,[e(Qe,{grid:"",rows:m(n)().wrapper,"row-key":"name",filter:r.value,"hide-header":"",pagination:l.value,"onUpdate:pagination":s[0]||(s[0]=o=>l.value=o),"rows-per-page-options":[0]},{item:u(o=>[a("div",qa,[e(I,{flat:"",bordered:""},{default:u(()=>[e(x,{class:"text-center"},{default:u(()=>{var d;return[e(Ee,{height:"200px",src:((d=m(O)().tokenList.find(p=>{var b;return p.address==((b=o.row.account)==null?void 0:b.mintUnwrapped.toString())}))==null?void 0:d.logoURI)??m(Le)},null,8,["src"])]}),_:2},1024),e(x,null,{default:u(()=>{var d,p,b,k;return[a("div",Pa,[Ta,a("div",Ia,U(m(n)().groups.find(_=>_.publicKey.toString()==o.row.account.group.toString()).account.name),1)]),a("div",Qa,[Ka,a("div",Ma,[a("div",null,U(m(O)().tokenList.find(_=>_.address==o.row.account.mintUnwrapped.toString()).symbol),1),Ba,a("div",null," W"+U(m(O)().tokenList.find(_=>_.address==o.row.account.mintUnwrapped.toString()).symbol),1)])]),a("div",Ra,[Na,a("div",Ea,U((d=o.row)!=null&&d.account.useLimit?(p=o.row)==null?void 0:p.account.limitAmountUnwrapped:"\u221E"),1)]),a("div",La,[Ga,a("div",Oa,U(m(_e)((k=(b=o.row)==null?void 0:b.publicKey)==null?void 0:k.toString())),1)])]}),_:2},1024),e(C),e(we,{class:"row text-h4"},{default:u(()=>[a("div",Da,U(o.row.account.ratio[0]),1),e(oe,{size:"md",name:"swap_horiz"}),a("div",ja,U(o.row.account.ratio[1]),1)]),_:2},1024),e(we,{class:"row"},{default:u(()=>[e(I,{class:"col q-mx-sm",flat:"",bordered:""},{default:u(()=>[e(x,null,{default:u(()=>[za]),_:1}),e(C),Xa,e(x,null,{default:u(()=>[e(xe,{mintWrapped:o.row.account.mintWrapped.toString(),mintUnwrapped:o.row.account.mintUnwrapped.toString(),wrapper:o.row},null,8,["mintWrapped","mintUnwrapped","wrapper"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(x,{class:"col"},{default:u(()=>{var d,p;return[a("div",Fa,[e(le,{number:(d=m(H)().getAccountByMintPublicKey(o.row.account.mintUnwrapped))==null?void 0:d.uiAmount,decimals:4,"pad-start":10},null,8,["number"]),Ha,e(le,{number:(p=m(H)().getAccountByMintPublicKey(o.row.account.mintWrapped))==null?void 0:p.uiAmount,decimals:4,"pad-start":10},null,8,["number"])]),a("div",Ja,[e(Wa,{class:"col",wrapper:o.row},null,8,["wrapper"]),e(Aa,{class:"col",wrapper:o.row},null,8,["wrapper"])])]}),_:2},1024)]),_:2},1024)])]),_:1},8,["rows","filter","pagination"])]))}}),Za=a("div",{class:"col text-h6"},"Token Wrapper Interface",-1),el={class:"row"},kl=W({__name:"WrapperPage",setup(h){const i=w("wrapping");return n(),ge(async()=>{T()||Te(),await n().updateStore()}),(c,r)=>(g(),$(Ie,{class:"bg-black"},{default:u(()=>[e(I,null,{default:u(()=>[e(x,{class:"row items-center q-gutter-x-md"},{default:u(()=>[e(oe,{name:"inventory_2",size:"md"}),Za]),_:1}),e(C),e(ce,{modelValue:i.value,"onUpdate:modelValue":r[0]||(r[0]=l=>i.value=l),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:u(()=>[e(D,{name:"wrapping",label:"Wrap / Unwrap"}),e(D,{name:"manage",label:"Manage"})]),_:1},8,["modelValue"]),e(C),e(ue,{modelValue:i.value,"onUpdate:modelValue":r[2]||(r[2]=l=>i.value=l),animated:""},{default:u(()=>[e(j,{name:"wrapping"},{default:u(()=>[a("div",el,[e(ie,{class:"col"}),e(M,{square:"",color:"primary",label:"reload",onClick:r[1]||(r[1]=()=>{m(n)().updateStore()})})]),e(I,{flat:""},{default:u(()=>[e(x,null,{default:u(()=>[e(Ya)]),_:1})]),_:1})]),_:1}),e(j,{name:"manage",class:"row q-gutter-x-md"},{default:u(()=>{var l;return[e(ut,{class:"col-3"}),(l=m(n)().groupSelected)!=null&&l.account?(g(),$(ka,{key:0,class:"col"})):P("",!0)]}),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{kl as default};
