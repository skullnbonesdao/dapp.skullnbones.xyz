import{Q as W,a as b,b as q}from"./QInput.c591bb43.js";import{Q as h,a as R}from"./QTabPanels.20936f89.js";import{Q as E}from"./QPage.f360718c.js";import{P as d,cJ as X,cK as J,cn as U,ah as A,cL as H,cM as Y,au as w,J as m,b1 as p,ak as f,as as t,bx as l,ar as g,ck as V,cN as $,cO as j,cP as D,cQ as y,aX as Q,a6 as S,b7 as C,bz as P,ai as k,a1 as B,aj as z}from"./index.a64e0562.js";import{l as T,n as F,o as K,m as I,C as M}from"./ClosePopup.de5c5461.js";import{Q as N}from"./QBtnDropdown.9e693564.js";import{Q as G}from"./QTree.e9c3ef80.js";import"./touch.3df10340.js";import"./QSlideTransition.fb2755a9.js";const O="processed",Z="confirmed",ee=new d(X.metadata.address);let L=null;const x=()=>L,te=()=>{const _=J(),a=U().connection,r=A(()=>new H(a,_.value,{preflightCommitment:O,commitment:Z})),n=A(()=>new Y(X,ee,r.value));L={wallet:_,connection:a,provider:r,program:n}},ae={class:"row q-gutter-x-md"},le=w({__name:"CreateWhitelist",setup(_){const a=m("My new whitelist");async function r(){const{program:n}=x();let[o,u]=d.findProgramAddressSync([$().publicKey.value.toBytes(),j(a.value)],n.value.programId);try{const c=await n.value.methods.initialize(a.value).accounts({whitelist:o,systemProgram:D.programId}).rpc();console.log(c),y.create({message:"TX-Signature: "+c,timeout:5e3})}catch{y.create({color:"red",message:"Error sending tx!",timeout:5e3})}}return(n,o)=>(p(),f("div",ae,[t(W,{class:"col",modelValue:a.value,"onUpdate:modelValue":o[0]||(o[0]=u=>a.value=u)},null,8,["modelValue"]),t(V,{color:"primary",onClick:o[1]||(o[1]=u=>r())},{default:l(()=>[g("Create")]),_:1})]))}}),oe={class:"row q-gutter-x-md"},se=w({__name:"AddAddressToWhitelist",setup(_){const{program:a}=x(),r=m("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),n=m(),o=m();Q(async()=>{n.value=await a.value.account.whitelist.all()});async function u(){const c=new d(o.value.publicKey),[s,i]=d.findProgramAddressSync([new d(r.value).toBytes(),c.toBytes()],a.value.programId);try{const e=new d(r.value),v=await a.value.methods.addToWhitelist(e).accounts({entry:s,whitelist:c,authority:$().publicKey.value,systemProgram:D.programId}).rpc();console.log(v),y.create({message:"TX-Signature: "+v,timeout:5e3})}catch(e){console.log(e),y.create({color:"red",message:`${e}`,timeout:5e3})}}return(c,s)=>{var i;return p(),f("div",oe,[t(N,{color:"primary",label:((i=o.value)==null?void 0:i.account.name)??"please select a whitelist"},{default:l(()=>[t(T,null,{default:l(()=>[(p(!0),f(S,null,C(n.value,e=>P((p(),k(I,{clickable:"",key:e,onClick:v=>o.value=e},{default:l(()=>[t(F,null,{default:l(()=>[t(K,null,{default:l(()=>[g(B(e==null?void 0:e.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[M]])),128))]),_:1})]),_:1},8,["label"]),t(W,{class:"col",outlined:"",modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=e=>r.value=e),label:"Address to be added"},null,8,["modelValue"]),t(V,{color:"primary",onClick:s[1]||(s[1]=e=>u())},{default:l(()=>[g("Add")]),_:1})])}}}),re={class:"row q-gutter-x-md"},ne=w({__name:"ViewWhitelist",setup(_){const{program:a}=x(),r=m(),n=m();Q(async()=>{r.value=await a.value.account.whitelist.all(),n.value=await a.value.account.whitelistEntry.all()});const o=A(()=>{var u;return(u=r==null?void 0:r.value)==null?void 0:u.map(c=>{var s,i;return{label:`${c.account.name} | ${c.publicKey.toString()}`,children:(i=(s=n.value)==null?void 0:s.filter(e=>e.account.parent.toString()===c.publicKey.toString()))==null?void 0:i.flatMap(e=>({label:`Member: ${e.account.whitelisted.toString()}  |  Account: ${e.publicKey.toString()} `}))}})});return(u,c)=>(p(),f("div",re,[o.value?(p(),k(G,{key:0,nodes:o.value,"node-key":"label","selected-color":"primary","default-expand-all":""},null,8,["nodes"])):z("",!0)]))}}),ce={class:"row q-gutter-x-md"},ue=w({__name:"RemoveAddressFromWhitelist",setup(_){const{program:a}=x(),r=m("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),n=m(),o=m();Q(async()=>{n.value=await a.value.account.whitelist.all()});async function u(){const c=new d(o.value.publicKey),[s,i]=d.findProgramAddressSync([new d(r.value).toBytes(),c.toBytes()],a.value.programId);try{console.log(a.value.methods);const e=new d(r.value),v=await a.value.methods.removeFromWhitelist(e).accounts({entry:s,whitelist:c,authority:$().publicKey.value}).rpc();console.log(v),y.create({message:"TX-Signature: "+v,timeout:5e3})}catch(e){console.log(e),y.create({color:"red",message:`${e}`,timeout:5e3})}}return(c,s)=>{var i;return p(),f("div",ce,[t(N,{color:"primary",label:((i=o.value)==null?void 0:i.account.name)??"please select a whitelist"},{default:l(()=>[t(T,null,{default:l(()=>[(p(!0),f(S,null,C(n.value,e=>P((p(),k(I,{clickable:"",key:e,onClick:v=>o.value=e},{default:l(()=>[t(F,null,{default:l(()=>[t(K,null,{default:l(()=>[g(B(e==null?void 0:e.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[M]])),128))]),_:1})]),_:1},8,["label"]),t(W,{class:"col",outlined:"",modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=e=>r.value=e),label:"Address to be removed"},null,8,["modelValue"]),t(V,{color:"primary",onClick:s[1]||(s[1]=e=>u())},{default:l(()=>[g("Remove")]),_:1})])}}}),ie={class:"row q-gutter-x-md"},de=w({__name:"DeleteWhitelist",setup(_){const{program:a}=x(),r=m("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),n=m(),o=m();Q(async()=>{n.value=await a.value.account.whitelist.all()});async function u(){const c=new d(o.value.publicKey);d.findProgramAddressSync([new d(r.value).toBytes(),c.toBytes()],a.value.programId);try{const s=await a.value.methods.deleteWhitelist(o.value.account.name).accounts({whitelist:c,authority:$().publicKey.value}).rpc();console.log(s),y.create({message:"TX-Signature: "+s,timeout:5e3})}catch(s){console.log(s),y.create({color:"red",message:`${s}`,timeout:5e3})}}return(c,s)=>{var i;return p(),f("div",ie,[t(N,{color:"primary",label:((i=o.value)==null?void 0:i.account.name)??"please select a whitelist"},{default:l(()=>[t(T,null,{default:l(()=>[(p(!0),f(S,null,C(n.value,e=>P((p(),k(I,{clickable:"",key:e,onClick:v=>o.value=e},{default:l(()=>[t(F,null,{default:l(()=>[t(K,null,{default:l(()=>[g(B(e==null?void 0:e.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[M]])),128))]),_:1})]),_:1},8,["label"]),t(V,{color:"primary",onClick:s[0]||(s[0]=e=>u())},{default:l(()=>[g("Delete")]),_:1})])}}}),he=w({__name:"WhitelistPage",setup(_){const a=m("create");return te(),(r,n)=>(p(),k(E,{class:"col text-center"},{default:l(()=>[t(q,{"no-caps":"","outside-arrows":"","mobile-arrows":"",modelValue:a.value,"onUpdate:modelValue":n[0]||(n[0]=o=>a.value=o),class:"shadow-2",align:"justify"},{default:l(()=>[t(b,{name:"create",label:"Create Whitelist"}),t(b,{name:"add",label:"Add Address to Whitelist"}),t(b,{name:"remove",label:"Remove address from Whitelist"}),t(b,{name:"delete",label:"Delete Whitelist"}),t(b,{name:"view",label:"View "})]),_:1},8,["modelValue"]),t(R,{dark:"",modelValue:a.value,"onUpdate:modelValue":n[1]||(n[1]=o=>a.value=o),animated:"",class:"q-mx-xl"},{default:l(()=>[t(h,{name:"create"},{default:l(()=>[t(le)]),_:1}),t(h,{name:"add"},{default:l(()=>[t(se)]),_:1}),t(h,{name:"remove"},{default:l(()=>[t(ue)]),_:1}),t(h,{name:"delete"},{default:l(()=>[t(de)]),_:1}),t(h,{name:"view"},{default:l(()=>[t(ne)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{he as default};
