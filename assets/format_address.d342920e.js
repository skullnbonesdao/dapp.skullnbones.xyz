import{aF as P,bZ as en,d5 as Eu,d6 as Bu,cg as ui,c0 as Cu,cl as sr,aC as vn,ah as O,c1 as Ou,J as Te,bs as st,aQ as Jt,cd as xu,aS as ns,aV as wo,aR as So,aT as Nr,aX as ko,c2 as Ms,ce as rs,cT as _o,cS as Ao,cf as Lu,d7 as Nu,cq as zu,cc as Kn,bC as Us,cE as Ku,aU as Mu,b0 as Uu,c8 as xi,cP as kr,cu as qu,c9 as nr,cO as Wu,cy as Fu,cH as qs,d8 as $i,d9 as Ws,da as Du,db as Vu,cA as _r,cj as ti,bX as $,dc as bi,dd as $e,de as is,df as G,dg as $n,dh as se,di as dt,dj as J,dk as Q,dl as Mt,dm as ke,dn as ft,dp as Fn,dq as zr,dr as L,ds as ss,dt as os,du as qe,dv as Kr,dw as B,dx as S,dy as D,dz as W,dA as ae,dB as Zt,dC as Io,dD as At,dE as z,dF as Dt,dG as as,dH as Ue,cU as Fs,dI as Ds,dJ as $u,dK as yr,dL as Hu,dM as Ro,dN as Vs,dO as Gu,dP as ju,dQ as Yu,dR as Ju,bW as Qu,P as Po,dS as Xu,cm as Ar,co as ni,a as Zu}from"./index.8da7bd1d.js";import{Q as ec}from"./QSeparator.7b724edc.js";import{u as mi,d as pi,l as tc,g as nc,f as rc,p as ic,h as sc,i as oc,v as ac,B as uc,F as cc,j as lc,w as dc,K as $s,L as Hs,M as fc,N as hc,r as gc,n as yc,o as bc,m as mc}from"./ClosePopup.8a841db8.js";import{r as Hi,d as us,e as To,f as Eo,g as Bo,u as pc,h as vc,i as Gs,j as wc}from"./QInput.bd2b564a.js";import{u as Sc,a as kc,n as js}from"./use-prevent-scroll.dc36eeaa.js";import{Q as Li}from"./QSlideTransition.aa4a01b3.js";import{a as _c,b as Ac}from"./index.431f1c80.js";import{T as Ic}from"./constants.1feedd04.js";const Rc=[P("rect",{x:"0",y:"0",width:"100",height:"100",fill:"none"}),P("g",{transform:"translate(25 25)"},[P("rect",{x:"-20",y:"-20",width:"40",height:"40",fill:"currentColor",opacity:"0.9"},[P("animateTransform",{attributeName:"transform",type:"scale",from:"1.5",to:"1",repeatCount:"indefinite",begin:"0s",dur:"1s",calcMode:"spline",keySplines:"0.2 0.8 0.2 0.8",keyTimes:"0;1"})])]),P("g",{transform:"translate(75 25)"},[P("rect",{x:"-20",y:"-20",width:"40",height:"40",fill:"currentColor",opacity:"0.8"},[P("animateTransform",{attributeName:"transform",type:"scale",from:"1.5",to:"1",repeatCount:"indefinite",begin:"0.1s",dur:"1s",calcMode:"spline",keySplines:"0.2 0.8 0.2 0.8",keyTimes:"0;1"})])]),P("g",{transform:"translate(25 75)"},[P("rect",{x:"-20",y:"-20",width:"40",height:"40",fill:"currentColor",opacity:"0.7"},[P("animateTransform",{attributeName:"transform",type:"scale",from:"1.5",to:"1",repeatCount:"indefinite",begin:"0.3s",dur:"1s",calcMode:"spline",keySplines:"0.2 0.8 0.2 0.8",keyTimes:"0;1"})])]),P("g",{transform:"translate(75 75)"},[P("rect",{x:"-20",y:"-20",width:"40",height:"40",fill:"currentColor",opacity:"0.6"},[P("animateTransform",{attributeName:"transform",type:"scale",from:"1.5",to:"1",repeatCount:"indefinite",begin:"0.2s",dur:"1s",calcMode:"spline",keySplines:"0.2 0.8 0.2 0.8",keyTimes:"0;1"})])])];var kg=en({name:"QSpinnerCube",props:Eu,setup(n){const{cSize:e,classes:t}=Bu(n);return()=>P("svg",{class:t.value,width:e.value,height:e.value,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid"},Rc)}}),Pc=en({name:"QTh",props:{props:Object,autoWidth:Boolean},emits:["click"],setup(n,{slots:e,emit:t}){const r=vn(),{proxy:{$q:i}}=r,s=o=>{t("click",o)};return()=>{if(n.props===void 0)return P("th",{class:n.autoWidth===!0?"q-table--col-auto-width":"",onClick:s},ui(e.default));let o,a;const c=r.vnode.key;if(c){if(o=n.props.colsMap[c],o===void 0)return}else o=n.props.col;if(o.sortable===!0){const l=o.align==="right"?"unshift":"push";a=Cu(e.default,[]),a[l](P(sr,{class:o.__iconClass,name:i.iconSet.table.arrowUp}))}else a=ui(e.default);const d={class:o.__thClass+(n.autoWidth===!0?" q-table--col-auto-width":""),style:o.headerStyle,onClick:l=>{o.sortable===!0&&n.props.sort(o),s(l)}};return P("th",d,a)}}});const Tc=["horizontal","vertical","cell","none"];var Ec=en({name:"QMarkupTable",props:{...mi,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:n=>Tc.includes(n)}},setup(n,{slots:e}){const t=vn(),r=pi(n,t.proxy.$q),i=O(()=>`q-markup-table q-table__container q-table__card q-table--${n.separator}-separator`+(r.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(n.dense===!0?" q-table--dense":"")+(n.flat===!0?" q-table--flat":"")+(n.bordered===!0?" q-table--bordered":"")+(n.square===!0?" q-table--square":"")+(n.wrapCells===!1?" q-table--no-wrap":""));return()=>P("div",{class:i.value},[P("table",{class:"q-table"},ui(e.default))])}});function Co(n,e){return P("div",n,[P("table",{class:"q-table"},e)])}const Vt=1e3,Bc=["start","center","end","start-force","center-force","end-force"],Oo=Array.prototype.filter,Cc=window.getComputedStyle(document.body).overflowAnchor===void 0?Ou:function(n,e){n!==null&&(n._qOverflowAnimationFrame!==void 0&&cancelAnimationFrame(n._qOverflowAnimationFrame),n._qOverflowAnimationFrame=requestAnimationFrame(()=>{if(n===null)return;n._qOverflowAnimationFrame=void 0;const t=n.children||[];Oo.call(t,i=>i.dataset&&i.dataset.qVsAnchor!==void 0).forEach(i=>{delete i.dataset.qVsAnchor});const r=t[e];r&&r.dataset&&(r.dataset.qVsAnchor="")}))};function or(n,e){return n+e}function Ni(n,e,t,r,i,s,o,a){const c=n===window?document.scrollingElement||document.documentElement:n,d=i===!0?"offsetWidth":"offsetHeight",l={scrollStart:0,scrollViewSize:-o-a,scrollMaxSize:0,offsetStart:-o,offsetEnd:-a};if(i===!0?(n===window?(l.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,l.scrollViewSize+=document.documentElement.clientWidth):(l.scrollStart=c.scrollLeft,l.scrollViewSize+=c.clientWidth),l.scrollMaxSize=c.scrollWidth,s===!0&&(l.scrollStart=(Hi===!0?l.scrollMaxSize-l.scrollViewSize:0)-l.scrollStart)):(n===window?(l.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,l.scrollViewSize+=document.documentElement.clientHeight):(l.scrollStart=c.scrollTop,l.scrollViewSize+=c.clientHeight),l.scrollMaxSize=c.scrollHeight),t!==null)for(let g=t.previousElementSibling;g!==null;g=g.previousElementSibling)g.classList.contains("q-virtual-scroll--skip")===!1&&(l.offsetStart+=g[d]);if(r!==null)for(let g=r.nextElementSibling;g!==null;g=g.nextElementSibling)g.classList.contains("q-virtual-scroll--skip")===!1&&(l.offsetEnd+=g[d]);if(e!==n){const g=c.getBoundingClientRect(),w=e.getBoundingClientRect();i===!0?(l.offsetStart+=w.left-g.left,l.offsetEnd-=w.width):(l.offsetStart+=w.top-g.top,l.offsetEnd-=w.height),n!==window&&(l.offsetStart+=l.scrollStart),l.offsetEnd+=l.scrollMaxSize-l.offsetStart}return l}function Ys(n,e,t,r){e==="end"&&(e=(n===window?document.body:n)[t===!0?"scrollWidth":"scrollHeight"]),n===window?t===!0?(r===!0&&(e=(Hi===!0?document.body.scrollWidth-document.documentElement.clientWidth:0)-e),window.scrollTo(e,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,e):t===!0?(r===!0&&(e=(Hi===!0?n.scrollWidth-n.offsetWidth:0)-e),n.scrollLeft=e):n.scrollTop=e}function Ir(n,e,t,r){if(t>=r)return 0;const i=e.length,s=Math.floor(t/Vt),o=Math.floor((r-1)/Vt)+1;let a=n.slice(s,o).reduce(or,0);return t%Vt!==0&&(a-=e.slice(s*Vt,t).reduce(or,0)),r%Vt!==0&&r!==i&&(a-=e.slice(r,o*Vt).reduce(or,0)),a}const xo={virtualScrollSliceSize:{type:[Number,String],default:null},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},Lo=Object.keys(xo),No={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...xo};function zo({virtualScrollLength:n,getVirtualScrollTarget:e,getVirtualScrollEl:t,virtualScrollItemSizeComputed:r}){const i=vn(),{props:s,emit:o,proxy:a}=i,{$q:c}=a;let d,l,g,w=[],h;const b=Te(0),v=Te(0),p=Te({}),m=Te(null),_=Te(null),A=Te(null),T=Te({from:0,to:0}),x=O(()=>s.tableColspan!==void 0?s.tableColspan:100);r===void 0&&(r=O(()=>s.virtualScrollItemSize));const C=O(()=>r.value+";"+s.virtualScrollHorizontal),te=O(()=>C.value+";"+s.virtualScrollSliceRatioBefore+";"+s.virtualScrollSliceRatioAfter);st(te,()=>{Ne()}),st(C,oe);function oe(){Je(l,!0)}function fe(R){Je(R===void 0?l:R)}function j(R,K){const ue=e();if(ue==null||ue.nodeType===8)return;const ye=Ni(ue,t(),m.value,_.value,s.virtualScrollHorizontal,c.lang.rtl,s.virtualScrollStickySizeStart,s.virtualScrollStickySizeEnd);g!==ye.scrollViewSize&&Ne(ye.scrollViewSize),Le(ue,ye,Math.min(n.value-1,Math.max(0,parseInt(R,10)||0)),0,Bc.indexOf(K)>-1?K:l>-1&&R>l?"end":"start")}function pe(){const R=e();if(R==null||R.nodeType===8)return;const K=Ni(R,t(),m.value,_.value,s.virtualScrollHorizontal,c.lang.rtl,s.virtualScrollStickySizeStart,s.virtualScrollStickySizeEnd),ue=n.value-1,ye=K.scrollMaxSize-K.offsetStart-K.offsetEnd-v.value;if(d===K.scrollStart)return;if(K.scrollMaxSize<=0){Le(R,K,0,0);return}g!==K.scrollViewSize&&Ne(K.scrollViewSize),ht(T.value.from);const M=Math.floor(K.scrollMaxSize-Math.max(K.scrollViewSize,K.offsetEnd)-Math.min(h[ue],K.scrollViewSize/2));if(M>0&&Math.ceil(K.scrollStart)>=M){Le(R,K,ue,K.scrollMaxSize-K.offsetEnd-w.reduce(or,0));return}let F=0,ne=K.scrollStart-K.offsetStart,Y=ne;if(ne<=ye&&ne+K.scrollViewSize>=b.value)ne-=b.value,F=T.value.from,Y=ne;else for(let ee=0;ne>=w[ee]&&F<ue;ee++)ne-=w[ee],F+=Vt;for(;ne>0&&F<ue;)ne-=h[F],ne>-K.scrollViewSize?(F++,Y=ne):Y=h[F]+ne;Le(R,K,F,Y)}function Le(R,K,ue,ye,M){const F=typeof M=="string"&&M.indexOf("-force")>-1,ne=F===!0?M.replace("-force",""):M,Y=ne!==void 0?ne:"start";let ee=Math.max(0,ue-p.value[Y]),ze=ee+p.value.total;ze>n.value&&(ze=n.value,ee=Math.max(0,ze-p.value.total)),d=K.scrollStart;const Be=ee!==T.value.from||ze!==T.value.to;if(Be===!1&&ne===void 0){ut(ue);return}const{activeElement:Rt}=document,Fe=A.value;Be===!0&&Fe!==null&&Fe!==Rt&&Fe.contains(Rt)===!0&&(Fe.addEventListener("focusout",It),setTimeout(()=>{Fe!==null&&Fe.removeEventListener("focusout",It)})),Cc(Fe,ue-ee);const pt=ne!==void 0?h.slice(ee,ue).reduce(or,0):0;if(Be===!0){const Qe=ze>=T.value.from&&ee<=T.value.to?T.value.to:ze;T.value={from:ee,to:Qe},b.value=Ir(w,h,0,ee),v.value=Ir(w,h,ze,n.value),requestAnimationFrame(()=>{T.value.to!==ze&&d===K.scrollStart&&(T.value={from:T.value.from,to:ze},v.value=Ir(w,h,ze,n.value))})}requestAnimationFrame(()=>{if(d!==K.scrollStart)return;Be===!0&&ht(ee);const Qe=h.slice(ee,ue).reduce(or,0),ct=Qe+K.offsetStart+b.value,Pt=ct+h[ue];let Ht=ct+ye;if(ne!==void 0){const xn=Qe-pt,un=K.scrollStart+xn;Ht=F!==!0&&un<ct&&Pt<un+K.scrollViewSize?un:ne==="end"?Pt-K.scrollViewSize:ct-(ne==="start"?0:Math.round((K.scrollViewSize-h[ue])/2))}d=Ht,Ys(R,Ht,s.virtualScrollHorizontal,c.lang.rtl),ut(ue)})}function ht(R){const K=A.value;if(K){const ue=Oo.call(K.children,ee=>ee.classList&&ee.classList.contains("q-virtual-scroll--skip")===!1),ye=ue.length,M=s.virtualScrollHorizontal===!0?ee=>ee.getBoundingClientRect().width:ee=>ee.offsetHeight;let F=R,ne,Y;for(let ee=0;ee<ye;){for(ne=M(ue[ee]),ee++;ee<ye&&ue[ee].classList.contains("q-virtual-scroll--with-prev")===!0;)ne+=M(ue[ee]),ee++;Y=ne-h[F],Y!==0&&(h[F]+=Y,w[Math.floor(F/Vt)]+=Y),F++}}}function It(){A.value!==null&&A.value!==void 0&&A.value.focus()}function Je(R,K){const ue=1*r.value;(K===!0||Array.isArray(h)===!1)&&(h=[]);const ye=h.length;h.length=n.value;for(let F=n.value-1;F>=ye;F--)h[F]=ue;const M=Math.floor((n.value-1)/Vt);w=[];for(let F=0;F<=M;F++){let ne=0;const Y=Math.min((F+1)*Vt,n.value);for(let ee=F*Vt;ee<Y;ee++)ne+=h[ee];w.push(ne)}l=-1,d=void 0,b.value=Ir(w,h,0,T.value.from),v.value=Ir(w,h,T.value.to,n.value),R>=0?(ht(T.value.from),Jt(()=>{j(R)})):Ge()}function Ne(R){if(R===void 0&&typeof window<"u"){const ne=e();ne!=null&&ne.nodeType!==8&&(R=Ni(ne,t(),m.value,_.value,s.virtualScrollHorizontal,c.lang.rtl,s.virtualScrollStickySizeStart,s.virtualScrollStickySizeEnd).scrollViewSize)}g=R;const K=parseFloat(s.virtualScrollSliceRatioBefore)||0,ue=parseFloat(s.virtualScrollSliceRatioAfter)||0,ye=1+K+ue,M=R===void 0||R<=0?1:Math.ceil(R/r.value),F=Math.max(1,M,Math.ceil((s.virtualScrollSliceSize>0?s.virtualScrollSliceSize:10)/ye));p.value={total:Math.ceil(F*ye),start:Math.ceil(F*K),center:Math.ceil(F*(.5+K)),end:Math.ceil(F*(1+K)),view:M}}function at(R,K){const ue=s.virtualScrollHorizontal===!0?"width":"height",ye={["--q-virtual-scroll-item-"+ue]:r.value+"px"};return[R==="tbody"?P(R,{class:"q-virtual-scroll__padding",key:"before",ref:m},[P("tr",[P("td",{style:{[ue]:`${b.value}px`,...ye},colspan:x.value})])]):P(R,{class:"q-virtual-scroll__padding",key:"before",ref:m,style:{[ue]:`${b.value}px`,...ye}}),P(R,{class:"q-virtual-scroll__content",key:"content",ref:A,tabindex:-1},K.flat()),R==="tbody"?P(R,{class:"q-virtual-scroll__padding",key:"after",ref:_},[P("tr",[P("td",{style:{[ue]:`${v.value}px`,...ye},colspan:x.value})])]):P(R,{class:"q-virtual-scroll__padding",key:"after",ref:_,style:{[ue]:`${v.value}px`,...ye}})]}function ut(R){l!==R&&(s.onVirtualScroll!==void 0&&o("virtualScroll",{index:R,from:T.value.from,to:T.value.to-1,direction:R<l?"decrease":"increase",ref:a}),l=R)}Ne();const Ge=xu(pe,c.platform.is.ios===!0?120:35);ns(()=>{Ne()});let We=!1;return wo(()=>{We=!0}),So(()=>{if(We!==!0)return;const R=e();d!==void 0&&R!==void 0&&R!==null&&R.nodeType!==8?Ys(R,d,s.virtualScrollHorizontal,c.lang.rtl):j(l)}),Nr(()=>{Ge.cancel()}),Object.assign(a,{scrollTo:j,reset:oe,refresh:fe}),{virtualScrollSliceRange:T,virtualScrollSliceSizeComputed:p,setVirtualScrollSize:Ne,onVirtualScrollEvt:Ge,localResetVirtualScroll:Je,padVirtualScroll:at,scrollTo:j,reset:oe,refresh:fe}}const Oc={list:tc,table:Ec},xc=["list","table","__qtable"];var Lc=en({name:"QVirtualScroll",props:{...No,type:{type:String,default:"list",validator:n=>xc.includes(n)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:{default:void 0}},setup(n,{slots:e,attrs:t}){let r;const i=Te(null),s=O(()=>n.itemsSize>=0&&n.itemsFn!==void 0?parseInt(n.itemsSize,10):Array.isArray(n.items)?n.items.length:0),{virtualScrollSliceRange:o,localResetVirtualScroll:a,padVirtualScroll:c,onVirtualScrollEvt:d}=zo({virtualScrollLength:s,getVirtualScrollTarget:b,getVirtualScrollEl:h}),l=O(()=>{if(s.value===0)return[];const _=(A,T)=>({index:o.value.from+T,item:A});return n.itemsFn===void 0?n.items.slice(o.value.from,o.value.to).map(_):n.itemsFn(o.value.from,o.value.to-o.value.from).map(_)}),g=O(()=>"q-virtual-scroll q-virtual-scroll"+(n.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(n.scrollTarget!==void 0?"":" scroll")),w=O(()=>n.scrollTarget!==void 0?{}:{tabindex:0});st(s,()=>{a()}),st(()=>n.scrollTarget,()=>{p(),v()});function h(){return i.value.$el||i.value}function b(){return r}function v(){r=nc(h(),n.scrollTarget),r.addEventListener("scroll",d,Ms.passive)}function p(){r!==void 0&&(r.removeEventListener("scroll",d,Ms.passive),r=void 0)}function m(){let _=c(n.type==="list"?"div":"tbody",l.value.map(e.default));return e.before!==void 0&&(_=e.before().concat(_)),rs(e.after,_)}return ns(()=>{a()}),ko(()=>{v()}),So(()=>{v()}),wo(()=>{p()}),Nr(()=>{p()}),()=>{if(e.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return n.type==="__qtable"?Co({ref:i,class:"q-table__middle "+g.value},m()):P(Oc[n.type],{...t,ref:i,class:[t.class,g.value],...w.value},m)}}}),Nc=en({name:"QField",inheritAttrs:!1,props:us,emits:To,setup(){return Eo(Bo())}});const zc={xs:8,sm:10,md:14,lg:20,xl:24};var Kc=en({name:"QChip",props:{...mi,..._o,dense:Boolean,icon:String,iconRight:String,iconRemove:String,iconSelected:String,label:[String,Number],color:String,textColor:String,modelValue:{type:Boolean,default:!0},selected:{type:Boolean,default:null},square:Boolean,outline:Boolean,clickable:Boolean,removable:Boolean,removeAriaLabel:String,tabindex:[String,Number],disable:Boolean,ripple:{type:[Boolean,Object],default:!0}},emits:["update:modelValue","update:selected","remove","click"],setup(n,{slots:e,emit:t}){const{proxy:{$q:r}}=vn(),i=pi(n,r),s=Ao(n,zc),o=O(()=>n.selected===!0||n.icon!==void 0),a=O(()=>n.selected===!0?n.iconSelected||r.iconSet.chip.selected:n.icon),c=O(()=>n.iconRemove||r.iconSet.chip.remove),d=O(()=>n.disable===!1&&(n.clickable===!0||n.selected!==null)),l=O(()=>{const p=n.outline===!0&&n.color||n.textColor;return"q-chip row inline no-wrap items-center"+(n.outline===!1&&n.color!==void 0?` bg-${n.color}`:"")+(p?` text-${p} q-chip--colored`:"")+(n.disable===!0?" disabled":"")+(n.dense===!0?" q-chip--dense":"")+(n.outline===!0?" q-chip--outline":"")+(n.selected===!0?" q-chip--selected":"")+(d.value===!0?" q-chip--clickable cursor-pointer non-selectable q-hoverable":"")+(n.square===!0?" q-chip--square":"")+(i.value===!0?" q-chip--dark q-dark":"")}),g=O(()=>{const p=n.disable===!0?{tabindex:-1,"aria-disabled":"true"}:{tabindex:n.tabindex||0},m={...p,role:"button","aria-hidden":"false","aria-label":n.removeAriaLabel||r.lang.label.remove};return{chip:p,remove:m}});function w(p){p.keyCode===13&&h(p)}function h(p){n.disable||(t("update:selected",!n.selected),t("click",p))}function b(p){(p.keyCode===void 0||p.keyCode===13)&&(Kn(p),n.disable===!1&&(t("update:modelValue",!1),t("remove")))}function v(){const p=[];d.value===!0&&p.push(P("div",{class:"q-focus-helper"})),o.value===!0&&p.push(P(sr,{class:"q-chip__icon q-chip__icon--left",name:a.value}));const m=n.label!==void 0?[P("div",{class:"ellipsis"},[n.label])]:void 0;return p.push(P("div",{class:"q-chip__content col row no-wrap items-center q-anchor--skip"},Nu(e.default,m))),n.iconRight&&p.push(P(sr,{class:"q-chip__icon q-chip__icon--right",name:n.iconRight})),n.removable===!0&&p.push(P(sr,{class:"q-chip__icon q-chip__icon--remove cursor-pointer",name:c.value,...g.value.remove,onClick:b,onKeyup:b})),p}return()=>{if(n.modelValue===!1)return;const p={class:l.value,style:s.value};return d.value===!0&&Object.assign(p,g.value.chip,{onClick:h,onKeyup:w}),Lu("div",p,v(),"ripple",n.ripple!==!1&&n.disable!==!0,()=>[[zu,n.ripple]])}}});let ri=0;const Mc={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},Js={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]};var Uc=en({name:"QDialog",inheritAttrs:!1,props:{...rc,...ic,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,position:{type:String,default:"standard",validator:n=>n==="standard"||["top","bottom","left","right"].includes(n)}},emits:[...sc,"shake","click","escapeKey"],setup(n,{slots:e,emit:t,attrs:r}){const i=vn(),s=Te(null),o=Te(!1),a=Te(!1);let c=null,d=null,l,g;const w=O(()=>n.persistent!==!0&&n.noRouteDismiss!==!0&&n.seamless!==!0),{preventBodyScroll:h}=kc(),{registerTimeout:b}=oc(),{registerTick:v,removeTick:p}=ac(),{transitionProps:m,transitionStyle:_}=uc(n,()=>Js[n.position][0],()=>Js[n.position][1]),{showPortal:A,hidePortal:T,portalIsAccessible:x,renderPortal:C}=cc(i,s,ye,"dialog"),{hide:te}=lc({showing:o,hideOnRouteChange:w,handleShow:It,handleHide:Je,processOnMount:!0}),{addToHistory:oe,removeFromHistory:fe}=Sc(o,te,w),j=O(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${n.maximized===!0?"maximized":"minimized"} q-dialog__inner--${n.position} ${Mc[n.position]}`+(a.value===!0?" q-dialog__inner--animating":"")+(n.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(n.fullHeight===!0?" q-dialog__inner--fullheight":"")+(n.square===!0?" q-dialog__inner--square":"")),pe=O(()=>o.value===!0&&n.seamless!==!0),Le=O(()=>n.autoClose===!0?{onClick:R}:{}),ht=O(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${pe.value===!0?"modal":"seamless"}`,r.class]);st(()=>n.maximized,M=>{o.value===!0&&We(M)}),st(pe,M=>{h(M),M===!0?(fc(ue),hc(ut)):($s(ue),Hs(ut))});function It(M){oe(),d=n.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,We(n.maximized),A(),a.value=!0,n.noFocus!==!0?(document.activeElement!==null&&document.activeElement.blur(),v(Ne)):p(),b(()=>{if(i.proxy.$q.platform.is.ios===!0){if(n.seamless!==!0&&document.activeElement){const{top:F,bottom:ne}=document.activeElement.getBoundingClientRect(),{innerHeight:Y}=window,ee=window.visualViewport!==void 0?window.visualViewport.height:Y;F>0&&ne>ee/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-ee,ne>=Y?1/0:Math.ceil(document.scrollingElement.scrollTop+ne-ee/2))),document.activeElement.scrollIntoView()}g=!0,s.value.click(),g=!1}A(!0),a.value=!1,t("show",M)},n.transitionDuration)}function Je(M){p(),fe(),Ge(!0),a.value=!0,T(),d!==null&&(((M&&M.type.indexOf("key")===0?d.closest('[tabindex]:not([tabindex^="-"])'):void 0)||d).focus(),d=null),b(()=>{T(!0),a.value=!1,t("hide",M)},n.transitionDuration)}function Ne(M){dc(()=>{let F=s.value;F===null||F.contains(document.activeElement)===!0||(F=(M!==""?F.querySelector(M):null)||F.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||F.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||F.querySelector("[autofocus], [data-autofocus]")||F,F.focus({preventScroll:!0}))})}function at(M){M&&typeof M.focus=="function"?M.focus({preventScroll:!0}):Ne(),t("shake");const F=s.value;F!==null&&(F.classList.remove("q-animate--scale"),F.classList.add("q-animate--scale"),c!==null&&clearTimeout(c),c=setTimeout(()=>{c=null,s.value!==null&&(F.classList.remove("q-animate--scale"),Ne())},170))}function ut(){n.seamless!==!0&&(n.persistent===!0||n.noEscDismiss===!0?n.maximized!==!0&&n.noShake!==!0&&at():(t("escapeKey"),te()))}function Ge(M){c!==null&&(clearTimeout(c),c=null),(M===!0||o.value===!0)&&(We(!1),n.seamless!==!0&&(h(!1),$s(ue),Hs(ut))),M!==!0&&(d=null)}function We(M){M===!0?l!==!0&&(ri<1&&document.body.classList.add("q-body--dialog"),ri++,l=!0):l===!0&&(ri<2&&document.body.classList.remove("q-body--dialog"),ri--,l=!1)}function R(M){g!==!0&&(te(M),t("click",M))}function K(M){n.persistent!==!0&&n.noBackdropDismiss!==!0?te(M):n.noShake!==!0&&at()}function ue(M){n.allowFocusOutside!==!0&&x.value===!0&&Ku(s.value,M.target)!==!0&&Ne('[tabindex]:not([tabindex="-1"])')}Object.assign(i.proxy,{focus:Ne,shake:at,__updateRefocusTarget(M){d=M||null}}),Nr(Ge);function ye(){return P("div",{role:"dialog","aria-modal":pe.value===!0?"true":"false",...r,class:ht.value},[P(Us,{name:"q-transition--fade",appear:!0},()=>pe.value===!0?P("div",{class:"q-dialog__backdrop fixed-full",style:_.value,"aria-hidden":"true",tabindex:-1,onClick:K}):null),P(Us,m.value,()=>o.value===!0?P("div",{ref:s,class:j.value,style:_.value,tabindex:-1,...Le.value},ui(e.default)):null)])}return C}});const Qs=n=>["add","add-unique","toggle"].includes(n),qc=".*+?^${}()|[]\\",Wc=Object.keys(us);var Fc=en({name:"QSelect",inheritAttrs:!1,props:{...No,...pc,...us,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:Qs},mapOptions:Boolean,emitValue:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:String,transitionHide:String,transitionDuration:[String,Number],behavior:{type:String,validator:n=>["default","menu","dialog"].includes(n),default:"default"},virtualScrollItemSize:{type:[Number,String],default:void 0},onNewValue:Function,onFilter:Function},emits:[...To,"add","remove","inputValue","newValue","keyup","keypress","keydown","filterAbort"],setup(n,{slots:e,emit:t}){const{proxy:r}=vn(),{$q:i}=r,s=Te(!1),o=Te(!1),a=Te(-1),c=Te(""),d=Te(!1),l=Te(!1);let g=null,w=null,h,b,v,p=null,m,_,A,T;const x=Te(null),C=Te(null),te=Te(null),oe=Te(null),fe=Te(null),j=vc(n),pe=wc(H),Le=O(()=>Array.isArray(n.options)?n.options.length:0),ht=O(()=>n.virtualScrollItemSize===void 0?n.optionsDense===!0?24:48:n.virtualScrollItemSize),{virtualScrollSliceRange:It,virtualScrollSliceSizeComputed:Je,localResetVirtualScroll:Ne,padVirtualScroll:at,onVirtualScrollEvt:ut,scrollTo:Ge,setVirtualScrollSize:We}=zo({virtualScrollLength:Le,getVirtualScrollTarget:vr,getVirtualScrollEl:Zn,virtualScrollItemSizeComputed:ht}),R=Bo(),K=O(()=>{const y=n.mapOptions===!0&&n.multiple!==!0,V=n.modelValue!==void 0&&(n.modelValue!==null||y===!0)?n.multiple===!0&&Array.isArray(n.modelValue)?n.modelValue:[n.modelValue]:[];if(n.mapOptions===!0&&Array.isArray(n.options)===!0){const q=n.mapOptions===!0&&h!==void 0?h:[],ce=V.map(Re=>Qn(Re,q));return n.modelValue===null&&y===!0?ce.filter(Re=>Re!==null):ce}return V}),ue=O(()=>{const y={};return Wc.forEach(V=>{const q=n[V];q!==void 0&&(y[V]=q)}),y}),ye=O(()=>n.optionsDark===null?R.isDark.value:n.optionsDark),M=O(()=>Gs(K.value)),F=O(()=>{let y="q-field__input q-placeholder col";return n.hideSelected===!0||K.value.length===0?[y,n.inputClass]:(y+=" q-field__input--padding",n.inputClass===void 0?y:[y,n.inputClass])}),ne=O(()=>(n.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(n.popupContentClass?" "+n.popupContentClass:"")),Y=O(()=>Le.value===0),ee=O(()=>K.value.map(y=>nt.value(y)).join(", ")),ze=O(()=>n.displayValue!==void 0?n.displayValue:ee.value),Be=O(()=>n.optionsHtml===!0?()=>!0:y=>y!=null&&y.html===!0),Rt=O(()=>n.displayValueHtml===!0||n.displayValue===void 0&&(n.optionsHtml===!0||K.value.some(Be.value))),Fe=O(()=>R.focused.value===!0?n.tabindex:-1),pt=O(()=>{const y={tabindex:n.tabindex,role:"combobox","aria-label":n.label,"aria-readonly":n.readonly===!0?"true":"false","aria-autocomplete":n.useInput===!0?"list":"none","aria-expanded":s.value===!0?"true":"false","aria-controls":`${R.targetUid.value}_lb`};return a.value>=0&&(y["aria-activedescendant"]=`${R.targetUid.value}_${a.value}`),y}),Qe=O(()=>({id:`${R.targetUid.value}_lb`,role:"listbox","aria-multiselectable":n.multiple===!0?"true":"false"})),ct=O(()=>K.value.map((y,V)=>({index:V,opt:y,html:Be.value(y),selected:!0,removeAtIndex:pr,toggleOption:Tt,tabindex:Fe.value}))),Pt=O(()=>{if(Le.value===0)return[];const{from:y,to:V}=It.value;return n.options.slice(y,V).map((q,ce)=>{const Re=qt.value(q)===!0,_e=y+ce,Oe={clickable:!0,active:!1,activeClass:un.value,manualFocus:!0,focused:!1,disable:Re,tabindex:-1,dense:n.optionsDense,dark:ye.value,role:"option",id:`${R.targetUid.value}_${_e}`,onClick:()=>{Tt(q)}};return Re!==!0&&(lt(q)===!0&&(Oe.active=!0),a.value===_e&&(Oe.focused=!0),Oe["aria-selected"]=Oe.active===!0?"true":"false",i.platform.is.desktop===!0&&(Oe.onMousemove=()=>{s.value===!0&&Xe(_e)})),{index:_e,opt:q,html:Be.value(q),label:nt.value(q),selected:Oe.active,focused:Oe.focused,toggleOption:Tt,setOptionIndex:Xe,itemProps:Oe}})}),Ht=O(()=>n.dropdownIcon!==void 0?n.dropdownIcon:i.iconSet.arrow.dropdown),xn=O(()=>n.optionsCover===!1&&n.outlined!==!0&&n.standout!==!0&&n.borderless!==!0&&n.rounded!==!0),un=O(()=>n.optionsSelectedClass!==void 0?n.optionsSelectedClass:n.color!==void 0?`text-${n.color}`:""),vt=O(()=>ln(n.optionValue,"value")),nt=O(()=>ln(n.optionLabel,"label")),qt=O(()=>ln(n.optionDisable,"disable")),cn=O(()=>K.value.map(y=>vt.value(y))),wn=O(()=>{const y={onInput:H,onChange:pe,onKeydown:Xn,onKeyup:_n,onKeypress:Gt,onFocus:Wt,onClick(V){b===!0&&nr(V)}};return y.onCompositionstart=y.onCompositionupdate=y.onCompositionend=pe,y});st(K,y=>{h=y,n.useInput===!0&&n.fillInput===!0&&n.multiple!==!0&&R.innerLoading.value!==!0&&(o.value!==!0&&s.value!==!0||M.value!==!0)&&(v!==!0&&Rn(),(o.value===!0||s.value===!0)&&le(""))},{immediate:!0}),st(()=>n.fillInput,Rn),st(s,Bt),st(Le,Ei);function Yn(y){return n.emitValue===!0?vt.value(y):y}function Sn(y){if(y>-1&&y<K.value.length)if(n.multiple===!0){const V=n.modelValue.slice();t("remove",{index:y,value:V.splice(y,1)[0]}),t("update:modelValue",V)}else t("update:modelValue",null)}function pr(y){Sn(y),R.focus()}function Jn(y,V){const q=Yn(y);if(n.multiple!==!0){n.fillInput===!0&&ie(nt.value(y),!0,!0),t("update:modelValue",q);return}if(K.value.length===0){t("add",{index:0,value:q}),t("update:modelValue",n.multiple===!0?[q]:q);return}if(V===!0&&lt(y)===!0||n.maxValues!==void 0&&n.modelValue.length>=n.maxValues)return;const ce=n.modelValue.slice();t("add",{index:ce.length,value:q}),ce.push(q),t("update:modelValue",ce)}function Tt(y,V){if(R.editable.value!==!0||y===void 0||qt.value(y)===!0)return;const q=vt.value(y);if(n.multiple!==!0){V!==!0&&(ie(n.fillInput===!0?nt.value(y):"",!0,!0),fn()),C.value!==null&&C.value.focus(),(K.value.length===0||kr(vt.value(K.value[0]),q)!==!0)&&t("update:modelValue",n.emitValue===!0?q:y);return}if((b!==!0||d.value===!0)&&R.focus(),Wt(),K.value.length===0){const _e=n.emitValue===!0?q:y;t("add",{index:0,value:_e}),t("update:modelValue",n.multiple===!0?[_e]:_e);return}const ce=n.modelValue.slice(),Re=cn.value.findIndex(_e=>kr(_e,q));if(Re>-1)t("remove",{index:Re,value:ce.splice(Re,1)[0]});else{if(n.maxValues!==void 0&&ce.length>=n.maxValues)return;const _e=n.emitValue===!0?q:y;t("add",{index:ce.length,value:_e}),ce.push(_e)}t("update:modelValue",ce)}function Xe(y){if(i.platform.is.desktop!==!0)return;const V=y>-1&&y<Le.value?y:-1;a.value!==V&&(a.value=V)}function gt(y=1,V){if(s.value===!0){let q=a.value;do q=js(q+y,-1,Le.value-1);while(q!==-1&&q!==a.value&&qt.value(n.options[q])===!0);a.value!==q&&(Xe(q),Ge(q),V!==!0&&n.useInput===!0&&n.fillInput===!0&&re(q>=0?nt.value(n.options[q]):m,!0))}}function Qn(y,V){const q=ce=>kr(vt.value(ce),y);return n.options.find(q)||V.find(q)||y}function ln(y,V){const q=y!==void 0?y:V;return typeof q=="function"?q:ce=>ce!==null&&typeof ce=="object"&&q in ce?ce[q]:ce}function lt(y){const V=vt.value(y);return cn.value.find(q=>kr(q,V))!==void 0}function Wt(y){n.useInput===!0&&C.value!==null&&(y===void 0||C.value===y.target&&y.target.value===ee.value)&&C.value.select()}function kn(y){qu(y,27)===!0&&s.value===!0&&(nr(y),fn(),Rn()),t("keyup",y)}function _n(y){const{value:V}=y.target;if(y.keyCode!==void 0){kn(y);return}if(y.target.value="",g!==null&&(clearTimeout(g),g=null),w!==null&&(clearTimeout(w),w=null),Rn(),typeof V=="string"&&V.length!==0){const q=V.toLocaleLowerCase(),ce=_e=>{const Oe=n.options.find(rt=>_e.value(rt).toLocaleLowerCase()===q);return Oe===void 0?!1:(K.value.indexOf(Oe)===-1?Tt(Oe):fn(),!0)},Re=_e=>{ce(vt)!==!0&&(ce(nt)===!0||_e===!0||le(V,!0,()=>Re(!0)))};Re()}else R.clearValue(y)}function Gt(y){t("keypress",y)}function Xn(y){if(t("keydown",y),Wu(y)===!0)return;const V=c.value.length!==0&&(n.newValueMode!==void 0||n.onNewValue!==void 0),q=y.shiftKey!==!0&&n.multiple!==!0&&(a.value>-1||V===!0);if(y.keyCode===27){xi(y);return}if(y.keyCode===9&&q===!1){An();return}if(y.target===void 0||y.target.id!==R.targetUid.value||R.editable.value!==!0)return;if(y.keyCode===40&&R.innerLoading.value!==!0&&s.value===!1){Kn(y),In();return}if(y.keyCode===8&&(n.useChips===!0||n.clearable===!0)&&n.hideSelected!==!0&&c.value.length===0){n.multiple===!0&&Array.isArray(n.modelValue)===!0?Sn(n.modelValue.length-1):n.multiple!==!0&&n.modelValue!==null&&t("update:modelValue",null);return}(y.keyCode===35||y.keyCode===36)&&(typeof c.value!="string"||c.value.length===0)&&(Kn(y),a.value=-1,gt(y.keyCode===36?1:-1,n.multiple)),(y.keyCode===33||y.keyCode===34)&&Je.value!==void 0&&(Kn(y),a.value=Math.max(-1,Math.min(Le.value,a.value+(y.keyCode===33?-1:1)*Je.value.view)),gt(y.keyCode===33?1:-1,n.multiple)),(y.keyCode===38||y.keyCode===40)&&(Kn(y),gt(y.keyCode===38?-1:1,n.multiple));const ce=Le.value;if((A===void 0||T<Date.now())&&(A=""),ce>0&&n.useInput!==!0&&y.key!==void 0&&y.key.length===1&&y.altKey===!1&&y.ctrlKey===!1&&y.metaKey===!1&&(y.keyCode!==32||A.length!==0)){s.value!==!0&&In(y);const Re=y.key.toLocaleLowerCase(),_e=A.length===1&&A[0]===Re;T=Date.now()+1500,_e===!1&&(Kn(y),A+=Re);const Oe=new RegExp("^"+A.split("").map(wr=>qc.indexOf(wr)>-1?"\\"+wr:wr).join(".*"),"i");let rt=a.value;if(_e===!0||rt<0||Oe.test(nt.value(n.options[rt]))!==!0)do rt=js(rt+1,-1,ce-1);while(rt!==a.value&&(qt.value(n.options[rt])===!0||Oe.test(nt.value(n.options[rt]))!==!0));a.value!==rt&&Jt(()=>{Xe(rt),Ge(rt),rt>=0&&n.useInput===!0&&n.fillInput===!0&&re(nt.value(n.options[rt]),!0)});return}if(!(y.keyCode!==13&&(y.keyCode!==32||n.useInput===!0||A!=="")&&(y.keyCode!==9||q===!1))){if(y.keyCode!==9&&Kn(y),a.value>-1&&a.value<ce){Tt(n.options[a.value]);return}if(V===!0){const Re=(_e,Oe)=>{if(Oe){if(Qs(Oe)!==!0)return}else Oe=n.newValueMode;if(ie("",n.multiple!==!0,!0),_e==null)return;(Oe==="toggle"?Tt:Jn)(_e,Oe==="add-unique"),n.multiple!==!0&&(C.value!==null&&C.value.focus(),fn())};if(n.onNewValue!==void 0?t("newValue",c.value,Re):Re(c.value),n.multiple!==!0)return}s.value===!0?An():R.innerLoading.value!==!0&&In()}}function Zn(){return b===!0?fe.value:te.value!==null&&te.value.contentEl!==null?te.value.contentEl:void 0}function vr(){return Zn()}function Ln(){return n.hideSelected===!0?[]:e["selected-item"]!==void 0?ct.value.map(y=>e["selected-item"](y)).slice():e.selected!==void 0?[].concat(e.selected()):n.useChips===!0?ct.value.map((y,V)=>P(Kc,{key:"option-"+V,removable:R.editable.value===!0&&qt.value(y.opt)!==!0,dense:!0,textColor:n.color,tabindex:Fe.value,onRemove(){y.removeAtIndex(V)}},()=>P("span",{class:"ellipsis",[y.html===!0?"innerHTML":"textContent"]:nt.value(y.opt)}))):[P("span",{[Rt.value===!0?"innerHTML":"textContent"]:ze.value})]}function jt(){if(Y.value===!0)return e["no-option"]!==void 0?e["no-option"]({inputValue:c.value}):void 0;const y=e.option!==void 0?e.option:q=>P(mc,{key:q.index,...q.itemProps},()=>P(yc,()=>P(bc,()=>P("span",{[q.html===!0?"innerHTML":"textContent"]:q.label}))));let V=at("div",Pt.value.map(y));return e["before-options"]!==void 0&&(V=e["before-options"]().concat(V)),rs(e["after-options"],V)}function I(y,V){const q=V===!0?{...pt.value,...R.splitAttrs.attributes.value}:void 0,ce={ref:V===!0?C:void 0,key:"i_t",class:F.value,style:n.inputStyle,value:c.value!==void 0?c.value:"",type:"search",...q,id:V===!0?R.targetUid.value:void 0,maxlength:n.maxlength,autocomplete:n.autocomplete,"data-autofocus":y===!0||n.autofocus===!0||void 0,disabled:n.disable===!0,readonly:n.readonly===!0,...wn.value};return y!==!0&&b===!0&&(Array.isArray(ce.class)===!0?ce.class=[...ce.class,"no-pointer-events"]:ce.class+=" no-pointer-events"),P("input",ce)}function H(y){g!==null&&(clearTimeout(g),g=null),w!==null&&(clearTimeout(w),w=null),!(y&&y.target&&y.target.qComposing===!0)&&(re(y.target.value||""),v=!0,m=c.value,R.focused.value!==!0&&(b!==!0||d.value===!0)&&R.focus(),n.onFilter!==void 0&&(g=setTimeout(()=>{g=null,le(c.value)},n.inputDebounce)))}function re(y,V){c.value!==y&&(c.value=y,V===!0||n.inputDebounce===0||n.inputDebounce==="0"?t("inputValue",y):w=setTimeout(()=>{w=null,t("inputValue",y)},n.inputDebounce))}function ie(y,V,q){v=q!==!0,n.useInput===!0&&(re(y,!0),(V===!0||q!==!0)&&(m=y),V!==!0&&le(y))}function le(y,V,q){if(n.onFilter===void 0||V!==!0&&R.focused.value!==!0)return;R.innerLoading.value===!0?t("filterAbort"):(R.innerLoading.value=!0,l.value=!0),y!==""&&n.multiple!==!0&&K.value.length!==0&&v!==!0&&y===nt.value(K.value[0])&&(y="");const ce=setTimeout(()=>{s.value===!0&&(s.value=!1)},10);p!==null&&clearTimeout(p),p=ce,t("filter",y,(Re,_e)=>{(V===!0||R.focused.value===!0)&&p===ce&&(clearTimeout(p),typeof Re=="function"&&Re(),l.value=!1,Jt(()=>{R.innerLoading.value=!1,R.editable.value===!0&&(V===!0?s.value===!0&&fn():s.value===!0?Bt(!0):s.value=!0),typeof _e=="function"&&Jt(()=>{_e(r)}),typeof q=="function"&&Jt(()=>{q(r)})}))},()=>{R.focused.value===!0&&p===ce&&(clearTimeout(p),R.innerLoading.value=!1,l.value=!1),s.value===!0&&(s.value=!1)})}function Ke(){return P(gc,{ref:te,class:ne.value,style:n.popupContentStyle,modelValue:s.value,fit:n.menuShrink!==!0,cover:n.optionsCover===!0&&Y.value!==!0&&n.useInput!==!0,anchor:n.menuAnchor,self:n.menuSelf,offset:n.menuOffset,dark:ye.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,square:xn.value,transitionShow:n.transitionShow,transitionHide:n.transitionHide,transitionDuration:n.transitionDuration,separateClosePopup:!0,...Qe.value,onScrollPassive:ut,onBeforeShow:Fr,onBeforeHide:Ce,onShow:Et},jt)}function Ce(y){Dr(y),An()}function Et(){We()}function Ze(y){nr(y),C.value!==null&&C.value.focus(),d.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function Ft(y){nr(y),Jt(()=>{d.value=!1})}function Yt(){const y=[P(Nc,{class:`col-auto ${R.fieldClass.value}`,...ue.value,for:R.targetUid.value,dark:ye.value,square:!0,loading:l.value,itemAligned:!1,filled:!0,stackLabel:c.value.length!==0,...R.splitAttrs.listeners.value,onFocus:Ze,onBlur:Ft},{...e,rawControl:()=>R.getControl(!0),before:void 0,after:void 0})];return s.value===!0&&y.push(P("div",{ref:fe,class:ne.value+" scroll",style:n.popupContentStyle,...Qe.value,onClick:xi,onScrollPassive:ut},jt())),P(Uc,{ref:oe,modelValue:o.value,position:n.useInput===!0?"top":void 0,transitionShow:_,transitionHide:n.transitionHide,transitionDuration:n.transitionDuration,onBeforeShow:Fr,onBeforeHide:er,onHide:dn,onShow:Ti},()=>P("div",{class:"q-select__dialog"+(ye.value===!0?" q-select__dialog--dark q-dark":"")+(d.value===!0?" q-select__dialog--focused":"")},y))}function er(y){Dr(y),oe.value!==null&&oe.value.__updateRefocusTarget(R.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),R.focused.value=!1}function dn(y){fn(),R.focused.value===!1&&t("blur",y),Rn()}function Ti(){const y=document.activeElement;(y===null||y.id!==R.targetUid.value)&&C.value!==null&&C.value!==y&&C.value.focus(),We()}function An(){o.value!==!0&&(a.value=-1,s.value===!0&&(s.value=!1),R.focused.value===!1&&(p!==null&&(clearTimeout(p),p=null),R.innerLoading.value===!0&&(t("filterAbort"),R.innerLoading.value=!1,l.value=!1)))}function In(y){R.editable.value===!0&&(b===!0?(R.onControlFocusin(y),o.value=!0,Jt(()=>{R.focus()})):R.focus(),n.onFilter!==void 0?le(c.value):(Y.value!==!0||e["no-option"]!==void 0)&&(s.value=!0))}function fn(){o.value=!1,An()}function Rn(){n.useInput===!0&&ie(n.multiple!==!0&&n.fillInput===!0&&K.value.length!==0&&nt.value(K.value[0])||"",!0,!0)}function Bt(y){let V=-1;if(y===!0){if(K.value.length!==0){const q=vt.value(K.value[0]);V=n.options.findIndex(ce=>kr(vt.value(ce),q))}Ne(V)}Xe(V)}function Ei(y,V){s.value===!0&&R.innerLoading.value===!1&&(Ne(-1,!0),Jt(()=>{s.value===!0&&R.innerLoading.value===!1&&(y>V?Ne():Bt(!0))}))}function Wr(){o.value===!1&&te.value!==null&&te.value.updatePosition()}function Fr(y){y!==void 0&&nr(y),t("popupShow",y),R.hasPopupOpen=!0,R.onControlFocusin(y)}function Dr(y){y!==void 0&&nr(y),t("popupHide",y),R.hasPopupOpen=!1,R.onControlFocusout(y)}function Vr(){b=i.platform.is.mobile!==!0&&n.behavior!=="dialog"?!1:n.behavior!=="menu"&&(n.useInput===!0?e["no-option"]!==void 0||n.onFilter!==void 0||Y.value===!1:!0),_=i.platform.is.ios===!0&&b===!0&&n.useInput===!0?"fade":n.transitionShow}return Mu(Vr),Uu(Wr),Vr(),Nr(()=>{g!==null&&clearTimeout(g),w!==null&&clearTimeout(w)}),Object.assign(r,{showPopup:In,hidePopup:fn,removeAtIndex:Sn,add:Jn,toggleOption:Tt,getOptionIndex:()=>a.value,setOptionIndex:Xe,moveOptionSelection:gt,filter:le,updateMenuPosition:Wr,updateInputValue:ie,isOptionSelected:lt,getEmittingOptionValue:Yn,isOptionDisabled:(...y)=>qt.value.apply(null,y)===!0,getOptionValue:(...y)=>vt.value.apply(null,y),getOptionLabel:(...y)=>nt.value.apply(null,y)}),Object.assign(R,{innerValue:K,fieldClass:O(()=>`q-select q-field--auto-height q-select--with${n.useInput!==!0?"out":""}-input q-select--with${n.useChips!==!0?"out":""}-chips q-select--${n.multiple===!0?"multiple":"single"}`),inputRef:x,targetRef:C,hasValue:M,showPopup:In,floatingLabel:O(()=>n.hideSelected!==!0&&M.value===!0||typeof c.value=="number"||c.value.length!==0||Gs(n.displayValue)),getControlChild:()=>{if(R.editable.value!==!1&&(o.value===!0||Y.value!==!0||e["no-option"]!==void 0))return b===!0?Yt():Ke();R.hasPopupOpen===!0&&(R.hasPopupOpen=!1)},controlEvents:{onFocusin(y){R.onControlFocusin(y)},onFocusout(y){R.onControlFocusout(y,()=>{Rn(),An()})},onClick(y){if(xi(y),b!==!0&&s.value===!0){An(),C.value!==null&&C.value.focus();return}In(y)}},getControl:y=>{const V=Ln(),q=y===!0||o.value!==!0||b!==!0;if(n.useInput===!0)V.push(I(y,q));else if(R.editable.value===!0){const Re=q===!0?pt.value:void 0;V.push(P("input",{ref:q===!0?C:void 0,key:"d_t",class:"q-select__focus-target",id:q===!0?R.targetUid.value:void 0,value:ze.value,readonly:!0,"data-autofocus":y===!0||n.autofocus===!0||void 0,...Re,onKeydown:Xn,onKeyup:kn,onKeypress:Gt})),q===!0&&typeof n.autocomplete=="string"&&n.autocomplete.length!==0&&V.push(P("input",{class:"q-select__autocomplete-input",autocomplete:n.autocomplete,tabindex:-1,onKeyup:_n}))}if(j.value!==void 0&&n.disable!==!0&&cn.value.length!==0){const Re=cn.value.map(_e=>P("option",{value:_e,selected:!0}));V.push(P("select",{class:"hidden",name:j.value,multiple:n.multiple},Re))}const ce=n.useInput===!0||q!==!0?void 0:R.splitAttrs.attributes.value;return P("div",{class:"q-field__native row items-center",...ce,...R.splitAttrs.listeners.value},V)},getInnerAppend:()=>n.loading!==!0&&l.value!==!0&&n.hideDropdownIcon!==!0?[P(sr,{class:"q-select__dropdown-icon"+(s.value===!0?" rotate-180":""),name:Ht.value})]:null}),Eo(R)}});const Dc={xs:2,sm:4,md:6,lg:10,xl:14};function Xs(n,e,t){return{transform:e===!0?`translateX(${t.lang.rtl===!0?"-":""}100%) scale3d(${-n},1,1)`:`scale3d(${n},1,1)`}}var Vc=en({name:"QLinearProgress",props:{...mi,..._o,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(n,{slots:e}){const{proxy:t}=vn(),r=pi(n,t.$q),i=Ao(n,Dc),s=O(()=>n.indeterminate===!0||n.query===!0),o=O(()=>n.reverse!==n.query),a=O(()=>({...i.value!==null?i.value:{},"--q-linear-progress-speed":`${n.animationSpeed}ms`})),c=O(()=>"q-linear-progress"+(n.color!==void 0?` text-${n.color}`:"")+(n.reverse===!0||n.query===!0?" q-linear-progress--reverse":"")+(n.rounded===!0?" rounded-borders":"")),d=O(()=>Xs(n.buffer!==void 0?n.buffer:1,o.value,t.$q)),l=O(()=>`with${n.instantFeedback===!0?"out":""}-transition`),g=O(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${l.value} q-linear-progress__track--${r.value===!0?"dark":"light"}`+(n.trackColor!==void 0?` bg-${n.trackColor}`:"")),w=O(()=>Xs(s.value===!0?1:n.value,o.value,t.$q)),h=O(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${l.value} q-linear-progress__model--${s.value===!0?"in":""}determinate`),b=O(()=>({width:`${n.value*100}%`})),v=O(()=>`q-linear-progress__stripe absolute-${n.reverse===!0?"right":"left"} q-linear-progress__stripe--${l.value}`);return()=>{const p=[P("div",{class:g.value,style:d.value}),P("div",{class:h.value,style:w.value})];return n.stripe===!0&&s.value===!1&&p.push(P("div",{class:v.value,style:b.value})),P("div",{class:c.value,style:a.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":n.indeterminate===!0?void 0:n.value},rs(e.default,p))}}});let Rr=0;const $c={fullscreen:Boolean,noRouteFullscreenExit:Boolean},Hc=["update:fullscreen","fullscreen"];function Gc(){const n=vn(),{props:e,emit:t,proxy:r}=n;let i,s,o;const a=Te(!1);Fu(n)===!0&&st(()=>r.$route.fullPath,()=>{e.noRouteFullscreenExit!==!0&&l()}),st(()=>e.fullscreen,g=>{a.value!==g&&c()}),st(a,g=>{t("update:fullscreen",g),t("fullscreen",g)});function c(){a.value===!0?l():d()}function d(){a.value!==!0&&(a.value=!0,o=r.$el.parentNode,o.replaceChild(s,r.$el),document.body.appendChild(r.$el),Rr++,Rr===1&&document.body.classList.add("q-body--fullscreen-mixin"),i={handler:l},qs.add(i))}function l(){a.value===!0&&(i!==void 0&&(qs.remove(i),i=void 0),o.replaceChild(r.$el,s),a.value=!1,Rr=Math.max(0,Rr-1),Rr===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),r.$el.scrollIntoView!==void 0&&setTimeout(()=>{r.$el.scrollIntoView()})))}return ns(()=>{s=document.createElement("span")}),ko(()=>{e.fullscreen===!0&&d()}),Nr(l),Object.assign(r,{toggleFullscreen:c,setFullscreen:d,exitFullscreen:l}),{inFullscreen:a,toggleFullscreen:c}}function jc(n,e){return new Date(n)-new Date(e)}const Yc={sortMethod:Function,binaryStateSort:Boolean,columnSortOrder:{type:String,validator:n=>n==="ad"||n==="da",default:"ad"}};function Jc(n,e,t,r){const i=O(()=>{const{sortBy:a}=e.value;return a&&t.value.find(c=>c.name===a)||null}),s=O(()=>n.sortMethod!==void 0?n.sortMethod:(a,c,d)=>{const l=t.value.find(h=>h.name===c);if(l===void 0||l.field===void 0)return a;const g=d===!0?-1:1,w=typeof l.field=="function"?h=>l.field(h):h=>h[l.field];return a.sort((h,b)=>{let v=w(h),p=w(b);return l.rawSort!==void 0?l.rawSort(v,p,h,b)*g:v==null?-1*g:p==null?1*g:l.sort!==void 0?l.sort(v,p,h,b)*g:$i(v)===!0&&$i(p)===!0?(v-p)*g:Ws(v)===!0&&Ws(p)===!0?jc(v,p)*g:typeof v=="boolean"&&typeof p=="boolean"?(v-p)*g:([v,p]=[v,p].map(m=>(m+"").toLocaleString().toLowerCase()),v<p?-1*g:v===p?0:g)})});function o(a){let c=n.columnSortOrder;if(Du(a)===!0)a.sortOrder&&(c=a.sortOrder),a=a.name;else{const g=t.value.find(w=>w.name===a);g!==void 0&&g.sortOrder&&(c=g.sortOrder)}let{sortBy:d,descending:l}=e.value;d!==a?(d=a,l=c==="da"):n.binaryStateSort===!0?l=!l:l===!0?c==="ad"?d=null:l=!1:c==="ad"?l=!0:d=null,r({sortBy:d,descending:l,page:1})}return{columnToSort:i,computedSortMethod:s,sort:o}}const Qc={filter:[String,Object],filterMethod:Function};function Xc(n,e){const t=O(()=>n.filterMethod!==void 0?n.filterMethod:(r,i,s,o)=>{const a=i?i.toLowerCase():"";return r.filter(c=>s.some(d=>{const l=o(d,c)+"";return(l==="undefined"||l==="null"?"":l.toLowerCase()).indexOf(a)!==-1}))});return st(()=>n.filter,()=>{Jt(()=>{e({page:1},!0)})},{deep:!0}),{computedFilterMethod:t}}function Zc(n,e){for(const t in e)if(e[t]!==n[t])return!1;return!0}function Zs(n){return n.page<1&&(n.page=1),n.rowsPerPage!==void 0&&n.rowsPerPage<1&&(n.rowsPerPage=0),n}const el={pagination:Object,rowsPerPageOptions:{type:Array,default:()=>[5,7,10,15,20,25,50,0]},"onUpdate:pagination":[Function,Array]};function tl(n,e){const{props:t,emit:r}=n,i=Te(Object.assign({sortBy:null,descending:!1,page:1,rowsPerPage:t.rowsPerPageOptions.length!==0?t.rowsPerPageOptions[0]:5},t.pagination)),s=O(()=>{const l=t["onUpdate:pagination"]!==void 0?{...i.value,...t.pagination}:i.value;return Zs(l)}),o=O(()=>s.value.rowsNumber!==void 0);function a(l){c({pagination:l,filter:t.filter})}function c(l={}){Jt(()=>{r("request",{pagination:l.pagination||s.value,filter:l.filter||t.filter,getCellValue:e})})}function d(l,g){const w=Zs({...s.value,...l});if(Zc(s.value,w)===!0){o.value===!0&&g===!0&&a(w);return}if(o.value===!0){a(w);return}t.pagination!==void 0&&t["onUpdate:pagination"]!==void 0?r("update:pagination",w):i.value=w}return{innerPagination:i,computedPagination:s,isServerSide:o,requestServerInteraction:c,setPagination:d}}function nl(n,e,t,r,i,s){const{props:o,emit:a,proxy:{$q:c}}=n,d=O(()=>r.value===!0?t.value.rowsNumber||0:s.value),l=O(()=>{const{page:T,rowsPerPage:x}=t.value;return(T-1)*x}),g=O(()=>{const{page:T,rowsPerPage:x}=t.value;return T*x}),w=O(()=>t.value.page===1),h=O(()=>t.value.rowsPerPage===0?1:Math.max(1,Math.ceil(d.value/t.value.rowsPerPage))),b=O(()=>g.value===0?!0:t.value.page>=h.value),v=O(()=>(o.rowsPerPageOptions.includes(e.value.rowsPerPage)?o.rowsPerPageOptions:[e.value.rowsPerPage].concat(o.rowsPerPageOptions)).map(x=>({label:x===0?c.lang.table.allRows:""+x,value:x})));st(h,(T,x)=>{if(T===x)return;const C=t.value.page;T&&!C?i({page:1}):T<C&&i({page:T})});function p(){i({page:1})}function m(){const{page:T}=t.value;T>1&&i({page:T-1})}function _(){const{page:T,rowsPerPage:x}=t.value;g.value>0&&T*x<d.value&&i({page:T+1})}function A(){i({page:h.value})}return o["onUpdate:pagination"]!==void 0&&a("update:pagination",{...t.value}),{firstRowIndex:l,lastRowIndex:g,isFirstPage:w,isLastPage:b,pagesNumber:h,computedRowsPerPageOptions:v,computedRowsNumber:d,firstPage:p,prevPage:m,nextPage:_,lastPage:A}}const rl={selection:{type:String,default:"none",validator:n=>["single","multiple","none"].includes(n)},selected:{type:Array,default:()=>[]}},il=["update:selected","selection"];function sl(n,e,t,r){const i=O(()=>{const b={};return n.selected.map(r.value).forEach(v=>{b[v]=!0}),b}),s=O(()=>n.selection!=="none"),o=O(()=>n.selection==="single"),a=O(()=>n.selection==="multiple"),c=O(()=>t.value.length!==0&&t.value.every(b=>i.value[r.value(b)]===!0)),d=O(()=>c.value!==!0&&t.value.some(b=>i.value[r.value(b)]===!0)),l=O(()=>n.selected.length);function g(b){return i.value[b]===!0}function w(){e("update:selected",[])}function h(b,v,p,m){e("selection",{rows:v,added:p,keys:b,evt:m});const _=o.value===!0?p===!0?v:[]:p===!0?n.selected.concat(v):n.selected.filter(A=>b.includes(r.value(A))===!1);e("update:selected",_)}return{hasSelectionMode:s,singleSelection:o,multipleSelection:a,allRowsSelected:c,someRowsSelected:d,rowsSelectedNumber:l,isRowSelected:g,clearSelection:w,updateSelection:h}}function eo(n){return Array.isArray(n)?n.slice():[]}const ol={expanded:Array},al=["update:expanded"];function ul(n,e){const t=Te(eo(n.expanded));st(()=>n.expanded,o=>{t.value=eo(o)});function r(o){return t.value.includes(o)}function i(o){n.expanded!==void 0?e("update:expanded",o):t.value=o}function s(o,a){const c=t.value.slice(),d=c.indexOf(o);a===!0?d===-1&&(c.push(o),i(c)):d!==-1&&(c.splice(d,1),i(c))}return{isRowExpanded:r,setExpanded:i,updateExpanded:s}}const cl={visibleColumns:Array};function ll(n,e,t){const r=O(()=>{if(n.columns!==void 0)return n.columns;const a=n.rows[0];return a!==void 0?Object.keys(a).map(c=>({name:c,label:c.toUpperCase(),field:c,align:$i(a[c])?"right":"left",sortable:!0})):[]}),i=O(()=>{const{sortBy:a,descending:c}=e.value;return(n.visibleColumns!==void 0?r.value.filter(l=>l.required===!0||n.visibleColumns.includes(l.name)===!0):r.value).map(l=>{const g=l.align||"right",w=`text-${g}`;return{...l,align:g,__iconClass:`q-table__sort-icon q-table__sort-icon--${g}`,__thClass:w+(l.headerClasses!==void 0?" "+l.headerClasses:"")+(l.sortable===!0?" sortable":"")+(l.name===a?` sorted ${c===!0?"sort-desc":""}`:""),__tdStyle:l.style!==void 0?typeof l.style!="function"?()=>l.style:l.style:()=>null,__tdClass:l.classes!==void 0?typeof l.classes!="function"?()=>w+" "+l.classes:h=>w+" "+l.classes(h):()=>w}})}),s=O(()=>{const a={};return i.value.forEach(c=>{a[c.name]=c}),a}),o=O(()=>n.tableColspan!==void 0?n.tableColspan:i.value.length+(t.value===!0?1:0));return{colList:r,computedCols:i,computedColsMap:s,computedColspan:o}}const ii="q-table__bottom row items-center",Ko={};Lo.forEach(n=>{Ko[n]={}});var _g=en({name:"QTable",props:{rows:{type:Array,default:()=>[]},rowKey:{type:[String,Function],default:"id"},columns:Array,loading:Boolean,iconFirstPage:String,iconPrevPage:String,iconNextPage:String,iconLastPage:String,title:String,hideHeader:Boolean,grid:Boolean,gridHeader:Boolean,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,separator:{type:String,default:"horizontal",validator:n=>["horizontal","vertical","cell","none"].includes(n)},wrapCells:Boolean,virtualScroll:Boolean,virtualScrollTarget:{default:void 0},...Ko,noDataLabel:String,noResultsLabel:String,loadingLabel:String,selectedRowsLabel:Function,rowsPerPageLabel:String,paginationLabel:Function,color:{type:String,default:"grey-8"},titleClass:[String,Array,Object],tableStyle:[String,Array,Object],tableClass:[String,Array,Object],tableHeaderStyle:[String,Array,Object],tableHeaderClass:[String,Array,Object],cardContainerClass:[String,Array,Object],cardContainerStyle:[String,Array,Object],cardStyle:[String,Array,Object],cardClass:[String,Array,Object],hideBottom:Boolean,hideSelectedBanner:Boolean,hideNoData:Boolean,hidePagination:Boolean,onRowClick:Function,onRowDblclick:Function,onRowContextmenu:Function,...mi,...$c,...cl,...Qc,...el,...ol,...rl,...Yc},emits:["request","virtualScroll",...Hc,...al,...il],setup(n,{slots:e,emit:t}){const r=vn(),{proxy:{$q:i}}=r,s=pi(n,i),{inFullscreen:o,toggleFullscreen:a}=Gc(),c=O(()=>typeof n.rowKey=="function"?n.rowKey:I=>I[n.rowKey]),d=Te(null),l=Te(null),g=O(()=>n.grid!==!0&&n.virtualScroll===!0),w=O(()=>" q-table__card"+(s.value===!0?" q-table__card--dark q-dark":"")+(n.square===!0?" q-table--square":"")+(n.flat===!0?" q-table--flat":"")+(n.bordered===!0?" q-table--bordered":"")),h=O(()=>`q-table__container q-table--${n.separator}-separator column no-wrap`+(n.grid===!0?" q-table--grid":w.value)+(s.value===!0?" q-table--dark":"")+(n.dense===!0?" q-table--dense":"")+(n.wrapCells===!1?" q-table--no-wrap":"")+(o.value===!0?" fullscreen scroll":"")),b=O(()=>h.value+(n.loading===!0?" q-table--loading":""));st(()=>n.tableStyle+n.tableClass+n.tableHeaderStyle+n.tableHeaderClass+h.value,()=>{g.value===!0&&l.value!==null&&l.value.reset()});const{innerPagination:v,computedPagination:p,isServerSide:m,requestServerInteraction:_,setPagination:A}=tl(r,Xe),{computedFilterMethod:T}=Xc(n,A),{isRowExpanded:x,setExpanded:C,updateExpanded:te}=ul(n,t),oe=O(()=>{let I=n.rows;if(m.value===!0||I.length===0)return I;const{sortBy:H,descending:re}=p.value;return n.filter&&(I=T.value(I,n.filter,R.value,Xe)),ye.value!==null&&(I=M.value(n.rows===I?I.slice():I,H,re)),I}),fe=O(()=>oe.value.length),j=O(()=>{let I=oe.value;if(m.value===!0)return I;const{rowsPerPage:H}=p.value;return H!==0&&(ne.value===0&&n.rows!==I?I.length>Y.value&&(I=I.slice(0,Y.value)):I=I.slice(ne.value,Y.value)),I}),{hasSelectionMode:pe,singleSelection:Le,multipleSelection:ht,allRowsSelected:It,someRowsSelected:Je,rowsSelectedNumber:Ne,isRowSelected:at,clearSelection:ut,updateSelection:Ge}=sl(n,t,j,c),{colList:We,computedCols:R,computedColsMap:K,computedColspan:ue}=ll(n,p,pe),{columnToSort:ye,computedSortMethod:M,sort:F}=Jc(n,p,We,A),{firstRowIndex:ne,lastRowIndex:Y,isFirstPage:ee,isLastPage:ze,pagesNumber:Be,computedRowsPerPageOptions:Rt,computedRowsNumber:Fe,firstPage:pt,prevPage:Qe,nextPage:ct,lastPage:Pt}=nl(r,v,p,m,A,fe),Ht=O(()=>j.value.length===0),xn=O(()=>{const I={};return Lo.forEach(H=>{I[H]=n[H]}),I.virtualScrollItemSize===void 0&&(I.virtualScrollItemSize=n.dense===!0?28:48),I});function un(){g.value===!0&&l.value.reset()}function vt(){if(n.grid===!0)return jt();const I=n.hideHeader!==!0?lt:null;if(g.value===!0){const re=e["top-row"],ie=e["bottom-row"],le={default:Ke=>wn(Ke.item,e.body,Ke.index)};if(re!==void 0){const Ke=P("tbody",re({cols:R.value}));le.before=I===null?()=>Ke:()=>[I()].concat(Ke)}else I!==null&&(le.before=I);return ie!==void 0&&(le.after=()=>P("tbody",ie({cols:R.value}))),P(Lc,{ref:l,class:n.tableClass,style:n.tableStyle,...xn.value,scrollTarget:n.virtualScrollTarget,items:j.value,type:"__qtable",tableColspan:ue.value,onVirtualScroll:qt},le)}const H=[Yn()];return I!==null&&H.unshift(I()),Co({class:["q-table__middle scroll",n.tableClass],style:n.tableStyle},H)}function nt(I,H){if(l.value!==null){l.value.scrollTo(I,H);return}I=parseInt(I,10);const re=d.value.querySelector(`tbody tr:nth-of-type(${I+1})`);if(re!==null){const ie=d.value.querySelector(".q-table__middle.scroll"),le=re.offsetTop-n.virtualScrollStickySizeStart,Ke=le<ie.scrollTop?"decrease":"increase";ie.scrollTop=le,t("virtualScroll",{index:I,from:0,to:v.value.rowsPerPage-1,direction:Ke})}}function qt(I){t("virtualScroll",I)}function cn(){return[P(Vc,{class:"q-table__linear-progress",color:n.color,dark:s.value,indeterminate:!0,trackColor:"transparent"})]}function wn(I,H,re){const ie=c.value(I),le=at(ie);if(H!==void 0)return H(Sn({key:ie,row:I,pageIndex:re,__trClass:le?"selected":""}));const Ke=e["body-cell"],Ce=R.value.map(Ze=>{const Ft=e[`body-cell-${Ze.name}`],Yt=Ft!==void 0?Ft:Ke;return Yt!==void 0?Yt(pr({key:ie,row:I,pageIndex:re,col:Ze})):P("td",{class:Ze.__tdClass(I),style:Ze.__tdStyle(I)},Xe(Ze,I))});if(pe.value===!0){const Ze=e["body-selection"],Ft=Ze!==void 0?Ze(Jn({key:ie,row:I,pageIndex:re})):[P(Li,{modelValue:le,color:n.color,dark:s.value,dense:n.dense,"onUpdate:modelValue":(Yt,er)=>{Ge([ie],[I],Yt,er)}})];Ce.unshift(P("td",{class:"q-table--col-auto-width"},Ft))}const Et={key:ie,class:{selected:le}};return n.onRowClick!==void 0&&(Et.class["cursor-pointer"]=!0,Et.onClick=Ze=>{t("RowClick",Ze,I,re)}),n.onRowDblclick!==void 0&&(Et.class["cursor-pointer"]=!0,Et.onDblclick=Ze=>{t("RowDblclick",Ze,I,re)}),n.onRowContextmenu!==void 0&&(Et.class["cursor-pointer"]=!0,Et.onContextmenu=Ze=>{t("RowContextmenu",Ze,I,re)}),P("tr",Et,Ce)}function Yn(){const I=e.body,H=e["top-row"],re=e["bottom-row"];let ie=j.value.map((le,Ke)=>wn(le,I,Ke));return H!==void 0&&(ie=H({cols:R.value}).concat(ie)),re!==void 0&&(ie=ie.concat(re({cols:R.value}))),P("tbody",ie)}function Sn(I){return Tt(I),I.cols=I.cols.map(H=>_r({...H},"value",()=>Xe(H,I.row))),I}function pr(I){return Tt(I),_r(I,"value",()=>Xe(I.col,I.row)),I}function Jn(I){return Tt(I),I}function Tt(I){Object.assign(I,{cols:R.value,colsMap:K.value,sort:F,rowIndex:ne.value+I.pageIndex,color:n.color,dark:s.value,dense:n.dense}),pe.value===!0&&_r(I,"selected",()=>at(I.key),(H,re)=>{Ge([I.key],[I.row],H,re)}),_r(I,"expand",()=>x(I.key),H=>{te(I.key,H)})}function Xe(I,H){const re=typeof I.field=="function"?I.field(H):H[I.field];return I.format!==void 0?I.format(re,H):re}const gt=O(()=>({pagination:p.value,pagesNumber:Be.value,isFirstPage:ee.value,isLastPage:ze.value,firstPage:pt,prevPage:Qe,nextPage:ct,lastPage:Pt,inFullscreen:o.value,toggleFullscreen:a}));function Qn(){const I=e.top,H=e["top-left"],re=e["top-right"],ie=e["top-selection"],le=pe.value===!0&&ie!==void 0&&Ne.value>0,Ke="q-table__top relative-position row items-center";if(I!==void 0)return P("div",{class:Ke},[I(gt.value)]);let Ce;if(le===!0?Ce=ie(gt.value).slice():(Ce=[],H!==void 0?Ce.push(P("div",{class:"q-table__control"},[H(gt.value)])):n.title&&Ce.push(P("div",{class:"q-table__control"},[P("div",{class:["q-table__title",n.titleClass]},n.title)]))),re!==void 0&&(Ce.push(P("div",{class:"q-table__separator col"})),Ce.push(P("div",{class:"q-table__control"},[re(gt.value)]))),Ce.length!==0)return P("div",{class:Ke},Ce)}const ln=O(()=>Je.value===!0?null:It.value);function lt(){const I=Wt();return n.loading===!0&&e.loading===void 0&&I.push(P("tr",{class:"q-table__progress"},[P("th",{class:"relative-position",colspan:ue.value},cn())])),P("thead",I)}function Wt(){const I=e.header,H=e["header-cell"];if(I!==void 0)return I(kn({header:!0})).slice();const re=R.value.map(ie=>{const le=e[`header-cell-${ie.name}`],Ke=le!==void 0?le:H,Ce=kn({col:ie});return Ke!==void 0?Ke(Ce):P(Pc,{key:ie.name,props:Ce},()=>ie.label)});if(Le.value===!0&&n.grid!==!0)re.unshift(P("th",{class:"q-table--col-auto-width"}," "));else if(ht.value===!0){const ie=e["header-selection"],le=ie!==void 0?ie(kn({})):[P(Li,{color:n.color,modelValue:ln.value,dark:s.value,dense:n.dense,"onUpdate:modelValue":_n})];re.unshift(P("th",{class:"q-table--col-auto-width"},le))}return[P("tr",{class:n.tableHeaderClass,style:n.tableHeaderStyle},re)]}function kn(I){return Object.assign(I,{cols:R.value,sort:F,colsMap:K.value,color:n.color,dark:s.value,dense:n.dense}),ht.value===!0&&_r(I,"selected",()=>ln.value,_n),I}function _n(I){Je.value===!0&&(I=!1),Ge(j.value.map(c.value),j.value,I)}const Gt=O(()=>{const I=[n.iconFirstPage||i.iconSet.table.firstPage,n.iconPrevPage||i.iconSet.table.prevPage,n.iconNextPage||i.iconSet.table.nextPage,n.iconLastPage||i.iconSet.table.lastPage];return i.lang.rtl===!0?I.reverse():I});function Xn(){if(n.hideBottom===!0)return;if(Ht.value===!0){if(n.hideNoData===!0)return;const re=n.loading===!0?n.loadingLabel||i.lang.table.loading:n.filter?n.noResultsLabel||i.lang.table.noResults:n.noDataLabel||i.lang.table.noData,ie=e["no-data"],le=ie!==void 0?[ie({message:re,icon:i.iconSet.table.warning,filter:n.filter})]:[P(sr,{class:"q-table__bottom-nodata-icon",name:i.iconSet.table.warning}),re];return P("div",{class:ii+" q-table__bottom--nodata"},le)}const I=e.bottom;if(I!==void 0)return P("div",{class:ii},[I(gt.value)]);const H=n.hideSelectedBanner!==!0&&pe.value===!0&&Ne.value>0?[P("div",{class:"q-table__control"},[P("div",[(n.selectedRowsLabel||i.lang.table.selectedRecords)(Ne.value)])])]:[];if(n.hidePagination!==!0)return P("div",{class:ii+" justify-end"},vr(H));if(H.length!==0)return P("div",{class:ii},H)}function Zn(I){A({page:1,rowsPerPage:I.value})}function vr(I){let H;const{rowsPerPage:re}=p.value,ie=n.paginationLabel||i.lang.table.pagination,le=e.pagination,Ke=n.rowsPerPageOptions.length>1;if(I.push(P("div",{class:"q-table__separator col"})),Ke===!0&&I.push(P("div",{class:"q-table__control"},[P("span",{class:"q-table__bottom-item"},[n.rowsPerPageLabel||i.lang.table.recordsPerPage]),P(Fc,{class:"q-table__select inline q-table__bottom-item",color:n.color,modelValue:re,options:Rt.value,displayValue:re===0?i.lang.table.allRows:re,dark:s.value,borderless:!0,dense:!0,optionsDense:!0,optionsCover:!0,"onUpdate:modelValue":Zn})])),le!==void 0)H=le(gt.value);else if(H=[P("span",re!==0?{class:"q-table__bottom-item"}:{},[re?ie(ne.value+1,Math.min(Y.value,Fe.value),Fe.value):ie(1,fe.value,Fe.value)])],re!==0&&Be.value>1){const Ce={color:n.color,round:!0,dense:!0,flat:!0};n.dense===!0&&(Ce.size="sm"),Be.value>2&&H.push(P(ti,{key:"pgFirst",...Ce,icon:Gt.value[0],disable:ee.value,onClick:pt})),H.push(P(ti,{key:"pgPrev",...Ce,icon:Gt.value[1],disable:ee.value,onClick:Qe}),P(ti,{key:"pgNext",...Ce,icon:Gt.value[2],disable:ze.value,onClick:ct})),Be.value>2&&H.push(P(ti,{key:"pgLast",...Ce,icon:Gt.value[3],disable:ze.value,onClick:Pt}))}return I.push(P("div",{class:"q-table__control"},H)),I}function Ln(){const I=n.gridHeader===!0?[P("table",{class:"q-table"},[lt()])]:n.loading===!0&&e.loading===void 0?cn():void 0;return P("div",{class:"q-table__middle"},I)}function jt(){const I=e.item!==void 0?e.item:H=>{const re=H.cols.map(le=>P("div",{class:"q-table__grid-item-row"},[P("div",{class:"q-table__grid-item-title"},[le.label]),P("div",{class:"q-table__grid-item-value"},[le.value])]));if(pe.value===!0){const le=e["body-selection"],Ke=le!==void 0?le(H):[P(Li,{modelValue:H.selected,color:n.color,dark:s.value,dense:n.dense,"onUpdate:modelValue":(Ce,Et)=>{Ge([H.key],[H.row],Ce,Et)}})];re.unshift(P("div",{class:"q-table__grid-item-row"},Ke),P(ec,{dark:s.value}))}const ie={class:["q-table__grid-item-card"+w.value,n.cardClass],style:n.cardStyle};return(n.onRowClick!==void 0||n.onRowDblclick!==void 0)&&(ie.class[0]+=" cursor-pointer",n.onRowClick!==void 0&&(ie.onClick=le=>{t("RowClick",le,H.row,H.pageIndex)}),n.onRowDblclick!==void 0&&(ie.onDblclick=le=>{t("RowDblclick",le,H.row,H.pageIndex)})),P("div",{class:"q-table__grid-item col-xs-12 col-sm-6 col-md-4 col-lg-3"+(H.selected===!0?" q-table__grid-item--selected":"")},[P("div",ie,re)])};return P("div",{class:["q-table__grid-content row",n.cardContainerClass],style:n.cardContainerStyle},j.value.map((H,re)=>I(Sn({key:c.value(H),row:H,pageIndex:re}))))}return Object.assign(r.proxy,{requestServerInteraction:_,setPagination:A,firstPage:pt,prevPage:Qe,nextPage:ct,lastPage:Pt,isRowSelected:at,clearSelection:ut,isRowExpanded:x,setExpanded:C,sort:F,resetVirtualScroll:un,scrollTo:nt,getCellValue:Xe}),Vu(r.proxy,{filteredSortedRows:()=>oe.value,computedRows:()=>j.value,computedRowsNumber:()=>Fe.value}),()=>{const I=[Qn()],H={ref:d,class:b.value};return n.grid===!0?I.push(Ln()):Object.assign(H,{class:[H.class,n.cardClass],style:n.cardStyle}),I.push(vt(),Xn()),n.loading===!0&&e.loading!==void 0&&I.push(e.loading()),P("div",H,I)}}}),Mo={},Uo={},to=1/0,qo=9007199254740991,dl=17976931348623157e292,no=0/0,fl="[object Function]",hl="[object GeneratorFunction]",gl="[object Symbol]",yl=/^\s+|\s+$/g,bl=/^[-+]0x[0-9a-f]+$/i,ml=/^0b[01]+$/i,pl=/^0o[0-7]+$/i,vl=/^(?:0|[1-9]\d*)$/,wl=parseInt,Sl=Object.prototype,Wo=Sl.toString,kl=Math.ceil,_l=Math.max;function Al(n,e,t){var r=-1,i=n.length;e<0&&(e=-e>i?0:i+e),t=t>i?i:t,t<0&&(t+=i),i=e>t?0:t-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=n[r+e];return s}function Il(n,e){return e=e??qo,!!e&&(typeof n=="number"||vl.test(n))&&n>-1&&n%1==0&&n<e}function Rl(n,e,t){if(!ci(t))return!1;var r=typeof e;return(r=="number"?El(t)&&Il(e,t.length):r=="string"&&e in t)?Tl(t[e],n):!1}function Pl(n,e,t){(t?Rl(n,e,t):e===void 0)?e=1:e=_l(Nl(e),0);var r=n?n.length:0;if(!r||e<1)return[];for(var i=0,s=0,o=Array(kl(r/e));i<r;)o[s++]=Al(n,i,i+=e);return o}function Tl(n,e){return n===e||n!==n&&e!==e}function El(n){return n!=null&&Cl(n.length)&&!Bl(n)}function Bl(n){var e=ci(n)?Wo.call(n):"";return e==fl||e==hl}function Cl(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=qo}function ci(n){var e=typeof n;return!!n&&(e=="object"||e=="function")}function Ol(n){return!!n&&typeof n=="object"}function xl(n){return typeof n=="symbol"||Ol(n)&&Wo.call(n)==gl}function Ll(n){if(!n)return n===0?n:0;if(n=zl(n),n===to||n===-to){var e=n<0?-1:1;return e*dl}return n===n?n:0}function Nl(n){var e=Ll(n),t=e%1;return e===e?t?e-t:e:0}function zl(n){if(typeof n=="number")return n;if(xl(n))return no;if(ci(n)){var e=typeof n.valueOf=="function"?n.valueOf():n;n=ci(e)?e+"":e}if(typeof n!="string")return n===0?n:+n;n=n.replace(yl,"");var t=ml.test(n);return t||pl.test(n)?wl(n.slice(2),t?2:8):bl.test(n)?no:+n}var Kl=Pl,Gi={exports:{}};(function(n,e){var t=200,r="Expected a function",i="__lodash_hash_undefined__",s=1,o=2,a=1/0,c=9007199254740991,d="[object Arguments]",l="[object Array]",g="[object Boolean]",w="[object Date]",h="[object Error]",b="[object Function]",v="[object GeneratorFunction]",p="[object Map]",m="[object Number]",_="[object Object]",A="[object Promise]",T="[object RegExp]",x="[object Set]",C="[object String]",te="[object Symbol]",oe="[object WeakMap]",fe="[object ArrayBuffer]",j="[object DataView]",pe="[object Float32Array]",Le="[object Float64Array]",ht="[object Int8Array]",It="[object Int16Array]",Je="[object Int32Array]",Ne="[object Uint8Array]",at="[object Uint8ClampedArray]",ut="[object Uint16Array]",Ge="[object Uint32Array]",We=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,R=/^\w*$/,K=/^\./,ue=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ye=/[\\^$.*+?()[\]{}|]/g,M=/\\(\\)?/g,F=/^\[object .+?Constructor\]$/,ne=/^(?:0|[1-9]\d*)$/,Y={};Y[pe]=Y[Le]=Y[ht]=Y[It]=Y[Je]=Y[Ne]=Y[at]=Y[ut]=Y[Ge]=!0,Y[d]=Y[l]=Y[fe]=Y[g]=Y[j]=Y[w]=Y[h]=Y[b]=Y[p]=Y[m]=Y[_]=Y[T]=Y[x]=Y[C]=Y[oe]=!1;var ee=typeof $=="object"&&$&&$.Object===Object&&$,ze=typeof self=="object"&&self&&self.Object===Object&&self,Be=ee||ze||Function("return this")(),Rt=e&&!e.nodeType&&e,Fe=Rt&&!0&&n&&!n.nodeType&&n,pt=Fe&&Fe.exports===Rt,Qe=pt&&ee.process,ct=function(){try{return Qe&&Qe.binding("util")}catch{}}(),Pt=ct&&ct.isTypedArray;function Ht(u,f){for(var k=-1,E=u?u.length:0,Z=Array(E);++k<E;)Z[k]=f(u[k],k,u);return Z}function xn(u,f){for(var k=-1,E=u?u.length:0;++k<E;)if(f(u[k],k,u))return!0;return!1}function un(u){return function(f){return f==null?void 0:f[u]}}function vt(u,f){var k=u.length;for(u.sort(f);k--;)u[k]=u[k].value;return u}function nt(u,f){for(var k=-1,E=Array(u);++k<u;)E[k]=f(k);return E}function qt(u){return function(f){return u(f)}}function cn(u,f){return u==null?void 0:u[f]}function wn(u){var f=!1;if(u!=null&&typeof u.toString!="function")try{f=!!(u+"")}catch{}return f}function Yn(u){var f=-1,k=Array(u.size);return u.forEach(function(E,Z){k[++f]=[Z,E]}),k}function Sn(u,f){return function(k){return u(f(k))}}function pr(u){var f=-1,k=Array(u.size);return u.forEach(function(E){k[++f]=E}),k}var Jn=Array.prototype,Tt=Function.prototype,Xe=Object.prototype,gt=Be["__core-js_shared__"],Qn=function(){var u=/[^.]+$/.exec(gt&&gt.keys&&gt.keys.IE_PROTO||"");return u?"Symbol(src)_1."+u:""}(),ln=Tt.toString,lt=Xe.hasOwnProperty,Wt=Xe.toString,kn=RegExp("^"+ln.call(lt).replace(ye,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),_n=Be.Symbol,Gt=Be.Uint8Array,Xn=Xe.propertyIsEnumerable,Zn=Jn.splice,vr=Sn(Object.keys,Object),Ln=tr(Be,"DataView"),jt=tr(Be,"Map"),I=tr(Be,"Promise"),H=tr(Be,"Set"),re=tr(Be,"WeakMap"),ie=tr(Object,"create"),le=Nn(Ln),Ke=Nn(jt),Ce=Nn(I),Et=Nn(H),Ze=Nn(re),Ft=_n?_n.prototype:void 0,Yt=Ft?Ft.valueOf:void 0,er=Ft?Ft.toString:void 0;function dn(u){var f=-1,k=u?u.length:0;for(this.clear();++f<k;){var E=u[f];this.set(E[0],E[1])}}function Ti(){this.__data__=ie?ie(null):{}}function An(u){return this.has(u)&&delete this.__data__[u]}function In(u){var f=this.__data__;if(ie){var k=f[u];return k===i?void 0:k}return lt.call(f,u)?f[u]:void 0}function fn(u){var f=this.__data__;return ie?f[u]!==void 0:lt.call(f,u)}function Rn(u,f){var k=this.__data__;return k[u]=ie&&f===void 0?i:f,this}dn.prototype.clear=Ti,dn.prototype.delete=An,dn.prototype.get=In,dn.prototype.has=fn,dn.prototype.set=Rn;function Bt(u){var f=-1,k=u?u.length:0;for(this.clear();++f<k;){var E=u[f];this.set(E[0],E[1])}}function Ei(){this.__data__=[]}function Wr(u){var f=this.__data__,k=$r(f,u);if(k<0)return!1;var E=f.length-1;return k==E?f.pop():Zn.call(f,k,1),!0}function Fr(u){var f=this.__data__,k=$r(f,u);return k<0?void 0:f[k][1]}function Dr(u){return $r(this.__data__,u)>-1}function Vr(u,f){var k=this.__data__,E=$r(k,u);return E<0?k.push([u,f]):k[E][1]=f,this}Bt.prototype.clear=Ei,Bt.prototype.delete=Wr,Bt.prototype.get=Fr,Bt.prototype.has=Dr,Bt.prototype.set=Vr;function y(u){var f=-1,k=u?u.length:0;for(this.clear();++f<k;){var E=u[f];this.set(E[0],E[1])}}function V(){this.__data__={hash:new dn,map:new(jt||Bt),string:new dn}}function q(u){return Hr(this,u).delete(u)}function ce(u){return Hr(this,u).get(u)}function Re(u){return Hr(this,u).has(u)}function _e(u,f){return Hr(this,u).set(u,f),this}y.prototype.clear=V,y.prototype.delete=q,y.prototype.get=ce,y.prototype.has=Re,y.prototype.set=_e;function Oe(u){var f=-1,k=u?u.length:0;for(this.__data__=new y;++f<k;)this.add(u[f])}function rt(u){return this.__data__.set(u,i),this}function wr(u){return this.__data__.has(u)}Oe.prototype.add=Oe.prototype.push=rt,Oe.prototype.has=wr;function hn(u){this.__data__=new Bt(u)}function Wa(){this.__data__=new Bt}function Fa(u){return this.__data__.delete(u)}function Da(u){return this.__data__.get(u)}function Va(u){return this.__data__.has(u)}function $a(u,f){var k=this.__data__;if(k instanceof Bt){var E=k.__data__;if(!jt||E.length<t-1)return E.push([u,f]),this;k=this.__data__=new y(E)}return k.set(u,f),this}hn.prototype.clear=Wa,hn.prototype.delete=Fa,hn.prototype.get=Da,hn.prototype.has=Va,hn.prototype.set=$a;function Ha(u,f){var k=gn(u)||Ls(u)?nt(u.length,String):[],E=k.length,Z=!!E;for(var U in u)(f||lt.call(u,U))&&!(Z&&(U=="length"||Bs(U,E)))&&k.push(U);return k}function $r(u,f){for(var k=u.length;k--;)if(xs(u[k][0],f))return k;return-1}var Ga=fu(Ya),ja=hu();function Ya(u,f){return u&&ja(u,f,Xr)}function Ps(u,f){f=Gr(f,u)?[f]:Ts(f);for(var k=0,E=f.length;u!=null&&k<E;)u=u[jr(f[k++])];return k&&k==E?u:void 0}function Ja(u){return Wt.call(u)}function Qa(u,f){return u!=null&&f in Object(u)}function Bi(u,f,k,E,Z){return u===f?!0:u==null||f==null||!Jr(u)&&!Qr(f)?u!==u&&f!==f:Xa(u,f,Bi,k,E,Z)}function Xa(u,f,k,E,Z,U){var de=gn(u),ve=gn(f),me=l,Pe=l;de||(me=Pn(u),me=me==d?_:me),ve||(Pe=Pn(f),Pe=Pe==d?_:Pe);var yt=me==_&&!wn(u),wt=Pe==_&&!wn(f),et=me==Pe;if(et&&!yt)return U||(U=new hn),de||Au(u)?Es(u,f,k,E,Z,U):gu(u,f,me,k,E,Z,U);if(!(Z&o)){var zt=yt&&lt.call(u,"__wrapped__"),Kt=wt&&lt.call(f,"__wrapped__");if(zt||Kt){var Tn=zt?u.value():u,yn=Kt?f.value():f;return U||(U=new hn),k(Tn,yn,E,Z,U)}}return et?(U||(U=new hn),yu(u,f,k,E,Z,U)):!1}function Za(u,f,k,E){var Z=k.length,U=Z,de=!E;if(u==null)return!U;for(u=Object(u);Z--;){var ve=k[Z];if(de&&ve[2]?ve[1]!==u[ve[0]]:!(ve[0]in u))return!1}for(;++Z<U;){ve=k[Z];var me=ve[0],Pe=u[me],yt=ve[1];if(de&&ve[2]){if(Pe===void 0&&!(me in u))return!1}else{var wt=new hn;if(E)var et=E(Pe,yt,me,u,f,wt);if(!(et===void 0?Bi(yt,Pe,E,s|o,wt):et))return!1}}return!0}function eu(u){if(!Jr(u)||vu(u))return!1;var f=Ns(u)||wn(u)?kn:F;return f.test(Nn(u))}function tu(u){return Qr(u)&&Oi(u.length)&&!!Y[Wt.call(u)]}function nu(u){return typeof u=="function"?u:u==null?zs:typeof u=="object"?gn(u)?ou(u[0],u[1]):su(u):Tu(u)}function ru(u){if(!wu(u))return vr(u);var f=[];for(var k in Object(u))lt.call(u,k)&&k!="constructor"&&f.push(k);return f}function iu(u,f){var k=-1,E=Yr(u)?Array(u.length):[];return Ga(u,function(Z,U,de){E[++k]=f(Z,U,de)}),E}function su(u){var f=bu(u);return f.length==1&&f[0][2]?Os(f[0][0],f[0][1]):function(k){return k===u||Za(k,u,f)}}function ou(u,f){return Gr(u)&&Cs(f)?Os(jr(u),f):function(k){var E=Ru(k,u);return E===void 0&&E===f?Pu(k,u):Bi(f,E,void 0,s|o)}}function au(u,f,k){var E=-1;f=Ht(f.length?f:[zs],qt(nu));var Z=iu(u,function(U,de,ve){var me=Ht(f,function(Pe){return Pe(U)});return{criteria:me,index:++E,value:U}});return vt(Z,function(U,de){return du(U,de,k)})}function uu(u){return function(f){return Ps(f,u)}}function cu(u){if(typeof u=="string")return u;if(Sr(u))return er?er.call(u):"";var f=u+"";return f=="0"&&1/u==-a?"-0":f}function Ts(u){return gn(u)?u:Su(u)}function lu(u,f){if(u!==f){var k=u!==void 0,E=u===null,Z=u===u,U=Sr(u),de=f!==void 0,ve=f===null,me=f===f,Pe=Sr(f);if(!ve&&!Pe&&!U&&u>f||U&&de&&me&&!ve&&!Pe||E&&de&&me||!k&&me||!Z)return 1;if(!E&&!U&&!Pe&&u<f||Pe&&k&&Z&&!E&&!U||ve&&k&&Z||!de&&Z||!me)return-1}return 0}function du(u,f,k){for(var E=-1,Z=u.criteria,U=f.criteria,de=Z.length,ve=k.length;++E<de;){var me=lu(Z[E],U[E]);if(me){if(E>=ve)return me;var Pe=k[E];return me*(Pe=="desc"?-1:1)}}return u.index-f.index}function fu(u,f){return function(k,E){if(k==null)return k;if(!Yr(k))return u(k,E);for(var Z=k.length,U=f?Z:-1,de=Object(k);(f?U--:++U<Z)&&E(de[U],U,de)!==!1;);return k}}function hu(u){return function(f,k,E){for(var Z=-1,U=Object(f),de=E(f),ve=de.length;ve--;){var me=de[u?ve:++Z];if(k(U[me],me,U)===!1)break}return f}}function Es(u,f,k,E,Z,U){var de=Z&o,ve=u.length,me=f.length;if(ve!=me&&!(de&&me>ve))return!1;var Pe=U.get(u);if(Pe&&U.get(f))return Pe==f;var yt=-1,wt=!0,et=Z&s?new Oe:void 0;for(U.set(u,f),U.set(f,u);++yt<ve;){var zt=u[yt],Kt=f[yt];if(E)var Tn=de?E(Kt,zt,yt,f,u,U):E(zt,Kt,yt,u,f,U);if(Tn!==void 0){if(Tn)continue;wt=!1;break}if(et){if(!xn(f,function(yn,zn){if(!et.has(zn)&&(zt===yn||k(zt,yn,E,Z,U)))return et.add(zn)})){wt=!1;break}}else if(!(zt===Kt||k(zt,Kt,E,Z,U))){wt=!1;break}}return U.delete(u),U.delete(f),wt}function gu(u,f,k,E,Z,U,de){switch(k){case j:if(u.byteLength!=f.byteLength||u.byteOffset!=f.byteOffset)return!1;u=u.buffer,f=f.buffer;case fe:return!(u.byteLength!=f.byteLength||!E(new Gt(u),new Gt(f)));case g:case w:case m:return xs(+u,+f);case h:return u.name==f.name&&u.message==f.message;case T:case C:return u==f+"";case p:var ve=Yn;case x:var me=U&o;if(ve||(ve=pr),u.size!=f.size&&!me)return!1;var Pe=de.get(u);if(Pe)return Pe==f;U|=s,de.set(u,f);var yt=Es(ve(u),ve(f),E,Z,U,de);return de.delete(u),yt;case te:if(Yt)return Yt.call(u)==Yt.call(f)}return!1}function yu(u,f,k,E,Z,U){var de=Z&o,ve=Xr(u),me=ve.length,Pe=Xr(f),yt=Pe.length;if(me!=yt&&!de)return!1;for(var wt=me;wt--;){var et=ve[wt];if(!(de?et in f:lt.call(f,et)))return!1}var zt=U.get(u);if(zt&&U.get(f))return zt==f;var Kt=!0;U.set(u,f),U.set(f,u);for(var Tn=de;++wt<me;){et=ve[wt];var yn=u[et],zn=f[et];if(E)var Ks=de?E(zn,yn,et,f,u,U):E(yn,zn,et,u,f,U);if(!(Ks===void 0?yn===zn||k(yn,zn,E,Z,U):Ks)){Kt=!1;break}Tn||(Tn=et=="constructor")}if(Kt&&!Tn){var Zr=u.constructor,ei=f.constructor;Zr!=ei&&"constructor"in u&&"constructor"in f&&!(typeof Zr=="function"&&Zr instanceof Zr&&typeof ei=="function"&&ei instanceof ei)&&(Kt=!1)}return U.delete(u),U.delete(f),Kt}function Hr(u,f){var k=u.__data__;return pu(f)?k[typeof f=="string"?"string":"hash"]:k.map}function bu(u){for(var f=Xr(u),k=f.length;k--;){var E=f[k],Z=u[E];f[k]=[E,Z,Cs(Z)]}return f}function tr(u,f){var k=cn(u,f);return eu(k)?k:void 0}var Pn=Ja;(Ln&&Pn(new Ln(new ArrayBuffer(1)))!=j||jt&&Pn(new jt)!=p||I&&Pn(I.resolve())!=A||H&&Pn(new H)!=x||re&&Pn(new re)!=oe)&&(Pn=function(u){var f=Wt.call(u),k=f==_?u.constructor:void 0,E=k?Nn(k):void 0;if(E)switch(E){case le:return j;case Ke:return p;case Ce:return A;case Et:return x;case Ze:return oe}return f});function mu(u,f,k){f=Gr(f,u)?[f]:Ts(f);for(var E,Z=-1,de=f.length;++Z<de;){var U=jr(f[Z]);if(!(E=u!=null&&k(u,U)))break;u=u[U]}if(E)return E;var de=u?u.length:0;return!!de&&Oi(de)&&Bs(U,de)&&(gn(u)||Ls(u))}function Bs(u,f){return f=f??c,!!f&&(typeof u=="number"||ne.test(u))&&u>-1&&u%1==0&&u<f}function Gr(u,f){if(gn(u))return!1;var k=typeof u;return k=="number"||k=="symbol"||k=="boolean"||u==null||Sr(u)?!0:R.test(u)||!We.test(u)||f!=null&&u in Object(f)}function pu(u){var f=typeof u;return f=="string"||f=="number"||f=="symbol"||f=="boolean"?u!=="__proto__":u===null}function vu(u){return!!Qn&&Qn in u}function wu(u){var f=u&&u.constructor,k=typeof f=="function"&&f.prototype||Xe;return u===k}function Cs(u){return u===u&&!Jr(u)}function Os(u,f){return function(k){return k==null?!1:k[u]===f&&(f!==void 0||u in Object(k))}}var Su=Ci(function(u){u=Iu(u);var f=[];return K.test(u)&&f.push(""),u.replace(ue,function(k,E,Z,U){f.push(Z?U.replace(M,"$1"):E||k)}),f});function jr(u){if(typeof u=="string"||Sr(u))return u;var f=u+"";return f=="0"&&1/u==-a?"-0":f}function Nn(u){if(u!=null){try{return ln.call(u)}catch{}try{return u+""}catch{}}return""}function ku(u,f,k,E){return u==null?[]:(gn(f)||(f=f==null?[]:[f]),k=E?void 0:k,gn(k)||(k=k==null?[]:[k]),au(u,f,k))}function Ci(u,f){if(typeof u!="function"||f&&typeof f!="function")throw new TypeError(r);var k=function(){var E=arguments,Z=f?f.apply(this,E):E[0],U=k.cache;if(U.has(Z))return U.get(Z);var de=u.apply(this,E);return k.cache=U.set(Z,de),de};return k.cache=new(Ci.Cache||y),k}Ci.Cache=y;function xs(u,f){return u===f||u!==u&&f!==f}function Ls(u){return _u(u)&&lt.call(u,"callee")&&(!Xn.call(u,"callee")||Wt.call(u)==d)}var gn=Array.isArray;function Yr(u){return u!=null&&Oi(u.length)&&!Ns(u)}function _u(u){return Qr(u)&&Yr(u)}function Ns(u){var f=Jr(u)?Wt.call(u):"";return f==b||f==v}function Oi(u){return typeof u=="number"&&u>-1&&u%1==0&&u<=c}function Jr(u){var f=typeof u;return!!u&&(f=="object"||f=="function")}function Qr(u){return!!u&&typeof u=="object"}function Sr(u){return typeof u=="symbol"||Qr(u)&&Wt.call(u)==te}var Au=Pt?qt(Pt):tu;function Iu(u){return u==null?"":cu(u)}function Ru(u,f,k){var E=u==null?void 0:Ps(u,f);return E===void 0?k:E}function Pu(u,f){return u!=null&&mu(u,f,Qa)}function Xr(u){return Yr(u)?Ha(u):ru(u)}function zs(u){return u}function Tu(u){return Gr(u)?un(jr(u)):uu(u)}n.exports=ku})(Gi,Gi.exports);var kt={},je={},Ml=$&&$.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Ul=$&&$.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),tn=$&&$.__decorate||function(n,e,t,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},ql=$&&$.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.hasOwnProperty.call(n,t)&&Ml(e,n,t);return Ul(e,n),e},Fo=$&&$.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(je,"__esModule",{value:!0});je.deserializeUnchecked=je.deserialize=je.serialize=je.BinaryReader=je.BinaryWriter=je.BorshError=je.baseDecode=je.baseEncode=void 0;const En=Fo(bi.exports),Do=Fo($e),Wl=ql(is),Fl=typeof $.TextDecoder!="function"?Wl.TextDecoder:$.TextDecoder,Dl=new Fl("utf-8",{fatal:!0});function Vl(n){return typeof n=="string"&&(n=G.Buffer.from(n,"utf8")),Do.default.encode(G.Buffer.from(n))}je.baseEncode=Vl;function $l(n){return G.Buffer.from(Do.default.decode(n))}je.baseDecode=$l;const zi=1024;class bt extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}je.BorshError=bt;class Vo{constructor(){this.buf=G.Buffer.alloc(zi),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=G.Buffer.concat([this.buf,G.Buffer.alloc(zi)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(G.Buffer.from(new En.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(G.Buffer.from(new En.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(G.Buffer.from(new En.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(G.Buffer.from(new En.default(e).toArray("le",64)))}writeBuffer(e){this.buf=G.Buffer.concat([G.Buffer.from(this.buf.subarray(0,this.length)),e,G.Buffer.alloc(zi)]),this.length+=e.length}writeString(e){this.maybeResize();const t=G.Buffer.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(G.Buffer.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const r of e)this.maybeResize(),t(r)}toArray(){return this.buf.subarray(0,this.length)}}je.BinaryWriter=Vo;function nn(n,e,t){const r=t.value;t.value=function(...i){try{return r.apply(this,i)}catch(s){if(s instanceof RangeError){const o=s.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(o)>=0)throw new bt("Reached the end of buffer when deserializing")}throw s}}}class xt{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new En.default(e,"le")}readU128(){const e=this.readBuffer(16);return new En.default(e,"le")}readU256(){const e=this.readBuffer(32);return new En.default(e,"le")}readU512(){const e=this.readBuffer(64);return new En.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new bt(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return Dl.decode(t)}catch(r){throw new bt(`Error decoding UTF-8 string: ${r}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),r=Array();for(let i=0;i<t;++i)r.push(e());return r}}tn([nn],xt.prototype,"readU8",null);tn([nn],xt.prototype,"readU16",null);tn([nn],xt.prototype,"readU32",null);tn([nn],xt.prototype,"readU64",null);tn([nn],xt.prototype,"readU128",null);tn([nn],xt.prototype,"readU256",null);tn([nn],xt.prototype,"readU512",null);tn([nn],xt.prototype,"readString",null);tn([nn],xt.prototype,"readFixedArray",null);tn([nn],xt.prototype,"readArray",null);je.BinaryReader=xt;function $o(n){return n.charAt(0).toUpperCase()+n.slice(1)}function Er(n,e,t,r,i){try{if(typeof r=="string")i[`write${$o(r)}`](t);else if(r instanceof Array)if(typeof r[0]=="number"){if(t.length!==r[0])throw new bt(`Expecting byte array of length ${r[0]}, but got ${t.length} bytes`);i.writeFixedArray(t)}else if(r.length===2&&typeof r[1]=="number"){if(t.length!==r[1])throw new bt(`Expecting byte array of length ${r[1]}, but got ${t.length} bytes`);for(let s=0;s<r[1];s++)Er(n,null,t[s],r[0],i)}else i.writeArray(t,s=>{Er(n,e,s,r[0],i)});else if(r.kind!==void 0)switch(r.kind){case"option":{t==null?i.writeU8(0):(i.writeU8(1),Er(n,e,t,r.type,i));break}default:throw new bt(`FieldType ${r} unrecognized`)}else Ho(n,t,i)}catch(s){throw s instanceof bt&&s.addToFieldPath(e),s}}function Ho(n,e,t){if(typeof e.borshSerialize=="function"){e.borshSerialize(t);return}const r=n.get(e.constructor);if(!r)throw new bt(`Class ${e.constructor.name} is missing in schema`);if(r.kind==="struct")r.fields.map(([i,s])=>{Er(n,i,e[i],s,t)});else if(r.kind==="enum"){const i=e[r.field];for(let s=0;s<r.values.length;++s){const[o,a]=r.values[s];if(o===i){t.writeU8(s),Er(n,o,e[o],a,t);break}}}else throw new bt(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function Hl(n,e,t=Vo){const r=new t;return Ho(n,e,r),r.toArray()}je.serialize=Hl;function Br(n,e,t,r){try{if(typeof t=="string")return r[`read${$o(t)}`]();if(t instanceof Array){if(typeof t[0]=="number")return r.readFixedArray(t[0]);if(typeof t[1]=="number"){const i=[];for(let s=0;s<t[1];s++)i.push(Br(n,null,t[0],r));return i}else return r.readArray(()=>Br(n,e,t[0],r))}return t.kind==="option"?r.readU8()?Br(n,e,t.type,r):void 0:cs(n,t,r)}catch(i){throw i instanceof bt&&i.addToFieldPath(e),i}}function cs(n,e,t){if(typeof e.borshDeserialize=="function")return e.borshDeserialize(t);const r=n.get(e);if(!r)throw new bt(`Class ${e.name} is missing in schema`);if(r.kind==="struct"){const i={};for(const[s,o]of n.get(e).fields)i[s]=Br(n,s,o,t);return new e(i)}if(r.kind==="enum"){const i=t.readU8();if(i>=r.values.length)throw new bt(`Enum index: ${i} is out of range`);const[s,o]=r.values[i],a=Br(n,s,o,t);return new e({[s]:a})}throw new bt(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function Gl(n,e,t,r=xt){const i=new r(t),s=cs(n,e,i);if(i.offset<t.length)throw new bt(`Unexpected ${t.length-i.offset} bytes after deserialized data`);return s}je.deserialize=Gl;function jl(n,e,t,r=xt){const i=new r(t);return cs(n,e,i)}je.deserializeUnchecked=jl;var ls={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=n.METADATA_PROGRAM=n.METADATA_PREFIX=n.METADATA_SCHEMA=n.Data=n.Creator=n.MetadataKey=void 0;var e="metadata";n.METADATA_PREFIX=e;var t="metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s";n.METADATA_PROGRAM=t;var r;(function(c){c[c.Uninitialized=0]="Uninitialized",c[c.MetadataV1=4]="MetadataV1",c[c.EditionV1=1]="EditionV1",c[c.MasterEditionV1=2]="MasterEditionV1",c[c.MasterEditionV2=6]="MasterEditionV2",c[c.EditionMarker=7]="EditionMarker"})(r=n.MetadataKey||(n.MetadataKey={}));var i=function(){function c(d){this.address=d.address,this.verified=d.verified,this.share=d.share}return c}();n.Creator=i;var s=function(){function c(d){var l;this.key=r.MetadataV1,this.updateAuthority=d.updateAuthority,this.mint=d.mint,this.data=d.data,this.primarySaleHappened=d.primarySaleHappened,this.isMutable=d.isMutable,this.editionNonce=(l=d.editionNonce)!==null&&l!==void 0?l:null}return c}();n.Metadata=s;var o=function(){function c(d){this.name=d.name,this.symbol=d.symbol,this.uri=d.uri,this.sellerFeeBasisPoints=d.sellerFeeBasisPoints,this.creators=d.creators}return c}();n.Data=o;var a=new Map([[o,{kind:"struct",fields:[["name","string"],["symbol","string"],["uri","string"],["sellerFeeBasisPoints","u16"],["creators",{kind:"option",type:[i]}]]}],[s,{kind:"struct",fields:[["key","u8"],["updateAuthority","pubkey"],["mint","pubkey"],["data",o],["primarySaleHappened","u8"],["isMutable","u8"]]}],[i,{kind:"struct",fields:[["address","pubkey"],["verified","u8"],["share","u8"]]}]]);n.METADATA_SCHEMA=a})(ls);var Go={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.extendBorsh=void 0;var e=$n,t=je,r=function(){t.BinaryReader.prototype.readPubkey=function(){var i=this,s=i.readFixedArray(32);return new e.PublicKey(s)},t.BinaryWriter.prototype.writePubkey=function(i){var s=this;s.writeFixedArray(i.toBuffer())}};n.extendBorsh=r,(0,n.extendBorsh)()})(Go);var jo=$&&$.__awaiter||function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{d(r.next(l))}catch(g){o(g)}}function c(l){try{d(r.throw(l))}catch(g){o(g)}}function d(l){l.done?s(l.value):i(l.value).then(a,c)}d((r=r.apply(n,e||[])).next())})},Yo=$&&$.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(d){return function(l){return c([d,l])}}function c(d){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(s=d[0]&2?i.return:d[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,d[1])).done)return s;switch(i=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,i=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){t.label=d[1];break}if(d[0]===6&&t.label<s[1]){t.label=s[1],s=d;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(d);break}s[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(l){d=[6,l],i=0}finally{r=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(kt,"__esModule",{value:!0});kt.createConnectionConfig=kt.isValidSolanaAddress=kt.getSolanaMetadataAddress=kt.decodeTokenMetadata=void 0;var Yl=je,lr=$n,Or=ls,Jl=Go;(0,Jl.extendBorsh)();var Ql=new lr.PublicKey(Or.METADATA_PROGRAM),Xl=Ql.toBuffer(),Zl=new TextEncoder().encode(Or.METADATA_PREFIX),ed=function(n){return jo(void 0,void 0,void 0,function(){return Yo(this,function(e){return[2,(0,Yl.deserializeUnchecked)(Or.METADATA_SCHEMA,Or.Metadata,n)]})})};kt.decodeTokenMetadata=ed;function td(n){return jo(this,void 0,void 0,function(){var e;return Yo(this,function(t){switch(t.label){case 0:return e=new lr.PublicKey(Or.METADATA_PROGRAM),[4,lr.PublicKey.findProgramAddress([Zl,Xl,n.toBuffer()],e)];case 1:return[2,t.sent()[0]]}})})}kt.getSolanaMetadataAddress=td;var nd=function(n){try{return new lr.PublicKey(n),!0}catch{return!1}};kt.isValidSolanaAddress=nd;var rd=function(n,e){return n===void 0&&(n=(0,lr.clusterApiUrl)("mainnet-beta")),e===void 0&&(e="confirmed"),new lr.Connection(n,e)};kt.createConnectionConfig=rd;var Mr={};Object.defineProperty(Mr,"__esModule",{value:!0});Mr.TOKEN_PROGRAM=void 0;Mr.TOKEN_PROGRAM="TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA";(function(n){var e=$&&$.__assign||function(){return e=Object.assign||function(m){for(var _,A=1,T=arguments.length;A<T;A++){_=arguments[A];for(var x in _)Object.prototype.hasOwnProperty.call(_,x)&&(m[x]=_[x])}return m},e.apply(this,arguments)},t=$&&$.__awaiter||function(m,_,A,T){function x(C){return C instanceof A?C:new A(function(te){te(C)})}return new(A||(A=Promise))(function(C,te){function oe(pe){try{j(T.next(pe))}catch(Le){te(Le)}}function fe(pe){try{j(T.throw(pe))}catch(Le){te(Le)}}function j(pe){pe.done?C(pe.value):x(pe.value).then(oe,fe)}j((T=T.apply(m,_||[])).next())})},r=$&&$.__generator||function(m,_){var A={label:0,sent:function(){if(C[0]&1)throw C[1];return C[1]},trys:[],ops:[]},T,x,C,te;return te={next:oe(0),throw:oe(1),return:oe(2)},typeof Symbol=="function"&&(te[Symbol.iterator]=function(){return this}),te;function oe(j){return function(pe){return fe([j,pe])}}function fe(j){if(T)throw new TypeError("Generator is already executing.");for(;A;)try{if(T=1,x&&(C=j[0]&2?x.return:j[0]?x.throw||((C=x.return)&&C.call(x),0):x.next)&&!(C=C.call(x,j[1])).done)return C;switch(x=0,C&&(j=[j[0]&2,C.value]),j[0]){case 0:case 1:C=j;break;case 4:return A.label++,{value:j[1],done:!1};case 5:A.label++,x=j[1],j=[0];continue;case 7:j=A.ops.pop(),A.trys.pop();continue;default:if(C=A.trys,!(C=C.length>0&&C[C.length-1])&&(j[0]===6||j[0]===2)){A=0;continue}if(j[0]===3&&(!C||j[1]>C[0]&&j[1]<C[3])){A.label=j[1];break}if(j[0]===6&&A.label<C[1]){A.label=C[1],C=j;break}if(C&&A.label<C[2]){A.label=C[2],A.ops.push(j);break}C[2]&&A.ops.pop(),A.trys.pop();continue}j=_.call(m,A)}catch(pe){j=[6,pe],x=0}finally{T=C=0}if(j[0]&5)throw j[1];return{value:j[0]?j[1]:void 0,done:!0}}},i=$&&$.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(n,"__esModule",{value:!0}),n.sanitizeMetaStrings=n.getParsedNftAccountsByOwner=void 0;var s=$n,o=i(Kl),a=i(Gi.exports),c=kt,d=Mr,l;(function(m){m.updateAuthority="updateAuthority"})(l||(l={}));var g=function(m){var _=m.publicAddress,A=m.connection,T=A===void 0?(0,c.createConnectionConfig)():A,x=m.sanitize,C=x===void 0?!0:x,te=m.stringifyPubKeys,oe=te===void 0?!0:te,fe=m.sort,j=fe===void 0?!0:fe,pe=m.limit,Le=pe===void 0?5e3:pe;return t(void 0,void 0,void 0,function(){var ht,It,Je,Ne,at,ut,Ge,We,R,K,ue;return r(this,function(ye){switch(ye.label){case 0:return ht=(0,c.isValidSolanaAddress)(_),ht?[4,T.getParsedTokenAccountsByOwner(new s.PublicKey(_),{programId:new s.PublicKey(d.TOKEN_PROGRAM)})]:[2,[]];case 1:return It=ye.sent().value,Je=It.filter(function(M){var F,ne,Y,ee,ze,Be,Rt,Fe,pt,Qe,ct=(ze=(ee=(Y=(ne=(F=M.account)===null||F===void 0?void 0:F.data)===null||ne===void 0?void 0:ne.parsed)===null||Y===void 0?void 0:Y.info)===null||ee===void 0?void 0:ee.tokenAmount)===null||ze===void 0?void 0:ze.uiAmount,Pt=(Qe=(pt=(Fe=(Rt=(Be=M.account)===null||Be===void 0?void 0:Be.data)===null||Rt===void 0?void 0:Rt.parsed)===null||Fe===void 0?void 0:Fe.info)===null||pt===void 0?void 0:pt.tokenAmount)===null||Qe===void 0?void 0:Qe.decimals;return Pt===0&&ct>=1}).map(function(M){var F,ne,Y,ee,ze=(ee=(Y=(ne=(F=M.account)===null||F===void 0?void 0:F.data)===null||ne===void 0?void 0:ne.parsed)===null||Y===void 0?void 0:Y.info)===null||ee===void 0?void 0:ee.mint;return new s.PublicKey(ze)}),Ne=Je==null?void 0:Je.slice(0,Le),[4,Promise.allSettled(Ne.map(c.getSolanaMetadataAddress))];case 2:return at=ye.sent(),ut=at.filter(v).map(function(M){return M.value}),[4,Promise.allSettled((0,o.default)(ut,99).map(function(M){return T.getMultipleAccountsInfo(M)}))];case 3:return Ge=ye.sent(),We=Ge.filter(function(M){var F=M.status;return F==="fulfilled"}).flatMap(function(M){return M.value}),!(We!=null&&We.length)||(We==null?void 0:We.length)===0?[2,[]]:[4,Promise.allSettled(We.map(function(M){var F;return(0,c.decodeTokenMetadata)((F=M)===null||F===void 0?void 0:F.data)}))];case 4:return R=ye.sent(),K=R.filter(v).filter(p).map(function(M){var F=M.value;return C?w(F):F}).map(function(M){return oe?h(M):M}),oe&&j?(ue=(0,a.default)(K,[l.updateAuthority],["asc"]),[2,ue]):[2,K]}})})};n.getParsedNftAccountsByOwner=g;var w=function(m){var _,A,T;return e(e({},m),{data:e(e({},m==null?void 0:m.data),{name:(0,n.sanitizeMetaStrings)((_=m==null?void 0:m.data)===null||_===void 0?void 0:_.name),symbol:(0,n.sanitizeMetaStrings)((A=m==null?void 0:m.data)===null||A===void 0?void 0:A.symbol),uri:(0,n.sanitizeMetaStrings)((T=m==null?void 0:m.data)===null||T===void 0?void 0:T.uri)})})},h=function(m){var _,A,T,x,C,te;return e(e({},m),{mint:(A=(_=m==null?void 0:m.mint)===null||_===void 0?void 0:_.toString)===null||A===void 0?void 0:A.call(_),updateAuthority:(x=(T=m==null?void 0:m.updateAuthority)===null||T===void 0?void 0:T.toString)===null||x===void 0?void 0:x.call(T),data:e(e({},m==null?void 0:m.data),{creators:(te=(C=m==null?void 0:m.data)===null||C===void 0?void 0:C.creators)===null||te===void 0?void 0:te.map(function(oe){var fe,j;return e(e({},oe),{address:(j=(fe=new s.PublicKey(oe==null?void 0:oe.address))===null||fe===void 0?void 0:fe.toString)===null||j===void 0?void 0:j.call(fe)})})})})},b=function(m){return m.replace(/\0/g,"")};n.sanitizeMetaStrings=b;var v=function(m){return m&&m.status==="fulfilled"},p=function(m){var _,A,T,x=(T=(A=(_=m.value.data)===null||_===void 0?void 0:_.uri)===null||A===void 0?void 0:A.replace)===null||T===void 0?void 0:T.call(A,/\0/g,"");return x!==""&&x!==void 0}})(Uo);var Jo={};(function(n){var e=$&&$.__awaiter||function(c,d,l,g){function w(h){return h instanceof l?h:new l(function(b){b(h)})}return new(l||(l=Promise))(function(h,b){function v(_){try{m(g.next(_))}catch(A){b(A)}}function p(_){try{m(g.throw(_))}catch(A){b(A)}}function m(_){_.done?h(_.value):w(_.value).then(v,p)}m((g=g.apply(c,d||[])).next())})},t=$&&$.__generator||function(c,d){var l={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},g,w,h,b;return b={next:v(0),throw:v(1),return:v(2)},typeof Symbol=="function"&&(b[Symbol.iterator]=function(){return this}),b;function v(m){return function(_){return p([m,_])}}function p(m){if(g)throw new TypeError("Generator is already executing.");for(;l;)try{if(g=1,w&&(h=m[0]&2?w.return:m[0]?w.throw||((h=w.return)&&h.call(w),0):w.next)&&!(h=h.call(w,m[1])).done)return h;switch(w=0,h&&(m=[m[0]&2,h.value]),m[0]){case 0:case 1:h=m;break;case 4:return l.label++,{value:m[1],done:!1};case 5:l.label++,w=m[1],m=[0];continue;case 7:m=l.ops.pop(),l.trys.pop();continue;default:if(h=l.trys,!(h=h.length>0&&h[h.length-1])&&(m[0]===6||m[0]===2)){l=0;continue}if(m[0]===3&&(!h||m[1]>h[0]&&m[1]<h[3])){l.label=m[1];break}if(m[0]===6&&l.label<h[1]){l.label=h[1],h=m;break}if(h&&l.label<h[2]){l.label=h[2],l.ops.push(m);break}h[2]&&l.ops.pop(),l.trys.pop();continue}m=d.call(c,l)}catch(_){m=[6,_],w=0}finally{g=h=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.getParsedNftAccountsByUpdateAuthority=n.createConnectionConfig=void 0;var r=$n,i=ls,s=kt,o=function(c,d){return c===void 0&&(c=(0,r.clusterApiUrl)("mainnet-beta")),d===void 0&&(d="confirmed"),new r.Connection(c,d)};n.createConnectionConfig=o;var a=function(c){var d=c.updateAuthority,l=c.connection,g=l===void 0?(0,n.createConnectionConfig)():l;return e(void 0,void 0,void 0,function(){var w,h,b;return t(this,function(v){switch(v.label){case 0:return v.trys.push([0,3,,4]),[4,g.getProgramAccounts(new r.PublicKey(i.METADATA_PROGRAM),{encoding:"base64",filters:[{memcmp:{offset:1,bytes:d}}]})];case 1:return w=v.sent(),[4,Promise.all(w.map(function(p){return(0,s.decodeTokenMetadata)(p.account.data)}))];case 2:return h=v.sent(),[2,h];case 3:return b=v.sent(),console.error(b),[2,[]];case 4:return[2]}})})};n.getParsedNftAccountsByUpdateAuthority=a})(Jo);var vi={},rr=$&&$.__assign||function(){return rr=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},rr.apply(this,arguments)},id=$&&$.__awaiter||function(n,e,t,r){function i(s){return s instanceof t?s:new t(function(o){o(s)})}return new(t||(t=Promise))(function(s,o){function a(l){try{d(r.next(l))}catch(g){o(g)}}function c(l){try{d(r.throw(l))}catch(g){o(g)}}function d(l){l.done?s(l.value):i(l.value).then(a,c)}d((r=r.apply(n,e||[])).next())})},sd=$&&$.__generator||function(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,i,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(d){return function(l){return c([d,l])}}function c(d){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,i&&(s=d[0]&2?i.return:d[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,d[1])).done)return s;switch(i=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,i=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){t.label=d[1];break}if(d[0]===6&&t.label<s[1]){t.label=s[1],s=d;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(d);break}s[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(l){d=[6,l],i=0}finally{r=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(vi,"__esModule",{value:!0});vi.getParsedAccountByMint=void 0;var ji=$n,od=Mr,ad=kt;function ud(n){return(n==null?void 0:n.parsed)!==void 0}var cd=function(n){var e=n.mintAddress,t=n.connection,r=t===void 0?(0,ad.createConnectionConfig)():t,i=n.stringifyPubKeys,s=i===void 0?!0:i;return id(void 0,void 0,void 0,function(){var o,a,c;return sd(this,function(d){switch(d.label){case 0:return[4,r.getParsedProgramAccounts(new ji.PublicKey(od.TOKEN_PROGRAM),{filters:[{dataSize:165},{memcmp:{offset:0,bytes:e}}]})];case 1:return o=d.sent(),o!=null&&o.length?(a=o==null?void 0:o.find(function(l){var g,w,h,b=l.account,v=b.data;if(ud(v)){var p=+((h=(w=(g=v==null?void 0:v.parsed)===null||g===void 0?void 0:g.info)===null||w===void 0?void 0:w.tokenAmount)===null||h===void 0?void 0:h.amount);return p}return!1}),c=s?ld(a):a,[2,c]):[2,void 0]}})})};vi.getParsedAccountByMint=cd;var ld=function(n){var e,t,r,i;return rr(rr({},n),{account:rr(rr({},n==null?void 0:n.account),{owner:(t=(e=new ji.PublicKey(n==null?void 0:n.account.owner))===null||e===void 0?void 0:e.toString)===null||t===void 0?void 0:t.call(e)}),pubkey:(i=(r=new ji.PublicKey(n==null?void 0:n.pubkey))===null||r===void 0?void 0:r.toString)===null||i===void 0?void 0:i.call(r)})},Qo={},Xo={},wi={},it={},dd=$&&$.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),fd=$&&$.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),rn=$&&$.__decorate||function(n,e,t,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},hd=$&&$.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.hasOwnProperty.call(n,t)&&dd(e,n,t);return fd(e,n),e},Zo=$&&$.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(it,"__esModule",{value:!0});var ea=it.deserializeUnchecked=oa=it.deserialize=sa=it.serialize=it.BinaryReader=it.BinaryWriter=it.BorshError=it.baseDecode=it.baseEncode=void 0;const Bn=Zo(bi.exports),ta=Zo($e),gd=hd(is),yd=typeof TextDecoder!="function"?gd.TextDecoder:TextDecoder,bd=new yd("utf-8",{fatal:!0});function md(n){return typeof n=="string"&&(n=G.Buffer.from(n,"utf8")),ta.default.encode(G.Buffer.from(n))}it.baseEncode=md;function pd(n){return G.Buffer.from(ta.default.decode(n))}it.baseDecode=pd;const Ki=1024;class mt extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}it.BorshError=mt;class na{constructor(){this.buf=G.Buffer.alloc(Ki),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=G.Buffer.concat([this.buf,G.Buffer.alloc(Ki)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(G.Buffer.from(new Bn.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(G.Buffer.from(new Bn.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(G.Buffer.from(new Bn.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(G.Buffer.from(new Bn.default(e).toArray("le",64)))}writeBuffer(e){this.buf=G.Buffer.concat([G.Buffer.from(this.buf.subarray(0,this.length)),e,G.Buffer.alloc(Ki)]),this.length+=e.length}writeString(e){this.maybeResize();const t=G.Buffer.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(G.Buffer.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const r of e)this.maybeResize(),t(r)}toArray(){return this.buf.subarray(0,this.length)}}it.BinaryWriter=na;function sn(n,e,t){const r=t.value;t.value=function(...i){try{return r.apply(this,i)}catch(s){if(s instanceof RangeError){const o=s.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(o)>=0)throw new mt("Reached the end of buffer when deserializing")}throw s}}}class Lt{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new Bn.default(e,"le")}readU128(){const e=this.readBuffer(16);return new Bn.default(e,"le")}readU256(){const e=this.readBuffer(32);return new Bn.default(e,"le")}readU512(){const e=this.readBuffer(64);return new Bn.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new mt(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return bd.decode(t)}catch(r){throw new mt(`Error decoding UTF-8 string: ${r}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),r=Array();for(let i=0;i<t;++i)r.push(e());return r}}rn([sn],Lt.prototype,"readU8",null);rn([sn],Lt.prototype,"readU16",null);rn([sn],Lt.prototype,"readU32",null);rn([sn],Lt.prototype,"readU64",null);rn([sn],Lt.prototype,"readU128",null);rn([sn],Lt.prototype,"readU256",null);rn([sn],Lt.prototype,"readU512",null);rn([sn],Lt.prototype,"readString",null);rn([sn],Lt.prototype,"readFixedArray",null);rn([sn],Lt.prototype,"readArray",null);it.BinaryReader=Lt;function ra(n){return n.charAt(0).toUpperCase()+n.slice(1)}function Mn(n,e,t,r,i){try{if(typeof r=="string")i[`write${ra(r)}`](t);else if(r instanceof Array)if(typeof r[0]=="number"){if(t.length!==r[0])throw new mt(`Expecting byte array of length ${r[0]}, but got ${t.length} bytes`);i.writeFixedArray(t)}else if(r.length===2&&typeof r[1]=="number"){if(t.length!==r[1])throw new mt(`Expecting byte array of length ${r[1]}, but got ${t.length} bytes`);for(let s=0;s<r[1];s++)Mn(n,null,t[s],r[0],i)}else i.writeArray(t,s=>{Mn(n,e,s,r[0],i)});else if(r.kind!==void 0)switch(r.kind){case"option":{t==null?i.writeU8(0):(i.writeU8(1),Mn(n,e,t,r.type,i));break}case"map":{i.writeU32(t.size),t.forEach((s,o)=>{Mn(n,e,o,r.key,i),Mn(n,e,s,r.value,i)});break}default:throw new mt(`FieldType ${r} unrecognized`)}else ia(n,t,i)}catch(s){throw s instanceof mt&&s.addToFieldPath(e),s}}function ia(n,e,t){if(typeof e.borshSerialize=="function"){e.borshSerialize(t);return}const r=n.get(e.constructor);if(!r)throw new mt(`Class ${e.constructor.name} is missing in schema`);if(r.kind==="struct")r.fields.map(([i,s])=>{Mn(n,i,e[i],s,t)});else if(r.kind==="enum"){const i=e[r.field];for(let s=0;s<r.values.length;++s){const[o,a]=r.values[s];if(o===i){t.writeU8(s),Mn(n,o,e[o],a,t);break}}}else throw new mt(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function vd(n,e,t=na){const r=new t;return ia(n,e,r),r.toArray()}var sa=it.serialize=vd;function Un(n,e,t,r){try{if(typeof t=="string")return r[`read${ra(t)}`]();if(t instanceof Array){if(typeof t[0]=="number")return r.readFixedArray(t[0]);if(typeof t[1]=="number"){const i=[];for(let s=0;s<t[1];s++)i.push(Un(n,null,t[0],r));return i}else return r.readArray(()=>Un(n,e,t[0],r))}if(t.kind==="option")return r.readU8()?Un(n,e,t.type,r):void 0;if(t.kind==="map"){let i=new Map;const s=r.readU32();for(let o=0;o<s;o++){const a=Un(n,e,t.key,r),c=Un(n,e,t.value,r);i.set(a,c)}return i}return ds(n,t,r)}catch(i){throw i instanceof mt&&i.addToFieldPath(e),i}}function ds(n,e,t){if(typeof e.borshDeserialize=="function")return e.borshDeserialize(t);const r=n.get(e);if(!r)throw new mt(`Class ${e.name} is missing in schema`);if(r.kind==="struct"){const i={};for(const[s,o]of n.get(e).fields)i[s]=Un(n,s,o,t);return new e(i)}if(r.kind==="enum"){const i=t.readU8();if(i>=r.values.length)throw new mt(`Enum index: ${i} is out of range`);const[s,o]=r.values[i],a=Un(n,s,o,t);return new e({[s]:a})}throw new mt(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function wd(n,e,t,r=Lt){const i=new r(t),s=ds(n,e,i);if(i.offset<t.length)throw new mt(`Unexpected ${t.length-i.offset} bytes after deserialized data`);return s}var oa=it.deserialize=wd;function Sd(n,e,t,r=Lt){const i=new r(t);return ds(n,e,i)}ea=it.deserializeUnchecked=Sd;const kd=yr.utils.randomPrivateKey,ro=()=>{const n=yr.utils.randomPrivateKey(),e=li(n),t=new Uint8Array(64);return t.set(n),t.set(e,32),{publicKey:e,secretKey:t}},li=yr.getPublicKey;function io(n){try{return yr.ExtendedPoint.fromHex(n),!0}catch{return!1}}const fs=(n,e)=>yr.sign(n,e.slice(0,32)),_d=yr.verify,ge=n=>se.Buffer.isBuffer(n)?n:n instanceof Uint8Array?se.Buffer.from(n.buffer,n.byteOffset,n.byteLength):se.Buffer.from(n);class hs{constructor(e){Object.assign(this,e)}encode(){return se.Buffer.from(sa(Cr,this))}static decode(e){return oa(Cr,this,e)}static decodeUnchecked(e){return ea(Cr,this,e)}}class Ad extends hs{constructor(e){if(super(e),this.enum="",Object.keys(e).length!==1)throw new Error("Enum can only take single value");Object.keys(e).map(t=>{this.enum=t})}}const Cr=new Map;var aa;let ua;const ca=32,Ot=32;function Id(n){return n._bn!==void 0}let so=1;ua=Symbol.toStringTag;class N extends hs{constructor(e){if(super({}),this._bn=void 0,Id(e))this._bn=e._bn;else{if(typeof e=="string"){const t=$e.decode(e);if(t.length!=Ot)throw new Error("Invalid public key input");this._bn=new Fs(t)}else this._bn=new Fs(e);if(this._bn.byteLength()>Ot)throw new Error("Invalid public key input")}}static unique(){const e=new N(so);return so+=1,new N(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return $e.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(se.Buffer);if(e.length===Ot)return e;const t=se.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[ua](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,r){const i=se.Buffer.concat([e.toBuffer(),se.Buffer.from(t),r.toBuffer()]),s=Ds(i);return new N(s)}static createProgramAddressSync(e,t){let r=se.Buffer.alloc(0);e.forEach(function(s){if(s.length>ca)throw new TypeError("Max seed length exceeded");r=se.Buffer.concat([r,ge(s)])}),r=se.Buffer.concat([r,t.toBuffer(),se.Buffer.from("ProgramDerivedAddress")]);const i=Ds(r);if(io(i))throw new Error("Invalid seeds, address must fall off the curve");return new N(i)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let r=255,i;for(;r!=0;){try{const s=e.concat(se.Buffer.from([r]));i=this.createProgramAddressSync(s,t)}catch(s){if(s instanceof TypeError)throw s;r--;continue}return[i,r]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new N(e);return io(t.toBytes())}}aa=N;N.default=new aa("11111111111111111111111111111111");Cr.set(N,{kind:"struct",fields:[["_bn","u256"]]});class Rd{constructor(e){if(this._publicKey=void 0,this._secretKey=void 0,e){const t=ge(e);if(e.length!==64)throw new Error("bad secret key size");this._publicKey=t.slice(32,64),this._secretKey=t.slice(0,32)}else this._secretKey=ge(kd()),this._publicKey=ge(li(this._secretKey))}get publicKey(){return new N(this._publicKey)}get secretKey(){return se.Buffer.concat([this._secretKey,this._publicKey],64)}}const Pd=new N("BPFLoader1111111111111111111111111111111111"),On=1280-40-8,Si=127,dr=64;class gs extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(gs.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class ys extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(ys.prototype,"name",{value:"TransactionExpiredTimeoutError"});class ir extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(ir.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class xr{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const r=new Map;this.keySegments().flat().forEach((s,o)=>{r.set(s.toBase58(),o)});const i=s=>{const o=r.get(s.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(s=>({programIdIndex:i(s.programId),accountKeyIndexes:s.keys.map(o=>i(o.pubkey)),data:s.data}))}}const be=(n="publicKey")=>Ue(32,n),Td=(n="signature")=>Ue(64,n),Wn=(n="string")=>{const e=J([Q("length"),Q("lengthPadding"),Ue(Fn(Q(),-8),"chars")],n),t=e.decode.bind(e),r=e.encode.bind(e),i=e;return i.decode=(s,o)=>t(s,o).chars.toString(),i.encode=(s,o,a)=>{const c={chars:se.Buffer.from(s,"utf8")};return r(c,o,a)},i.alloc=s=>Q().span+Q().span+se.Buffer.from(s,"utf8").length,i},Ed=(n="authorized")=>J([be("staker"),be("withdrawer")],n),Bd=(n="lockup")=>J([Mt("unixTimestamp"),Mt("epoch"),be("custodian")],n),Cd=(n="voteInit")=>J([be("nodePubkey"),be("authorizedVoter"),be("authorizedWithdrawer"),ke("commission")],n),Od=(n="voteAuthorizeWithSeedArgs")=>J([Q("voteAuthorizationType"),be("currentAuthorityDerivedKeyOwnerPubkey"),Wn("currentAuthorityDerivedKeySeed"),be("newAuthorized")],n);function la(n,e){const t=i=>{if(i.span>=0)return i.span;if(typeof i.alloc=="function")return i.alloc(e[i.property]);if("count"in i&&"elementLayout"in i){const s=e[i.property];if(Array.isArray(s))return s.length*t(i.elementLayout)}else if("fields"in i)return la({layout:i},e[i.property]);return 0};let r=0;return n.layout.fields.forEach(i=>{r+=t(i)}),r}function St(n){let e=0,t=0;for(;;){let r=n.shift();if(e|=(r&127)<<t*7,t+=1,(r&128)===0)break}return e}function Ct(n,e){let t=e;for(;;){let r=t&127;if(t>>=7,t==0){n.push(r);break}else r|=128,n.push(r)}}function Se(n,e){if(!n)throw new Error(e||"Assertion failed")}class ki{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const r=new Map,i=o=>{const a=o.toBase58();let c=r.get(a);return c===void 0&&(c={isSigner:!1,isWritable:!1,isInvoked:!1},r.set(a,c)),c},s=i(t);s.isSigner=!0,s.isWritable=!0;for(const o of e){i(o.programId).isInvoked=!0;for(const a of o.keys){const c=i(a.pubkey);c.isSigner||=a.isSigner,c.isWritable||=a.isWritable}}return new ki(t,r)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];Se(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,c])=>c.isSigner&&c.isWritable),r=e.filter(([,c])=>c.isSigner&&!c.isWritable),i=e.filter(([,c])=>!c.isSigner&&c.isWritable),s=e.filter(([,c])=>!c.isSigner&&!c.isWritable),o={numRequiredSignatures:t.length+r.length,numReadonlySignedAccounts:r.length,numReadonlyUnsignedAccounts:s.length};{Se(t.length>0,"Expected at least one writable signer key");const[c]=t[0];Se(c===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const a=[...t.map(([c])=>new N(c)),...r.map(([c])=>new N(c)),...i.map(([c])=>new N(c)),...s.map(([c])=>new N(c))];return[o,a]}extractTableLookup(e){const[t,r]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[i,s]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&i.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:i},{writable:r,readonly:s}]}drainKeysFoundInLookupTable(e,t){const r=new Array,i=new Array;for(const[s,o]of this.keyMetaMap.entries())if(t(o)){const a=new N(s),c=e.findIndex(d=>d.equals(a));c>=0&&(Se(c<256,"Max lookup table index exceeded"),r.push(c),i.push(a),this.keyMetaMap.delete(s))}return[r,i]}}class $t{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new N(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:$e.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new xr(this.staticAccountKeys)}static compile(e){const t=ki.compile(e.instructions,e.payerKey),[r,i]=t.getMessageComponents(),o=new xr(i).compileInstructions(e.instructions).map(a=>({programIdIndex:a.programIdIndex,accounts:a.accountKeyIndexes,data:$e.encode(a.data)}));return new $t({header:r,accountKeys:i,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const r=e-t,s=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return r<s}else{const r=t-this.header.numReadonlySignedAccounts;return e<r}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];Ct(t,e);const r=this.instructions.map(g=>{const{accounts:w,programIdIndex:h}=g,b=Array.from($e.decode(g.data));let v=[];Ct(v,w.length);let p=[];return Ct(p,b.length),{programIdIndex:h,keyIndicesCount:se.Buffer.from(v),keyIndices:w,dataLength:se.Buffer.from(p),data:b}});let i=[];Ct(i,r.length);let s=se.Buffer.alloc(On);se.Buffer.from(i).copy(s);let o=i.length;r.forEach(g=>{o+=J([ke("programIdIndex"),Ue(g.keyIndicesCount.length,"keyIndicesCount"),ft(ke("keyIndex"),g.keyIndices.length,"keyIndices"),Ue(g.dataLength.length,"dataLength"),ft(ke("userdatum"),g.data.length,"data")]).encode(g,s,o)}),s=s.slice(0,o);const a=J([Ue(1,"numRequiredSignatures"),Ue(1,"numReadonlySignedAccounts"),Ue(1,"numReadonlyUnsignedAccounts"),Ue(t.length,"keyCount"),ft(be("key"),e,"keys"),be("recentBlockhash")]),c={numRequiredSignatures:se.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:se.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:se.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:se.Buffer.from(t),keys:this.accountKeys.map(g=>ge(g.toBytes())),recentBlockhash:$e.decode(this.recentBlockhash)};let d=se.Buffer.alloc(2048);const l=a.encode(c,d);return s.copy(d,l),d.slice(0,l+s.length)}static from(e){let t=[...e];const r=t.shift();if(r!==(r&Si))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const i=t.shift(),s=t.shift(),o=St(t);let a=[];for(let w=0;w<o;w++){const h=t.slice(0,Ot);t=t.slice(Ot),a.push(new N(se.Buffer.from(h)))}const c=t.slice(0,Ot);t=t.slice(Ot);const d=St(t);let l=[];for(let w=0;w<d;w++){const h=t.shift(),b=St(t),v=t.slice(0,b);t=t.slice(b);const p=St(t),m=t.slice(0,p),_=$e.encode(se.Buffer.from(m));t=t.slice(p),l.push({programIdIndex:h,accounts:v,data:_})}const g={header:{numRequiredSignatures:r,numReadonlySignedAccounts:i,numReadonlyUnsignedAccounts:s},recentBlockhash:$e.encode(se.Buffer.from(c)),accountKeys:a,instructions:l};return new $t(g)}}class Dn{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new xr(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,r=this.staticAccountKeys.length;if(e>=r){const i=e-r,s=this.addressTableLookups.reduce((o,a)=>o+a.writableIndexes.length,0);return i<s}else if(e>=this.header.numRequiredSignatures){const i=e-t,o=r-t-this.header.numReadonlyUnsignedAccounts;return i<o}else{const i=t-this.header.numReadonlySignedAccounts;return e<i}}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const r of this.addressTableLookups){const i=e.find(s=>s.key.equals(r.accountKey));if(!i)throw new Error(`Failed to find address lookup table account for table key ${r.accountKey.toBase58()}`);for(const s of r.writableIndexes)if(s<i.state.addresses.length)t.writable.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${r.accountKey.toBase58()}`);for(const s of r.readonlyIndexes)if(s<i.state.addresses.length)t.readonly.push(i.state.addresses[s]);else throw new Error(`Failed to find address for index ${s} in address lookup table ${r.accountKey.toBase58()}`)}return t}static compile(e){const t=ki.compile(e.instructions,e.payerKey),r=new Array,i={writable:new Array,readonly:new Array},s=e.addressLookupTableAccounts||[];for(const l of s){const g=t.extractTableLookup(l);if(g!==void 0){const[w,{writable:h,readonly:b}]=g;r.push(w),i.writable.push(...h),i.readonly.push(...b)}}const[o,a]=t.getMessageComponents(),d=new xr(a,i).compileInstructions(e.instructions);return new Dn({header:o,staticAccountKeys:a,recentBlockhash:e.recentBlockhash,compiledInstructions:d,addressTableLookups:r})}serialize(){const e=Array();Ct(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),r=Array();Ct(r,this.compiledInstructions.length);const i=this.serializeAddressTableLookups(),s=Array();Ct(s,this.addressTableLookups.length);const o=J([ke("prefix"),J([ke("numRequiredSignatures"),ke("numReadonlySignedAccounts"),ke("numReadonlyUnsignedAccounts")],"header"),Ue(e.length,"staticAccountKeysLength"),ft(be(),this.staticAccountKeys.length,"staticAccountKeys"),be("recentBlockhash"),Ue(r.length,"instructionsLength"),Ue(t.length,"serializedInstructions"),Ue(s.length,"addressTableLookupsLength"),Ue(i.length,"serializedAddressTableLookups")]),a=new Uint8Array(On),c=1<<7,d=o.encode({prefix:c,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(l=>l.toBytes()),recentBlockhash:$e.decode(this.recentBlockhash),instructionsLength:new Uint8Array(r),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(s),serializedAddressTableLookups:i},a);return a.slice(0,d)}serializeInstructions(){let e=0;const t=new Uint8Array(On);for(const r of this.compiledInstructions){const i=Array();Ct(i,r.accountKeyIndexes.length);const s=Array();Ct(s,r.data.length),e+=J([ke("programIdIndex"),Ue(i.length,"encodedAccountKeyIndexesLength"),ft(ke(),r.accountKeyIndexes.length,"accountKeyIndexes"),Ue(s.length,"encodedDataLength"),Ue(r.data.length,"data")]).encode({programIdIndex:r.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(i),accountKeyIndexes:r.accountKeyIndexes,encodedDataLength:new Uint8Array(s),data:r.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(On);for(const r of this.addressTableLookups){const i=Array();Ct(i,r.writableIndexes.length);const s=Array();Ct(s,r.readonlyIndexes.length),e+=J([be("accountKey"),Ue(i.length,"encodedWritableIndexesLength"),ft(ke(),r.writableIndexes.length,"writableIndexes"),Ue(s.length,"encodedReadonlyIndexesLength"),ft(ke(),r.readonlyIndexes.length,"readonlyIndexes")]).encode({accountKey:r.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(i),writableIndexes:r.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(s),readonlyIndexes:r.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const r=t.shift(),i=r&Si;Se(r!==i,"Expected versioned message but received legacy message");const s=i;Se(s===0,`Expected versioned message with version 0 but found version ${s}`);const o={numRequiredSignatures:t.shift(),numReadonlySignedAccounts:t.shift(),numReadonlyUnsignedAccounts:t.shift()},a=[],c=St(t);for(let b=0;b<c;b++)a.push(new N(t.splice(0,Ot)));const d=$e.encode(t.splice(0,Ot)),l=St(t),g=[];for(let b=0;b<l;b++){const v=t.shift(),p=St(t),m=t.splice(0,p),_=St(t),A=new Uint8Array(t.splice(0,_));g.push({programIdIndex:v,accountKeyIndexes:m,data:A})}const w=St(t),h=[];for(let b=0;b<w;b++){const v=new N(t.splice(0,Ot)),p=St(t),m=t.splice(0,p),_=St(t),A=t.splice(0,_);h.push({accountKey:v,writableIndexes:m,readonlyIndexes:A})}return new Dn({header:o,staticAccountKeys:a,recentBlockhash:d,compiledInstructions:g,addressTableLookups:h})}}const bs={deserializeMessageVersion(n){const e=n[0],t=e&Si;return t===e?"legacy":t},deserialize:n=>{const e=bs.deserializeMessageVersion(n);if(e==="legacy")return $t.from(n);if(e===0)return Dn.deserialize(n);throw new Error(`Transaction message version ${e} deserialization is not supported`)}};let bn=function(n){return n[n.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",n[n.PROCESSED=1]="PROCESSED",n[n.TIMED_OUT=2]="TIMED_OUT",n[n.NONCE_INVALID=3]="NONCE_INVALID",n}({});const xd=se.Buffer.alloc(dr).fill(0);class Ee{constructor(e){this.keys=void 0,this.programId=void 0,this.data=se.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:r})=>({pubkey:e.toJSON(),isSigner:t,isWritable:r})),programId:this.programId.toJSON(),data:[...this.data]}}}class Ie{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:r}=e;this.minNonceContextSlot=t,this.nonceInfo=r}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:r}=e;this.recentBlockhash=t,this.lastValidBlockHeight=r}else{const{recentBlockhash:t,nonceInfo:r}=e;r&&(this.nonceInfo=r),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new Ee(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let r;if(this.feePayer)r=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)r=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let v=0;v<t.length;v++)if(t[v].programId===void 0)throw new Error(`Transaction instruction index ${v} has undefined program id`);const i=[],s=[];t.forEach(v=>{v.keys.forEach(m=>{s.push({...m})});const p=v.programId.toString();i.includes(p)||i.push(p)}),i.forEach(v=>{s.push({pubkey:new N(v),isSigner:!1,isWritable:!1})});const o=[];s.forEach(v=>{const p=v.pubkey.toString(),m=o.findIndex(_=>_.pubkey.toString()===p);m>-1?(o[m].isWritable=o[m].isWritable||v.isWritable,o[m].isSigner=o[m].isSigner||v.isSigner):o.push(v)}),o.sort(function(v,p){if(v.isSigner!==p.isSigner)return v.isSigner?-1:1;if(v.isWritable!==p.isWritable)return v.isWritable?-1:1;const m={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return v.pubkey.toBase58().localeCompare(p.pubkey.toBase58(),"en",m)});const a=o.findIndex(v=>v.pubkey.equals(r));if(a>-1){const[v]=o.splice(a,1);v.isSigner=!0,v.isWritable=!0,o.unshift(v)}else o.unshift({pubkey:r,isSigner:!0,isWritable:!0});for(const v of this.signatures){const p=o.findIndex(m=>m.pubkey.equals(v.publicKey));if(p>-1)o[p].isSigner||(o[p].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${v.publicKey.toString()}`)}let c=0,d=0,l=0;const g=[],w=[];o.forEach(({pubkey:v,isSigner:p,isWritable:m})=>{p?(g.push(v.toString()),c+=1,m||(d+=1)):(w.push(v.toString()),m||(l+=1))});const h=g.concat(w),b=t.map(v=>{const{data:p,programId:m}=v;return{programIdIndex:h.indexOf(m.toString()),accounts:v.keys.map(_=>h.indexOf(_.pubkey.toString())),data:$e.encode(p)}});return b.forEach(v=>{Se(v.programIdIndex>=0),v.accounts.forEach(p=>Se(p>=0))}),new $t({header:{numRequiredSignatures:c,numReadonlySignedAccounts:d,numReadonlyUnsignedAccounts:l},accountKeys:h,recentBlockhash:e,instructions:b})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((i,s)=>t[s].equals(i.publicKey))||(this.signatures=t.map(r=>({signature:null,publicKey:r}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(r=>{const i=r.toString();return t.has(i)?!1:(t.add(i),!0)}).map(r=>({signature:null,publicKey:r}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,r=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),r.push(s))}this.signatures=r.map(s=>({signature:null,publicKey:s.publicKey}));const i=this._compile();this._partialSign(i,...r)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,r=[];for(const s of e){const o=s.publicKey.toString();t.has(o)||(t.add(o),r.push(s))}const i=this._compile();this._partialSign(i,...r)}_partialSign(e,...t){const r=e.serialize();t.forEach(i=>{const s=fs(r,i.secretKey);this._addSignature(i.publicKey,ge(s))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){Se(t.length===64);const r=this.signatures.findIndex(i=>e.equals(i.publicKey));if(r<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[r].signature=se.Buffer.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:r,publicKey:i}of this.signatures)if(r===null){if(t)return!1}else if(!_d(r,e,i.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:r}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),i=this.serializeMessage();if(r&&!this._verifySignatures(i,t))throw new Error("Signature verification failed");return this._serialize(i)}_serialize(e){const{signatures:t}=this,r=[];Ct(r,t.length);const i=r.length+t.length*64+e.length,s=se.Buffer.alloc(i);return Se(t.length<256),se.Buffer.from(r).copy(s,0),t.forEach(({signature:o},a)=>{o!==null&&(Se(o.length===64,"signature has invalid length"),se.Buffer.from(o).copy(s,r.length+a*64))}),e.copy(s,r.length+t.length*64),Se(s.length<=On,`Transaction too large: ${s.length} > ${On}`),s}get keys(){return Se(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return Se(this.instructions.length===1),this.instructions[0].programId}get data(){return Se(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const r=St(t);let i=[];for(let s=0;s<r;s++){const o=t.slice(0,dr);t=t.slice(dr),i.push($e.encode(se.Buffer.from(o)))}return Ie.populate($t.from(t),i)}static populate(e,t=[]){const r=new Ie;return r.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(r.feePayer=e.accountKeys[0]),t.forEach((i,s)=>{const o={signature:i==$e.encode(xd)?null:$e.decode(i),publicKey:e.accountKeys[s]};r.signatures.push(o)}),e.instructions.forEach(i=>{const s=i.accounts.map(o=>{const a=e.accountKeys[o];return{pubkey:a,isSigner:r.signatures.some(c=>c.publicKey.toString()===a.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});r.instructions.push(new Ee({keys:s,programId:e.accountKeys[i.programIdIndex],data:$e.decode(i.data)}))}),r._message=e,r._json=r.toJSON(),r}}class ms{constructor(e){this.payerKey=void 0,this.instructions=void 0,this.recentBlockhash=void 0,this.payerKey=e.payerKey,this.instructions=e.instructions,this.recentBlockhash=e.recentBlockhash}static decompile(e,t){const{header:r,compiledInstructions:i,recentBlockhash:s}=e,{numRequiredSignatures:o,numReadonlySignedAccounts:a,numReadonlyUnsignedAccounts:c}=r,d=o-a;Se(d>0,"Message header is invalid");const l=e.staticAccountKeys.length-o-c;Se(l>=0,"Message header is invalid");const g=e.getAccountKeys(t),w=g.get(0);if(w===void 0)throw new Error("Failed to decompile message because no account keys were found");const h=[];for(const b of i){const v=[];for(const m of b.accountKeyIndexes){const _=g.get(m);if(_===void 0)throw new Error(`Failed to find key for account key index ${m}`);const A=m<o;let T;A?T=m<d:m<g.staticAccountKeys.length?T=m-o<l:T=m-g.staticAccountKeys.length<g.accountKeysFromLookups.writable.length,v.push({pubkey:_,isSigner:m<r.numRequiredSignatures,isWritable:T})}const p=g.get(b.programIdIndex);if(p===void 0)throw new Error(`Failed to find program id for program id index ${b.programIdIndex}`);h.push(new Ee({programId:p,data:ge(b.data),keys:v}))}return new ms({payerKey:w,instructions:h,recentBlockhash:s})}compileToLegacyMessage(){return $t.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions})}compileToV0Message(e){return Dn.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions,addressLookupTableAccounts:e})}}class ps{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,t!==void 0)Se(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{const r=[];for(let i=0;i<e.header.numRequiredSignatures;i++)r.push(new Uint8Array(dr));this.signatures=r}this.message=e}serialize(){const e=this.message.serialize(),t=Array();Ct(t,this.signatures.length);const r=J([Ue(t.length,"encodedSignaturesLength"),ft(Td(),this.signatures.length,"signatures"),Ue(e.length,"serializedMessage")]),i=new Uint8Array(2048),s=r.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},i);return i.slice(0,s)}static deserialize(e){let t=[...e];const r=[],i=St(t);for(let o=0;o<i;o++)r.push(new Uint8Array(t.splice(0,dr)));const s=bs.deserialize(new Uint8Array(t));return new ps(s,r)}sign(e){const t=this.message.serialize(),r=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const i of e){const s=r.findIndex(o=>o.equals(i.publicKey));Se(s>=0,`Cannot sign with non signer key ${i.publicKey.toBase58()}`),this.signatures[s]=fs(t,i.secretKey)}}addSignature(e,t){Se(t.byteLength===64,"Signature must be 64 bytes long");const i=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(s=>s.equals(e));Se(i>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[i]=t}}const Ld=160,Nd=64,zd=Ld/Nd,da=1e3/zd,Qt=new N("SysvarC1ock11111111111111111111111111111111"),Kd=new N("SysvarEpochSchedu1e111111111111111111111111"),Md=new N("Sysvar1nstructions1111111111111111111111111"),oi=new N("SysvarRecentB1ockHashes11111111111111111111"),fr=new N("SysvarRent111111111111111111111111111111111"),Ud=new N("SysvarRewards111111111111111111111111111111"),qd=new N("SysvarS1otHashes111111111111111111111111111"),Wd=new N("SysvarS1otHistory11111111111111111111111111"),ai=new N("SysvarStakeHistory1111111111111111111111111");async function Yi(n,e,t,r){const i=r&&{skipPreflight:r.skipPreflight,preflightCommitment:r.preflightCommitment||r.commitment,maxRetries:r.maxRetries,minContextSlot:r.minContextSlot},s=await n.sendTransaction(e,t,i);let o;if(e.recentBlockhash!=null&&e.lastValidBlockHeight!=null)o=(await n.confirmTransaction({abortSignal:r==null?void 0:r.abortSignal,signature:s,blockhash:e.recentBlockhash,lastValidBlockHeight:e.lastValidBlockHeight},r&&r.commitment)).value;else if(e.minNonceContextSlot!=null&&e.nonceInfo!=null){const{nonceInstruction:a}=e.nonceInfo,c=a.keys[0].pubkey;o=(await n.confirmTransaction({abortSignal:r==null?void 0:r.abortSignal,minContextSlot:e.minNonceContextSlot,nonceAccountPubkey:c,nonceValue:e.nonceInfo.nonce,signature:s},r&&r.commitment)).value}else(r==null?void 0:r.abortSignal)!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),o=(await n.confirmTransaction(s,r&&r.commitment)).value;if(o.err)throw new Error(`Transaction ${s} failed (${JSON.stringify(o)})`);return s}function qn(n){return new Promise(e=>setTimeout(e,n))}function we(n,e){const t=n.layout.span>=0?n.layout.span:la(n,e),r=se.Buffer.alloc(t),i=Object.assign({instruction:n.index},e);return n.layout.encode(i,r),r}function Ae(n,e){let t;try{t=n.layout.decode(e)}catch(r){throw new Error("invalid instruction; "+r)}if(t.instruction!==n.index)throw new Error(`invalid instruction; instruction index mismatch ${t.instruction} != ${n.index}`);return t}const fa=dt("lamportsPerSignature"),ha=J([Q("version"),Q("state"),be("authorizedPubkey"),be("nonce"),J([fa],"feeCalculator")]),Ji=ha.span;class _i{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=ha.decode(ge(e),0);return new _i({authorizedPubkey:new N(t.authorizedPubkey),nonce:new N(t.nonce).toString(),feeCalculator:t.feeCalculator})}}const Fd=n=>{const e=n.decode.bind(n),t=n.encode.bind(n);return{decode:e,encode:t}},Dd=n=>e=>{const t=Ue(n,e),{encode:r,decode:i}=Fd(t),s=t;return s.decode=(o,a)=>{const c=i(o,a);return Hu(se.Buffer.from(c))},s.encode=(o,a,c)=>{const d=Ro(o,n);return r(d,a,c)},s},hr=Dd(8);class Vd{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const r=Q("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(xe))if(o.index==r){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a SystemInstruction");return i}static decodeCreateAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t,space:r,programId:i}=Ae(xe.Create,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,lamports:t,space:r,programId:new N(i)}}static decodeTransfer(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t}=Ae(xe.Transfer,e.data);return{fromPubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,lamports:t}}static decodeTransferWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t,seed:r,programId:i}=Ae(xe.TransferWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,basePubkey:e.keys[1].pubkey,toPubkey:e.keys[2].pubkey,lamports:t,seed:r,programId:new N(i)}}static decodeAllocate(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{space:t}=Ae(xe.Allocate,e.data);return{accountPubkey:e.keys[0].pubkey,space:t}}static decodeAllocateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:r,space:i,programId:s}=Ae(xe.AllocateWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new N(t),seed:r,space:i,programId:new N(s)}}static decodeAssign(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{programId:t}=Ae(xe.Assign,e.data);return{accountPubkey:e.keys[0].pubkey,programId:new N(t)}}static decodeAssignWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:r,programId:i}=Ae(xe.AssignWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new N(t),seed:r,programId:new N(i)}}static decodeCreateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{base:t,seed:r,lamports:i,space:s,programId:o}=Ae(xe.CreateWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,basePubkey:new N(t),seed:r,lamports:i,space:s,programId:new N(o)}}static decodeNonceInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{authorized:t}=Ae(xe.InitializeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:new N(t)}}static decodeNonceAdvance(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Ae(xe.AdvanceNonceAccount,e.data),{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static decodeNonceWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Ae(xe.WithdrawNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t}}static decodeNonceAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t}=Ae(xe.AuthorizeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[1].pubkey,newAuthorizedPubkey:new N(t)}}static checkProgramId(e){if(!e.equals(ot.programId))throw new Error("invalid instruction; programId is not SystemProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const xe=Object.freeze({Create:{index:0,layout:J([Q("instruction"),Mt("lamports"),Mt("space"),be("programId")])},Assign:{index:1,layout:J([Q("instruction"),be("programId")])},Transfer:{index:2,layout:J([Q("instruction"),hr("lamports")])},CreateWithSeed:{index:3,layout:J([Q("instruction"),be("base"),Wn("seed"),Mt("lamports"),Mt("space"),be("programId")])},AdvanceNonceAccount:{index:4,layout:J([Q("instruction")])},WithdrawNonceAccount:{index:5,layout:J([Q("instruction"),Mt("lamports")])},InitializeNonceAccount:{index:6,layout:J([Q("instruction"),be("authorized")])},AuthorizeNonceAccount:{index:7,layout:J([Q("instruction"),be("authorized")])},Allocate:{index:8,layout:J([Q("instruction"),Mt("space")])},AllocateWithSeed:{index:9,layout:J([Q("instruction"),be("base"),Wn("seed"),Mt("space"),be("programId")])},AssignWithSeed:{index:10,layout:J([Q("instruction"),be("base"),Wn("seed"),be("programId")])},TransferWithSeed:{index:11,layout:J([Q("instruction"),hr("lamports"),Wn("seed"),be("programId")])},UpgradeNonceAccount:{index:12,layout:J([Q("instruction")])}});class ot{constructor(){}static createAccount(e){const t=xe.Create,r=we(t,{lamports:e.lamports,space:e.space,programId:ge(e.programId.toBuffer())});return new Ee({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:r})}static transfer(e){let t,r;if("basePubkey"in e){const i=xe.TransferWithSeed;t=we(i,{lamports:BigInt(e.lamports),seed:e.seed,programId:ge(e.programId.toBuffer())}),r=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}else{const i=xe.Transfer;t=we(i,{lamports:BigInt(e.lamports)}),r=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}return new Ee({keys:r,programId:this.programId,data:t})}static assign(e){let t,r;if("basePubkey"in e){const i=xe.AssignWithSeed;t=we(i,{base:ge(e.basePubkey.toBuffer()),seed:e.seed,programId:ge(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=xe.Assign;t=we(i,{programId:ge(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new Ee({keys:r,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=xe.CreateWithSeed,r=we(t,{base:ge(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:ge(e.programId.toBuffer())});let i=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey!=e.fromPubkey&&i.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new Ee({keys:i,programId:this.programId,data:r})}static createNonceAccount(e){const t=new Ie;"basePubkey"in e&&"seed"in e?t.add(ot.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:Ji,programId:this.programId})):t.add(ot.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:Ji,programId:this.programId}));const r={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(r)),t}static nonceInitialize(e){const t=xe.InitializeNonceAccount,r=we(t,{authorized:ge(e.authorizedPubkey.toBuffer())}),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:oi,isSigner:!1,isWritable:!1},{pubkey:fr,isSigner:!1,isWritable:!1}],programId:this.programId,data:r};return new Ee(i)}static nonceAdvance(e){const t=xe.AdvanceNonceAccount,r=we(t),i={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:oi,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:r};return new Ee(i)}static nonceWithdraw(e){const t=xe.WithdrawNonceAccount,r=we(t,{lamports:e.lamports});return new Ee({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:oi,isSigner:!1,isWritable:!1},{pubkey:fr,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:r})}static nonceAuthorize(e){const t=xe.AuthorizeNonceAccount,r=we(t,{authorized:ge(e.newAuthorizedPubkey.toBuffer())});return new Ee({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:r})}static allocate(e){let t,r;if("basePubkey"in e){const i=xe.AllocateWithSeed;t=we(i,{base:ge(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:ge(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const i=xe.Allocate;t=we(i,{space:e.space}),r=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new Ee({keys:r,programId:this.programId,data:t})}}ot.programId=new N("11111111111111111111111111111111");const $d=On-300;class Vn{constructor(){}static getMinNumSignatures(e){return 2*(Math.ceil(e/Vn.chunkSize)+1+1)}static async load(e,t,r,i,s){{const g=await e.getMinimumBalanceForRentExemption(s.length),w=await e.getAccountInfo(r.publicKey,"confirmed");let h=null;if(w!==null){if(w.executable)return console.error("Program load failed, account is already executable"),!1;w.data.length!==s.length&&(h=h||new Ie,h.add(ot.allocate({accountPubkey:r.publicKey,space:s.length}))),w.owner.equals(i)||(h=h||new Ie,h.add(ot.assign({accountPubkey:r.publicKey,programId:i}))),w.lamports<g&&(h=h||new Ie,h.add(ot.transfer({fromPubkey:t.publicKey,toPubkey:r.publicKey,lamports:g-w.lamports})))}else h=new Ie().add(ot.createAccount({fromPubkey:t.publicKey,newAccountPubkey:r.publicKey,lamports:g>0?g:1,space:s.length,programId:i}));h!==null&&await Yi(e,h,[t,r],{commitment:"confirmed"})}const o=J([Q("instruction"),Q("offset"),Q("bytesLength"),Q("bytesLengthPadding"),ft(ke("byte"),Fn(Q(),-8),"bytes")]),a=Vn.chunkSize;let c=0,d=s,l=[];for(;d.length>0;){const g=d.slice(0,a),w=se.Buffer.alloc(a+16);o.encode({instruction:0,offset:c,bytes:g,bytesLength:0,bytesLengthPadding:0},w);const h=new Ie().add({keys:[{pubkey:r.publicKey,isSigner:!0,isWritable:!0}],programId:i,data:w});l.push(Yi(e,h,[t,r],{commitment:"confirmed"})),e._rpcEndpoint.includes("solana.com")&&await qn(1e3/4),c+=a,d=d.slice(a)}await Promise.all(l);{const g=J([Q("instruction")]),w=se.Buffer.alloc(g.span);g.encode({instruction:1},w);const h=new Ie().add({keys:[{pubkey:r.publicKey,isSigner:!0,isWritable:!0},{pubkey:fr,isSigner:!1,isWritable:!1}],programId:i,data:w}),b="processed",v=await e.sendTransaction(h,[t,r],{preflightCommitment:b}),{context:p,value:m}=await e.confirmTransaction({signature:v,lastValidBlockHeight:h.lastValidBlockHeight,blockhash:h.recentBlockhash},b);if(m.err)throw new Error(`Transaction ${v} failed (${JSON.stringify(m)})`);for(;;){try{if(await e.getSlot({commitment:b})>p.slot)break}catch{}await new Promise(_=>setTimeout(_,Math.round(da/2)))}}return!0}}Vn.chunkSize=$d;const Hd=new N("BPFLoader2111111111111111111111111111111111");class Gd{static getMinNumSignatures(e){return Vn.getMinNumSignatures(e)}static load(e,t,r,i,s){return Vn.load(e,t,r,s,i)}}function jd(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Yd=Object.prototype.toString,Jd=Object.keys||function(n){var e=[];for(var t in n)e.push(t);return e};function Tr(n,e){var t,r,i,s,o,a,c;if(n===!0)return"true";if(n===!1)return"false";switch(typeof n){case"object":if(n===null)return null;if(n.toJSON&&typeof n.toJSON=="function")return Tr(n.toJSON(),e);if(c=Yd.call(n),c==="[object Array]"){for(i="[",r=n.length-1,t=0;t<r;t++)i+=Tr(n[t],!0)+",";return r>-1&&(i+=Tr(n[t],!0)),i+"]"}else if(c==="[object Object]"){for(s=Jd(n).sort(),r=s.length,i="",t=0;t<r;)o=s[t],a=Tr(n[o],!1),a!==void 0&&(i&&(i+=","),i+=JSON.stringify(o)+":"+a),t++;return"{"+i+"}"}else return JSON.stringify(n);case"function":case"undefined":return e?null:void 0;case"string":return JSON.stringify(n);default:return isFinite(n)?n:null}}var Qd=function(n){var e=Tr(n,!1);if(e!==void 0)return""+e},oo=jd(Qd);const Pr=32;function Mi(n){let e=0;for(;n>1;)n/=2,e++;return e}function Xd(n){return n===0?1:(n--,n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n|=n>>16,n|=n>>32,n+1)}class ga{constructor(e,t,r,i,s){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=r,this.firstNormalEpoch=i,this.firstNormalSlot=s}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const t=Mi(Xd(e+Pr+1))-Mi(Pr)-1,r=this.getSlotsInEpoch(t),i=e-(r-Pr);return[t,i]}else{const t=e-this.firstNormalSlot,r=Math.floor(t/this.slotsPerEpoch),i=this.firstNormalEpoch+r,s=t%this.slotsPerEpoch;return[i,s]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*Pr:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+Mi(Pr)):this.slotsPerEpoch}}class Qi extends Error{constructor(e,t){super(e),this.logs=void 0,this.logs=t}}const Zd={JSON_RPC_SERVER_ERROR_BLOCK_CLEANED_UP:-32001,JSON_RPC_SERVER_ERROR_SEND_TRANSACTION_PREFLIGHT_FAILURE:-32002,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_VERIFICATION_FAILURE:-32003,JSON_RPC_SERVER_ERROR_BLOCK_NOT_AVAILABLE:-32004,JSON_RPC_SERVER_ERROR_NODE_UNHEALTHY:-32005,JSON_RPC_SERVER_ERROR_TRANSACTION_PRECOMPILE_VERIFICATION_FAILURE:-32006,JSON_RPC_SERVER_ERROR_SLOT_SKIPPED:-32007,JSON_RPC_SERVER_ERROR_NO_SNAPSHOT:-32008,JSON_RPC_SERVER_ERROR_LONG_TERM_STORAGE_SLOT_SKIPPED:-32009,JSON_RPC_SERVER_ERROR_KEY_EXCLUDED_FROM_SECONDARY_INDEX:-32010,JSON_RPC_SERVER_ERROR_TRANSACTION_HISTORY_NOT_AVAILABLE:-32011,JSON_RPC_SCAN_ERROR:-32012,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_LEN_MISMATCH:-32013,JSON_RPC_SERVER_ERROR_BLOCK_STATUS_NOT_AVAILABLE_YET:-32014,JSON_RPC_SERVER_ERROR_UNSUPPORTED_TRANSACTION_VERSION:-32015,JSON_RPC_SERVER_ERROR_MIN_CONTEXT_SLOT_NOT_REACHED:-32016};class X extends Error{constructor({code:e,message:t,data:r},i){super(i!=null?`${i}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=r,this.name="SolanaJSONRPCError"}}var ef=globalThis.fetch;class tf extends Gu{constructor(e,t,r){const i=s=>{const o=Ju(s,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in o?this.underlyingSocket=o.socket:this.underlyingSocket=o,o};super(i,e,t,r),this.underlyingSocket=void 0}call(...e){var r;const t=(r=this.underlyingSocket)==null?void 0:r.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){var r;const t=(r=this.underlyingSocket)==null?void 0:r.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}function nf(n,e){let t;try{t=n.layout.decode(e)}catch(r){throw new Error("invalid instruction; "+r)}if(t.typeIndex!==n.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${n.index}`);return t}const ao=56;class Xi{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=nf(rf,e),r=e.length-ao;Se(r>=0,"lookup table is invalid"),Se(r%32===0,"lookup table is invalid");const i=r/32,{addresses:s}=J([ft(be(),i,"addresses")]).decode(e.slice(ao));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new N(t.authority[0]):void 0,addresses:s.map(o=>new N(o))}}}const rf={index:1,layout:J([Q("typeIndex"),hr("deactivationSlot"),dt("lastExtendedSlot"),ke("lastExtendedStartIndex"),ke(),ft(be(),Fn(ke(),-1),"authority")])},sf=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function of(n){const e=n.match(sf);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${n}\``);const[t,r,i,s]=e,o=n.startsWith("https:")?"wss:":"ws:",a=i==null?null:parseInt(i.slice(1),10),c=a==null?"":`:${a+1}`;return`${o}//${r}${c}${s}`}const He=zr(ss(N),L(),n=>new N(n)),ya=os([L(),qe("base64")]),vs=zr(ss(se.Buffer),ya,n=>se.Buffer.from(n[0],"base64")),ba=30*1e3;function af(n){if(/^https?:/.test(n)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return n}function Me(n){let e,t;if(typeof n=="string")e=n;else if(n){const{commitment:r,...i}=n;e=r,t=i}return{commitment:e,config:t}}function ma(n){return At([B({jsonrpc:qe("2.0"),id:L(),result:n}),B({jsonrpc:qe("2.0"),id:L(),error:B({code:Kr(),message:L(),data:ae($u())})})])}const uf=ma(Kr());function he(n){return zr(ma(n),uf,e=>"error"in e?e:{...e,result:z(e.result,n)})}function De(n){return he(B({context:B({slot:S()}),value:n}))}function Ai(n){return B({context:B({slot:S()}),value:n})}function Ui(n,e){return n===0?new Dn({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new N(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:$e.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new $t(e)}const cf=B({foundation:S(),foundationTerm:S(),initial:S(),taper:S(),terminal:S()}),lf=he(D(W(B({epoch:S(),effectiveSlot:S(),amount:S(),postBalance:S(),commission:ae(W(S()))})))),df=D(B({slot:S(),prioritizationFee:S()})),ff=B({total:S(),validator:S(),foundation:S(),epoch:S()}),hf=B({epoch:S(),slotIndex:S(),slotsInEpoch:S(),absoluteSlot:S(),blockHeight:ae(S()),transactionCount:ae(S())}),gf=B({slotsPerEpoch:S(),leaderScheduleSlotOffset:S(),warmup:Zt(),firstNormalEpoch:S(),firstNormalSlot:S()}),yf=Io(L(),D(S())),Hn=W(At([B({}),L()])),bf=B({err:Hn}),mf=qe("receivedSignature"),pf=B({"solana-core":L(),"feature-set":ae(S())}),uo=De(B({err:W(At([B({}),L()])),logs:W(D(L())),accounts:ae(W(D(W(B({executable:Zt(),owner:L(),lamports:S(),data:D(L()),rentEpoch:ae(S())}))))),unitsConsumed:ae(S()),returnData:ae(W(B({programId:L(),data:os([L(),qe("base64")])})))})),vf=De(B({byIdentity:Io(L(),D(S())),range:B({firstSlot:S(),lastSlot:S()})}));function wf(n,e,t,r,i,s){const o=t||ef;let a;s!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let c;return r&&(c=async(l,g)=>{const w=await new Promise((h,b)=>{try{r(l,g,(v,p)=>h([v,p]))}catch(v){b(v)}});return await o(...w)}),new ju(async(l,g)=>{const w={method:"POST",body:l,agent:a,headers:Object.assign({"Content-Type":"application/json"},e||{},Sh)};try{let h=5,b,v=500;for(;c?b=await c(n,w):b=await o(n,w),!(b.status!==429||i===!0||(h-=1,h===0));)console.log(`Server responded with ${b.status} ${b.statusText}.  Retrying after ${v}ms delay...`),await qn(v),v*=2;const p=await b.text();b.ok?g(null,p):g(new Error(`${b.status} ${b.statusText}: ${p}`))}catch(h){h instanceof Error&&g(h)}},{})}function Sf(n){return(e,t)=>new Promise((r,i)=>{n.request(e,t,(s,o)=>{if(s){i(s);return}r(o)})})}function kf(n){return e=>new Promise((t,r)=>{e.length===0&&t([]);const i=e.map(s=>n.request(s.methodName,s.args));n.request(i,(s,o)=>{if(s){r(s);return}t(o)})})}const _f=he(cf),Af=he(ff),If=he(df),Rf=he(hf),Pf=he(gf),Tf=he(yf),Ef=he(S()),Bf=De(B({total:S(),circulating:S(),nonCirculating:S(),nonCirculatingAccounts:D(He)})),Zi=B({amount:L(),uiAmount:W(S()),decimals:S(),uiAmountString:ae(L())}),Cf=De(D(B({address:He,amount:L(),uiAmount:W(S()),decimals:S(),uiAmountString:ae(L())}))),Of=De(D(B({pubkey:He,account:B({executable:Zt(),owner:He,lamports:S(),data:vs,rentEpoch:S()})}))),es=B({program:L(),parsed:Kr(),space:S()}),xf=De(D(B({pubkey:He,account:B({executable:Zt(),owner:He,lamports:S(),data:es,rentEpoch:S()})}))),Lf=De(D(B({lamports:S(),address:He}))),Lr=B({executable:Zt(),owner:He,lamports:S(),data:vs,rentEpoch:S()}),Nf=B({pubkey:He,account:Lr}),zf=zr(At([ss(se.Buffer),es]),At([ya,es]),n=>Array.isArray(n)?z(n,vs):n),ts=B({executable:Zt(),owner:He,lamports:S(),data:zf,rentEpoch:S()}),Kf=B({pubkey:He,account:ts}),Mf=B({state:At([qe("active"),qe("inactive"),qe("activating"),qe("deactivating")]),active:S(),inactive:S()}),Uf=he(D(B({signature:L(),slot:S(),err:Hn,memo:W(L()),blockTime:ae(W(S()))}))),qf=he(D(B({signature:L(),slot:S(),err:Hn,memo:W(L()),blockTime:ae(W(S()))}))),Wf=B({subscription:S(),result:Ai(Lr)}),Ff=B({pubkey:He,account:Lr}),Df=B({subscription:S(),result:Ai(Ff)}),Vf=B({parent:S(),slot:S(),root:S()}),$f=B({subscription:S(),result:Vf}),Hf=At([B({type:At([qe("firstShredReceived"),qe("completed"),qe("optimisticConfirmation"),qe("root")]),slot:S(),timestamp:S()}),B({type:qe("createdBank"),parent:S(),slot:S(),timestamp:S()}),B({type:qe("frozen"),slot:S(),timestamp:S(),stats:B({numTransactionEntries:S(),numSuccessfulTransactions:S(),numFailedTransactions:S(),maxTransactionsPerEntry:S()})}),B({type:qe("dead"),slot:S(),timestamp:S(),err:L()})]),Gf=B({subscription:S(),result:Hf}),jf=B({subscription:S(),result:Ai(At([bf,mf]))}),Yf=B({subscription:S(),result:S()}),Jf=B({pubkey:L(),gossip:W(L()),tpu:W(L()),rpc:W(L()),version:W(L())}),co=B({votePubkey:L(),nodePubkey:L(),activatedStake:S(),epochVoteAccount:Zt(),epochCredits:D(os([S(),S(),S()])),commission:S(),lastVote:S(),rootSlot:W(S())}),Qf=he(B({current:D(co),delinquent:D(co)})),Xf=At([qe("processed"),qe("confirmed"),qe("finalized")]),Zf=B({slot:S(),confirmations:W(S()),err:Hn,confirmationStatus:ae(Xf)}),eh=De(D(W(Zf))),th=he(S()),pa=B({accountKey:He,writableIndexes:D(S()),readonlyIndexes:D(S())}),ws=B({signatures:D(L()),message:B({accountKeys:D(L()),header:B({numRequiredSignatures:S(),numReadonlySignedAccounts:S(),numReadonlyUnsignedAccounts:S()}),instructions:D(B({accounts:D(S()),data:L(),programIdIndex:S()})),recentBlockhash:L(),addressTableLookups:ae(D(pa))})}),va=B({pubkey:He,signer:Zt(),writable:Zt(),source:ae(At([qe("transaction"),qe("lookupTable")]))}),wa=B({accountKeys:D(va),signatures:D(L())}),Sa=B({parsed:Kr(),program:L(),programId:He}),ka=B({accounts:D(He),data:L(),programId:He}),nh=At([ka,Sa]),rh=At([B({parsed:Kr(),program:L(),programId:L()}),B({accounts:D(L()),data:L(),programId:L()})]),_a=zr(nh,rh,n=>"accounts"in n?z(n,ka):z(n,Sa)),Aa=B({signatures:D(L()),message:B({accountKeys:D(va),instructions:D(_a),recentBlockhash:L(),addressTableLookups:ae(W(D(pa)))})}),di=B({accountIndex:S(),mint:L(),owner:ae(L()),uiTokenAmount:Zi}),Ia=B({writable:D(He),readonly:D(He)}),Ii=B({err:Hn,fee:S(),innerInstructions:ae(W(D(B({index:S(),instructions:D(B({accounts:D(S()),data:L(),programIdIndex:S()}))})))),preBalances:D(S()),postBalances:D(S()),logMessages:ae(W(D(L()))),preTokenBalances:ae(W(D(di))),postTokenBalances:ae(W(D(di))),loadedAddresses:ae(Ia),computeUnitsConsumed:ae(S())}),Ss=B({err:Hn,fee:S(),innerInstructions:ae(W(D(B({index:S(),instructions:D(_a)})))),preBalances:D(S()),postBalances:D(S()),logMessages:ae(W(D(L()))),preTokenBalances:ae(W(D(di))),postTokenBalances:ae(W(D(di))),loadedAddresses:ae(Ia),computeUnitsConsumed:ae(S())}),br=At([qe(0),qe("legacy")]),Gn=B({pubkey:L(),lamports:S(),postBalance:W(S()),rewardType:W(L()),commission:ae(W(S()))}),ih=he(W(B({blockhash:L(),previousBlockhash:L(),parentSlot:S(),transactions:D(B({transaction:ws,meta:W(Ii),version:ae(br)})),rewards:ae(D(Gn)),blockTime:W(S()),blockHeight:W(S())}))),sh=he(W(B({blockhash:L(),previousBlockhash:L(),parentSlot:S(),rewards:ae(D(Gn)),blockTime:W(S()),blockHeight:W(S())}))),oh=he(W(B({blockhash:L(),previousBlockhash:L(),parentSlot:S(),transactions:D(B({transaction:wa,meta:W(Ii),version:ae(br)})),rewards:ae(D(Gn)),blockTime:W(S()),blockHeight:W(S())}))),ah=he(W(B({blockhash:L(),previousBlockhash:L(),parentSlot:S(),transactions:D(B({transaction:Aa,meta:W(Ss),version:ae(br)})),rewards:ae(D(Gn)),blockTime:W(S()),blockHeight:W(S())}))),uh=he(W(B({blockhash:L(),previousBlockhash:L(),parentSlot:S(),transactions:D(B({transaction:wa,meta:W(Ss),version:ae(br)})),rewards:ae(D(Gn)),blockTime:W(S()),blockHeight:W(S())}))),ch=he(W(B({blockhash:L(),previousBlockhash:L(),parentSlot:S(),rewards:ae(D(Gn)),blockTime:W(S()),blockHeight:W(S())}))),lh=he(W(B({blockhash:L(),previousBlockhash:L(),parentSlot:S(),transactions:D(B({transaction:ws,meta:W(Ii)})),rewards:ae(D(Gn)),blockTime:W(S())}))),lo=he(W(B({blockhash:L(),previousBlockhash:L(),parentSlot:S(),signatures:D(L()),blockTime:W(S())}))),qi=he(W(B({slot:S(),meta:W(Ii),blockTime:ae(W(S())),transaction:ws,version:ae(br)}))),si=he(W(B({slot:S(),transaction:Aa,meta:W(Ss),blockTime:ae(W(S())),version:ae(br)}))),dh=De(B({blockhash:L(),feeCalculator:B({lamportsPerSignature:S()})})),fh=De(B({blockhash:L(),lastValidBlockHeight:S()})),hh=De(Zt()),gh=B({slot:S(),numTransactions:S(),numSlots:S(),samplePeriodSecs:S()}),yh=he(D(gh)),bh=De(W(B({feeCalculator:B({lamportsPerSignature:S()})}))),mh=he(L()),ph=he(L()),vh=B({err:Hn,logs:D(L()),signature:L()}),wh=B({result:Ai(vh),subscription:S()}),Sh={"solana-client":"js/0.0.0-development"};class kh{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const d={};return async l=>{const{commitment:g,config:w}=Me(l),h=this._buildArgs([],g,void 0,w),b=oo(h);return d[b]=d[b]??(async()=>{try{const v=await this._rpcRequest("getBlockHeight",h),p=z(v,he(S()));if("error"in p)throw new X(p.error,"failed to get block height information");return p.result}finally{delete d[b]}})(),await d[b]}})();let r,i,s,o,a,c;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,r=t.wsEndpoint,i=t.httpHeaders,s=t.fetch,o=t.fetchMiddleware,a=t.disableRetryOnRateLimit,c=t.httpAgent),this._rpcEndpoint=af(e),this._rpcWsEndpoint=r||of(e),this._rpcClient=wf(e,i,s,o,a,c),this._rpcRequest=Sf(this._rpcClient),this._rpcBatchRequest=kf(this._rpcClient),this._rpcWebSocket=new tf(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:r,config:i}=Me(t),s=this._buildArgs([e.toBase58()],r,void 0,i),o=await this._rpcRequest("getBalance",s),a=z(o,De(S()));if("error"in a)throw new X(a.error,`failed to get balance for ${e.toBase58()}`);return a.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(r=>r.value).catch(r=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+r)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),r=z(t,he(W(S())));if("error"in r)throw new X(r.error,`failed to get block time for slot ${e}`);return r.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=z(e,he(S()));if("error"in t)throw new X(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=z(e,Ef);if("error"in t)throw new X(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};const r=await this._rpcRequest("getSupply",[t]),i=z(r,Bf);if("error"in i)throw new X(i.error,"failed to get supply");return i.result}async getTokenSupply(e,t){const r=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenSupply",r),s=z(i,De(Zi));if("error"in s)throw new X(s.error,"failed to get token supply");return s.result}async getTokenAccountBalance(e,t){const r=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenAccountBalance",r),s=z(i,De(Zi));if("error"in s)throw new X(s.error,"failed to get token account balance");return s.result}async getTokenAccountsByOwner(e,t,r){const{commitment:i,config:s}=Me(r);let o=[e.toBase58()];"mint"in t?o.push({mint:t.mint.toBase58()}):o.push({programId:t.programId.toBase58()});const a=this._buildArgs(o,i,"base64",s),c=await this._rpcRequest("getTokenAccountsByOwner",a),d=z(c,Of);if("error"in d)throw new X(d.error,`failed to get token accounts owned by account ${e.toBase58()}`);return d.result}async getParsedTokenAccountsByOwner(e,t,r){let i=[e.toBase58()];"mint"in t?i.push({mint:t.mint.toBase58()}):i.push({programId:t.programId.toBase58()});const s=this._buildArgs(i,r,"jsonParsed"),o=await this._rpcRequest("getTokenAccountsByOwner",s),a=z(o,xf);if("error"in a)throw new X(a.error,`failed to get token accounts owned by account ${e.toBase58()}`);return a.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},r=t.filter||t.commitment?[t]:[],i=await this._rpcRequest("getLargestAccounts",r),s=z(i,Lf);if("error"in s)throw new X(s.error,"failed to get largest accounts");return s.result}async getTokenLargestAccounts(e,t){const r=this._buildArgs([e.toBase58()],t),i=await this._rpcRequest("getTokenLargestAccounts",r),s=z(i,Cf);if("error"in s)throw new X(s.error,"failed to get token largest accounts");return s.result}async getAccountInfoAndContext(e,t){const{commitment:r,config:i}=Me(t),s=this._buildArgs([e.toBase58()],r,"base64",i),o=await this._rpcRequest("getAccountInfo",s),a=z(o,De(W(Lr)));if("error"in a)throw new X(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getParsedAccountInfo(e,t){const{commitment:r,config:i}=Me(t),s=this._buildArgs([e.toBase58()],r,"jsonParsed",i),o=await this._rpcRequest("getAccountInfo",s),a=z(o,De(W(ts)));if("error"in a)throw new X(a.error,`failed to get info about account ${e.toBase58()}`);return a.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(r){throw new Error("failed to get info about account "+e.toBase58()+": "+r)}}async getMultipleParsedAccounts(e,t){const{commitment:r,config:i}=Me(t),s=e.map(d=>d.toBase58()),o=this._buildArgs([s],r,"jsonParsed",i),a=await this._rpcRequest("getMultipleAccounts",o),c=z(a,De(D(W(ts))));if("error"in c)throw new X(c.error,`failed to get info for accounts ${s}`);return c.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:r,config:i}=Me(t),s=e.map(d=>d.toBase58()),o=this._buildArgs([s],r,"base64",i),a=await this._rpcRequest("getMultipleAccounts",o),c=z(a,De(D(W(Lr))));if("error"in c)throw new X(c.error,`failed to get info for accounts ${s}`);return c.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,r){const{commitment:i,config:s}=Me(t),o=this._buildArgs([e.toBase58()],i,void 0,{...s,epoch:r??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getStakeActivation",o),c=z(a,he(Mf));if("error"in c)throw new X(c.error,`failed to get Stake Activation ${e.toBase58()}`);return c.result}async getProgramAccounts(e,t){const{commitment:r,config:i}=Me(t),{encoding:s,...o}=i||{},a=this._buildArgs([e.toBase58()],r,s||"base64",o),c=await this._rpcRequest("getProgramAccounts",a),d=D(Nf),l=o.withContext===!0?z(c,De(d)):z(c,he(d));if("error"in l)throw new X(l.error,`failed to get accounts owned by program ${e.toBase58()}`);return l.result}async getParsedProgramAccounts(e,t){const{commitment:r,config:i}=Me(t),s=this._buildArgs([e.toBase58()],r,"jsonParsed",i),o=await this._rpcRequest("getProgramAccounts",s),a=z(o,he(D(Kf)));if("error"in a)throw new X(a.error,`failed to get accounts owned by program ${e.toBase58()}`);return a.result}async confirmTransaction(e,t){var s;let r;if(typeof e=="string")r=e;else{const o=e;if((s=o.abortSignal)!=null&&s.aborted)return Promise.reject(o.abortSignal.reason);r=o.signature}let i;try{i=$e.decode(r)}catch{throw new Error("signature must be base58 encoded: "+r)}return Se(i.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:r}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,r)=>{e!=null&&(e.aborted?r(e.reason):e.addEventListener("abort",()=>{r(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let r,i,s=!1;const o=new Promise((c,d)=>{try{r=this.onSignature(t,(g,w)=>{r=void 0;const h={context:w,value:g};c({__type:bn.PROCESSED,response:h})},e);const l=new Promise(g=>{r==null?g():i=this._onSubscriptionStateChange(r,w=>{w==="subscribed"&&g()})});(async()=>{if(await l,s)return;const g=await this.getSignatureStatus(t);if(s||g==null)return;const{context:w,value:h}=g;if(h!=null)if(h!=null&&h.err)d(h.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(h.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(h.confirmationStatus==="processed"||h.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}s=!0,c({__type:bn.PROCESSED,response:{context:w,value:h}})}})()}catch(l){d(l)}});return{abortConfirmation:()=>{i&&(i(),i=void 0),r!=null&&(this.removeSignatureListener(r),r=void 0)},confirmationPromise:o}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:r,signature:i}}){let s=!1;const o=new Promise(g=>{const w=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let h=await w();if(!s){for(;h<=r;)if(await qn(1e3),s||(h=await w(),s))return;g({__type:bn.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:a,confirmationPromise:c}=this.getTransactionConfirmationPromise({commitment:e,signature:i}),d=this.getCancellationPromise(t);let l;try{const g=await Promise.race([d,c,o]);if(g.__type===bn.PROCESSED)l=g.response;else throw new gs(i)}finally{s=!0,a()}return l}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:r,nonceAccountPubkey:i,nonceValue:s,signature:o}}){let a=!1;const c=new Promise(h=>{let b=s,v=null;const p=async()=>{try{const{context:m,value:_}=await this.getNonceAndContext(i,{commitment:e,minContextSlot:r});return v=m.slot,_==null?void 0:_.nonce}catch{return b}};(async()=>{if(b=await p(),!a)for(;;){if(s!==b){h({__type:bn.NONCE_INVALID,slotInWhichNonceDidAdvance:v});return}if(await qn(2e3),a||(b=await p(),a))return}})()}),{abortConfirmation:d,confirmationPromise:l}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),g=this.getCancellationPromise(t);let w;try{const h=await Promise.race([g,l,c]);if(h.__type===bn.PROCESSED)w=h.response;else{let b;for(;;){const v=await this.getSignatureStatus(o);if(v==null)break;if(v.context.slot<(h.slotInWhichNonceDidAdvance??r)){await qn(400);continue}b=v;break}if(b!=null&&b.value){const v=e||"finalized",{confirmationStatus:p}=b.value;switch(v){case"processed":case"recent":if(p!=="processed"&&p!=="confirmed"&&p!=="finalized")throw new ir(o);break;case"confirmed":case"single":case"singleGossip":if(p!=="confirmed"&&p!=="finalized")throw new ir(o);break;case"finalized":case"max":case"root":if(p!=="finalized")throw new ir(o);break;default:(m=>{})(v)}w={context:b.context,value:{err:b.value.err}}}else throw new ir(o)}}finally{a=!0,d()}return w}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let r;const i=new Promise(c=>{let d=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{d=this._confirmTransactionInitialTimeout||3e4;break}}r=setTimeout(()=>c({__type:bn.TIMED_OUT,timeoutMs:d}),d)}),{abortConfirmation:s,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let a;try{const c=await Promise.race([o,i]);if(c.__type===bn.PROCESSED)a=c.response;else throw new ys(t,c.timeoutMs/1e3)}finally{clearTimeout(r),s()}return a}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=z(e,he(D(Jf)));if("error"in t)throw new X(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getVoteAccounts",t),i=z(r,Qf);if("error"in i)throw new X(i.error,"failed to get vote accounts");return i.result}async getSlot(e){const{commitment:t,config:r}=Me(e),i=this._buildArgs([],t,void 0,r),s=await this._rpcRequest("getSlot",i),o=z(s,he(S()));if("error"in o)throw new X(o.error,"failed to get slot");return o.result}async getSlotLeader(e){const{commitment:t,config:r}=Me(e),i=this._buildArgs([],t,void 0,r),s=await this._rpcRequest("getSlotLeader",i),o=z(s,he(L()));if("error"in o)throw new X(o.error,"failed to get slot leader");return o.result}async getSlotLeaders(e,t){const r=[e,t],i=await this._rpcRequest("getSlotLeaders",r),s=z(i,he(D(He)));if("error"in s)throw new X(s.error,"failed to get slot leaders");return s.result}async getSignatureStatus(e,t){const{context:r,value:i}=await this.getSignatureStatuses([e],t);Se(i.length===1);const s=i[0];return{context:r,value:s}}async getSignatureStatuses(e,t){const r=[e];t&&r.push(t);const i=await this._rpcRequest("getSignatureStatuses",r),s=z(i,eh);if("error"in s)throw new X(s.error,"failed to get signature status");return s.result}async getTransactionCount(e){const{commitment:t,config:r}=Me(e),i=this._buildArgs([],t,void 0,r),s=await this._rpcRequest("getTransactionCount",i),o=z(s,he(S()));if("error"in o)throw new X(o.error,"failed to get transaction count");return o.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getInflationGovernor",t),i=z(r,_f);if("error"in i)throw new X(i.error,"failed to get inflation");return i.result}async getInflationReward(e,t,r){const{commitment:i,config:s}=Me(r),o=this._buildArgs([e.map(d=>d.toBase58())],i,void 0,{...s,epoch:t??(s==null?void 0:s.epoch)}),a=await this._rpcRequest("getInflationReward",o),c=z(a,lf);if("error"in c)throw new X(c.error,"failed to get inflation reward");return c.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=z(e,Af);if("error"in t)throw new X(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:r}=Me(e),i=this._buildArgs([],t,void 0,r),s=await this._rpcRequest("getEpochInfo",i),o=z(s,Rf);if("error"in o)throw new X(o.error,"failed to get epoch info");return o.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=z(e,Pf);if("error"in t)throw new X(t.error,"failed to get epoch schedule");const r=t.result;return new ga(r.slotsPerEpoch,r.leaderScheduleSlotOffset,r.warmup,r.firstNormalEpoch,r.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=z(e,Tf);if("error"in t)throw new X(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const r=this._buildArgs([e],t),i=await this._rpcRequest("getMinimumBalanceForRentExemption",r),s=z(i,th);return"error"in s?(console.warn("Unable to fetch minimum balance for rent exemption"),0):s.result}async getRecentBlockhashAndContext(e){const t=this._buildArgs([],e),r=await this._rpcRequest("getRecentBlockhash",t),i=z(r,dh);if("error"in i)throw new X(i.error,"failed to get recent blockhash");return i.result}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),r=z(t,yh);if("error"in r)throw new X(r.error,"failed to get recent performance samples");return r.result}async getFeeCalculatorForBlockhash(e,t){const r=this._buildArgs([e],t),i=await this._rpcRequest("getFeeCalculatorForBlockhash",r),s=z(i,bh);if("error"in s)throw new X(s.error,"failed to get fee calculator");const{context:o,value:a}=s.result;return{context:o,value:a!==null?a.feeCalculator:null}}async getFeeForMessage(e,t){const r=ge(e.serialize()).toString("base64"),i=this._buildArgs([r],t),s=await this._rpcRequest("getFeeForMessage",i),o=z(s,De(W(S())));if("error"in o)throw new X(o.error,"failed to get fee for message");if(o.result===null)throw new Error("invalid blockhash");return o.result}async getRecentPrioritizationFees(e){var o;const t=(o=e==null?void 0:e.lockedWritableAccounts)==null?void 0:o.map(a=>a.toBase58()),r=t!=null&&t.length?[t]:[],i=await this._rpcRequest("getRecentPrioritizationFees",r),s=z(i,If);if("error"in s)throw new X(s.error,"failed to get recent prioritization fees");return s.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:r}=Me(e),i=this._buildArgs([],t,void 0,r),s=await this._rpcRequest("getLatestBlockhash",i),o=z(s,fh);if("error"in o)throw new X(o.error,"failed to get latest blockhash");return o.result}async isBlockhashValid(e,t){const{commitment:r,config:i}=Me(t),s=this._buildArgs([e],r,void 0,i),o=await this._rpcRequest("isBlockhashValid",s),a=z(o,hh);if("error"in a)throw new X(a.error,"failed to determine if the blockhash `"+e+"`is valid");return a.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=z(e,he(pf));if("error"in t)throw new X(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=z(e,he(L()));if("error"in t)throw new X(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:r,config:i}=Me(t),s=this._buildArgsAtLeastConfirmed([e],r,void 0,i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=z(o,oh);if("error"in a)throw a.error;return a.result}case"none":{const a=z(o,sh);if("error"in a)throw a.error;return a.result}default:{const a=z(o,ih);if("error"in a)throw a.error;const{result:c}=a;return c?{...c,transactions:c.transactions.map(({transaction:d,meta:l,version:g})=>({meta:l,transaction:{...d,message:Ui(g,d.message)},version:g}))}:null}}}catch(a){throw new X(a,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:r,config:i}=Me(t),s=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",i),o=await this._rpcRequest("getBlock",s);try{switch(i==null?void 0:i.transactionDetails){case"accounts":{const a=z(o,uh);if("error"in a)throw a.error;return a.result}case"none":{const a=z(o,ch);if("error"in a)throw a.error;return a.result}default:{const a=z(o,ah);if("error"in a)throw a.error;return a.result}}}catch(a){throw new X(a,"failed to get block")}}async getBlockProduction(e){let t,r;if(typeof e=="string")r=e;else if(e){const{commitment:a,...c}=e;r=a,t=c}const i=this._buildArgs([],r,"base64",t),s=await this._rpcRequest("getBlockProduction",i),o=z(s,vf);if("error"in o)throw new X(o.error,"failed to get block production information");return o.result}async getTransaction(e,t){const{commitment:r,config:i}=Me(t),s=this._buildArgsAtLeastConfirmed([e],r,void 0,i),o=await this._rpcRequest("getTransaction",s),a=z(o,qi);if("error"in a)throw new X(a.error,"failed to get transaction");const c=a.result;return c&&{...c,transaction:{...c.transaction,message:Ui(c.version,c.transaction.message)}}}async getParsedTransaction(e,t){const{commitment:r,config:i}=Me(t),s=this._buildArgsAtLeastConfirmed([e],r,"jsonParsed",i),o=await this._rpcRequest("getTransaction",s),a=z(o,si);if("error"in a)throw new X(a.error,"failed to get transaction");return a.result}async getParsedTransactions(e,t){const{commitment:r,config:i}=Me(t),s=e.map(c=>{const d=this._buildArgsAtLeastConfirmed([c],r,"jsonParsed",i);return{methodName:"getTransaction",args:d}});return(await this._rpcBatchRequest(s)).map(c=>{const d=z(c,si);if("error"in d)throw new X(d.error,"failed to get transactions");return d.result})}async getTransactions(e,t){const{commitment:r,config:i}=Me(t),s=e.map(c=>{const d=this._buildArgsAtLeastConfirmed([c],r,void 0,i);return{methodName:"getTransaction",args:d}});return(await this._rpcBatchRequest(s)).map(c=>{const d=z(c,qi);if("error"in d)throw new X(d.error,"failed to get transactions");const l=d.result;return l&&{...l,transaction:{...l.transaction,message:Ui(l.version,l.transaction.message)}}})}async getConfirmedBlock(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getConfirmedBlock",r),s=z(i,lh);if("error"in s)throw new X(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");const a={...o,transactions:o.transactions.map(({transaction:c,meta:d})=>{const l=new $t(c.message);return{meta:d,transaction:{...c,message:l}}})};return{...a,transactions:a.transactions.map(({transaction:c,meta:d})=>({meta:d,transaction:Ie.populate(c.message,c.signatures)}))}}async getBlocks(e,t,r){const i=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],r),s=await this._rpcRequest("getBlocks",i),o=z(s,he(D(S())));if("error"in o)throw new X(o.error,"failed to get blocks");return o.result}async getBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getBlock",r),s=z(i,lo);if("error"in s)throw new X(s.error,"failed to get block");const o=s.result;if(!o)throw new Error("Block "+e+" not found");return o}async getConfirmedBlockSignatures(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),i=await this._rpcRequest("getConfirmedBlock",r),s=z(i,lo);if("error"in s)throw new X(s.error,"failed to get confirmed block");const o=s.result;if(!o)throw new Error("Confirmed block "+e+" not found");return o}async getConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t),i=await this._rpcRequest("getConfirmedTransaction",r),s=z(i,qi);if("error"in s)throw new X(s.error,"failed to get transaction");const o=s.result;if(!o)return o;const a=new $t(o.transaction.message),c=o.transaction.signatures;return{...o,transaction:Ie.populate(a,c)}}async getParsedConfirmedTransaction(e,t){const r=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),i=await this._rpcRequest("getConfirmedTransaction",r),s=z(i,si);if("error"in s)throw new X(s.error,"failed to get confirmed transaction");return s.result}async getParsedConfirmedTransactions(e,t){const r=e.map(o=>{const a=this._buildArgsAtLeastConfirmed([o],t,"jsonParsed");return{methodName:"getConfirmedTransaction",args:a}});return(await this._rpcBatchRequest(r)).map(o=>{const a=z(o,si);if("error"in a)throw new X(a.error,"failed to get confirmed transactions");return a.result})}async getConfirmedSignaturesForAddress(e,t,r){let i={},s=await this.getFirstAvailableBlock();for(;!("until"in i)&&(t--,!(t<=0||t<s));)try{const c=await this.getConfirmedBlockSignatures(t,"finalized");c.signatures.length>0&&(i.until=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}let o=await this.getSlot("finalized");for(;!("before"in i)&&(r++,!(r>o));)try{const c=await this.getConfirmedBlockSignatures(r);c.signatures.length>0&&(i.before=c.signatures[c.signatures.length-1].toString())}catch(c){if(c instanceof Error&&c.message.includes("skipped"))continue;throw c}return(await this.getConfirmedSignaturesForAddress2(e,i)).map(c=>c.signature)}async getConfirmedSignaturesForAddress2(e,t,r){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),s=await this._rpcRequest("getConfirmedSignaturesForAddress2",i),o=z(s,Uf);if("error"in o)throw new X(o.error,"failed to get confirmed signatures for address");return o.result}async getSignaturesForAddress(e,t,r){const i=this._buildArgsAtLeastConfirmed([e.toBase58()],r,void 0,t),s=await this._rpcRequest("getSignaturesForAddress",i),o=z(s,qf);if("error"in o)throw new X(o.error,"failed to get signatures for address");return o.result}async getAddressLookupTable(e,t){const{context:r,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=new Xi({key:e,state:Xi.deserialize(i.data)})),{context:r,value:s}}async getNonceAndContext(e,t){const{context:r,value:i}=await this.getAccountInfoAndContext(e,t);let s=null;return i!==null&&(s=_i.fromAccountData(i.data)),{context:r,value:s}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(r=>r.value).catch(r=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+r)})}async requestAirdrop(e,t){const r=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),i=z(r,mh);if("error"in i)throw new X(i.error,`airdrop to ${e.toBase58()} failed`);return i.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await qn(100);const r=Date.now()-this._blockhashInfo.lastFetch>=ba;if(this._blockhashInfo.latestBlockhash!==null&&!r)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,r=t?t.blockhash:null;for(let i=0;i<50;i++){const s=await this.getLatestBlockhash("finalized");if(r!==s.blockhash)return this._blockhashInfo={latestBlockhash:s,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},s;await qn(da/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:r}=Me(e),i=this._buildArgs([],t,"base64",r),s=await this._rpcRequest("getStakeMinimumDelegation",i),o=z(s,De(S()));if("error"in o)throw new X(o.error,"failed to get stake minimum delegation");return o.result}async simulateTransaction(e,t,r){if("message"in e){const v=e.serialize(),p=se.Buffer.from(v).toString("base64");if(Array.isArray(t)||r!==void 0)throw new Error("Invalid arguments");const m=t||{};m.encoding="base64","commitment"in m||(m.commitment=this.commitment);const _=[p,m],A=await this._rpcRequest("simulateTransaction",_),T=z(A,uo);if("error"in T)throw new Error("failed to simulate transaction: "+T.error.message);return T.result}let i;if(e instanceof Ie){let b=e;i=new Ie,i.feePayer=b.feePayer,i.instructions=e.instructions,i.nonceInfo=b.nonceInfo,i.signatures=b.signatures}else i=Ie.populate(e),i._message=i._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");const s=t;if(i.nonceInfo&&s)i.sign(...s);else{let b=this._disableBlockhashCaching;for(;;){const v=await this._blockhashWithExpiryBlockHeight(b);if(i.lastValidBlockHeight=v.lastValidBlockHeight,i.recentBlockhash=v.blockhash,!s)break;if(i.sign(...s),!i.signature)throw new Error("!signature");const p=i.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(p)&&!this._blockhashInfo.transactionSignatures.includes(p)){this._blockhashInfo.simulatedSignatures.push(p);break}else b=!0}}const o=i._compile(),a=o.serialize(),d=i._serialize(a).toString("base64"),l={encoding:"base64",commitment:this.commitment};if(r){const b=(Array.isArray(r)?r:o.nonProgramIds()).map(v=>v.toBase58());l.accounts={encoding:"base64",addresses:b}}s&&(l.sigVerify=!0);const g=[d,l],w=await this._rpcRequest("simulateTransaction",g),h=z(w,uo);if("error"in h){let b;if("data"in h.error&&(b=h.error.data.logs,b&&Array.isArray(b))){const v=`
    `,p=v+b.join(v);console.error(h.error.message,p)}throw new Qi("failed to simulate transaction: "+h.error.message,b)}return h.result}async sendTransaction(e,t,r){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const o=e.serialize();return await this.sendRawTransaction(o,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");const i=t;if(e.nonceInfo)e.sign(...i);else{let o=this._disableBlockhashCaching;for(;;){const a=await this._blockhashWithExpiryBlockHeight(o);if(e.lastValidBlockHeight=a.lastValidBlockHeight,e.recentBlockhash=a.blockhash,e.sign(...i),!e.signature)throw new Error("!signature");const c=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(c))o=!0;else{this._blockhashInfo.transactionSignatures.push(c);break}}}const s=e.serialize();return await this.sendRawTransaction(s,r)}async sendRawTransaction(e,t){const r=ge(e).toString("base64");return await this.sendEncodedTransaction(r,t)}async sendEncodedTransaction(e,t){const r={encoding:"base64"},i=t&&t.skipPreflight,s=t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(r.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(r.minContextSlot=t.minContextSlot),i&&(r.skipPreflight=i),s&&(r.preflightCommitment=s);const o=[e,r],a=await this._rpcRequest("sendTransaction",o),c=z(a,ph);if("error"in c){let d;throw"data"in c.error&&(d=c.error.data.logs),new Qi("failed to send transaction: "+c.error.message,d)}return c.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,r])=>{this._setSubscription(t,{...r,state:"pending"})})}_setSubscription(e,t){var i;const r=(i=this._subscriptionsByHash[e])==null?void 0:i.state;if(this._subscriptionsByHash[e]=t,r!==t.state){const s=this._subscriptionStateChangeCallbacksByHash[e];s&&s.forEach(o=>{try{o(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){const r=this._subscriptionHashByClientSubscriptionId[e];if(r==null)return()=>{};const i=this._subscriptionStateChangeCallbacksByHash[r]||=new Set;return i.add(t),()=>{i.delete(t),i.size===0&&delete this._subscriptionStateChangeCallbacksByHash[r]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(r){r instanceof Error&&console.log(`Error when closing socket connection: ${r.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async r=>{const i=this._subscriptionsByHash[r];if(i!==void 0)switch(i.state){case"pending":case"unsubscribed":if(i.callbacks.size===0){delete this._subscriptionsByHash[r],i.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[i.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:s,method:o}=i;try{this._setSubscription(r,{...i,state:"subscribing"});const a=await this._rpcWebSocket.call(o,s);this._setSubscription(r,{...i,serverSubscriptionId:a,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[a]=i.callbacks,await this._updateSubscriptions()}catch(a){if(a instanceof Error&&console.error(`${o} error for argument`,s,a.message),!t())return;this._setSubscription(r,{...i,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":i.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:s,unsubscribeMethod:o}=i;if(this._subscriptionsAutoDisposedByRpc.has(s))this._subscriptionsAutoDisposedByRpc.delete(s);else{this._setSubscription(r,{...i,state:"unsubscribing"}),this._setSubscription(r,{...i,state:"unsubscribing"});try{await this._rpcWebSocket.call(o,[s])}catch(a){if(a instanceof Error&&console.error(`${o} error:`,a.message),!t())return;this._setSubscription(r,{...i,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(r,{...i,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){const r=this._subscriptionCallbacksByServerSubscriptionId[e];r!==void 0&&r.forEach(i=>{try{i(...t)}catch(s){console.error(s)}})}_wsOnAccountNotification(e){const{result:t,subscription:r}=z(e,Wf);this._handleServerNotification(r,[t.value,t.context])}_makeSubscription(e,t){const r=this._nextClientSubscriptionId++,i=oo([e.method,t],!0),s=this._subscriptionsByHash[i];return s===void 0?this._subscriptionsByHash[i]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:s.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[r]=i,this._subscriptionDisposeFunctionsByClientSubscriptionId[r]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[r],delete this._subscriptionHashByClientSubscriptionId[r];const o=this._subscriptionsByHash[i];Se(o!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${r}`),o.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),r}onAccountChange(e,t,r){const i=this._buildArgs([e.toBase58()],r||this._commitment||"finalized","base64");return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},i)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:r}=z(e,Df);this._handleServerNotification(r,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,r,i){const s=this._buildArgs([e.toBase58()],r||this._commitment||"finalized","base64",i?{filters:i}:void 0);return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},s)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,r){const i=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],r||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},i)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:r}=z(e,wh);this._handleServerNotification(r,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:r}=z(e,$f);this._handleServerNotification(r,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:r}=z(e,Gf);this._handleServerNotification(r,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const r=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];r?await r():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,r,i){const s=t||this._commitment;if(s||r||i){let o={};r&&(o.encoding=r),s&&(o.commitment=s),i&&(o=Object.assign(o,i)),e.push(o)}return e}_buildArgsAtLeastConfirmed(e,t,r,i){const s=t||this._commitment;if(s&&!["confirmed","finalized"].includes(s))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,r,i)}_wsOnSignatureNotification(e){const{result:t,subscription:r}=z(e,jf);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(r),this._handleServerNotification(r,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,r){const i=this._buildArgs([e],r||this._commitment||"finalized"),s=this._makeSubscription({callback:(o,a)=>{if(o.type==="status"){t(o.result,a);try{this.removeSignatureListener(s)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},i);return s}onSignatureWithOptions(e,t,r){const{commitment:i,...s}={...r,commitment:r&&r.commitment||this._commitment||"finalized"},o=this._buildArgs([e],i,void 0,s),a=this._makeSubscription({callback:(c,d)=>{t(c,d);try{this.removeSignatureListener(a)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return a}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:r}=z(e,Yf);this._handleServerNotification(r,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class ar{constructor(e){this._keypair=void 0,this._keypair=e??ro()}static generate(){return new ar(ro())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const r=e.slice(32,64);if(!t||!t.skipValidation){const i=e.slice(0,32),s=li(i);for(let o=0;o<32;o++)if(r[o]!==s[o])throw new Error("provided secretKey is invalid")}return new ar({publicKey:r,secretKey:e})}static fromSeed(e){const t=li(e),r=new Uint8Array(64);return r.set(e),r.set(t,32),new ar({publicKey:t,secretKey:r})}get publicKey(){return new N(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}const mn=Object.freeze({CreateLookupTable:{index:0,layout:J([Q("instruction"),hr("recentSlot"),ke("bumpSeed")])},FreezeLookupTable:{index:1,layout:J([Q("instruction")])},ExtendLookupTable:{index:2,layout:J([Q("instruction"),hr(),ft(be(),Fn(Q(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:J([Q("instruction")])},CloseLookupTable:{index:4,layout:J([Q("instruction")])}});class _h{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const r=Q("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(mn))if(o.index==r){i=s;break}if(!i)throw new Error("Invalid Instruction. Should be a LookupTable Instruction");return i}static decodeCreateLookupTable(e){this.checkProgramId(e.programId),this.checkKeysLength(e.keys,4);const{recentSlot:t}=Ae(mn.CreateLookupTable,e.data);return{authority:e.keys[1].pubkey,payer:e.keys[2].pubkey,recentSlot:Number(t)}}static decodeExtendLookupTable(e){if(this.checkProgramId(e.programId),e.keys.length<2)throw new Error(`invalid instruction; found ${e.keys.length} keys, expected at least 2`);const{addresses:t}=Ae(mn.ExtendLookupTable,e.data);return{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,payer:e.keys.length>2?e.keys[2].pubkey:void 0,addresses:t.map(r=>new N(r))}}static decodeCloseLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,3),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,recipient:e.keys[2].pubkey}}static decodeFreezeLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static decodeDeactivateLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(ks.programId))throw new Error("invalid instruction; programId is not AddressLookupTable Program")}static checkKeysLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}class ks{constructor(){}static createLookupTable(e){const[t,r]=N.findProgramAddressSync([e.authority.toBuffer(),Ro(BigInt(e.recentSlot),8)],this.programId),i=mn.CreateLookupTable,s=we(i,{recentSlot:BigInt(e.recentSlot),bumpSeed:r}),o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:ot.programId,isSigner:!1,isWritable:!1}];return[new Ee({programId:this.programId,keys:o,data:s}),t]}static freezeLookupTable(e){const t=mn.FreezeLookupTable,r=we(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new Ee({programId:this.programId,keys:i,data:r})}static extendLookupTable(e){const t=mn.ExtendLookupTable,r=we(t,{addresses:e.addresses.map(s=>s.toBytes())}),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return e.payer&&i.push({pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:ot.programId,isSigner:!1,isWritable:!1}),new Ee({programId:this.programId,keys:i,data:r})}static deactivateLookupTable(e){const t=mn.DeactivateLookupTable,r=we(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new Ee({programId:this.programId,keys:i,data:r})}static closeLookupTable(e){const t=mn.CloseLookupTable,r=we(t),i=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.recipient,isSigner:!1,isWritable:!0}];return new Ee({programId:this.programId,keys:i,data:r})}}ks.programId=new N("AddressLookupTab1e1111111111111111111111111");class Ah{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const r=ke("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(Xt))if(o.index==r){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a ComputeBudgetInstruction");return i}static decodeRequestUnits(e){this.checkProgramId(e.programId);const{units:t,additionalFee:r}=Ae(Xt.RequestUnits,e.data);return{units:t,additionalFee:r}}static decodeRequestHeapFrame(e){this.checkProgramId(e.programId);const{bytes:t}=Ae(Xt.RequestHeapFrame,e.data);return{bytes:t}}static decodeSetComputeUnitLimit(e){this.checkProgramId(e.programId);const{units:t}=Ae(Xt.SetComputeUnitLimit,e.data);return{units:t}}static decodeSetComputeUnitPrice(e){this.checkProgramId(e.programId);const{microLamports:t}=Ae(Xt.SetComputeUnitPrice,e.data);return{microLamports:t}}static checkProgramId(e){if(!e.equals(_s.programId))throw new Error("invalid instruction; programId is not ComputeBudgetProgram")}}const Xt=Object.freeze({RequestUnits:{index:0,layout:J([ke("instruction"),Q("units"),Q("additionalFee")])},RequestHeapFrame:{index:1,layout:J([ke("instruction"),Q("bytes")])},SetComputeUnitLimit:{index:2,layout:J([ke("instruction"),Q("units")])},SetComputeUnitPrice:{index:3,layout:J([ke("instruction"),hr("microLamports")])}});class _s{constructor(){}static requestUnits(e){const t=Xt.RequestUnits,r=we(t,e);return new Ee({keys:[],programId:this.programId,data:r})}static requestHeapFrame(e){const t=Xt.RequestHeapFrame,r=we(t,e);return new Ee({keys:[],programId:this.programId,data:r})}static setComputeUnitLimit(e){const t=Xt.SetComputeUnitLimit,r=we(t,e);return new Ee({keys:[],programId:this.programId,data:r})}static setComputeUnitPrice(e){const t=Xt.SetComputeUnitPrice,r=we(t,{microLamports:BigInt(e.microLamports)});return new Ee({keys:[],programId:this.programId,data:r})}}_s.programId=new N("ComputeBudget111111111111111111111111111111");const fo=64,ho=32,go=64,yo=J([ke("numSignatures"),ke("padding"),Dt("signatureOffset"),Dt("signatureInstructionIndex"),Dt("publicKeyOffset"),Dt("publicKeyInstructionIndex"),Dt("messageDataOffset"),Dt("messageDataSize"),Dt("messageInstructionIndex")]);class Ri{constructor(){}static createInstructionWithPublicKey(e){const{publicKey:t,message:r,signature:i,instructionIndex:s}=e;Se(t.length===ho,`Public Key must be ${ho} bytes but received ${t.length} bytes`),Se(i.length===go,`Signature must be ${go} bytes but received ${i.length} bytes`);const o=yo.span,a=o+t.length,c=a+i.length,d=1,l=se.Buffer.alloc(c+r.length),g=s??65535;return yo.encode({numSignatures:d,padding:0,signatureOffset:a,signatureInstructionIndex:g,publicKeyOffset:o,publicKeyInstructionIndex:g,messageDataOffset:c,messageDataSize:r.length,messageInstructionIndex:g},l),l.fill(t,o),l.fill(i,a),l.fill(r,c),new Ee({keys:[],programId:Ri.programId,data:l})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:r,instructionIndex:i}=e;Se(t.length===fo,`Private key must be ${fo} bytes but received ${t.length} bytes`);try{const s=ar.fromSecretKey(t),o=s.publicKey.toBytes(),a=fs(r,s.secretKey);return this.createInstructionWithPublicKey({publicKey:o,message:r,signature:a,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}Ri.programId=new N("Ed25519SigVerify111111111111111111111111111");const Ih=(n,e)=>{const t=as.sign(n,e);return[t.toCompactRawBytes(),t.recovery]};as.utils.isValidPrivateKey;const Rh=as.getPublicKey,bo=32,Wi=20,mo=64,Ph=11,Fi=J([ke("numSignatures"),Dt("signatureOffset"),ke("signatureInstructionIndex"),Dt("ethAddressOffset"),ke("ethAddressInstructionIndex"),Dt("messageDataOffset"),Dt("messageDataSize"),ke("messageInstructionIndex"),Ue(20,"ethAddress"),Ue(64,"signature"),ke("recoveryId")]);class ur{constructor(){}static publicKeyToEthAddress(e){Se(e.length===mo,`Public key must be ${mo} bytes but received ${e.length} bytes`);try{return se.Buffer.from(Vs(ge(e))).slice(-Wi)}catch(t){throw new Error(`Error constructing Ethereum address: ${t}`)}}static createInstructionWithPublicKey(e){const{publicKey:t,message:r,signature:i,recoveryId:s,instructionIndex:o}=e;return ur.createInstructionWithEthAddress({ethAddress:ur.publicKeyToEthAddress(t),message:r,signature:i,recoveryId:s,instructionIndex:o})}static createInstructionWithEthAddress(e){const{ethAddress:t,message:r,signature:i,recoveryId:s,instructionIndex:o=0}=e;let a;typeof t=="string"?t.startsWith("0x")?a=se.Buffer.from(t.substr(2),"hex"):a=se.Buffer.from(t,"hex"):a=t,Se(a.length===Wi,`Address must be ${Wi} bytes but received ${a.length} bytes`);const c=1+Ph,d=c,l=c+a.length,g=l+i.length+1,w=1,h=se.Buffer.alloc(Fi.span+r.length);return Fi.encode({numSignatures:w,signatureOffset:l,signatureInstructionIndex:o,ethAddressOffset:d,ethAddressInstructionIndex:o,messageDataOffset:g,messageDataSize:r.length,messageInstructionIndex:o,signature:ge(i),ethAddress:ge(a),recoveryId:s},h),h.fill(ge(r),Fi.span),new Ee({keys:[],programId:ur.programId,data:h})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:r,instructionIndex:i}=e;Se(t.length===bo,`Private key must be ${bo} bytes but received ${t.length} bytes`);try{const s=ge(t),o=Rh(s,!1).slice(1),a=se.Buffer.from(Vs(ge(r))),[c,d]=Ih(a,s);return this.createInstructionWithPublicKey({publicKey:o,message:r,signature:c,recoveryId:d,instructionIndex:i})}catch(s){throw new Error(`Error creating instruction; ${s}`)}}}ur.programId=new N("KeccakSecp256k11111111111111111111111111111");var Ra;const Pa=new N("StakeConfig11111111111111111111111111111111");class Ta{constructor(e,t){this.staker=void 0,this.withdrawer=void 0,this.staker=e,this.withdrawer=t}}class Ur{constructor(e,t,r){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=r}}Ra=Ur;Ur.default=new Ra(0,0,N.default);class Th{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const r=Q("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(tt))if(o.index==r){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a StakeInstruction");return i}static decodeInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t,lockup:r}=Ae(tt.Initialize,e.data);return{stakePubkey:e.keys[0].pubkey,authorized:new Ta(new N(t.staker),new N(t.withdrawer)),lockup:new Ur(r.unixTimestamp,r.epoch,new N(r.custodian))}}static decodeDelegate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,6),Ae(tt.Delegate,e.data),{stakePubkey:e.keys[0].pubkey,votePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[5].pubkey}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,stakeAuthorizationType:r}=Ae(tt.Authorize,e.data),i={stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new N(t),stakeAuthorizationType:{index:r}};return e.keys.length>3&&(i.custodianPubkey=e.keys[3].pubkey),i}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{newAuthorized:t,stakeAuthorizationType:r,authoritySeed:i,authorityOwner:s}=Ae(tt.AuthorizeWithSeed,e.data),o={stakePubkey:e.keys[0].pubkey,authorityBase:e.keys[1].pubkey,authoritySeed:i,authorityOwner:new N(s),newAuthorizedPubkey:new N(t),stakeAuthorizationType:{index:r}};return e.keys.length>3&&(o.custodianPubkey=e.keys[3].pubkey),o}static decodeSplit(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Ae(tt.Split,e.data);return{stakePubkey:e.keys[0].pubkey,splitStakePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[2].pubkey,lamports:t}}static decodeMerge(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Ae(tt.Merge,e.data),{stakePubkey:e.keys[0].pubkey,sourceStakePubKey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=Ae(tt.Withdraw,e.data),r={stakePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t};return e.keys.length>5&&(r.custodianPubkey=e.keys[5].pubkey),r}static decodeDeactivate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Ae(tt.Deactivate,e.data),{stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static checkProgramId(e){if(!e.equals(Pi.programId))throw new Error("invalid instruction; programId is not StakeProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const tt=Object.freeze({Initialize:{index:0,layout:J([Q("instruction"),Ed(),Bd()])},Authorize:{index:1,layout:J([Q("instruction"),be("newAuthorized"),Q("stakeAuthorizationType")])},Delegate:{index:2,layout:J([Q("instruction")])},Split:{index:3,layout:J([Q("instruction"),Mt("lamports")])},Withdraw:{index:4,layout:J([Q("instruction"),Mt("lamports")])},Deactivate:{index:5,layout:J([Q("instruction")])},Merge:{index:7,layout:J([Q("instruction")])},AuthorizeWithSeed:{index:8,layout:J([Q("instruction"),be("newAuthorized"),Q("stakeAuthorizationType"),Wn("authoritySeed"),be("authorityOwner")])}}),Eh=Object.freeze({Staker:{index:0},Withdrawer:{index:1}});class Pi{constructor(){}static initialize(e){const{stakePubkey:t,authorized:r,lockup:i}=e,s=i||Ur.default,o=tt.Initialize,a=we(o,{authorized:{staker:ge(r.staker.toBuffer()),withdrawer:ge(r.withdrawer.toBuffer())},lockup:{unixTimestamp:s.unixTimestamp,epoch:s.epoch,custodian:ge(s.custodian.toBuffer())}}),c={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:fr,isSigner:!1,isWritable:!1}],programId:this.programId,data:a};return new Ee(c)}static createAccountWithSeed(e){const t=new Ie;t.add(ot.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:r,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:r,authorized:i,lockup:s}))}static createAccount(e){const t=new Ie;t.add(ot.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:r,authorized:i,lockup:s}=e;return t.add(this.initialize({stakePubkey:r,authorized:i,lockup:s}))}static delegate(e){const{stakePubkey:t,authorizedPubkey:r,votePubkey:i}=e,s=tt.Delegate,o=we(s);return new Ie().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:Qt,isSigner:!1,isWritable:!1},{pubkey:ai,isSigner:!1,isWritable:!1},{pubkey:Pa,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static authorize(e){const{stakePubkey:t,authorizedPubkey:r,newAuthorizedPubkey:i,stakeAuthorizationType:s,custodianPubkey:o}=e,a=tt.Authorize,c=we(a,{newAuthorized:ge(i.toBuffer()),stakeAuthorizationType:s.index}),d=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Qt,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return o&&d.push({pubkey:o,isSigner:!1,isWritable:!1}),new Ie().add({keys:d,programId:this.programId,data:c})}static authorizeWithSeed(e){const{stakePubkey:t,authorityBase:r,authoritySeed:i,authorityOwner:s,newAuthorizedPubkey:o,stakeAuthorizationType:a,custodianPubkey:c}=e,d=tt.AuthorizeWithSeed,l=we(d,{newAuthorized:ge(o.toBuffer()),stakeAuthorizationType:a.index,authoritySeed:i,authorityOwner:ge(s.toBuffer())}),g=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1},{pubkey:Qt,isSigner:!1,isWritable:!1}];return c&&g.push({pubkey:c,isSigner:!1,isWritable:!1}),new Ie().add({keys:g,programId:this.programId,data:l})}static splitInstruction(e){const{stakePubkey:t,authorizedPubkey:r,splitStakePubkey:i,lamports:s}=e,o=tt.Split,a=we(o,{lamports:s});return new Ee({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:a})}static split(e){const t=new Ie;return t.add(ot.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:0,space:this.space,programId:this.programId})),t.add(this.splitInstruction(e))}static splitWithSeed(e){const{stakePubkey:t,authorizedPubkey:r,splitStakePubkey:i,basePubkey:s,seed:o,lamports:a}=e,c=new Ie;return c.add(ot.allocate({accountPubkey:i,basePubkey:s,seed:o,space:this.space,programId:this.programId})),c.add(this.splitInstruction({stakePubkey:t,authorizedPubkey:r,splitStakePubkey:i,lamports:a}))}static merge(e){const{stakePubkey:t,sourceStakePubKey:r,authorizedPubkey:i}=e,s=tt.Merge,o=we(s);return new Ie().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:Qt,isSigner:!1,isWritable:!1},{pubkey:ai,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static withdraw(e){const{stakePubkey:t,authorizedPubkey:r,toPubkey:i,lamports:s,custodianPubkey:o}=e,a=tt.Withdraw,c=we(a,{lamports:s}),d=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:Qt,isSigner:!1,isWritable:!1},{pubkey:ai,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return o&&d.push({pubkey:o,isSigner:!1,isWritable:!1}),new Ie().add({keys:d,programId:this.programId,data:c})}static deactivate(e){const{stakePubkey:t,authorizedPubkey:r}=e,i=tt.Deactivate,s=we(i);return new Ie().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Qt,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:s})}}Pi.programId=new N("Stake11111111111111111111111111111111111111");Pi.space=200;class Ea{constructor(e,t,r,i){this.nodePubkey=void 0,this.authorizedVoter=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.nodePubkey=e,this.authorizedVoter=t,this.authorizedWithdrawer=r,this.commission=i}}class Bh{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const r=Q("instruction").decode(e.data);let i;for(const[s,o]of Object.entries(pn))if(o.index==r){i=s;break}if(!i)throw new Error("Instruction type incorrect; not a VoteInstruction");return i}static decodeInitializeAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,4);const{voteInit:t}=Ae(pn.InitializeAccount,e.data);return{votePubkey:e.keys[0].pubkey,nodePubkey:e.keys[3].pubkey,voteInit:new Ea(new N(t.nodePubkey),new N(t.authorizedVoter),new N(t.authorizedWithdrawer),t.commission)}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,voteAuthorizationType:r}=Ae(pn.Authorize,e.data);return{votePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new N(t),voteAuthorizationType:{index:r}}}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:t,currentAuthorityDerivedKeySeed:r,newAuthorized:i,voteAuthorizationType:s}}=Ae(pn.AuthorizeWithSeed,e.data);return{currentAuthorityDerivedKeyBasePubkey:e.keys[2].pubkey,currentAuthorityDerivedKeyOwnerPubkey:new N(t),currentAuthorityDerivedKeySeed:r,newAuthorizedPubkey:new N(i),voteAuthorizationType:{index:s},votePubkey:e.keys[0].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=Ae(pn.Withdraw,e.data);return{votePubkey:e.keys[0].pubkey,authorizedWithdrawerPubkey:e.keys[2].pubkey,lamports:t,toPubkey:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(mr.programId))throw new Error("invalid instruction; programId is not VoteProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const pn=Object.freeze({InitializeAccount:{index:0,layout:J([Q("instruction"),Cd()])},Authorize:{index:1,layout:J([Q("instruction"),be("newAuthorized"),Q("voteAuthorizationType")])},Withdraw:{index:3,layout:J([Q("instruction"),Mt("lamports")])},AuthorizeWithSeed:{index:10,layout:J([Q("instruction"),Od()])}}),Ch=Object.freeze({Voter:{index:0},Withdrawer:{index:1}});class mr{constructor(){}static initializeAccount(e){const{votePubkey:t,nodePubkey:r,voteInit:i}=e,s=pn.InitializeAccount,o=we(s,{voteInit:{nodePubkey:ge(i.nodePubkey.toBuffer()),authorizedVoter:ge(i.authorizedVoter.toBuffer()),authorizedWithdrawer:ge(i.authorizedWithdrawer.toBuffer()),commission:i.commission}}),a={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:fr,isSigner:!1,isWritable:!1},{pubkey:Qt,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:o};return new Ee(a)}static createAccount(e){const t=new Ie;return t.add(ot.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}static authorize(e){const{votePubkey:t,authorizedPubkey:r,newAuthorizedPubkey:i,voteAuthorizationType:s}=e,o=pn.Authorize,a=we(o,{newAuthorized:ge(i.toBuffer()),voteAuthorizationType:s.index}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Qt,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return new Ie().add({keys:c,programId:this.programId,data:a})}static authorizeWithSeed(e){const{currentAuthorityDerivedKeyBasePubkey:t,currentAuthorityDerivedKeyOwnerPubkey:r,currentAuthorityDerivedKeySeed:i,newAuthorizedPubkey:s,voteAuthorizationType:o,votePubkey:a}=e,c=pn.AuthorizeWithSeed,d=we(c,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:ge(r.toBuffer()),currentAuthorityDerivedKeySeed:i,newAuthorized:ge(s.toBuffer()),voteAuthorizationType:o.index}}),l=[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:Qt,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return new Ie().add({keys:l,programId:this.programId,data:d})}static withdraw(e){const{votePubkey:t,authorizedWithdrawerPubkey:r,lamports:i,toPubkey:s}=e,o=pn.Withdraw,a=we(o,{lamports:i}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return new Ie().add({keys:c,programId:this.programId,data:a})}static safeWithdraw(e,t,r){if(e.lamports>t-r)throw new Error("Withdraw will leave vote account with insuffcient funds.");return mr.withdraw(e)}}mr.programId=new N("Vote111111111111111111111111111111111111111");mr.space=3731;const Ba=new N("Va1idator1nfo111111111111111111111111111111"),Oh=B({name:L(),website:ae(L()),details:ae(L()),keybaseUsername:ae(L())});class As{constructor(e,t){this.key=void 0,this.info=void 0,this.key=e,this.info=t}static fromConfigData(e){let t=[...e];if(St(t)!==2)return null;const i=[];for(let s=0;s<2;s++){const o=new N(t.slice(0,Ot));t=t.slice(Ot);const a=t.slice(0,1)[0]===1;t=t.slice(1),i.push({publicKey:o,isSigner:a})}if(i[0].publicKey.equals(Ba)&&i[1].isSigner){const s=Wn().decode(se.Buffer.from(t)),o=JSON.parse(s);return Yu(o,Oh),new As(i[1].publicKey,o)}return null}}const xh=new N("Vote111111111111111111111111111111111111111"),Lh=J([be("nodePubkey"),be("authorizedWithdrawer"),ke("commission"),dt(),ft(J([dt("slot"),Q("confirmationCount")]),Fn(Q(),-8),"votes"),ke("rootSlotValid"),dt("rootSlot"),dt(),ft(J([dt("epoch"),be("authorizedVoter")]),Fn(Q(),-8),"authorizedVoters"),J([ft(J([be("authorizedPubkey"),dt("epochOfLastAuthorizedSwitch"),dt("targetEpoch")]),32,"buf"),dt("idx"),ke("isEmpty")],"priorVoters"),dt(),ft(J([dt("epoch"),dt("credits"),dt("prevCredits")]),Fn(Q(),-8),"epochCredits"),J([dt("slot"),dt("timestamp")],"lastTimestamp")]);class Is{constructor(e){this.nodePubkey=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.rootSlot=void 0,this.votes=void 0,this.authorizedVoters=void 0,this.priorVoters=void 0,this.epochCredits=void 0,this.lastTimestamp=void 0,this.nodePubkey=e.nodePubkey,this.authorizedWithdrawer=e.authorizedWithdrawer,this.commission=e.commission,this.rootSlot=e.rootSlot,this.votes=e.votes,this.authorizedVoters=e.authorizedVoters,this.priorVoters=e.priorVoters,this.epochCredits=e.epochCredits,this.lastTimestamp=e.lastTimestamp}static fromAccountData(e){const r=Lh.decode(ge(e),4);let i=r.rootSlot;return r.rootSlotValid||(i=null),new Is({nodePubkey:new N(r.nodePubkey),authorizedWithdrawer:new N(r.authorizedWithdrawer),commission:r.commission,votes:r.votes,rootSlot:i,authorizedVoters:r.authorizedVoters.map(Nh),priorVoters:zh(r.priorVoters),epochCredits:r.epochCredits,lastTimestamp:r.lastTimestamp})}}function Nh({authorizedVoter:n,epoch:e}){return{epoch:e,authorizedVoter:new N(n)}}function po({authorizedPubkey:n,epochOfLastAuthorizedSwitch:e,targetEpoch:t}){return{authorizedPubkey:new N(n),epochOfLastAuthorizedSwitch:e,targetEpoch:t}}function zh({buf:n,idx:e,isEmpty:t}){return t?[]:[...n.slice(e+1).map(po),...n.slice(0,e).map(po)]}const vo={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function Kh(n,e){const t=e===!1?"http":"https";if(!n)return vo[t].devnet;const r=vo[t][n];if(!r)throw new Error(`Unknown ${t} cluster: ${n}`);return r}async function Mh(n,e,t,r){let i,s;t&&Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")||t&&Object.prototype.hasOwnProperty.call(t,"nonceValue")?(i=t,s=r):s=t;const o=s&&{skipPreflight:s.skipPreflight,preflightCommitment:s.preflightCommitment||s.commitment,minContextSlot:s.minContextSlot},a=await n.sendRawTransaction(e,o),c=s&&s.commitment,l=(await(i?n.confirmTransaction(i,c):n.confirmTransaction(a,c))).value;if(l.err)throw new Error(`Raw transaction ${a} failed (${JSON.stringify(l)})`);return a}const Uh=1e9;var qh=Object.freeze(Object.defineProperty({__proto__:null,Account:Rd,AddressLookupTableAccount:Xi,AddressLookupTableInstruction:_h,AddressLookupTableProgram:ks,Authorized:Ta,BLOCKHASH_CACHE_TIMEOUT_MS:ba,BPF_LOADER_DEPRECATED_PROGRAM_ID:Pd,BPF_LOADER_PROGRAM_ID:Hd,BpfLoader:Gd,COMPUTE_BUDGET_INSTRUCTION_LAYOUTS:Xt,ComputeBudgetInstruction:Ah,ComputeBudgetProgram:_s,Connection:kh,Ed25519Program:Ri,Enum:Ad,EpochSchedule:ga,FeeCalculatorLayout:fa,Keypair:ar,LAMPORTS_PER_SOL:Uh,LOOKUP_TABLE_INSTRUCTION_LAYOUTS:mn,Loader:Vn,Lockup:Ur,MAX_SEED_LENGTH:ca,Message:$t,MessageAccountKeys:xr,MessageV0:Dn,NONCE_ACCOUNT_LENGTH:Ji,NonceAccount:_i,PACKET_DATA_SIZE:On,PUBLIC_KEY_LENGTH:Ot,PublicKey:N,SIGNATURE_LENGTH_IN_BYTES:dr,SOLANA_SCHEMA:Cr,STAKE_CONFIG_ID:Pa,STAKE_INSTRUCTION_LAYOUTS:tt,SYSTEM_INSTRUCTION_LAYOUTS:xe,SYSVAR_CLOCK_PUBKEY:Qt,SYSVAR_EPOCH_SCHEDULE_PUBKEY:Kd,SYSVAR_INSTRUCTIONS_PUBKEY:Md,SYSVAR_RECENT_BLOCKHASHES_PUBKEY:oi,SYSVAR_RENT_PUBKEY:fr,SYSVAR_REWARDS_PUBKEY:Ud,SYSVAR_SLOT_HASHES_PUBKEY:qd,SYSVAR_SLOT_HISTORY_PUBKEY:Wd,SYSVAR_STAKE_HISTORY_PUBKEY:ai,Secp256k1Program:ur,SendTransactionError:Qi,SolanaJSONRPCError:X,SolanaJSONRPCErrorCode:Zd,StakeAuthorizationLayout:Eh,StakeInstruction:Th,StakeProgram:Pi,Struct:hs,SystemInstruction:Vd,SystemProgram:ot,Transaction:Ie,TransactionExpiredBlockheightExceededError:gs,TransactionExpiredNonceInvalidError:ir,TransactionExpiredTimeoutError:ys,TransactionInstruction:Ee,TransactionMessage:ms,TransactionStatus:bn,VALIDATOR_INFO_KEY:Ba,VERSION_PREFIX_MASK:Si,VOTE_PROGRAM_ID:xh,ValidatorInfo:As,VersionedMessage:bs,VersionedTransaction:ps,VoteAccount:Is,VoteAuthorizationLayout:Ch,VoteInit:Ea,VoteInstruction:Bh,VoteProgram:mr,clusterApiUrl:Kh,sendAndConfirmRawTransaction:Mh,sendAndConfirmTransaction:Yi},Symbol.toStringTag,{value:"Module"})),qr=Qu(qh),Ut={},Ve={},jn={},Ye={},Wh=$&&$.__createBinding||(Object.create?function(n,e,t,r){r===void 0&&(r=t),Object.defineProperty(n,r,{enumerable:!0,get:function(){return e[t]}})}:function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]}),Fh=$&&$.__setModuleDefault||(Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e}),on=$&&$.__decorate||function(n,e,t,r){var i=arguments.length,s=i<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(n,e,t,r);else for(var a=n.length-1;a>=0;a--)(o=n[a])&&(s=(i<3?o(s):i>3?o(e,t,s):o(e,t))||s);return i>3&&s&&Object.defineProperty(e,t,s),s},Dh=$&&$.__importStar||function(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t in n)t!=="default"&&Object.hasOwnProperty.call(n,t)&&Wh(e,n,t);return Fh(e,n),e},Ca=$&&$.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ye,"__esModule",{value:!0});Ye.deserializeUnchecked=Ye.deserialize=Ye.serialize=Ye.BinaryReader=Ye.BinaryWriter=Ye.BorshError=Ye.baseDecode=Ye.baseEncode=void 0;const Cn=Ca(bi.exports),Oa=Ca($e),Vh=Dh(is),$h=typeof $.TextDecoder!="function"?Vh.TextDecoder:$.TextDecoder,Hh=new $h("utf-8",{fatal:!0});function Gh(n){return typeof n=="string"&&(n=G.Buffer.from(n,"utf8")),Oa.default.encode(G.Buffer.from(n))}Ye.baseEncode=Gh;function jh(n){return G.Buffer.from(Oa.default.decode(n))}Ye.baseDecode=jh;const Di=1024;class _t extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}Ye.BorshError=_t;class xa{constructor(){this.buf=G.Buffer.alloc(Di),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=G.Buffer.concat([this.buf,G.Buffer.alloc(Di)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(G.Buffer.from(new Cn.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(G.Buffer.from(new Cn.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(G.Buffer.from(new Cn.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(G.Buffer.from(new Cn.default(e).toArray("le",64)))}writeBuffer(e){this.buf=G.Buffer.concat([G.Buffer.from(this.buf.subarray(0,this.length)),e,G.Buffer.alloc(Di)]),this.length+=e.length}writeString(e){this.maybeResize();const t=G.Buffer.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(G.Buffer.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const r of e)this.maybeResize(),t(r)}toArray(){return this.buf.subarray(0,this.length)}}Ye.BinaryWriter=xa;function an(n,e,t){const r=t.value;t.value=function(...i){try{return r.apply(this,i)}catch(s){if(s instanceof RangeError){const o=s.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(o)>=0)throw new _t("Reached the end of buffer when deserializing")}throw s}}}class Nt{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new Cn.default(e,"le")}readU128(){const e=this.readBuffer(16);return new Cn.default(e,"le")}readU256(){const e=this.readBuffer(32);return new Cn.default(e,"le")}readU512(){const e=this.readBuffer(64);return new Cn.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new _t(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return Hh.decode(t)}catch(r){throw new _t(`Error decoding UTF-8 string: ${r}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),r=Array();for(let i=0;i<t;++i)r.push(e());return r}}on([an],Nt.prototype,"readU8",null);on([an],Nt.prototype,"readU16",null);on([an],Nt.prototype,"readU32",null);on([an],Nt.prototype,"readU64",null);on([an],Nt.prototype,"readU128",null);on([an],Nt.prototype,"readU256",null);on([an],Nt.prototype,"readU512",null);on([an],Nt.prototype,"readString",null);on([an],Nt.prototype,"readFixedArray",null);on([an],Nt.prototype,"readArray",null);Ye.BinaryReader=Nt;function La(n){return n.charAt(0).toUpperCase()+n.slice(1)}function fi(n,e,t,r,i){try{if(typeof r=="string")i[`write${La(r)}`](t);else if(r instanceof Array)if(typeof r[0]=="number"){if(t.length!==r[0])throw new _t(`Expecting byte array of length ${r[0]}, but got ${t.length} bytes`);i.writeFixedArray(t)}else i.writeArray(t,s=>{fi(n,e,s,r[0],i)});else if(r.kind!==void 0)switch(r.kind){case"option":{t==null?i.writeU8(0):(i.writeU8(1),fi(n,e,t,r.type,i));break}default:throw new _t(`FieldType ${r} unrecognized`)}else Na(n,t,i)}catch(s){throw s instanceof _t&&s.addToFieldPath(e),s}}function Na(n,e,t){const r=n.get(e.constructor);if(!r)throw new _t(`Class ${e.constructor.name} is missing in schema`);if(r.kind==="struct")r.fields.map(([i,s])=>{fi(n,i,e[i],s,t)});else if(r.kind==="enum"){const i=e[r.field];for(let s=0;s<r.values.length;++s){const[o,a]=r.values[s];if(o===i){t.writeU8(s),fi(n,o,e[o],a,t);break}}}else throw new _t(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function Yh(n,e){const t=new xa;return Na(n,e,t),t.toArray()}Ye.serialize=Yh;function hi(n,e,t,r){try{return typeof t=="string"?r[`read${La(t)}`]():t instanceof Array?typeof t[0]=="number"?r.readFixedArray(t[0]):r.readArray(()=>hi(n,e,t[0],r)):t.kind==="option"?r.readU8()?hi(n,e,t.type,r):void 0:Rs(n,t,r)}catch(i){throw i instanceof _t&&i.addToFieldPath(e),i}}function Rs(n,e,t){const r=n.get(e);if(!r)throw new _t(`Class ${e.name} is missing in schema`);if(r.kind==="struct"){const i={};for(const[s,o]of n.get(e).fields)i[s]=hi(n,s,o,t);return new e(i)}if(r.kind==="enum"){const i=t.readU8();if(i>=r.values.length)throw new _t(`Enum index: ${i} is out of range`);const[s,o]=r.values[i],a=hi(n,s,o,t);return new e({[s]:a})}throw new _t(`Unexpected schema kind: ${r.kind} for ${e.constructor.name}`)}function Jh(n,e,t){const r=new Nt(t),i=Rs(n,e,r);if(r.offset<t.length)throw new _t(`Unexpected ${t.length-r.offset} bytes after deserialized data`);return i}Ye.deserialize=Jh;function Qh(n,e,t){const r=new Nt(t);return Rs(n,e,r)}Ye.deserializeUnchecked=Qh;Object.defineProperty(jn,"__esModule",{value:!0});jn.NameRegistryState=void 0;const Vi=qr,Xh=Ye;class gr{constructor(e){this.parentName=new Vi.PublicKey(e.parentName),this.owner=new Vi.PublicKey(e.owner),this.class=new Vi.PublicKey(e.class)}static async retrieve(e,t){var r;const i=await e.getAccountInfo(t,"processed");if(!i)throw new Error("Invalid name account provided");const s=(0,Xh.deserializeUnchecked)(this.schema,gr,i.data);return s.data=(r=i.data)===null||r===void 0?void 0:r.slice(this.HEADER_LEN),s}}jn.NameRegistryState=gr;gr.HEADER_LEN=96;gr.schema=new Map([[gr,{kind:"struct",fields:[["parentName",[32]],["owner",[32]],["class",[32]]]}]]);var za=$&&$.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ve,"__esModule",{value:!0});Ve.getFilteredProgramAccounts=Ve.getNameOwner=Ve.getNameAccountKey=Ve.getHashedName=Ve.signAndSendTransactionInstructions=Ve.Numberu64=Ve.Numberu32=void 0;const gi=za(_c.exports),Zh=Ac,Ka=qr,yi=za(bi.exports),Ma=wi,eg=jn;class tg extends yi.default{toBuffer(){const e=super.toArray().reverse(),t=G.Buffer.from(e);if(t.length===4)return t;(0,gi.default)(t.length<4,"Numberu32 too large");const r=G.Buffer.alloc(4);return t.copy(r),r}static fromBuffer(e){return(0,gi.default)(e.length===4,`Invalid buffer length: ${e.length}`),new yi.default([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}Ve.Numberu32=tg;class ng extends yi.default{toBuffer(){const e=super.toArray().reverse(),t=G.Buffer.from(e);if(t.length===8)return t;(0,gi.default)(t.length<8,"Numberu64 too large");const r=G.Buffer.alloc(8);return t.copy(r),r}static fromBuffer(e){return(0,gi.default)(e.length===8,`Invalid buffer length: ${e.length}`),new yi.default([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}Ve.Numberu64=ng;const rg=async(n,e,t,r)=>{const i=new Ka.Transaction;return i.feePayer=t.publicKey,e.push(t),i.add(...r),await n.sendTransaction(i,e)};Ve.signAndSendTransactionInstructions=rg;async function ig(n){const e=Ma.HASH_PREFIX+n;return(0,Zh.createHash)("sha256").update(e,"utf8").digest()}Ve.getHashedName=ig;async function sg(n,e,t){const r=[n];e?r.push(e.toBuffer()):r.push(G.Buffer.alloc(32)),t?r.push(t.toBuffer()):r.push(G.Buffer.alloc(32));const[i]=await Ka.PublicKey.findProgramAddress(r,Ma.NAME_PROGRAM_ID);return i}Ve.getNameAccountKey=sg;async function og(n,e){if(!await n.getAccountInfo(e))throw new Error("Unable to find the given account.");return eg.NameRegistryState.retrieve(n,e)}Ve.getNameOwner=og;async function ag(n,e,t){return(await n.getProgramAccounts(e,{commitment:n.commitment,filters:t,encoding:"base64"})).map(({pubkey:i,account:{data:s,executable:o,owner:a,lamports:c}})=>({publicKey:i,accountInfo:{data:s,executable:o,owner:a,lamports:c}}))}Ve.getFilteredProgramAccounts=ag;Object.defineProperty(Ut,"__esModule",{value:!0});Ut.deleteInstruction=Ut.transferInstruction=Ut.updateInstruction=Ut.createInstruction=void 0;const cr=qr,Ua=Ve;function ug(n,e,t,r,i,s,o,a,c,d,l){const g=[G.Buffer.from(Int8Array.from([0])),new Ua.Numberu32(s.length).toBuffer(),s,o.toBuffer(),a.toBuffer()],w=G.Buffer.concat(g),h=[{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1}];return c?h.push({pubkey:c,isSigner:!0,isWritable:!1}):h.push({pubkey:new cr.PublicKey(G.Buffer.alloc(32)),isSigner:!1,isWritable:!1}),d?h.push({pubkey:d,isSigner:!1,isWritable:!1}):h.push({pubkey:new cr.PublicKey(G.Buffer.alloc(32)),isSigner:!1,isWritable:!1}),l&&h.push({pubkey:l,isSigner:!0,isWritable:!1}),new cr.TransactionInstruction({keys:h,programId:n,data:w})}Ut.createInstruction=ug;function cg(n,e,t,r,i,s){const o=[G.Buffer.from(Int8Array.from([1])),t.toBuffer(),new Ua.Numberu32(r.length).toBuffer(),r],a=G.Buffer.concat(o),c=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!0,isWritable:!1}];return s&&c.push({pubkey:s,isSigner:!1,isWritable:!1}),new cr.TransactionInstruction({keys:c,programId:n,data:a})}Ut.updateInstruction=cg;function lg(n,e,t,r,i,s){const o=[G.Buffer.from(Int8Array.from([2])),t.toBuffer()],a=G.Buffer.concat(o),c=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return i&&c.push({pubkey:i,isSigner:!0,isWritable:!1}),s&&c.push({pubkey:s,isSigner:!1,isWritable:!1}),new cr.TransactionInstruction({keys:c,programId:n,data:a})}Ut.transferInstruction=lg;function dg(n,e,t,r){const i=[G.Buffer.from(Int8Array.from([3]))],s=G.Buffer.concat(i),o=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0}];return new cr.TransactionInstruction({keys:o,programId:n,data:s})}Ut.deleteInstruction=dg;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.deleteNameRegistry=n.transferNameOwnership=n.updateNameRegistryData=n.createNameRegistry=n.HASH_PREFIX=n.NAME_PROGRAM_ID=void 0;const e=qr,t=Ut,r=jn,i=Ve,s=Ve;n.NAME_PROGRAM_ID=new e.PublicKey("namesLPneVptA9Z5rqUDD9tMTWEJwofgaYwp8cawRkX"),n.HASH_PREFIX="SPL Name Service";async function o(l,g,w,h,b,v,p,m){const _=await(0,s.getHashedName)(g),A=await(0,s.getNameAccountKey)(_,p,m),T=v||await l.getMinimumBalanceForRentExemption(w);let x;return m&&(x=(await(0,s.getNameOwner)(l,m)).owner),(0,t.createInstruction)(n.NAME_PROGRAM_ID,e.SystemProgram.programId,A,b,h,_,new i.Numberu64(T),new s.Numberu32(w),p,m,x)}n.createNameRegistry=o;async function a(l,g,w,h,b,v){const p=await(0,s.getHashedName)(g),m=await(0,s.getNameAccountKey)(p,b,v);let _;return b?_=b:_=(await r.NameRegistryState.retrieve(l,m)).owner,(0,t.updateInstruction)(n.NAME_PROGRAM_ID,m,new s.Numberu32(w),h,_,v)}n.updateNameRegistryData=a;async function c(l,g,w,h,b){const v=await(0,s.getHashedName)(g),p=await(0,s.getNameAccountKey)(v,h,b);let m;return h?m=h:m=(await r.NameRegistryState.retrieve(l,p)).owner,(0,t.transferInstruction)(n.NAME_PROGRAM_ID,p,w,m,h,b)}n.transferNameOwnership=c;async function d(l,g,w,h,b){const v=await(0,s.getHashedName)(g),p=await(0,s.getNameAccountKey)(v,h,b);let m;return h?m=h:m=(await r.NameRegistryState.retrieve(l,p)).owner,(0,t.deleteInstruction)(n.NAME_PROGRAM_ID,p,w,m)}n.deleteNameRegistry=d})(wi);var qa={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.createReverseTwitterRegistry=n.ReverseTwitterRegistryState=n.getTwitterRegistryData=n.getTwitterHandleandRegistryKeyViaFilters=n.getHandleAndRegistryKey=n.getTwitterRegistry=n.getTwitterRegistryKey=n.deleteTwitterRegistry=n.changeVerifiedPubkey=n.changeTwitterRegistryData=n.createVerifiedTwitterRegistry=n.TWITTER_ROOT_PARENT_REGISTRY_KEY=n.TWITTER_VERIFICATION_AUTHORITY=void 0;const e=qr,t=Ye,r=wi,i=Ut,s=jn,o=Ve;n.TWITTER_VERIFICATION_AUTHORITY=new e.PublicKey("FvPH7PrVrLGKPfqaf3xJodFTjZriqrAXXLTVWEorTFBi"),n.TWITTER_ROOT_PARENT_REGISTRY_KEY=new e.PublicKey("4YcexoW3r78zz16J2aqmukBLRwGq6rAvWzJpkYAXqebv");async function a(_,A,T,x,C){const te=await(0,o.getHashedName)(A),oe=await(0,o.getNameAccountKey)(te,void 0,n.TWITTER_ROOT_PARENT_REGISTRY_KEY);let fe=[(0,i.createInstruction)(r.NAME_PROGRAM_ID,e.SystemProgram.programId,oe,T,C,te,new o.Numberu64(await _.getMinimumBalanceForRentExemption(x)),new o.Numberu32(x),void 0,n.TWITTER_ROOT_PARENT_REGISTRY_KEY,n.TWITTER_VERIFICATION_AUTHORITY)];return fe=fe.concat(await m(_,A,oe,T,C)),fe}n.createVerifiedTwitterRegistry=a;async function c(_,A,T,x){const C=await(0,o.getHashedName)(_),te=await(0,o.getNameAccountKey)(C,void 0,n.TWITTER_ROOT_PARENT_REGISTRY_KEY);return[(0,i.updateInstruction)(r.NAME_PROGRAM_ID,te,new o.Numberu32(T),x,A,void 0)]}n.changeTwitterRegistryData=c;async function d(_,A,T,x,C){const te=await(0,o.getHashedName)(A),oe=await(0,o.getNameAccountKey)(te,void 0,n.TWITTER_ROOT_PARENT_REGISTRY_KEY);let fe=[(0,i.transferInstruction)(r.NAME_PROGRAM_ID,oe,x,T,void 0)];return fe.push(await(0,r.deleteNameRegistry)(_,T.toString(),C,n.TWITTER_VERIFICATION_AUTHORITY,n.TWITTER_ROOT_PARENT_REGISTRY_KEY)),fe=fe.concat(await m(_,A,oe,x,C)),fe}n.changeVerifiedPubkey=d;async function l(_,A){const T=await(0,o.getHashedName)(_),x=await(0,o.getNameAccountKey)(T,void 0,n.TWITTER_ROOT_PARENT_REGISTRY_KEY),C=await(0,o.getHashedName)(A.toString()),te=await(0,o.getNameAccountKey)(C,n.TWITTER_VERIFICATION_AUTHORITY,n.TWITTER_ROOT_PARENT_REGISTRY_KEY);return[(0,i.deleteInstruction)(r.NAME_PROGRAM_ID,x,A,A),(0,i.deleteInstruction)(r.NAME_PROGRAM_ID,te,A,A)]}n.deleteTwitterRegistry=l;async function g(_){const A=await(0,o.getHashedName)(_);return await(0,o.getNameAccountKey)(A,void 0,n.TWITTER_ROOT_PARENT_REGISTRY_KEY)}n.getTwitterRegistryKey=g;async function w(_,A){const T=await(0,o.getHashedName)(A),x=await(0,o.getNameAccountKey)(T,void 0,n.TWITTER_ROOT_PARENT_REGISTRY_KEY);return s.NameRegistryState.retrieve(_,x)}n.getTwitterRegistry=w;async function h(_,A){const T=await(0,o.getHashedName)(A.toString()),x=await(0,o.getNameAccountKey)(T,n.TWITTER_VERIFICATION_AUTHORITY,n.TWITTER_ROOT_PARENT_REGISTRY_KEY),C=await p.retrieve(_,x);return[C.twitterHandle,new e.PublicKey(C.twitterRegistryKey)]}n.getHandleAndRegistryKey=h;async function b(_,A){const T=[{memcmp:{offset:0,bytes:n.TWITTER_ROOT_PARENT_REGISTRY_KEY.toBase58()}},{memcmp:{offset:32,bytes:A.toBase58()}},{memcmp:{offset:64,bytes:n.TWITTER_VERIFICATION_AUTHORITY.toBase58()}}],x=await(0,o.getFilteredProgramAccounts)(_,r.NAME_PROGRAM_ID,T);for(const C of x)if(C.accountInfo.data.length>s.NameRegistryState.HEADER_LEN+32){const te=C.accountInfo.data.slice(s.NameRegistryState.HEADER_LEN),oe=(0,t.deserialize)(p.schema,p,te);return[oe.twitterHandle,new e.PublicKey(oe.twitterRegistryKey)]}throw new Error("Registry not found.")}n.getTwitterHandleandRegistryKeyViaFilters=b;async function v(_,A){const T=[{memcmp:{offset:0,bytes:n.TWITTER_ROOT_PARENT_REGISTRY_KEY.toBytes()}},{memcmp:{offset:32,bytes:A.toBytes()}},{memcmp:{offset:64,bytes:new e.PublicKey(G.Buffer.alloc(32,0)).toBase58()}}],x=await(0,o.getFilteredProgramAccounts)(_,r.NAME_PROGRAM_ID,T);if(x.length>1)throw new Error("Found more than one registry.");return x[0].accountInfo.data.slice(s.NameRegistryState.HEADER_LEN)}n.getTwitterRegistryData=v;class p{constructor(A){this.twitterRegistryKey=A.twitterRegistryKey,this.twitterHandle=A.twitterHandle}static async retrieve(A,T){const x=await A.getAccountInfo(T,"processed");if(!x)throw new Error("Invalid reverse Twitter account provided");return(0,t.deserializeUnchecked)(this.schema,p,x.data.slice(s.NameRegistryState.HEADER_LEN))}}n.ReverseTwitterRegistryState=p,p.schema=new Map([[p,{kind:"struct",fields:[["twitterRegistryKey",[32]],["twitterHandle","string"]]}]]);async function m(_,A,T,x,C){const te=await(0,o.getHashedName)(x.toString()),oe=await(0,o.getNameAccountKey)(te,n.TWITTER_VERIFICATION_AUTHORITY,n.TWITTER_ROOT_PARENT_REGISTRY_KEY),fe=(0,t.serialize)(p.schema,new p({twitterRegistryKey:T.toBytes(),twitterHandle:A}));return[(0,i.createInstruction)(r.NAME_PROGRAM_ID,e.SystemProgram.programId,oe,x,C,te,new o.Numberu64(await _.getMinimumBalanceForRentExemption(fe.length)),new o.Numberu32(fe.length),n.TWITTER_VERIFICATION_AUTHORITY,n.TWITTER_ROOT_PARENT_REGISTRY_KEY,n.TWITTER_VERIFICATION_AUTHORITY),(0,i.updateInstruction)(r.NAME_PROGRAM_ID,oe,new o.Numberu32(0),G.Buffer.from(fe),n.TWITTER_VERIFICATION_AUTHORITY,void 0)]}n.createReverseTwitterRegistry=m})(qa);(function(n){var e=$&&$.__createBinding||(Object.create?function(r,i,s,o){o===void 0&&(o=s);var a=Object.getOwnPropertyDescriptor(i,s);(!a||("get"in a?!i.__esModule:a.writable||a.configurable))&&(a={enumerable:!0,get:function(){return i[s]}}),Object.defineProperty(r,o,a)}:function(r,i,s,o){o===void 0&&(o=s),r[o]=i[s]}),t=$&&$.__exportStar||function(r,i){for(var s in r)s!=="default"&&!Object.prototype.hasOwnProperty.call(i,s)&&e(i,r,s)};Object.defineProperty(n,"__esModule",{value:!0}),t(wi,n),t(Ut,n),t(jn,n),t(Ve,n),t(qa,n)})(Xo);(function(n){var e=$&&$.__awaiter||function(d,l,g,w){function h(b){return b instanceof g?b:new g(function(v){v(b)})}return new(g||(g=Promise))(function(b,v){function p(A){try{_(w.next(A))}catch(T){v(T)}}function m(A){try{_(w.throw(A))}catch(T){v(T)}}function _(A){A.done?b(A.value):h(A.value).then(p,m)}_((w=w.apply(d,l||[])).next())})},t=$&&$.__generator||function(d,l){var g={label:0,sent:function(){if(b[0]&1)throw b[1];return b[1]},trys:[],ops:[]},w,h,b,v;return v={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(v[Symbol.iterator]=function(){return this}),v;function p(_){return function(A){return m([_,A])}}function m(_){if(w)throw new TypeError("Generator is already executing.");for(;g;)try{if(w=1,h&&(b=_[0]&2?h.return:_[0]?h.throw||((b=h.return)&&b.call(h),0):h.next)&&!(b=b.call(h,_[1])).done)return b;switch(h=0,b&&(_=[_[0]&2,b.value]),_[0]){case 0:case 1:b=_;break;case 4:return g.label++,{value:_[1],done:!1};case 5:g.label++,h=_[1],_=[0];continue;case 7:_=g.ops.pop(),g.trys.pop();continue;default:if(b=g.trys,!(b=b.length>0&&b[b.length-1])&&(_[0]===6||_[0]===2)){g=0;continue}if(_[0]===3&&(!b||_[1]>b[0]&&_[1]<b[3])){g.label=_[1];break}if(_[0]===6&&g.label<b[1]){g.label=b[1],b=_;break}if(b&&g.label<b[2]){g.label=b[2],g.ops.push(_);break}b[2]&&g.ops.pop(),g.trys.pop();continue}_=l.call(d,g)}catch(A){_=[6,A],h=0}finally{w=b=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}};Object.defineProperty(n,"__esModule",{value:!0}),n.resolveToWalletAddress=n.getInputKey=n.SOL_TLD_AUTHORITY=void 0;var r=$n,i=Xo,s=kt;n.SOL_TLD_AUTHORITY=new r.PublicKey("58PwtjSDuFHuUkYjH9BYnnQKHfwo9reZhC2zMJv9JPkx");var o=function(d){return e(void 0,void 0,void 0,function(){var l,g;return t(this,function(w){switch(w.label){case 0:return[4,(0,i.getHashedName)(d)];case 1:return l=w.sent(),[4,(0,i.getNameAccountKey)(l,void 0,n.SOL_TLD_AUTHORITY)];case 2:return g=w.sent(),[2,{inputDomainKey:g,hashedInputName:l}]}})})};n.getInputKey=o;var a=new Error("Can't resolve provided name into valid Solana address =("),c=function(d){var l=d.text,g=d.connection,w=g===void 0?(0,s.createConnectionConfig)():g;return e(void 0,void 0,void 0,function(){var h,b,v,p,m,_,A,T,x,C,te,oe;return t(this,function(fe){switch(fe.label){case 0:return h=(x=l==null?void 0:l.trim)===null||x===void 0?void 0:x.call(l),h?(b=(0,s.isValidSolanaAddress)(h),b?[2,Promise.resolve(h)]:(v=h==null?void 0:h.toLowerCase(),p=(C=v==null?void 0:v.endsWith)===null||C===void 0?void 0:C.call(v,".sol"),p?(m=v.split(".sol")[0],[4,(0,n.getInputKey)(m)]):[3,3])):[2,Promise.reject(a)];case 1:return _=fe.sent().inputDomainKey,[4,i.NameRegistryState.retrieve(w,_)];case 2:if(A=fe.sent(),T=(oe=(te=A==null?void 0:A.owner)===null||te===void 0?void 0:te.toBase58)===null||oe===void 0?void 0:oe.call(te),T)return[2,Promise.resolve(T)];fe.label=3;case 3:return[2,Promise.reject(a)]}})})};n.resolveToWalletAddress=c})(Qo);(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.decodeTokenMetadata=n.getSolanaMetadataAddress=n.createConnectionConfig=n.isValidSolanaAddress=n.resolveToWalletAddress=n.getParsedAccountByMint=n.getParsedNftAccountsByUpdateAuthority=n.getParsedNftAccountsByOwner=void 0;var e=Uo;Object.defineProperty(n,"getParsedNftAccountsByOwner",{enumerable:!0,get:function(){return e.getParsedNftAccountsByOwner}});var t=Jo;Object.defineProperty(n,"getParsedNftAccountsByUpdateAuthority",{enumerable:!0,get:function(){return t.getParsedNftAccountsByUpdateAuthority}});var r=vi;Object.defineProperty(n,"getParsedAccountByMint",{enumerable:!0,get:function(){return r.getParsedAccountByMint}});var i=Qo;Object.defineProperty(n,"resolveToWalletAddress",{enumerable:!0,get:function(){return i.resolveToWalletAddress}});var s=kt;Object.defineProperty(n,"isValidSolanaAddress",{enumerable:!0,get:function(){return s.isValidSolanaAddress}}),Object.defineProperty(n,"createConnectionConfig",{enumerable:!0,get:function(){return s.createConnectionConfig}}),Object.defineProperty(n,"getSolanaMetadataAddress",{enumerable:!0,get:function(){return s.getSolanaMetadataAddress}}),Object.defineProperty(n,"decodeTokenMetadata",{enumerable:!0,get:function(){return s.decodeTokenMetadata}})})(Mo);new Po("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1");const Ag=Xu("walletStore",{state:()=>({_updateCount:0,is_loading:!1,token_accounts:[],nft_accounts:[],nft_in_wallet:[],token_map:[],nft_map:[]}),getters:{get_account_map(n){return n.token_accounts.map(e=>{const t=e.account.data.parsed.info;return{pubkey:e.pubkey.toString(),info:t,account:e,meta:Ar().token_list.find(r=>r.address===t.mint)}})}},actions:{async update_accounts(){this.is_loading=!0,this.token_accounts=[],ni().publicKey.value&&(this.token_accounts=[],this.token_accounts=(await Ar().connection.getParsedTokenAccountsByOwner(ni().publicKey.value,{programId:Ic})).value),this.is_loading=!1},async update_accounts_nft(n=!1){if(ni().publicKey.value||!this.nft_map.length||n){this.is_loading=!0,this.nft_in_wallet=[],this.nft_map=[],this.nft_in_wallet=await Mo.getParsedNftAccountsByOwner({publicAddress:ni().publicKey.value.toString(),connection:Ar().connection});for(const e of this.nft_in_wallet){const t=await Ar().connection.getTokenLargestAccounts(new Po(e.mint)),r=await Ar().connection.getParsedAccountInfo(t.value[0].address),i=r.value.data.parsed.info;this.nft_map.push({pubkey:t.value[0].address.toString(),account:r.value,info:i,meta:e,data:await fg(e.data.uri)})}}this.is_loading=!1}}});async function fg(n){try{return await Zu.get(n).then(e=>e.data)}catch(e){console.warn(e);return}}var hg={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.associatedAddress=n.ASSOCIATED_PROGRAM_ID=n.TOKEN_PROGRAM_ID=void 0;const e=$n;n.TOKEN_PROGRAM_ID=new e.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),n.ASSOCIATED_PROGRAM_ID=new e.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");function t({mint:r,owner:i}){return e.PublicKey.findProgramAddressSync([i.toBuffer(),n.TOKEN_PROGRAM_ID.toBuffer(),r.toBuffer()],n.ASSOCIATED_PROGRAM_ID)[0]}n.associatedAddress=t})(hg);function Ig(n,e=6){if(n){const t=n==null?void 0:n.substring(0,e),r=n==null?void 0:n.substring(n.length-e);return`${t}[...]${r}`}return"error"}export{Fc as Q,Uc as a,Vc as b,_g as c,kg as d,Ig as f,hg as t,Ag as u};
