import{Q as B,a as Me}from"./QTabs.c10beef6.js";import{Q as E,a as Ie}from"./QTabPanels.ecb3151a.js";import{Q as Le}from"./QPage.877b9662.js";import{Q as Y}from"./QInput.c55b3801.js";import{P as S,cI as ze,cm as De,ah as K,au as F,J as p,b1 as C,ak as A,as as o,bx as v,ar as V,cj as D,cJ as U,cK as ke,cL as $,aX as R,a6 as G,b7 as Z,bz as X,ai as W,a1 as ee,bZ as Ue,aU as Re,bs as _e,aF as k,aC as Xe,aQ as je,cM as He,cq as Oe,cl as he,cd as ge,bT as Je,cx as be,aj as Ye}from"./index.d567c69a.js";import{A as Ge,P as Ze,e as et}from"./index.447aaff2.js";import{d as xe,Q as tt,a as lt}from"./QSlideTransition.5a2dce2c.js";import{j as te,l as le,m as ae,k as re,n as ne,C as ie}from"./ClosePopup.5e27b488.js";import{u as at,a as rt}from"./uid.18e34e7d.js";import"./touch.3df10340.js";import"./pako.esm.065d9feb.js";const nt="processed",it="confirmed",ot=new S(xe.metadata.address);let we=null;const N=()=>we,ct=()=>{const l=ze(),c=De().connection,s=K(()=>new Ge(c,l.value,{preflightCommitment:nt,commitment:it})),y=K(()=>new Ze(xe,ot,s.value));we={wallet:l,connection:c,provider:s,program:y}},st={class:"row q-gutter-x-md"},ut=F({__name:"CreateWhitelist",setup(l){const c=p("My new whitelist");async function s(){const{program:y}=N();let[u,x]=S.findProgramAddressSync([U().publicKey.value.toBytes(),et(c.value)],y.value.programId);try{const _=await y.value.methods.initialize(c.value).accounts({whitelist:u,systemProgram:ke.programId}).rpc();console.log(_),$.create({message:"TX-Signature: "+_,timeout:5e3})}catch{$.create({color:"red",message:"Error sending tx!",timeout:5e3})}}return(y,u)=>(C(),A("div",st,[o(Y,{class:"col",modelValue:c.value,"onUpdate:modelValue":u[0]||(u[0]=x=>c.value=x)},null,8,["modelValue"]),o(D,{color:"primary",onClick:u[1]||(u[1]=x=>s())},{default:v(()=>[V("Create")]),_:1})]))}}),dt={class:"row q-gutter-x-md"},ft=F({__name:"AddAddressToWhitelist",setup(l){const{program:c}=N(),s=p("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),y=p(),u=p();R(async()=>{y.value=await c.value.account.whitelist.all()});async function x(){const _=new S(u.value.publicKey),[d,h]=S.findProgramAddressSync([new S(s.value).toBytes(),_.toBytes()],c.value.programId);try{const n=new S(s.value),q=await c.value.methods.addToWhitelist(n).accounts({entry:d,whitelist:_,authority:U().publicKey.value,systemProgram:ke.programId}).rpc();console.log(q),$.create({message:"TX-Signature: "+q,timeout:5e3})}catch(n){console.log(n),$.create({color:"red",message:`${n}`,timeout:5e3})}}return(_,d)=>{var h;return C(),A("div",dt,[o(ne,{color:"primary",label:((h=u.value)==null?void 0:h.account.name)??"please select a whitelist"},{default:v(()=>[o(te,null,{default:v(()=>[(C(!0),A(G,null,Z(y.value,n=>X((C(),W(re,{clickable:"",key:n,onClick:q=>u.value=n},{default:v(()=>[o(le,null,{default:v(()=>[o(ae,null,{default:v(()=>[V(ee(n==null?void 0:n.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[ie]])),128))]),_:1})]),_:1},8,["label"]),o(Y,{class:"col",outlined:"",modelValue:s.value,"onUpdate:modelValue":d[0]||(d[0]=n=>s.value=n),label:"Address to be removed"},null,8,["modelValue"]),o(D,{color:"primary",onClick:d[1]||(d[1]=n=>x())},{default:v(()=>[V("Add")]),_:1})])}}}),mt=["none","strict","leaf","leaf-filtered"];var vt=Ue({name:"QTree",props:{...at,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:l=>mt.includes(l)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:Number,noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(l,{slots:c,emit:s}){const{proxy:y}=Xe(),{$q:u}=y,x=rt(l,u),_=p({}),d=p(l.ticked||[]),h=p(l.expanded||[]);let n={};Re(()=>{n={}});const q=K(()=>`q-tree q-tree--${l.dense===!0?"dense":"standard"}`+(l.noConnectors===!0?" q-tree--no-connectors":"")+(x.value===!0?" q-tree--dark":"")+(l.color!==void 0?` text-${l.color}`:"")),oe=K(()=>l.selected!==void 0),pe=K(()=>l.icon||u.iconSet.tree.icon),ce=K(()=>l.controlColor||l.color),M=K(()=>l.textColor!==void 0?` text-${l.textColor}`:""),Se=K(()=>{const t=l.selectedColor||l.color;return t?` text-${t}`:""}),Ce=K(()=>l.filterMethod!==void 0?l.filterMethod:(t,a)=>{const e=a.toLowerCase();return t[l.labelKey]&&t[l.labelKey].toLowerCase().indexOf(e)>-1}),T=K(()=>{const t={},a=(e,i)=>{const r=e.tickStrategy||(i?i.tickStrategy:l.tickStrategy),m=e[l.nodeKey],g=e[l.childrenKey]&&Array.isArray(e[l.childrenKey])&&e[l.childrenKey].length!==0,Q=e.disabled!==!0&&oe.value===!0&&e.selectable!==!1,w=e.disabled!==!0&&e.expandable!==!1,We=r!=="none",z=r==="strict",ve=r==="leaf-filtered",O=r==="leaf"||r==="leaf-filtered";let J=e.disabled!==!0&&e.tickable!==!1;O===!0&&J===!0&&i&&i.tickable!==!0&&(J=!1);let P=e.lazy;P===!0&&_.value[m]!==void 0&&Array.isArray(e[l.childrenKey])===!0&&(P=_.value[m]);const f={key:m,parent:i,isParent:g,lazy:P,disabled:e.disabled,link:e.disabled!==!0&&(Q===!0||w===!0&&(g===!0||P===!0)),children:[],matchesFilter:l.filter?Ce.value(e,l.filter):!0,selected:m===l.selected&&Q===!0,selectable:Q,expanded:g===!0?h.value.includes(m):!1,expandable:w,noTick:e.noTick===!0||z!==!0&&P&&P!=="loaded",tickable:J,tickStrategy:r,hasTicking:We,strictTicking:z,leafFilteredTicking:ve,leafTicking:O,ticked:z===!0?d.value.includes(m):g===!0?!1:d.value.includes(m)};if(t[m]=f,g===!0&&(f.children=e[l.childrenKey].map(b=>a(b,f)),l.filter&&(f.matchesFilter!==!0?f.matchesFilter=f.children.some(b=>b.matchesFilter):f.noTick!==!0&&f.disabled!==!0&&f.tickable===!0&&ve===!0&&f.children.every(b=>b.matchesFilter!==!0||b.noTick===!0||b.tickable!==!0)===!0&&(f.tickable=!1)),f.matchesFilter===!0&&(f.noTick!==!0&&z!==!0&&f.children.every(b=>b.noTick)===!0&&(f.noTick=!0),O))){if(f.ticked=!1,f.indeterminate=f.children.some(b=>b.indeterminate===!0),f.tickable=f.tickable===!0&&f.children.some(b=>b.tickable),f.indeterminate!==!0){const b=f.children.reduce((ye,Ne)=>Ne.ticked===!0?ye+1:ye,0);b===f.children.length?f.ticked=!0:b>0&&(f.indeterminate=!0)}f.indeterminate===!0&&(f.indeterminateNextState=f.children.every(b=>b.tickable!==!0||b.ticked!==!0))}return f};return l.nodes.forEach(e=>a(e,null)),t});_e(()=>l.ticked,t=>{d.value=t}),_e(()=>l.expanded,t=>{h.value=t});function I(t){const a=[].reduce,e=(i,r)=>{if(i||!r)return i;if(Array.isArray(r)===!0)return a.call(Object(r),e,i);if(r[l.nodeKey]===t)return r;if(r[l.childrenKey])return e(null,r[l.childrenKey])};return e(null,l.nodes)}function Te(){return d.value.map(t=>I(t))}function Ke(){return h.value.map(t=>I(t))}function qe(t){return t&&T.value[t]?T.value[t].expanded:!1}function Ae(){l.expanded!==void 0?s("update:expanded",[]):h.value=[]}function se(){const t=[],a=e=>{e[l.childrenKey]&&e[l.childrenKey].length!==0&&e.expandable!==!1&&e.disabled!==!0&&(t.push(e[l.nodeKey]),e[l.childrenKey].forEach(a))};l.nodes.forEach(a),l.expanded!==void 0?s("update:expanded",t):h.value=t}function j(t,a,e=I(t),i=T.value[t]){if(i.lazy&&i.lazy!=="loaded"){if(i.lazy==="loading")return;_.value[t]="loading",Array.isArray(e[l.childrenKey])!==!0&&(e[l.childrenKey]=[]),s("lazyLoad",{node:e,key:t,done:r=>{_.value[t]="loaded",e[l.childrenKey]=Array.isArray(r)===!0?r:[],je(()=>{const m=T.value[t];m&&m.isParent===!0&&ue(t,!0)})},fail:()=>{delete _.value[t],e[l.childrenKey].length===0&&delete e[l.childrenKey]}})}else i.isParent===!0&&i.expandable===!0&&ue(t,a)}function ue(t,a){let e=h.value;const i=l.expanded!==void 0;if(i===!0&&(e=e.slice()),a){if(l.accordion&&T.value[t]){const r=[];T.value[t].parent?T.value[t].parent.children.forEach(m=>{m.key!==t&&m.expandable===!0&&r.push(m.key)}):l.nodes.forEach(m=>{const g=m[l.nodeKey];g!==t&&r.push(g)}),r.length!==0&&(e=e.filter(m=>r.includes(m)===!1))}e=e.concat([t]).filter((r,m,g)=>g.indexOf(r)===m)}else e=e.filter(r=>r!==t);i===!0?s("update:expanded",e):h.value=e}function $e(t){return t&&T.value[t]?T.value[t].ticked:!1}function L(t,a){let e=d.value;const i=l.ticked!==void 0;i===!0&&(e=e.slice()),a?e=e.concat(t).filter((r,m,g)=>g.indexOf(r)===m):e=e.filter(r=>t.includes(r)===!1),i===!0&&s("update:ticked",e)}function Ve(t,a,e){const i={tree:y,node:t,key:e,color:l.color,dark:x.value};return be(i,"expanded",()=>a.expanded,r=>{r!==a.expanded&&j(e,r)}),be(i,"ticked",()=>a.ticked,r=>{r!==a.ticked&&L([e],r)}),i}function de(t){return(l.filter?t.filter(a=>T.value[a[l.nodeKey]].matchesFilter):t).map(a=>Be(a))}function Qe(t){if(t.icon!==void 0)return k(he,{class:"q-tree__icon q-mr-sm",name:t.icon,color:t.iconColor});const a=t.img||t.avatar;if(a)return k("img",{class:`q-tree__${t.img?"img":"avatar"} q-mr-sm`,src:a})}function Pe(){s("afterShow")}function Fe(){s("afterHide")}function Be(t){const a=t[l.nodeKey],e=T.value[a],i=t.header&&c[`header-${t.header}`]||c["default-header"],r=e.isParent===!0?de(t[l.childrenKey]):[],m=r.length!==0||e.lazy&&e.lazy!=="loaded";let g=t.body&&c[`body-${t.body}`]||c["default-body"];const Q=i!==void 0||g!==void 0?Ve(t,e,a):null;return g!==void 0&&(g=k("div",{class:"q-tree__node-body relative-position"},[k("div",{class:M.value},[g(Q)])])),k("div",{key:a,class:`q-tree__node relative-position q-tree__node--${m===!0?"parent":"child"}`},[k("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(e.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(e.selected===!0?" q-tree__node--selected":"")+(e.disabled===!0?" q-tree__node--disabled":""),tabindex:e.link===!0?0:-1,ariaExpanded:r.length>0?e.expanded:null,role:"treeitem",onClick:w=>{me(t,e,w)},onKeypress(w){He(w)!==!0&&(w.keyCode===13?me(t,e,w,!0):w.keyCode===32&&H(t,e,w,!0))}},[k("div",{class:"q-focus-helper",tabindex:-1,ref:w=>{n[e.key]=w}}),e.lazy==="loading"?k(Oe,{class:"q-tree__spinner",color:ce.value}):m===!0?k(he,{class:"q-tree__arrow"+(e.expanded===!0?" q-tree__arrow--rotate":""),name:pe.value,onClick(w){H(t,e,w)}}):null,e.hasTicking===!0&&e.noTick!==!0?k(tt,{class:"q-tree__tickbox",modelValue:e.indeterminate===!0?null:e.ticked,color:ce.value,dark:x.value,dense:!0,keepColor:!0,disable:e.tickable!==!0,onKeydown:ge,"onUpdate:modelValue":w=>{Ee(e,w)}}):null,k("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(e.selected===!0?Se.value:M.value)},[i?i(Q):[Qe(t),k("div",t[l.labelKey])]])]),m===!0?l.noTransition===!0?e.expanded===!0?k("div",{class:"q-tree__node-collapsible"+M.value,key:`${a}__q`},[g,k("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":""),role:"group"},r)]):null:k(lt,{duration:l.duration,onShow:Pe,onHide:Fe},()=>X(k("div",{class:"q-tree__node-collapsible"+M.value,key:`${a}__q`},[g,k("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":""),role:"group"},r)]),[[Je,e.expanded]])):g])}function fe(t){const a=n[t];a&&a.focus()}function me(t,a,e,i){i!==!0&&a.selectable!==!1&&fe(a.key),oe.value&&a.selectable?l.noSelectionUnset===!1?s("update:selected",a.key!==l.selected?a.key:null):a.key!==l.selected&&s("update:selected",a.key===void 0?null:a.key):H(t,a,e,i),typeof t.handler=="function"&&t.handler(t)}function H(t,a,e,i){e!==void 0&&ge(e),i!==!0&&a.selectable!==!1&&fe(a.key),j(a.key,!a.expanded,t,a)}function Ee(t,a){if(t.indeterminate===!0&&(a=t.indeterminateNextState),t.strictTicking)L([t.key],a);else if(t.leafTicking){const e=[],i=r=>{r.isParent?(a!==!0&&r.noTick!==!0&&r.tickable===!0&&e.push(r.key),r.leafTicking===!0&&r.children.forEach(i)):r.noTick!==!0&&r.tickable===!0&&(r.leafFilteredTicking!==!0||r.matchesFilter===!0)&&e.push(r.key)};i(t),L(e,a)}}return l.defaultExpandAll===!0&&se(),Object.assign(y,{getNodeByKey:I,getTickedNodes:Te,getExpandedNodes:Ke,isExpanded:qe,collapseAll:Ae,expandAll:se,setExpanded:j,isTicked:$e,setTicked:L}),()=>{const t=de(l.nodes);return k("div",{class:q.value,role:"tree"},t.length===0?l.filter?l.noResultsLabel||u.lang.tree.noResults:l.noNodesLabel||u.lang.tree.noNodes:t)}}});const yt={class:"row q-gutter-x-md"},_t=F({__name:"ViewWhitelist",setup(l){const{program:c}=N(),s=p(),y=p();R(async()=>{s.value=await c.value.account.whitelist.all(),y.value=await c.value.account.whitelistEntry.all()});const u=K(()=>{var x;return(x=s==null?void 0:s.value)==null?void 0:x.map(_=>{var d,h;return{label:`${_.account.name} | ${_.publicKey.toString()}`,children:(h=(d=y.value)==null?void 0:d.filter(n=>n.account.parent.toString()===_.publicKey.toString()))==null?void 0:h.flatMap(n=>({label:`Member: ${n.account.whitelisted.toString()}  |  Account: ${n.publicKey.toString()} `}))}})});return(x,_)=>(C(),A("div",yt,[u.value?(C(),W(vt,{key:0,nodes:u.value,"node-key":"label","selected-color":"primary","default-expand-all":""},null,8,["nodes"])):Ye("",!0)]))}}),ht={class:"row q-gutter-x-md"},gt=F({__name:"RemoveAddressFromWhitelist",setup(l){const{program:c}=N(),s=p("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),y=p(),u=p();R(async()=>{y.value=await c.value.account.whitelist.all()});async function x(){const _=new S(u.value.publicKey),[d,h]=S.findProgramAddressSync([new S(s.value).toBytes(),_.toBytes()],c.value.programId);try{console.log(c.value.methods);const n=new S(s.value),q=await c.value.methods.removeFromWhitelist(n).accounts({entry:d,whitelist:_,authority:U().publicKey.value}).rpc();console.log(q),$.create({message:"TX-Signature: "+q,timeout:5e3})}catch(n){console.log(n),$.create({color:"red",message:`${n}`,timeout:5e3})}}return(_,d)=>{var h;return C(),A("div",ht,[o(ne,{color:"primary",label:((h=u.value)==null?void 0:h.account.name)??"please select a whitelist"},{default:v(()=>[o(te,null,{default:v(()=>[(C(!0),A(G,null,Z(y.value,n=>X((C(),W(re,{clickable:"",key:n,onClick:q=>u.value=n},{default:v(()=>[o(le,null,{default:v(()=>[o(ae,null,{default:v(()=>[V(ee(n==null?void 0:n.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[ie]])),128))]),_:1})]),_:1},8,["label"]),o(Y,{class:"col",outlined:"",modelValue:s.value,"onUpdate:modelValue":d[0]||(d[0]=n=>s.value=n),label:"Address to be added"},null,8,["modelValue"]),o(D,{color:"primary",onClick:d[1]||(d[1]=n=>x())},{default:v(()=>[V("Remove")]),_:1})])}}}),bt={class:"row q-gutter-x-md"},kt=F({__name:"DeleteWhitelist",setup(l){const{program:c}=N(),s=p("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),y=p(),u=p();R(async()=>{y.value=await c.value.account.whitelist.all()});async function x(){const _=new S(u.value.publicKey);S.findProgramAddressSync([new S(s.value).toBytes(),_.toBytes()],c.value.programId);try{const d=await c.value.methods.deleteWhitelist(u.value.account.name).accounts({whitelist:_,authority:U().publicKey.value}).rpc();console.log(d),$.create({message:"TX-Signature: "+d,timeout:5e3})}catch(d){console.log(d),$.create({color:"red",message:`${d}`,timeout:5e3})}}return(_,d)=>{var h;return C(),A("div",bt,[o(ne,{color:"primary",label:((h=u.value)==null?void 0:h.account.name)??"please select a whitelist"},{default:v(()=>[o(te,null,{default:v(()=>[(C(!0),A(G,null,Z(y.value,n=>X((C(),W(re,{clickable:"",key:n,onClick:q=>u.value=n},{default:v(()=>[o(le,null,{default:v(()=>[o(ae,null,{default:v(()=>[V(ee(n==null?void 0:n.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[ie]])),128))]),_:1})]),_:1},8,["label"]),o(D,{color:"primary",onClick:d[0]||(d[0]=n=>x())},{default:v(()=>[V("Delete")]),_:1})])}}}),Qt=F({__name:"WhitelistPage",setup(l){const c=p("create");return ct(),(s,y)=>(C(),W(Le,{class:"col text-center"},{default:v(()=>[o(Me,{"no-caps":"","outside-arrows":"","mobile-arrows":"",modelValue:c.value,"onUpdate:modelValue":y[0]||(y[0]=u=>c.value=u),class:"shadow-2",align:"justify"},{default:v(()=>[o(B,{name:"create",label:"Create Whitelist"}),o(B,{name:"add",label:"Add Address to Whitelist"}),o(B,{name:"remove",label:"Remove address from Whitelist"}),o(B,{name:"delete",label:"Delete Whitelist"}),o(B,{name:"view",label:"View "})]),_:1},8,["modelValue"]),o(Ie,{dark:"",modelValue:c.value,"onUpdate:modelValue":y[1]||(y[1]=u=>c.value=u),animated:""},{default:v(()=>[o(E,{name:"create"},{default:v(()=>[o(ut)]),_:1}),o(E,{name:"add"},{default:v(()=>[o(ft)]),_:1}),o(E,{name:"remove"},{default:v(()=>[o(gt)]),_:1}),o(E,{name:"delete"},{default:v(()=>[o(kt)]),_:1}),o(E,{name:"view"},{default:v(()=>[o(_t)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{Qt as default};
