import{cM as Ue,dk as K,P as O,au as k,cj as T,J as w,b1 as g,ak as C,as as e,bV as ye,ck as M,da as L,ai as V,V as _,bx as c,al as t,a1 as S,aj as q,bs as te,db as D,d9 as X,b7 as he,a6 as _e,cm as ce,d0 as H,dh as Q,aX as xe,eh as ke,ah as Ve,b9 as We,cn as Y,d$ as Ae,cN as Se,ei as Ce}from"./index.4796aa65.js";import{Q as W,a as x}from"./QInput.b15c0320.js";import{Q as I}from"./QSeparator.47aa1ec5.js";import{a as G,Q as ue}from"./QTabs.a6bcf2b7.js";import{Q as P}from"./QCard.b5e7cd83.js";import{a as F,Q as ve}from"./QTabPanels.f337b503.js";import{Q as qe}from"./QPage.47a0f145.js";import{Q as fe}from"./QSlideTransition.7435593e.js";import{g as U,h as N}from"./handleTransaction.120d4144.js";import{Q as se}from"./QSelect.fe1dacd0.js";import{c as de,Q as ne}from"./calcAmountToTransfer.51ab1ec0.js";import{Q as Pe}from"./QList.1fa6b78f.js";import{Q as E}from"./QToggle.24f3a712.js";import{a as me,b as re,c as Te,d as ee,_ as ie,f as Z,s as Ie}from"./FormatNumber.3320c282.js";import{Q as Qe}from"./QImg.4f11188e.js";import{Q as be}from"./QCardActions.23ff4a9c.js";import{f as Ke,a as Me}from"./format_address.9abdcb71.js";import{U as Le}from"./constants.e2ffd8e4.js";import{c as Ne}from"./associatedTokenAccount.274c48ec.js";import"./rtl.c152ad1e.js";import"./touch.3df10340.js";import"./use-checkbox.2eeac7e6.js";import"./SquadsStore.074a7ae1.js";import"./pda.7d3c6642.js";import"./cusper.907c87c5.js";import"./assert.7b0088ad.js";import"./vaultTransactionCreate.45690309.js";import"./token.dc99411c.js";let Be;const ge=()=>Be,s=Ue("wrapperStore",{state:()=>({wrapperSelected:{},groupSelected:{},wrapper:[],groups:[]}),getters:{},actions:{async updateStore(){if(K()){const{pg_wrapper:h}=K();this.groups=await h.value.account.group.all(),this.wrapper=await h.value.account.wrapper.all(),this.groupSelected||(this.groupSelected=this.groups[0]),console.log("[Updated] WrapperStore")}}}}),Oe=new O("subA4tNLV18htV8xACaZyMMKkAm1AQS4EhiPYPV4zbH"),Re={class:"row"},Ee=k({__name:"WrapperCreateGroup",setup(h){const u=T(),d=w("");async function r(){try{const l=new L,a=K().pg_wrapper.value;if(d.value==""){u.notify({message:"Invalid group name",color:"info",position:"bottom-right"});return}l.add(await a.methods.initializeGroup(d.value).accountsPartial({signer:U(),fee:Oe}).instruction()),await N(l,"[Raffle] create new group"),await s().updateStore()}catch(l){u.notify({message:l.message,type:"negative"})}}return(l,a)=>(g(),C("div",Re,[e(W,{square:"",filled:"",class:"col",modelValue:d.value,"onUpdate:modelValue":a[0]||(a[0]=n=>d.value=n),label:"New group name",type:"text"},null,8,["modelValue"]),e(M,{square:"",onClick:a[1]||(a[1]=ye(n=>r(),["prevent"])),color:"primary",label:"Create"})]))}}),we=k({__name:"WrapperGroupSelect",setup(h){return(u,d)=>(g(),V(se,{label:"Select a group",square:"",filled:"",modelValue:_(s)().groupSelected,"onUpdate:modelValue":d[0]||(d[0]=r=>_(s)().groupSelected=r),options:_(s)().groups,"option-label":r=>{var l;return(l=r==null?void 0:r.account)==null?void 0:l.name}},null,8,["modelValue","options","option-label"]))}}),Ge=k({__name:"WrapperCloseGroup",props:{disabled:{default:!0}},setup(h){const u=T();async function d(){try{const r=new L,l=K().pg_wrapper.value;r.add(await l.methods.closeGroup().accountsPartial({group:s().groupSelected.publicKey,signer:U()}).instruction()),await N(r,"Close Group"),await s().updateStore()}catch(r){u.notify({message:r.message,type:"negative"})}}return(r,l)=>(g(),V(M,{disable:h.disabled,square:"",color:"primary",label:"Close",onClick:l[0]||(l[0]=ye(a=>d(),["prevent"]))},null,8,["disable"]))}}),je=t("div",{class:"text-h5"},"Group",-1),ze=t("div",{class:"text-caption text-grey"}," The group will be used to filter and create the wrappers - one time creation fee of 0.5 SOL ",-1),De=t("div",{class:"text-caption text-accent"}," Make sure u use a list where you are the owner! ",-1),Fe={key:0,class:"text-caption row"},Xe=t("div",{style:{width:"50px"}},"ID",-1),Ze={class:"col text-right"},Je={key:1,class:"text-caption row"},He=t("div",{style:{width:"50px"}},"Owner",-1),Ye={class:"col text-accent text-right"},et={class:"row"},tt={key:0,class:"text-caption row"},at=t("div",{style:{width:"50px"}},"ID:",-1),lt={class:"col text-accent text-right"},ot={key:1,class:"text-caption row"},nt=t("div",{style:{width:"50px"}},"Owner:",-1),st={class:"col text-accent text-right"},rt=t("div",{class:"text-h6 text-red-6 col"}," I know what im doing i want to close the group ",-1),it=k({__name:"WrapperGroupView",setup(h){const u=w("select"),d=w(!1);return(r,l)=>(g(),V(P,{flat:"",bordered:""},{default:c(()=>[e(x,null,{default:c(()=>[je,ze,De]),_:1}),e(I),e(ue,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=a=>u.value=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[e(G,{name:"select",label:"Select"}),e(G,{name:"create",label:"Create"}),e(G,{name:"close",label:"Close"})]),_:1},8,["modelValue"]),e(I),e(ve,{modelValue:u.value,"onUpdate:modelValue":l[2]||(l[2]=a=>u.value=a),animated:""},{default:c(()=>[e(F,{name:"create"},{default:c(()=>[e(Ee)]),_:1}),e(F,{name:"select"},{default:c(()=>[e(we,{class:""}),e(x,null,{default:c(()=>{var a,n,o,p,m;return[(a=_(s)().groupSelected)!=null&&a.account?(g(),C("div",Fe,[Xe,t("div",Ze,S((n=_(s)().groupSelected)==null?void 0:n.publicKey),1)])):q("",!0),(o=_(s)().groupSelected)!=null&&o.account?(g(),C("div",Je,[He,t("div",Ye,S((m=(p=_(s)().groupSelected)==null?void 0:p.account)==null?void 0:m.owner),1)])):q("",!0)]}),_:1})]),_:1}),e(F,{name:"close"},{default:c(()=>[t("div",et,[e(we,{class:"col"}),e(Ge,{disabled:!d.value},null,8,["disabled"])]),e(x,null,{default:c(()=>{var a,n,o,p,m;return[(a=_(s)().groupSelected)!=null&&a.account?(g(),C("div",tt,[at,t("div",lt,S((n=_(s)().groupSelected)==null?void 0:n.publicKey),1)])):q("",!0),(o=_(s)().groupSelected)!=null&&o.account?(g(),C("div",ot,[nt,t("div",st,S((m=(p=_(s)().groupSelected)==null?void 0:p.account)==null?void 0:m.owner),1)])):q("",!0)]}),_:1}),e(x,{class:"row items-center"},{default:c(()=>[e(fe,{color:"red",modelValue:d.value,"onUpdate:modelValue":l[1]||(l[1]=a=>d.value=a)},null,8,["modelValue"]),rt]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),ct={class:"row items-center"},ut=t("div",{class:"col text-h6"},"Unwrapped Token",-1),dt={class:"row items-center"},pt=t("div",{class:"col text-right q-mr-md text-subtitle2"},"Filter:",-1),mt={class:"row q-gutter-x-md items-center"},wt=t("div",{class:"text-h6"},"Wrapped Token",-1),_t={class:"row q-gutter-x-md items-center"},vt=t("div",{class:"text-h6"},"Ratio",-1),ft={class:"row q-gutter-x-md items-center"},gt={class:"row items-center"},bt=t("div",{class:"text-h6"},"Add Medata",-1),yt={key:0,class:"row items-center q-gutter-x-sm"},ht=k({__name:"WrapperCreate",setup(h){const u=T(),d=w(["list","address"]),r=w("list"),l=w(),a=w(9),n=w(1),o=w(1),p=w(!0),m=w(""),b=w(""),$=w("");async function A(){var B;try{const f=new L,i=K().pg_wrapper.value,v=new H(window.crypto.getRandomValues(new Uint8Array(8))),y={ratio:[new H(n.value),new H(o.value)],onlyCreatorCanWrap:!1,onlyCreatorCanUnwrap:!1,wrappedDecimals:a.value,seed:v},R=new O(l.value.mint.toString());if(f.add(await i.methods.initialize(y).accountsPartial({signer:U(),group:new O(((B=s().groupSelected)==null?void 0:B.publicKey.toString())??""),mintUnwrapped:R,tokenProgram:Q}).instruction()),f.add(await i.methods.createVault().accountsPartial({signer:U(),wrapper:me(R,U()),vaultUnwrappedAta:re(me(R,U()),R),mintUnwrapped:R,tokenProgram:Q}).instruction()),p.value){const pe={name:m.value,symbol:b.value,uri:$.value},le=me(R,U()),J=Te(le,v),oe=ee(J);f.add(await i.methods.metadataCreate(pe).accountsPartial({signer:U(),wrapper:le,mintWrapped:J,mintUnwrapped:R,metadata:oe,tokenProgram:Q}).instruction())}await N(f,`[Wrapper] create + vault ${p.value?"+ metadata":""}`),await s().updateStore()}catch(f){console.error(f),u.notify({message:f.message,type:"negative",position:"bottom-right"})}}const j=w(z());te(()=>r.value,()=>j.value=z());function z(){var B;return r.value=="list"?D().tokenList.map(f=>({name:f.name,symbol:f.symbol,mint:f.address})):(B=X().getAccountsBalanceNotZero)==null?void 0:B.map(f=>{var i,v;return{name:(i=f.info)==null?void 0:i.name,symbol:(v=f.info)==null?void 0:v.symbol,mint:f.mint}})}function ae(B,f,i){f(()=>{const v=B.toLowerCase();j.value=z().filter(y=>JSON.stringify(y).toLowerCase().indexOf(v)>-1)})}return(B,f)=>(g(),V(P,{flat:""},{default:c(()=>[e(x,{class:""},{default:c(()=>[t("div",ct,[ut,t("div",dt,[pt,e(ue,{dense:"",modelValue:r.value,"onUpdate:modelValue":f[0]||(f[0]=i=>r.value=i),class:"text-teal"},{default:c(()=>[(g(!0),C(_e,null,he(d.value,i=>(g(),V(G,{name:i,label:i,key:i},null,8,["name","label"]))),128))]),_:1},8,["modelValue"])])]),t("div",mt,[e(se,{filled:"",square:"",class:"col","use-input":"","hide-selected":"","fill-input":"",onFilter:ae,options:j.value,"option-label":i=>i.name?`[${i.symbol}] ${i.name}`:i.mint,modelValue:l.value,"onUpdate:modelValue":f[1]||(f[1]=i=>l.value=i),label:"Token to Wrap"},null,8,["options","option-label","modelValue"])])]),_:1}),e(x,null,{default:c(()=>[wt,t("div",_t,[e(W,{square:"",filled:"",class:"col",modelValue:a.value,"onUpdate:modelValue":f[2]||(f[2]=i=>a.value=i),label:"Decimals",type:"number"},null,8,["modelValue"])])]),_:1}),e(x,null,{default:c(()=>[vt,t("div",ft,[e(W,{square:"",filled:"",class:"col",modelValue:n.value,"onUpdate:modelValue":f[3]||(f[3]=i=>n.value=i),label:"Unwrapped",type:"number"},null,8,["modelValue"]),e(ce,{name:"swap_horiz",size:"xl  "}),e(W,{square:"",filled:"",class:"col",modelValue:o.value,"onUpdate:modelValue":f[4]||(f[4]=i=>o.value=i),label:"Wrapped",type:"number"},null,8,["modelValue"])])]),_:1}),e(x,null,{default:c(()=>[t("div",gt,[bt,e(E,{modelValue:p.value,"onUpdate:modelValue":f[5]||(f[5]=i=>p.value=i),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),p.value?(g(),C("div",yt,[e(W,{square:"",filled:"",class:"col",modelValue:m.value,"onUpdate:modelValue":f[6]||(f[6]=i=>m.value=i),label:"Name",type:"text"},null,8,["modelValue"]),e(W,{square:"",filled:"",class:"col",modelValue:b.value,"onUpdate:modelValue":f[7]||(f[7]=i=>b.value=i),label:"Symbol",type:"text"},null,8,["modelValue"]),e(W,{square:"",filled:"",class:"col",modelValue:$.value,"onUpdate:modelValue":f[8]||(f[8]=i=>$.value=i),label:"Image-URI",type:"text"},null,8,["modelValue"])])):q("",!0)]),_:1}),e(x,{class:"row justify-end"},{default:c(()=>[e(M,{square:"",color:"primary",label:"Create new wrapper",onClick:f[9]||(f[9]=i=>A())})]),_:1})]),_:1}))}}),xt={class:"row items-center"},Vt=t("div",{class:"col text-subtitle1 text-weight-thin"},"Publickey",-1),St={class:"text-subtitle2"},$t={class:"col text-subtitle1 text-weight-thin"},Ut={key:0,class:"text-subtitle2"},kt={key:1,class:"text-subtitle2"},Wt=k({__name:"WrapperInfo",setup(h){return(u,d)=>{var r;return(r=_(s)().wrapperSelected)!=null&&r.account?(g(),V(P,{key:0,flat:""},{default:c(()=>[e(I),e(x,null,{default:c(()=>{var l;return[t("div",xt,[Vt,t("div",St,S(_(s)().wrapperSelected.publicKey),1)]),(g(!0),C(_e,null,he(Object.keys((l=_(s)().wrapperSelected)==null?void 0:l.account),a=>(g(),C("div",{key:a,class:"row items-center"},[t("div",$t,S(a.toUpperCase()),1),a=="ratio"?(g(),C("div",Ut,S(_(s)().wrapperSelected.account[a][0])+" : "+S(_(s)().wrapperSelected.account[a][1]),1)):(g(),C("div",kt,S(_(s)().wrapperSelected.account[a]),1))]))),128))]}),_:1})]),_:1})):q("",!0)}}}),At=k({__name:"WrapperClose",props:{disabled:{default:!0}},setup(h){const u=T();async function d(){var r,l;try{const a=new L,n=K().pg_wrapper.value;a.add(await n.methods.close().accountsPartial({wrapper:(r=s().wrapperSelected)==null?void 0:r.publicKey,signer:U(),mintUnwrapped:(l=s().wrapperSelected)==null?void 0:l.account.mintUnwrapped,tokenProgram:Q}).instruction()),await N(a,"[Wrapper] Close"),await s().updateStore()}catch(a){console.error(a),u.notify({message:a.message,type:"negative"})}}return(r,l)=>(g(),V(M,{disable:h.disabled,square:"",color:"primary",label:"Close WrapperInterface",onClick:l[0]||(l[0]=a=>d())},null,8,["disable"]))}}),Ct={class:"row items-center"},qt=t("div",{class:"col text-subtitle1"},"Allow wrap",-1),Pt={class:"row items-center"},Tt=t("div",{class:"col text-subtitle1"},"Allow unwrap",-1),It={class:"row items-center"},Qt=t("div",{class:"col text-subtitle1"},"Only admin can Wrap",-1),Kt={class:"row items-center"},Mt=t("div",{class:"col text-subtitle1"},"Only admin can unwrap",-1),Lt={class:"row items-center"},Nt=t("div",{class:"col text-subtitle1"},"Use whitelist",-1),Bt={class:"row items-center"},Ot=t("div",{class:"col text-subtitle1"},"Use Limit",-1),Rt={class:"row items-center"},Et=t("div",{class:"col text-subtitle1"},"Change Admin",-1),Gt={class:"row items-center"},jt=t("div",{class:"col text-subtitle1"},"Change Ratio",-1),zt={key:0,style:{width:"500px"},class:"row items-center"},Dt=k({__name:"WrapperSettings",setup(h){var f;const u=T();(f=s().wrapperSelected)==null||f.account;const d=w(),r=w(),l=w(),a=w(),n=w(),o=w(),p=w(),m=w(),b=w(!1),$=w(),A=w(!1),j=w(),z=w();ae(),te(()=>{var i,v;return(v=(i=s())==null?void 0:i.wrapperSelected)==null?void 0:v.account},()=>{ae()});function ae(){var v,y;if(!((v=s().wrapperSelected)!=null&&v.account))return;const i=(y=s().wrapperSelected)==null?void 0:y.account;d.value=i.allowWrap,r.value=i==null?void 0:i.allowUnwrap,l.value=i==null?void 0:i.onlyAdminCanWrap,a.value=i==null?void 0:i.onlyAdminCanUnwrap,n.value=i==null?void 0:i.useWhitelist,o.value=i==null?void 0:i.whitelist,p.value=i==null?void 0:i.useLimit,m.value=(i==null?void 0:i.limitAmountUnwrapped)??0,$.value=i==null?void 0:i.admin,j.value=i==null?void 0:i.ratio[0],z.value=i==null?void 0:i.ratio[1]}async function B(){var i,v;try{const y=new L,R=K().pg_wrapper.value,pe={allowWrap:d.value,allowUnwrap:r.value,onlyAdminCanWrap:l.value,onlyAdminCanUnwrap:a.value,useWhitelist:n.value,whitelistAddress:n.value?new O(o.value):null,useLimit:p.value,amountAbleToWrap:p.value?de(m.value,D().tokenList.find(le=>{var J,oe;return le.address==((oe=(J=s().wrapperSelected)==null?void 0:J.account)==null?void 0:oe.mintUnwrapped.toString())}).decimals):null,admin:b.value?new O($.value):null,ratio:A.value?[new H(j.value),new H(z.value)]:null};y.add(await R.methods.edit(pe).accountsPartial({wrapper:(i=s().wrapperSelected)==null?void 0:i.publicKey,signer:U(),mintUnwrapped:(v=s().wrapperSelected)==null?void 0:v.account.mintUnwrapped,whitelist:null,tokenProgram:Q}).instruction()),await N(y),await s().updateStore()}catch(y){console.error(y),u.notify({message:y.message,type:"negative"})}}return(i,v)=>(g(),V(P,{flat:""},{default:c(()=>[e(x,{class:"q-gutter-y-sm"},{default:c(()=>[t("div",Ct,[qt,e(E,{modelValue:d.value,"onUpdate:modelValue":v[0]||(v[0]=y=>d.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",Pt,[Tt,e(E,{modelValue:r.value,"onUpdate:modelValue":v[1]||(v[1]=y=>r.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",It,[Qt,e(E,{modelValue:l.value,"onUpdate:modelValue":v[2]||(v[2]=y=>l.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",Kt,[Mt,e(E,{modelValue:a.value,"onUpdate:modelValue":v[3]||(v[3]=y=>a.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",Lt,[Nt,n.value?(g(),V(W,{key:0,dense:"",filled:"",square:"",style:{width:"500px"},modelValue:o.value,"onUpdate:modelValue":v[4]||(v[4]=y=>o.value=y),type:"text",label:"Whitelist"},null,8,["modelValue"])):q("",!0),e(E,{modelValue:n.value,"onUpdate:modelValue":v[5]||(v[5]=y=>n.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",Bt,[Ot,p.value?(g(),V(W,{key:0,dense:"",filled:"",square:"",style:{width:"500px"},modelValue:m.value,"onUpdate:modelValue":v[6]||(v[6]=y=>m.value=y),type:"number",label:"Amount wrappable"},null,8,["modelValue"])):q("",!0),e(E,{modelValue:p.value,"onUpdate:modelValue":v[7]||(v[7]=y=>p.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])]),t("div",null,[t("div",Rt,[Et,b.value?(g(),V(W,{key:0,style:{width:"500px"},dense:"",filled:"",square:"",label:"Admin",modelValue:$.value,"onUpdate:modelValue":v[8]||(v[8]=y=>$.value=y)},null,8,["modelValue"])):q("",!0),e(E,{modelValue:b.value,"onUpdate:modelValue":v[9]||(v[9]=y=>b.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])])]),t("div",null,[t("div",Gt,[jt,A.value?(g(),C("div",zt,[e(W,{class:"col",dense:"",filled:"",square:"",label:"Unwrapped",modelValue:j.value,"onUpdate:modelValue":v[10]||(v[10]=y=>j.value=y),type:"number"},null,8,["modelValue"]),e(ce,{size:"md",name:"swap_horiz"}),e(W,{class:"col",dense:"",filled:"",square:"",label:"Wrapped",modelValue:z.value,"onUpdate:modelValue":v[11]||(v[11]=y=>z.value=y),type:"number"},null,8,["modelValue"])])):q("",!0),e(E,{modelValue:A.value,"onUpdate:modelValue":v[12]||(v[12]=y=>A.value=y),"checked-icon":"check",color:"primary","unchecked-icon":"clear"},null,8,["modelValue"])])])]),_:1}),e(x,{class:"row justify-end"},{default:c(()=>[e(M,{square:"",class:"",color:"primary",label:"Update settings",onClick:v[13]||(v[13]=y=>B())})]),_:1})]),_:1}))}}),Ft=k({__name:"WrapperCreateVault",setup(h){const u=T(),d=w(!1);async function r(l){try{const a=new L,n=ge().pg_wrapper.value;a.add(await n.methods.createVault().accountsPartial({wrapper:new O(s().wrapperSelected.publicKey.toString()),signer:U(),mintUnwrapped:new O(s().wrapperSelected.account.mintUnwrapped.toString()),tokenProgram:Q}).instruction()),await N(a,"[Wrapper] create vault")}catch(a){console.error(a),u.notify({message:a.message,type:"negative"})}}return(l,a)=>{var n;return!d.value&&((n=_(s)().wrapperSelected)==null?void 0:n.publicKey)?(g(),V(M,{key:0,square:"",color:"primary",label:"Create Vault",onClick:a[0]||(a[0]=o=>r())})):q("",!0)}}}),Xt={class:"row"},Zt=t("div",{class:"col"},"Vault Balance",-1),Jt={class:"row"},Ht=t("div",{class:"col"},"Circ. Supply",-1),$e=k({__name:"WrapperVaultDonut",props:["wrapper"],setup(h){const u=h,d=w(0),r=w(0),l=w(0);async function a(){d.value=await n()??0,r.value=await o()??0,l.value=d.value*u.wrapper.account.ratio[1]/d.value*u.wrapper.account.ratio[1]*100}async function n(){return(await Y().connection.getTokenSupply(new O(u.wrapper.account.mintWrapped))).value.uiAmount}async function o(){let b=re(u.wrapper.publicKey,u.wrapper.account.mintUnwrapped);return(await Y().connection.getTokenAccountBalance(b)).value.uiAmount}xe(async()=>{await a()}),ke(()=>u.wrapper,async()=>await a());const p=Ve(()=>[l.value]),m=w({dataLabels:{enabled:!1},legend:{labels:{colors:"white"},show:!1,position:"left"},theme:{palette:"palette3"},labels:["Redeemable"]});return(b,$)=>{const A=We("apexchart");return g(),C(_e,null,[t("div",Xt,[Zt,e(ie,{class:"",number:r.value,decimals:4,"pad-start":10},null,8,["number"])]),t("div",Jt,[Ht,e(ie,{number:d.value,decimals:4,"pad-start":10},null,8,["number"])]),e(A,{height:"300px",type:"radialBar",options:m.value,series:p.value},null,8,["options","series"])],64)}}}),Yt={class:"text-subtitle2 row items-center"},ea=t("div",{class:"text-accent"}," I want to transfer tokens out of the vault to a new address ",-1),ta={class:"col"},aa={class:"row"},la=k({__name:"WrapperTransferVaultOut",setup(h){const u=T(),d=w(1),r=w("C6LnFVyc5Qj2LAPdkX5CyyEEga9ePPB6ZRuzGhirZnqX"),l=w(!1);async function a(){try{if(K()){const n=new L,o=K().pg_wrapper.value;n.add(await o.methods.transferVault(de(d.value,X().getAccountByMintPublicKey(s().wrapperSelected.account.mintUnwrapped).decimals)).accountsPartial({signer:U(),wrapper:s().wrapperSelected.publicKey,mintUnwrapped:s().wrapperSelected.account.mintUnwrapped,ataUnwrappedSigner:Z(new O(r.value).toString(),s().wrapperSelected.account.mintUnwrapped.toString()),tokenProgram:Q}).instruction()),await N(n,`[Wrapper] transfer to ${r.value}`),await s().updateStore()}}catch(n){console.error(n),u.notify({message:n.message,type:"negative"})}}return(n,o)=>(g(),V(P,{flat:""},{default:c(()=>[t("div",Yt,[e(fe,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=p=>l.value=p)},null,8,["modelValue"]),ea]),t("div",ta,[t("div",aa,[e(W,{class:"col",disable:!l.value,square:"",filled:"",modelValue:r.value,"onUpdate:modelValue":o[1]||(o[1]=p=>r.value=p),type:"text",label:"recipient"},null,8,["disable","modelValue"]),e(I,{vertical:""}),e(W,{disable:!l.value,square:"",filled:"",modelValue:d.value,"onUpdate:modelValue":o[2]||(o[2]=p=>d.value=p),type:"number",label:"Amount to transfer"},null,8,["disable","modelValue"]),e(M,{disable:!d.value||!r.value||!l.value,color:"primary",label:"Send",square:"",onClick:o[3]||(o[3]=p=>a())},null,8,["disable"])])])]),_:1}))}}),oa={class:"row items-center"},na=t("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),sa={class:"text-subtitle2"},ra={class:"row items-center"},ia=t("div",{class:"col text-subtitle1 text-weight-thin"},"Mint",-1),ca={class:"text-subtitle2"},ua={class:"row items-center"},da=t("div",{class:"col text-subtitle1 text-weight-thin"},"Unwrapped",-1),pa={class:"text-subtitle2"},ma={class:"row items-center"},wa=t("div",{class:"col text-subtitle1 text-weight-thin"},"Balance",-1),_a={class:"text-subtitle2"},va=k({__name:"WrapperVault",setup(h){T();const u=w(null),d=w(!1);r(),te(()=>{var l,a;return(a=(l=s())==null?void 0:l.wrapperSelected)==null?void 0:a.account},async()=>{await r()});async function r(){var l;u.value=(l=(await Y().connection.getParsedAccountInfo(re(s().wrapperSelected.publicKey,s().wrapperSelected.account.mintUnwrapped))).value)==null?void 0:l.data,u.value&&(d.value=!0)}return(l,a)=>(g(),V(P,{flat:""},{default:c(()=>[e(I),e(x,{class:"col"},{default:c(()=>{var n,o;return[t("div",oa,[na,t("div",sa,S(_(re)(_(s)().wrapperSelected.publicKey,_(s)().wrapperSelected.account.mintUnwrapped)),1)]),t("div",ra,[ia,t("div",ca,S((n=_(s)().wrapperSelected.account)==null?void 0:n.mintUnwrapped),1)]),t("div",ua,[da,t("div",pa,S(_(D)().getTokenByMintPublicKey(_(s)().wrapperSelected.account.mintUnwrapped).name),1)]),t("div",ma,[wa,t("div",_a,S((o=u.value)==null?void 0:o.parsed.info.tokenAmount.uiAmount),1)])]}),_:1}),e(x,null,{default:c(()=>[e($e,{wrapper:_(s)().wrapperSelected},null,8,["wrapper"])]),_:1}),e(x,{class:"q-gutter-y-md"},{default:c(()=>[d.value?q("",!0):(g(),V(Ft,{key:0,class:"full-width"})),e(la)]),_:1})]),_:1}))}}),fa=k({__name:"WrapperMetadataUpdate",props:["name","symbol","uri"],setup(h){const u=h,d=T();async function r(l){var a,n;try{const o=new L,p=ge().pg_wrapper.value,m={name:u.name,symbol:u.symbol,uri:u.uri};o.add(await p.methods.metadataUpdate(m).accountsPartial({wrapper:(a=s().wrapperSelected)==null?void 0:a.publicKey,signer:U(),metadata:ee(s().wrapperSelected.account.mintWrapped),mintUnwrapped:(n=s().wrapperSelected)==null?void 0:n.account.mintUnwrapped,tokenProgram:Q}).instruction()),await N(o,"[Wrapper] metadata update"),await s().updateStore()}catch(o){console.error(o),d.notify({message:o.message,type:"negative"})}}return(l,a)=>(g(),V(M,{square:"",color:"primary",label:"Apply Metadata",onClick:a[0]||(a[0]=n=>r())}))}}),ga=k({__name:"WrapperMetadataCreate",props:["name","symbol","uri"],setup(h){const u=h,d=T();async function r(l){var a,n;try{const o=new L,p=ge().pg_wrapper.value,m={name:u.name,symbol:u.symbol,uri:u.uri};o.add(await p.methods.metadataCreate(m).accountsPartial({wrapper:(a=s().wrapperSelected)==null?void 0:a.publicKey,signer:U(),metadata:ee(s().wrapperSelected.account.mintWrapped),mintUnwrapped:(n=s().wrapperSelected)==null?void 0:n.account.mintUnwrapped,tokenProgram:Q}).instruction()),await N(o,"[Wrapper] metadata create"),await s().updateStore()}catch(o){console.error(o),d.notify({message:o.message,type:"negative"})}}return(l,a)=>(g(),V(M,{square:"",color:"primary",label:"Create Metadata",onClick:a[0]||(a[0]=n=>r())}))}}),ba={class:"row items-center"},ya=t("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),ha={class:"text-subtitle2"},xa={class:"row"},Va=k({__name:"WrapperMetadata",setup(h){T();const u=w(""),d=w(""),r=w(""),l=w(),a=w(),n=w(!1);o(),te(()=>{var p,m;return(m=(p=s())==null?void 0:p.wrapperSelected)==null?void 0:m.account},async()=>{await o()});async function o(){l.value=await Y().connection.getAccountInfo(ee(s().wrapperSelected.account.mintWrapped)),a.value=Ie.deserializeMetadata(l.value),u.value=a.value.name,d.value=a.value.symbol,r.value=a.value.uri,l.value&&(n.value=!0)}return(p,m)=>(g(),V(P,{flat:""},{default:c(()=>[e(x,null,{default:c(()=>[t("div",ba,[ya,t("div",ha,S(_(ee)(_(s)().wrapperSelected.publicKey)),1)])]),_:1}),n.value?(g(),V(x,{key:0,class:"col"},{default:c(()=>[t("div",xa,[e(W,{square:"",label:"Name",filled:"",modelValue:u.value,"onUpdate:modelValue":m[0]||(m[0]=b=>u.value=b)},null,8,["modelValue"]),e(I,{vertical:""}),e(W,{square:"",label:"Symbol",filled:"",modelValue:d.value,"onUpdate:modelValue":m[1]||(m[1]=b=>d.value=b)},null,8,["modelValue"]),e(I,{vertical:""}),e(W,{square:"",label:"Image URI",class:"col",filled:"",modelValue:r.value,"onUpdate:modelValue":m[2]||(m[2]=b=>r.value=b)},null,8,["modelValue"]),e(fa,{name:u.value,symbol:d.value,uri:r.value},null,8,["name","symbol","uri"])])]),_:1})):(g(),V(x,{key:1,class:"row justify-end"},{default:c(()=>[e(ga,{name:u.value,symbol:d.value,uri:r.value},null,8,["name","symbol","uri"])]),_:1}))]),_:1}))}}),Sa=t("div",{class:"text-h5"},"WrapperInterface Factory",-1),$a=t("div",{class:"text-caption text-grey"}," Small plates, salads & sandwiches in an intimate setting. ",-1),Ua={class:"row q-gutter-x-md"},ka={class:"text-caption text-grey text-right"},Wa={class:"row"},Aa=t("div",{class:"text-h6 text-red-6 col"}," I know what im doing i want to close a wrapper ",-1),Ca=k({__name:"WrapperManage",setup(h){const u=w("select"),d=w(!1);return(r,l)=>(g(),V(P,{flat:"",bordered:""},{default:c(()=>[e(x,null,{default:c(()=>[Sa,$a]),_:1}),e(I),e(ue,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=a=>u.value=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[e(G,{name:"create",label:"Create"}),e(G,{name:"select",label:"Edit"}),e(G,{name:"close",label:"Close"})]),_:1},8,["modelValue"]),e(I),e(ve,{modelValue:u.value,"onUpdate:modelValue":l[4]||(l[4]=a=>u.value=a),animated:""},{default:c(()=>[e(F,{name:"create"},{default:c(()=>[e(ht)]),_:1}),e(F,{name:"select"},{default:c(()=>[e(P,{flat:""},{default:c(()=>{var a;return[e(x,null,{default:c(()=>[t("div",Ua,[e(se,{label:"Select a wrapper",class:"col",filled:"",modelValue:_(s)().wrapperSelected,"onUpdate:modelValue":l[1]||(l[1]=n=>_(s)().wrapperSelected=n),options:_(s)().wrapper,"option-label":n=>{var o,p;return"[Wrapped] "+(((o=_(D)().tokenList.find(m=>{var b,$;return m.address==(($=(b=n.account)==null?void 0:b.mintUnwrapped)==null?void 0:$.toString())}))==null?void 0:o.name)??((p=n.account)==null?void 0:p.mintUnwrapped.toString())??"")}},null,8,["modelValue","options","option-label"])]),t("div",ka," Total Found: "+S(_(s)().wrapper.length),1)]),_:1}),(a=_(s)().wrapperSelected)!=null&&a.account?(g(),V(x,{key:0,class:"row full-width"},{default:c(()=>[e(Pe,{bordered:"",class:"rounded-borders full-width"},{default:c(()=>[e(ne,{"expand-separator":"",class:"text-h5",icon:"info",label:"Info"},{default:c(()=>[e(Wt)]),_:1}),e(ne,{"expand-separator":"",class:"text-h5",icon:"settings",label:"Settings"},{default:c(()=>[e(Dt)]),_:1}),e(ne,{"expand-separator":"",class:"text-h5",icon:"note_add",label:"Metadata"},{default:c(()=>[e(Va)]),_:1}),e(ne,{"default-opened":"","expand-separator":"",class:"text-h5",icon:"inventory_2",label:"Vault"},{default:c(()=>[e(va)]),_:1})]),_:1})]),_:1})):q("",!0)]}),_:1})]),_:1}),e(F,{name:"close"},{default:c(()=>[e(P,{flat:""},{default:c(()=>{var a;return[e(x,null,{default:c(()=>[t("div",Wa,[e(se,{label:"Select a wrapper",class:"col",filled:"",modelValue:_(s)().wrapperSelected,"onUpdate:modelValue":l[2]||(l[2]=n=>_(s)().wrapperSelected=n),options:_(s)().wrapper,"option-label":n=>{var o,p;return"[Wrapped] "+(((o=_(D)().tokenList.find(m=>{var b,$;return m.address==(($=(b=n.account)==null?void 0:b.mintUnwrapped)==null?void 0:$.toString())}))==null?void 0:o.name)??((p=n.account)==null?void 0:p.mintUnwrapped.toString())??"")}},null,8,["modelValue","options","option-label"]),e(At,{disabled:!d.value},null,8,["disabled"])])]),_:1}),(a=_(s)().wrapperSelected)!=null&&a.account?(g(),V(x,{key:0,class:"row justify-between"})):q("",!0)]}),_:1}),e(x,{class:"row items-center"},{default:c(()=>[e(fe,{color:"red",modelValue:d.value,"onUpdate:modelValue":l[3]||(l[3]=a=>d.value=a)},null,8,["modelValue"]),Aa]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),qa=k({__name:"WrapperWrap",props:["wrapper"],setup(h){const u=T(),d=w(1),r=h;async function l(a){var n;try{const o=new L,p=K().pg_wrapper.value,m=r.wrapper,b=de(d.value,(n=X().getAccountByMintPublicKey(m==null?void 0:m.account.mintUnwrapped))==null?void 0:n.decimals);await Y().connection.getAccountInfo(Z(U().toString(),r.wrapper.account.mintWrapped.toString()))||o.add(Ne(U(),Z(U().toString(),r.wrapper.account.mintWrapped.toString()),U(),r.wrapper.account.mintWrapped,Q,Ae)),o.add(await p.methods.wrap(b).accountsPartial({signer:U(),wrapper:m.publicKey,mintUnwrapped:m.account.mintUnwrapped,signerUnwrapped:Z(U().toString(),m.account.mintUnwrapped.toString()),signerWrapped:Z(Se().publicKey.value.toString(),r.wrapper.account.mintWrapped.toString()),tokenProgram:Q,whitelist:null,whitelistEntry:null}).instruction()),await N(o,"[Wrapper] wrap tokens"),await s().updateStore()}catch(o){console.error(o),u.notify({message:o.message,type:"negative"})}}return(a,n)=>(g(),C("div",null,[e(W,{disable:!h.wrapper.account.allowWrap,filled:"",modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=o=>d.value=o)},null,8,["disable","modelValue"]),e(M,{disable:!h.wrapper.account.allowWrap,class:"full-width",color:"primary",label:"Wrap",onClick:n[1]||(n[1]=o=>l())},null,8,["disable"])]))}}),Pa=k({__name:"WrapperUnwrap",props:["wrapper"],setup(h){const u=T(),d=w(1),r=h;async function l(a){var n,o;try{const p=new L,m=K().pg_wrapper.value,b=r.wrapper,$=de(d.value,(n=X().getAccountByMintPublicKey(b==null?void 0:b.account.mintUnwrapped))==null?void 0:n.decimals);p.add(await m.methods.unwrap($).accountsPartial({signer:U(),wrapper:b.publicKey,mintUnwrapped:b.account.mintUnwrapped,signerUnwrapped:new O(((o=X().accounts.find(A=>A.mint.toString()==b.account.mintUnwrapped.toString()))==null?void 0:o.pubkey)??""),signerWrapped:Z(Se().publicKey.value.toString(),r.wrapper.account.mintWrapped.toString()),tokenProgram:Q,whitelist:null,whitelistEntry:null}).instruction()),await N(p,"[Wrapper] unwrap tokens"),await s().updateStore()}catch(p){console.error(p),u.notify({message:p.message,type:"negative"})}}return(a,n)=>(g(),C("div",null,[e(W,{disable:!h.wrapper.account.allowUnwrap,filled:"",modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=o=>d.value=o)},null,8,["disable","modelValue"]),e(M,{disable:!h.wrapper.account.allowUnwrap,class:"full-width",color:"primary",label:"Unwrap",onClick:n[1]||(n[1]=o=>l())},null,8,["disable"])]))}});const Ta={class:"q-pa-md"},Ia={class:"q-pa-xs col-xs-12 col-sm-6 col-md-3"},Qa={class:"row items-center"},Ka=t("div",{class:"col text-subtitle1 text-weight-thin"},"Group",-1),Ma={class:"text-subtitle2"},La={class:"row items-center"},Na=t("div",{class:"col text-subtitle1 text-weight-thin"},"Pair",-1),Ba={class:"text-subtitle2 row q-gutter-x-xs"},Oa=t("div",null,"/",-1),Ra={class:"row items-center"},Ea=t("div",{class:"col text-subtitle1 text-weight-thin"},"Wrappable",-1),Ga={class:"text-subtitle2"},ja={class:"row items-center"},za=t("div",{class:"col text-subtitle1 text-weight-thin"},"Address",-1),Da={class:"text-subtitle2"},Fa={class:"col text-center"},Xa={class:"col text-center"},Za=t("div",{class:"text-center text-subtitle2"},"Status",-1),Ja=t("div",null,null,-1),Ha={class:"row q-mb-md q-px-md"},Ya={class:"col-3 q-gutter-x-xs"},el=t("div",{class:"col text-center"},"Wallet Balance",-1),tl={class:"col-3 text-right q-gutter-x-xs"},al={class:"row q-gutter-x-md"},ll=k({__name:"WrapperTable",setup(h){const u=T();function d(){return u.screen.lt.sm?3:u.screen.lt.md?6:9}const r=w(""),l=w({page:1,rowsPerPage:d()});return te(()=>u.screen.name,()=>{l.value.rowsPerPage=d()}),Ve(()=>u.screen.gt.xs?u.screen.gt.sm?[3,6,9]:[3,6]:[3]),(a,n)=>(g(),C("div",Ta,[e(Me,{grid:"",rows:_(s)().wrapper,"row-key":"name",filter:r.value,"hide-header":"",pagination:l.value,"onUpdate:pagination":n[0]||(n[0]=o=>l.value=o),"rows-per-page-options":[0]},{item:c(o=>[t("div",Ia,[e(P,{flat:"",bordered:""},{default:c(()=>[e(x,{class:"text-center"},{default:c(()=>{var p;return[e(Qe,{height:"200px",src:((p=_(D)().tokenList.find(m=>{var b;return m.address==((b=o.row.account)==null?void 0:b.mintUnwrapped.toString())}))==null?void 0:p.logoURI)??_(Le)},null,8,["src"])]}),_:2},1024),e(x,null,{default:c(()=>{var p,m,b,$;return[t("div",Qa,[Ka,t("div",Ma,S(_(s)().groups.find(A=>A.publicKey.toString()==o.row.account.group.toString()).account.name),1)]),t("div",La,[Na,t("div",Ba,[t("div",null,S(_(D)().tokenList.find(A=>A.address==o.row.account.mintUnwrapped.toString()).symbol),1),Oa,t("div",null," W"+S(_(D)().tokenList.find(A=>A.address==o.row.account.mintUnwrapped.toString()).symbol),1)])]),t("div",Ra,[Ea,t("div",Ga,S((p=o.row)!=null&&p.account.useLimit?(m=o.row)==null?void 0:m.account.limitAmountUnwrapped:"\u221E"),1)]),t("div",ja,[za,t("div",Da,S(_(Ke)(($=(b=o.row)==null?void 0:b.publicKey)==null?void 0:$.toString())),1)])]}),_:2},1024),e(I),e(be,{class:"row text-h4"},{default:c(()=>[t("div",Fa,S(o.row.account.ratio[0]),1),e(ce,{size:"md",name:"swap_horiz"}),t("div",Xa,S(o.row.account.ratio[1]),1)]),_:2},1024),e(be,{class:"row"},{default:c(()=>[e(P,{class:"col q-mx-sm",flat:"",bordered:""},{default:c(()=>[e(x,null,{default:c(()=>[Za]),_:1}),e(I),Ja,e(x,null,{default:c(()=>[e($e,{mintWrapped:o.row.account.mintWrapped.toString(),mintUnwrapped:o.row.account.mintUnwrapped.toString(),wrapper:o.row},null,8,["mintWrapped","mintUnwrapped","wrapper"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(x,{class:"col"},{default:c(()=>{var p,m;return[t("div",Ha,[t("div",Ya,[e(ie,{class:"",number:(p=_(X)().getAccountByMintPublicKey(o.row.account.mintUnwrapped))==null?void 0:p.uiAmount,decimals:4,"pad-start":10},null,8,["number"])]),el,t("div",tl,[e(ie,{class:"",number:(m=_(X)().getAccountByMintPublicKey(o.row.account.mintWrapped))==null?void 0:m.uiAmount,decimals:4,"pad-start":10},null,8,["number"])])]),t("div",al,[e(qa,{class:"col",wrapper:o.row},null,8,["wrapper"]),e(Pa,{class:"col",wrapper:o.row},null,8,["wrapper"])])]}),_:2},1024)]),_:2},1024)])]),_:1},8,["rows","filter","pagination"])]))}}),ol=t("div",{class:"col text-h6"},"WrapperInterface",-1),nl={class:"row"},Il=k({__name:"WrapperPage",setup(h){const u=w("wrapping");return s(),xe(async()=>{K()||Ce(),await s().updateStore()}),(d,r)=>(g(),V(qe,{class:"bg-black"},{default:c(()=>[e(P,null,{default:c(()=>[e(x,{class:"row items-center q-gutter-x-md"},{default:c(()=>[e(ce,{name:"inventory_2",size:"md"}),ol]),_:1}),e(I),e(ue,{modelValue:u.value,"onUpdate:modelValue":r[0]||(r[0]=l=>u.value=l),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:c(()=>[e(G,{name:"wrapping",label:"Wrap / Unwrap"}),e(G,{name:"manage",label:"Manage"})]),_:1},8,["modelValue"]),e(I),e(ve,{modelValue:u.value,"onUpdate:modelValue":r[2]||(r[2]=l=>u.value=l),animated:""},{default:c(()=>[e(F,{name:"wrapping"},{default:c(()=>[t("div",nl,[e(we,{class:"col"}),e(M,{square:"",color:"primary",label:"reload",onClick:r[1]||(r[1]=()=>{_(s)().updateStore()})})]),e(P,{flat:""},{default:c(()=>[e(x,null,{default:c(()=>[e(ll)]),_:1})]),_:1})]),_:1}),e(F,{name:"manage",class:"row q-gutter-x-md"},{default:c(()=>{var l;return[e(it,{class:"col-3"}),(l=_(s)().groupSelected)!=null&&l.account?(g(),V(Ca,{key:0,class:"col"})):q("",!0)]}),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}))}});export{Il as default};
