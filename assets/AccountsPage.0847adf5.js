import{a as Q,Q as G}from"./QTabs.2d54f4b2.js";import{Q as $}from"./QSpace.b1c7f2b7.js";import{u as A,Q as _e}from"./globalWallet.253a07e9.js";import{a as H,Q as be}from"./QTabPanels.58ff1b55.js";import{Q as we}from"./QPage.a6a97328.js";import{Q as K,a as J}from"./QInput.a46bd7b9.js";import{au as k,J as w,bs as R,b1 as v,ak as h,a1 as _,dg as ve,P as u,aX as W,cN as b,al as r,as as t,ck as y,bx as a,a6 as D,bZ as ee,ah as te,aF as I,cg as F,aC as ge,ai as p,cm as j,V as q,dt as U,bz as ae,d9 as M,cn as P,dc as N,ar as g,e2 as z,e3 as ye,di as Z,e4 as X,aj as S,Z as ne}from"./index.83a77d2b.js";import{Q as ke}from"./QTree.b12867e1.js";import{d as V}from"./index.9aaa7628.js";import{t as pe}from"./token.b11d8f01.js";import{g as x}from"./extensionType.565ab7c5.js";import{c as le,Q as oe}from"./QSelect.76388295.js";import{f as Ae,a as se}from"./format_address.ffec8bff.js";import{Q as ie,a as ue}from"./QToolbar.d96dca86.js";import{Q as re}from"./QCard.b2c77731.js";import{C as ce}from"./ClosePopup.0fdb8bc3.js";import{h as O}from"./handle_confirmation.f79edca2.js";import{c as he,a as Se,b as Y}from"./transfer.e55079a4.js";import{c as Te}from"./associatedTokenAccount.318c78cb.js";import"./rtl.d60794d2.js";import"./assert.8d022599.js";import"./index.01382230.js";import"./touch.3df10340.js";import"./QSlideTransition.8bca4d8f.js";import"./use-checkbox.9f2a4048.js";import"./sha256.d6e3af27.js";import"./defineProperty.034d6b40.js";import"./errors.0f021fd2.js";import"./QSeparator.d6f41f82.js";import"./QList.0405a8dd.js";import"./internal.ea25ba5b.js";const qe={class:"text-overline"},C="ATLocKpzDbTokxgvnLew3d7drZkEzLzDpzwgrgWKDbmc",B="ATLkZsBofSKG845dNFpNoUyMciGpeH29BCbMqYFUoxzU",E="poLisWXnNRwC6oBu1vHiuKQzFjGL4XDSu4g9qjz9qVk",xe=k({__name:"AccountTemplate",props:["count","function_name","publicKey","mint","program"],setup(i){const l=i,o=w("[empty]");async function d(){switch(l.function_name){case"getRegisteredStake":{const[c]=await V.getRegisteredStake(new u(C),new u(B),new u(l.mint),new u(E));o.value=c}break;case"getStakingAccount":{const[c]=await V.getRegisteredStake(new u(C),new u(B),new u(l.mint),new u(E)),[s]=await V.getStakingAccount(new u(C),new u(l.publicKey),c);o.value=s}break;case"getTokenEscrow":{const[c]=await V.getRegisteredStake(new u(C),new u(B),new u(l.mint),new u(E)),[s]=await V.getStakingAccount(new u(C),new u(l.publicKey),c);o.value=await x(new u(l.mint),s,!0)}break;case"getAssociatedTokenAddress(mint)":o.value=await x(new u(l.mint),new u(l.publicKey),!0,ve,pe.ASSOCIATED_PROGRAM_ID);break;default:o.value="No function called";break}}return R(()=>l.count,async()=>{await d()}),(c,s)=>(v(),h("div",qe,_(o.value),1))}}),Ve={class:"row shadow-3 q-pa-md"},Ce={class:"col"},Qe={class:"row items-center text-h6"},$e={class:"text-primary"},Ke={class:"row items-center"},Pe={class:"text-weight-bold"},Re=k({__name:"AccountSolana",setup(i){const l=w(0),o=w("none"),d=w("ATLASXmbPQxBUYbxPsV97usA3fPQYEqzQBUHgiFCUsXx"),c=w([{label:"Solana",header:"root",children:[{label:"Tokens",header:"generic",children:[{label:"getAssociatedTokenAddress() by mint",function_name:"getAssociatedTokenAddress(mint)",header:"generic",body:"story"}]}]},{label:"StarAtlas-Factory",header:"root",children:[{label:"Staking (Atlas/Polis)",icon:"restaurant_menu",header:"generic",children:[{label:"getRegisteredStake()",function_name:"getRegisteredStake",header:"generic",body:"story"},{label:"getStakingAccount()",function_name:"getStakingAccount",body:"story"},{label:"getTokenEscrow()",function_name:"getTokenEscrow",body:"story"}]}]}]);W(()=>{var e;o.value=((e=b().publicKey.value)==null?void 0:e.toString())??"none"});const s=()=>{l.value++};return R(()=>b().publicKey.value,()=>{var e;o.value=((e=b().publicKey.value)==null?void 0:e.toString())??"none"}),(e,n)=>(v(),h(D,null,[r("div",Ve,[r("div",Ce,[t(K,{class:"col",modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=m=>o.value=m),label:"Wallet Address"},null,8,["modelValue"]),t(K,{class:"col",modelValue:d.value,"onUpdate:modelValue":n[1]||(n[1]=m=>d.value=m),label:"Token Mint"},null,8,["modelValue"])]),t(y,{color:"primary",icon:"send",class:"q-ml-xl",onClick:s})]),t(ke,{color:"primary",dark:"",nodes:c.value,"node-key":"label",class:"q-pt-md"},{"header-root":a(m=>[r("div",Qe,[r("div",$e,_(m.node.label),1)])]),"default-header":a(m=>[r("div",Ke,[r("div",Pe,_(m.node.label),1)])]),"body-story":a(m=>[t(xe,{count:l.value,function_name:m.node.function_name,"public-key":o.value,mint:d.value},null,8,["count","function_name","public-key","mint"])]),_:1},8,["nodes"])],64))}});var f=ee({name:"QTd",props:{props:Object,autoWidth:Boolean,noHover:Boolean},setup(i,{slots:l}){const o=ge(),d=te(()=>"q-td"+(i.autoWidth===!0?" q-table--col-auto-width":"")+(i.noHover===!0?" q-td--no-hover":"")+" ");return()=>{if(i.props===void 0)return I("td",{class:d.value},F(l.default));const c=o.vnode.key,s=(i.props.colsMap!==void 0?i.props.colsMap[c]:null)||i.props.col;if(s===void 0)return;const{row:e}=i.props;return I("td",{class:d.value+s.__tdClass(e),style:s.__tdStyle(e)},F(l.default))}}}),de=ee({name:"QTr",props:{props:Object,noHover:Boolean},setup(i,{slots:l}){const o=te(()=>"q-tr"+(i.props===void 0||i.props.header===!0?"":" "+i.props.__trClass)+(i.noHover===!0?" q-tr--no-hover":""));return()=>I("tr",{class:o.value},F(l.default))}});const T=k({__name:"SolscanLink",props:["address"],setup(i){return(l,o)=>(v(),p(y,{square:"",flat:"",color:"secondary",size:"sm",icon:"link",target:"_blank",href:"https://solscan.io/account/"+i.address},{default:a(()=>[t(j),r("div",null,_(q(Ae)(i.address)),1)]),_:1},8,["href"]))}}),Ue=r("span",{class:"text-weight-bold"},"Send Token",-1),Le={class:"text-overline"},ze={class:"row"},me=k({__name:"SendTokenButton",props:["mint","decimals"],setup(i){const l=w(!1),o=i,d=w("6AzZCoxBrJnfWejYZmqcdKUvzdG6yTbRLyuqVYizHWy4"),c=w(0);async function s(){const e=new M,n=await x(new u(o.mint),new u(d.value));console.log(n);const m=await x(new u(o.mint),b().publicKey.value);await P().connection.getAccountInfo(n)===null&&e.add(Te(b().publicKey.value,n,new u(d.value),new u(o.mint))),e.add(he(m,n,b().publicKey.value,c.value*Math.pow(10,o.decimals)));try{const L=await b().sendTransaction(e,P().connection);await O(L)}catch(L){N.create({color:"red",message:`${L}`,timeout:5e3})}}return(e,n)=>(v(),h(D,null,[t(y,{square:"",color:"primary",size:"sm",icon:"send",onClick:n[0]||(n[0]=m=>l.value=!0)}),t(le,{modelValue:l.value,"onUpdate:modelValue":n[4]||(n[4]=m=>l.value=m)},{default:a(()=>[t(re,null,{default:a(()=>[t(ie,{class:"q-mt-md"},{default:a(()=>[t(U,null,{default:a(()=>[t(j,{name:"send"})]),_:1}),t(ue,null,{default:a(()=>[Ue,r("div",Le,_(i.mint),1)]),_:1}),ae(t(y,{flat:"",round:"",dense:"",icon:"close"},null,512),[[ce]])]),_:1}),t(J,{class:"q-gutter-y-sm"},{default:a(()=>[r("div",null,[t(K,{filled:"",square:"",label:"Receiver",modelValue:d.value,"onUpdate:modelValue":n[1]||(n[1]=m=>d.value=m)},null,8,["modelValue"])]),r("div",ze,[t(K,{filled:"",square:"",class:"col",label:"Amount",modelValue:c.value,"onUpdate:modelValue":n[2]||(n[2]=m=>c.value=m)},null,8,["modelValue"]),t(y,{square:"",color:"primary",icon:"send",onClick:n[3]||(n[3]=m=>s())})])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}}),Be=r("span",{class:"text-weight-bold"},"Close/Burn Account",-1),Ee={class:"text-overline"},Ie=r("div",{class:"row q-gutter-x-sm"},[r("div",{class:""},"Closing Token-Accounts will recover the fee!")],-1),Fe={class:"row q-gutter-x-sm"},Me=r("div",{class:""},"Amount left:",-1),Ne={class:""},Oe={class:"q-ma-md text-right text-weight-light"},fe=k({__name:"EditTokenButton",props:["mint","decimals","amount"],setup(i){const l=w(!1),o=i;w(""),w(0);async function d(){const s=new M,e=await x(new u(o.mint),b().publicKey.value);s.add(Se(e,new u(o.mint),b().publicKey.value,o.amount*Math.pow(10,o.decimals))),s.add(Y(e,b().publicKey.value,b().publicKey.value)),s.add(Z.transfer({fromPubkey:b().publicKey.value,toPubkey:new u(X),lamports:z}));try{const n=await b().sendTransaction(s,P().connection);await O(n)}catch(n){N.create({color:"red",message:`${n}`,timeout:5e3})}}async function c(){const s=new M,e=await x(new u(o.mint),b().publicKey.value);s.add(Y(e,b().publicKey.value,b().publicKey.value)),s.add(Z.transfer({fromPubkey:b().publicKey.value,toPubkey:new u(X),lamports:z}));try{const n=await b().sendTransaction(s,P().connection);await O(n)}catch(n){N.create({color:"red",message:`${n}`,timeout:5e3})}}return(s,e)=>(v(),h(D,null,[t(y,{flat:"",square:"",color:"primary",size:"sm",icon:"edit",onClick:e[0]||(e[0]=n=>l.value=!0)}),t(le,{modelValue:l.value,"onUpdate:modelValue":e[3]||(e[3]=n=>l.value=n)},{default:a(()=>[t(re,null,{default:a(()=>[t(ie,{class:"q-mt-md"},{default:a(()=>[t(U,null,{default:a(()=>[t(j,{name:"edit"})]),_:1}),t(ue,null,{default:a(()=>[Be,r("div",Ee,_(i.mint),1)]),_:1}),ae(t(y,{flat:"",round:"",dense:"",icon:"close"},null,512),[[ce]])]),_:1}),t(J,{class:"q-gutter-y-md col justify-around"},{default:a(()=>[Ie,r("div",Fe,[Me,r("div",Ne,_(i.amount),1)]),t(y,{square:"",disabled:i.amount==0,class:"full-width",color:"red",onClick:e[1]||(e[1]=n=>d())},{default:a(()=>[g(" Burn and close Account ")]),_:1},8,["disabled"]),t(y,{square:"",flat:"",disabled:i.amount>0,class:"full-width",color:"orange",onClick:e[2]||(e[2]=n=>c())},{default:a(()=>[g(" Close Account")]),_:1},8,["disabled"])]),_:1}),r("div",Oe," service-fee: "+_(q(z)/q(ye))+"sol ",1)]),_:1})]),_:1},8,["modelValue"])],64))}}),We=r("div",{class:"col-2 q-table__title"},"Accounts",-1),De=["src"],je=k({__name:"AccountWalletAccountsToken",setup(i){w();const l=w(["account","amount","mint","action"]),o=[{name:"image",label:"Image",align:"left",required:!0},{name:"name",label:"Name",align:"left",sortable:!0,required:!0},{name:"account",label:"Account",align:"left",sortable:!0},{name:"mint",label:"Mint",align:"left",sortable:!0},{name:"owner",align:"left",label:"Owner",sortable:!0},{name:"state",align:"center",label:"State",sortable:!0},{name:"space",label:"Space",sortable:!0},{name:"lamports",label:"Lamports",sortable:!0},{name:"decimals",label:"Decimals",sortable:!0},{name:"amount",label:"Amount",align:"right",sortable:!0},{label:"",align:"right",name:"action"}];W(async()=>{await A().update_accounts()}),R(()=>b().publicKey.value,async()=>{await A().update_accounts()});const d=w({rowsPerPage:0});return(c,s)=>(v(),h("div",null,[t(se,{color:"primary",dark:"",flat:"",square:"","virtual-scroll":"",pagination:d.value,"onUpdate:pagination":s[1]||(s[1]=e=>d.value=e),"rows-per-page-options":[0],"visible-columns":l.value,title:"Accounts",rows:q(A)().get_account_map,columns:o,"row-key":"name"},{top:a(e=>[We,t($),t(oe,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=n=>l.value=n),multiple:"",borderless:"",dense:"","options-dense":"","display-value":c.$q.lang.table.columns,"emit-value":"","map-options":"",options:o,"option-value":"name",style:{"min-width":"150px"}},null,8,["modelValue","display-value"]),t(y,{flat:"",round:"",dense:"",icon:e.inFullscreen?"fullscreen_exit":"fullscreen",onClick:e.toggleFullscreen,class:"q-ml-md"},null,8,["icon","onClick"])]),body:a(e=>[t(de,{props:e},{default:a(()=>[t(f,{key:"image",props:e},{default:a(()=>{var n;return[(n=e.row.meta)!=null&&n.logoURI?(v(),p(U,{key:0,color:"",size:"sm"},{default:a(()=>{var m;return[r("img",{src:(m=e.row.meta)==null?void 0:m.logoURI},null,8,De)]}),_:2},1024)):S("",!0)]}),_:2},1032,["props"]),t(f,{key:"name",props:e},{default:a(()=>{var n;return[g(_(((n=e.row.meta)==null?void 0:n.name)??"-"),1)]}),_:2},1032,["props"]),t(f,{key:"account",props:e},{default:a(()=>[t(T,{address:e.row.pubkey},null,8,["address"])]),_:2},1032,["props"]),t(f,{key:"mint",props:e,class:""},{default:a(()=>[t(T,{address:e.row.info.mint},null,8,["address"])]),_:2},1032,["props"]),t(f,{key:"owner",props:e},{default:a(()=>[t(T,{address:e.row.info.owner},null,8,["address"])]),_:2},1032,["props"]),t(f,{key:"state",props:e},{default:a(()=>[g(_(e.row.account.account.data.parsed.info.state),1)]),_:2},1032,["props"]),t(f,{key:"space",props:e},{default:a(()=>[g(_(e.row.account.account.space),1)]),_:2},1032,["props"]),t(f,{key:"lamports",props:e},{default:a(()=>[g(_(e.row.account.account.lamports),1)]),_:2},1032,["props"]),t(f,{key:"decimals",props:e},{default:a(()=>[g(_(e.row.info.tokenAmount.decimals),1)]),_:2},1032,["props"]),t(f,{key:"amount",class:"text-overline",props:e},{default:a(()=>[r("div",{class:ne(e.row.info.tokenAmount.uiAmount>0?"text-white":"text-secondary")},_(e.row.info.tokenAmount.uiAmount.toFixed(2)),3)]),_:2},1032,["props"]),t(f,{key:"action",props:e,class:"q-gutter-x-sm"},{default:a(()=>[t(fe,{amount:e.row.info.tokenAmount.uiAmount,mint:e.row.info.mint,decimals:e.row.info.tokenAmount.decimals},null,8,["amount","mint","decimals"]),t(me,{mint:e.row.info.mint,decimals:e.row.info.tokenAmount.decimals},null,8,["mint","decimals"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["pagination","visible-columns","rows"])]))}}),Ge=r("div",{class:"col-2 q-table__title"},"Accounts",-1),He=["src"],Ze=k({__name:"AccountWalletAccountsNft",setup(i){w();const l=w(["account","amount","mint","action"]),o=[{name:"name",label:"Name",align:"left",sortable:!0,required:!0},{name:"symbol",label:"Symbol",align:"left",sortable:!0,required:!0},{name:"account",label:"Account",align:"left",sortable:!0},{name:"mint",label:"Mint",align:"left",sortable:!0},{name:"owner",align:"left",label:"Owner",sortable:!0},{name:"state",align:"center",label:"State",sortable:!0},{name:"space",label:"Space",sortable:!0},{name:"lamports",label:"Lamports",sortable:!0},{name:"decimals",label:"Decimals",sortable:!0},{name:"amount",label:"Amount",sortable:!0},{label:"",align:"right",name:"action"}];W(async()=>{await A().update_accounts_nft()}),R(()=>b().publicKey.value,async()=>{await A().update_accounts_nft()});const d=w({rowsPerPage:0});return(c,s)=>(v(),h("div",null,[t(se,{color:"primary",dark:"",flat:"",square:"","virtual-scroll":"",pagination:d.value,"onUpdate:pagination":s[1]||(s[1]=e=>d.value=e),"rows-per-page-options":[0],"visible-columns":l.value,title:"Accounts",rows:q(A)().nft_map,columns:o,"row-key":"name"},{top:a(e=>[Ge,t($),t(oe,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=n=>l.value=n),multiple:"",borderless:"",dense:"","options-dense":"","display-value":c.$q.lang.table.columns,"emit-value":"","map-options":"",options:o,"option-value":"name",style:{"min-width":"150px"}},null,8,["modelValue","display-value"]),t(y,{flat:"",round:"",dense:"",icon:e.inFullscreen?"fullscreen_exit":"fullscreen",onClick:e.toggleFullscreen,class:"q-ml-md"},null,8,["icon","onClick"])]),body:a(e=>[t(de,{props:e},{default:a(()=>[t(f,{key:"name",props:e,class:"row items-center"},{default:a(()=>{var n;return[e.row.meta.data.uri&&e.row.data?(v(),p(U,{key:0,color:"",size:"sm",class:"q-mr-sm"},{default:a(()=>[r("img",{src:e.row.data.image??"none"},null,8,He)]),_:2},1024)):S("",!0),r("div",null,_(((n=e.row.meta.data)==null?void 0:n.name)||e.row.data.name),1)]}),_:2},1032,["props"]),t(f,{key:"symbol",props:e},{default:a(()=>[g(_(e.row.meta.data.symbol||e.row.data.symbol),1)]),_:2},1032,["props"]),t(f,{key:"account",props:e},{default:a(()=>[t(T,{address:e.row.pubkey},null,8,["address"])]),_:2},1032,["props"]),t(f,{key:"mint",props:e,class:""},{default:a(()=>[t(T,{address:e.row.meta.mint},null,8,["address"])]),_:2},1032,["props"]),t(f,{key:"owner",props:e},{default:a(()=>[t(T,{address:e.row.info.owner},null,8,["address"])]),_:2},1032,["props"]),t(f,{key:"state",props:e},{default:a(()=>[g(_(e.row.account.account.data.parsed.info.state),1)]),_:2},1032,["props"]),t(f,{key:"space",props:e},{default:a(()=>[g(_(e.row.account.account.space),1)]),_:2},1032,["props"]),t(f,{key:"lamports",props:e},{default:a(()=>[g(_(e.row.account.account.lamports),1)]),_:2},1032,["props"]),t(f,{key:"decimals",props:e},{default:a(()=>[g(_(e.row.info.tokenAmount.decimals),1)]),_:2},1032,["props"]),t(f,{key:"amount",class:"text-overline",props:e},{default:a(()=>[r("div",{class:ne(e.row.info.tokenAmount.uiAmount>0?"text-white":"text-yellow")},_(e.row.info.tokenAmount.uiAmount.toFixed(2)),3)]),_:2},1032,["props"]),t(f,{key:"action",props:e,class:"q-gutter-x-sm"},{default:a(()=>[t(fe,{amount:e.row.info.tokenAmount.uiAmount,mint:e.row.info.mint,decimals:e.row.info.tokenAmount.decimals},null,8,["amount","mint","decimals"]),t(me,{mint:e.row.info.mint,decimals:e.row.info.tokenAmount.decimals},null,8,["mint","decimals"])]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["pagination","visible-columns","rows"])]))}}),Xe={class:"col shadow-1 bg-dark"},Ye={class:"row"},Je=r("div",{class:"col"},null,-1),et={key:0,class:"row"},Pt=k({__name:"AccountsPage",setup(i){w();const l=w("wallet"),o=w("token");return(d,c)=>(v(),p(we,{class:"col items-center justify-evenly"},{default:a(()=>[r("div",Xe,[t(G,{"no-caps":"","outside-arrows":"","mobile-arrows":"",modelValue:l.value,"onUpdate:modelValue":c[0]||(c[0]=s=>l.value=s),align:"justify"},{default:a(()=>[t(Q,{name:"wallet",label:"Wallet"}),t(Q,{name:"solana",label:"Solana"})]),_:1},8,["modelValue"]),r("div",Ye,[l.value=="wallet"?(v(),p(G,{key:0,class:"col","mobile-arrows":"",modelValue:o.value,"onUpdate:modelValue":c[1]||(c[1]=s=>o.value=s),align:"justify"},{default:a(()=>[t(Q,{name:"token",label:"Token"}),t(Q,{name:"nft",label:"NFT"})]),_:1},8,["modelValue"])):S("",!0),Je])]),t(be,{dark:"",modelValue:l.value,"onUpdate:modelValue":c[2]||(c[2]=s=>l.value=s),animated:"",class:"q-ma-md"},{default:a(()=>[t(H,{name:"wallet"},{default:a(()=>[q(A)().is_loading?(v(),h("div",et,[t($),t(_e,{class:"row",color:"primary",size:"3rem"}),t($)])):S("",!0),o.value=="token"?(v(),p(je,{key:1})):S("",!0),o.value=="nft"?(v(),p(Ze,{key:2})):S("",!0)]),_:1}),t(H,{name:"solana",class:"q-gutter-md"},{default:a(()=>[t(Re)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{Pt as default};
