import{aF as C,bZ as Bn,d7 as Za,d8 as ec,cg as hs,c0 as tc,cm as Oi,aC as Xn,ah as H,J as An,bs as Kt,aS as Ni,aX as Li,aR as nc,aV as rc,aT as xi,c2 as ii,ce as Ki,cI as sc,cJ as ic,cD as oc,cL as oi,d9 as gs,da as ai,db as ac,aQ as zi,dc as cc,cy as $n,ck as _r,bX as z,dd as Lr,de as Ie,df as As,dg as M,dh as Cn,di as V,dj as xe,dk as W,dl as $,dm as rt,dn as ue,dp as Ke,dq as un,dr as Qn,ds as T,dt as Is,du as Rs,dv as ke,dw as Zn,dx as R,dy as m,dz as K,dA as x,dB as G,dC as yt,dD as Ui,dE as Ge,dF as B,dG as ut,dH as Ps,dI as pe,cX as ci,dJ as ui,dK as uc,dL as On,dM as lc,dN as Mi,dO as li,dP as dc,dQ as fc,dR as hc,dS as gc,bW as yc,P as Wi,dT as bc,cp as pc,cq as kr,cn as Sr,a as mc}from"./index.a7087e37.js";import{Q as wc}from"./QSeparator.86315e67.js";import{Q as _c}from"./QList.07fc55b3.js";import{u as Ts,a as Es}from"./use-key-composition.4a3c6082.js";import{d as kc,e as Sc,f as $i,Q as vc}from"./QSelect.fa3185bc.js";import{g as Ac}from"./ClosePopup.d175a44c.js";import{Q as rs}from"./QSlideTransition.9cf2db83.js";import{a as Ic}from"./assert.cc5be821.js";import{a as Rc}from"./index.5159beae.js";import{T as Pc}from"./constants.5727eee4.js";const Tc=[C("rect",{x:"0",y:"0",width:"100",height:"100",fill:"none"}),C("g",{transform:"translate(25 25)"},[C("rect",{x:"-20",y:"-20",width:"40",height:"40",fill:"currentColor",opacity:"0.9"},[C("animateTransform",{attributeName:"transform",type:"scale",from:"1.5",to:"1",repeatCount:"indefinite",begin:"0s",dur:"1s",calcMode:"spline",keySplines:"0.2 0.8 0.2 0.8",keyTimes:"0;1"})])]),C("g",{transform:"translate(75 25)"},[C("rect",{x:"-20",y:"-20",width:"40",height:"40",fill:"currentColor",opacity:"0.8"},[C("animateTransform",{attributeName:"transform",type:"scale",from:"1.5",to:"1",repeatCount:"indefinite",begin:"0.1s",dur:"1s",calcMode:"spline",keySplines:"0.2 0.8 0.2 0.8",keyTimes:"0;1"})])]),C("g",{transform:"translate(25 75)"},[C("rect",{x:"-20",y:"-20",width:"40",height:"40",fill:"currentColor",opacity:"0.7"},[C("animateTransform",{attributeName:"transform",type:"scale",from:"1.5",to:"1",repeatCount:"indefinite",begin:"0.3s",dur:"1s",calcMode:"spline",keySplines:"0.2 0.8 0.2 0.8",keyTimes:"0;1"})])]),C("g",{transform:"translate(75 75)"},[C("rect",{x:"-20",y:"-20",width:"40",height:"40",fill:"currentColor",opacity:"0.6"},[C("animateTransform",{attributeName:"transform",type:"scale",from:"1.5",to:"1",repeatCount:"indefinite",begin:"0.2s",dur:"1s",calcMode:"spline",keySplines:"0.2 0.8 0.2 0.8",keyTimes:"0;1"})])])];var yh=Bn({name:"QSpinnerCube",props:Za,setup(r){const{cSize:e,classes:t}=ec(r);return()=>C("svg",{class:t.value,width:e.value,height:e.value,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid"},Tc)}}),Ec=Bn({name:"QTh",props:{props:Object,autoWidth:Boolean},emits:["click"],setup(r,{slots:e,emit:t}){const n=Xn(),{proxy:{$q:s}}=n,i=o=>{t("click",o)};return()=>{if(r.props===void 0)return C("th",{class:r.autoWidth===!0?"q-table--col-auto-width":"",onClick:i},hs(e.default));let o,c;const u=n.vnode.key;if(u){if(o=r.props.colsMap[u],o===void 0)return}else o=r.props.col;if(o.sortable===!0){const f=o.align==="right"?"unshift":"push";c=tc(e.default,[]),c[f](C(Oi,{class:o.__iconClass,name:s.iconSet.table.arrowUp}))}else c=hs(e.default);const d={class:o.__thClass+(r.autoWidth===!0?" q-table--col-auto-width":""),style:o.headerStyle,onClick:f=>{o.sortable===!0&&r.props.sort(o),i(f)}};return C("th",d,c)}}});const Bc=["horizontal","vertical","cell","none"];var Cc=Bn({name:"QMarkupTable",props:{...Ts,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,wrapCells:Boolean,separator:{type:String,default:"horizontal",validator:r=>Bc.includes(r)}},setup(r,{slots:e}){const t=Xn(),n=Es(r,t.proxy.$q),s=H(()=>`q-markup-table q-table__container q-table__card q-table--${r.separator}-separator`+(n.value===!0?" q-table--dark q-table__card--dark q-dark":"")+(r.dense===!0?" q-table--dense":"")+(r.flat===!0?" q-table--flat":"")+(r.bordered===!0?" q-table--bordered":"")+(r.square===!0?" q-table--square":"")+(r.wrapCells===!1?" q-table--no-wrap":""));return()=>C("div",{class:s.value},[C("table",{class:"q-table"},hs(e.default))])}});function Di(r,e){return C("div",r,[C("table",{class:"q-table"},e)])}const Oc={list:_c,table:Cc},Nc=["list","table","__qtable"];var Lc=Bn({name:"QVirtualScroll",props:{...kc,type:{type:String,default:"list",validator:r=>Nc.includes(r)},items:{type:Array,default:()=>[]},itemsFn:Function,itemsSize:Number,scrollTarget:{default:void 0}},setup(r,{slots:e,attrs:t}){let n;const s=An(null),i=H(()=>r.itemsSize>=0&&r.itemsFn!==void 0?parseInt(r.itemsSize,10):Array.isArray(r.items)?r.items.length:0),{virtualScrollSliceRange:o,localResetVirtualScroll:c,padVirtualScroll:u,onVirtualScrollEvt:d}=Sc({virtualScrollLength:i,getVirtualScrollTarget:b,getVirtualScrollEl:h}),f=H(()=>{if(i.value===0)return[];const _=(A,P)=>({index:o.value.from+P,item:A});return r.itemsFn===void 0?r.items.slice(o.value.from,o.value.to).map(_):r.itemsFn(o.value.from,o.value.to-o.value.from).map(_)}),g=H(()=>"q-virtual-scroll q-virtual-scroll"+(r.virtualScrollHorizontal===!0?"--horizontal":"--vertical")+(r.scrollTarget!==void 0?"":" scroll")),S=H(()=>r.scrollTarget!==void 0?{}:{tabindex:0});Kt(i,()=>{c()}),Kt(()=>r.scrollTarget,()=>{k(),p()});function h(){return s.value.$el||s.value}function b(){return n}function p(){n=Ac(h(),r.scrollTarget),n.addEventListener("scroll",d,ii.passive)}function k(){n!==void 0&&(n.removeEventListener("scroll",d,ii.passive),n=void 0)}function y(){let _=u(r.type==="list"?"div":"tbody",f.value.map(e.default));return e.before!==void 0&&(_=e.before().concat(_)),Ki(e.after,_)}return Ni(()=>{c()}),Li(()=>{p()}),nc(()=>{p()}),rc(()=>{k()}),xi(()=>{k()}),()=>{if(e.default===void 0){console.error("QVirtualScroll: default scoped slot is required for rendering");return}return r.type==="__qtable"?Di({ref:s,class:"q-table__middle "+g.value},y()):C(Oc[r.type],{...t,ref:s,class:[t.class,g.value],...S.value},y)}}});const xc={xs:2,sm:4,md:6,lg:10,xl:14};function di(r,e,t){return{transform:e===!0?`translateX(${t.lang.rtl===!0?"-":""}100%) scale3d(${-r},1,1)`:`scale3d(${r},1,1)`}}var Kc=Bn({name:"QLinearProgress",props:{...Ts,...sc,value:{type:Number,default:0},buffer:Number,color:String,trackColor:String,reverse:Boolean,stripe:Boolean,indeterminate:Boolean,query:Boolean,rounded:Boolean,animationSpeed:{type:[String,Number],default:2100},instantFeedback:Boolean},setup(r,{slots:e}){const{proxy:t}=Xn(),n=Es(r,t.$q),s=ic(r,xc),i=H(()=>r.indeterminate===!0||r.query===!0),o=H(()=>r.reverse!==r.query),c=H(()=>({...s.value!==null?s.value:{},"--q-linear-progress-speed":`${r.animationSpeed}ms`})),u=H(()=>"q-linear-progress"+(r.color!==void 0?` text-${r.color}`:"")+(r.reverse===!0||r.query===!0?" q-linear-progress--reverse":"")+(r.rounded===!0?" rounded-borders":"")),d=H(()=>di(r.buffer!==void 0?r.buffer:1,o.value,t.$q)),f=H(()=>`with${r.instantFeedback===!0?"out":""}-transition`),g=H(()=>`q-linear-progress__track absolute-full q-linear-progress__track--${f.value} q-linear-progress__track--${n.value===!0?"dark":"light"}`+(r.trackColor!==void 0?` bg-${r.trackColor}`:"")),S=H(()=>di(i.value===!0?1:r.value,o.value,t.$q)),h=H(()=>`q-linear-progress__model absolute-full q-linear-progress__model--${f.value} q-linear-progress__model--${i.value===!0?"in":""}determinate`),b=H(()=>({width:`${r.value*100}%`})),p=H(()=>`q-linear-progress__stripe absolute-${r.reverse===!0?"right":"left"} q-linear-progress__stripe--${f.value}`);return()=>{const k=[C("div",{class:g.value,style:d.value}),C("div",{class:h.value,style:S.value})];return r.stripe===!0&&i.value===!1&&k.push(C("div",{class:p.value,style:b.value})),C("div",{class:u.value,style:c.value,role:"progressbar","aria-valuemin":0,"aria-valuemax":1,"aria-valuenow":r.indeterminate===!0?void 0:r.value},Ki(e.default,k))}}});let Dn=0;const zc={fullscreen:Boolean,noRouteFullscreenExit:Boolean},Uc=["update:fullscreen","fullscreen"];function Mc(){const r=Xn(),{props:e,emit:t,proxy:n}=r;let s,i,o;const c=An(!1);oc(r)===!0&&Kt(()=>n.$route.fullPath,()=>{e.noRouteFullscreenExit!==!0&&f()}),Kt(()=>e.fullscreen,g=>{c.value!==g&&u()}),Kt(c,g=>{t("update:fullscreen",g),t("fullscreen",g)});function u(){c.value===!0?f():d()}function d(){c.value!==!0&&(c.value=!0,o=n.$el.parentNode,o.replaceChild(i,n.$el),document.body.appendChild(n.$el),Dn++,Dn===1&&document.body.classList.add("q-body--fullscreen-mixin"),s={handler:f},oi.add(s))}function f(){c.value===!0&&(s!==void 0&&(oi.remove(s),s=void 0),o.replaceChild(n.$el,i),c.value=!1,Dn=Math.max(0,Dn-1),Dn===0&&(document.body.classList.remove("q-body--fullscreen-mixin"),n.$el.scrollIntoView!==void 0&&setTimeout(()=>{n.$el.scrollIntoView()})))}return Ni(()=>{i=document.createElement("span")}),Li(()=>{e.fullscreen===!0&&d()}),xi(f),Object.assign(n,{toggleFullscreen:u,setFullscreen:d,exitFullscreen:f}),{inFullscreen:c,toggleFullscreen:u}}function Wc(r,e){return new Date(r)-new Date(e)}const $c={sortMethod:Function,binaryStateSort:Boolean,columnSortOrder:{type:String,validator:r=>r==="ad"||r==="da",default:"ad"}};function Dc(r,e,t,n){const s=H(()=>{const{sortBy:c}=e.value;return c&&t.value.find(u=>u.name===c)||null}),i=H(()=>r.sortMethod!==void 0?r.sortMethod:(c,u,d)=>{const f=t.value.find(h=>h.name===u);if(f===void 0||f.field===void 0)return c;const g=d===!0?-1:1,S=typeof f.field=="function"?h=>f.field(h):h=>h[f.field];return c.sort((h,b)=>{let p=S(h),k=S(b);return f.rawSort!==void 0?f.rawSort(p,k,h,b)*g:p==null?-1*g:k==null?1*g:f.sort!==void 0?f.sort(p,k,h,b)*g:gs(p)===!0&&gs(k)===!0?(p-k)*g:ai(p)===!0&&ai(k)===!0?Wc(p,k)*g:typeof p=="boolean"&&typeof k=="boolean"?(p-k)*g:([p,k]=[p,k].map(y=>(y+"").toLocaleString().toLowerCase()),p<k?-1*g:p===k?0:g)})});function o(c){let u=r.columnSortOrder;if(ac(c)===!0)c.sortOrder&&(u=c.sortOrder),c=c.name;else{const g=t.value.find(S=>S.name===c);g!==void 0&&g.sortOrder&&(u=g.sortOrder)}let{sortBy:d,descending:f}=e.value;d!==c?(d=c,f=u==="da"):r.binaryStateSort===!0?f=!f:f===!0?u==="ad"?d=null:f=!1:u==="ad"?f=!0:d=null,n({sortBy:d,descending:f,page:1})}return{columnToSort:s,computedSortMethod:i,sort:o}}const Fc={filter:[String,Object],filterMethod:Function};function qc(r,e){const t=H(()=>r.filterMethod!==void 0?r.filterMethod:(n,s,i,o)=>{const c=s?s.toLowerCase():"";return n.filter(u=>i.some(d=>{const f=o(d,u)+"";return(f==="undefined"||f==="null"?"":f.toLowerCase()).indexOf(c)!==-1}))});return Kt(()=>r.filter,()=>{zi(()=>{e({page:1},!0)})},{deep:!0}),{computedFilterMethod:t}}function Hc(r,e){for(const t in e)if(e[t]!==r[t])return!1;return!0}function fi(r){return r.page<1&&(r.page=1),r.rowsPerPage!==void 0&&r.rowsPerPage<1&&(r.rowsPerPage=0),r}const Vc={pagination:Object,rowsPerPageOptions:{type:Array,default:()=>[5,7,10,15,20,25,50,0]},"onUpdate:pagination":[Function,Array]};function Gc(r,e){const{props:t,emit:n}=r,s=An(Object.assign({sortBy:null,descending:!1,page:1,rowsPerPage:t.rowsPerPageOptions.length!==0?t.rowsPerPageOptions[0]:5},t.pagination)),i=H(()=>{const f=t["onUpdate:pagination"]!==void 0?{...s.value,...t.pagination}:s.value;return fi(f)}),o=H(()=>i.value.rowsNumber!==void 0);function c(f){u({pagination:f,filter:t.filter})}function u(f={}){zi(()=>{n("request",{pagination:f.pagination||i.value,filter:f.filter||t.filter,getCellValue:e})})}function d(f,g){const S=fi({...i.value,...f});if(Hc(i.value,S)===!0){o.value===!0&&g===!0&&c(S);return}if(o.value===!0){c(S);return}t.pagination!==void 0&&t["onUpdate:pagination"]!==void 0?n("update:pagination",S):s.value=S}return{innerPagination:s,computedPagination:i,isServerSide:o,requestServerInteraction:u,setPagination:d}}function jc(r,e,t,n,s,i){const{props:o,emit:c,proxy:{$q:u}}=r,d=H(()=>n.value===!0?t.value.rowsNumber||0:i.value),f=H(()=>{const{page:P,rowsPerPage:O}=t.value;return(P-1)*O}),g=H(()=>{const{page:P,rowsPerPage:O}=t.value;return P*O}),S=H(()=>t.value.page===1),h=H(()=>t.value.rowsPerPage===0?1:Math.max(1,Math.ceil(d.value/t.value.rowsPerPage))),b=H(()=>g.value===0?!0:t.value.page>=h.value),p=H(()=>(o.rowsPerPageOptions.includes(e.value.rowsPerPage)?o.rowsPerPageOptions:[e.value.rowsPerPage].concat(o.rowsPerPageOptions)).map(O=>({label:O===0?u.lang.table.allRows:""+O,value:O})));Kt(h,(P,O)=>{if(P===O)return;const L=t.value.page;P&&!L?s({page:1}):P<L&&s({page:P})});function k(){s({page:1})}function y(){const{page:P}=t.value;P>1&&s({page:P-1})}function _(){const{page:P,rowsPerPage:O}=t.value;g.value>0&&P*O<d.value&&s({page:P+1})}function A(){s({page:h.value})}return o["onUpdate:pagination"]!==void 0&&c("update:pagination",{...t.value}),{firstRowIndex:f,lastRowIndex:g,isFirstPage:S,isLastPage:b,pagesNumber:h,computedRowsPerPageOptions:p,computedRowsNumber:d,firstPage:k,prevPage:y,nextPage:_,lastPage:A}}const Yc={selection:{type:String,default:"none",validator:r=>["single","multiple","none"].includes(r)},selected:{type:Array,default:()=>[]}},Jc=["update:selected","selection"];function Xc(r,e,t,n){const s=H(()=>{const b={};return r.selected.map(n.value).forEach(p=>{b[p]=!0}),b}),i=H(()=>r.selection!=="none"),o=H(()=>r.selection==="single"),c=H(()=>r.selection==="multiple"),u=H(()=>t.value.length!==0&&t.value.every(b=>s.value[n.value(b)]===!0)),d=H(()=>u.value!==!0&&t.value.some(b=>s.value[n.value(b)]===!0)),f=H(()=>r.selected.length);function g(b){return s.value[b]===!0}function S(){e("update:selected",[])}function h(b,p,k,y){e("selection",{rows:p,added:k,keys:b,evt:y});const _=o.value===!0?k===!0?p:[]:k===!0?r.selected.concat(p):r.selected.filter(A=>b.includes(n.value(A))===!1);e("update:selected",_)}return{hasSelectionMode:i,singleSelection:o,multipleSelection:c,allRowsSelected:u,someRowsSelected:d,rowsSelectedNumber:f,isRowSelected:g,clearSelection:S,updateSelection:h}}function hi(r){return Array.isArray(r)?r.slice():[]}const Qc={expanded:Array},Zc=["update:expanded"];function eu(r,e){const t=An(hi(r.expanded));Kt(()=>r.expanded,o=>{t.value=hi(o)});function n(o){return t.value.includes(o)}function s(o){r.expanded!==void 0?e("update:expanded",o):t.value=o}function i(o,c){const u=t.value.slice(),d=u.indexOf(o);c===!0?d===-1&&(u.push(o),s(u)):d!==-1&&(u.splice(d,1),s(u))}return{isRowExpanded:n,setExpanded:s,updateExpanded:i}}const tu={visibleColumns:Array};function nu(r,e,t){const n=H(()=>{if(r.columns!==void 0)return r.columns;const c=r.rows[0];return c!==void 0?Object.keys(c).map(u=>({name:u,label:u.toUpperCase(),field:u,align:gs(c[u])?"right":"left",sortable:!0})):[]}),s=H(()=>{const{sortBy:c,descending:u}=e.value;return(r.visibleColumns!==void 0?n.value.filter(f=>f.required===!0||r.visibleColumns.includes(f.name)===!0):n.value).map(f=>{const g=f.align||"right",S=`text-${g}`;return{...f,align:g,__iconClass:`q-table__sort-icon q-table__sort-icon--${g}`,__thClass:S+(f.headerClasses!==void 0?" "+f.headerClasses:"")+(f.sortable===!0?" sortable":"")+(f.name===c?` sorted ${u===!0?"sort-desc":""}`:""),__tdStyle:f.style!==void 0?typeof f.style!="function"?()=>f.style:f.style:()=>null,__tdClass:f.classes!==void 0?typeof f.classes!="function"?()=>S+" "+f.classes:h=>S+" "+f.classes(h):()=>S}})}),i=H(()=>{const c={};return s.value.forEach(u=>{c[u.name]=u}),c}),o=H(()=>r.tableColspan!==void 0?r.tableColspan:s.value.length+(t.value===!0?1:0));return{colList:n,computedCols:s,computedColsMap:i,computedColspan:o}}const vr="q-table__bottom row items-center",Fi={};$i.forEach(r=>{Fi[r]={}});var bh=Bn({name:"QTable",props:{rows:{type:Array,default:()=>[]},rowKey:{type:[String,Function],default:"id"},columns:Array,loading:Boolean,iconFirstPage:String,iconPrevPage:String,iconNextPage:String,iconLastPage:String,title:String,hideHeader:Boolean,grid:Boolean,gridHeader:Boolean,dense:Boolean,flat:Boolean,bordered:Boolean,square:Boolean,separator:{type:String,default:"horizontal",validator:r=>["horizontal","vertical","cell","none"].includes(r)},wrapCells:Boolean,virtualScroll:Boolean,virtualScrollTarget:{default:void 0},...Fi,noDataLabel:String,noResultsLabel:String,loadingLabel:String,selectedRowsLabel:Function,rowsPerPageLabel:String,paginationLabel:Function,color:{type:String,default:"grey-8"},titleClass:[String,Array,Object],tableStyle:[String,Array,Object],tableClass:[String,Array,Object],tableHeaderStyle:[String,Array,Object],tableHeaderClass:[String,Array,Object],cardContainerClass:[String,Array,Object],cardContainerStyle:[String,Array,Object],cardStyle:[String,Array,Object],cardClass:[String,Array,Object],hideBottom:Boolean,hideSelectedBanner:Boolean,hideNoData:Boolean,hidePagination:Boolean,onRowClick:Function,onRowDblclick:Function,onRowContextmenu:Function,...Ts,...zc,...tu,...Fc,...Vc,...Qc,...Yc,...$c},emits:["request","virtualScroll",...Uc,...Zc,...Jc],setup(r,{slots:e,emit:t}){const n=Xn(),{proxy:{$q:s}}=n,i=Es(r,s),{inFullscreen:o,toggleFullscreen:c}=Mc(),u=H(()=>typeof r.rowKey=="function"?r.rowKey:v=>v[r.rowKey]),d=An(null),f=An(null),g=H(()=>r.grid!==!0&&r.virtualScroll===!0),S=H(()=>" q-table__card"+(i.value===!0?" q-table__card--dark q-dark":"")+(r.square===!0?" q-table--square":"")+(r.flat===!0?" q-table--flat":"")+(r.bordered===!0?" q-table--bordered":"")),h=H(()=>`q-table__container q-table--${r.separator}-separator column no-wrap`+(r.grid===!0?" q-table--grid":S.value)+(i.value===!0?" q-table--dark":"")+(r.dense===!0?" q-table--dense":"")+(r.wrapCells===!1?" q-table--no-wrap":"")+(o.value===!0?" fullscreen scroll":"")),b=H(()=>h.value+(r.loading===!0?" q-table--loading":""));Kt(()=>r.tableStyle+r.tableClass+r.tableHeaderStyle+r.tableHeaderClass+h.value,()=>{g.value===!0&&f.value!==null&&f.value.reset()});const{innerPagination:p,computedPagination:k,isServerSide:y,requestServerInteraction:_,setPagination:A}=Gc(n,at),{computedFilterMethod:P}=qc(r,A),{isRowExpanded:O,setExpanded:L,updateExpanded:X}=eu(r,t),ee=H(()=>{let v=r.rows;if(y.value===!0||v.length===0)return v;const{sortBy:U,descending:j}=k.value;return r.filter&&(v=P.value(v,r.filter,We.value,at)),It.value!==null&&(v=we.value(r.rows===v?v.slice():v,U,j)),v}),se=H(()=>ee.value.length),q=H(()=>{let v=ee.value;if(y.value===!0)return v;const{rowsPerPage:U}=k.value;return U!==0&&($e.value===0&&r.rows!==v?v.length>te.value&&(v=v.slice(0,te.value)):v=v.slice($e.value,te.value)),v}),{hasSelectionMode:me,singleSelection:St,multipleSelection:Xt,allRowsSelected:yn,someRowsSelected:vt,rowsSelectedNumber:zt,isRowSelected:Ut,clearSelection:bn,updateSelection:At}=Xc(r,t,q,u),{colList:Ze,computedCols:We,computedColsMap:Mt,computedColspan:Qt}=nu(r,k,me),{columnToSort:It,computedSortMethod:we,sort:Se}=Dc(r,k,Ze,A),{firstRowIndex:$e,lastRowIndex:te,isFirstPage:De,isLastPage:it,pagesNumber:Ce,computedRowsPerPageOptions:Wt,computedRowsNumber:ot,firstPage:Rt,prevPage:dt,nextPage:$t,lastPage:Dt}=jc(n,p,k,y,A,se),rr=H(()=>q.value.length===0),qr=H(()=>{const v={};return $i.forEach(U=>{v[U]=r[U]}),v.virtualScrollItemSize===void 0&&(v.virtualScrollItemSize=r.dense===!0?28:48),v});function Hr(){g.value===!0&&f.value.reset()}function Vr(){if(r.grid===!0)return en();const v=r.hideHeader!==!0?et:null;if(g.value===!0){const j=e["top-row"],Y=e["bottom-row"],ne={default:_e=>pn(_e.item,e.body,_e.index)};if(j!==void 0){const _e=C("tbody",j({cols:We.value}));ne.before=v===null?()=>_e:()=>[v()].concat(_e)}else v!==null&&(ne.before=v);return Y!==void 0&&(ne.after=()=>C("tbody",Y({cols:We.value}))),C(Lc,{ref:f,class:r.tableClass,style:r.tableStyle,...qr.value,scrollTarget:r.virtualScrollTarget,items:q.value,type:"__qtable",tableColspan:Qt.value,onVirtualScroll:sr},ne)}const U=[jr()];return v!==null&&U.unshift(v()),Di({class:["q-table__middle scroll",r.tableClass],style:r.tableStyle},U)}function Gr(v,U){if(f.value!==null){f.value.scrollTo(v,U);return}v=parseInt(v,10);const j=d.value.querySelector(`tbody tr:nth-of-type(${v+1})`);if(j!==null){const Y=d.value.querySelector(".q-table__middle.scroll"),ne=j.offsetTop-r.virtualScrollStickySizeStart,_e=ne<Y.scrollTop?"decrease":"increase";Y.scrollTop=ne,t("virtualScroll",{index:v,from:0,to:p.value.rowsPerPage-1,direction:_e})}}function sr(v){t("virtualScroll",v)}function ir(){return[C(Kc,{class:"q-table__linear-progress",color:r.color,dark:i.value,indeterminate:!0,trackColor:"transparent"})]}function pn(v,U,j){const Y=u.value(v),ne=Ut(Y);if(U!==void 0)return U(or({key:Y,row:v,pageIndex:j,__trClass:ne?"selected":""}));const _e=e["body-cell"],ye=We.value.map(Le=>{const Pt=e[`body-cell-${Le.name}`],qt=Pt!==void 0?Pt:_e;return qt!==void 0?qt(Yr({key:Y,row:v,pageIndex:j,col:Le})):C("td",{class:Le.__tdClass(v),style:Le.__tdStyle(v)},at(Le,v))});if(me.value===!0){const Le=e["body-selection"],Pt=Le!==void 0?Le(Jr({key:Y,row:v,pageIndex:j})):[C(rs,{modelValue:ne,color:r.color,dark:i.value,dense:r.dense,"onUpdate:modelValue":(qt,cr)=>{At([Y],[v],qt,cr)}})];ye.unshift(C("td",{class:"q-table--col-auto-width"},Pt))}const ct={key:Y,class:{selected:ne}};return r.onRowClick!==void 0&&(ct.class["cursor-pointer"]=!0,ct.onClick=Le=>{t("RowClick",Le,v,j)}),r.onRowDblclick!==void 0&&(ct.class["cursor-pointer"]=!0,ct.onDblclick=Le=>{t("RowDblclick",Le,v,j)}),r.onRowContextmenu!==void 0&&(ct.class["cursor-pointer"]=!0,ct.onContextmenu=Le=>{t("RowContextmenu",Le,v,j)}),C("tr",ct,ye)}function jr(){const v=e.body,U=e["top-row"],j=e["bottom-row"];let Y=q.value.map((ne,_e)=>pn(ne,v,_e));return U!==void 0&&(Y=U({cols:We.value}).concat(Y)),j!==void 0&&(Y=Y.concat(j({cols:We.value}))),C("tbody",Y)}function or(v){return xn(v),v.cols=v.cols.map(U=>$n({...U},"value",()=>at(U,v.row))),v}function Yr(v){return xn(v),$n(v,"value",()=>at(v.col,v.row)),v}function Jr(v){return xn(v),v}function xn(v){Object.assign(v,{cols:We.value,colsMap:Mt.value,sort:Se,rowIndex:$e.value+v.pageIndex,color:r.color,dark:i.value,dense:r.dense}),me.value===!0&&$n(v,"selected",()=>Ut(v.key),(U,j)=>{At([v.key],[v.row],U,j)}),$n(v,"expand",()=>O(v.key),U=>{X(v.key,U)})}function at(v,U){const j=typeof v.field=="function"?v.field(U):U[v.field];return v.format!==void 0?v.format(j,U):j}const ft=H(()=>({pagination:k.value,pagesNumber:Ce.value,isFirstPage:De.value,isLastPage:it.value,firstPage:Rt,prevPage:dt,nextPage:$t,lastPage:Dt,inFullscreen:o.value,toggleFullscreen:c}));function ar(){const v=e.top,U=e["top-left"],j=e["top-right"],Y=e["top-selection"],ne=me.value===!0&&Y!==void 0&&zt.value>0,_e="q-table__top relative-position row items-center";if(v!==void 0)return C("div",{class:_e},[v(ft.value)]);let ye;if(ne===!0?ye=Y(ft.value).slice():(ye=[],U!==void 0?ye.push(C("div",{class:"q-table__control"},[U(ft.value)])):r.title&&ye.push(C("div",{class:"q-table__control"},[C("div",{class:["q-table__title",r.titleClass]},r.title)]))),j!==void 0&&(ye.push(C("div",{class:"q-table__separator col"})),ye.push(C("div",{class:"q-table__control"},[j(ft.value)]))),ye.length!==0)return C("div",{class:_e},ye)}const Kn=H(()=>vt.value===!0?null:yn.value);function et(){const v=Ft();return r.loading===!0&&e.loading===void 0&&v.push(C("tr",{class:"q-table__progress"},[C("th",{class:"relative-position",colspan:Qt.value},ir())])),C("thead",v)}function Ft(){const v=e.header,U=e["header-cell"];if(v!==void 0)return v(zn({header:!0})).slice();const j=We.value.map(Y=>{const ne=e[`header-cell-${Y.name}`],_e=ne!==void 0?ne:U,ye=zn({col:Y});return _e!==void 0?_e(ye):C(Ec,{key:Y.name,props:ye},()=>Y.label)});if(St.value===!0&&r.grid!==!0)j.unshift(C("th",{class:"q-table--col-auto-width"}," "));else if(Xt.value===!0){const Y=e["header-selection"],ne=Y!==void 0?Y(zn({})):[C(rs,{color:r.color,modelValue:Kn.value,dark:i.value,dense:r.dense,"onUpdate:modelValue":Un})];j.unshift(C("th",{class:"q-table--col-auto-width"},ne))}return[C("tr",{class:r.tableHeaderClass,style:r.tableHeaderStyle},j)]}function zn(v){return Object.assign(v,{cols:We.value,sort:Se,colsMap:Mt.value,color:r.color,dark:i.value,dense:r.dense}),Xt.value===!0&&$n(v,"selected",()=>Kn.value,Un),v}function Un(v){vt.value===!0&&(v=!1),At(q.value.map(u.value),q.value,v)}const Zt=H(()=>{const v=[r.iconFirstPage||s.iconSet.table.firstPage,r.iconPrevPage||s.iconSet.table.prevPage,r.iconNextPage||s.iconSet.table.nextPage,r.iconLastPage||s.iconSet.table.lastPage];return s.lang.rtl===!0?v.reverse():v});function Xr(){if(r.hideBottom===!0)return;if(rr.value===!0){if(r.hideNoData===!0)return;const j=r.loading===!0?r.loadingLabel||s.lang.table.loading:r.filter?r.noResultsLabel||s.lang.table.noResults:r.noDataLabel||s.lang.table.noData,Y=e["no-data"],ne=Y!==void 0?[Y({message:j,icon:s.iconSet.table.warning,filter:r.filter})]:[C(Oi,{class:"q-table__bottom-nodata-icon",name:s.iconSet.table.warning}),j];return C("div",{class:vr+" q-table__bottom--nodata"},ne)}const v=e.bottom;if(v!==void 0)return C("div",{class:vr},[v(ft.value)]);const U=r.hideSelectedBanner!==!0&&me.value===!0&&zt.value>0?[C("div",{class:"q-table__control"},[C("div",[(r.selectedRowsLabel||s.lang.table.selectedRecords)(zt.value)])])]:[];if(r.hidePagination!==!0)return C("div",{class:vr+" justify-end"},Zr(U));if(U.length!==0)return C("div",{class:vr},U)}function Qr(v){A({page:1,rowsPerPage:v.value})}function Zr(v){let U;const{rowsPerPage:j}=k.value,Y=r.paginationLabel||s.lang.table.pagination,ne=e.pagination,_e=r.rowsPerPageOptions.length>1;if(v.push(C("div",{class:"q-table__separator col"})),_e===!0&&v.push(C("div",{class:"q-table__control"},[C("span",{class:"q-table__bottom-item"},[r.rowsPerPageLabel||s.lang.table.recordsPerPage]),C(vc,{class:"q-table__select inline q-table__bottom-item",color:r.color,modelValue:j,options:Wt.value,displayValue:j===0?s.lang.table.allRows:j,dark:i.value,borderless:!0,dense:!0,optionsDense:!0,optionsCover:!0,"onUpdate:modelValue":Qr})])),ne!==void 0)U=ne(ft.value);else if(U=[C("span",j!==0?{class:"q-table__bottom-item"}:{},[j?Y($e.value+1,Math.min(te.value,ot.value),ot.value):Y(1,se.value,ot.value)])],j!==0&&Ce.value>1){const ye={color:r.color,round:!0,dense:!0,flat:!0};r.dense===!0&&(ye.size="sm"),Ce.value>2&&U.push(C(_r,{key:"pgFirst",...ye,icon:Zt.value[0],disable:De.value,onClick:Rt})),U.push(C(_r,{key:"pgPrev",...ye,icon:Zt.value[1],disable:De.value,onClick:dt}),C(_r,{key:"pgNext",...ye,icon:Zt.value[2],disable:it.value,onClick:$t})),Ce.value>2&&U.push(C(_r,{key:"pgLast",...ye,icon:Zt.value[3],disable:it.value,onClick:Dt}))}return v.push(C("div",{class:"q-table__control"},U)),v}function Mn(){const v=r.gridHeader===!0?[C("table",{class:"q-table"},[et()])]:r.loading===!0&&e.loading===void 0?ir():void 0;return C("div",{class:"q-table__middle"},v)}function en(){const v=e.item!==void 0?e.item:U=>{const j=U.cols.map(ne=>C("div",{class:"q-table__grid-item-row"},[C("div",{class:"q-table__grid-item-title"},[ne.label]),C("div",{class:"q-table__grid-item-value"},[ne.value])]));if(me.value===!0){const ne=e["body-selection"],_e=ne!==void 0?ne(U):[C(rs,{modelValue:U.selected,color:r.color,dark:i.value,dense:r.dense,"onUpdate:modelValue":(ye,ct)=>{At([U.key],[U.row],ye,ct)}})];j.unshift(C("div",{class:"q-table__grid-item-row"},_e),C(wc,{dark:i.value}))}const Y={class:["q-table__grid-item-card"+S.value,r.cardClass],style:r.cardStyle};return(r.onRowClick!==void 0||r.onRowDblclick!==void 0)&&(Y.class[0]+=" cursor-pointer",r.onRowClick!==void 0&&(Y.onClick=ne=>{t("RowClick",ne,U.row,U.pageIndex)}),r.onRowDblclick!==void 0&&(Y.onDblclick=ne=>{t("RowDblclick",ne,U.row,U.pageIndex)})),C("div",{class:"q-table__grid-item col-xs-12 col-sm-6 col-md-4 col-lg-3"+(U.selected===!0?" q-table__grid-item--selected":"")},[C("div",Y,j)])};return C("div",{class:["q-table__grid-content row",r.cardContainerClass],style:r.cardContainerStyle},q.value.map((U,j)=>v(or({key:u.value(U),row:U,pageIndex:j}))))}return Object.assign(n.proxy,{requestServerInteraction:_,setPagination:A,firstPage:Rt,prevPage:dt,nextPage:$t,lastPage:Dt,isRowSelected:Ut,clearSelection:bn,isRowExpanded:O,setExpanded:L,sort:Se,resetVirtualScroll:Hr,scrollTo:Gr,getCellValue:at}),cc(n.proxy,{filteredSortedRows:()=>ee.value,computedRows:()=>q.value,computedRowsNumber:()=>ot.value}),()=>{const v=[ar()],U={ref:d,class:b.value};return r.grid===!0?v.push(Mn()):Object.assign(U,{class:[U.class,r.cardClass],style:r.cardStyle}),v.push(Vr(),Xr()),r.loading===!0&&e.loading!==void 0&&v.push(e.loading()),C("div",U,v)}}}),qi={},Hi={},gi=1/0,Vi=9007199254740991,ru=17976931348623157e292,yi=0/0,su="[object Function]",iu="[object GeneratorFunction]",ou="[object Symbol]",au=/^\s+|\s+$/g,cu=/^[-+]0x[0-9a-f]+$/i,uu=/^0b[01]+$/i,lu=/^0o[0-7]+$/i,du=/^(?:0|[1-9]\d*)$/,fu=parseInt,hu=Object.prototype,Gi=hu.toString,gu=Math.ceil,yu=Math.max;function bu(r,e,t){var n=-1,s=r.length;e<0&&(e=-e>s?0:s+e),t=t>s?s:t,t<0&&(t+=s),s=e>t?0:t-e>>>0,e>>>=0;for(var i=Array(s);++n<s;)i[n]=r[n+e];return i}function pu(r,e){return e=e??Vi,!!e&&(typeof r=="number"||du.test(r))&&r>-1&&r%1==0&&r<e}function mu(r,e,t){if(!Pr(t))return!1;var n=typeof e;return(n=="number"?ku(t)&&pu(e,t.length):n=="string"&&e in t)?_u(t[e],r):!1}function wu(r,e,t){(t?mu(r,e,t):e===void 0)?e=1:e=yu(Pu(e),0);var n=r?r.length:0;if(!n||e<1)return[];for(var s=0,i=0,o=Array(gu(n/e));s<n;)o[i++]=bu(r,s,s+=e);return o}function _u(r,e){return r===e||r!==r&&e!==e}function ku(r){return r!=null&&vu(r.length)&&!Su(r)}function Su(r){var e=Pr(r)?Gi.call(r):"";return e==su||e==iu}function vu(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=Vi}function Pr(r){var e=typeof r;return!!r&&(e=="object"||e=="function")}function Au(r){return!!r&&typeof r=="object"}function Iu(r){return typeof r=="symbol"||Au(r)&&Gi.call(r)==ou}function Ru(r){if(!r)return r===0?r:0;if(r=Tu(r),r===gi||r===-gi){var e=r<0?-1:1;return e*ru}return r===r?r:0}function Pu(r){var e=Ru(r),t=e%1;return e===e?t?e-t:e:0}function Tu(r){if(typeof r=="number")return r;if(Iu(r))return yi;if(Pr(r)){var e=typeof r.valueOf=="function"?r.valueOf():r;r=Pr(e)?e+"":e}if(typeof r!="string")return r===0?r:+r;r=r.replace(au,"");var t=uu.test(r);return t||lu.test(r)?fu(r.slice(2),t?2:8):cu.test(r)?yi:+r}var Eu=wu,ys={exports:{}};(function(r,e){var t=200,n="Expected a function",s="__lodash_hash_undefined__",i=1,o=2,c=1/0,u=9007199254740991,d="[object Arguments]",f="[object Array]",g="[object Boolean]",S="[object Date]",h="[object Error]",b="[object Function]",p="[object GeneratorFunction]",k="[object Map]",y="[object Number]",_="[object Object]",A="[object Promise]",P="[object RegExp]",O="[object Set]",L="[object String]",X="[object Symbol]",ee="[object WeakMap]",se="[object ArrayBuffer]",q="[object DataView]",me="[object Float32Array]",St="[object Float64Array]",Xt="[object Int8Array]",yn="[object Int16Array]",vt="[object Int32Array]",zt="[object Uint8Array]",Ut="[object Uint8ClampedArray]",bn="[object Uint16Array]",At="[object Uint32Array]",Ze=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,We=/^\w*$/,Mt=/^\./,Qt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,It=/[\\^$.*+?()[\]{}|]/g,we=/\\(\\)?/g,Se=/^\[object .+?Constructor\]$/,$e=/^(?:0|[1-9]\d*)$/,te={};te[me]=te[St]=te[Xt]=te[yn]=te[vt]=te[zt]=te[Ut]=te[bn]=te[At]=!0,te[d]=te[f]=te[se]=te[g]=te[q]=te[S]=te[h]=te[b]=te[k]=te[y]=te[_]=te[P]=te[O]=te[L]=te[ee]=!1;var De=typeof z=="object"&&z&&z.Object===Object&&z,it=typeof self=="object"&&self&&self.Object===Object&&self,Ce=De||it||Function("return this")(),Wt=e&&!e.nodeType&&e,ot=Wt&&!0&&r&&!r.nodeType&&r,Rt=ot&&ot.exports===Wt,dt=Rt&&De.process,$t=function(){try{return dt&&dt.binding("util")}catch{}}(),Dt=$t&&$t.isTypedArray;function rr(a,l){for(var w=-1,I=a?a.length:0,F=Array(I);++w<I;)F[w]=l(a[w],w,a);return F}function qr(a,l){for(var w=-1,I=a?a.length:0;++w<I;)if(l(a[w],w,a))return!0;return!1}function Hr(a){return function(l){return l==null?void 0:l[a]}}function Vr(a,l){var w=a.length;for(a.sort(l);w--;)a[w]=a[w].value;return a}function Gr(a,l){for(var w=-1,I=Array(a);++w<a;)I[w]=l(w);return I}function sr(a){return function(l){return a(l)}}function ir(a,l){return a==null?void 0:a[l]}function pn(a){var l=!1;if(a!=null&&typeof a.toString!="function")try{l=!!(a+"")}catch{}return l}function jr(a){var l=-1,w=Array(a.size);return a.forEach(function(I,F){w[++l]=[F,I]}),w}function or(a,l){return function(w){return a(l(w))}}function Yr(a){var l=-1,w=Array(a.size);return a.forEach(function(I){w[++l]=I}),w}var Jr=Array.prototype,xn=Function.prototype,at=Object.prototype,ft=Ce["__core-js_shared__"],ar=function(){var a=/[^.]+$/.exec(ft&&ft.keys&&ft.keys.IE_PROTO||"");return a?"Symbol(src)_1."+a:""}(),Kn=xn.toString,et=at.hasOwnProperty,Ft=at.toString,zn=RegExp("^"+Kn.call(et).replace(It,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Un=Ce.Symbol,Zt=Ce.Uint8Array,Xr=at.propertyIsEnumerable,Qr=Jr.splice,Zr=or(Object.keys,Object),Mn=mn(Ce,"DataView"),en=mn(Ce,"Map"),v=mn(Ce,"Promise"),U=mn(Ce,"Set"),j=mn(Ce,"WeakMap"),Y=mn(Object,"create"),ne=nn(Mn),_e=nn(en),ye=nn(v),ct=nn(U),Le=nn(j),Pt=Un?Un.prototype:void 0,qt=Pt?Pt.valueOf:void 0,cr=Pt?Pt.toString:void 0;function tn(a){var l=-1,w=a?a.length:0;for(this.clear();++l<w;){var I=a[l];this.set(I[0],I[1])}}function jo(){this.__data__=Y?Y(null):{}}function Yo(a){return this.has(a)&&delete this.__data__[a]}function Jo(a){var l=this.__data__;if(Y){var w=l[a];return w===s?void 0:w}return et.call(l,a)?l[a]:void 0}function Xo(a){var l=this.__data__;return Y?l[a]!==void 0:et.call(l,a)}function Qo(a,l){var w=this.__data__;return w[a]=Y&&l===void 0?s:l,this}tn.prototype.clear=jo,tn.prototype.delete=Yo,tn.prototype.get=Jo,tn.prototype.has=Xo,tn.prototype.set=Qo;function Tt(a){var l=-1,w=a?a.length:0;for(this.clear();++l<w;){var I=a[l];this.set(I[0],I[1])}}function Zo(){this.__data__=[]}function ea(a){var l=this.__data__,w=lr(l,a);if(w<0)return!1;var I=l.length-1;return w==I?l.pop():Qr.call(l,w,1),!0}function ta(a){var l=this.__data__,w=lr(l,a);return w<0?void 0:l[w][1]}function na(a){return lr(this.__data__,a)>-1}function ra(a,l){var w=this.__data__,I=lr(w,a);return I<0?w.push([a,l]):w[I][1]=l,this}Tt.prototype.clear=Zo,Tt.prototype.delete=ea,Tt.prototype.get=ta,Tt.prototype.has=na,Tt.prototype.set=ra;function Et(a){var l=-1,w=a?a.length:0;for(this.clear();++l<w;){var I=a[l];this.set(I[0],I[1])}}function sa(){this.__data__={hash:new tn,map:new(en||Tt),string:new tn}}function ia(a){return dr(this,a).delete(a)}function oa(a){return dr(this,a).get(a)}function aa(a){return dr(this,a).has(a)}function ca(a,l){return dr(this,a).set(a,l),this}Et.prototype.clear=sa,Et.prototype.delete=ia,Et.prototype.get=oa,Et.prototype.has=aa,Et.prototype.set=ca;function ur(a){var l=-1,w=a?a.length:0;for(this.__data__=new Et;++l<w;)this.add(a[l])}function ua(a){return this.__data__.set(a,s),this}function la(a){return this.__data__.has(a)}ur.prototype.add=ur.prototype.push=ua,ur.prototype.has=la;function Bt(a){this.__data__=new Tt(a)}function da(){this.__data__=new Tt}function fa(a){return this.__data__.delete(a)}function ha(a){return this.__data__.get(a)}function ga(a){return this.__data__.has(a)}function ya(a,l){var w=this.__data__;if(w instanceof Tt){var I=w.__data__;if(!en||I.length<t-1)return I.push([a,l]),this;w=this.__data__=new Et(I)}return w.set(a,l),this}Bt.prototype.clear=da,Bt.prototype.delete=fa,Bt.prototype.get=ha,Bt.prototype.has=ga,Bt.prototype.set=ya;function ba(a,l){var w=Ct(a)||ti(a)?Gr(a.length,String):[],I=w.length,F=!!I;for(var N in a)(l||et.call(a,N))&&!(F&&(N=="length"||Xs(N,I)))&&w.push(N);return w}function lr(a,l){for(var w=a.length;w--;)if(ei(a[w][0],l))return w;return-1}var pa=Ka(wa),ma=za();function wa(a,l){return a&&ma(a,l,pr)}function js(a,l){l=fr(l,a)?[l]:Ys(l);for(var w=0,I=l.length;a!=null&&w<I;)a=a[hr(l[w++])];return w&&w==I?a:void 0}function _a(a){return Ft.call(a)}function ka(a,l){return a!=null&&l in Object(a)}function es(a,l,w,I,F){return a===l?!0:a==null||l==null||!yr(a)&&!br(l)?a!==a&&l!==l:Sa(a,l,es,w,I,F)}function Sa(a,l,w,I,F,N){var J=Ct(a),oe=Ct(l),ie=f,fe=f;J||(ie=Ht(a),ie=ie==d?_:ie),oe||(fe=Ht(l),fe=fe==d?_:fe);var ze=ie==_&&!pn(a),Fe=fe==_&&!pn(l),Ee=ie==fe;if(Ee&&!ze)return N||(N=new Bt),J||ja(a)?Js(a,l,w,I,F,N):Ua(a,l,ie,w,I,F,N);if(!(F&o)){var tt=ze&&et.call(a,"__wrapped__"),nt=Fe&&et.call(l,"__wrapped__");if(tt||nt){var Vt=tt?a.value():a,Ot=nt?l.value():l;return N||(N=new Bt),w(Vt,Ot,I,F,N)}}return Ee?(N||(N=new Bt),Ma(a,l,w,I,F,N)):!1}function va(a,l,w,I){var F=w.length,N=F,J=!I;if(a==null)return!N;for(a=Object(a);F--;){var oe=w[F];if(J&&oe[2]?oe[1]!==a[oe[0]]:!(oe[0]in a))return!1}for(;++F<N;){oe=w[F];var ie=oe[0],fe=a[ie],ze=oe[1];if(J&&oe[2]){if(fe===void 0&&!(ie in a))return!1}else{var Fe=new Bt;if(I)var Ee=I(fe,ze,ie,a,l,Fe);if(!(Ee===void 0?es(ze,fe,I,i|o,Fe):Ee))return!1}}return!0}function Aa(a){if(!yr(a)||Fa(a))return!1;var l=ni(a)||pn(a)?zn:Se;return l.test(nn(a))}function Ia(a){return br(a)&&ns(a.length)&&!!te[Ft.call(a)]}function Ra(a){return typeof a=="function"?a:a==null?ri:typeof a=="object"?Ct(a)?Ba(a[0],a[1]):Ea(a):Qa(a)}function Pa(a){if(!qa(a))return Zr(a);var l=[];for(var w in Object(a))et.call(a,w)&&w!="constructor"&&l.push(w);return l}function Ta(a,l){var w=-1,I=gr(a)?Array(a.length):[];return pa(a,function(F,N,J){I[++w]=l(F,N,J)}),I}function Ea(a){var l=Wa(a);return l.length==1&&l[0][2]?Zs(l[0][0],l[0][1]):function(w){return w===a||va(w,a,l)}}function Ba(a,l){return fr(a)&&Qs(l)?Zs(hr(a),l):function(w){var I=Ja(w,a);return I===void 0&&I===l?Xa(w,a):es(l,I,void 0,i|o)}}function Ca(a,l,w){var I=-1;l=rr(l.length?l:[ri],sr(Ra));var F=Ta(a,function(N,J,oe){var ie=rr(l,function(fe){return fe(N)});return{criteria:ie,index:++I,value:N}});return Vr(F,function(N,J){return xa(N,J,w)})}function Oa(a){return function(l){return js(l,a)}}function Na(a){if(typeof a=="string")return a;if(Wn(a))return cr?cr.call(a):"";var l=a+"";return l=="0"&&1/a==-c?"-0":l}function Ys(a){return Ct(a)?a:Ha(a)}function La(a,l){if(a!==l){var w=a!==void 0,I=a===null,F=a===a,N=Wn(a),J=l!==void 0,oe=l===null,ie=l===l,fe=Wn(l);if(!oe&&!fe&&!N&&a>l||N&&J&&ie&&!oe&&!fe||I&&J&&ie||!w&&ie||!F)return 1;if(!I&&!N&&!fe&&a<l||fe&&w&&F&&!I&&!N||oe&&w&&F||!J&&F||!ie)return-1}return 0}function xa(a,l,w){for(var I=-1,F=a.criteria,N=l.criteria,J=F.length,oe=w.length;++I<J;){var ie=La(F[I],N[I]);if(ie){if(I>=oe)return ie;var fe=w[I];return ie*(fe=="desc"?-1:1)}}return a.index-l.index}function Ka(a,l){return function(w,I){if(w==null)return w;if(!gr(w))return a(w,I);for(var F=w.length,N=l?F:-1,J=Object(w);(l?N--:++N<F)&&I(J[N],N,J)!==!1;);return w}}function za(a){return function(l,w,I){for(var F=-1,N=Object(l),J=I(l),oe=J.length;oe--;){var ie=J[a?oe:++F];if(w(N[ie],ie,N)===!1)break}return l}}function Js(a,l,w,I,F,N){var J=F&o,oe=a.length,ie=l.length;if(oe!=ie&&!(J&&ie>oe))return!1;var fe=N.get(a);if(fe&&N.get(l))return fe==l;var ze=-1,Fe=!0,Ee=F&i?new ur:void 0;for(N.set(a,l),N.set(l,a);++ze<oe;){var tt=a[ze],nt=l[ze];if(I)var Vt=J?I(nt,tt,ze,l,a,N):I(tt,nt,ze,a,l,N);if(Vt!==void 0){if(Vt)continue;Fe=!1;break}if(Ee){if(!qr(l,function(Ot,rn){if(!Ee.has(rn)&&(tt===Ot||w(tt,Ot,I,F,N)))return Ee.add(rn)})){Fe=!1;break}}else if(!(tt===nt||w(tt,nt,I,F,N))){Fe=!1;break}}return N.delete(a),N.delete(l),Fe}function Ua(a,l,w,I,F,N,J){switch(w){case q:if(a.byteLength!=l.byteLength||a.byteOffset!=l.byteOffset)return!1;a=a.buffer,l=l.buffer;case se:return!(a.byteLength!=l.byteLength||!I(new Zt(a),new Zt(l)));case g:case S:case y:return ei(+a,+l);case h:return a.name==l.name&&a.message==l.message;case P:case L:return a==l+"";case k:var oe=jr;case O:var ie=N&o;if(oe||(oe=Yr),a.size!=l.size&&!ie)return!1;var fe=J.get(a);if(fe)return fe==l;N|=i,J.set(a,l);var ze=Js(oe(a),oe(l),I,F,N,J);return J.delete(a),ze;case X:if(qt)return qt.call(a)==qt.call(l)}return!1}function Ma(a,l,w,I,F,N){var J=F&o,oe=pr(a),ie=oe.length,fe=pr(l),ze=fe.length;if(ie!=ze&&!J)return!1;for(var Fe=ie;Fe--;){var Ee=oe[Fe];if(!(J?Ee in l:et.call(l,Ee)))return!1}var tt=N.get(a);if(tt&&N.get(l))return tt==l;var nt=!0;N.set(a,l),N.set(l,a);for(var Vt=J;++Fe<ie;){Ee=oe[Fe];var Ot=a[Ee],rn=l[Ee];if(I)var si=J?I(rn,Ot,Ee,l,a,N):I(Ot,rn,Ee,a,l,N);if(!(si===void 0?Ot===rn||w(Ot,rn,I,F,N):si)){nt=!1;break}Vt||(Vt=Ee=="constructor")}if(nt&&!Vt){var mr=a.constructor,wr=l.constructor;mr!=wr&&"constructor"in a&&"constructor"in l&&!(typeof mr=="function"&&mr instanceof mr&&typeof wr=="function"&&wr instanceof wr)&&(nt=!1)}return N.delete(a),N.delete(l),nt}function dr(a,l){var w=a.__data__;return Da(l)?w[typeof l=="string"?"string":"hash"]:w.map}function Wa(a){for(var l=pr(a),w=l.length;w--;){var I=l[w],F=a[I];l[w]=[I,F,Qs(F)]}return l}function mn(a,l){var w=ir(a,l);return Aa(w)?w:void 0}var Ht=_a;(Mn&&Ht(new Mn(new ArrayBuffer(1)))!=q||en&&Ht(new en)!=k||v&&Ht(v.resolve())!=A||U&&Ht(new U)!=O||j&&Ht(new j)!=ee)&&(Ht=function(a){var l=Ft.call(a),w=l==_?a.constructor:void 0,I=w?nn(w):void 0;if(I)switch(I){case ne:return q;case _e:return k;case ye:return A;case ct:return O;case Le:return ee}return l});function $a(a,l,w){l=fr(l,a)?[l]:Ys(l);for(var I,F=-1,J=l.length;++F<J;){var N=hr(l[F]);if(!(I=a!=null&&w(a,N)))break;a=a[N]}if(I)return I;var J=a?a.length:0;return!!J&&ns(J)&&Xs(N,J)&&(Ct(a)||ti(a))}function Xs(a,l){return l=l??u,!!l&&(typeof a=="number"||$e.test(a))&&a>-1&&a%1==0&&a<l}function fr(a,l){if(Ct(a))return!1;var w=typeof a;return w=="number"||w=="symbol"||w=="boolean"||a==null||Wn(a)?!0:We.test(a)||!Ze.test(a)||l!=null&&a in Object(l)}function Da(a){var l=typeof a;return l=="string"||l=="number"||l=="symbol"||l=="boolean"?a!=="__proto__":a===null}function Fa(a){return!!ar&&ar in a}function qa(a){var l=a&&a.constructor,w=typeof l=="function"&&l.prototype||at;return a===w}function Qs(a){return a===a&&!yr(a)}function Zs(a,l){return function(w){return w==null?!1:w[a]===l&&(l!==void 0||a in Object(w))}}var Ha=ts(function(a){a=Ya(a);var l=[];return Mt.test(a)&&l.push(""),a.replace(Qt,function(w,I,F,N){l.push(F?N.replace(we,"$1"):I||w)}),l});function hr(a){if(typeof a=="string"||Wn(a))return a;var l=a+"";return l=="0"&&1/a==-c?"-0":l}function nn(a){if(a!=null){try{return Kn.call(a)}catch{}try{return a+""}catch{}}return""}function Va(a,l,w,I){return a==null?[]:(Ct(l)||(l=l==null?[]:[l]),w=I?void 0:w,Ct(w)||(w=w==null?[]:[w]),Ca(a,l,w))}function ts(a,l){if(typeof a!="function"||l&&typeof l!="function")throw new TypeError(n);var w=function(){var I=arguments,F=l?l.apply(this,I):I[0],N=w.cache;if(N.has(F))return N.get(F);var J=a.apply(this,I);return w.cache=N.set(F,J),J};return w.cache=new(ts.Cache||Et),w}ts.Cache=Et;function ei(a,l){return a===l||a!==a&&l!==l}function ti(a){return Ga(a)&&et.call(a,"callee")&&(!Xr.call(a,"callee")||Ft.call(a)==d)}var Ct=Array.isArray;function gr(a){return a!=null&&ns(a.length)&&!ni(a)}function Ga(a){return br(a)&&gr(a)}function ni(a){var l=yr(a)?Ft.call(a):"";return l==b||l==p}function ns(a){return typeof a=="number"&&a>-1&&a%1==0&&a<=u}function yr(a){var l=typeof a;return!!a&&(l=="object"||l=="function")}function br(a){return!!a&&typeof a=="object"}function Wn(a){return typeof a=="symbol"||br(a)&&Ft.call(a)==X}var ja=Dt?sr(Dt):Ia;function Ya(a){return a==null?"":Na(a)}function Ja(a,l,w){var I=a==null?void 0:js(a,l);return I===void 0?w:I}function Xa(a,l){return a!=null&&$a(a,l,ka)}function pr(a){return gr(a)?ba(a):Pa(a)}function ri(a){return a}function Qa(a){return fr(a)?Hr(hr(a)):Oa(a)}r.exports=Va})(ys,ys.exports);var He={},Pe={},Bu=z&&z.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Cu=z&&z.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),bt=z&&z.__decorate||function(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(o=r[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i},Ou=z&&z.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.hasOwnProperty.call(r,t)&&Bu(e,r,t);return Cu(e,r),e},ji=z&&z.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Pe,"__esModule",{value:!0});Pe.deserializeUnchecked=Pe.deserialize=Pe.serialize=Pe.BinaryReader=Pe.BinaryWriter=Pe.BorshError=Pe.baseDecode=Pe.baseEncode=void 0;const Gt=ji(Lr.exports),Yi=ji(Ie),Nu=Ou(As),Lu=typeof z.TextDecoder!="function"?Nu.TextDecoder:z.TextDecoder,xu=new Lu("utf-8",{fatal:!0});function Ku(r){return typeof r=="string"&&(r=M.Buffer.from(r,"utf8")),Yi.default.encode(M.Buffer.from(r))}Pe.baseEncode=Ku;function zu(r){return M.Buffer.from(Yi.default.decode(r))}Pe.baseDecode=zu;const ss=1024;class Ue extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}Pe.BorshError=Ue;class Ji{constructor(){this.buf=M.Buffer.alloc(ss),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=M.Buffer.concat([this.buf,M.Buffer.alloc(ss)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(M.Buffer.from(new Gt.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(M.Buffer.from(new Gt.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(M.Buffer.from(new Gt.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(M.Buffer.from(new Gt.default(e).toArray("le",64)))}writeBuffer(e){this.buf=M.Buffer.concat([M.Buffer.from(this.buf.subarray(0,this.length)),e,M.Buffer.alloc(ss)]),this.length+=e.length}writeString(e){this.maybeResize();const t=M.Buffer.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(M.Buffer.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const n of e)this.maybeResize(),t(n)}toArray(){return this.buf.subarray(0,this.length)}}Pe.BinaryWriter=Ji;function pt(r,e,t){const n=t.value;t.value=function(...s){try{return n.apply(this,s)}catch(i){if(i instanceof RangeError){const o=i.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(o)>=0)throw new Ue("Reached the end of buffer when deserializing")}throw i}}}class Je{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new Gt.default(e,"le")}readU128(){const e=this.readBuffer(16);return new Gt.default(e,"le")}readU256(){const e=this.readBuffer(32);return new Gt.default(e,"le")}readU512(){const e=this.readBuffer(64);return new Gt.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new Ue(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return xu.decode(t)}catch(n){throw new Ue(`Error decoding UTF-8 string: ${n}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),n=Array();for(let s=0;s<t;++s)n.push(e());return n}}bt([pt],Je.prototype,"readU8",null);bt([pt],Je.prototype,"readU16",null);bt([pt],Je.prototype,"readU32",null);bt([pt],Je.prototype,"readU64",null);bt([pt],Je.prototype,"readU128",null);bt([pt],Je.prototype,"readU256",null);bt([pt],Je.prototype,"readU512",null);bt([pt],Je.prototype,"readString",null);bt([pt],Je.prototype,"readFixedArray",null);bt([pt],Je.prototype,"readArray",null);Pe.BinaryReader=Je;function Xi(r){return r.charAt(0).toUpperCase()+r.slice(1)}function Hn(r,e,t,n,s){try{if(typeof n=="string")s[`write${Xi(n)}`](t);else if(n instanceof Array)if(typeof n[0]=="number"){if(t.length!==n[0])throw new Ue(`Expecting byte array of length ${n[0]}, but got ${t.length} bytes`);s.writeFixedArray(t)}else if(n.length===2&&typeof n[1]=="number"){if(t.length!==n[1])throw new Ue(`Expecting byte array of length ${n[1]}, but got ${t.length} bytes`);for(let i=0;i<n[1];i++)Hn(r,null,t[i],n[0],s)}else s.writeArray(t,i=>{Hn(r,e,i,n[0],s)});else if(n.kind!==void 0)switch(n.kind){case"option":{t==null?s.writeU8(0):(s.writeU8(1),Hn(r,e,t,n.type,s));break}default:throw new Ue(`FieldType ${n} unrecognized`)}else Qi(r,t,s)}catch(i){throw i instanceof Ue&&i.addToFieldPath(e),i}}function Qi(r,e,t){if(typeof e.borshSerialize=="function"){e.borshSerialize(t);return}const n=r.get(e.constructor);if(!n)throw new Ue(`Class ${e.constructor.name} is missing in schema`);if(n.kind==="struct")n.fields.map(([s,i])=>{Hn(r,s,e[s],i,t)});else if(n.kind==="enum"){const s=e[n.field];for(let i=0;i<n.values.length;++i){const[o,c]=n.values[i];if(o===s){t.writeU8(i),Hn(r,o,e[o],c,t);break}}}else throw new Ue(`Unexpected schema kind: ${n.kind} for ${e.constructor.name}`)}function Uu(r,e,t=Ji){const n=new t;return Qi(r,e,n),n.toArray()}Pe.serialize=Uu;function Vn(r,e,t,n){try{if(typeof t=="string")return n[`read${Xi(t)}`]();if(t instanceof Array){if(typeof t[0]=="number")return n.readFixedArray(t[0]);if(typeof t[1]=="number"){const s=[];for(let i=0;i<t[1];i++)s.push(Vn(r,null,t[0],n));return s}else return n.readArray(()=>Vn(r,e,t[0],n))}return t.kind==="option"?n.readU8()?Vn(r,e,t.type,n):void 0:Bs(r,t,n)}catch(s){throw s instanceof Ue&&s.addToFieldPath(e),s}}function Bs(r,e,t){if(typeof e.borshDeserialize=="function")return e.borshDeserialize(t);const n=r.get(e);if(!n)throw new Ue(`Class ${e.name} is missing in schema`);if(n.kind==="struct"){const s={};for(const[i,o]of r.get(e).fields)s[i]=Vn(r,i,o,t);return new e(s)}if(n.kind==="enum"){const s=t.readU8();if(s>=n.values.length)throw new Ue(`Enum index: ${s} is out of range`);const[i,o]=n.values[s],c=Vn(r,i,o,t);return new e({[i]:c})}throw new Ue(`Unexpected schema kind: ${n.kind} for ${e.constructor.name}`)}function Mu(r,e,t,n=Je){const s=new n(t),i=Bs(r,e,s);if(s.offset<t.length)throw new Ue(`Unexpected ${t.length-s.offset} bytes after deserialized data`);return i}Pe.deserialize=Mu;function Wu(r,e,t,n=Je){const s=new n(t);return Bs(r,e,s)}Pe.deserializeUnchecked=Wu;var Cs={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.Metadata=r.METADATA_PROGRAM=r.METADATA_PREFIX=r.METADATA_SCHEMA=r.Data=r.Creator=r.MetadataKey=void 0;var e="metadata";r.METADATA_PREFIX=e;var t="metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s";r.METADATA_PROGRAM=t;var n;(function(u){u[u.Uninitialized=0]="Uninitialized",u[u.MetadataV1=4]="MetadataV1",u[u.EditionV1=1]="EditionV1",u[u.MasterEditionV1=2]="MasterEditionV1",u[u.MasterEditionV2=6]="MasterEditionV2",u[u.EditionMarker=7]="EditionMarker"})(n=r.MetadataKey||(r.MetadataKey={}));var s=function(){function u(d){this.address=d.address,this.verified=d.verified,this.share=d.share}return u}();r.Creator=s;var i=function(){function u(d){var f;this.key=n.MetadataV1,this.updateAuthority=d.updateAuthority,this.mint=d.mint,this.data=d.data,this.primarySaleHappened=d.primarySaleHappened,this.isMutable=d.isMutable,this.editionNonce=(f=d.editionNonce)!==null&&f!==void 0?f:null}return u}();r.Metadata=i;var o=function(){function u(d){this.name=d.name,this.symbol=d.symbol,this.uri=d.uri,this.sellerFeeBasisPoints=d.sellerFeeBasisPoints,this.creators=d.creators}return u}();r.Data=o;var c=new Map([[o,{kind:"struct",fields:[["name","string"],["symbol","string"],["uri","string"],["sellerFeeBasisPoints","u16"],["creators",{kind:"option",type:[s]}]]}],[i,{kind:"struct",fields:[["key","u8"],["updateAuthority","pubkey"],["mint","pubkey"],["data",o],["primarySaleHappened","u8"],["isMutable","u8"]]}],[s,{kind:"struct",fields:[["address","pubkey"],["verified","u8"],["share","u8"]]}]]);r.METADATA_SCHEMA=c})(Cs);var Zi={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.extendBorsh=void 0;var e=Cn,t=Pe,n=function(){t.BinaryReader.prototype.readPubkey=function(){var s=this,i=s.readFixedArray(32);return new e.PublicKey(i)},t.BinaryWriter.prototype.writePubkey=function(s){var i=this;i.writeFixedArray(s.toBuffer())}};r.extendBorsh=n,(0,r.extendBorsh)()})(Zi);var eo=z&&z.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function c(f){try{d(n.next(f))}catch(g){o(g)}}function u(f){try{d(n.throw(f))}catch(g){o(g)}}function d(f){f.done?i(f.value):s(f.value).then(c,u)}d((n=n.apply(r,e||[])).next())})},to=z&&z.__generator||function(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(d){return function(f){return u([d,f])}}function u(d){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(i=d[0]&2?s.return:d[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,d[1])).done)return i;switch(s=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,s=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){t.label=d[1];break}if(d[0]===6&&t.label<i[1]){t.label=i[1],i=d;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(d);break}i[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(r,t)}catch(f){d=[6,f],s=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(He,"__esModule",{value:!0});He.createConnectionConfig=He.isValidSolanaAddress=He.getSolanaMetadataAddress=He.decodeTokenMetadata=void 0;var $u=Pe,In=Cn,jn=Cs,Du=Zi;(0,Du.extendBorsh)();var Fu=new In.PublicKey(jn.METADATA_PROGRAM),qu=Fu.toBuffer(),Hu=new TextEncoder().encode(jn.METADATA_PREFIX),Vu=function(r){return eo(void 0,void 0,void 0,function(){return to(this,function(e){return[2,(0,$u.deserializeUnchecked)(jn.METADATA_SCHEMA,jn.Metadata,r)]})})};He.decodeTokenMetadata=Vu;function Gu(r){return eo(this,void 0,void 0,function(){var e;return to(this,function(t){switch(t.label){case 0:return e=new In.PublicKey(jn.METADATA_PROGRAM),[4,In.PublicKey.findProgramAddress([Hu,qu,r.toBuffer()],e)];case 1:return[2,t.sent()[0]]}})})}He.getSolanaMetadataAddress=Gu;var ju=function(r){try{return new In.PublicKey(r),!0}catch{return!1}};He.isValidSolanaAddress=ju;var Yu=function(r,e){return r===void 0&&(r=(0,In.clusterApiUrl)("mainnet-beta")),e===void 0&&(e="confirmed"),new In.Connection(r,e)};He.createConnectionConfig=Yu;var er={};Object.defineProperty(er,"__esModule",{value:!0});er.TOKEN_PROGRAM=void 0;er.TOKEN_PROGRAM="TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA";(function(r){var e=z&&z.__assign||function(){return e=Object.assign||function(y){for(var _,A=1,P=arguments.length;A<P;A++){_=arguments[A];for(var O in _)Object.prototype.hasOwnProperty.call(_,O)&&(y[O]=_[O])}return y},e.apply(this,arguments)},t=z&&z.__awaiter||function(y,_,A,P){function O(L){return L instanceof A?L:new A(function(X){X(L)})}return new(A||(A=Promise))(function(L,X){function ee(me){try{q(P.next(me))}catch(St){X(St)}}function se(me){try{q(P.throw(me))}catch(St){X(St)}}function q(me){me.done?L(me.value):O(me.value).then(ee,se)}q((P=P.apply(y,_||[])).next())})},n=z&&z.__generator||function(y,_){var A={label:0,sent:function(){if(L[0]&1)throw L[1];return L[1]},trys:[],ops:[]},P,O,L,X;return X={next:ee(0),throw:ee(1),return:ee(2)},typeof Symbol=="function"&&(X[Symbol.iterator]=function(){return this}),X;function ee(q){return function(me){return se([q,me])}}function se(q){if(P)throw new TypeError("Generator is already executing.");for(;A;)try{if(P=1,O&&(L=q[0]&2?O.return:q[0]?O.throw||((L=O.return)&&L.call(O),0):O.next)&&!(L=L.call(O,q[1])).done)return L;switch(O=0,L&&(q=[q[0]&2,L.value]),q[0]){case 0:case 1:L=q;break;case 4:return A.label++,{value:q[1],done:!1};case 5:A.label++,O=q[1],q=[0];continue;case 7:q=A.ops.pop(),A.trys.pop();continue;default:if(L=A.trys,!(L=L.length>0&&L[L.length-1])&&(q[0]===6||q[0]===2)){A=0;continue}if(q[0]===3&&(!L||q[1]>L[0]&&q[1]<L[3])){A.label=q[1];break}if(q[0]===6&&A.label<L[1]){A.label=L[1],L=q;break}if(L&&A.label<L[2]){A.label=L[2],A.ops.push(q);break}L[2]&&A.ops.pop(),A.trys.pop();continue}q=_.call(y,A)}catch(me){q=[6,me],O=0}finally{P=L=0}if(q[0]&5)throw q[1];return{value:q[0]?q[1]:void 0,done:!0}}},s=z&&z.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(r,"__esModule",{value:!0}),r.sanitizeMetaStrings=r.getParsedNftAccountsByOwner=void 0;var i=Cn,o=s(Eu),c=s(ys.exports),u=He,d=er,f;(function(y){y.updateAuthority="updateAuthority"})(f||(f={}));var g=function(y){var _=y.publicAddress,A=y.connection,P=A===void 0?(0,u.createConnectionConfig)():A,O=y.sanitize,L=O===void 0?!0:O,X=y.stringifyPubKeys,ee=X===void 0?!0:X,se=y.sort,q=se===void 0?!0:se,me=y.limit,St=me===void 0?5e3:me;return t(void 0,void 0,void 0,function(){var Xt,yn,vt,zt,Ut,bn,At,Ze,We,Mt,Qt;return n(this,function(It){switch(It.label){case 0:return Xt=(0,u.isValidSolanaAddress)(_),Xt?[4,P.getParsedTokenAccountsByOwner(new i.PublicKey(_),{programId:new i.PublicKey(d.TOKEN_PROGRAM)})]:[2,[]];case 1:return yn=It.sent().value,vt=yn.filter(function(we){var Se,$e,te,De,it,Ce,Wt,ot,Rt,dt,$t=(it=(De=(te=($e=(Se=we.account)===null||Se===void 0?void 0:Se.data)===null||$e===void 0?void 0:$e.parsed)===null||te===void 0?void 0:te.info)===null||De===void 0?void 0:De.tokenAmount)===null||it===void 0?void 0:it.uiAmount,Dt=(dt=(Rt=(ot=(Wt=(Ce=we.account)===null||Ce===void 0?void 0:Ce.data)===null||Wt===void 0?void 0:Wt.parsed)===null||ot===void 0?void 0:ot.info)===null||Rt===void 0?void 0:Rt.tokenAmount)===null||dt===void 0?void 0:dt.decimals;return Dt===0&&$t>=1}).map(function(we){var Se,$e,te,De,it=(De=(te=($e=(Se=we.account)===null||Se===void 0?void 0:Se.data)===null||$e===void 0?void 0:$e.parsed)===null||te===void 0?void 0:te.info)===null||De===void 0?void 0:De.mint;return new i.PublicKey(it)}),zt=vt==null?void 0:vt.slice(0,St),[4,Promise.allSettled(zt.map(u.getSolanaMetadataAddress))];case 2:return Ut=It.sent(),bn=Ut.filter(p).map(function(we){return we.value}),[4,Promise.allSettled((0,o.default)(bn,99).map(function(we){return P.getMultipleAccountsInfo(we)}))];case 3:return At=It.sent(),Ze=At.filter(function(we){var Se=we.status;return Se==="fulfilled"}).flatMap(function(we){return we.value}),!(Ze!=null&&Ze.length)||(Ze==null?void 0:Ze.length)===0?[2,[]]:[4,Promise.allSettled(Ze.map(function(we){var Se;return(0,u.decodeTokenMetadata)((Se=we)===null||Se===void 0?void 0:Se.data)}))];case 4:return We=It.sent(),Mt=We.filter(p).filter(k).map(function(we){var Se=we.value;return L?S(Se):Se}).map(function(we){return ee?h(we):we}),ee&&q?(Qt=(0,c.default)(Mt,[f.updateAuthority],["asc"]),[2,Qt]):[2,Mt]}})})};r.getParsedNftAccountsByOwner=g;var S=function(y){var _,A,P;return e(e({},y),{data:e(e({},y==null?void 0:y.data),{name:(0,r.sanitizeMetaStrings)((_=y==null?void 0:y.data)===null||_===void 0?void 0:_.name),symbol:(0,r.sanitizeMetaStrings)((A=y==null?void 0:y.data)===null||A===void 0?void 0:A.symbol),uri:(0,r.sanitizeMetaStrings)((P=y==null?void 0:y.data)===null||P===void 0?void 0:P.uri)})})},h=function(y){var _,A,P,O,L,X;return e(e({},y),{mint:(A=(_=y==null?void 0:y.mint)===null||_===void 0?void 0:_.toString)===null||A===void 0?void 0:A.call(_),updateAuthority:(O=(P=y==null?void 0:y.updateAuthority)===null||P===void 0?void 0:P.toString)===null||O===void 0?void 0:O.call(P),data:e(e({},y==null?void 0:y.data),{creators:(X=(L=y==null?void 0:y.data)===null||L===void 0?void 0:L.creators)===null||X===void 0?void 0:X.map(function(ee){var se,q;return e(e({},ee),{address:(q=(se=new i.PublicKey(ee==null?void 0:ee.address))===null||se===void 0?void 0:se.toString)===null||q===void 0?void 0:q.call(se)})})})})},b=function(y){return y.replace(/\0/g,"")};r.sanitizeMetaStrings=b;var p=function(y){return y&&y.status==="fulfilled"},k=function(y){var _,A,P,O=(P=(A=(_=y.value.data)===null||_===void 0?void 0:_.uri)===null||A===void 0?void 0:A.replace)===null||P===void 0?void 0:P.call(A,/\0/g,"");return O!==""&&O!==void 0}})(Hi);var no={};(function(r){var e=z&&z.__awaiter||function(u,d,f,g){function S(h){return h instanceof f?h:new f(function(b){b(h)})}return new(f||(f=Promise))(function(h,b){function p(_){try{y(g.next(_))}catch(A){b(A)}}function k(_){try{y(g.throw(_))}catch(A){b(A)}}function y(_){_.done?h(_.value):S(_.value).then(p,k)}y((g=g.apply(u,d||[])).next())})},t=z&&z.__generator||function(u,d){var f={label:0,sent:function(){if(h[0]&1)throw h[1];return h[1]},trys:[],ops:[]},g,S,h,b;return b={next:p(0),throw:p(1),return:p(2)},typeof Symbol=="function"&&(b[Symbol.iterator]=function(){return this}),b;function p(y){return function(_){return k([y,_])}}function k(y){if(g)throw new TypeError("Generator is already executing.");for(;f;)try{if(g=1,S&&(h=y[0]&2?S.return:y[0]?S.throw||((h=S.return)&&h.call(S),0):S.next)&&!(h=h.call(S,y[1])).done)return h;switch(S=0,h&&(y=[y[0]&2,h.value]),y[0]){case 0:case 1:h=y;break;case 4:return f.label++,{value:y[1],done:!1};case 5:f.label++,S=y[1],y=[0];continue;case 7:y=f.ops.pop(),f.trys.pop();continue;default:if(h=f.trys,!(h=h.length>0&&h[h.length-1])&&(y[0]===6||y[0]===2)){f=0;continue}if(y[0]===3&&(!h||y[1]>h[0]&&y[1]<h[3])){f.label=y[1];break}if(y[0]===6&&f.label<h[1]){f.label=h[1],h=y;break}if(h&&f.label<h[2]){f.label=h[2],f.ops.push(y);break}h[2]&&f.ops.pop(),f.trys.pop();continue}y=d.call(u,f)}catch(_){y=[6,_],S=0}finally{g=h=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.getParsedNftAccountsByUpdateAuthority=r.createConnectionConfig=void 0;var n=Cn,s=Cs,i=He,o=function(u,d){return u===void 0&&(u=(0,n.clusterApiUrl)("mainnet-beta")),d===void 0&&(d="confirmed"),new n.Connection(u,d)};r.createConnectionConfig=o;var c=function(u){var d=u.updateAuthority,f=u.connection,g=f===void 0?(0,r.createConnectionConfig)():f;return e(void 0,void 0,void 0,function(){var S,h,b;return t(this,function(p){switch(p.label){case 0:return p.trys.push([0,3,,4]),[4,g.getProgramAccounts(new n.PublicKey(s.METADATA_PROGRAM),{encoding:"base64",filters:[{memcmp:{offset:1,bytes:d}}]})];case 1:return S=p.sent(),[4,Promise.all(S.map(function(k){return(0,i.decodeTokenMetadata)(k.account.data)}))];case 2:return h=p.sent(),[2,h];case 3:return b=p.sent(),console.error(b),[2,[]];case 4:return[2]}})})};r.getParsedNftAccountsByUpdateAuthority=c})(no);var xr={},wn=z&&z.__assign||function(){return wn=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=e[s])}return r},wn.apply(this,arguments)},Ju=z&&z.__awaiter||function(r,e,t,n){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function c(f){try{d(n.next(f))}catch(g){o(g)}}function u(f){try{d(n.throw(f))}catch(g){o(g)}}function d(f){f.done?i(f.value):s(f.value).then(c,u)}d((n=n.apply(r,e||[])).next())})},Xu=z&&z.__generator||function(r,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,s,i,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(d){return function(f){return u([d,f])}}function u(d){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,s&&(i=d[0]&2?s.return:d[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,d[1])).done)return i;switch(s=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,s=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){t.label=d[1];break}if(d[0]===6&&t.label<i[1]){t.label=i[1],i=d;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(d);break}i[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(r,t)}catch(f){d=[6,f],s=0}finally{n=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}};Object.defineProperty(xr,"__esModule",{value:!0});xr.getParsedAccountByMint=void 0;var bs=Cn,Qu=er,Zu=He;function el(r){return(r==null?void 0:r.parsed)!==void 0}var tl=function(r){var e=r.mintAddress,t=r.connection,n=t===void 0?(0,Zu.createConnectionConfig)():t,s=r.stringifyPubKeys,i=s===void 0?!0:s;return Ju(void 0,void 0,void 0,function(){var o,c,u;return Xu(this,function(d){switch(d.label){case 0:return[4,n.getParsedProgramAccounts(new bs.PublicKey(Qu.TOKEN_PROGRAM),{filters:[{dataSize:165},{memcmp:{offset:0,bytes:e}}]})];case 1:return o=d.sent(),o!=null&&o.length?(c=o==null?void 0:o.find(function(f){var g,S,h,b=f.account,p=b.data;if(el(p)){var k=+((h=(S=(g=p==null?void 0:p.parsed)===null||g===void 0?void 0:g.info)===null||S===void 0?void 0:S.tokenAmount)===null||h===void 0?void 0:h.amount);return k}return!1}),u=i?nl(c):c,[2,u]):[2,void 0]}})})};xr.getParsedAccountByMint=tl;var nl=function(r){var e,t,n,s;return wn(wn({},r),{account:wn(wn({},r==null?void 0:r.account),{owner:(t=(e=new bs.PublicKey(r==null?void 0:r.account.owner))===null||e===void 0?void 0:e.toString)===null||t===void 0?void 0:t.call(e)}),pubkey:(s=(n=new bs.PublicKey(r==null?void 0:r.pubkey))===null||n===void 0?void 0:n.toString)===null||s===void 0?void 0:s.call(n)})},ro={},so={},Kr={},Oe={},rl=z&&z.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),sl=z&&z.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),mt=z&&z.__decorate||function(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(o=r[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i},il=z&&z.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.hasOwnProperty.call(r,t)&&rl(e,r,t);return sl(e,r),e},io=z&&z.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Oe,"__esModule",{value:!0});var oo=Oe.deserializeUnchecked=ho=Oe.deserialize=fo=Oe.serialize=Oe.BinaryReader=Oe.BinaryWriter=Oe.BorshError=Oe.baseDecode=Oe.baseEncode=void 0;const jt=io(Lr.exports),ao=io(Ie),ol=il(As),al=typeof TextDecoder!="function"?ol.TextDecoder:TextDecoder,cl=new al("utf-8",{fatal:!0});function ul(r){return typeof r=="string"&&(r=M.Buffer.from(r,"utf8")),ao.default.encode(M.Buffer.from(r))}Oe.baseEncode=ul;function ll(r){return M.Buffer.from(ao.default.decode(r))}Oe.baseDecode=ll;const is=1024;class Me extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}Oe.BorshError=Me;class co{constructor(){this.buf=M.Buffer.alloc(is),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=M.Buffer.concat([this.buf,M.Buffer.alloc(is)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(M.Buffer.from(new jt.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(M.Buffer.from(new jt.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(M.Buffer.from(new jt.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(M.Buffer.from(new jt.default(e).toArray("le",64)))}writeBuffer(e){this.buf=M.Buffer.concat([M.Buffer.from(this.buf.subarray(0,this.length)),e,M.Buffer.alloc(is)]),this.length+=e.length}writeString(e){this.maybeResize();const t=M.Buffer.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(M.Buffer.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const n of e)this.maybeResize(),t(n)}toArray(){return this.buf.subarray(0,this.length)}}Oe.BinaryWriter=co;function wt(r,e,t){const n=t.value;t.value=function(...s){try{return n.apply(this,s)}catch(i){if(i instanceof RangeError){const o=i.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(o)>=0)throw new Me("Reached the end of buffer when deserializing")}throw i}}}class Xe{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new jt.default(e,"le")}readU128(){const e=this.readBuffer(16);return new jt.default(e,"le")}readU256(){const e=this.readBuffer(32);return new jt.default(e,"le")}readU512(){const e=this.readBuffer(64);return new jt.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new Me(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return cl.decode(t)}catch(n){throw new Me(`Error decoding UTF-8 string: ${n}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),n=Array();for(let s=0;s<t;++s)n.push(e());return n}}mt([wt],Xe.prototype,"readU8",null);mt([wt],Xe.prototype,"readU16",null);mt([wt],Xe.prototype,"readU32",null);mt([wt],Xe.prototype,"readU64",null);mt([wt],Xe.prototype,"readU128",null);mt([wt],Xe.prototype,"readU256",null);mt([wt],Xe.prototype,"readU512",null);mt([wt],Xe.prototype,"readString",null);mt([wt],Xe.prototype,"readFixedArray",null);mt([wt],Xe.prototype,"readArray",null);Oe.BinaryReader=Xe;function uo(r){return r.charAt(0).toUpperCase()+r.slice(1)}function sn(r,e,t,n,s){try{if(typeof n=="string")s[`write${uo(n)}`](t);else if(n instanceof Array)if(typeof n[0]=="number"){if(t.length!==n[0])throw new Me(`Expecting byte array of length ${n[0]}, but got ${t.length} bytes`);s.writeFixedArray(t)}else if(n.length===2&&typeof n[1]=="number"){if(t.length!==n[1])throw new Me(`Expecting byte array of length ${n[1]}, but got ${t.length} bytes`);for(let i=0;i<n[1];i++)sn(r,null,t[i],n[0],s)}else s.writeArray(t,i=>{sn(r,e,i,n[0],s)});else if(n.kind!==void 0)switch(n.kind){case"option":{t==null?s.writeU8(0):(s.writeU8(1),sn(r,e,t,n.type,s));break}case"map":{s.writeU32(t.size),t.forEach((i,o)=>{sn(r,e,o,n.key,s),sn(r,e,i,n.value,s)});break}default:throw new Me(`FieldType ${n} unrecognized`)}else lo(r,t,s)}catch(i){throw i instanceof Me&&i.addToFieldPath(e),i}}function lo(r,e,t){if(typeof e.borshSerialize=="function"){e.borshSerialize(t);return}const n=r.get(e.constructor);if(!n)throw new Me(`Class ${e.constructor.name} is missing in schema`);if(n.kind==="struct")n.fields.map(([s,i])=>{sn(r,s,e[s],i,t)});else if(n.kind==="enum"){const s=e[n.field];for(let i=0;i<n.values.length;++i){const[o,c]=n.values[i];if(o===s){t.writeU8(i),sn(r,o,e[o],c,t);break}}}else throw new Me(`Unexpected schema kind: ${n.kind} for ${e.constructor.name}`)}function dl(r,e,t=co){const n=new t;return lo(r,e,n),n.toArray()}var fo=Oe.serialize=dl;function on(r,e,t,n){try{if(typeof t=="string")return n[`read${uo(t)}`]();if(t instanceof Array){if(typeof t[0]=="number")return n.readFixedArray(t[0]);if(typeof t[1]=="number"){const s=[];for(let i=0;i<t[1];i++)s.push(on(r,null,t[0],n));return s}else return n.readArray(()=>on(r,e,t[0],n))}if(t.kind==="option")return n.readU8()?on(r,e,t.type,n):void 0;if(t.kind==="map"){let s=new Map;const i=n.readU32();for(let o=0;o<i;o++){const c=on(r,e,t.key,n),u=on(r,e,t.value,n);s.set(c,u)}return s}return Os(r,t,n)}catch(s){throw s instanceof Me&&s.addToFieldPath(e),s}}function Os(r,e,t){if(typeof e.borshDeserialize=="function")return e.borshDeserialize(t);const n=r.get(e);if(!n)throw new Me(`Class ${e.name} is missing in schema`);if(n.kind==="struct"){const s={};for(const[i,o]of r.get(e).fields)s[i]=on(r,i,o,t);return new e(s)}if(n.kind==="enum"){const s=t.readU8();if(s>=n.values.length)throw new Me(`Enum index: ${s} is out of range`);const[i,o]=n.values[s],c=on(r,i,o,t);return new e({[i]:c})}throw new Me(`Unexpected schema kind: ${n.kind} for ${e.constructor.name}`)}function fl(r,e,t,n=Xe){const s=new n(t),i=Os(r,e,s);if(s.offset<t.length)throw new Me(`Unexpected ${t.length-s.offset} bytes after deserialized data`);return i}var ho=Oe.deserialize=fl;function hl(r,e,t,n=Xe){const s=new n(t);return Os(r,e,s)}oo=Oe.deserializeUnchecked=hl;const gl=On.utils.randomPrivateKey,bi=()=>{const r=On.utils.randomPrivateKey(),e=Tr(r),t=new Uint8Array(64);return t.set(r),t.set(e,32),{publicKey:e,secretKey:t}},Tr=On.getPublicKey;function pi(r){try{return On.ExtendedPoint.fromHex(r),!0}catch{return!1}}const Ns=(r,e)=>On.sign(r,e.slice(0,32)),yl=On.verify,Z=r=>V.Buffer.isBuffer(r)?r:r instanceof Uint8Array?V.Buffer.from(r.buffer,r.byteOffset,r.byteLength):V.Buffer.from(r);class Ls{constructor(e){Object.assign(this,e)}encode(){return V.Buffer.from(fo(Gn,this))}static decode(e){return ho(Gn,this,e)}static decodeUnchecked(e){return oo(Gn,this,e)}}class bl extends Ls{constructor(e){if(super(e),this.enum="",Object.keys(e).length!==1)throw new Error("Enum can only take single value");Object.keys(e).map(t=>{this.enum=t})}}const Gn=new Map;var go;let yo;const bo=32,Ye=32;function pl(r){return r._bn!==void 0}let mi=1;yo=Symbol.toStringTag;class E extends Ls{constructor(e){if(super({}),this._bn=void 0,pl(e))this._bn=e._bn;else{if(typeof e=="string"){const t=Ie.decode(e);if(t.length!=Ye)throw new Error("Invalid public key input");this._bn=new ci(t)}else this._bn=new ci(e);if(this._bn.byteLength()>Ye)throw new Error("Invalid public key input")}}static unique(){const e=new E(mi);return mi+=1,new E(e.toBuffer())}equals(e){return this._bn.eq(e._bn)}toBase58(){return Ie.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){const e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}toBuffer(){const e=this._bn.toArrayLike(V.Buffer);if(e.length===Ye)return e;const t=V.Buffer.alloc(32);return e.copy(t,32-e.length),t}get[yo](){return`PublicKey(${this.toString()})`}toString(){return this.toBase58()}static async createWithSeed(e,t,n){const s=V.Buffer.concat([e.toBuffer(),V.Buffer.from(t),n.toBuffer()]),i=ui(s);return new E(i)}static createProgramAddressSync(e,t){let n=V.Buffer.alloc(0);e.forEach(function(i){if(i.length>bo)throw new TypeError("Max seed length exceeded");n=V.Buffer.concat([n,Z(i)])}),n=V.Buffer.concat([n,t.toBuffer(),V.Buffer.from("ProgramDerivedAddress")]);const s=ui(n);if(pi(s))throw new Error("Invalid seeds, address must fall off the curve");return new E(s)}static async createProgramAddress(e,t){return this.createProgramAddressSync(e,t)}static findProgramAddressSync(e,t){let n=255,s;for(;n!=0;){try{const i=e.concat(V.Buffer.from([n]));s=this.createProgramAddressSync(i,t)}catch(i){if(i instanceof TypeError)throw i;n--;continue}return[s,n]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(e,t){return this.findProgramAddressSync(e,t)}static isOnCurve(e){const t=new E(e);return pi(t.toBytes())}}go=E;E.default=new go("11111111111111111111111111111111");Gn.set(E,{kind:"struct",fields:[["_bn","u256"]]});class ml{constructor(e){if(this._publicKey=void 0,this._secretKey=void 0,e){const t=Z(e);if(e.length!==64)throw new Error("bad secret key size");this._publicKey=t.slice(32,64),this._secretKey=t.slice(0,32)}else this._secretKey=Z(gl()),this._publicKey=Z(Tr(this._secretKey))}get publicKey(){return new E(this._publicKey)}get secretKey(){return V.Buffer.concat([this._secretKey,this._publicKey],64)}}const wl=new E("BPFLoader1111111111111111111111111111111111"),Jt=1280-40-8,zr=127,Rn=64;class xs extends Error{constructor(e){super(`Signature ${e} has expired: block height exceeded.`),this.signature=void 0,this.signature=e}}Object.defineProperty(xs.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class Ks extends Error{constructor(e,t){super(`Transaction was not confirmed in ${t.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${e} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=e}}Object.defineProperty(Ks.prototype,"name",{value:"TransactionExpiredTimeoutError"});class _n extends Error{constructor(e){super(`Signature ${e} has expired: the nonce is no longer valid.`),this.signature=void 0,this.signature=e}}Object.defineProperty(_n.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});class Yn{constructor(e,t){this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=e,this.accountKeysFromLookups=t}keySegments(){const e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}get(e){for(const t of this.keySegments()){if(e<t.length)return t[e];e-=t.length}}get length(){return this.keySegments().flat().length}compileInstructions(e){if(this.length>255+1)throw new Error("Account index overflow encountered during compilation");const n=new Map;this.keySegments().flat().forEach((i,o)=>{n.set(i.toBase58(),o)});const s=i=>{const o=n.get(i.toBase58());if(o===void 0)throw new Error("Encountered an unknown instruction account key during compilation");return o};return e.map(i=>({programIdIndex:s(i.programId),accountKeyIndexes:i.keys.map(o=>s(o.pubkey)),data:i.data}))}}const re=(r="publicKey")=>pe(32,r),_l=(r="signature")=>pe(64,r),cn=(r="string")=>{const e=W([$("length"),$("lengthPadding"),pe(un($(),-8),"chars")],r),t=e.decode.bind(e),n=e.encode.bind(e),s=e;return s.decode=(i,o)=>t(i,o).chars.toString(),s.encode=(i,o,c)=>{const u={chars:V.Buffer.from(i,"utf8")};return n(u,o,c)},s.alloc=i=>$().span+$().span+V.Buffer.from(i,"utf8").length,s},kl=(r="authorized")=>W([re("staker"),re("withdrawer")],r),Sl=(r="lockup")=>W([rt("unixTimestamp"),rt("epoch"),re("custodian")],r),vl=(r="voteInit")=>W([re("nodePubkey"),re("authorizedVoter"),re("authorizedWithdrawer"),ue("commission")],r),Al=(r="voteAuthorizeWithSeedArgs")=>W([$("voteAuthorizationType"),re("currentAuthorityDerivedKeyOwnerPubkey"),cn("currentAuthorityDerivedKeySeed"),re("newAuthorized")],r);function po(r,e){const t=s=>{if(s.span>=0)return s.span;if(typeof s.alloc=="function")return s.alloc(e[s.property]);if("count"in s&&"elementLayout"in s){const i=e[s.property];if(Array.isArray(i))return i.length*t(s.elementLayout)}else if("fields"in s)return po({layout:s},e[s.property]);return 0};let n=0;return r.layout.fields.forEach(s=>{n+=t(s)}),n}function qe(r){let e=0,t=0;for(;;){let n=r.shift();if(e|=(n&127)<<t*7,t+=1,(n&128)===0)break}return e}function je(r,e){let t=e;for(;;){let n=t&127;if(t>>=7,t==0){r.push(n);break}else n|=128,r.push(n)}}function ce(r,e){if(!r)throw new Error(e||"Assertion failed")}class Ur{constructor(e,t){this.payer=void 0,this.keyMetaMap=void 0,this.payer=e,this.keyMetaMap=t}static compile(e,t){const n=new Map,s=o=>{const c=o.toBase58();let u=n.get(c);return u===void 0&&(u={isSigner:!1,isWritable:!1,isInvoked:!1},n.set(c,u)),u},i=s(t);i.isSigner=!0,i.isWritable=!0;for(const o of e){s(o.programId).isInvoked=!0;for(const c of o.keys){const u=s(c.pubkey);u.isSigner||=c.isSigner,u.isWritable||=c.isWritable}}return new Ur(t,n)}getMessageComponents(){const e=[...this.keyMetaMap.entries()];ce(e.length<=256,"Max static account keys length exceeded");const t=e.filter(([,u])=>u.isSigner&&u.isWritable),n=e.filter(([,u])=>u.isSigner&&!u.isWritable),s=e.filter(([,u])=>!u.isSigner&&u.isWritable),i=e.filter(([,u])=>!u.isSigner&&!u.isWritable),o={numRequiredSignatures:t.length+n.length,numReadonlySignedAccounts:n.length,numReadonlyUnsignedAccounts:i.length};{ce(t.length>0,"Expected at least one writable signer key");const[u]=t[0];ce(u===this.payer.toBase58(),"Expected first writable signer key to be the fee payer")}const c=[...t.map(([u])=>new E(u)),...n.map(([u])=>new E(u)),...s.map(([u])=>new E(u)),...i.map(([u])=>new E(u))];return[o,c]}extractTableLookup(e){const[t,n]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&o.isWritable),[s,i]=this.drainKeysFoundInLookupTable(e.state.addresses,o=>!o.isSigner&&!o.isInvoked&&!o.isWritable);if(!(t.length===0&&s.length===0))return[{accountKey:e.key,writableIndexes:t,readonlyIndexes:s},{writable:n,readonly:i}]}drainKeysFoundInLookupTable(e,t){const n=new Array,s=new Array;for(const[i,o]of this.keyMetaMap.entries())if(t(o)){const c=new E(i),u=e.findIndex(d=>d.equals(c));u>=0&&(ce(u<256,"Max lookup table index exceeded"),n.push(u),s.push(c),this.keyMetaMap.delete(i))}return[n,s]}}class lt{constructor(e){this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=e.header,this.accountKeys=e.accountKeys.map(t=>new E(t)),this.recentBlockhash=e.recentBlockhash,this.instructions=e.instructions,this.instructions.forEach(t=>this.indexToProgramIds.set(t.programIdIndex,this.accountKeys[t.programIdIndex]))}get version(){return"legacy"}get staticAccountKeys(){return this.accountKeys}get compiledInstructions(){return this.instructions.map(e=>({programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:Ie.decode(e.data)}))}get addressTableLookups(){return[]}getAccountKeys(){return new Yn(this.staticAccountKeys)}static compile(e){const t=Ur.compile(e.instructions,e.payerKey),[n,s]=t.getMessageComponents(),o=new Yn(s).compileInstructions(e.instructions).map(c=>({programIdIndex:c.programIdIndex,accounts:c.accountKeyIndexes,data:Ie.encode(c.data)}));return new lt({header:n,accountKeys:s,recentBlockhash:e.recentBlockhash,instructions:o})}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures;if(e>=this.header.numRequiredSignatures){const n=e-t,i=this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts;return n<i}else{const n=t-this.header.numReadonlySignedAccounts;return e<n}}isProgramId(e){return this.indexToProgramIds.has(e)}programIds(){return[...this.indexToProgramIds.values()]}nonProgramIds(){return this.accountKeys.filter((e,t)=>!this.isProgramId(t))}serialize(){const e=this.accountKeys.length;let t=[];je(t,e);const n=this.instructions.map(g=>{const{accounts:S,programIdIndex:h}=g,b=Array.from(Ie.decode(g.data));let p=[];je(p,S.length);let k=[];return je(k,b.length),{programIdIndex:h,keyIndicesCount:V.Buffer.from(p),keyIndices:S,dataLength:V.Buffer.from(k),data:b}});let s=[];je(s,n.length);let i=V.Buffer.alloc(Jt);V.Buffer.from(s).copy(i);let o=s.length;n.forEach(g=>{o+=W([ue("programIdIndex"),pe(g.keyIndicesCount.length,"keyIndicesCount"),Ke(ue("keyIndex"),g.keyIndices.length,"keyIndices"),pe(g.dataLength.length,"dataLength"),Ke(ue("userdatum"),g.data.length,"data")]).encode(g,i,o)}),i=i.slice(0,o);const c=W([pe(1,"numRequiredSignatures"),pe(1,"numReadonlySignedAccounts"),pe(1,"numReadonlyUnsignedAccounts"),pe(t.length,"keyCount"),Ke(re("key"),e,"keys"),re("recentBlockhash")]),u={numRequiredSignatures:V.Buffer.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:V.Buffer.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:V.Buffer.from([this.header.numReadonlyUnsignedAccounts]),keyCount:V.Buffer.from(t),keys:this.accountKeys.map(g=>Z(g.toBytes())),recentBlockhash:Ie.decode(this.recentBlockhash)};let d=V.Buffer.alloc(2048);const f=c.encode(u,d);return i.copy(d,f),d.slice(0,f+i.length)}static from(e){let t=[...e];const n=t.shift();if(n!==(n&zr))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");const s=t.shift(),i=t.shift(),o=qe(t);let c=[];for(let S=0;S<o;S++){const h=t.slice(0,Ye);t=t.slice(Ye),c.push(new E(V.Buffer.from(h)))}const u=t.slice(0,Ye);t=t.slice(Ye);const d=qe(t);let f=[];for(let S=0;S<d;S++){const h=t.shift(),b=qe(t),p=t.slice(0,b);t=t.slice(b);const k=qe(t),y=t.slice(0,k),_=Ie.encode(V.Buffer.from(y));t=t.slice(k),f.push({programIdIndex:h,accounts:p,data:_})}const g={header:{numRequiredSignatures:n,numReadonlySignedAccounts:s,numReadonlyUnsignedAccounts:i},recentBlockhash:Ie.encode(V.Buffer.from(u)),accountKeys:c,instructions:f};return new lt(g)}}class ln{constructor(e){this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=e.header,this.staticAccountKeys=e.staticAccountKeys,this.recentBlockhash=e.recentBlockhash,this.compiledInstructions=e.compiledInstructions,this.addressTableLookups=e.addressTableLookups}get version(){return 0}get numAccountKeysFromLookups(){let e=0;for(const t of this.addressTableLookups)e+=t.readonlyIndexes.length+t.writableIndexes.length;return e}getAccountKeys(e){let t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new Yn(this.staticAccountKeys,t)}isAccountSigner(e){return e<this.header.numRequiredSignatures}isAccountWritable(e){const t=this.header.numRequiredSignatures,n=this.staticAccountKeys.length;if(e>=n){const s=e-n,i=this.addressTableLookups.reduce((o,c)=>o+c.writableIndexes.length,0);return s<i}else if(e>=this.header.numRequiredSignatures){const s=e-t,o=n-t-this.header.numReadonlyUnsignedAccounts;return s<o}else{const s=t-this.header.numReadonlySignedAccounts;return e<s}}resolveAddressTableLookups(e){const t={writable:[],readonly:[]};for(const n of this.addressTableLookups){const s=e.find(i=>i.key.equals(n.accountKey));if(!s)throw new Error(`Failed to find address lookup table account for table key ${n.accountKey.toBase58()}`);for(const i of n.writableIndexes)if(i<s.state.addresses.length)t.writable.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${n.accountKey.toBase58()}`);for(const i of n.readonlyIndexes)if(i<s.state.addresses.length)t.readonly.push(s.state.addresses[i]);else throw new Error(`Failed to find address for index ${i} in address lookup table ${n.accountKey.toBase58()}`)}return t}static compile(e){const t=Ur.compile(e.instructions,e.payerKey),n=new Array,s={writable:new Array,readonly:new Array},i=e.addressLookupTableAccounts||[];for(const f of i){const g=t.extractTableLookup(f);if(g!==void 0){const[S,{writable:h,readonly:b}]=g;n.push(S),s.writable.push(...h),s.readonly.push(...b)}}const[o,c]=t.getMessageComponents(),d=new Yn(c,s).compileInstructions(e.instructions);return new ln({header:o,staticAccountKeys:c,recentBlockhash:e.recentBlockhash,compiledInstructions:d,addressTableLookups:n})}serialize(){const e=Array();je(e,this.staticAccountKeys.length);const t=this.serializeInstructions(),n=Array();je(n,this.compiledInstructions.length);const s=this.serializeAddressTableLookups(),i=Array();je(i,this.addressTableLookups.length);const o=W([ue("prefix"),W([ue("numRequiredSignatures"),ue("numReadonlySignedAccounts"),ue("numReadonlyUnsignedAccounts")],"header"),pe(e.length,"staticAccountKeysLength"),Ke(re(),this.staticAccountKeys.length,"staticAccountKeys"),re("recentBlockhash"),pe(n.length,"instructionsLength"),pe(t.length,"serializedInstructions"),pe(i.length,"addressTableLookupsLength"),pe(s.length,"serializedAddressTableLookups")]),c=new Uint8Array(Jt),u=1<<7,d=o.encode({prefix:u,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map(f=>f.toBytes()),recentBlockhash:Ie.decode(this.recentBlockhash),instructionsLength:new Uint8Array(n),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(i),serializedAddressTableLookups:s},c);return c.slice(0,d)}serializeInstructions(){let e=0;const t=new Uint8Array(Jt);for(const n of this.compiledInstructions){const s=Array();je(s,n.accountKeyIndexes.length);const i=Array();je(i,n.data.length),e+=W([ue("programIdIndex"),pe(s.length,"encodedAccountKeyIndexesLength"),Ke(ue(),n.accountKeyIndexes.length,"accountKeyIndexes"),pe(i.length,"encodedDataLength"),pe(n.data.length,"data")]).encode({programIdIndex:n.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(s),accountKeyIndexes:n.accountKeyIndexes,encodedDataLength:new Uint8Array(i),data:n.data},t,e)}return t.slice(0,e)}serializeAddressTableLookups(){let e=0;const t=new Uint8Array(Jt);for(const n of this.addressTableLookups){const s=Array();je(s,n.writableIndexes.length);const i=Array();je(i,n.readonlyIndexes.length),e+=W([re("accountKey"),pe(s.length,"encodedWritableIndexesLength"),Ke(ue(),n.writableIndexes.length,"writableIndexes"),pe(i.length,"encodedReadonlyIndexesLength"),Ke(ue(),n.readonlyIndexes.length,"readonlyIndexes")]).encode({accountKey:n.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(s),writableIndexes:n.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(i),readonlyIndexes:n.readonlyIndexes},t,e)}return t.slice(0,e)}static deserialize(e){let t=[...e];const n=t.shift(),s=n&zr;ce(n!==s,"Expected versioned message but received legacy message");const i=s;ce(i===0,`Expected versioned message with version 0 but found version ${i}`);const o={numRequiredSignatures:t.shift(),numReadonlySignedAccounts:t.shift(),numReadonlyUnsignedAccounts:t.shift()},c=[],u=qe(t);for(let b=0;b<u;b++)c.push(new E(t.splice(0,Ye)));const d=Ie.encode(t.splice(0,Ye)),f=qe(t),g=[];for(let b=0;b<f;b++){const p=t.shift(),k=qe(t),y=t.splice(0,k),_=qe(t),A=new Uint8Array(t.splice(0,_));g.push({programIdIndex:p,accountKeyIndexes:y,data:A})}const S=qe(t),h=[];for(let b=0;b<S;b++){const p=new E(t.splice(0,Ye)),k=qe(t),y=t.splice(0,k),_=qe(t),A=t.splice(0,_);h.push({accountKey:p,writableIndexes:y,readonlyIndexes:A})}return new ln({header:o,staticAccountKeys:c,recentBlockhash:d,compiledInstructions:g,addressTableLookups:h})}}const zs={deserializeMessageVersion(r){const e=r[0],t=e&zr;return t===e?"legacy":t},deserialize:r=>{const e=zs.deserializeMessageVersion(r);if(e==="legacy")return lt.from(r);if(e===0)return ln.deserialize(r);throw new Error(`Transaction message version ${e} deserialization is not supported`)}};let Nt=function(r){return r[r.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",r[r.PROCESSED=1]="PROCESSED",r[r.TIMED_OUT=2]="TIMED_OUT",r[r.NONCE_INVALID=3]="NONCE_INVALID",r}({});const Il=V.Buffer.alloc(Rn).fill(0);class he{constructor(e){this.keys=void 0,this.programId=void 0,this.data=V.Buffer.alloc(0),this.programId=e.programId,this.keys=e.keys,e.data&&(this.data=e.data)}toJSON(){return{keys:this.keys.map(({pubkey:e,isSigner:t,isWritable:n})=>({pubkey:e.toJSON(),isSigner:t,isWritable:n})),programId:this.programId.toJSON(),data:[...this.data]}}}class de{get signature(){return this.signatures.length>0?this.signatures[0].signature:null}constructor(e){if(this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,!!e)if(e.feePayer&&(this.feePayer=e.feePayer),e.signatures&&(this.signatures=e.signatures),Object.prototype.hasOwnProperty.call(e,"nonceInfo")){const{minContextSlot:t,nonceInfo:n}=e;this.minNonceContextSlot=t,this.nonceInfo=n}else if(Object.prototype.hasOwnProperty.call(e,"lastValidBlockHeight")){const{blockhash:t,lastValidBlockHeight:n}=e;this.recentBlockhash=t,this.lastValidBlockHeight=n}else{const{recentBlockhash:t,nonceInfo:n}=e;n&&(this.nonceInfo=n),this.recentBlockhash=t}}toJSON(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map(e=>e.toJSON()),signers:this.signatures.map(({publicKey:e})=>e.toJSON())}}add(...e){if(e.length===0)throw new Error("No instructions");return e.forEach(t=>{"instructions"in t?this.instructions=this.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?this.instructions.push(t):this.instructions.push(new he(t))}),this}compileMessage(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;let e,t;if(this.nonceInfo?(e=this.nonceInfo.nonce,this.instructions[0]!=this.nonceInfo.nonceInstruction?t=[this.nonceInfo.nonceInstruction,...this.instructions]:t=this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");t.length<1&&console.warn("No instructions provided");let n;if(this.feePayer)n=this.feePayer;else if(this.signatures.length>0&&this.signatures[0].publicKey)n=this.signatures[0].publicKey;else throw new Error("Transaction fee payer required");for(let p=0;p<t.length;p++)if(t[p].programId===void 0)throw new Error(`Transaction instruction index ${p} has undefined program id`);const s=[],i=[];t.forEach(p=>{p.keys.forEach(y=>{i.push({...y})});const k=p.programId.toString();s.includes(k)||s.push(k)}),s.forEach(p=>{i.push({pubkey:new E(p),isSigner:!1,isWritable:!1})});const o=[];i.forEach(p=>{const k=p.pubkey.toString(),y=o.findIndex(_=>_.pubkey.toString()===k);y>-1?(o[y].isWritable=o[y].isWritable||p.isWritable,o[y].isSigner=o[y].isSigner||p.isSigner):o.push(p)}),o.sort(function(p,k){if(p.isSigner!==k.isSigner)return p.isSigner?-1:1;if(p.isWritable!==k.isWritable)return p.isWritable?-1:1;const y={localeMatcher:"best fit",usage:"sort",sensitivity:"variant",ignorePunctuation:!1,numeric:!1,caseFirst:"lower"};return p.pubkey.toBase58().localeCompare(k.pubkey.toBase58(),"en",y)});const c=o.findIndex(p=>p.pubkey.equals(n));if(c>-1){const[p]=o.splice(c,1);p.isSigner=!0,p.isWritable=!0,o.unshift(p)}else o.unshift({pubkey:n,isSigner:!0,isWritable:!0});for(const p of this.signatures){const k=o.findIndex(y=>y.pubkey.equals(p.publicKey));if(k>-1)o[k].isSigner||(o[k].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."));else throw new Error(`unknown signer: ${p.publicKey.toString()}`)}let u=0,d=0,f=0;const g=[],S=[];o.forEach(({pubkey:p,isSigner:k,isWritable:y})=>{k?(g.push(p.toString()),u+=1,y||(d+=1)):(S.push(p.toString()),y||(f+=1))});const h=g.concat(S),b=t.map(p=>{const{data:k,programId:y}=p;return{programIdIndex:h.indexOf(y.toString()),accounts:p.keys.map(_=>h.indexOf(_.pubkey.toString())),data:Ie.encode(k)}});return b.forEach(p=>{ce(p.programIdIndex>=0),p.accounts.forEach(k=>ce(k>=0))}),new lt({header:{numRequiredSignatures:u,numReadonlySignedAccounts:d,numReadonlyUnsignedAccounts:f},accountKeys:h,recentBlockhash:e,instructions:b})}_compile(){const e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);return this.signatures.length===t.length&&this.signatures.every((s,i)=>t[i].equals(s.publicKey))||(this.signatures=t.map(n=>({signature:null,publicKey:n}))),e}serializeMessage(){return this._compile().serialize()}async getEstimatedFee(e){return(await e.getFeeForMessage(this.compileMessage())).value}setSigners(...e){if(e.length===0)throw new Error("No signers");const t=new Set;this.signatures=e.filter(n=>{const s=n.toString();return t.has(s)?!1:(t.add(s),!0)}).map(n=>({signature:null,publicKey:n}))}sign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const i of e){const o=i.publicKey.toString();t.has(o)||(t.add(o),n.push(i))}this.signatures=n.map(i=>({signature:null,publicKey:i.publicKey}));const s=this._compile();this._partialSign(s,...n)}partialSign(...e){if(e.length===0)throw new Error("No signers");const t=new Set,n=[];for(const i of e){const o=i.publicKey.toString();t.has(o)||(t.add(o),n.push(i))}const s=this._compile();this._partialSign(s,...n)}_partialSign(e,...t){const n=e.serialize();t.forEach(s=>{const i=Ns(n,s.secretKey);this._addSignature(s.publicKey,Z(i))})}addSignature(e,t){this._compile(),this._addSignature(e,t)}_addSignature(e,t){ce(t.length===64);const n=this.signatures.findIndex(s=>e.equals(s.publicKey));if(n<0)throw new Error(`unknown signer: ${e.toString()}`);this.signatures[n].signature=V.Buffer.from(t)}verifySignatures(e){return this._verifySignatures(this.serializeMessage(),e===void 0?!0:e)}_verifySignatures(e,t){for(const{signature:n,publicKey:s}of this.signatures)if(n===null){if(t)return!1}else if(!yl(n,e,s.toBytes()))return!1;return!0}serialize(e){const{requireAllSignatures:t,verifySignatures:n}=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),s=this.serializeMessage();if(n&&!this._verifySignatures(s,t))throw new Error("Signature verification failed");return this._serialize(s)}_serialize(e){const{signatures:t}=this,n=[];je(n,t.length);const s=n.length+t.length*64+e.length,i=V.Buffer.alloc(s);return ce(t.length<256),V.Buffer.from(n).copy(i,0),t.forEach(({signature:o},c)=>{o!==null&&(ce(o.length===64,"signature has invalid length"),V.Buffer.from(o).copy(i,n.length+c*64))}),e.copy(i,n.length+t.length*64),ce(i.length<=Jt,`Transaction too large: ${i.length} > ${Jt}`),i}get keys(){return ce(this.instructions.length===1),this.instructions[0].keys.map(e=>e.pubkey)}get programId(){return ce(this.instructions.length===1),this.instructions[0].programId}get data(){return ce(this.instructions.length===1),this.instructions[0].data}static from(e){let t=[...e];const n=qe(t);let s=[];for(let i=0;i<n;i++){const o=t.slice(0,Rn);t=t.slice(Rn),s.push(Ie.encode(V.Buffer.from(o)))}return de.populate(lt.from(t),s)}static populate(e,t=[]){const n=new de;return n.recentBlockhash=e.recentBlockhash,e.header.numRequiredSignatures>0&&(n.feePayer=e.accountKeys[0]),t.forEach((s,i)=>{const o={signature:s==Ie.encode(Il)?null:Ie.decode(s),publicKey:e.accountKeys[i]};n.signatures.push(o)}),e.instructions.forEach(s=>{const i=s.accounts.map(o=>{const c=e.accountKeys[o];return{pubkey:c,isSigner:n.signatures.some(u=>u.publicKey.toString()===c.toString())||e.isAccountSigner(o),isWritable:e.isAccountWritable(o)}});n.instructions.push(new he({keys:i,programId:e.accountKeys[s.programIdIndex],data:Ie.decode(s.data)}))}),n._message=e,n._json=n.toJSON(),n}}class Us{constructor(e){this.payerKey=void 0,this.instructions=void 0,this.recentBlockhash=void 0,this.payerKey=e.payerKey,this.instructions=e.instructions,this.recentBlockhash=e.recentBlockhash}static decompile(e,t){const{header:n,compiledInstructions:s,recentBlockhash:i}=e,{numRequiredSignatures:o,numReadonlySignedAccounts:c,numReadonlyUnsignedAccounts:u}=n,d=o-c;ce(d>0,"Message header is invalid");const f=e.staticAccountKeys.length-o-u;ce(f>=0,"Message header is invalid");const g=e.getAccountKeys(t),S=g.get(0);if(S===void 0)throw new Error("Failed to decompile message because no account keys were found");const h=[];for(const b of s){const p=[];for(const y of b.accountKeyIndexes){const _=g.get(y);if(_===void 0)throw new Error(`Failed to find key for account key index ${y}`);const A=y<o;let P;A?P=y<d:y<g.staticAccountKeys.length?P=y-o<f:P=y-g.staticAccountKeys.length<g.accountKeysFromLookups.writable.length,p.push({pubkey:_,isSigner:y<n.numRequiredSignatures,isWritable:P})}const k=g.get(b.programIdIndex);if(k===void 0)throw new Error(`Failed to find program id for program id index ${b.programIdIndex}`);h.push(new he({programId:k,data:Z(b.data),keys:p}))}return new Us({payerKey:S,instructions:h,recentBlockhash:i})}compileToLegacyMessage(){return lt.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions})}compileToV0Message(e){return ln.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions,addressLookupTableAccounts:e})}}class Ms{get version(){return this.message.version}constructor(e,t){if(this.signatures=void 0,this.message=void 0,t!==void 0)ce(t.length===e.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=t;else{const n=[];for(let s=0;s<e.header.numRequiredSignatures;s++)n.push(new Uint8Array(Rn));this.signatures=n}this.message=e}serialize(){const e=this.message.serialize(),t=Array();je(t,this.signatures.length);const n=W([pe(t.length,"encodedSignaturesLength"),Ke(_l(),this.signatures.length,"signatures"),pe(e.length,"serializedMessage")]),s=new Uint8Array(2048),i=n.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},s);return s.slice(0,i)}static deserialize(e){let t=[...e];const n=[],s=qe(t);for(let o=0;o<s;o++)n.push(new Uint8Array(t.splice(0,Rn)));const i=zs.deserialize(new Uint8Array(t));return new Ms(i,n)}sign(e){const t=this.message.serialize(),n=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures);for(const s of e){const i=n.findIndex(o=>o.equals(s.publicKey));ce(i>=0,`Cannot sign with non signer key ${s.publicKey.toBase58()}`),this.signatures[i]=Ns(t,s.secretKey)}}addSignature(e,t){ce(t.byteLength===64,"Signature must be 64 bytes long");const s=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex(i=>i.equals(e));ce(s>=0,`Can not add signature; \`${e.toBase58()}\` is not required to sign this transaction`),this.signatures[s]=t}}const Rl=160,Pl=64,Tl=Rl/Pl,mo=1e3/Tl,ht=new E("SysvarC1ock11111111111111111111111111111111"),El=new E("SysvarEpochSchedu1e111111111111111111111111"),Bl=new E("Sysvar1nstructions1111111111111111111111111"),Ir=new E("SysvarRecentB1ockHashes11111111111111111111"),Pn=new E("SysvarRent111111111111111111111111111111111"),Cl=new E("SysvarRewards111111111111111111111111111111"),Ol=new E("SysvarS1otHashes111111111111111111111111111"),Nl=new E("SysvarS1otHistory11111111111111111111111111"),Rr=new E("SysvarStakeHistory1111111111111111111111111");async function ps(r,e,t,n){const s=n&&{skipPreflight:n.skipPreflight,preflightCommitment:n.preflightCommitment||n.commitment,maxRetries:n.maxRetries,minContextSlot:n.minContextSlot},i=await r.sendTransaction(e,t,s);let o;if(e.recentBlockhash!=null&&e.lastValidBlockHeight!=null)o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,signature:i,blockhash:e.recentBlockhash,lastValidBlockHeight:e.lastValidBlockHeight},n&&n.commitment)).value;else if(e.minNonceContextSlot!=null&&e.nonceInfo!=null){const{nonceInstruction:c}=e.nonceInfo,u=c.keys[0].pubkey;o=(await r.confirmTransaction({abortSignal:n==null?void 0:n.abortSignal,minContextSlot:e.minNonceContextSlot,nonceAccountPubkey:u,nonceValue:e.nonceInfo.nonce,signature:i},n&&n.commitment)).value}else(n==null?void 0:n.abortSignal)!=null&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),o=(await r.confirmTransaction(i,n&&n.commitment)).value;if(o.err)throw new Error(`Transaction ${i} failed (${JSON.stringify(o)})`);return i}function an(r){return new Promise(e=>setTimeout(e,r))}function ae(r,e){const t=r.layout.span>=0?r.layout.span:po(r,e),n=V.Buffer.alloc(t),s=Object.assign({instruction:r.index},e);return r.layout.encode(s,n),n}function le(r,e){let t;try{t=r.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.instruction!==r.index)throw new Error(`invalid instruction; instruction index mismatch ${t.instruction} != ${r.index}`);return t}const wo=xe("lamportsPerSignature"),_o=W([$("version"),$("state"),re("authorizedPubkey"),re("nonce"),W([wo],"feeCalculator")]),ms=_o.span;class Mr{constructor(e){this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=e.authorizedPubkey,this.nonce=e.nonce,this.feeCalculator=e.feeCalculator}static fromAccountData(e){const t=_o.decode(Z(e),0);return new Mr({authorizedPubkey:new E(t.authorizedPubkey),nonce:new E(t.nonce).toString(),feeCalculator:t.feeCalculator})}}const Ll=r=>{const e=r.decode.bind(r),t=r.encode.bind(r);return{decode:e,encode:t}},xl=r=>e=>{const t=pe(r,e),{encode:n,decode:s}=Ll(t),i=t;return i.decode=(o,c)=>{const u=s(o,c);return lc(V.Buffer.from(u))},i.encode=(o,c,u)=>{const d=Mi(o,r);return n(d,c,u)},i},Tn=xl(8);class Kl{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=$("instruction").decode(e.data);let s;for(const[i,o]of Object.entries(ge))if(o.index==n){s=i;break}if(!s)throw new Error("Instruction type incorrect; not a SystemInstruction");return s}static decodeCreateAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t,space:n,programId:s}=le(ge.Create,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,lamports:t,space:n,programId:new E(s)}}static decodeTransfer(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{lamports:t}=le(ge.Transfer,e.data);return{fromPubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,lamports:t}}static decodeTransferWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t,seed:n,programId:s}=le(ge.TransferWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,basePubkey:e.keys[1].pubkey,toPubkey:e.keys[2].pubkey,lamports:t,seed:n,programId:new E(s)}}static decodeAllocate(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{space:t}=le(ge.Allocate,e.data);return{accountPubkey:e.keys[0].pubkey,space:t}}static decodeAllocateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:n,space:s,programId:i}=le(ge.AllocateWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new E(t),seed:n,space:s,programId:new E(i)}}static decodeAssign(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{programId:t}=le(ge.Assign,e.data);return{accountPubkey:e.keys[0].pubkey,programId:new E(t)}}static decodeAssignWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);const{base:t,seed:n,programId:s}=le(ge.AssignWithSeed,e.data);return{accountPubkey:e.keys[0].pubkey,basePubkey:new E(t),seed:n,programId:new E(s)}}static decodeCreateWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{base:t,seed:n,lamports:s,space:i,programId:o}=le(ge.CreateWithSeed,e.data);return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,basePubkey:new E(t),seed:n,lamports:s,space:i,programId:new E(o)}}static decodeNonceInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{authorized:t}=le(ge.InitializeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:new E(t)}}static decodeNonceAdvance(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),le(ge.AdvanceNonceAccount,e.data),{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static decodeNonceWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=le(ge.WithdrawNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t}}static decodeNonceAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t}=le(ge.AuthorizeNonceAccount,e.data);return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[1].pubkey,newAuthorizedPubkey:new E(t)}}static checkProgramId(e){if(!e.equals(Ne.programId))throw new Error("invalid instruction; programId is not SystemProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const ge=Object.freeze({Create:{index:0,layout:W([$("instruction"),rt("lamports"),rt("space"),re("programId")])},Assign:{index:1,layout:W([$("instruction"),re("programId")])},Transfer:{index:2,layout:W([$("instruction"),Tn("lamports")])},CreateWithSeed:{index:3,layout:W([$("instruction"),re("base"),cn("seed"),rt("lamports"),rt("space"),re("programId")])},AdvanceNonceAccount:{index:4,layout:W([$("instruction")])},WithdrawNonceAccount:{index:5,layout:W([$("instruction"),rt("lamports")])},InitializeNonceAccount:{index:6,layout:W([$("instruction"),re("authorized")])},AuthorizeNonceAccount:{index:7,layout:W([$("instruction"),re("authorized")])},Allocate:{index:8,layout:W([$("instruction"),rt("space")])},AllocateWithSeed:{index:9,layout:W([$("instruction"),re("base"),cn("seed"),rt("space"),re("programId")])},AssignWithSeed:{index:10,layout:W([$("instruction"),re("base"),cn("seed"),re("programId")])},TransferWithSeed:{index:11,layout:W([$("instruction"),Tn("lamports"),cn("seed"),re("programId")])},UpgradeNonceAccount:{index:12,layout:W([$("instruction")])}});class Ne{constructor(){}static createAccount(e){const t=ge.Create,n=ae(t,{lamports:e.lamports,space:e.space,programId:Z(e.programId.toBuffer())});return new he({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:n})}static transfer(e){let t,n;if("basePubkey"in e){const s=ge.TransferWithSeed;t=ae(s,{lamports:BigInt(e.lamports),seed:e.seed,programId:Z(e.programId.toBuffer())}),n=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}else{const s=ge.Transfer;t=ae(s,{lamports:BigInt(e.lamports)}),n=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]}return new he({keys:n,programId:this.programId,data:t})}static assign(e){let t,n;if("basePubkey"in e){const s=ge.AssignWithSeed;t=ae(s,{base:Z(e.basePubkey.toBuffer()),seed:e.seed,programId:Z(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const s=ge.Assign;t=ae(s,{programId:Z(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new he({keys:n,programId:this.programId,data:t})}static createAccountWithSeed(e){const t=ge.CreateWithSeed,n=ae(t,{base:Z(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:Z(e.programId.toBuffer())});let s=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey!=e.fromPubkey&&s.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new he({keys:s,programId:this.programId,data:n})}static createNonceAccount(e){const t=new de;"basePubkey"in e&&"seed"in e?t.add(Ne.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:ms,programId:this.programId})):t.add(Ne.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.noncePubkey,lamports:e.lamports,space:ms,programId:this.programId}));const n={noncePubkey:e.noncePubkey,authorizedPubkey:e.authorizedPubkey};return t.add(this.nonceInitialize(n)),t}static nonceInitialize(e){const t=ge.InitializeNonceAccount,n=ae(t,{authorized:Z(e.authorizedPubkey.toBuffer())}),s={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Ir,isSigner:!1,isWritable:!1},{pubkey:Pn,isSigner:!1,isWritable:!1}],programId:this.programId,data:n};return new he(s)}static nonceAdvance(e){const t=ge.AdvanceNonceAccount,n=ae(t),s={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:Ir,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n};return new he(s)}static nonceWithdraw(e){const t=ge.WithdrawNonceAccount,n=ae(t,{lamports:e.lamports});return new he({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:Ir,isSigner:!1,isWritable:!1},{pubkey:Pn,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static nonceAuthorize(e){const t=ge.AuthorizeNonceAccount,n=ae(t,{authorized:Z(e.newAuthorizedPubkey.toBuffer())});return new he({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}static allocate(e){let t,n;if("basePubkey"in e){const s=ge.AllocateWithSeed;t=ae(s,{base:Z(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:Z(e.programId.toBuffer())}),n=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]}else{const s=ge.Allocate;t=ae(s,{space:e.space}),n=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]}return new he({keys:n,programId:this.programId,data:t})}}Ne.programId=new E("11111111111111111111111111111111");const zl=Jt-300;class dn{constructor(){}static getMinNumSignatures(e){return 2*(Math.ceil(e/dn.chunkSize)+1+1)}static async load(e,t,n,s,i){{const g=await e.getMinimumBalanceForRentExemption(i.length),S=await e.getAccountInfo(n.publicKey,"confirmed");let h=null;if(S!==null){if(S.executable)return console.error("Program load failed, account is already executable"),!1;S.data.length!==i.length&&(h=h||new de,h.add(Ne.allocate({accountPubkey:n.publicKey,space:i.length}))),S.owner.equals(s)||(h=h||new de,h.add(Ne.assign({accountPubkey:n.publicKey,programId:s}))),S.lamports<g&&(h=h||new de,h.add(Ne.transfer({fromPubkey:t.publicKey,toPubkey:n.publicKey,lamports:g-S.lamports})))}else h=new de().add(Ne.createAccount({fromPubkey:t.publicKey,newAccountPubkey:n.publicKey,lamports:g>0?g:1,space:i.length,programId:s}));h!==null&&await ps(e,h,[t,n],{commitment:"confirmed"})}const o=W([$("instruction"),$("offset"),$("bytesLength"),$("bytesLengthPadding"),Ke(ue("byte"),un($(),-8),"bytes")]),c=dn.chunkSize;let u=0,d=i,f=[];for(;d.length>0;){const g=d.slice(0,c),S=V.Buffer.alloc(c+16);o.encode({instruction:0,offset:u,bytes:g,bytesLength:0,bytesLengthPadding:0},S);const h=new de().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0}],programId:s,data:S});f.push(ps(e,h,[t,n],{commitment:"confirmed"})),e._rpcEndpoint.includes("solana.com")&&await an(1e3/4),u+=c,d=d.slice(c)}await Promise.all(f);{const g=W([$("instruction")]),S=V.Buffer.alloc(g.span);g.encode({instruction:1},S);const h=new de().add({keys:[{pubkey:n.publicKey,isSigner:!0,isWritable:!0},{pubkey:Pn,isSigner:!1,isWritable:!1}],programId:s,data:S}),b="processed",p=await e.sendTransaction(h,[t,n],{preflightCommitment:b}),{context:k,value:y}=await e.confirmTransaction({signature:p,lastValidBlockHeight:h.lastValidBlockHeight,blockhash:h.recentBlockhash},b);if(y.err)throw new Error(`Transaction ${p} failed (${JSON.stringify(y)})`);for(;;){try{if(await e.getSlot({commitment:b})>k.slot)break}catch{}await new Promise(_=>setTimeout(_,Math.round(mo/2)))}}return!0}}dn.chunkSize=zl;const Ul=new E("BPFLoader2111111111111111111111111111111111");class Ml{static getMinNumSignatures(e){return dn.getMinNumSignatures(e)}static load(e,t,n,s,i){return dn.load(e,t,n,i,s)}}function Wl(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var $l=Object.prototype.toString,Dl=Object.keys||function(r){var e=[];for(var t in r)e.push(t);return e};function qn(r,e){var t,n,s,i,o,c,u;if(r===!0)return"true";if(r===!1)return"false";switch(typeof r){case"object":if(r===null)return null;if(r.toJSON&&typeof r.toJSON=="function")return qn(r.toJSON(),e);if(u=$l.call(r),u==="[object Array]"){for(s="[",n=r.length-1,t=0;t<n;t++)s+=qn(r[t],!0)+",";return n>-1&&(s+=qn(r[t],!0)),s+"]"}else if(u==="[object Object]"){for(i=Dl(r).sort(),n=i.length,s="",t=0;t<n;)o=i[t],c=qn(r[o],!1),c!==void 0&&(s&&(s+=","),s+=JSON.stringify(o)+":"+c),t++;return"{"+s+"}"}else return JSON.stringify(r);case"function":case"undefined":return e?null:void 0;case"string":return JSON.stringify(r);default:return isFinite(r)?r:null}}var Fl=function(r){var e=qn(r,!1);if(e!==void 0)return""+e},wi=Wl(Fl);const Fn=32;function os(r){let e=0;for(;r>1;)r/=2,e++;return e}function ql(r){return r===0?1:(r--,r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16,r|=r>>32,r+1)}class ko{constructor(e,t,n,s,i){this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=e,this.leaderScheduleSlotOffset=t,this.warmup=n,this.firstNormalEpoch=s,this.firstNormalSlot=i}getEpoch(e){return this.getEpochAndSlotIndex(e)[0]}getEpochAndSlotIndex(e){if(e<this.firstNormalSlot){const t=os(ql(e+Fn+1))-os(Fn)-1,n=this.getSlotsInEpoch(t),s=e-(n-Fn);return[t,s]}else{const t=e-this.firstNormalSlot,n=Math.floor(t/this.slotsPerEpoch),s=this.firstNormalEpoch+n,i=t%this.slotsPerEpoch;return[s,i]}}getFirstSlotInEpoch(e){return e<=this.firstNormalEpoch?(Math.pow(2,e)-1)*Fn:(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}getLastSlotInEpoch(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}getSlotsInEpoch(e){return e<this.firstNormalEpoch?Math.pow(2,e+os(Fn)):this.slotsPerEpoch}}class ws extends Error{constructor(e,t){super(e),this.logs=void 0,this.logs=t}}const Hl={JSON_RPC_SERVER_ERROR_BLOCK_CLEANED_UP:-32001,JSON_RPC_SERVER_ERROR_SEND_TRANSACTION_PREFLIGHT_FAILURE:-32002,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_VERIFICATION_FAILURE:-32003,JSON_RPC_SERVER_ERROR_BLOCK_NOT_AVAILABLE:-32004,JSON_RPC_SERVER_ERROR_NODE_UNHEALTHY:-32005,JSON_RPC_SERVER_ERROR_TRANSACTION_PRECOMPILE_VERIFICATION_FAILURE:-32006,JSON_RPC_SERVER_ERROR_SLOT_SKIPPED:-32007,JSON_RPC_SERVER_ERROR_NO_SNAPSHOT:-32008,JSON_RPC_SERVER_ERROR_LONG_TERM_STORAGE_SLOT_SKIPPED:-32009,JSON_RPC_SERVER_ERROR_KEY_EXCLUDED_FROM_SECONDARY_INDEX:-32010,JSON_RPC_SERVER_ERROR_TRANSACTION_HISTORY_NOT_AVAILABLE:-32011,JSON_RPC_SCAN_ERROR:-32012,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_LEN_MISMATCH:-32013,JSON_RPC_SERVER_ERROR_BLOCK_STATUS_NOT_AVAILABLE_YET:-32014,JSON_RPC_SERVER_ERROR_UNSUPPORTED_TRANSACTION_VERSION:-32015,JSON_RPC_SERVER_ERROR_MIN_CONTEXT_SLOT_NOT_REACHED:-32016};class D extends Error{constructor({code:e,message:t,data:n},s){super(s!=null?`${s}: ${t}`:t),this.code=void 0,this.data=void 0,this.code=e,this.data=n,this.name="SolanaJSONRPCError"}}var Vl=globalThis.fetch;class Gl extends dc{constructor(e,t,n){const s=i=>{const o=gc(i,{autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3,...t});return"socket"in o?this.underlyingSocket=o.socket:this.underlyingSocket=o,o};super(s,e,t,n),this.underlyingSocket=void 0}call(...e){var n;const t=(n=this.underlyingSocket)==null?void 0:n.readyState;return t===1?super.call(...e):Promise.reject(new Error("Tried to call a JSON-RPC method `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}notify(...e){var n;const t=(n=this.underlyingSocket)==null?void 0:n.readyState;return t===1?super.notify(...e):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+e[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+t+")"))}}function jl(r,e){let t;try{t=r.layout.decode(e)}catch(n){throw new Error("invalid instruction; "+n)}if(t.typeIndex!==r.index)throw new Error(`invalid account data; account type mismatch ${t.typeIndex} != ${r.index}`);return t}const _i=56;class _s{constructor(e){this.key=void 0,this.state=void 0,this.key=e.key,this.state=e.state}isActive(){const e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}static deserialize(e){const t=jl(Yl,e),n=e.length-_i;ce(n>=0,"lookup table is invalid"),ce(n%32===0,"lookup table is invalid");const s=n/32,{addresses:i}=W([Ke(re(),s,"addresses")]).decode(e.slice(_i));return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:t.authority.length!==0?new E(t.authority[0]):void 0,addresses:i.map(o=>new E(o))}}}const Yl={index:1,layout:W([$("typeIndex"),Tn("deactivationSlot"),xe("lastExtendedSlot"),ue("lastExtendedStartIndex"),ue(),Ke(re(),un(ue(),-1),"authority")])},Jl=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;function Xl(r){const e=r.match(Jl);if(e==null)throw TypeError(`Failed to validate endpoint URL \`${r}\``);const[t,n,s,i]=e,o=r.startsWith("https:")?"wss:":"ws:",c=s==null?null:parseInt(s.slice(1),10),u=c==null?"":`:${c+1}`;return`${o}//${n}${u}${i}`}const Re=Qn(Is(E),T(),r=>new E(r)),So=Rs([T(),ke("base64")]),Ws=Qn(Is(V.Buffer),So,r=>V.Buffer.from(r[0],"base64")),vo=30*1e3;function Ql(r){if(/^https?:/.test(r)===!1)throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return r}function be(r){let e,t;if(typeof r=="string")e=r;else if(r){const{commitment:n,...s}=r;e=n,t=s}return{commitment:e,config:t}}function Ao(r){return Ge([R({jsonrpc:ke("2.0"),id:T(),result:r}),R({jsonrpc:ke("2.0"),id:T(),error:R({code:Zn(),message:T(),data:G(uc())})})])}const Zl=Ao(Zn());function Q(r){return Qn(Ao(r),Zl,e=>"error"in e?e:{...e,result:B(e.result,r)})}function ve(r){return Q(R({context:R({slot:m()}),value:r}))}function Wr(r){return R({context:R({slot:m()}),value:r})}function as(r,e){return r===0?new ln({header:e.header,staticAccountKeys:e.accountKeys.map(t=>new E(t)),recentBlockhash:e.recentBlockhash,compiledInstructions:e.instructions.map(t=>({programIdIndex:t.programIdIndex,accountKeyIndexes:t.accounts,data:Ie.decode(t.data)})),addressTableLookups:e.addressTableLookups}):new lt(e)}const ed=R({foundation:m(),foundationTerm:m(),initial:m(),taper:m(),terminal:m()}),td=Q(K(x(R({epoch:m(),effectiveSlot:m(),amount:m(),postBalance:m(),commission:G(x(m()))})))),nd=K(R({slot:m(),prioritizationFee:m()})),rd=R({total:m(),validator:m(),foundation:m(),epoch:m()}),sd=R({epoch:m(),slotIndex:m(),slotsInEpoch:m(),absoluteSlot:m(),blockHeight:G(m()),transactionCount:G(m())}),id=R({slotsPerEpoch:m(),leaderScheduleSlotOffset:m(),warmup:yt(),firstNormalEpoch:m(),firstNormalSlot:m()}),od=Ui(T(),K(m())),fn=x(Ge([R({}),T()])),ad=R({err:fn}),cd=ke("receivedSignature"),ud=R({"solana-core":T(),"feature-set":G(m())}),ki=ve(R({err:x(Ge([R({}),T()])),logs:x(K(T())),accounts:G(x(K(x(R({executable:yt(),owner:T(),lamports:m(),data:K(T()),rentEpoch:G(m())}))))),unitsConsumed:G(m()),returnData:G(x(R({programId:T(),data:Rs([T(),ke("base64")])})))})),ld=ve(R({byIdentity:Ui(T(),K(m())),range:R({firstSlot:m(),lastSlot:m()})}));function dd(r,e,t,n,s,i){const o=t||Vl;let c;i!=null&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments.");let u;return n&&(u=async(f,g)=>{const S=await new Promise((h,b)=>{try{n(f,g,(p,k)=>h([p,k]))}catch(p){b(p)}});return await o(...S)}),new fc(async(f,g)=>{const S={method:"POST",body:f,agent:c,headers:Object.assign({"Content-Type":"application/json"},e||{},hf)};try{let h=5,b,p=500;for(;u?b=await u(r,S):b=await o(r,S),!(b.status!==429||s===!0||(h-=1,h===0));)console.log(`Server responded with ${b.status} ${b.statusText}.  Retrying after ${p}ms delay...`),await an(p),p*=2;const k=await b.text();b.ok?g(null,k):g(new Error(`${b.status} ${b.statusText}: ${k}`))}catch(h){h instanceof Error&&g(h)}},{})}function fd(r){return(e,t)=>new Promise((n,s)=>{r.request(e,t,(i,o)=>{if(i){s(i);return}n(o)})})}function hd(r){return e=>new Promise((t,n)=>{e.length===0&&t([]);const s=e.map(i=>r.request(i.methodName,i.args));r.request(s,(i,o)=>{if(i){n(i);return}t(o)})})}const gd=Q(ed),yd=Q(rd),bd=Q(nd),pd=Q(sd),md=Q(id),wd=Q(od),_d=Q(m()),kd=ve(R({total:m(),circulating:m(),nonCirculating:m(),nonCirculatingAccounts:K(Re)})),ks=R({amount:T(),uiAmount:x(m()),decimals:m(),uiAmountString:G(T())}),Sd=ve(K(R({address:Re,amount:T(),uiAmount:x(m()),decimals:m(),uiAmountString:G(T())}))),vd=ve(K(R({pubkey:Re,account:R({executable:yt(),owner:Re,lamports:m(),data:Ws,rentEpoch:m()})}))),Ss=R({program:T(),parsed:Zn(),space:m()}),Ad=ve(K(R({pubkey:Re,account:R({executable:yt(),owner:Re,lamports:m(),data:Ss,rentEpoch:m()})}))),Id=ve(K(R({lamports:m(),address:Re}))),Jn=R({executable:yt(),owner:Re,lamports:m(),data:Ws,rentEpoch:m()}),Rd=R({pubkey:Re,account:Jn}),Pd=Qn(Ge([Is(V.Buffer),Ss]),Ge([So,Ss]),r=>Array.isArray(r)?B(r,Ws):r),vs=R({executable:yt(),owner:Re,lamports:m(),data:Pd,rentEpoch:m()}),Td=R({pubkey:Re,account:vs}),Ed=R({state:Ge([ke("active"),ke("inactive"),ke("activating"),ke("deactivating")]),active:m(),inactive:m()}),Bd=Q(K(R({signature:T(),slot:m(),err:fn,memo:x(T()),blockTime:G(x(m()))}))),Cd=Q(K(R({signature:T(),slot:m(),err:fn,memo:x(T()),blockTime:G(x(m()))}))),Od=R({subscription:m(),result:Wr(Jn)}),Nd=R({pubkey:Re,account:Jn}),Ld=R({subscription:m(),result:Wr(Nd)}),xd=R({parent:m(),slot:m(),root:m()}),Kd=R({subscription:m(),result:xd}),zd=Ge([R({type:Ge([ke("firstShredReceived"),ke("completed"),ke("optimisticConfirmation"),ke("root")]),slot:m(),timestamp:m()}),R({type:ke("createdBank"),parent:m(),slot:m(),timestamp:m()}),R({type:ke("frozen"),slot:m(),timestamp:m(),stats:R({numTransactionEntries:m(),numSuccessfulTransactions:m(),numFailedTransactions:m(),maxTransactionsPerEntry:m()})}),R({type:ke("dead"),slot:m(),timestamp:m(),err:T()})]),Ud=R({subscription:m(),result:zd}),Md=R({subscription:m(),result:Wr(Ge([ad,cd]))}),Wd=R({subscription:m(),result:m()}),$d=R({pubkey:T(),gossip:x(T()),tpu:x(T()),rpc:x(T()),version:x(T())}),Si=R({votePubkey:T(),nodePubkey:T(),activatedStake:m(),epochVoteAccount:yt(),epochCredits:K(Rs([m(),m(),m()])),commission:m(),lastVote:m(),rootSlot:x(m())}),Dd=Q(R({current:K(Si),delinquent:K(Si)})),Fd=Ge([ke("processed"),ke("confirmed"),ke("finalized")]),qd=R({slot:m(),confirmations:x(m()),err:fn,confirmationStatus:G(Fd)}),Hd=ve(K(x(qd))),Vd=Q(m()),Io=R({accountKey:Re,writableIndexes:K(m()),readonlyIndexes:K(m())}),$s=R({signatures:K(T()),message:R({accountKeys:K(T()),header:R({numRequiredSignatures:m(),numReadonlySignedAccounts:m(),numReadonlyUnsignedAccounts:m()}),instructions:K(R({accounts:K(m()),data:T(),programIdIndex:m()})),recentBlockhash:T(),addressTableLookups:G(K(Io))})}),Ro=R({pubkey:Re,signer:yt(),writable:yt(),source:G(Ge([ke("transaction"),ke("lookupTable")]))}),Po=R({accountKeys:K(Ro),signatures:K(T())}),To=R({parsed:Zn(),program:T(),programId:Re}),Eo=R({accounts:K(Re),data:T(),programId:Re}),Gd=Ge([Eo,To]),jd=Ge([R({parsed:Zn(),program:T(),programId:T()}),R({accounts:K(T()),data:T(),programId:T()})]),Bo=Qn(Gd,jd,r=>"accounts"in r?B(r,Eo):B(r,To)),Co=R({signatures:K(T()),message:R({accountKeys:K(Ro),instructions:K(Bo),recentBlockhash:T(),addressTableLookups:G(x(K(Io)))})}),Er=R({accountIndex:m(),mint:T(),owner:G(T()),uiTokenAmount:ks}),Oo=R({writable:K(Re),readonly:K(Re)}),$r=R({err:fn,fee:m(),innerInstructions:G(x(K(R({index:m(),instructions:K(R({accounts:K(m()),data:T(),programIdIndex:m()}))})))),preBalances:K(m()),postBalances:K(m()),logMessages:G(x(K(T()))),preTokenBalances:G(x(K(Er))),postTokenBalances:G(x(K(Er))),loadedAddresses:G(Oo),computeUnitsConsumed:G(m())}),Ds=R({err:fn,fee:m(),innerInstructions:G(x(K(R({index:m(),instructions:K(Bo)})))),preBalances:K(m()),postBalances:K(m()),logMessages:G(x(K(T()))),preTokenBalances:G(x(K(Er))),postTokenBalances:G(x(K(Er))),loadedAddresses:G(Oo),computeUnitsConsumed:G(m())}),Nn=Ge([ke(0),ke("legacy")]),hn=R({pubkey:T(),lamports:m(),postBalance:x(m()),rewardType:x(T()),commission:G(x(m()))}),Yd=Q(x(R({blockhash:T(),previousBlockhash:T(),parentSlot:m(),transactions:K(R({transaction:$s,meta:x($r),version:G(Nn)})),rewards:G(K(hn)),blockTime:x(m()),blockHeight:x(m())}))),Jd=Q(x(R({blockhash:T(),previousBlockhash:T(),parentSlot:m(),rewards:G(K(hn)),blockTime:x(m()),blockHeight:x(m())}))),Xd=Q(x(R({blockhash:T(),previousBlockhash:T(),parentSlot:m(),transactions:K(R({transaction:Po,meta:x($r),version:G(Nn)})),rewards:G(K(hn)),blockTime:x(m()),blockHeight:x(m())}))),Qd=Q(x(R({blockhash:T(),previousBlockhash:T(),parentSlot:m(),transactions:K(R({transaction:Co,meta:x(Ds),version:G(Nn)})),rewards:G(K(hn)),blockTime:x(m()),blockHeight:x(m())}))),Zd=Q(x(R({blockhash:T(),previousBlockhash:T(),parentSlot:m(),transactions:K(R({transaction:Po,meta:x(Ds),version:G(Nn)})),rewards:G(K(hn)),blockTime:x(m()),blockHeight:x(m())}))),ef=Q(x(R({blockhash:T(),previousBlockhash:T(),parentSlot:m(),rewards:G(K(hn)),blockTime:x(m()),blockHeight:x(m())}))),tf=Q(x(R({blockhash:T(),previousBlockhash:T(),parentSlot:m(),transactions:K(R({transaction:$s,meta:x($r)})),rewards:G(K(hn)),blockTime:x(m())}))),vi=Q(x(R({blockhash:T(),previousBlockhash:T(),parentSlot:m(),signatures:K(T()),blockTime:x(m())}))),cs=Q(x(R({slot:m(),meta:x($r),blockTime:G(x(m())),transaction:$s,version:G(Nn)}))),Ar=Q(x(R({slot:m(),transaction:Co,meta:x(Ds),blockTime:G(x(m())),version:G(Nn)}))),nf=ve(R({blockhash:T(),feeCalculator:R({lamportsPerSignature:m()})})),rf=ve(R({blockhash:T(),lastValidBlockHeight:m()})),sf=ve(yt()),of=R({slot:m(),numTransactions:m(),numSlots:m(),samplePeriodSecs:m()}),af=Q(K(of)),cf=ve(x(R({feeCalculator:R({lamportsPerSignature:m()})}))),uf=Q(T()),lf=Q(T()),df=R({err:fn,logs:K(T()),signature:T()}),ff=R({result:Wr(df),subscription:m()}),hf={"solana-client":"js/0.0.0-development"};class gf{constructor(e,t){this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,this.getBlockHeight=(()=>{const d={};return async f=>{const{commitment:g,config:S}=be(f),h=this._buildArgs([],g,void 0,S),b=wi(h);return d[b]=d[b]??(async()=>{try{const p=await this._rpcRequest("getBlockHeight",h),k=B(p,Q(m()));if("error"in k)throw new D(k.error,"failed to get block height information");return k.result}finally{delete d[b]}})(),await d[b]}})();let n,s,i,o,c,u;t&&typeof t=="string"?this._commitment=t:t&&(this._commitment=t.commitment,this._confirmTransactionInitialTimeout=t.confirmTransactionInitialTimeout,n=t.wsEndpoint,s=t.httpHeaders,i=t.fetch,o=t.fetchMiddleware,c=t.disableRetryOnRateLimit,u=t.httpAgent),this._rpcEndpoint=Ql(e),this._rpcWsEndpoint=n||Xl(e),this._rpcClient=dd(e,s,i,o,c,u),this._rpcRequest=fd(this._rpcClient),this._rpcBatchRequest=hd(this._rpcClient),this._rpcWebSocket=new Gl(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}get commitment(){return this._commitment}get rpcEndpoint(){return this._rpcEndpoint}async getBalanceAndContext(e,t){const{commitment:n,config:s}=be(t),i=this._buildArgs([e.toBase58()],n,void 0,s),o=await this._rpcRequest("getBalance",i),c=B(o,ve(m()));if("error"in c)throw new D(c.error,`failed to get balance for ${e.toBase58()}`);return c.result}async getBalance(e,t){return await this.getBalanceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get balance of account "+e.toBase58()+": "+n)})}async getBlockTime(e){const t=await this._rpcRequest("getBlockTime",[e]),n=B(t,Q(x(m())));if("error"in n)throw new D(n.error,`failed to get block time for slot ${e}`);return n.result}async getMinimumLedgerSlot(){const e=await this._rpcRequest("minimumLedgerSlot",[]),t=B(e,Q(m()));if("error"in t)throw new D(t.error,"failed to get minimum ledger slot");return t.result}async getFirstAvailableBlock(){const e=await this._rpcRequest("getFirstAvailableBlock",[]),t=B(e,_d);if("error"in t)throw new D(t.error,"failed to get first available block");return t.result}async getSupply(e){let t={};typeof e=="string"?t={commitment:e}:e?t={...e,commitment:e&&e.commitment||this.commitment}:t={commitment:this.commitment};const n=await this._rpcRequest("getSupply",[t]),s=B(n,kd);if("error"in s)throw new D(s.error,"failed to get supply");return s.result}async getTokenSupply(e,t){const n=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenSupply",n),i=B(s,ve(ks));if("error"in i)throw new D(i.error,"failed to get token supply");return i.result}async getTokenAccountBalance(e,t){const n=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenAccountBalance",n),i=B(s,ve(ks));if("error"in i)throw new D(i.error,"failed to get token account balance");return i.result}async getTokenAccountsByOwner(e,t,n){const{commitment:s,config:i}=be(n);let o=[e.toBase58()];"mint"in t?o.push({mint:t.mint.toBase58()}):o.push({programId:t.programId.toBase58()});const c=this._buildArgs(o,s,"base64",i),u=await this._rpcRequest("getTokenAccountsByOwner",c),d=B(u,vd);if("error"in d)throw new D(d.error,`failed to get token accounts owned by account ${e.toBase58()}`);return d.result}async getParsedTokenAccountsByOwner(e,t,n){let s=[e.toBase58()];"mint"in t?s.push({mint:t.mint.toBase58()}):s.push({programId:t.programId.toBase58()});const i=this._buildArgs(s,n,"jsonParsed"),o=await this._rpcRequest("getTokenAccountsByOwner",i),c=B(o,Ad);if("error"in c)throw new D(c.error,`failed to get token accounts owned by account ${e.toBase58()}`);return c.result}async getLargestAccounts(e){const t={...e,commitment:e&&e.commitment||this.commitment},n=t.filter||t.commitment?[t]:[],s=await this._rpcRequest("getLargestAccounts",n),i=B(s,Id);if("error"in i)throw new D(i.error,"failed to get largest accounts");return i.result}async getTokenLargestAccounts(e,t){const n=this._buildArgs([e.toBase58()],t),s=await this._rpcRequest("getTokenLargestAccounts",n),i=B(s,Sd);if("error"in i)throw new D(i.error,"failed to get token largest accounts");return i.result}async getAccountInfoAndContext(e,t){const{commitment:n,config:s}=be(t),i=this._buildArgs([e.toBase58()],n,"base64",s),o=await this._rpcRequest("getAccountInfo",i),c=B(o,ve(x(Jn)));if("error"in c)throw new D(c.error,`failed to get info about account ${e.toBase58()}`);return c.result}async getParsedAccountInfo(e,t){const{commitment:n,config:s}=be(t),i=this._buildArgs([e.toBase58()],n,"jsonParsed",s),o=await this._rpcRequest("getAccountInfo",i),c=B(o,ve(x(vs)));if("error"in c)throw new D(c.error,`failed to get info about account ${e.toBase58()}`);return c.result}async getAccountInfo(e,t){try{return(await this.getAccountInfoAndContext(e,t)).value}catch(n){throw new Error("failed to get info about account "+e.toBase58()+": "+n)}}async getMultipleParsedAccounts(e,t){const{commitment:n,config:s}=be(t),i=e.map(d=>d.toBase58()),o=this._buildArgs([i],n,"jsonParsed",s),c=await this._rpcRequest("getMultipleAccounts",o),u=B(c,ve(K(x(vs))));if("error"in u)throw new D(u.error,`failed to get info for accounts ${i}`);return u.result}async getMultipleAccountsInfoAndContext(e,t){const{commitment:n,config:s}=be(t),i=e.map(d=>d.toBase58()),o=this._buildArgs([i],n,"base64",s),c=await this._rpcRequest("getMultipleAccounts",o),u=B(c,ve(K(x(Jn))));if("error"in u)throw new D(u.error,`failed to get info for accounts ${i}`);return u.result}async getMultipleAccountsInfo(e,t){return(await this.getMultipleAccountsInfoAndContext(e,t)).value}async getStakeActivation(e,t,n){const{commitment:s,config:i}=be(t),o=this._buildArgs([e.toBase58()],s,void 0,{...i,epoch:n??(i==null?void 0:i.epoch)}),c=await this._rpcRequest("getStakeActivation",o),u=B(c,Q(Ed));if("error"in u)throw new D(u.error,`failed to get Stake Activation ${e.toBase58()}`);return u.result}async getProgramAccounts(e,t){const{commitment:n,config:s}=be(t),{encoding:i,...o}=s||{},c=this._buildArgs([e.toBase58()],n,i||"base64",o),u=await this._rpcRequest("getProgramAccounts",c),d=K(Rd),f=o.withContext===!0?B(u,ve(d)):B(u,Q(d));if("error"in f)throw new D(f.error,`failed to get accounts owned by program ${e.toBase58()}`);return f.result}async getParsedProgramAccounts(e,t){const{commitment:n,config:s}=be(t),i=this._buildArgs([e.toBase58()],n,"jsonParsed",s),o=await this._rpcRequest("getProgramAccounts",i),c=B(o,Q(K(Td)));if("error"in c)throw new D(c.error,`failed to get accounts owned by program ${e.toBase58()}`);return c.result}async confirmTransaction(e,t){var i;let n;if(typeof e=="string")n=e;else{const o=e;if((i=o.abortSignal)!=null&&i.aborted)return Promise.reject(o.abortSignal.reason);n=o.signature}let s;try{s=Ie.decode(n)}catch{throw new Error("signature must be base58 encoded: "+n)}return ce(s.length===64,"signature has invalid length"),typeof e=="string"?await this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:t||this.commitment,signature:n}):"lastValidBlockHeight"in e?await this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:t||this.commitment,strategy:e}):await this.confirmTransactionUsingDurableNonceStrategy({commitment:t||this.commitment,strategy:e})}getCancellationPromise(e){return new Promise((t,n)=>{e!=null&&(e.aborted?n(e.reason):e.addEventListener("abort",()=>{n(e.reason)}))})}getTransactionConfirmationPromise({commitment:e,signature:t}){let n,s,i=!1;const o=new Promise((u,d)=>{try{n=this.onSignature(t,(g,S)=>{n=void 0;const h={context:S,value:g};u({__type:Nt.PROCESSED,response:h})},e);const f=new Promise(g=>{n==null?g():s=this._onSubscriptionStateChange(n,S=>{S==="subscribed"&&g()})});(async()=>{if(await f,i)return;const g=await this.getSignatureStatus(t);if(i||g==null)return;const{context:S,value:h}=g;if(h!=null)if(h!=null&&h.err)d(h.err);else{switch(e){case"confirmed":case"single":case"singleGossip":{if(h.confirmationStatus==="processed")return;break}case"finalized":case"max":case"root":{if(h.confirmationStatus==="processed"||h.confirmationStatus==="confirmed")return;break}case"processed":case"recent":}i=!0,u({__type:Nt.PROCESSED,response:{context:S,value:h}})}})()}catch(f){d(f)}});return{abortConfirmation:()=>{s&&(s(),s=void 0),n!=null&&(this.removeSignatureListener(n),n=void 0)},confirmationPromise:o}}async confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:e,strategy:{abortSignal:t,lastValidBlockHeight:n,signature:s}}){let i=!1;const o=new Promise(g=>{const S=async()=>{try{return await this.getBlockHeight(e)}catch{return-1}};(async()=>{let h=await S();if(!i){for(;h<=n;)if(await an(1e3),i||(h=await S(),i))return;g({__type:Nt.BLOCKHEIGHT_EXCEEDED})}})()}),{abortConfirmation:c,confirmationPromise:u}=this.getTransactionConfirmationPromise({commitment:e,signature:s}),d=this.getCancellationPromise(t);let f;try{const g=await Promise.race([d,u,o]);if(g.__type===Nt.PROCESSED)f=g.response;else throw new xs(s)}finally{i=!0,c()}return f}async confirmTransactionUsingDurableNonceStrategy({commitment:e,strategy:{abortSignal:t,minContextSlot:n,nonceAccountPubkey:s,nonceValue:i,signature:o}}){let c=!1;const u=new Promise(h=>{let b=i,p=null;const k=async()=>{try{const{context:y,value:_}=await this.getNonceAndContext(s,{commitment:e,minContextSlot:n});return p=y.slot,_==null?void 0:_.nonce}catch{return b}};(async()=>{if(b=await k(),!c)for(;;){if(i!==b){h({__type:Nt.NONCE_INVALID,slotInWhichNonceDidAdvance:p});return}if(await an(2e3),c||(b=await k(),c))return}})()}),{abortConfirmation:d,confirmationPromise:f}=this.getTransactionConfirmationPromise({commitment:e,signature:o}),g=this.getCancellationPromise(t);let S;try{const h=await Promise.race([g,f,u]);if(h.__type===Nt.PROCESSED)S=h.response;else{let b;for(;;){const p=await this.getSignatureStatus(o);if(p==null)break;if(p.context.slot<(h.slotInWhichNonceDidAdvance??n)){await an(400);continue}b=p;break}if(b!=null&&b.value){const p=e||"finalized",{confirmationStatus:k}=b.value;switch(p){case"processed":case"recent":if(k!=="processed"&&k!=="confirmed"&&k!=="finalized")throw new _n(o);break;case"confirmed":case"single":case"singleGossip":if(k!=="confirmed"&&k!=="finalized")throw new _n(o);break;case"finalized":case"max":case"root":if(k!=="finalized")throw new _n(o);break;default:(y=>{})(p)}S={context:b.context,value:{err:b.value.err}}}else throw new _n(o)}}finally{c=!0,d()}return S}async confirmTransactionUsingLegacyTimeoutStrategy({commitment:e,signature:t}){let n;const s=new Promise(u=>{let d=this._confirmTransactionInitialTimeout||6e4;switch(e){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":{d=this._confirmTransactionInitialTimeout||3e4;break}}n=setTimeout(()=>u({__type:Nt.TIMED_OUT,timeoutMs:d}),d)}),{abortConfirmation:i,confirmationPromise:o}=this.getTransactionConfirmationPromise({commitment:e,signature:t});let c;try{const u=await Promise.race([o,s]);if(u.__type===Nt.PROCESSED)c=u.response;else throw new Ks(t,u.timeoutMs/1e3)}finally{clearTimeout(n),i()}return c}async getClusterNodes(){const e=await this._rpcRequest("getClusterNodes",[]),t=B(e,Q(K($d)));if("error"in t)throw new D(t.error,"failed to get cluster nodes");return t.result}async getVoteAccounts(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getVoteAccounts",t),s=B(n,Dd);if("error"in s)throw new D(s.error,"failed to get vote accounts");return s.result}async getSlot(e){const{commitment:t,config:n}=be(e),s=this._buildArgs([],t,void 0,n),i=await this._rpcRequest("getSlot",s),o=B(i,Q(m()));if("error"in o)throw new D(o.error,"failed to get slot");return o.result}async getSlotLeader(e){const{commitment:t,config:n}=be(e),s=this._buildArgs([],t,void 0,n),i=await this._rpcRequest("getSlotLeader",s),o=B(i,Q(T()));if("error"in o)throw new D(o.error,"failed to get slot leader");return o.result}async getSlotLeaders(e,t){const n=[e,t],s=await this._rpcRequest("getSlotLeaders",n),i=B(s,Q(K(Re)));if("error"in i)throw new D(i.error,"failed to get slot leaders");return i.result}async getSignatureStatus(e,t){const{context:n,value:s}=await this.getSignatureStatuses([e],t);ce(s.length===1);const i=s[0];return{context:n,value:i}}async getSignatureStatuses(e,t){const n=[e];t&&n.push(t);const s=await this._rpcRequest("getSignatureStatuses",n),i=B(s,Hd);if("error"in i)throw new D(i.error,"failed to get signature status");return i.result}async getTransactionCount(e){const{commitment:t,config:n}=be(e),s=this._buildArgs([],t,void 0,n),i=await this._rpcRequest("getTransactionCount",s),o=B(i,Q(m()));if("error"in o)throw new D(o.error,"failed to get transaction count");return o.result}async getTotalSupply(e){return(await this.getSupply({commitment:e,excludeNonCirculatingAccountsList:!0})).value.total}async getInflationGovernor(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getInflationGovernor",t),s=B(n,gd);if("error"in s)throw new D(s.error,"failed to get inflation");return s.result}async getInflationReward(e,t,n){const{commitment:s,config:i}=be(n),o=this._buildArgs([e.map(d=>d.toBase58())],s,void 0,{...i,epoch:t??(i==null?void 0:i.epoch)}),c=await this._rpcRequest("getInflationReward",o),u=B(c,td);if("error"in u)throw new D(u.error,"failed to get inflation reward");return u.result}async getInflationRate(){const e=await this._rpcRequest("getInflationRate",[]),t=B(e,yd);if("error"in t)throw new D(t.error,"failed to get inflation rate");return t.result}async getEpochInfo(e){const{commitment:t,config:n}=be(e),s=this._buildArgs([],t,void 0,n),i=await this._rpcRequest("getEpochInfo",s),o=B(i,pd);if("error"in o)throw new D(o.error,"failed to get epoch info");return o.result}async getEpochSchedule(){const e=await this._rpcRequest("getEpochSchedule",[]),t=B(e,md);if("error"in t)throw new D(t.error,"failed to get epoch schedule");const n=t.result;return new ko(n.slotsPerEpoch,n.leaderScheduleSlotOffset,n.warmup,n.firstNormalEpoch,n.firstNormalSlot)}async getLeaderSchedule(){const e=await this._rpcRequest("getLeaderSchedule",[]),t=B(e,wd);if("error"in t)throw new D(t.error,"failed to get leader schedule");return t.result}async getMinimumBalanceForRentExemption(e,t){const n=this._buildArgs([e],t),s=await this._rpcRequest("getMinimumBalanceForRentExemption",n),i=B(s,Vd);return"error"in i?(console.warn("Unable to fetch minimum balance for rent exemption"),0):i.result}async getRecentBlockhashAndContext(e){const t=this._buildArgs([],e),n=await this._rpcRequest("getRecentBlockhash",t),s=B(n,nf);if("error"in s)throw new D(s.error,"failed to get recent blockhash");return s.result}async getRecentPerformanceSamples(e){const t=await this._rpcRequest("getRecentPerformanceSamples",e?[e]:[]),n=B(t,af);if("error"in n)throw new D(n.error,"failed to get recent performance samples");return n.result}async getFeeCalculatorForBlockhash(e,t){const n=this._buildArgs([e],t),s=await this._rpcRequest("getFeeCalculatorForBlockhash",n),i=B(s,cf);if("error"in i)throw new D(i.error,"failed to get fee calculator");const{context:o,value:c}=i.result;return{context:o,value:c!==null?c.feeCalculator:null}}async getFeeForMessage(e,t){const n=Z(e.serialize()).toString("base64"),s=this._buildArgs([n],t),i=await this._rpcRequest("getFeeForMessage",s),o=B(i,ve(x(m())));if("error"in o)throw new D(o.error,"failed to get fee for message");if(o.result===null)throw new Error("invalid blockhash");return o.result}async getRecentPrioritizationFees(e){var o;const t=(o=e==null?void 0:e.lockedWritableAccounts)==null?void 0:o.map(c=>c.toBase58()),n=t!=null&&t.length?[t]:[],s=await this._rpcRequest("getRecentPrioritizationFees",n),i=B(s,bd);if("error"in i)throw new D(i.error,"failed to get recent prioritization fees");return i.result}async getRecentBlockhash(e){try{return(await this.getRecentBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhash(e){try{return(await this.getLatestBlockhashAndContext(e)).value}catch(t){throw new Error("failed to get recent blockhash: "+t)}}async getLatestBlockhashAndContext(e){const{commitment:t,config:n}=be(e),s=this._buildArgs([],t,void 0,n),i=await this._rpcRequest("getLatestBlockhash",s),o=B(i,rf);if("error"in o)throw new D(o.error,"failed to get latest blockhash");return o.result}async isBlockhashValid(e,t){const{commitment:n,config:s}=be(t),i=this._buildArgs([e],n,void 0,s),o=await this._rpcRequest("isBlockhashValid",i),c=B(o,sf);if("error"in c)throw new D(c.error,"failed to determine if the blockhash `"+e+"`is valid");return c.result}async getVersion(){const e=await this._rpcRequest("getVersion",[]),t=B(e,Q(ud));if("error"in t)throw new D(t.error,"failed to get version");return t.result}async getGenesisHash(){const e=await this._rpcRequest("getGenesisHash",[]),t=B(e,Q(T()));if("error"in t)throw new D(t.error,"failed to get genesis hash");return t.result}async getBlock(e,t){const{commitment:n,config:s}=be(t),i=this._buildArgsAtLeastConfirmed([e],n,void 0,s),o=await this._rpcRequest("getBlock",i);try{switch(s==null?void 0:s.transactionDetails){case"accounts":{const c=B(o,Xd);if("error"in c)throw c.error;return c.result}case"none":{const c=B(o,Jd);if("error"in c)throw c.error;return c.result}default:{const c=B(o,Yd);if("error"in c)throw c.error;const{result:u}=c;return u?{...u,transactions:u.transactions.map(({transaction:d,meta:f,version:g})=>({meta:f,transaction:{...d,message:as(g,d.message)},version:g}))}:null}}}catch(c){throw new D(c,"failed to get confirmed block")}}async getParsedBlock(e,t){const{commitment:n,config:s}=be(t),i=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",s),o=await this._rpcRequest("getBlock",i);try{switch(s==null?void 0:s.transactionDetails){case"accounts":{const c=B(o,Zd);if("error"in c)throw c.error;return c.result}case"none":{const c=B(o,ef);if("error"in c)throw c.error;return c.result}default:{const c=B(o,Qd);if("error"in c)throw c.error;return c.result}}}catch(c){throw new D(c,"failed to get block")}}async getBlockProduction(e){let t,n;if(typeof e=="string")n=e;else if(e){const{commitment:c,...u}=e;n=c,t=u}const s=this._buildArgs([],n,"base64",t),i=await this._rpcRequest("getBlockProduction",s),o=B(i,ld);if("error"in o)throw new D(o.error,"failed to get block production information");return o.result}async getTransaction(e,t){const{commitment:n,config:s}=be(t),i=this._buildArgsAtLeastConfirmed([e],n,void 0,s),o=await this._rpcRequest("getTransaction",i),c=B(o,cs);if("error"in c)throw new D(c.error,"failed to get transaction");const u=c.result;return u&&{...u,transaction:{...u.transaction,message:as(u.version,u.transaction.message)}}}async getParsedTransaction(e,t){const{commitment:n,config:s}=be(t),i=this._buildArgsAtLeastConfirmed([e],n,"jsonParsed",s),o=await this._rpcRequest("getTransaction",i),c=B(o,Ar);if("error"in c)throw new D(c.error,"failed to get transaction");return c.result}async getParsedTransactions(e,t){const{commitment:n,config:s}=be(t),i=e.map(u=>{const d=this._buildArgsAtLeastConfirmed([u],n,"jsonParsed",s);return{methodName:"getTransaction",args:d}});return(await this._rpcBatchRequest(i)).map(u=>{const d=B(u,Ar);if("error"in d)throw new D(d.error,"failed to get transactions");return d.result})}async getTransactions(e,t){const{commitment:n,config:s}=be(t),i=e.map(u=>{const d=this._buildArgsAtLeastConfirmed([u],n,void 0,s);return{methodName:"getTransaction",args:d}});return(await this._rpcBatchRequest(i)).map(u=>{const d=B(u,cs);if("error"in d)throw new D(d.error,"failed to get transactions");const f=d.result;return f&&{...f,transaction:{...f.transaction,message:as(f.version,f.transaction.message)}}})}async getConfirmedBlock(e,t){const n=this._buildArgsAtLeastConfirmed([e],t),s=await this._rpcRequest("getConfirmedBlock",n),i=B(s,tf);if("error"in i)throw new D(i.error,"failed to get confirmed block");const o=i.result;if(!o)throw new Error("Confirmed block "+e+" not found");const c={...o,transactions:o.transactions.map(({transaction:u,meta:d})=>{const f=new lt(u.message);return{meta:d,transaction:{...u,message:f}}})};return{...c,transactions:c.transactions.map(({transaction:u,meta:d})=>({meta:d,transaction:de.populate(u.message,u.signatures)}))}}async getBlocks(e,t,n){const s=this._buildArgsAtLeastConfirmed(t!==void 0?[e,t]:[e],n),i=await this._rpcRequest("getBlocks",s),o=B(i,Q(K(m())));if("error"in o)throw new D(o.error,"failed to get blocks");return o.result}async getBlockSignatures(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getBlock",n),i=B(s,vi);if("error"in i)throw new D(i.error,"failed to get block");const o=i.result;if(!o)throw new Error("Block "+e+" not found");return o}async getConfirmedBlockSignatures(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,void 0,{transactionDetails:"signatures",rewards:!1}),s=await this._rpcRequest("getConfirmedBlock",n),i=B(s,vi);if("error"in i)throw new D(i.error,"failed to get confirmed block");const o=i.result;if(!o)throw new Error("Confirmed block "+e+" not found");return o}async getConfirmedTransaction(e,t){const n=this._buildArgsAtLeastConfirmed([e],t),s=await this._rpcRequest("getConfirmedTransaction",n),i=B(s,cs);if("error"in i)throw new D(i.error,"failed to get transaction");const o=i.result;if(!o)return o;const c=new lt(o.transaction.message),u=o.transaction.signatures;return{...o,transaction:de.populate(c,u)}}async getParsedConfirmedTransaction(e,t){const n=this._buildArgsAtLeastConfirmed([e],t,"jsonParsed"),s=await this._rpcRequest("getConfirmedTransaction",n),i=B(s,Ar);if("error"in i)throw new D(i.error,"failed to get confirmed transaction");return i.result}async getParsedConfirmedTransactions(e,t){const n=e.map(o=>{const c=this._buildArgsAtLeastConfirmed([o],t,"jsonParsed");return{methodName:"getConfirmedTransaction",args:c}});return(await this._rpcBatchRequest(n)).map(o=>{const c=B(o,Ar);if("error"in c)throw new D(c.error,"failed to get confirmed transactions");return c.result})}async getConfirmedSignaturesForAddress(e,t,n){let s={},i=await this.getFirstAvailableBlock();for(;!("until"in s)&&(t--,!(t<=0||t<i));)try{const u=await this.getConfirmedBlockSignatures(t,"finalized");u.signatures.length>0&&(s.until=u.signatures[u.signatures.length-1].toString())}catch(u){if(u instanceof Error&&u.message.includes("skipped"))continue;throw u}let o=await this.getSlot("finalized");for(;!("before"in s)&&(n++,!(n>o));)try{const u=await this.getConfirmedBlockSignatures(n);u.signatures.length>0&&(s.before=u.signatures[u.signatures.length-1].toString())}catch(u){if(u instanceof Error&&u.message.includes("skipped"))continue;throw u}return(await this.getConfirmedSignaturesForAddress2(e,s)).map(u=>u.signature)}async getConfirmedSignaturesForAddress2(e,t,n){const s=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),i=await this._rpcRequest("getConfirmedSignaturesForAddress2",s),o=B(i,Bd);if("error"in o)throw new D(o.error,"failed to get confirmed signatures for address");return o.result}async getSignaturesForAddress(e,t,n){const s=this._buildArgsAtLeastConfirmed([e.toBase58()],n,void 0,t),i=await this._rpcRequest("getSignaturesForAddress",s),o=B(i,Cd);if("error"in o)throw new D(o.error,"failed to get signatures for address");return o.result}async getAddressLookupTable(e,t){const{context:n,value:s}=await this.getAccountInfoAndContext(e,t);let i=null;return s!==null&&(i=new _s({key:e,state:_s.deserialize(s.data)})),{context:n,value:i}}async getNonceAndContext(e,t){const{context:n,value:s}=await this.getAccountInfoAndContext(e,t);let i=null;return s!==null&&(i=Mr.fromAccountData(s.data)),{context:n,value:i}}async getNonce(e,t){return await this.getNonceAndContext(e,t).then(n=>n.value).catch(n=>{throw new Error("failed to get nonce for account "+e.toBase58()+": "+n)})}async requestAirdrop(e,t){const n=await this._rpcRequest("requestAirdrop",[e.toBase58(),t]),s=B(n,uf);if("error"in s)throw new D(s.error,`airdrop to ${e.toBase58()} failed`);return s.result}async _blockhashWithExpiryBlockHeight(e){if(!e){for(;this._pollingBlockhash;)await an(100);const n=Date.now()-this._blockhashInfo.lastFetch>=vo;if(this._blockhashInfo.latestBlockhash!==null&&!n)return this._blockhashInfo.latestBlockhash}return await this._pollNewBlockhash()}async _pollNewBlockhash(){this._pollingBlockhash=!0;try{const e=Date.now(),t=this._blockhashInfo.latestBlockhash,n=t?t.blockhash:null;for(let s=0;s<50;s++){const i=await this.getLatestBlockhash("finalized");if(n!==i.blockhash)return this._blockhashInfo={latestBlockhash:i,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},i;await an(mo/2)}throw new Error(`Unable to obtain a new blockhash after ${Date.now()-e}ms`)}finally{this._pollingBlockhash=!1}}async getStakeMinimumDelegation(e){const{commitment:t,config:n}=be(e),s=this._buildArgs([],t,"base64",n),i=await this._rpcRequest("getStakeMinimumDelegation",s),o=B(i,ve(m()));if("error"in o)throw new D(o.error,"failed to get stake minimum delegation");return o.result}async simulateTransaction(e,t,n){if("message"in e){const p=e.serialize(),k=V.Buffer.from(p).toString("base64");if(Array.isArray(t)||n!==void 0)throw new Error("Invalid arguments");const y=t||{};y.encoding="base64","commitment"in y||(y.commitment=this.commitment);const _=[k,y],A=await this._rpcRequest("simulateTransaction",_),P=B(A,ki);if("error"in P)throw new Error("failed to simulate transaction: "+P.error.message);return P.result}let s;if(e instanceof de){let b=e;s=new de,s.feePayer=b.feePayer,s.instructions=e.instructions,s.nonceInfo=b.nonceInfo,s.signatures=b.signatures}else s=de.populate(e),s._message=s._json=void 0;if(t!==void 0&&!Array.isArray(t))throw new Error("Invalid arguments");const i=t;if(s.nonceInfo&&i)s.sign(...i);else{let b=this._disableBlockhashCaching;for(;;){const p=await this._blockhashWithExpiryBlockHeight(b);if(s.lastValidBlockHeight=p.lastValidBlockHeight,s.recentBlockhash=p.blockhash,!i)break;if(s.sign(...i),!s.signature)throw new Error("!signature");const k=s.signature.toString("base64");if(!this._blockhashInfo.simulatedSignatures.includes(k)&&!this._blockhashInfo.transactionSignatures.includes(k)){this._blockhashInfo.simulatedSignatures.push(k);break}else b=!0}}const o=s._compile(),c=o.serialize(),d=s._serialize(c).toString("base64"),f={encoding:"base64",commitment:this.commitment};if(n){const b=(Array.isArray(n)?n:o.nonProgramIds()).map(p=>p.toBase58());f.accounts={encoding:"base64",addresses:b}}i&&(f.sigVerify=!0);const g=[d,f],S=await this._rpcRequest("simulateTransaction",g),h=B(S,ki);if("error"in h){let b;if("data"in h.error&&(b=h.error.data.logs,b&&Array.isArray(b))){const p=`
    `,k=p+b.join(p);console.error(h.error.message,k)}throw new ws("failed to simulate transaction: "+h.error.message,b)}return h.result}async sendTransaction(e,t,n){if("version"in e){if(t&&Array.isArray(t))throw new Error("Invalid arguments");const o=e.serialize();return await this.sendRawTransaction(o,t)}if(t===void 0||!Array.isArray(t))throw new Error("Invalid arguments");const s=t;if(e.nonceInfo)e.sign(...s);else{let o=this._disableBlockhashCaching;for(;;){const c=await this._blockhashWithExpiryBlockHeight(o);if(e.lastValidBlockHeight=c.lastValidBlockHeight,e.recentBlockhash=c.blockhash,e.sign(...s),!e.signature)throw new Error("!signature");const u=e.signature.toString("base64");if(this._blockhashInfo.transactionSignatures.includes(u))o=!0;else{this._blockhashInfo.transactionSignatures.push(u);break}}}const i=e.serialize();return await this.sendRawTransaction(i,n)}async sendRawTransaction(e,t){const n=Z(e).toString("base64");return await this.sendEncodedTransaction(n,t)}async sendEncodedTransaction(e,t){const n={encoding:"base64"},s=t&&t.skipPreflight,i=t&&t.preflightCommitment||this.commitment;t&&t.maxRetries!=null&&(n.maxRetries=t.maxRetries),t&&t.minContextSlot!=null&&(n.minContextSlot=t.minContextSlot),s&&(n.skipPreflight=s),i&&(n.preflightCommitment=i);const o=[e,n],c=await this._rpcRequest("sendTransaction",o),u=B(c,lf);if("error"in u){let d;throw"data"in u.error&&(d=u.error.data.logs),new ws("failed to send transaction: "+u.error.message,d)}return u.result}_wsOnOpen(){this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval(()=>{(async()=>{try{await this._rpcWebSocket.notify("ping")}catch{}})()},5e3),this._updateSubscriptions()}_wsOnError(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}_wsOnClose(e){if(this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),e===1e3){this._updateSubscriptions();return}this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach(([t,n])=>{this._setSubscription(t,{...n,state:"pending"})})}_setSubscription(e,t){var s;const n=(s=this._subscriptionsByHash[e])==null?void 0:s.state;if(this._subscriptionsByHash[e]=t,n!==t.state){const i=this._subscriptionStateChangeCallbacksByHash[e];i&&i.forEach(o=>{try{o(t.state)}catch{}})}}_onSubscriptionStateChange(e,t){const n=this._subscriptionHashByClientSubscriptionId[e];if(n==null)return()=>{};const s=this._subscriptionStateChangeCallbacksByHash[n]||=new Set;return s.add(t),()=>{s.delete(t),s.size===0&&delete this._subscriptionStateChangeCallbacksByHash[n]}}async _updateSubscriptions(){if(Object.keys(this._subscriptionsByHash).length===0){this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout(()=>{this._rpcWebSocketIdleTimeout=null;try{this._rpcWebSocket.close()}catch(n){n instanceof Error&&console.log(`Error when closing socket connection: ${n.message}`)}},500));return}if(this._rpcWebSocketIdleTimeout!==null&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),!this._rpcWebSocketConnected){this._rpcWebSocket.connect();return}const e=this._rpcWebSocketGeneration,t=()=>e===this._rpcWebSocketGeneration;await Promise.all(Object.keys(this._subscriptionsByHash).map(async n=>{const s=this._subscriptionsByHash[n];if(s!==void 0)switch(s.state){case"pending":case"unsubscribed":if(s.callbacks.size===0){delete this._subscriptionsByHash[n],s.state==="unsubscribed"&&delete this._subscriptionCallbacksByServerSubscriptionId[s.serverSubscriptionId],await this._updateSubscriptions();return}await(async()=>{const{args:i,method:o}=s;try{this._setSubscription(n,{...s,state:"subscribing"});const c=await this._rpcWebSocket.call(o,i);this._setSubscription(n,{...s,serverSubscriptionId:c,state:"subscribed"}),this._subscriptionCallbacksByServerSubscriptionId[c]=s.callbacks,await this._updateSubscriptions()}catch(c){if(c instanceof Error&&console.error(`${o} error for argument`,i,c.message),!t())return;this._setSubscription(n,{...s,state:"pending"}),await this._updateSubscriptions()}})();break;case"subscribed":s.callbacks.size===0&&await(async()=>{const{serverSubscriptionId:i,unsubscribeMethod:o}=s;if(this._subscriptionsAutoDisposedByRpc.has(i))this._subscriptionsAutoDisposedByRpc.delete(i);else{this._setSubscription(n,{...s,state:"unsubscribing"}),this._setSubscription(n,{...s,state:"unsubscribing"});try{await this._rpcWebSocket.call(o,[i])}catch(c){if(c instanceof Error&&console.error(`${o} error:`,c.message),!t())return;this._setSubscription(n,{...s,state:"subscribed"}),await this._updateSubscriptions();return}}this._setSubscription(n,{...s,state:"unsubscribed"}),await this._updateSubscriptions()})();break}}))}_handleServerNotification(e,t){const n=this._subscriptionCallbacksByServerSubscriptionId[e];n!==void 0&&n.forEach(s=>{try{s(...t)}catch(i){console.error(i)}})}_wsOnAccountNotification(e){const{result:t,subscription:n}=B(e,Od);this._handleServerNotification(n,[t.value,t.context])}_makeSubscription(e,t){const n=this._nextClientSubscriptionId++,s=wi([e.method,t],!0),i=this._subscriptionsByHash[s];return i===void 0?this._subscriptionsByHash[s]={...e,args:t,callbacks:new Set([e.callback]),state:"pending"}:i.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[n]=s,this._subscriptionDisposeFunctionsByClientSubscriptionId[n]=async()=>{delete this._subscriptionDisposeFunctionsByClientSubscriptionId[n],delete this._subscriptionHashByClientSubscriptionId[n];const o=this._subscriptionsByHash[s];ce(o!==void 0,`Could not find a \`Subscription\` when tearing down client subscription #${n}`),o.callbacks.delete(e.callback),await this._updateSubscriptions()},this._updateSubscriptions(),n}onAccountChange(e,t,n){const s=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64");return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},s)}async removeAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"account change")}_wsOnProgramAccountNotification(e){const{result:t,subscription:n}=B(e,Ld);this._handleServerNotification(n,[{accountId:t.value.pubkey,accountInfo:t.value.account},t.context])}onProgramAccountChange(e,t,n,s){const i=this._buildArgs([e.toBase58()],n||this._commitment||"finalized","base64",s?{filters:s}:void 0);return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},i)}async removeProgramAccountChangeListener(e){await this._unsubscribeClientSubscription(e,"program account change")}onLogs(e,t,n){const s=this._buildArgs([typeof e=="object"?{mentions:[e.toString()]}:e],n||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},s)}async removeOnLogsListener(e){await this._unsubscribeClientSubscription(e,"logs")}_wsOnLogsNotification(e){const{result:t,subscription:n}=B(e,ff);this._handleServerNotification(n,[t.value,t.context])}_wsOnSlotNotification(e){const{result:t,subscription:n}=B(e,Kd);this._handleServerNotification(n,[t])}onSlotChange(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}async removeSlotChangeListener(e){await this._unsubscribeClientSubscription(e,"slot change")}_wsOnSlotUpdatesNotification(e){const{result:t,subscription:n}=B(e,Ud);this._handleServerNotification(n,[t])}onSlotUpdate(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}async removeSlotUpdateListener(e){await this._unsubscribeClientSubscription(e,"slot update")}async _unsubscribeClientSubscription(e,t){const n=this._subscriptionDisposeFunctionsByClientSubscriptionId[e];n?await n():console.warn(`Ignored unsubscribe request because an active subscription with id \`${e}\` for '${t}' events could not be found.`)}_buildArgs(e,t,n,s){const i=t||this._commitment;if(i||n||s){let o={};n&&(o.encoding=n),i&&(o.commitment=i),s&&(o=Object.assign(o,s)),e.push(o)}return e}_buildArgsAtLeastConfirmed(e,t,n,s){const i=t||this._commitment;if(i&&!["confirmed","finalized"].includes(i))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,n,s)}_wsOnSignatureNotification(e){const{result:t,subscription:n}=B(e,Md);t.value!=="receivedSignature"&&this._subscriptionsAutoDisposedByRpc.add(n),this._handleServerNotification(n,t.value==="receivedSignature"?[{type:"received"},t.context]:[{type:"status",result:t.value},t.context])}onSignature(e,t,n){const s=this._buildArgs([e],n||this._commitment||"finalized"),i=this._makeSubscription({callback:(o,c)=>{if(o.type==="status"){t(o.result,c);try{this.removeSignatureListener(i)}catch{}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},s);return i}onSignatureWithOptions(e,t,n){const{commitment:s,...i}={...n,commitment:n&&n.commitment||this._commitment||"finalized"},o=this._buildArgs([e],s,void 0,i),c=this._makeSubscription({callback:(u,d)=>{t(u,d);try{this.removeSignatureListener(c)}catch{}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},o);return c}async removeSignatureListener(e){await this._unsubscribeClientSubscription(e,"signature result")}_wsOnRootNotification(e){const{result:t,subscription:n}=B(e,Wd);this._handleServerNotification(n,[t])}onRootChange(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}async removeRootChangeListener(e){await this._unsubscribeClientSubscription(e,"root change")}}class kn{constructor(e){this._keypair=void 0,this._keypair=e??bi()}static generate(){return new kn(bi())}static fromSecretKey(e,t){if(e.byteLength!==64)throw new Error("bad secret key size");const n=e.slice(32,64);if(!t||!t.skipValidation){const s=e.slice(0,32),i=Tr(s);for(let o=0;o<32;o++)if(n[o]!==i[o])throw new Error("provided secretKey is invalid")}return new kn({publicKey:n,secretKey:e})}static fromSeed(e){const t=Tr(e),n=new Uint8Array(64);return n.set(e),n.set(t,32),new kn({publicKey:t,secretKey:n})}get publicKey(){return new E(this._keypair.publicKey)}get secretKey(){return new Uint8Array(this._keypair.secretKey)}}const Lt=Object.freeze({CreateLookupTable:{index:0,layout:W([$("instruction"),Tn("recentSlot"),ue("bumpSeed")])},FreezeLookupTable:{index:1,layout:W([$("instruction")])},ExtendLookupTable:{index:2,layout:W([$("instruction"),Tn(),Ke(re(),un($(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:W([$("instruction")])},CloseLookupTable:{index:4,layout:W([$("instruction")])}});class yf{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=$("instruction").decode(e.data);let s;for(const[i,o]of Object.entries(Lt))if(o.index==n){s=i;break}if(!s)throw new Error("Invalid Instruction. Should be a LookupTable Instruction");return s}static decodeCreateLookupTable(e){this.checkProgramId(e.programId),this.checkKeysLength(e.keys,4);const{recentSlot:t}=le(Lt.CreateLookupTable,e.data);return{authority:e.keys[1].pubkey,payer:e.keys[2].pubkey,recentSlot:Number(t)}}static decodeExtendLookupTable(e){if(this.checkProgramId(e.programId),e.keys.length<2)throw new Error(`invalid instruction; found ${e.keys.length} keys, expected at least 2`);const{addresses:t}=le(Lt.ExtendLookupTable,e.data);return{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,payer:e.keys.length>2?e.keys[2].pubkey:void 0,addresses:t.map(n=>new E(n))}}static decodeCloseLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,3),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,recipient:e.keys[2].pubkey}}static decodeFreezeLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static decodeDeactivateLookupTable(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(Fs.programId))throw new Error("invalid instruction; programId is not AddressLookupTable Program")}static checkKeysLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}class Fs{constructor(){}static createLookupTable(e){const[t,n]=E.findProgramAddressSync([e.authority.toBuffer(),Mi(BigInt(e.recentSlot),8)],this.programId),s=Lt.CreateLookupTable,i=ae(s,{recentSlot:BigInt(e.recentSlot),bumpSeed:n}),o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:Ne.programId,isSigner:!1,isWritable:!1}];return[new he({programId:this.programId,keys:o,data:i}),t]}static freezeLookupTable(e){const t=Lt.FreezeLookupTable,n=ae(t),s=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new he({programId:this.programId,keys:s,data:n})}static extendLookupTable(e){const t=Lt.ExtendLookupTable,n=ae(t,{addresses:e.addresses.map(i=>i.toBytes())}),s=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return e.payer&&s.push({pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:Ne.programId,isSigner:!1,isWritable:!1}),new he({programId:this.programId,keys:s,data:n})}static deactivateLookupTable(e){const t=Lt.DeactivateLookupTable,n=ae(t),s=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new he({programId:this.programId,keys:s,data:n})}static closeLookupTable(e){const t=Lt.CloseLookupTable,n=ae(t),s=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.recipient,isSigner:!1,isWritable:!0}];return new he({programId:this.programId,keys:s,data:n})}}Fs.programId=new E("AddressLookupTab1e1111111111111111111111111");class bf{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=ue("instruction").decode(e.data);let s;for(const[i,o]of Object.entries(gt))if(o.index==n){s=i;break}if(!s)throw new Error("Instruction type incorrect; not a ComputeBudgetInstruction");return s}static decodeRequestUnits(e){this.checkProgramId(e.programId);const{units:t,additionalFee:n}=le(gt.RequestUnits,e.data);return{units:t,additionalFee:n}}static decodeRequestHeapFrame(e){this.checkProgramId(e.programId);const{bytes:t}=le(gt.RequestHeapFrame,e.data);return{bytes:t}}static decodeSetComputeUnitLimit(e){this.checkProgramId(e.programId);const{units:t}=le(gt.SetComputeUnitLimit,e.data);return{units:t}}static decodeSetComputeUnitPrice(e){this.checkProgramId(e.programId);const{microLamports:t}=le(gt.SetComputeUnitPrice,e.data);return{microLamports:t}}static checkProgramId(e){if(!e.equals(qs.programId))throw new Error("invalid instruction; programId is not ComputeBudgetProgram")}}const gt=Object.freeze({RequestUnits:{index:0,layout:W([ue("instruction"),$("units"),$("additionalFee")])},RequestHeapFrame:{index:1,layout:W([ue("instruction"),$("bytes")])},SetComputeUnitLimit:{index:2,layout:W([ue("instruction"),$("units")])},SetComputeUnitPrice:{index:3,layout:W([ue("instruction"),Tn("microLamports")])}});class qs{constructor(){}static requestUnits(e){const t=gt.RequestUnits,n=ae(t,e);return new he({keys:[],programId:this.programId,data:n})}static requestHeapFrame(e){const t=gt.RequestHeapFrame,n=ae(t,e);return new he({keys:[],programId:this.programId,data:n})}static setComputeUnitLimit(e){const t=gt.SetComputeUnitLimit,n=ae(t,e);return new he({keys:[],programId:this.programId,data:n})}static setComputeUnitPrice(e){const t=gt.SetComputeUnitPrice,n=ae(t,{microLamports:BigInt(e.microLamports)});return new he({keys:[],programId:this.programId,data:n})}}qs.programId=new E("ComputeBudget111111111111111111111111111111");const Ai=64,Ii=32,Ri=64,Pi=W([ue("numSignatures"),ue("padding"),ut("signatureOffset"),ut("signatureInstructionIndex"),ut("publicKeyOffset"),ut("publicKeyInstructionIndex"),ut("messageDataOffset"),ut("messageDataSize"),ut("messageInstructionIndex")]);class Dr{constructor(){}static createInstructionWithPublicKey(e){const{publicKey:t,message:n,signature:s,instructionIndex:i}=e;ce(t.length===Ii,`Public Key must be ${Ii} bytes but received ${t.length} bytes`),ce(s.length===Ri,`Signature must be ${Ri} bytes but received ${s.length} bytes`);const o=Pi.span,c=o+t.length,u=c+s.length,d=1,f=V.Buffer.alloc(u+n.length),g=i??65535;return Pi.encode({numSignatures:d,padding:0,signatureOffset:c,signatureInstructionIndex:g,publicKeyOffset:o,publicKeyInstructionIndex:g,messageDataOffset:u,messageDataSize:n.length,messageInstructionIndex:g},f),f.fill(t,o),f.fill(s,c),f.fill(n,u),new he({keys:[],programId:Dr.programId,data:f})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:n,instructionIndex:s}=e;ce(t.length===Ai,`Private key must be ${Ai} bytes but received ${t.length} bytes`);try{const i=kn.fromSecretKey(t),o=i.publicKey.toBytes(),c=Ns(n,i.secretKey);return this.createInstructionWithPublicKey({publicKey:o,message:n,signature:c,instructionIndex:s})}catch(i){throw new Error(`Error creating instruction; ${i}`)}}}Dr.programId=new E("Ed25519SigVerify111111111111111111111111111");const pf=(r,e)=>{const t=Ps.sign(r,e);return[t.toCompactRawBytes(),t.recovery]};Ps.utils.isValidPrivateKey;const mf=Ps.getPublicKey,Ti=32,us=20,Ei=64,wf=11,ls=W([ue("numSignatures"),ut("signatureOffset"),ue("signatureInstructionIndex"),ut("ethAddressOffset"),ue("ethAddressInstructionIndex"),ut("messageDataOffset"),ut("messageDataSize"),ue("messageInstructionIndex"),pe(20,"ethAddress"),pe(64,"signature"),ue("recoveryId")]);class Sn{constructor(){}static publicKeyToEthAddress(e){ce(e.length===Ei,`Public key must be ${Ei} bytes but received ${e.length} bytes`);try{return V.Buffer.from(li(Z(e))).slice(-us)}catch(t){throw new Error(`Error constructing Ethereum address: ${t}`)}}static createInstructionWithPublicKey(e){const{publicKey:t,message:n,signature:s,recoveryId:i,instructionIndex:o}=e;return Sn.createInstructionWithEthAddress({ethAddress:Sn.publicKeyToEthAddress(t),message:n,signature:s,recoveryId:i,instructionIndex:o})}static createInstructionWithEthAddress(e){const{ethAddress:t,message:n,signature:s,recoveryId:i,instructionIndex:o=0}=e;let c;typeof t=="string"?t.startsWith("0x")?c=V.Buffer.from(t.substr(2),"hex"):c=V.Buffer.from(t,"hex"):c=t,ce(c.length===us,`Address must be ${us} bytes but received ${c.length} bytes`);const u=1+wf,d=u,f=u+c.length,g=f+s.length+1,S=1,h=V.Buffer.alloc(ls.span+n.length);return ls.encode({numSignatures:S,signatureOffset:f,signatureInstructionIndex:o,ethAddressOffset:d,ethAddressInstructionIndex:o,messageDataOffset:g,messageDataSize:n.length,messageInstructionIndex:o,signature:Z(s),ethAddress:Z(c),recoveryId:i},h),h.fill(Z(n),ls.span),new he({keys:[],programId:Sn.programId,data:h})}static createInstructionWithPrivateKey(e){const{privateKey:t,message:n,instructionIndex:s}=e;ce(t.length===Ti,`Private key must be ${Ti} bytes but received ${t.length} bytes`);try{const i=Z(t),o=mf(i,!1).slice(1),c=V.Buffer.from(li(Z(n))),[u,d]=pf(c,i);return this.createInstructionWithPublicKey({publicKey:o,message:n,signature:u,recoveryId:d,instructionIndex:s})}catch(i){throw new Error(`Error creating instruction; ${i}`)}}}Sn.programId=new E("KeccakSecp256k11111111111111111111111111111");var No;const Lo=new E("StakeConfig11111111111111111111111111111111");class xo{constructor(e,t){this.staker=void 0,this.withdrawer=void 0,this.staker=e,this.withdrawer=t}}class tr{constructor(e,t,n){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=e,this.epoch=t,this.custodian=n}}No=tr;tr.default=new No(0,0,E.default);class _f{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=$("instruction").decode(e.data);let s;for(const[i,o]of Object.entries(Be))if(o.index==n){s=i;break}if(!s)throw new Error("Instruction type incorrect; not a StakeInstruction");return s}static decodeInitialize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{authorized:t,lockup:n}=le(Be.Initialize,e.data);return{stakePubkey:e.keys[0].pubkey,authorized:new xo(new E(t.staker),new E(t.withdrawer)),lockup:new tr(n.unixTimestamp,n.epoch,new E(n.custodian))}}static decodeDelegate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,6),le(Be.Delegate,e.data),{stakePubkey:e.keys[0].pubkey,votePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[5].pubkey}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,stakeAuthorizationType:n}=le(Be.Authorize,e.data),s={stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new E(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(s.custodianPubkey=e.keys[3].pubkey),s}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);const{newAuthorized:t,stakeAuthorizationType:n,authoritySeed:s,authorityOwner:i}=le(Be.AuthorizeWithSeed,e.data),o={stakePubkey:e.keys[0].pubkey,authorityBase:e.keys[1].pubkey,authoritySeed:s,authorityOwner:new E(i),newAuthorizedPubkey:new E(t),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(o.custodianPubkey=e.keys[3].pubkey),o}static decodeSplit(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=le(Be.Split,e.data);return{stakePubkey:e.keys[0].pubkey,splitStakePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[2].pubkey,lamports:t}}static decodeMerge(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),le(Be.Merge,e.data),{stakePubkey:e.keys[0].pubkey,sourceStakePubKey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);const{lamports:t}=le(Be.Withdraw,e.data),n={stakePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t};return e.keys.length>5&&(n.custodianPubkey=e.keys[5].pubkey),n}static decodeDeactivate(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),le(Be.Deactivate,e.data),{stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}static checkProgramId(e){if(!e.equals(Fr.programId))throw new Error("invalid instruction; programId is not StakeProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const Be=Object.freeze({Initialize:{index:0,layout:W([$("instruction"),kl(),Sl()])},Authorize:{index:1,layout:W([$("instruction"),re("newAuthorized"),$("stakeAuthorizationType")])},Delegate:{index:2,layout:W([$("instruction")])},Split:{index:3,layout:W([$("instruction"),rt("lamports")])},Withdraw:{index:4,layout:W([$("instruction"),rt("lamports")])},Deactivate:{index:5,layout:W([$("instruction")])},Merge:{index:7,layout:W([$("instruction")])},AuthorizeWithSeed:{index:8,layout:W([$("instruction"),re("newAuthorized"),$("stakeAuthorizationType"),cn("authoritySeed"),re("authorityOwner")])}}),kf=Object.freeze({Staker:{index:0},Withdrawer:{index:1}});class Fr{constructor(){}static initialize(e){const{stakePubkey:t,authorized:n,lockup:s}=e,i=s||tr.default,o=Be.Initialize,c=ae(o,{authorized:{staker:Z(n.staker.toBuffer()),withdrawer:Z(n.withdrawer.toBuffer())},lockup:{unixTimestamp:i.unixTimestamp,epoch:i.epoch,custodian:Z(i.custodian.toBuffer())}}),u={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Pn,isSigner:!1,isWritable:!1}],programId:this.programId,data:c};return new he(u)}static createAccountWithSeed(e){const t=new de;t.add(Ne.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:n,authorized:s,lockup:i}=e;return t.add(this.initialize({stakePubkey:n,authorized:s,lockup:i}))}static createAccount(e){const t=new de;t.add(Ne.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));const{stakePubkey:n,authorized:s,lockup:i}=e;return t.add(this.initialize({stakePubkey:n,authorized:s,lockup:i}))}static delegate(e){const{stakePubkey:t,authorizedPubkey:n,votePubkey:s}=e,i=Be.Delegate,o=ae(i);return new de().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:Rr,isSigner:!1,isWritable:!1},{pubkey:Lo,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static authorize(e){const{stakePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:s,stakeAuthorizationType:i,custodianPubkey:o}=e,c=Be.Authorize,u=ae(c,{newAuthorized:Z(s.toBuffer()),stakeAuthorizationType:i.index}),d=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:ht,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return o&&d.push({pubkey:o,isSigner:!1,isWritable:!1}),new de().add({keys:d,programId:this.programId,data:u})}static authorizeWithSeed(e){const{stakePubkey:t,authorityBase:n,authoritySeed:s,authorityOwner:i,newAuthorizedPubkey:o,stakeAuthorizationType:c,custodianPubkey:u}=e,d=Be.AuthorizeWithSeed,f=ae(d,{newAuthorized:Z(o.toBuffer()),stakeAuthorizationType:c.index,authoritySeed:s,authorityOwner:Z(i.toBuffer())}),g=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:ht,isSigner:!1,isWritable:!1}];return u&&g.push({pubkey:u,isSigner:!1,isWritable:!1}),new de().add({keys:g,programId:this.programId,data:f})}static splitInstruction(e){const{stakePubkey:t,authorizedPubkey:n,splitStakePubkey:s,lamports:i}=e,o=Be.Split,c=ae(o,{lamports:i});return new he({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:c})}static split(e){const t=new de;return t.add(Ne.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:0,space:this.space,programId:this.programId})),t.add(this.splitInstruction(e))}static splitWithSeed(e){const{stakePubkey:t,authorizedPubkey:n,splitStakePubkey:s,basePubkey:i,seed:o,lamports:c}=e,u=new de;return u.add(Ne.allocate({accountPubkey:s,basePubkey:i,seed:o,space:this.space,programId:this.programId})),u.add(this.splitInstruction({stakePubkey:t,authorizedPubkey:n,splitStakePubkey:s,lamports:c}))}static merge(e){const{stakePubkey:t,sourceStakePubKey:n,authorizedPubkey:s}=e,i=Be.Merge,o=ae(i);return new de().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:Rr,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}static withdraw(e){const{stakePubkey:t,authorizedPubkey:n,toPubkey:s,lamports:i,custodianPubkey:o}=e,c=Be.Withdraw,u=ae(c,{lamports:i}),d=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:Rr,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return o&&d.push({pubkey:o,isSigner:!1,isWritable:!1}),new de().add({keys:d,programId:this.programId,data:u})}static deactivate(e){const{stakePubkey:t,authorizedPubkey:n}=e,s=Be.Deactivate,i=ae(s);return new de().add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:i})}}Fr.programId=new E("Stake11111111111111111111111111111111111111");Fr.space=200;class Ko{constructor(e,t,n,s){this.nodePubkey=void 0,this.authorizedVoter=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.nodePubkey=e,this.authorizedVoter=t,this.authorizedWithdrawer=n,this.commission=s}}class Sf{constructor(){}static decodeInstructionType(e){this.checkProgramId(e.programId);const n=$("instruction").decode(e.data);let s;for(const[i,o]of Object.entries(xt))if(o.index==n){s=i;break}if(!s)throw new Error("Instruction type incorrect; not a VoteInstruction");return s}static decodeInitializeAccount(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,4);const{voteInit:t}=le(xt.InitializeAccount,e.data);return{votePubkey:e.keys[0].pubkey,nodePubkey:e.keys[3].pubkey,voteInit:new Ko(new E(t.nodePubkey),new E(t.authorizedVoter),new E(t.authorizedWithdrawer),t.commission)}}static decodeAuthorize(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{newAuthorized:t,voteAuthorizationType:n}=le(xt.Authorize,e.data);return{votePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new E(t),voteAuthorizationType:{index:n}}}static decodeAuthorizeWithSeed(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:t,currentAuthorityDerivedKeySeed:n,newAuthorized:s,voteAuthorizationType:i}}=le(xt.AuthorizeWithSeed,e.data);return{currentAuthorityDerivedKeyBasePubkey:e.keys[2].pubkey,currentAuthorityDerivedKeyOwnerPubkey:new E(t),currentAuthorityDerivedKeySeed:n,newAuthorizedPubkey:new E(s),voteAuthorizationType:{index:i},votePubkey:e.keys[0].pubkey}}static decodeWithdraw(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);const{lamports:t}=le(xt.Withdraw,e.data);return{votePubkey:e.keys[0].pubkey,authorizedWithdrawerPubkey:e.keys[2].pubkey,lamports:t,toPubkey:e.keys[1].pubkey}}static checkProgramId(e){if(!e.equals(Ln.programId))throw new Error("invalid instruction; programId is not VoteProgram")}static checkKeyLength(e,t){if(e.length<t)throw new Error(`invalid instruction; found ${e.length} keys, expected at least ${t}`)}}const xt=Object.freeze({InitializeAccount:{index:0,layout:W([$("instruction"),vl()])},Authorize:{index:1,layout:W([$("instruction"),re("newAuthorized"),$("voteAuthorizationType")])},Withdraw:{index:3,layout:W([$("instruction"),rt("lamports")])},AuthorizeWithSeed:{index:10,layout:W([$("instruction"),Al()])}}),vf=Object.freeze({Voter:{index:0},Withdrawer:{index:1}});class Ln{constructor(){}static initializeAccount(e){const{votePubkey:t,nodePubkey:n,voteInit:s}=e,i=xt.InitializeAccount,o=ae(i,{voteInit:{nodePubkey:Z(s.nodePubkey.toBuffer()),authorizedVoter:Z(s.authorizedVoter.toBuffer()),authorizedWithdrawer:Z(s.authorizedWithdrawer.toBuffer()),commission:s.commission}}),c={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:Pn,isSigner:!1,isWritable:!1},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:o};return new he(c)}static createAccount(e){const t=new de;return t.add(Ne.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}static authorize(e){const{votePubkey:t,authorizedPubkey:n,newAuthorizedPubkey:s,voteAuthorizationType:i}=e,o=xt.Authorize,c=ae(o,{newAuthorized:Z(s.toBuffer()),voteAuthorizationType:i.index}),u=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}];return new de().add({keys:u,programId:this.programId,data:c})}static authorizeWithSeed(e){const{currentAuthorityDerivedKeyBasePubkey:t,currentAuthorityDerivedKeyOwnerPubkey:n,currentAuthorityDerivedKeySeed:s,newAuthorizedPubkey:i,voteAuthorizationType:o,votePubkey:c}=e,u=xt.AuthorizeWithSeed,d=ae(u,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:Z(n.toBuffer()),currentAuthorityDerivedKeySeed:s,newAuthorized:Z(i.toBuffer()),voteAuthorizationType:o.index}}),f=[{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:ht,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return new de().add({keys:f,programId:this.programId,data:d})}static withdraw(e){const{votePubkey:t,authorizedWithdrawerPubkey:n,lamports:s,toPubkey:i}=e,o=xt.Withdraw,c=ae(o,{lamports:s}),u=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return new de().add({keys:u,programId:this.programId,data:c})}static safeWithdraw(e,t,n){if(e.lamports>t-n)throw new Error("Withdraw will leave vote account with insuffcient funds.");return Ln.withdraw(e)}}Ln.programId=new E("Vote111111111111111111111111111111111111111");Ln.space=3731;const zo=new E("Va1idator1nfo111111111111111111111111111111"),Af=R({name:T(),website:G(T()),details:G(T()),keybaseUsername:G(T())});class Hs{constructor(e,t){this.key=void 0,this.info=void 0,this.key=e,this.info=t}static fromConfigData(e){let t=[...e];if(qe(t)!==2)return null;const s=[];for(let i=0;i<2;i++){const o=new E(t.slice(0,Ye));t=t.slice(Ye);const c=t.slice(0,1)[0]===1;t=t.slice(1),s.push({publicKey:o,isSigner:c})}if(s[0].publicKey.equals(zo)&&s[1].isSigner){const i=cn().decode(V.Buffer.from(t)),o=JSON.parse(i);return hc(o,Af),new Hs(s[1].publicKey,o)}return null}}const If=new E("Vote111111111111111111111111111111111111111"),Rf=W([re("nodePubkey"),re("authorizedWithdrawer"),ue("commission"),xe(),Ke(W([xe("slot"),$("confirmationCount")]),un($(),-8),"votes"),ue("rootSlotValid"),xe("rootSlot"),xe(),Ke(W([xe("epoch"),re("authorizedVoter")]),un($(),-8),"authorizedVoters"),W([Ke(W([re("authorizedPubkey"),xe("epochOfLastAuthorizedSwitch"),xe("targetEpoch")]),32,"buf"),xe("idx"),ue("isEmpty")],"priorVoters"),xe(),Ke(W([xe("epoch"),xe("credits"),xe("prevCredits")]),un($(),-8),"epochCredits"),W([xe("slot"),xe("timestamp")],"lastTimestamp")]);class Vs{constructor(e){this.nodePubkey=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.rootSlot=void 0,this.votes=void 0,this.authorizedVoters=void 0,this.priorVoters=void 0,this.epochCredits=void 0,this.lastTimestamp=void 0,this.nodePubkey=e.nodePubkey,this.authorizedWithdrawer=e.authorizedWithdrawer,this.commission=e.commission,this.rootSlot=e.rootSlot,this.votes=e.votes,this.authorizedVoters=e.authorizedVoters,this.priorVoters=e.priorVoters,this.epochCredits=e.epochCredits,this.lastTimestamp=e.lastTimestamp}static fromAccountData(e){const n=Rf.decode(Z(e),4);let s=n.rootSlot;return n.rootSlotValid||(s=null),new Vs({nodePubkey:new E(n.nodePubkey),authorizedWithdrawer:new E(n.authorizedWithdrawer),commission:n.commission,votes:n.votes,rootSlot:s,authorizedVoters:n.authorizedVoters.map(Pf),priorVoters:Tf(n.priorVoters),epochCredits:n.epochCredits,lastTimestamp:n.lastTimestamp})}}function Pf({authorizedVoter:r,epoch:e}){return{epoch:e,authorizedVoter:new E(r)}}function Bi({authorizedPubkey:r,epochOfLastAuthorizedSwitch:e,targetEpoch:t}){return{authorizedPubkey:new E(r),epochOfLastAuthorizedSwitch:e,targetEpoch:t}}function Tf({buf:r,idx:e,isEmpty:t}){return t?[]:[...r.slice(e+1).map(Bi),...r.slice(0,e).map(Bi)]}const Ci={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function Ef(r,e){const t=e===!1?"http":"https";if(!r)return Ci[t].devnet;const n=Ci[t][r];if(!n)throw new Error(`Unknown ${t} cluster: ${r}`);return n}async function Bf(r,e,t,n){let s,i;t&&Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")||t&&Object.prototype.hasOwnProperty.call(t,"nonceValue")?(s=t,i=n):i=t;const o=i&&{skipPreflight:i.skipPreflight,preflightCommitment:i.preflightCommitment||i.commitment,minContextSlot:i.minContextSlot},c=await r.sendRawTransaction(e,o),u=i&&i.commitment,f=(await(s?r.confirmTransaction(s,u):r.confirmTransaction(c,u))).value;if(f.err)throw new Error(`Raw transaction ${c} failed (${JSON.stringify(f)})`);return c}const Cf=1e9;var Of=Object.freeze(Object.defineProperty({__proto__:null,Account:ml,AddressLookupTableAccount:_s,AddressLookupTableInstruction:yf,AddressLookupTableProgram:Fs,Authorized:xo,BLOCKHASH_CACHE_TIMEOUT_MS:vo,BPF_LOADER_DEPRECATED_PROGRAM_ID:wl,BPF_LOADER_PROGRAM_ID:Ul,BpfLoader:Ml,COMPUTE_BUDGET_INSTRUCTION_LAYOUTS:gt,ComputeBudgetInstruction:bf,ComputeBudgetProgram:qs,Connection:gf,Ed25519Program:Dr,Enum:bl,EpochSchedule:ko,FeeCalculatorLayout:wo,Keypair:kn,LAMPORTS_PER_SOL:Cf,LOOKUP_TABLE_INSTRUCTION_LAYOUTS:Lt,Loader:dn,Lockup:tr,MAX_SEED_LENGTH:bo,Message:lt,MessageAccountKeys:Yn,MessageV0:ln,NONCE_ACCOUNT_LENGTH:ms,NonceAccount:Mr,PACKET_DATA_SIZE:Jt,PUBLIC_KEY_LENGTH:Ye,PublicKey:E,SIGNATURE_LENGTH_IN_BYTES:Rn,SOLANA_SCHEMA:Gn,STAKE_CONFIG_ID:Lo,STAKE_INSTRUCTION_LAYOUTS:Be,SYSTEM_INSTRUCTION_LAYOUTS:ge,SYSVAR_CLOCK_PUBKEY:ht,SYSVAR_EPOCH_SCHEDULE_PUBKEY:El,SYSVAR_INSTRUCTIONS_PUBKEY:Bl,SYSVAR_RECENT_BLOCKHASHES_PUBKEY:Ir,SYSVAR_RENT_PUBKEY:Pn,SYSVAR_REWARDS_PUBKEY:Cl,SYSVAR_SLOT_HASHES_PUBKEY:Ol,SYSVAR_SLOT_HISTORY_PUBKEY:Nl,SYSVAR_STAKE_HISTORY_PUBKEY:Rr,Secp256k1Program:Sn,SendTransactionError:ws,SolanaJSONRPCError:D,SolanaJSONRPCErrorCode:Hl,StakeAuthorizationLayout:kf,StakeInstruction:_f,StakeProgram:Fr,Struct:Ls,SystemInstruction:Kl,SystemProgram:Ne,Transaction:de,TransactionExpiredBlockheightExceededError:xs,TransactionExpiredNonceInvalidError:_n,TransactionExpiredTimeoutError:Ks,TransactionInstruction:he,TransactionMessage:Us,TransactionStatus:Nt,VALIDATOR_INFO_KEY:zo,VERSION_PREFIX_MASK:zr,VOTE_PROGRAM_ID:If,ValidatorInfo:Hs,VersionedMessage:zs,VersionedTransaction:Ms,VoteAccount:Vs,VoteAuthorizationLayout:vf,VoteInit:Ko,VoteInstruction:Sf,VoteProgram:Ln,clusterApiUrl:Ef,sendAndConfirmRawTransaction:Bf,sendAndConfirmTransaction:ps},Symbol.toStringTag,{value:"Module"})),nr=yc(Of),st={},Ae={},gn={},Te={},Nf=z&&z.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t),Object.defineProperty(r,n,{enumerable:!0,get:function(){return e[t]}})}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),Lf=z&&z.__setModuleDefault||(Object.create?function(r,e){Object.defineProperty(r,"default",{enumerable:!0,value:e})}:function(r,e){r.default=e}),_t=z&&z.__decorate||function(r,e,t,n){var s=arguments.length,i=s<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(r,e,t,n);else for(var c=r.length-1;c>=0;c--)(o=r[c])&&(i=(s<3?o(i):s>3?o(e,t,i):o(e,t))||i);return s>3&&i&&Object.defineProperty(e,t,i),i},xf=z&&z.__importStar||function(r){if(r&&r.__esModule)return r;var e={};if(r!=null)for(var t in r)t!=="default"&&Object.hasOwnProperty.call(r,t)&&Nf(e,r,t);return Lf(e,r),e},Uo=z&&z.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Te,"__esModule",{value:!0});Te.deserializeUnchecked=Te.deserialize=Te.serialize=Te.BinaryReader=Te.BinaryWriter=Te.BorshError=Te.baseDecode=Te.baseEncode=void 0;const Yt=Uo(Lr.exports),Mo=Uo(Ie),Kf=xf(As),zf=typeof z.TextDecoder!="function"?Kf.TextDecoder:z.TextDecoder,Uf=new zf("utf-8",{fatal:!0});function Mf(r){return typeof r=="string"&&(r=M.Buffer.from(r,"utf8")),Mo.default.encode(M.Buffer.from(r))}Te.baseEncode=Mf;function Wf(r){return M.Buffer.from(Mo.default.decode(r))}Te.baseDecode=Wf;const ds=1024;class Ve extends Error{constructor(e){super(e),this.fieldPath=[],this.originalMessage=e}addToFieldPath(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}Te.BorshError=Ve;class Wo{constructor(){this.buf=M.Buffer.alloc(ds),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=M.Buffer.concat([this.buf,M.Buffer.alloc(ds)]))}writeU8(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}writeU16(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}writeU32(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}writeU64(e){this.maybeResize(),this.writeBuffer(M.Buffer.from(new Yt.default(e).toArray("le",8)))}writeU128(e){this.maybeResize(),this.writeBuffer(M.Buffer.from(new Yt.default(e).toArray("le",16)))}writeU256(e){this.maybeResize(),this.writeBuffer(M.Buffer.from(new Yt.default(e).toArray("le",32)))}writeU512(e){this.maybeResize(),this.writeBuffer(M.Buffer.from(new Yt.default(e).toArray("le",64)))}writeBuffer(e){this.buf=M.Buffer.concat([M.Buffer.from(this.buf.subarray(0,this.length)),e,M.Buffer.alloc(ds)]),this.length+=e.length}writeString(e){this.maybeResize();const t=M.Buffer.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}writeFixedArray(e){this.writeBuffer(M.Buffer.from(e))}writeArray(e,t){this.maybeResize(),this.writeU32(e.length);for(const n of e)this.maybeResize(),t(n)}toArray(){return this.buf.subarray(0,this.length)}}Te.BinaryWriter=Wo;function kt(r,e,t){const n=t.value;t.value=function(...s){try{return n.apply(this,s)}catch(i){if(i instanceof RangeError){const o=i.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(o)>=0)throw new Ve("Reached the end of buffer when deserializing")}throw i}}}class Qe{constructor(e){this.buf=e,this.offset=0}readU8(){const e=this.buf.readUInt8(this.offset);return this.offset+=1,e}readU16(){const e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}readU32(){const e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}readU64(){const e=this.readBuffer(8);return new Yt.default(e,"le")}readU128(){const e=this.readBuffer(16);return new Yt.default(e,"le")}readU256(){const e=this.readBuffer(32);return new Yt.default(e,"le")}readU512(){const e=this.readBuffer(64);return new Yt.default(e,"le")}readBuffer(e){if(this.offset+e>this.buf.length)throw new Ve(`Expected buffer length ${e} isn't within bounds`);const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}readString(){const e=this.readU32(),t=this.readBuffer(e);try{return Uf.decode(t)}catch(n){throw new Ve(`Error decoding UTF-8 string: ${n}`)}}readFixedArray(e){return new Uint8Array(this.readBuffer(e))}readArray(e){const t=this.readU32(),n=Array();for(let s=0;s<t;++s)n.push(e());return n}}_t([kt],Qe.prototype,"readU8",null);_t([kt],Qe.prototype,"readU16",null);_t([kt],Qe.prototype,"readU32",null);_t([kt],Qe.prototype,"readU64",null);_t([kt],Qe.prototype,"readU128",null);_t([kt],Qe.prototype,"readU256",null);_t([kt],Qe.prototype,"readU512",null);_t([kt],Qe.prototype,"readString",null);_t([kt],Qe.prototype,"readFixedArray",null);_t([kt],Qe.prototype,"readArray",null);Te.BinaryReader=Qe;function $o(r){return r.charAt(0).toUpperCase()+r.slice(1)}function Br(r,e,t,n,s){try{if(typeof n=="string")s[`write${$o(n)}`](t);else if(n instanceof Array)if(typeof n[0]=="number"){if(t.length!==n[0])throw new Ve(`Expecting byte array of length ${n[0]}, but got ${t.length} bytes`);s.writeFixedArray(t)}else s.writeArray(t,i=>{Br(r,e,i,n[0],s)});else if(n.kind!==void 0)switch(n.kind){case"option":{t==null?s.writeU8(0):(s.writeU8(1),Br(r,e,t,n.type,s));break}default:throw new Ve(`FieldType ${n} unrecognized`)}else Do(r,t,s)}catch(i){throw i instanceof Ve&&i.addToFieldPath(e),i}}function Do(r,e,t){const n=r.get(e.constructor);if(!n)throw new Ve(`Class ${e.constructor.name} is missing in schema`);if(n.kind==="struct")n.fields.map(([s,i])=>{Br(r,s,e[s],i,t)});else if(n.kind==="enum"){const s=e[n.field];for(let i=0;i<n.values.length;++i){const[o,c]=n.values[i];if(o===s){t.writeU8(i),Br(r,o,e[o],c,t);break}}}else throw new Ve(`Unexpected schema kind: ${n.kind} for ${e.constructor.name}`)}function $f(r,e){const t=new Wo;return Do(r,e,t),t.toArray()}Te.serialize=$f;function Cr(r,e,t,n){try{return typeof t=="string"?n[`read${$o(t)}`]():t instanceof Array?typeof t[0]=="number"?n.readFixedArray(t[0]):n.readArray(()=>Cr(r,e,t[0],n)):t.kind==="option"?n.readU8()?Cr(r,e,t.type,n):void 0:Gs(r,t,n)}catch(s){throw s instanceof Ve&&s.addToFieldPath(e),s}}function Gs(r,e,t){const n=r.get(e);if(!n)throw new Ve(`Class ${e.name} is missing in schema`);if(n.kind==="struct"){const s={};for(const[i,o]of r.get(e).fields)s[i]=Cr(r,i,o,t);return new e(s)}if(n.kind==="enum"){const s=t.readU8();if(s>=n.values.length)throw new Ve(`Enum index: ${s} is out of range`);const[i,o]=n.values[s],c=Cr(r,i,o,t);return new e({[i]:c})}throw new Ve(`Unexpected schema kind: ${n.kind} for ${e.constructor.name}`)}function Df(r,e,t){const n=new Qe(t),s=Gs(r,e,n);if(n.offset<t.length)throw new Ve(`Unexpected ${t.length-n.offset} bytes after deserialized data`);return s}Te.deserialize=Df;function Ff(r,e,t){const n=new Qe(t);return Gs(r,e,n)}Te.deserializeUnchecked=Ff;Object.defineProperty(gn,"__esModule",{value:!0});gn.NameRegistryState=void 0;const fs=nr,qf=Te;class En{constructor(e){this.parentName=new fs.PublicKey(e.parentName),this.owner=new fs.PublicKey(e.owner),this.class=new fs.PublicKey(e.class)}static async retrieve(e,t){var n;const s=await e.getAccountInfo(t,"processed");if(!s)throw new Error("Invalid name account provided");const i=(0,qf.deserializeUnchecked)(this.schema,En,s.data);return i.data=(n=s.data)===null||n===void 0?void 0:n.slice(this.HEADER_LEN),i}}gn.NameRegistryState=En;En.HEADER_LEN=96;En.schema=new Map([[En,{kind:"struct",fields:[["parentName",[32]],["owner",[32]],["class",[32]]]}]]);var Fo=z&&z.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ae,"__esModule",{value:!0});Ae.getFilteredProgramAccounts=Ae.getNameOwner=Ae.getNameAccountKey=Ae.getHashedName=Ae.signAndSendTransactionInstructions=Ae.Numberu64=Ae.Numberu32=void 0;const Or=Fo(Ic.exports),Hf=Rc,qo=nr,Nr=Fo(Lr.exports),Ho=Kr,Vf=gn;class Gf extends Nr.default{toBuffer(){const e=super.toArray().reverse(),t=M.Buffer.from(e);if(t.length===4)return t;(0,Or.default)(t.length<4,"Numberu32 too large");const n=M.Buffer.alloc(4);return t.copy(n),n}static fromBuffer(e){return(0,Or.default)(e.length===4,`Invalid buffer length: ${e.length}`),new Nr.default([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}Ae.Numberu32=Gf;class jf extends Nr.default{toBuffer(){const e=super.toArray().reverse(),t=M.Buffer.from(e);if(t.length===8)return t;(0,Or.default)(t.length<8,"Numberu64 too large");const n=M.Buffer.alloc(8);return t.copy(n),n}static fromBuffer(e){return(0,Or.default)(e.length===8,`Invalid buffer length: ${e.length}`),new Nr.default([...e].reverse().map(t=>`00${t.toString(16)}`.slice(-2)).join(""),16)}}Ae.Numberu64=jf;const Yf=async(r,e,t,n)=>{const s=new qo.Transaction;return s.feePayer=t.publicKey,e.push(t),s.add(...n),await r.sendTransaction(s,e)};Ae.signAndSendTransactionInstructions=Yf;async function Jf(r){const e=Ho.HASH_PREFIX+r;return(0,Hf.createHash)("sha256").update(e,"utf8").digest()}Ae.getHashedName=Jf;async function Xf(r,e,t){const n=[r];e?n.push(e.toBuffer()):n.push(M.Buffer.alloc(32)),t?n.push(t.toBuffer()):n.push(M.Buffer.alloc(32));const[s]=await qo.PublicKey.findProgramAddress(n,Ho.NAME_PROGRAM_ID);return s}Ae.getNameAccountKey=Xf;async function Qf(r,e){if(!await r.getAccountInfo(e))throw new Error("Unable to find the given account.");return Vf.NameRegistryState.retrieve(r,e)}Ae.getNameOwner=Qf;async function Zf(r,e,t){return(await r.getProgramAccounts(e,{commitment:r.commitment,filters:t,encoding:"base64"})).map(({pubkey:s,account:{data:i,executable:o,owner:c,lamports:u}})=>({publicKey:s,accountInfo:{data:i,executable:o,owner:c,lamports:u}}))}Ae.getFilteredProgramAccounts=Zf;Object.defineProperty(st,"__esModule",{value:!0});st.deleteInstruction=st.transferInstruction=st.updateInstruction=st.createInstruction=void 0;const vn=nr,Vo=Ae;function eh(r,e,t,n,s,i,o,c,u,d,f){const g=[M.Buffer.from(Int8Array.from([0])),new Vo.Numberu32(i.length).toBuffer(),i,o.toBuffer(),c.toBuffer()],S=M.Buffer.concat(g),h=[{pubkey:e,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1}];return u?h.push({pubkey:u,isSigner:!0,isWritable:!1}):h.push({pubkey:new vn.PublicKey(M.Buffer.alloc(32)),isSigner:!1,isWritable:!1}),d?h.push({pubkey:d,isSigner:!1,isWritable:!1}):h.push({pubkey:new vn.PublicKey(M.Buffer.alloc(32)),isSigner:!1,isWritable:!1}),f&&h.push({pubkey:f,isSigner:!0,isWritable:!1}),new vn.TransactionInstruction({keys:h,programId:r,data:S})}st.createInstruction=eh;function th(r,e,t,n,s,i){const o=[M.Buffer.from(Int8Array.from([1])),t.toBuffer(),new Vo.Numberu32(n.length).toBuffer(),n],c=M.Buffer.concat(o),u=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1}];return i&&u.push({pubkey:i,isSigner:!1,isWritable:!1}),new vn.TransactionInstruction({keys:u,programId:r,data:c})}st.updateInstruction=th;function nh(r,e,t,n,s,i){const o=[M.Buffer.from(Int8Array.from([2])),t.toBuffer()],c=M.Buffer.concat(o),u=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}];return s&&u.push({pubkey:s,isSigner:!0,isWritable:!1}),i&&u.push({pubkey:i,isSigner:!1,isWritable:!1}),new vn.TransactionInstruction({keys:u,programId:r,data:c})}st.transferInstruction=nh;function rh(r,e,t,n){const s=[M.Buffer.from(Int8Array.from([3]))],i=M.Buffer.concat(s),o=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!0}];return new vn.TransactionInstruction({keys:o,programId:r,data:i})}st.deleteInstruction=rh;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.deleteNameRegistry=r.transferNameOwnership=r.updateNameRegistryData=r.createNameRegistry=r.HASH_PREFIX=r.NAME_PROGRAM_ID=void 0;const e=nr,t=st,n=gn,s=Ae,i=Ae;r.NAME_PROGRAM_ID=new e.PublicKey("namesLPneVptA9Z5rqUDD9tMTWEJwofgaYwp8cawRkX"),r.HASH_PREFIX="SPL Name Service";async function o(f,g,S,h,b,p,k,y){const _=await(0,i.getHashedName)(g),A=await(0,i.getNameAccountKey)(_,k,y),P=p||await f.getMinimumBalanceForRentExemption(S);let O;return y&&(O=(await(0,i.getNameOwner)(f,y)).owner),(0,t.createInstruction)(r.NAME_PROGRAM_ID,e.SystemProgram.programId,A,b,h,_,new s.Numberu64(P),new i.Numberu32(S),k,y,O)}r.createNameRegistry=o;async function c(f,g,S,h,b,p){const k=await(0,i.getHashedName)(g),y=await(0,i.getNameAccountKey)(k,b,p);let _;return b?_=b:_=(await n.NameRegistryState.retrieve(f,y)).owner,(0,t.updateInstruction)(r.NAME_PROGRAM_ID,y,new i.Numberu32(S),h,_,p)}r.updateNameRegistryData=c;async function u(f,g,S,h,b){const p=await(0,i.getHashedName)(g),k=await(0,i.getNameAccountKey)(p,h,b);let y;return h?y=h:y=(await n.NameRegistryState.retrieve(f,k)).owner,(0,t.transferInstruction)(r.NAME_PROGRAM_ID,k,S,y,h,b)}r.transferNameOwnership=u;async function d(f,g,S,h,b){const p=await(0,i.getHashedName)(g),k=await(0,i.getNameAccountKey)(p,h,b);let y;return h?y=h:y=(await n.NameRegistryState.retrieve(f,k)).owner,(0,t.deleteInstruction)(r.NAME_PROGRAM_ID,k,S,y)}r.deleteNameRegistry=d})(Kr);var Go={};(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.createReverseTwitterRegistry=r.ReverseTwitterRegistryState=r.getTwitterRegistryData=r.getTwitterHandleandRegistryKeyViaFilters=r.getHandleAndRegistryKey=r.getTwitterRegistry=r.getTwitterRegistryKey=r.deleteTwitterRegistry=r.changeVerifiedPubkey=r.changeTwitterRegistryData=r.createVerifiedTwitterRegistry=r.TWITTER_ROOT_PARENT_REGISTRY_KEY=r.TWITTER_VERIFICATION_AUTHORITY=void 0;const e=nr,t=Te,n=Kr,s=st,i=gn,o=Ae;r.TWITTER_VERIFICATION_AUTHORITY=new e.PublicKey("FvPH7PrVrLGKPfqaf3xJodFTjZriqrAXXLTVWEorTFBi"),r.TWITTER_ROOT_PARENT_REGISTRY_KEY=new e.PublicKey("4YcexoW3r78zz16J2aqmukBLRwGq6rAvWzJpkYAXqebv");async function c(_,A,P,O,L){const X=await(0,o.getHashedName)(A),ee=await(0,o.getNameAccountKey)(X,void 0,r.TWITTER_ROOT_PARENT_REGISTRY_KEY);let se=[(0,s.createInstruction)(n.NAME_PROGRAM_ID,e.SystemProgram.programId,ee,P,L,X,new o.Numberu64(await _.getMinimumBalanceForRentExemption(O)),new o.Numberu32(O),void 0,r.TWITTER_ROOT_PARENT_REGISTRY_KEY,r.TWITTER_VERIFICATION_AUTHORITY)];return se=se.concat(await y(_,A,ee,P,L)),se}r.createVerifiedTwitterRegistry=c;async function u(_,A,P,O){const L=await(0,o.getHashedName)(_),X=await(0,o.getNameAccountKey)(L,void 0,r.TWITTER_ROOT_PARENT_REGISTRY_KEY);return[(0,s.updateInstruction)(n.NAME_PROGRAM_ID,X,new o.Numberu32(P),O,A,void 0)]}r.changeTwitterRegistryData=u;async function d(_,A,P,O,L){const X=await(0,o.getHashedName)(A),ee=await(0,o.getNameAccountKey)(X,void 0,r.TWITTER_ROOT_PARENT_REGISTRY_KEY);let se=[(0,s.transferInstruction)(n.NAME_PROGRAM_ID,ee,O,P,void 0)];return se.push(await(0,n.deleteNameRegistry)(_,P.toString(),L,r.TWITTER_VERIFICATION_AUTHORITY,r.TWITTER_ROOT_PARENT_REGISTRY_KEY)),se=se.concat(await y(_,A,ee,O,L)),se}r.changeVerifiedPubkey=d;async function f(_,A){const P=await(0,o.getHashedName)(_),O=await(0,o.getNameAccountKey)(P,void 0,r.TWITTER_ROOT_PARENT_REGISTRY_KEY),L=await(0,o.getHashedName)(A.toString()),X=await(0,o.getNameAccountKey)(L,r.TWITTER_VERIFICATION_AUTHORITY,r.TWITTER_ROOT_PARENT_REGISTRY_KEY);return[(0,s.deleteInstruction)(n.NAME_PROGRAM_ID,O,A,A),(0,s.deleteInstruction)(n.NAME_PROGRAM_ID,X,A,A)]}r.deleteTwitterRegistry=f;async function g(_){const A=await(0,o.getHashedName)(_);return await(0,o.getNameAccountKey)(A,void 0,r.TWITTER_ROOT_PARENT_REGISTRY_KEY)}r.getTwitterRegistryKey=g;async function S(_,A){const P=await(0,o.getHashedName)(A),O=await(0,o.getNameAccountKey)(P,void 0,r.TWITTER_ROOT_PARENT_REGISTRY_KEY);return i.NameRegistryState.retrieve(_,O)}r.getTwitterRegistry=S;async function h(_,A){const P=await(0,o.getHashedName)(A.toString()),O=await(0,o.getNameAccountKey)(P,r.TWITTER_VERIFICATION_AUTHORITY,r.TWITTER_ROOT_PARENT_REGISTRY_KEY),L=await k.retrieve(_,O);return[L.twitterHandle,new e.PublicKey(L.twitterRegistryKey)]}r.getHandleAndRegistryKey=h;async function b(_,A){const P=[{memcmp:{offset:0,bytes:r.TWITTER_ROOT_PARENT_REGISTRY_KEY.toBase58()}},{memcmp:{offset:32,bytes:A.toBase58()}},{memcmp:{offset:64,bytes:r.TWITTER_VERIFICATION_AUTHORITY.toBase58()}}],O=await(0,o.getFilteredProgramAccounts)(_,n.NAME_PROGRAM_ID,P);for(const L of O)if(L.accountInfo.data.length>i.NameRegistryState.HEADER_LEN+32){const X=L.accountInfo.data.slice(i.NameRegistryState.HEADER_LEN),ee=(0,t.deserialize)(k.schema,k,X);return[ee.twitterHandle,new e.PublicKey(ee.twitterRegistryKey)]}throw new Error("Registry not found.")}r.getTwitterHandleandRegistryKeyViaFilters=b;async function p(_,A){const P=[{memcmp:{offset:0,bytes:r.TWITTER_ROOT_PARENT_REGISTRY_KEY.toBytes()}},{memcmp:{offset:32,bytes:A.toBytes()}},{memcmp:{offset:64,bytes:new e.PublicKey(M.Buffer.alloc(32,0)).toBase58()}}],O=await(0,o.getFilteredProgramAccounts)(_,n.NAME_PROGRAM_ID,P);if(O.length>1)throw new Error("Found more than one registry.");return O[0].accountInfo.data.slice(i.NameRegistryState.HEADER_LEN)}r.getTwitterRegistryData=p;class k{constructor(A){this.twitterRegistryKey=A.twitterRegistryKey,this.twitterHandle=A.twitterHandle}static async retrieve(A,P){const O=await A.getAccountInfo(P,"processed");if(!O)throw new Error("Invalid reverse Twitter account provided");return(0,t.deserializeUnchecked)(this.schema,k,O.data.slice(i.NameRegistryState.HEADER_LEN))}}r.ReverseTwitterRegistryState=k,k.schema=new Map([[k,{kind:"struct",fields:[["twitterRegistryKey",[32]],["twitterHandle","string"]]}]]);async function y(_,A,P,O,L){const X=await(0,o.getHashedName)(O.toString()),ee=await(0,o.getNameAccountKey)(X,r.TWITTER_VERIFICATION_AUTHORITY,r.TWITTER_ROOT_PARENT_REGISTRY_KEY),se=(0,t.serialize)(k.schema,new k({twitterRegistryKey:P.toBytes(),twitterHandle:A}));return[(0,s.createInstruction)(n.NAME_PROGRAM_ID,e.SystemProgram.programId,ee,O,L,X,new o.Numberu64(await _.getMinimumBalanceForRentExemption(se.length)),new o.Numberu32(se.length),r.TWITTER_VERIFICATION_AUTHORITY,r.TWITTER_ROOT_PARENT_REGISTRY_KEY,r.TWITTER_VERIFICATION_AUTHORITY),(0,s.updateInstruction)(n.NAME_PROGRAM_ID,ee,new o.Numberu32(0),M.Buffer.from(se),r.TWITTER_VERIFICATION_AUTHORITY,void 0)]}r.createReverseTwitterRegistry=y})(Go);(function(r){var e=z&&z.__createBinding||(Object.create?function(n,s,i,o){o===void 0&&(o=i);var c=Object.getOwnPropertyDescriptor(s,i);(!c||("get"in c?!s.__esModule:c.writable||c.configurable))&&(c={enumerable:!0,get:function(){return s[i]}}),Object.defineProperty(n,o,c)}:function(n,s,i,o){o===void 0&&(o=i),n[o]=s[i]}),t=z&&z.__exportStar||function(n,s){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(s,i)&&e(s,n,i)};Object.defineProperty(r,"__esModule",{value:!0}),t(Kr,r),t(st,r),t(gn,r),t(Ae,r),t(Go,r)})(so);(function(r){var e=z&&z.__awaiter||function(d,f,g,S){function h(b){return b instanceof g?b:new g(function(p){p(b)})}return new(g||(g=Promise))(function(b,p){function k(A){try{_(S.next(A))}catch(P){p(P)}}function y(A){try{_(S.throw(A))}catch(P){p(P)}}function _(A){A.done?b(A.value):h(A.value).then(k,y)}_((S=S.apply(d,f||[])).next())})},t=z&&z.__generator||function(d,f){var g={label:0,sent:function(){if(b[0]&1)throw b[1];return b[1]},trys:[],ops:[]},S,h,b,p;return p={next:k(0),throw:k(1),return:k(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function k(_){return function(A){return y([_,A])}}function y(_){if(S)throw new TypeError("Generator is already executing.");for(;g;)try{if(S=1,h&&(b=_[0]&2?h.return:_[0]?h.throw||((b=h.return)&&b.call(h),0):h.next)&&!(b=b.call(h,_[1])).done)return b;switch(h=0,b&&(_=[_[0]&2,b.value]),_[0]){case 0:case 1:b=_;break;case 4:return g.label++,{value:_[1],done:!1};case 5:g.label++,h=_[1],_=[0];continue;case 7:_=g.ops.pop(),g.trys.pop();continue;default:if(b=g.trys,!(b=b.length>0&&b[b.length-1])&&(_[0]===6||_[0]===2)){g=0;continue}if(_[0]===3&&(!b||_[1]>b[0]&&_[1]<b[3])){g.label=_[1];break}if(_[0]===6&&g.label<b[1]){g.label=b[1],b=_;break}if(b&&g.label<b[2]){g.label=b[2],g.ops.push(_);break}b[2]&&g.ops.pop(),g.trys.pop();continue}_=f.call(d,g)}catch(A){_=[6,A],h=0}finally{S=b=0}if(_[0]&5)throw _[1];return{value:_[0]?_[1]:void 0,done:!0}}};Object.defineProperty(r,"__esModule",{value:!0}),r.resolveToWalletAddress=r.getInputKey=r.SOL_TLD_AUTHORITY=void 0;var n=Cn,s=so,i=He;r.SOL_TLD_AUTHORITY=new n.PublicKey("58PwtjSDuFHuUkYjH9BYnnQKHfwo9reZhC2zMJv9JPkx");var o=function(d){return e(void 0,void 0,void 0,function(){var f,g;return t(this,function(S){switch(S.label){case 0:return[4,(0,s.getHashedName)(d)];case 1:return f=S.sent(),[4,(0,s.getNameAccountKey)(f,void 0,r.SOL_TLD_AUTHORITY)];case 2:return g=S.sent(),[2,{inputDomainKey:g,hashedInputName:f}]}})})};r.getInputKey=o;var c=new Error("Can't resolve provided name into valid Solana address =("),u=function(d){var f=d.text,g=d.connection,S=g===void 0?(0,i.createConnectionConfig)():g;return e(void 0,void 0,void 0,function(){var h,b,p,k,y,_,A,P,O,L,X,ee;return t(this,function(se){switch(se.label){case 0:return h=(O=f==null?void 0:f.trim)===null||O===void 0?void 0:O.call(f),h?(b=(0,i.isValidSolanaAddress)(h),b?[2,Promise.resolve(h)]:(p=h==null?void 0:h.toLowerCase(),k=(L=p==null?void 0:p.endsWith)===null||L===void 0?void 0:L.call(p,".sol"),k?(y=p.split(".sol")[0],[4,(0,r.getInputKey)(y)]):[3,3])):[2,Promise.reject(c)];case 1:return _=se.sent().inputDomainKey,[4,s.NameRegistryState.retrieve(S,_)];case 2:if(A=se.sent(),P=(ee=(X=A==null?void 0:A.owner)===null||X===void 0?void 0:X.toBase58)===null||ee===void 0?void 0:ee.call(X),P)return[2,Promise.resolve(P)];se.label=3;case 3:return[2,Promise.reject(c)]}})})};r.resolveToWalletAddress=u})(ro);(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.decodeTokenMetadata=r.getSolanaMetadataAddress=r.createConnectionConfig=r.isValidSolanaAddress=r.resolveToWalletAddress=r.getParsedAccountByMint=r.getParsedNftAccountsByUpdateAuthority=r.getParsedNftAccountsByOwner=void 0;var e=Hi;Object.defineProperty(r,"getParsedNftAccountsByOwner",{enumerable:!0,get:function(){return e.getParsedNftAccountsByOwner}});var t=no;Object.defineProperty(r,"getParsedNftAccountsByUpdateAuthority",{enumerable:!0,get:function(){return t.getParsedNftAccountsByUpdateAuthority}});var n=xr;Object.defineProperty(r,"getParsedAccountByMint",{enumerable:!0,get:function(){return n.getParsedAccountByMint}});var s=ro;Object.defineProperty(r,"resolveToWalletAddress",{enumerable:!0,get:function(){return s.resolveToWalletAddress}});var i=He;Object.defineProperty(r,"isValidSolanaAddress",{enumerable:!0,get:function(){return i.isValidSolanaAddress}}),Object.defineProperty(r,"createConnectionConfig",{enumerable:!0,get:function(){return i.createConnectionConfig}}),Object.defineProperty(r,"getSolanaMetadataAddress",{enumerable:!0,get:function(){return i.getSolanaMetadataAddress}}),Object.defineProperty(r,"decodeTokenMetadata",{enumerable:!0,get:function(){return i.decodeTokenMetadata}})})(qi);new Wi("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1");const ph=bc("walletStore",{state:()=>({_updateCount:0,is_loading:!1,token_accounts:[],nft_accounts:[],nft_in_wallet:[],token_map:[],nft_map:[]}),getters:{get_account_map(r){return r.token_accounts.map(e=>{const t=e.account.data.parsed.info;return{pubkey:e.pubkey.toString(),info:t,account:e,meta:pc().token_list.find(n=>n.address===t.mint)}})}},actions:{async update_accounts(){this.is_loading=!0,this.token_accounts=[],kr().publicKey.value&&(this.token_accounts=[],this.token_accounts=(await Sr().connection.getParsedTokenAccountsByOwner(kr().publicKey.value,{programId:Pc})).value),this.is_loading=!1},async update_accounts_nft(r=!1){if(kr().publicKey.value||!this.nft_map.length||r){this.is_loading=!0,this.nft_in_wallet=[],this.nft_map=[],this.nft_in_wallet=await qi.getParsedNftAccountsByOwner({publicAddress:kr().publicKey.value.toString(),connection:Sr().connection});for(const e of this.nft_in_wallet){const t=await Sr().connection.getTokenLargestAccounts(new Wi(e.mint)),n=await Sr().connection.getParsedAccountInfo(t.value[0].address),s=n.value.data.parsed.info;this.nft_map.push({pubkey:t.value[0].address.toString(),account:n.value,info:s,meta:e,data:await sh(e.data.uri)})}}this.is_loading=!1}}});async function sh(r){try{return await mc.get(r).then(e=>e.data)}catch(e){console.warn(e);return}}function mh(r,e=6){if(r){const t=r==null?void 0:r.substring(0,e),n=r==null?void 0:r.substring(r.length-e);return`${t}[...]${n}`}return"error"}export{Kc as Q,bh as a,yh as b,mh as f,ph as u};
