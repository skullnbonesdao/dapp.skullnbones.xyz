import{Q as le,a as M,b as Me}from"./QInput.aace5420.js";import{Q as z,a as ze}from"./QTabPanels.1319e518.js";import{Q as Ie}from"./QPage.482aa754.js";import{P as K,aL as De,af as He,u as V,a6 as W,A as T,a7 as A,a8 as E,a9 as u,ae as g,ah as j,aM as X,aN as pe,aO as F,ai as P,G as Y,ao as ae,al as ne,Z as J,ad as I,an as re,t as Se,D as Re,v as p,ar as Ue,aP as Oe,C as be,F as je,$ as Xe,aQ as Ye,as as Je,am as ke,T as xe,aR as Ge,az as we,aj as Ze}from"./index.4de59bb1.js";import{A as et,P as tt,e as lt}from"./index.46f1ff27.js";import{d as Te,Q as at}from"./QCheckbox.b4dbea20.js";import{p as ie,l as oe,n as se,o as ce,m as ue,C as de,u as nt,d as rt}from"./ClosePopup.bafabe87.js";import"./touch.3df10340.js";const it="processed",ot="confirmed",st=new K(Te.metadata.address);let Ce=null;const D=()=>Ce,ct=()=>{const l=De(),o=He().connection,d=V(()=>new et(o,l.value,{preflightCommitment:it,commitment:ot})),m=V(()=>new tt(Te,st,d.value));Ce={wallet:l,connection:o,provider:d,program:m}},ut={class:"row q-gutter-x-md"},dt=W({__name:"CreateWhitelist",setup(l){const o=T("My new whitelist");async function d(){const{program:m}=D();let[c,b]=K.findProgramAddressSync([X().publicKey.value.toBytes(),lt(o.value)],m.value.programId);try{const f=await m.value.methods.initialize(o.value).accounts({whitelist:c,systemProgram:pe.programId}).rpc();console.log(f),F.create({message:"TX-Signature: "+f,timeout:5e3})}catch{F.create({color:"red",message:"Error sending tx!",timeout:5e3})}}return(m,c)=>(A(),E("div",ut,[u(le,{class:"col",modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=b=>o.value=b)},null,8,["modelValue"]),u(j,{color:"primary",onClick:c[1]||(c[1]=b=>d())},{default:g(()=>[P("Create")]),_:1})]))}}),ft={class:"row q-gutter-x-md"},mt=W({__name:"AddAddressToWhitelist",setup(l){const{program:o}=D(),d=T("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),m=T(),c=T();Y(async()=>{m.value=await o.value.account.whitelist.all()});async function b(){const f=new K(c.value.publicKey),[i,v]=K.findProgramAddressSync([new K(d.value).toBytes(),f.toBytes()],o.value.programId);try{const r=new K(d.value),C=await o.value.methods.addToWhitelist(r).accounts({entry:i,whitelist:f,authority:X().publicKey.value,systemProgram:pe.programId}).rpc();console.log(C),F.create({message:"TX-Signature: "+C,timeout:5e3})}catch(r){console.log(r),F.create({color:"red",message:`${r}`,timeout:5e3})}}return(f,i)=>{var v;return A(),E("div",ft,[u(ie,{color:"primary",label:((v=c.value)==null?void 0:v.account.name)??"please select a whitelist"},{default:g(()=>[u(oe,null,{default:g(()=>[(A(!0),E(ae,null,ne(m.value,r=>J((A(),I(ue,{clickable:"",key:r,onClick:C=>c.value=r},{default:g(()=>[u(se,null,{default:g(()=>[u(ce,null,{default:g(()=>[P(re(r==null?void 0:r.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[de]])),128))]),_:1})]),_:1},8,["label"]),u(le,{class:"col",outlined:"",modelValue:d.value,"onUpdate:modelValue":i[0]||(i[0]=r=>d.value=r),label:"Address to be removed"},null,8,["modelValue"]),u(j,{color:"primary",onClick:i[1]||(i[1]=r=>b())},{default:g(()=>[P("Add")]),_:1})])}}});var vt=Se({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(l,{slots:o,emit:d}){let m=!1,c,b,f=null,i=null,v,r;function C(){c&&c(),c=null,m=!1,f!==null&&(clearTimeout(f),f=null),i!==null&&(clearTimeout(i),i=null),b!==void 0&&b.removeEventListener("transitionend",v),v=null}function N(h,$,x){$!==void 0&&(h.style.height=`${$}px`),h.style.transition=`height ${l.duration}ms cubic-bezier(.25, .8, .50, 1)`,m=!0,c=x}function H(h,$){h.style.overflowY=null,h.style.height=null,h.style.transition=null,C(),$!==r&&d($)}function R(h,$){let x=0;b=h,m===!0?(C(),x=h.offsetHeight===h.scrollHeight?0:void 0):(r="hide",h.style.overflowY="hidden"),N(h,x,$),f=setTimeout(()=>{f=null,h.style.height=`${h.scrollHeight}px`,v=q=>{i=null,(Object(q)!==q||q.target===h)&&H(h,"show")},h.addEventListener("transitionend",v),i=setTimeout(v,l.duration*1.1)},100)}function Q(h,$){let x;b=h,m===!0?C():(r="show",h.style.overflowY="hidden",x=h.scrollHeight),N(h,x,$),f=setTimeout(()=>{f=null,h.style.height=0,v=q=>{i=null,(Object(q)!==q||q.target===h)&&H(h,"hide")},h.addEventListener("transitionend",v),i=setTimeout(v,l.duration*1.1)},100)}return Re(()=>{m===!0&&C()}),()=>p(Ue,{css:!1,appear:l.appear,onEnter:R,onLeave:Q},o.default)}});const yt=["none","strict","leaf","leaf-filtered"];var ht=Se({name:"QTree",props:{...nt,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:l=>yt.includes(l)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:Number,noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(l,{slots:o,emit:d}){const{proxy:m}=je(),{$q:c}=m,b=rt(l,c),f=T({}),i=T(l.ticked||[]),v=T(l.expanded||[]);let r={};Oe(()=>{r={}});const C=V(()=>`q-tree q-tree--${l.dense===!0?"dense":"standard"}`+(l.noConnectors===!0?" q-tree--no-connectors":"")+(b.value===!0?" q-tree--dark":"")+(l.color!==void 0?` text-${l.color}`:"")),N=V(()=>l.selected!==void 0),H=V(()=>l.icon||c.iconSet.tree.icon),R=V(()=>l.controlColor||l.color),Q=V(()=>l.textColor!==void 0?` text-${l.textColor}`:""),h=V(()=>{const t=l.selectedColor||l.color;return t?` text-${t}`:""}),$=V(()=>l.filterMethod!==void 0?l.filterMethod:(t,a)=>{const e=a.toLowerCase();return t[l.labelKey]&&t[l.labelKey].toLowerCase().indexOf(e)>-1}),x=V(()=>{const t={},a=(e,s)=>{const n=e.tickStrategy||(s?s.tickStrategy:l.tickStrategy),_=e[l.nodeKey],k=e[l.childrenKey]&&Array.isArray(e[l.childrenKey])&&e[l.childrenKey].length!==0,B=e.disabled!==!0&&N.value===!0&&e.selectable!==!1,S=e.disabled!==!0&&e.expandable!==!1,We=n!=="none",O=n==="strict",_e=n==="leaf-filtered",ee=n==="leaf"||n==="leaf-filtered";let te=e.disabled!==!0&&e.tickable!==!1;ee===!0&&te===!0&&s&&s.tickable!==!0&&(te=!1);let L=e.lazy;L===!0&&f.value[_]!==void 0&&Array.isArray(e[l.childrenKey])===!0&&(L=f.value[_]);const y={key:_,parent:s,isParent:k,lazy:L,disabled:e.disabled,link:e.disabled!==!0&&(B===!0||S===!0&&(k===!0||L===!0)),children:[],matchesFilter:l.filter?$.value(e,l.filter):!0,selected:_===l.selected&&B===!0,selectable:B,expanded:k===!0?v.value.includes(_):!1,expandable:S,noTick:e.noTick===!0||O!==!0&&L&&L!=="loaded",tickable:te,tickStrategy:n,hasTicking:We,strictTicking:O,leafFilteredTicking:_e,leafTicking:ee,ticked:O===!0?i.value.includes(_):k===!0?!1:i.value.includes(_)};if(t[_]=y,k===!0&&(y.children=e[l.childrenKey].map(w=>a(w,y)),l.filter&&(y.matchesFilter!==!0?y.matchesFilter=y.children.some(w=>w.matchesFilter):y.noTick!==!0&&y.disabled!==!0&&y.tickable===!0&&_e===!0&&y.children.every(w=>w.matchesFilter!==!0||w.noTick===!0||w.tickable!==!0)===!0&&(y.tickable=!1)),y.matchesFilter===!0&&(y.noTick!==!0&&O!==!0&&y.children.every(w=>w.noTick)===!0&&(y.noTick=!0),ee))){if(y.ticked=!1,y.indeterminate=y.children.some(w=>w.indeterminate===!0),y.tickable=y.tickable===!0&&y.children.some(w=>w.tickable),y.indeterminate!==!0){const w=y.children.reduce((ge,Ne)=>Ne.ticked===!0?ge+1:ge,0);w===y.children.length?y.ticked=!0:w>0&&(y.indeterminate=!0)}y.indeterminate===!0&&(y.indeterminateNextState=y.children.every(w=>w.tickable!==!0||w.ticked!==!0))}return y};return l.nodes.forEach(e=>a(e,null)),t});be(()=>l.ticked,t=>{i.value=t}),be(()=>l.expanded,t=>{v.value=t});function q(t){const a=[].reduce,e=(s,n)=>{if(s||!n)return s;if(Array.isArray(n)===!0)return a.call(Object(n),e,s);if(n[l.nodeKey]===t)return n;if(n[l.childrenKey])return e(null,n[l.childrenKey])};return e(null,l.nodes)}function Ke(){return i.value.map(t=>q(t))}function Ae(){return v.value.map(t=>q(t))}function qe(t){return t&&x.value[t]?x.value[t].expanded:!1}function $e(){l.expanded!==void 0?d("update:expanded",[]):v.value=[]}function fe(){const t=[],a=e=>{e[l.childrenKey]&&e[l.childrenKey].length!==0&&e.expandable!==!1&&e.disabled!==!0&&(t.push(e[l.nodeKey]),e[l.childrenKey].forEach(a))};l.nodes.forEach(a),l.expanded!==void 0?d("update:expanded",t):v.value=t}function G(t,a,e=q(t),s=x.value[t]){if(s.lazy&&s.lazy!=="loaded"){if(s.lazy==="loading")return;f.value[t]="loading",Array.isArray(e[l.childrenKey])!==!0&&(e[l.childrenKey]=[]),d("lazyLoad",{node:e,key:t,done:n=>{f.value[t]="loaded",e[l.childrenKey]=Array.isArray(n)===!0?n:[],Xe(()=>{const _=x.value[t];_&&_.isParent===!0&&me(t,!0)})},fail:()=>{delete f.value[t],e[l.childrenKey].length===0&&delete e[l.childrenKey]}})}else s.isParent===!0&&s.expandable===!0&&me(t,a)}function me(t,a){let e=v.value;const s=l.expanded!==void 0;if(s===!0&&(e=e.slice()),a){if(l.accordion&&x.value[t]){const n=[];x.value[t].parent?x.value[t].parent.children.forEach(_=>{_.key!==t&&_.expandable===!0&&n.push(_.key)}):l.nodes.forEach(_=>{const k=_[l.nodeKey];k!==t&&n.push(k)}),n.length!==0&&(e=e.filter(_=>n.includes(_)===!1))}e=e.concat([t]).filter((n,_,k)=>k.indexOf(n)===_)}else e=e.filter(n=>n!==t);s===!0?d("update:expanded",e):v.value=e}function Ve(t){return t&&x.value[t]?x.value[t].ticked:!1}function U(t,a){let e=i.value;const s=l.ticked!==void 0;s===!0&&(e=e.slice()),a?e=e.concat(t).filter((n,_,k)=>k.indexOf(n)===_):e=e.filter(n=>t.includes(n)===!1),s===!0&&d("update:ticked",e)}function Ee(t,a,e){const s={tree:m,node:t,key:e,color:l.color,dark:b.value};return we(s,"expanded",()=>a.expanded,n=>{n!==a.expanded&&G(e,n)}),we(s,"ticked",()=>a.ticked,n=>{n!==a.ticked&&U([e],n)}),s}function ve(t){return(l.filter?t.filter(a=>x.value[a[l.nodeKey]].matchesFilter):t).map(a=>Be(a))}function Fe(t){if(t.icon!==void 0)return p(ke,{class:"q-tree__icon q-mr-sm",name:t.icon,color:t.iconColor});const a=t.img||t.avatar;if(a)return p("img",{class:`q-tree__${t.img?"img":"avatar"} q-mr-sm`,src:a})}function Pe(){d("afterShow")}function Qe(){d("afterHide")}function Be(t){const a=t[l.nodeKey],e=x.value[a],s=t.header&&o[`header-${t.header}`]||o["default-header"],n=e.isParent===!0?ve(t[l.childrenKey]):[],_=n.length!==0||e.lazy&&e.lazy!=="loaded";let k=t.body&&o[`body-${t.body}`]||o["default-body"];const B=s!==void 0||k!==void 0?Ee(t,e,a):null;return k!==void 0&&(k=p("div",{class:"q-tree__node-body relative-position"},[p("div",{class:Q.value},[k(B)])])),p("div",{key:a,class:`q-tree__node relative-position q-tree__node--${_===!0?"parent":"child"}`},[p("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(e.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(e.selected===!0?" q-tree__node--selected":"")+(e.disabled===!0?" q-tree__node--disabled":""),tabindex:e.link===!0?0:-1,ariaExpanded:n.length>0?e.expanded:null,role:"treeitem",onClick:S=>{he(t,e,S)},onKeypress(S){Ye(S)!==!0&&(S.keyCode===13?he(t,e,S,!0):S.keyCode===32&&Z(t,e,S,!0))}},[p("div",{class:"q-focus-helper",tabindex:-1,ref:S=>{r[e.key]=S}}),e.lazy==="loading"?p(Je,{class:"q-tree__spinner",color:R.value}):_===!0?p(ke,{class:"q-tree__arrow"+(e.expanded===!0?" q-tree__arrow--rotate":""),name:H.value,onClick(S){Z(t,e,S)}}):null,e.hasTicking===!0&&e.noTick!==!0?p(at,{class:"q-tree__tickbox",modelValue:e.indeterminate===!0?null:e.ticked,color:R.value,dark:b.value,dense:!0,keepColor:!0,disable:e.tickable!==!0,onKeydown:xe,"onUpdate:modelValue":S=>{Le(e,S)}}):null,p("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(e.selected===!0?h.value:Q.value)},[s?s(B):[Fe(t),p("div",t[l.labelKey])]])]),_===!0?l.noTransition===!0?e.expanded===!0?p("div",{class:"q-tree__node-collapsible"+Q.value,key:`${a}__q`},[k,p("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":""),role:"group"},n)]):null:p(vt,{duration:l.duration,onShow:Pe,onHide:Qe},()=>J(p("div",{class:"q-tree__node-collapsible"+Q.value,key:`${a}__q`},[k,p("div",{class:"q-tree__children"+(e.disabled===!0?" q-tree__node--disabled":""),role:"group"},n)]),[[Ge,e.expanded]])):k])}function ye(t){const a=r[t];a&&a.focus()}function he(t,a,e,s){s!==!0&&a.selectable!==!1&&ye(a.key),N.value&&a.selectable?l.noSelectionUnset===!1?d("update:selected",a.key!==l.selected?a.key:null):a.key!==l.selected&&d("update:selected",a.key===void 0?null:a.key):Z(t,a,e,s),typeof t.handler=="function"&&t.handler(t)}function Z(t,a,e,s){e!==void 0&&xe(e),s!==!0&&a.selectable!==!1&&ye(a.key),G(a.key,!a.expanded,t,a)}function Le(t,a){if(t.indeterminate===!0&&(a=t.indeterminateNextState),t.strictTicking)U([t.key],a);else if(t.leafTicking){const e=[],s=n=>{n.isParent?(a!==!0&&n.noTick!==!0&&n.tickable===!0&&e.push(n.key),n.leafTicking===!0&&n.children.forEach(s)):n.noTick!==!0&&n.tickable===!0&&(n.leafFilteredTicking!==!0||n.matchesFilter===!0)&&e.push(n.key)};s(t),U(e,a)}}return l.defaultExpandAll===!0&&fe(),Object.assign(m,{getNodeByKey:q,getTickedNodes:Ke,getExpandedNodes:Ae,isExpanded:qe,collapseAll:$e,expandAll:fe,setExpanded:G,isTicked:Ve,setTicked:U}),()=>{const t=ve(l.nodes);return p("div",{class:C.value,role:"tree"},t.length===0?l.filter?l.noResultsLabel||c.lang.tree.noResults:l.noNodesLabel||c.lang.tree.noNodes:t)}}});const _t={class:"row q-gutter-x-md"},gt=W({__name:"ViewWhitelist",setup(l){const{program:o}=D(),d=T(),m=T();Y(async()=>{d.value=await o.value.account.whitelist.all(),m.value=await o.value.account.whitelistEntry.all()});const c=V(()=>{var b;return(b=d==null?void 0:d.value)==null?void 0:b.map(f=>{var i,v;return{label:`${f.account.name} | ${f.publicKey.toString()}`,children:(v=(i=m.value)==null?void 0:i.filter(r=>r.account.parent.toString()===f.publicKey.toString()))==null?void 0:v.flatMap(r=>({label:`Member: ${r.account.whitelisted.toString()}  |  Account: ${r.publicKey.toString()} `}))}})});return(b,f)=>(A(),E("div",_t,[c.value?(A(),I(ht,{key:0,nodes:c.value,"node-key":"label","selected-color":"primary","default-expand-all":""},null,8,["nodes"])):Ze("",!0)]))}}),bt={class:"row q-gutter-x-md"},kt=W({__name:"RemoveAddressFromWhitelist",setup(l){const{program:o}=D(),d=T("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),m=T(),c=T();Y(async()=>{m.value=await o.value.account.whitelist.all()});async function b(){const f=new K(c.value.publicKey),[i,v]=K.findProgramAddressSync([new K(d.value).toBytes(),f.toBytes()],o.value.programId);try{console.log(o.value.methods);const r=new K(d.value),C=await o.value.methods.removeFromWhitelist(r).accounts({entry:i,whitelist:f,authority:X().publicKey.value}).rpc();console.log(C),F.create({message:"TX-Signature: "+C,timeout:5e3})}catch(r){console.log(r),F.create({color:"red",message:`${r}`,timeout:5e3})}}return(f,i)=>{var v;return A(),E("div",bt,[u(ie,{color:"primary",label:((v=c.value)==null?void 0:v.account.name)??"please select a whitelist"},{default:g(()=>[u(oe,null,{default:g(()=>[(A(!0),E(ae,null,ne(m.value,r=>J((A(),I(ue,{clickable:"",key:r,onClick:C=>c.value=r},{default:g(()=>[u(se,null,{default:g(()=>[u(ce,null,{default:g(()=>[P(re(r==null?void 0:r.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[de]])),128))]),_:1})]),_:1},8,["label"]),u(le,{class:"col",outlined:"",modelValue:d.value,"onUpdate:modelValue":i[0]||(i[0]=r=>d.value=r),label:"Address to be added"},null,8,["modelValue"]),u(j,{color:"primary",onClick:i[1]||(i[1]=r=>b())},{default:g(()=>[P("Remove")]),_:1})])}}}),xt={class:"row q-gutter-x-md"},wt=W({__name:"DeleteWhitelist",setup(l){const{program:o}=D(),d=T("3x5vrFFTspsicxrYHMA8SNVW71RMhVkALemXrJFfeQo1"),m=T(),c=T();Y(async()=>{m.value=await o.value.account.whitelist.all()});async function b(){const f=new K(c.value.publicKey);K.findProgramAddressSync([new K(d.value).toBytes(),f.toBytes()],o.value.programId);try{const i=await o.value.methods.deleteWhitelist(c.value.account.name).accounts({whitelist:f,authority:X().publicKey.value}).rpc();console.log(i),F.create({message:"TX-Signature: "+i,timeout:5e3})}catch(i){console.log(i),F.create({color:"red",message:`${i}`,timeout:5e3})}}return(f,i)=>{var v;return A(),E("div",xt,[u(ie,{color:"primary",label:((v=c.value)==null?void 0:v.account.name)??"please select a whitelist"},{default:g(()=>[u(oe,null,{default:g(()=>[(A(!0),E(ae,null,ne(m.value,r=>J((A(),I(ue,{clickable:"",key:r,onClick:C=>c.value=r},{default:g(()=>[u(se,null,{default:g(()=>[u(ce,null,{default:g(()=>[P(re(r==null?void 0:r.account.name),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["onClick"])),[[de]])),128))]),_:1})]),_:1},8,["label"]),u(j,{color:"primary",onClick:i[0]||(i[0]=r=>b())},{default:g(()=>[P("Delete")]),_:1})])}}}),Vt=W({__name:"WhitelistPage",setup(l){const o=T("create");return ct(),(d,m)=>(A(),I(Ie,{class:"col text-center"},{default:g(()=>[u(Me,{"no-caps":"","outside-arrows":"","mobile-arrows":"",modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=c=>o.value=c),class:"shadow-2",align:"justify"},{default:g(()=>[u(M,{name:"create",label:"Create Whitelist"}),u(M,{name:"add",label:"Add Address to Whitelist"}),u(M,{name:"remove",label:"Remove address from Whitelist"}),u(M,{name:"delete",label:"Delete Whitelist"}),u(M,{name:"view",label:"View "})]),_:1},8,["modelValue"]),u(ze,{dark:"",modelValue:o.value,"onUpdate:modelValue":m[1]||(m[1]=c=>o.value=c),animated:""},{default:g(()=>[u(z,{name:"create"},{default:g(()=>[u(dt)]),_:1}),u(z,{name:"add"},{default:g(()=>[u(mt)]),_:1}),u(z,{name:"remove"},{default:g(()=>[u(kt)]),_:1}),u(z,{name:"delete"},{default:g(()=>[u(wt)]),_:1}),u(z,{name:"view"},{default:g(()=>[u(gt)]),_:1})]),_:1},8,["modelValue"])]),_:1}))}});export{Vt as default};
